@&#MAIN-TITLE@&#A new approach to automatic and a priori mesh adaptation around circular holes for finite element analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new approach to a priori mesh adaptation around circular holes in 2D.


                        
                        
                           
                           Based on offline FEA results and error distributions obtained on a reference case.


                        
                        
                           
                           A heuristic relationship between element size and FEA error.


                        
                        
                           
                           Potential extension to 3D holes and to other 2D features.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Mesh adaptation

Mesh sizing

B-Rep

CAD/FEA integration

@&#ABSTRACT@&#


               
               
                  Through our research on the integration of finite element analysis in the design and manufacturing process with CAD, we have proposed the concept of mesh pre-optimization. This concept consists in converting shape and analysis information in a size map (a mesh sizing function) with respect to various adaptation criteria (refining the mesh around geometric form features, minimizing the geometric discretization error, boundary conditions, etc.). This size map then represents a constraint that has to be respected by automatic mesh generation procedures. This paper introduces a new approach to automatic mesh adaptation around circular holes. This tool aims at optimizing, before any FEA, the mesh of a CAD model around circular holes. This approach, referred to as “a priori” mesh adaptation, should not be regarded as an alternative to adaptive a posteriori mesh refinement but as an efficient way to obtain reasonably accurate FEA results before a posteriori adaptation, which is particularly interesting when evaluating design scenarios. The approach is based on performing many offline FEA analyses on a reference case and deriving, from results and error distributions obtained, a relationship between mesh size and FEA error. This relationship can then be extended to target user specified FEA accuracy objectives in a priori mesh adaptation for any distribution of circular holes. The approach being purely heuristic, fulfilling FEA accuracy objectives, in all cases, cannot be theoretically guaranteed. However, results obtained using varying hole diameters and distributions in 2D show that this heuristic approach is reliable and useful. Preliminary results also show that extension of the method can be foreseen towards a priori mesh adaptation in 3D and mesh adaptation around other types of 2D features.
               
            

@&#INTRODUCTION@&#

The rapid evolution of computer systems and computer aided design (CAD) systems allows for significant increase in performance when solving engineering problems with numerical methods. Amongst these methods, finite element analysis (FEA)  [1] has undergone a major expansion for the last twenty years, despite the development of several alternative methods (meshless methods like the Element Free Galerkin Method  [2], isogeometric analysis  [3] and XFEM methods  [4] for example) that have proven efficiency in the analysis of certain classes of engineering problems. Only operating on large size computer systems thirty years ago, FEA can now be processed on personal computers and represents an affordable and versatile tool for solving problems in the context of computer aided product design. Even if its successful use still requires significant expertise, availability of FEA has increased and will certainly further increase in the future. This democratization in the use of numerical analysis induces that it is now used by various actors through the product design cycle (from high-end analysts to early stages designers) which also induces increasingly sophisticated requests on behalf of users. To assist designers and analysts, many tools have been developed towards reducing time required to derive FEA models from CAD product models and towards making its use easier for less experienced actors. Integrating FEA with in the CAD world is one of the early concepts  [5,6] that first came out to make FEA more accessible and productive. This integration between CAD and FEA is now a reality in many commercial solutions even if work remains to be done towards achieving this integration into the product design cycle itself.

Moreover, during the last fifteen years, accessibility and productivity of FEA has also increased through a lot of work performed with regard to CAD/FEA integration  [7–9], to automatic mesh generation  [10–12] and to mesh adaptation based on error estimation  [13]. These tools have dramatically lowered time required to obtain accurate FEA results and have also allowed less experienced FEA users, like early stage designers, to get their designs verified with a certain level of confidence about the accuracy of their analysis results. More generally, it appears that a major consequence of these advances is the fact that FEA technology is now used by a much wider number of actors along the design and manufacturing process, which induces a need for tools allowing less skilled users to obtain reasonably accurate FEA results. Building this type of tools is not simple since it fundamentally involves knowledge synthesis about the way good FEA models can be derived from CAD and about the way relevant engineering conclusions can be drawn from raw FEA results.

In traditional approaches to mesh adaptation, a coarse initial mesh is gradually refined through several analysis and error estimation loops, which provides, at the end, analysis results with a controlled level of accuracy. In this context, several authors, among which Zhu and Zienkiewicz  [14] and Kang and Haghighi  [15,16], showed that the attributes (element size distribution and quality) of the initial mesh introduced as input of this iterative process are crucial to obtain accurate results, with a reasonable number of iterations and without using a very large number of degrees of freedom (DOF). Consequently, it appears that introducing, at the beginning of this iterative process, a mesh with reasonably refined element sizes in specific zones, results in faster convergence with less DOF. The problem is that this is clearly out of reach for certain types of FEA users. On the other hand, more experienced FE analysts use their expertise to build this type of initial meshes, which means featuring a priori adaptation in sensitive zones. Note that, all along the paper, a priori means before any FEA. A priori is opposed to a posteriori, which refers to the automatic refinement process based on FEA error estimation as described above.

Also, since FEA is used through the entire design cycle, differences must be made with regard to accuracy requirements between early design, detailed design and design optimization activities. Usually, during early design steps, analysts only require a reasonable level of accuracy, which means that an initial mesh with an a priori reasonable adaptation in sensible zones would often be sufficient to meet accuracy requirements (see Fig. 1
                     ). Here again, this is out of reach for less experienced users and, for more experienced users, even if is not technically complex, it is usually long and fastidious. In this context, productivity in using FEA at various stages of the design process could notably be increased with the use of efficient and automatic a priori mesh adaptation tools. Even if, as presented in the next section, several approaches to a priori automatic mesh adaptation have been proposed in the literature, setting up robust and efficient tools in this direction still represents a major challenge for the following reasons: 
                        
                           •
                           
                              A priori mesh adaptation is intimately related to the experience and knowledge of engineering problems considered. FEA is used for solving numerous and various engineering problems such as elasticity, heat transfer and magnetics, in stationary and transient state and for both linear and non-linear problems. Consequently, even if similar adaptation rules can be applied in the case of distinct engineering problems, a priori automatic adaptation may be different in different analysis contexts.


                              A priori mesh adaptation fundamentally relies on knowledge synthesis, and the knowledge on which a priori adaptation fundamentally relies is usually very complex.

The knowledge to be synthesized applies on various types of input data (geometric features, material behavior, boundary and loading conditions, etc.) and this data can be vague, ambiguous, extremely delicate to identify and synthesize.

The process has to be completely automated to be practically relevant and efficient, which means automating both data identification, decision making and decision applying.

It is important to outline, as described in  [19,12,20], that CAD, FEA, size and mesh data are closely integrated together in CAD/FEA integrated platforms. This allows rapid changes to design solutions along the design process, while keeping track of the engineering knowledge accumulated through the evolution of these solutions.


                     Fig. 1 also points out that mesh adaptation is practically based on setting up size maps. A size map (or sizing function) is formulated as a 3D scalar field 
                        E
                        
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                        
                      in the case of isotropic mesh grading. Even if this is not used in the work presented in this paper, it is worth noting that mesh grading, either isotropic or anisotropic, is usually represented using a metric   [11], which is defined as matrix field 
                        M
                        
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                        
                     .

The main objective of this paper is introducing a new methodology towards implementing and automating a priori mesh adaptation in the context of 2D and 3D linear elasticity problems. At this point, its implementation is limited to mesh adaptation around circular holes but its extension to other types of features can reasonably be foreseen. This paper is organized as follows. In Section  2, we present existing approaches to automatic a priori mesh adaptation and their limitations, with a specific focus on a previous work led by our research team on the subject  [17]. It ends with the objective of our research. Section  3 details the approach proposed towards automatic and a priori mesh adaptation around circular holes and presents validations for different holes distributions. The way a size map is represented and saved is explained in Section  4, followed by validation examples in 3D in Section  5. The paper ends with comments related to extending the approach to other types of features in Section  6 and with a conclusion about perspectives of future work.

@&#INTRODUCTION@&#

We started working on a priori mesh adaptation several years ago  [5,17,18] and, in our work, it is referred to as nodal density pre-optimization. Several approaches to a priori mesh adaptation have been proposed, with varying generality and varying level of automation. In this literature review, we will focus on the following most important issues in the process and classify references with respect to these issues: 
                           
                              •
                              Knowledge synthesis and decision making.

Criteria underlying a priori mesh adaptation.

Deriving size maps from data extraction and knowledge synthesis.

As introduced in the previous sections, a priori mesh adaptation is fundamentally based on synthesizing engineering knowledge about how a given CAD model should be meshed in order to obtain good FEA results. This problem is in fact a subset of a more general problem which is how a given engineering problem related to an isolated component or to an assembly of components can be derived into a FEA model which is truly relevant to solve the problem or to provide significant engineering results. This topic has been studied by many authors since the early days of FEA use in engineering processes and it still is of interest. Setting up reliable and efficient tools in this direction is particularly complex because: 
                           
                              •
                              It basically involves knowledge synthesis, which is not obviously straightforward.

It involves fundamental knowledge about the engineering problem considered itself (for example about the elastic behavior of solids and more generally about the physics involved) as well as knowledge about the FEA process.

The work presented here is focused on 3D linear elasticity problems for isotropic materials. Thus, a priori adaptation should be based on criteria related to features that have a significant influence on stress concentrations. As detailed below, these features  [17,25] are geometric features, boundary conditions and some other types of criteria.

A majority of a priori mesh adaptation approaches (see for example references  [16,17,25,29,31]) are indeed based on geometry since it is the most obvious criterion influencing stress distribution. Geometry can be taken into account from several considerations such as curvature, form features and geometric proximity. Several research approaches  [18,29,32,33], as well as implementations in commercial FEA systems consider curvature as a key criterion to a priori adaptation. In these approaches, either curvature along edges and/or curvature components on faces of the geometric solid model are calculated to derive a size map that is intended to control the geometric discretization error (usually referred to as 
                           ε
                        ). The adaptation process maintains the maximum distance between the actual geometry and its discretization under a user-defined threshold. Local curvature is considered as an important criterion since it has been shown  [18,34] that, at a given location, 
                           ε
                         is directly related to curvature and to the local element size used. A further step in a priori adaptation is identifying and taking into account geometric features (such as notches, holes, concave fillets, etc.)  [16,17,25]. This aims at reproducing the experienced analyst reasoning towards a priori adaptation. It involves deriving a refined size map around geometric features with regard to their engineering significance. For example, when a notch is identified (with its parameters) and processed as a notch, qualitative as well as quantitative (stress concentration data) mechanical engineering knowledge can be applied to improve mesh adaptation around the notch. These features can either be identified from the feature tree or using feature recognition techniques  [17,35–37]. However, in many approaches, especially for 3D solid domains, the feature identification process is still user driven. Geometric proximity, as defined by Quadros  [29,30] and others  [32], is a third type of geometric criteria which can be taken into account in a priori mesh adaptation. It basically represents, at a given location, the local thickness of material around a curve, normal to a surface or inside a volume. This proximity information is then used to refine the size map in very thin regions or in regions showing small sections. In this case, different tools like Medial Axis Transform (MAT)  [38] and wave propagation techniques  [29,39] can be used (with certain limitations) to automatically extract this proximity information from 3D solid models which is then derived into mesh sizing requirements.

As introduced above, a priori mesh adaptation can be driven by geometric features recognition. Once identified, these features should only be considered as candidate critical regions. In fact, an analysis of loads and boundary conditions must be made to identify which of these candidate critical regions are truly critical. For example, a notch in a given part will actually be the source of stress concentration, if it is under some specific loading conditions as illustrated in Fig. 2
                         (in Fig. 2(a) the notch is not subject to stress concentrations as it is in Fig. 2(b)). Thus, refining the mesh around the notch is useless in Fig. 2(a), whereas it is necessary in Fig. 2(b) to capture stress concentration accurately. However, for usual industrial parts, even if loads and boundary conditions are quantitatively known, automatically deriving from it the loading condition of a given feature is very difficult. This is the reason why, at this time, taking loads and boundary conditions into account is either automatic but limited to 2D simple, or requires user input  [16,25].

Finally, it is sometimes necessary to consider other types of criteria than those mentioned above. For example, when analyzing assemblies, mesh adaptation on a given part is likely to derive from constraints coming from contact conditions with other parts. As well, Quadros in  [29] mentions that the specification of a proper size map may be influenced (due to continuity constraints) by previously meshed portions of the model. As a conclusion, criteria on which a priori adaptation can be based are numerous and various. Taking these criteria into account together implies making compromises between them. Once made these compromises, a priori adaptation is based on deriving size map as presented in the next section.

Once defined mesh adaptation criteria and once extracted necessary data for applying these criteria, a priori mesh adaptation is led through the automatic calculation of a FEA size map. A size map (or target size function) is classically represented using a scalar field 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            or a metric 
                              M
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            (in the case of anisotropic sizing). As described in  [29], generating 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            or 
                              M
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            from geometric features and data can be divided into the following sub-problems:


                           
                              
                                 •
                                 Computing local size maps around (or across) local features.

Integrating the influence of several nearby geometric features (which means several overlapping local size maps) into a global (for the whole domain) size map 
                                       E
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    .

Ensuring that 
                                       E
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                     is continuous and bounded over the whole domain.

Bounding the size map gradient 
                                       
                                          ‖
                                          
                                             
                                                ∇
                                             
                                             →
                                          
                                          E
                                          
                                             (
                                             x
                                             ,
                                             y
                                             ,
                                             z
                                             )
                                          
                                          ‖
                                       
                                     to avoid poorly shaped elements. For methods based on the wave propagation concept  [16,25], this is equivalent to limiting the wave propagation rate.

When trying to derive a local size map around or across local geometric features, most of existing approaches use the concept of defining source entities and extrapolating local size maps from these sources entities  [16,17,25,29,30]. Source entities are basically locations represented by points, edges or faces around which target size maps are automatically extrapolated (taking into account the criteria mentioned above) or user specified. Thus in general, a target size is associated with each source entity and then, this target size is extrapolated around the source entity considered. In the following paragraphs, 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                            refers to the target size on source entity 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            and the extrapolation of 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                            at distance 
                              d
                            from 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            is 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                           , which means that 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                           . The location of source entities is related to criteria listed in Section  2.3 such as curvature, features causing stress concentration, geometric proximity, contact between components and existing mesh elements. Consequently, these source entities are derived from entities of the CAD model and/or from mesh entities associated with previously meshed portions of the CAD model. A local size map 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            is extrapolated from the location of each source entity 
                              
                                 
                                    S
                                 
                                 
                                    i
                                 
                              
                            and from the target size associated 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    s
                                 
                                 
                                    i
                                 
                              
                           , inside an influence zone (associated to each source entity as a scope). By controlling the position, target value, scope and sizing function associated with sets of source entities, a great variety of size maps can be generated to fulfill many types of requirements. It has been shown  [16,18,29] that using sets of source points with flexible sizing functions is a very efficient and general solution, which will be used in the present paper. An alternative approach that can be used for the extrapolation of mesh size around source entities and critical regions in general is using the wave propagation concept  [16,25]. In this case, sizing functions 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          S
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            are calculated considering waves that are initiated from source entities (source entities are at the center of these waves). These waves propagate through space and can be assigned with a wave propagation rate (which basically represents the way the target size varies) and a wave priority (which allows balancing the influence of several waves taking action at a given location).

In a previous work of our team on this topic  [17], as illustrated in Fig. 3
                            three types of adaptation entities, referred to in  [17] as analysis features, have been considered (material withdrawals, concave edges and concave fillets). In this previous approach to a priori adaptation, a size map is extrapolated from each analysis features with the use of influence zones like in the previous paragraph (see Fig. 4
                           ). In this approach the geometry of influence zone 
                              
                                 
                                    Z
                                 
                                 
                                    i
                                 
                              
                            associated with analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            is derived from the geometry of 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            and from its distance of influence 
                              
                                 
                                    Δ
                                 
                                 
                                    i
                                 
                              
                            (also referred to as its scope). The sizing function 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            (at a distance 
                              d
                            from analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           ) is linear (which is a limitation since stress concentration itself is not linear) and is defined as follows: 
                              
                                 •
                                 When 
                                       d
                                       ≥
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          d
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                       
                                    . Thus, 
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                       
                                     is the imposed target size across the whole object outside any influence zone.

When 
                                       d
                                       =
                                       0
                                    , 
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          0
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                     where 
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                     is the imposed target size on the analysis feature 
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                    .

When 
                                       d
                                       <
                                       
                                          
                                             Δ
                                          
                                          
                                             i
                                          
                                       
                                    , the sizing function 
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          d
                                          )
                                       
                                     around analysis feature 
                                       
                                          
                                             A
                                          
                                          
                                             i
                                          
                                       
                                     is 
                                       
                                          (1)
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                (
                                                d
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               E
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         g
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            
                                                               E
                                                            
                                                            
                                                               ˆ
                                                            
                                                         
                                                      
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             .
                                             d
                                             +
                                             
                                                
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                             .
                                          
                                       
                                    
                                 

In general, when using source entities or analysis features as a basis for the extrapolation of local size maps, questions arise about making a compromise between influences of several sources or features. The fact that several sources influence the target size at a given location can result from the fact that the influence zones of several analysis features intersect at this location, but also that a compromise has to be made between different adaptation criteria. This is the case for example when taking into account curvature by controlling the geometric discretization error 
                              ε
                           , as well as taking into account the influence of local features causing stress concentration. Managing intersections between influence zones or making compromises between different adaptation criteria can be achieved using different approaches  [16,17,25,29,30] but in all cases this compromise has to be made with respect to constraints as introduced in Section  2.4.1 (especially continuity and smoothness).

A priori mesh adaptation can also be performed by solving sets of linear or differential equations. For example, Remondini and co-authors  [40] have proposed using the Force Density Method (FDM) in a mesh refinement loop for 2D domains. The main interest of this approach is that the FDM allows taking into account the distribution of loads along the refinement process. In this case, the process involves solving sets of linear equations. In  [41] Persson combines, for 2D meshes, an implicit representation of geometry (a distance function), the Medial Axis Transform (MAT) and a Hamilton–Jacobi partial differential equation system, to generate a sizing function that is able to take into account various types of constraints (curvature, local feature size and others) while respecting a threshold on the mesh size gradient along with satisfying an optimality criterion (the local size of elements is as large as possible). This approach has the advantage of taking into account all constraints on mesh sizing together in an elegant and efficient way but it requires solving partial differential equation systems. Avoiding the resolution of such systems in mesh adaptation represents one of the main objectives of the approach presented in this paper.

As presented in the previous section, several approaches have been proposed towards a priori 3D mesh adaptation but unfortunately, many problems remain unsolved, which mainly derives from the following observations: 
                           
                              •
                              These approaches are essentially qualitative.

Different constraints must be taken into account together and these constraints may be contradictory.

Some constraints are difficult to take into account (BCs for example).

A priori mesh adaptation somehow requires anticipating simulation results, which is in general not easy.

3D extension of methods that have been successfully developed for 2D problems is usually complex.

Indeed, none of the approaches presented along the previous sections consider the final objective of a priori mesh adaptation explicitly, which means as it is the case for a posteriori mesh adaptation. The objective of a priori mesh adaptation is controlling the FEA error, at locations of interest, with respect to analysis objectives. At this point, quantitatively controlling the FEA error can only be performed through a posteriori mesh adaptation. Indeed, all the approaches proposed to a priori mesh adaptation are qualitative and not quantitative. The approach presented in this paper brings about a contribution that leads towards filling this gap by a priori quantifying the effect of mesh adaptation. Indeed, as presented along next sections, the maximum FEA error objective in zones of interest (referred to as 
                           
                              
                                 δ
                              
                              
                                 
                                    target
                                 
                              
                           
                        ) is explicitly the main input in the process. The adaptation process, as proposed in this work, tries keeping the FEA error distribution under 
                           
                              
                                 δ
                              
                              
                                 
                                    target
                                 
                              
                           
                         in zones of interest (where stress concentration occurs). Thus, the final objective of this work is setting up a fully automatic adaptation process for 3D mechanical parts that is explicitly intended to control the FEA error distribution at concentration points, before any FEA calculation. Implementation of the concept, as presented in this paper, is limited to the case of circular through holes. However, as shown in Section  5, it is likely to be extended to other types of geometric features causing stress concentration. Also, the method presented here is independent of loads and BCs, which means that: 
                           
                              •
                              A circular hole is a priori considered as source of stress concentration, which is not necessarily the case.

Refinement is applied all around holes and not only at stress concentration points.

FEA error is only controlled around stress concentration points, which is not a practical problem since FEA results at higher stress locations are usually the most meaningful for engineering purposes. However, this makes that, unlike a posteriori mesh adaptation, a priori mesh adaptation, as proposed in this paper, does not feature global error control properties.

The approach proposed in this paper is based on thoroughly studying a reference circular through hole, on which sets of FEA simulations, using various sizing functions, are performed. For each FEA sizing function, an accurate error estimate is calculated between the FEA result and a so called “exact” solution for this reference case. This so-called “exact” solution is assessed by using an extremely refined and quadratic mesh. Using this so-called “exact” solution as a reference, FEA error estimates are calculated for many FEA simulations on the reference case and for many sizing functions. This allows finding a quantitative relationship between mesh sizing and error estimate for the reference case. Once found such a relationship, mesh adaptation required to meet a desired error target 
                           
                              
                                 δ
                              
                              
                                 
                                    target
                                 
                              
                           
                         in the FEA result can inversely be estimated. Finally, the quantitative relationship between FEA error estimate and mesh sizing for the reference case is extrapolated to other through circular through holes configurations. At the end, this methodology allows predicting the element size distribution that is required to meet a desired error target 
                           
                              
                                 δ
                              
                              
                                 
                                    target
                                 
                              
                           
                         in the FEA result, and this for any type of through hole.

The reference case considered (see Fig. 5
                        (a)) is the study of stress concentration occurring around a circular hole, with hole diameter 
                           
                              
                                 D
                              
                              
                                 
                                    ref
                                 
                              
                           
                        , in a plate with nearly infinite width 
                           
                              
                                 w
                              
                              
                                 
                                    ref
                                 
                              
                           
                         under uniaxial loading. In this case, the stress concentration theoretical factor is close to 3 (but not exactly 3 because the width is not infinite). Dimensions considered are 2 mm for 
                           
                              
                                 D
                              
                              
                                 
                                    ref
                                 
                              
                           
                         and 20 mm for 
                           
                              
                                 w
                              
                              
                                 
                                    ref
                                 
                              
                           
                        . Due to symmetry of geometry, BCs and loads, FEA simulations are performed on half the plate as illustrated in Fig. 5(b). Theoretically, we could only use a quarter of the plate, due to double symmetry, but in this case, results of interest (the line between 
                           x
                           =
                           1
                         and 
                           x
                           =
                           10
                        ) would be located on BCs, which affects the accuracy of stress results. In fact, we initially started with a quarter of the plate and found out that better correlations can be obtained with half the plate.

On this reference case, as introduced in the previous paragraph, a reference Von-Mises stress distribution along 
                           x
                         axis 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         is calculated using an extremely refined quadratic mesh (with a constant element size equal to 0.025 mm). In this paper, this Von-Mises stress distribution (Fig. 5(b)) is noted with a 
                           
                              
                                 
                              
                              
                                 ̃
                              
                           
                         because it is considered as “exact”. Indeed, the quadratic mesh used for computing 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         is refined so that 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         can reasonably be considered as close enough to the exact solution. Thus, it can be used for estimating, accurately enough, the actual analysis error obtained when using coarser meshes. One interesting aspect with this reference case is that a theoretical stress distribution 
                           
                              
                                 σ
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    th
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         can be formulated (see Ref.  [42] for example), based the assumption that plate width is close enough to infinite (with 
                           
                              
                                 σ
                              
                              
                                 
                                    
                                    
                                       ∞
                                    
                                 
                              
                           
                           =
                           1
                           
                           
                              Pa
                           
                        ): 
                           
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          
                                             VM
                                          
                                       
                                       
                                          
                                             th
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               y
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      x
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      y
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 (2)
                                 
                                    With
                                    
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                x
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    −
                                    
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    
                                    and
                                    
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                y
                                             
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                    
                                    =
                                    1
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    ⋅
                                    
                                       
                                          1
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                         The comparison between 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         and 
                           
                              
                                 σ
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    th
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         along 
                           x
                         axis is shown in Fig. 6
                         and the relative difference in Fig. 7
                        . As expected, there is a difference between these two solutions since 
                           
                              
                                 σ
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    th
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         considers the plate width as infinite. Close to the hole, the relative difference is nearly constant and around 1.5%. Note that 
                           
                              
                                 σ
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    th
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                         is only used here for comparison with 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ̃
                                    
                                 
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              x
                              )
                           
                        . Indeed, since 
                           
                              
                                 σ
                              
                              
                                 
                                    VM
                                 
                              
                              
                                 
                                    th
                                 
                              
                           
                         is not known for any type of stress concentration feature, the methodology cannot be based on it in general.

As introduced in the previous paragraph, the first objective is finding, for the reference case, a quantitative relationship between the element size distribution at stress concentration locations around the hole (noted 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           ) and the distribution of the so called “exact” FEA error estimate 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           . If 
                              
                                 
                                    σ
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            is the Von-Mises stress distribution obtained using size distribution 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           , 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            is calculated from: 
                              
                                 (3)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          −
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                            A set of simulations are performed using various mesh sizing with the objective of fulfilling target values for the FEA error estimate at the concentration point 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 1
                                 )
                              
                            that are distributed between 5% and 30%.

For comparison, we will also assess, for the same set of simulations, the evolution of the FEA error 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       th
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            calculated with the theoretical stress distribution 
                              
                                 
                                    σ
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    
                                       th
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            as reference: 
                              
                                 (4)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             th
                                          
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          −
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   th
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   th
                                                
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                       
                                    
                                    .
                                 
                              
                           
                           Fig. 8
                            shows the evolution of 
                              
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          ref
                                       
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 |
                              
                            with 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 1
                                 )
                              
                            while Fig. 9
                            shows the evolution of 
                              
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          th
                                       
                                    
                                    
                                       
                                          ref
                                       
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 |
                              
                            with 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 1
                                 )
                              
                           .

From these results we are able to draw a first fundamental and very interesting conclusion: the relationship between element size at the concentration point and FEA error estimate is highly linear. Moreover, it is the case for both FEA error measures 
                              
                                 (
                                 
                                    |
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    |
                                 
                                   and  
                                 
                                    |
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             th
                                          
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    |
                                 
                                 )
                              
                           . It appears that correlation coefficients are very similar for the two FEA error measures (0.9916 for Fig. 8 and 0.9915 for Fig. 9) and that, as expected, 
                              
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          ref
                                       
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 |
                              
                            is in general smaller that 
                              
                                 |
                                 
                                    
                                       δ
                                    
                                    
                                       
                                          ref
                                       
                                    
                                 
                                 
                                    (
                                    1
                                    )
                                 
                                 |
                              
                           . This last result, in some way, confirms that 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            is more accurate than 
                              
                                 
                                    σ
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    
                                       th
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           .

It can be noted that these two linear regressions do not pass through the origin. This can first be explained by lack of data for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              <
                              5
                              %
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       th
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              <
                              5
                              %
                           . Then, it must reminded that for FEA errors under 5%, results are necessarily affected by uncertainty related to the fact that the reference solution is not exact, even if very close to the exact solution. Thus, a better correlation for FEA errors under 5% would require using a more accurate reference solution, which means a more refined quadratic mesh.

Linearity between element size and FEA error at the concentration point is a very important and interesting conclusion because, as we will explain it in the next paragraphs, this settles the base for being able to “a priori” establish an element size distribution around circular holes that will allow satisfying a given user specified FEA error target. In other words, this allows controlling the FEA error before performing the analysis itself.

Moreover, we found that this linearity is strongly influenced by the quality of the FEA solution around the stress concentration point. In Fig. 10
                            we first illustrate the effect of a diagonal swap on the quality of the FEA solution. It is obvious that stress distribution shown in Fig. 10(b) is closer to the reference stress distribution than that shown in Fig. 10(d). This can also be illustrated by plotting 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       th
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            (or 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           ) before and after the diagonal swap (see Fig. 10(c) and (f)). Then, when the result obtained in Fig. 10(e) is introduced in linear distributions shown in Figs. 8 and 9 it clearly shows that this result is far from these linear distributions (see the red point in Fig. 11
                           ). Thus this emphasizes that, when mesh quality is good and when the mesh topology is appropriate, the relationship between element size and FEA error, at the stress concentration point, is perfectly linear.

In Fig. 12
                           , with 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                              =
                              0.15
                           , we illustrate that the distribution of the FEA error estimate along the 
                              x
                            axis for the reference case 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            (the curve in red) is absolutely not linear. In fact, we found that the distribution of 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            can be closely related to the second derivative of Von-Mises stress 
                              
                                 
                                    σ
                                 
                                 
                                    ″
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            (the dotted curve in Fig. 12): 
                              
                                 (5)
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ″
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                
                                                   VM
                                                
                                             
                                             
                                                
                                                   th
                                                
                                             
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    .
                                 
                              
                           
                        

Of course, for this type of features (circular holes), the second derivative of Von-Mises stress can be calculated quite accurately from the theoretical stress distribution 
                              
                                 
                                    σ
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    
                                       th
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           , as given in Eq. (2). For other features, for which the theoretical stress distribution is not known, this second derivative should be calculated from FEA results, which can be a rough estimate. However, it appears that, despite the fact that the estimation of 
                              
                                 
                                    σ
                                 
                                 
                                    ″
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            from FEA results is a rough estimate, it is sufficiently accurate for the extrapolation of an “a priori” element size distribution 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            aimed at keeping FEA error around stress concentration points under a given threshold. Indeed, as shown in the next section, 
                              
                                 
                                    σ
                                 
                                 
                                    ″
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            essentially influences the variation of element size away from the hole and it has no effect on mesh sizing at the concentration point itself.

We have seen in the previous paragraph that the relationship between element size and FEA error estimate around stress concentration points is linear and that the shape of the distribution, along 
                              x
                            axis, of the FEA error estimate is similar to the distribution of Von-Mises stress second derivative. These two conclusions made us consider the following general relationship between the FEA error estimate 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            and the element size distribution 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            for the reference case: 
                              
                                 (6)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    α
                                    ⋅
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    ⋅
                                    
                                       
                                          
                                             (
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         
                                                            VM
                                                         
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             )
                                          
                                       
                                       
                                          β
                                       
                                    
                                    .
                                 
                              
                            Once established the general form of this law, parameters 
                              α
                            and 
                              β
                            can be calculated empirically by performing, on the reference case, many FEA simulations based on using different element size distributions.

One may argue that this relationship is not necessarily very accurate as it is based on quite approximate data. In fact, this relationship does not need to be very accurate since the final objective is “a priori” setting up the order of magnitude and the shape of imposed element size distributions that will later be used as an input by automatic mesh generation procedures. Since these mesh generation procedures in themselves are genuinely limited in their capacity to respect imposed element size distributions, searching for highly accurate element size distributions is a pointless exercise. Once calculated 
                              α
                            and 
                              β
                            this empirical law can then be used to setup the “a priori” element size adaptation 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            that should be imposed to the automatic mesh generation process around the hole in order to achieve a desired level of accuracy 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           : 
                              
                                 (7)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   target
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                       
                                          α
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               
                                                                  VM
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Thus, even if the target accuracy is constant along 
                              x
                            axis, the required element size 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            varies and it is not linear. Fig. 13
                            illustrates, for the reference case, element size distributions corresponding to target accuracies from 5% to 50%. The illustration of these curves is limited to the interval 
                              x
                              ∈
                              
                                 [
                                 1
                                 ,
                                 2.5
                                 ]
                              
                            since we will see in the next section that this expression of 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            is only valid inside a zone around the hole and that its expression needs to be modified at a certain distance from it.

The basic expression of 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            for the reference case, as introduced in the previous section, has to be modified for several reasons. The first reason is related to the fact that, at a certain distance from the circular hole, the second derivative of Von-Mises stress vanishes, which makes that there is no need to refine the mesh outside a zone located around the hole. For the reference case, it appears that the required adaptation zone is limited to 
                              x
                              ∈
                              
                                 [
                                 1
                                 ,
                                 2
                                 ]
                              
                           . In Section  2.4.3, this zone is referred to as the influence zone of analysis features. Considering the same type of notation used in Section  2.4.3, the influence zone associated with the reference circular hole is noted 
                              
                                 
                                    Δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            and consequently 
                              
                                 
                                    Δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              =
                              1
                           . Since the reference hole is the only stress concentration feature in the reference case, at distance 
                              d
                              ≥
                              
                                 
                                    Δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           , the mesh does not need to be refined. Thus, for 
                              d
                              ≥
                              
                                 
                                    Δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            the target size is constant and noted 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           .

For obvious reasons, the element size distribution must be continuous and this imposes that: 
                              
                                 (8)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          g
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   target
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                       
                                          α
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               
                                                                  VM
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Using the same notations as in Section  2.4.3, we can also state that the required element size on the reference analysis feature 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            is: 
                              
                                 (9)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          A
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   target
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                       
                                          α
                                          ⋅
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               
                                                                  VM
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            The second reason why the initial expression of 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           , as introduced in the previous section, needs to be modified is related to element quality issues. It is indeed obvious that target accuracy 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            can only be reached if an adequate element distribution is used and if the element quality is satisfying. We introduced in Section  2.4.4 that a common way of controlling element quality is to consider a threshold on 
                              
                                 ‖
                                 
                                    
                                       ∇
                                    
                                    →
                                 
                                 E
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 ‖
                              
                           . In our context, this is done by limiting the slope of 
                              
                                 
                                    E
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           , which means limiting its first derivative.

After several trials, we came to the conclusion that keeping 
                              
                                 
                                    ∂
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                              ≤
                              0.25
                            is a good compromise between: 
                              
                                 •
                                 Insuring element quality (by keeping 
                                       
                                          
                                             ∂
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      ref
                                                   
                                                
                                             
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                     as low as possible).

Minimizing the number of elements (by refining the mesh only where it is required, which means by respecting the theoretical distribution of 
                                       
                                          
                                             E
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    ).


                           
                              
                                 
                                    Step  1: compute 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             
                                                lim
                                             
                                          
                                       
                                     
                                    for which 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      ref
                                                   
                                                
                                             
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   lim
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       0.25
                                    .


                                    Step  2: for 
                                    
                                       x
                                       <
                                       
                                          
                                             x
                                          
                                          
                                             
                                                lim
                                             
                                          
                                       
                                       :
                                       
                                          
                                             E
                                          
                                          
                                             
                                                mod
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                    .


                                    Step  3: for 
                                    
                                       x
                                       ≥
                                       
                                          
                                             x
                                          
                                          
                                             
                                                lim
                                             
                                          
                                       
                                       
                                          
                                             E
                                          
                                          
                                             
                                                mod
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             E
                                          
                                          
                                             
                                                linear
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                     
                                    with 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   E
                                                
                                                
                                                   
                                                      linear
                                                   
                                                
                                                
                                                   
                                                      ref
                                                   
                                                
                                             
                                          
                                          
                                             ∂
                                             x
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       0.25
                                    .


                                    Step  4: compute 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                     
                                    for which 
                                    
                                       
                                          
                                             E
                                          
                                          
                                             
                                                linear
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          
                                             
                                                x
                                             
                                             
                                                
                                                   end
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                    .


                                    Step  5: for 
                                    
                                       x
                                       ≥
                                       
                                          
                                             x
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                       :
                                       
                                          
                                             E
                                          
                                          
                                             
                                                mod
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                       
                                          (
                                          x
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                    .

As shown in Fig. 14 this gradient limitation makes that the influence zone around reference hole is increased in general. Moreover, Fig. 14 also illustrate that values of 
                              
                                 
                                    x
                                 
                                 
                                    
                                       lim
                                    
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    
                                       end
                                    
                                 
                              
                            strongly depend on the target accuracy 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            and it appears that, for the reference case, if 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              ≤
                              1
                              %
                           , there is no linear portion in 
                              
                                 
                                    E
                                 
                                 
                                    
                                       mod
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            while, if 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              >
                              10
                              %
                           , 
                              
                                 
                                    E
                                 
                                 
                                    
                                       mod
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            is completely linear for 
                              x
                              ∈
                              
                                 [
                                 1
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       
                                          end
                                       
                                    
                                 
                                 ]
                              
                           . This leads to an important conclusion: 
                              
                                 •
                                 For very low values of 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                target
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                     the target size distribution is non-linear.

For mean values of 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                target
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                     the target size distribution is a combination between linear and non-linear laws (Fig. 14(a)).

For higher values of 
                                       
                                          
                                             δ
                                          
                                          
                                             
                                                target
                                             
                                          
                                          
                                             
                                                ref
                                             
                                          
                                       
                                     the target size distribution is linear only and thus, it only derives from gradient limitation issues (Fig. 14(b)).

The principle of the approach proposed in this paper is using the analysis and adaptation data that has been made on the reference case to extrapolate it to any distribution of circular holes. The objective is computing a size map 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            over 
                              Ω
                            that is automatically adapted around all holes, so that the maximum FEA error estimate remains under the specified accuracy target 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           . Thus, the computation of this size map 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            can actually be considered as “a priori” (if compared to “a posteriori” classical schemes) since it is calculated before any FEA on 
                              Ω
                           .

The reference case features a hole with diameter 
                              
                                 
                                    D
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            and we now consider the general case of an analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            as a through hole with diameter 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            and a target accuracy 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                           . With 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           , element sizes proposed in the previous section can be extrapolated from the reference case to the analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            using a simple proportional law. This assumption is reasonable since it has been seen in Section  3.3.1 that there is a linear relationship between element size at the stress concentration point and the error estimate associated. Thus considering again the same notations as in Section  2.4.3, 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                            are simply extrapolated from 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    A
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            using: 
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                    
                                    ⋅
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          A
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          g
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                    
                                    ⋅
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          g
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

We apply the adaptation scheme described in the previous section to sets of circular holes with increasing hole diameters 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            (and constant width 
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              =
                              20
                              
                              
                                 mm
                              
                           ). For each hole 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           , the fraction between hole diameter and plate width is noted: 
                              
                                 (12)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                w
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            The reference case features 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              =
                              0.1
                            (illustrated in Fig. 5) and we consider validations cases with 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                            between 0.1 and 0.4. For each case, different mesh adaptations are considered based on different objectives 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                           . As explained for the reference case in Section  3.1, the actual error obtained 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                            is based on results 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    i
                                 
                              
                            obtained from an extremely refined mesh and considered as close enough to the exact solution: 
                              
                                 (13)
                                 
                                    
                                       
                                          δ
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   
                                                      VM
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      VM
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         ̃
                                                      
                                                   
                                                
                                                
                                                   
                                                      VM
                                                   
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       |
                                    
                                    .
                                 
                              
                            For all validation cases we calculate both the distribution of the estimated error 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            across the whole plate and the evolution 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            along 
                              x
                            axis (
                              x
                            varies between 1 and 10 mm). In Fig. 15
                           (a), the mesh generated, with Von-Mises stress results, are shown for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                            and 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              =
                              0.1
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            along with 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            are respectively illustrated (in %) in Fig. 15(b) and Fig. 15(c) for this case. Note that in Fig. 15(b), the color scale is adjusted to the objective 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                           . This is also the case, in figures below, for all distributions 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                           .

These results show that 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            is well fulfilled along 
                              x
                            axis, especially at the stress concentration point. It also shows that from around 45° to 90° (and −45° to −90°) from 
                              x
                            axis, 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            exceeds 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                           , which is absolutely not a problem since it is sufficiently far away from the concentration zone and since Von-Mises stress in this zone is very low. Then, in Fig. 16
                           , the same set of results is provided for the same diameter with 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              25
                              %
                           . The mesh is obviously much coarser than in Fig. 15 but the target 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            is well fulfilled along 
                              x
                            axis. The same remark applies with respect to the distribution 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            around the hole, far from the stress concentration zone.

In Fig. 17
                           , the hole diameter is increased to 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                              =
                              0.3
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                           . Mesh sizing is imposed as explained in Section  3.5.2 and we again illustrate both 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                            (it can be noted that since the hole diameter is increased, 
                              x
                            varies between 3 and 10 mm). In this case, the target 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            is slightly exceeded (17% at the stress concentration point). We are going to see that in the next examples that, in some cases, 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            is indeed slightly exceeded. This can first be explained considering that the actual mesh sizing obtained, once the mesh generated, cannot be equal to the imposed mesh sizing function everywhere. Indeed, finite elements can locally be a little bigger than what imposed by the mesh sizing function, which obviously has an impact on 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                           . Another explanation is that, as introduced in Section  3.3.2, local mesh quality also has an significant impact on FEA accuracy and by the way on 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                           . However, we will see in the results presented in Table 1
                            that these excesses are very limited. Indeed, Table 1 presents a synthesis of results obtained for 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                           , at the stress concentration point, for 4 values of 
                              
                                 
                                    ρ
                                 
                                 
                                    i
                                 
                              
                            and 5 values of 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                           .


                           Figs. 18–20
                           
                           
                            illustrate distributions obtained for 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 )
                              
                           , for different objectives 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            and for different hole diameters. The general trend of results presented in Table 1 and Figs. 18–20 clearly confirms that using such a mesh sizing function allows “a priori” controlling the FEA error around stress concentration points of a single circular hole.

We now consider extrapolating the reference case to a set of 
                              n
                            circular holes with associated hole diameters 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            (for 
                           
                              i
                              =
                              1
                              
                              to
                              
                              n
                           ). We considered the same accuracy objective for all analysis features so that 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                            (for 
                           
                              i
                              =
                              1
                                to  
                              n
                           ). The main problem with this extrapolation is the fact that, in this context, each hole diameter 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            induces a different value for 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                           , the target size outside the adaptation zone associated with analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           . Overall, a common value 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                           , as introduced in Section  2.4.3, must be found from the different values of 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                            since 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                            represents the target size outside all adaptation zones. We tried different options and finally considered calculating 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                            as the mean value of all 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                           : 
                              
                                 (14)
                                 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          g
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    ⋅
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          g
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                            The problem is that this harmonization affects each distribution 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            at distance 
                              d
                            around each analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           . Consequently, each element size distribution is modified according to the two following principles. First, the element size at distance 
                              d
                            from analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            should be equal to the element size a distance 
                              d
                              ⋅
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            from the reference hole multiplied by 
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                 
                              
                           .

This implies that (note that distance 
                              d
                            to the reference hole is used instead of coordinate 
                              x
                            with 
                              x
                              =
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              +
                              d
                              ⋅
                              
                                 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           ): 
                              
                                 (15)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                             
                                                A
                                             
                                          
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       d
                                       )
                                    
                                    =
                                    
                                       
                                          E
                                       
                                       
                                          
                                             ref
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   
                                                      ref
                                                   
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       d
                                       ⋅
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   
                                                      ref
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ⋅
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                δ
                                             
                                             
                                                
                                                   target
                                                
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                       
                                          α
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ∂
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               
                                                                  VM
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ∂
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  
                                                                     ref
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      d
                                                      ⋅
                                                      
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  
                                                                     ref
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   )
                                                
                                             
                                             
                                                β
                                             
                                          
                                       
                                    
                                    ⋅
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                i
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                
                                                   ref
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Second, as seen in the case of the reference case, the distribution 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            at distance 
                              d
                            around analysis feature 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            is modified considering that the gradient 
                              
                                 
                                    ∂
                                    
                                       
                                          E
                                       
                                       
                                          A
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ∂
                                    d
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                              ≤
                              0.25
                            and 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                              ≤
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                           , which is performed by modifying 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            as follows: 
                              
                                 •
                                 if 
                                       
                                          
                                             ∂
                                             
                                                
                                                   E
                                                
                                                
                                                   A
                                                
                                                
                                                   i
                                                
                                             
                                          
                                          
                                             ∂
                                             d
                                          
                                       
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   lim
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       0.25
                                       ,
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          d
                                          )
                                       
                                     is imposed as linear (with slope 0.25) for 
                                       d
                                       >
                                       
                                          
                                             d
                                          
                                          
                                             
                                                lim
                                             
                                          
                                       
                                    
                                 

if 
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          
                                             
                                                d
                                             
                                             
                                                
                                                   end
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                       
                                    , 
                                       
                                          
                                             E
                                          
                                          
                                             
                                                
                                                
                                                   A
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       
                                          (
                                          d
                                          )
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                       
                                     for 
                                       d
                                       >
                                       
                                          
                                             d
                                          
                                          
                                             
                                                end
                                             
                                          
                                       
                                    .

Taking the mean value of all 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                            as 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                            may be questionable, especially in cases with significant differences between hole diameters. However, since the element size on each hole 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                            (which means where stress concentration is at maximum) is not influenced by 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                            and since the slope is kept under 0.25, element size distributions around smaller holes are not affected by this choice. Once modified all the 
                              
                                 
                                    E
                                 
                                 
                                    
                                       
                                       
                                          A
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 d
                                 )
                              
                            this way, the result is a size map 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                           . 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            is continuous and its value is 
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    g
                                 
                              
                            outside adaptation zones associated with all analysis features 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                           . It is refined around all analysis features 
                              
                                 
                                    A
                                 
                                 
                                    i
                                 
                              
                            in a way that the maximum FEA error estimate is expected under the user specified accuracy target 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                           . Thus, following the steps described along Section  3 results in an “a priori” and automatic adaptation process as aimed in the objective. Moreover, the resulting size map 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            is smooth enough to avoid poorly shaped elements, since the process includes a limitation on the gradient 
                              
                                 ‖
                                 
                                    
                                       ∇
                                    
                                    →
                                 
                                 E
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 ‖
                              
                           .

We have applied the adaptation scheme around multiple circular holes, as introduced the previous section, to the sample part illustrated (along with loading applied) in Fig. 21
                           . In this figure, holes are numbered and radii vary from 1 to 4. Like in the case of validating the approach for a single hole, a reference Von-Mises stress distribution 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       VM
                                    
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            is calculated using an extremely refined quadratic mesh (with a constant element size equal to 0.025 mm). This quadratic mesh features 2591400 triangles and 5190612 nodes. The solution obtained with this refined mesh is illustrated in Fig. 22
                            with zooms on maximum stress locations around each hole. Figs. 23
                           (a) and 24
                           (a) show meshes generated using the adaptation scheme proposed in this paper for respectively 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                           . Like in the case of a single hole, it is interesting to compute 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            distributions. Figs. 23(b) and 24(b) show 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 )
                              
                            obtained with meshes respectively shown in Figs. 23(a) and 24(a) with zooms on maximum Von-Mises stress zones as identified for each hole in Fig. 22. A synthesis of results obtained on this case, with accuracy objectives 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            from 3% to 25%, is presented in Table 2
                           . All these results confirm conclusions made in Section  3.5.3 for single holes. Indeed, even if the accuracy objective is slightly exceeded in some cases, the general trend of results shows that using such a mesh sizing function allows “a priori” controlling the FEA error around stress concentration points for sets of holes in general, which is very powerful and very interesting. Table 3
                            presents statistics about meshes associated with results presented in Table 2. The quality of triangles is classically measured using  [43]:
                              
                                 (16)
                                 
                                    
                                       
                                          Q
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    α
                                    ⋅
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                
                                                   ins
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                
                                                   max
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    l
                                 
                                 
                                    
                                       max
                                    
                                 
                              
                            is the longest element edge and 
                              
                                 
                                    r
                                 
                                 
                                    
                                       ins
                                    
                                 
                              
                            radius of the inscribed circle. Taking 
                              α
                              =
                              2
                              ⋅
                              
                                 
                                    3
                                 
                              
                            makes that 
                              
                                 
                                    Q
                                 
                                 
                                    e
                                 
                              
                              =
                              1
                            for an equilateral element and 0 for degenerate elements.

@&#INTRODUCTION@&#

These examples demonstrate validity of the approach for 2D cases. In 3D, holes are either through or blind, which makes that more configurations should be investigated. Moreover, the ratio between hole radius and hole depth is likely to vary in 3D, for both blind and through holes, which is not the case in 2D. In general, 3D holes feature 3D effects that should be studied thoroughly in a specific extension of this work. However, even if more complex and more computationally demanding, the same methodology can be applied on 3D holes, which means deriving relationship between element size and FEA error estimate from reference cases and reference solutions.

In this section, we will show that, for through holes, the adaptation scheme presented in previous sections for 2D holes can be used as is for 3D holes without a huge loss in accuracy. For through holes in 3D, as shown in Fig. 25
                           , it is common knowledge that stress distribution along hole axis is not constant and that this 3D effect is strongly influenced by the ratio depth/diameter (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           ). When this ratio is low, 3D effect (stress variation along hole axis) can be neglected and when this ratio increases stress is lower at hole exit and entry than along it. For example if 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              10
                            if the stress concentration factor is 3 along hole axis it drops under 2.6 at hole exit and entry. However, the question of validity of our approach for through holes in 3D is not related to the fact that stress varies along hole axis but it is related to how steep this variation is. It appears that this stress variation is a lot smoother than stress variation due to the stress concentration effect. Consequently, we can expect that these 3D effects do not have a strong effect on the FEA error and that we are likely to reach the same accuracy targets applying the 2D adaptation scheme on 3D through holes.

@&#RESULTS@&#

We applied the 2D adaptation scheme on the 3D case shown in Fig. 26
                           (a) for 4 hole diameters 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            (1.5, 2 3 and 4 mm). As shown in the figure, material thickness, and by the way hole depth, is 4 mm for these 4 diameters (thus 
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                            is respectively 2.7, 2.0, 1.3 and 1.0). For symmetry reasons only one quarter of the 3D model has been considered in the FEA model and symmetry conditions have been applied on the 2 symmetry planes (see Fig. 26(b)). Fig. 26(b) illustrates the reference von Mises stress distribution obtained for 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                              
                              
                                 mm
                              
                           .

We first applied the 2D adaptation scheme on this 3D case with 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                              
                              
                                 mm
                              
                            (
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              /
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              2.0
                           ) using 5 accuracy targets 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                              ,
                              10
                              %
                              ,
                              15
                              %
                              ,
                              20
                              %
                            and 25%, which led to meshes illustrated in Fig. 27
                           .

Then, we can compute FEA results from these adapted meshes and then compute the actual error distribution 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                           . Note that, for the computation of 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            in 3D, the reference Von-Mises stress distribution 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       VM
                                    
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            is calculated from quadratic meshes that are not as refined as in 2D. In 3D we use a 0.032 mm element size instead of 0.025 mm in 2D. The reason is purely practical since, at this point, our computational capabilities do not allow us processing cases for which RAM memory required is more than 32 GB. Doing that is likely to affect results for which the minimum element size, after adaptation, is close the reference quadratic element size, which means for low values of the accuracy target 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                           . Consequently, we have limited our tests to accuracy targets between 5% and 25%. Fig. 28
                            illustrates 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            distributions for the 5 meshes illustrated in Fig. 27 (for respectively 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                              ,
                              10
                              %
                              ,
                              15
                              %
                              ,
                              20
                              %
                            and 25%). These distributions are compared with error distribution 
                              
                                 
                                    δ
                                 
                                 
                                    Z
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            as estimated using the Zhu–Zienkiewicz classical estimator  [44]. Note that for each accuracy target, the same color scale is used for 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            and 
                              
                                 
                                    δ
                                 
                                 
                                    Z
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            (between 0 and 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                           ). Of course, these two error distributions cannot be compared quantitatively since they are based on completely different principles. Moreover, 
                              
                                 
                                    δ
                                 
                                 
                                    Z
                                    Z
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            is constant per element, which is not the case for 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                           . However, the interesting aspect of this comparison is that these two error distributions are similar and that, for both distributions, the maximum error zone is not located at concentration points but in very low stress zones.

In Fig. 29
                           , we finally illustrate meshes and 
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            distributions obtained for the 3 other hole diameters with 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                           .

A synthesis of results obtained for the maximum error along the stress concentration line 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       max
                                    
                                 
                                 
                                    i
                                 
                              
                            is provided in Table 4
                           . Note that 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       VM
                                    
                                 
                                 
                                    i
                                 
                              
                            maximum values included in Table 4 are taken along this line. As assumed in the introduction, these results confirm that, for these cases, 3D effects do not have a very strong effect on the FEA error and that reasonably good accuracy targets are reached applying the 2D adaptation scheme on these through holes in 3D. Note that we have provided results for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                            even if these results can clearly be discussed since the minimum element size for these examples is too close to quadratic mesh size used for the computation of reference Von-Mises stress distributions 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ̃
                                       
                                    
                                 
                                 
                                    
                                       VM
                                    
                                 
                              
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                           . For example, when 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                           , minimum element sizes for 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                              ,
                              5
                              
                              
                                 mm
                              
                            and 
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                              
                              
                                 mm
                              
                            are respectively 0.033 mm and 0.043 mm which is too close to the reference element size (0.032 mm as explained above). Of course, as introduced in 3.6.1, this does not mean that our 2D adaptation scheme can be applied, as is in general. For 3D through holes, applying in 3D the whole methodology as presented in this paper, should lead to a little more accurate results than those obtained by applying the 2D adaptation scheme on 3D cases. As introduced in Section  5, for blind holes and for other types of features in general, this methodology still applies but it needs to be applied separately for each type of feature to derive feature specific adaptation schemes.

@&#INTRODUCTION@&#

As introduced in Section  2.4.2 and following similar concepts as presented in  [29], the practical implementation of the size map 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is based on using sets of source entities. Moreover, before being used by automatic mesh generation procedure, it is saved on a background mesh. Indeed, a huge number of calls to the size map computation are made along automatic mesh generation and consequently, these calls must be as fast as possible, while controlling accuracy in the representation of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        . This avoids computing the size map the way it is presented in Section  3.5.4 at each call and justifies using a background mesh.

Source entities used in our work are based on similar concepts as presented in  [29]. At this point of our implementation, we only use points as source entities. This means that if adaptation needs to be performed around an analysis feature 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         in general, sets of source points need to be generated along (for an edge) or along and across (for a face) or inside (for a volume) analysis feature 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        . This process is referred to as sampling sets of source entities 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         (source points in our case) on an analysis feature 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        . Like in  [29], each source point 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         is associated with an influence zone around it (a sphere defined by a scope radius in  [29]) and a sizing function inside this influence zone. In this work, a source point 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         is associated with a cubic influence zone around it (the source point is located at the center) instead of a sphere for CPU time minimization.

Source point 
                           
                              
                                 S
                              
                              
                                 j
                              
                           
                         is associated with: 
                           
                              •
                              a target size at location 
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                  noted 
                                    
                                       
                                          
                                             
                                                E
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          s
                                       
                                       
                                          j
                                       
                                    
                                 
                              

an influence distance (half length of the cube) from source point 
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                 , noted 
                                    
                                       
                                          r
                                       
                                       
                                          s
                                       
                                       
                                          j
                                       
                                    
                                 
                              

a curvature of the sizing function around 
                                    
                                       
                                          S
                                       
                                       
                                          j
                                       
                                    
                                  (see Fig. 30
                                 ), noted 
                                    
                                       
                                          c
                                       
                                       
                                          s
                                       
                                       
                                          j
                                       
                                    
                                 .

As shown in Fig. 30, this variation is non-linear in general and it is expressed using the form 
                           E
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    j
                                 
                              
                              )
                           
                           =
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                              
                                 j
                              
                           
                           .
                           f
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . In general, 
                           f
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    s
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         is aimed at fitting as accurately as possible with the non-linear specification of 
                           
                              
                                 E
                              
                              
                                 
                                    
                                    
                                       A
                                    
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              d
                              )
                           
                        . In this work, curvature parameter 
                           
                              
                                 c
                              
                              
                                 s
                              
                              
                                 j
                              
                           
                         is computed using a classical least-square minimization process.

Source points, along with associated influence zones and sizing functions, as introduced in the previous paragraph, represent the basic tool for locally refining 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         around analysis features. The way these source points are defined allows refining the size map with respect to any type of variation, particularly by adjusting parameter 
                           
                              
                                 c
                              
                              
                                 s
                              
                              
                                 j
                              
                           
                        . Adaptation of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         around a given analysis feature 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         requires sampling source points around 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         (Fig. 31
                        ). Fig. 31(b) presents an example of sampling around a hole and a fillet. For a given analysis feature 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        , the distribution of sample points and associated data are thoroughly adjusted so that the resulting adaptation accurately fits 
                           
                              
                                 E
                              
                              
                                 
                                    
                                    
                                       A
                                    
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              d
                              )
                           
                         and that 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         around 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                         is as smooth as possible. Indeed, if sampling is not dense enough around 
                           
                              
                                 A
                              
                              
                                 i
                              
                           
                        , 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         tends to oscillate between sample points. Thus, sampling is automatically adjusted so that these oscillations are limited and controlled. This is practically achieved by overlapping the influence zones of neighboring source points as shown in Fig. 31(c) for two neighboring source points.

Once source points generated around analysis features, 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is computed as follows:

If 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is not inside the influence zone of a source point, then 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                           =
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 g
                              
                           
                        .

If 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is inside the influence zones of 
                           N
                         source points 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                         (with 
                           k
                           =
                           1
                             to  
                           N
                        ) and if 
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is the target size variation around source point 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                        , then:


                        
                           
                              
                                 E
                              
                              
                                 k
                              
                           
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                           =
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 s
                              
                              
                                 k
                              
                           
                           ⋅
                           f
                           
                              (
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    s
                                 
                                 
                                    k
                                 
                              
                              )
                           
                         where 
                           
                              
                                 r
                              
                              
                                 k
                              
                           
                         is the distance between source point 
                           
                              
                                 S
                              
                              
                                 k
                              
                           
                         and location 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         and 
                           
                              (17)
                              
                                 E
                                 
                                    (
                                    x
                                    ,
                                    y
                                    ,
                                    z
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             4
                                          
                                       
                                       ⋅
                                       
                                          
                                             min
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       ⋅
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             g
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   E
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             s
                                          
                                          
                                             k
                                          
                                       
                                       ⋅
                                       f
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             4
                                          
                                       
                                       ⋅
                                       
                                          
                                             min
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             1
                                          
                                          
                                             N
                                          
                                       
                                       f
                                       
                                          (
                                          
                                             
                                                r
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                c
                                             
                                             
                                                s
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                    
                                 
                                 .
                              
                           
                         The form of this equation comes from concepts introduced in Ref.  [18].

This computation of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         from source points could theoretically be used as is but it is too costly on CPU time. Consequently, the last step in the definition of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is saving it on a background mesh. In this work, we used a regular grid as background mesh (see Fig. 32
                        (b)). This regular grid is based on the bounding box around the part (Fig. 32(a)). Note that using an octree based background mesh could also have been considered like in the work of Tchon et al. and others  [32,33]. Another option is using an unstructured mesh. Indeed, using an Octree or an unstructured mesh allows minimizing the storage of the sizing function. Since this is not a specific objective in this work, we considered the simplest solution for storing 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        . As shown in Fig. 32(b), the bounding box around the part is equally divided into 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                         cells respectively along 
                           x
                        , 
                           y
                         and 
                           z
                         axes. Since cells of the grid are considered as linear hexahedral elements (8 nodes), the background mesh features 
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    x
                                 
                              
                              +
                              1
                              )
                           
                           .
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    y
                                 
                              
                              +
                              1
                              )
                           
                           .
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    z
                                 
                              
                              +
                              1
                              )
                           
                         nodes. Values of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         at each of these nodes are computed from Eq. (15). These values are noted 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 k
                              
                           
                         (with 
                           i
                           =
                           0
                           …
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                        , 
                           j
                           =
                           0
                           …
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                         and 
                           k
                           =
                           0
                           …
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                        ). This background mesh, along with nodal values 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        , is then saved as a file. Once saved, this file alone allows computing 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         at any location 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        . This is done by first identifying the cell of the background mesh (Fig. 32(c)) inside which 
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         is located and by interpolating 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         from the 8 nodal values 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 k
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 +
                                 1
                                 j
                                 k
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 +
                                 1
                                 k
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 k
                                 +
                                 1
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 +
                                 1
                                 j
                                 +
                                 1
                                 k
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 +
                                 1
                                 j
                                 k
                                 +
                                 1
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 j
                                 +
                                 1
                                 k
                                 +
                                 1
                              
                           
                        , 
                           
                              
                                 E
                              
                              
                                 i
                                 +
                                 1
                                 j
                                 +
                                 1
                                 k
                                 +
                                 1
                              
                           
                        .

It must be pointed out that this representation of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        , based on source points and a background mesh, is approximate. Of course, 
                           
                              
                                 N
                              
                              
                                 x
                              
                           
                        , 
                           
                              
                                 N
                              
                              
                                 y
                              
                           
                         and 
                           
                              
                                 N
                              
                              
                                 z
                              
                           
                         values and source point sampling can both be adjusted for controlling accuracy in this representation of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                        . It remains that, using a regular grid as background mesh is not optimal with respect to memory usage. Using an unstructured mesh or octrees as background mesh is a well-known alternative when trying to make a good compromise between accuracy in the representation of 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         and memory usage.


                        Fig. 33
                        (a) presents the 2D size map associated with one of the validation examples shown in Section  3.5.5, in the case of multiple circular holes (for 
                           
                              
                                 δ
                              
                              
                                 
                                    target
                                 
                              
                              
                                 i
                              
                           
                           =
                           3
                           %
                        ). 20 sample points are used on each hole and the background mesh features 100 × 100 cells. The minimum mesh size (
                           0.039
                           
                           
                              mm
                           
                        ) is specified around hole number 3 since it is the smallest and target size outside all adaptation zones is 
                           
                              
                                 
                                    
                                       E
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 g
                              
                           
                           =
                           0.663
                           
                           
                              mm
                           
                        . Fig. 33(b) shows the mesh generated from this size map and used for validation in Section  3.5.5. Note that, due to using a regular grid that covers both meshed and unmeshed zones, and due to the fact that sample points influence the size map in all directions, the size map in Fig. 33(a) varies inside each hole whereas these zones are not meshed.

It is mentioned in the previous section that there is an obvious limitation that cannot be avoided in the respect of target size 
                           E
                           
                              (
                              x
                              ,
                              y
                              ,
                              z
                              )
                           
                         by the mesh generation process itself. Fig. 34
                         quantifies this aspect of a priori mesh adaptation in the case of the mesh presented in Fig. 33(a). Fig. 34 shows the relative difference (in %) between the target size distribution as imposed to the mesh generation process and the actual size obtained after meshing. This image shows that even if the target size is globally respected, there are local differences (in this case up to 41%) between imposed and actual size maps that cannot be avoided.

We applied the adaptation scheme presented in this paper to a first part (see Fig. 35
                           (a)) for which two subsequent accuracy objectives are considered (15% and 5%). Analysis features are first identified and source points are automatically generated on these features (in this case 4 circular through holes and 4 circular blind holes) as shown in Fig. 35(b). As introduced in Section  3.6.2, it is important to note that, in this adaptation, the 2D adaptation scheme is applied, as is, on 3D examples, even for blind holes. It is not a problem since the focus here is only on generating, saving and respecting the size map and not on FEA results in itself.

Once sets of source points are generated around all analysis features, the resulting size map 
                              E
                              
                                 (
                                 x
                                 ,
                                 y
                                 ,
                                 z
                                 )
                              
                            is calculated and saved as explained in the previous section. In Fig. 36
                           (a) the size map is presented along with the corresponding mesh (Fig. 36(b)) for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                            around the 8 holes. In this figure, the size map is shown without and with a cutting plane applied to see its distribution inside the material. Then, the same part is processed with 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                            around the 8 holes and the result is shown in Fig. 37
                           . Comparison between size maps obtained for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                            (Fig. 36(a)) and for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                            (Fig. 37(a)) confirms the conclusions made in Section  3.4.2. The size map for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                            features a much smoother distribution since it is essentially linear and based on gradient limitation. The size map for 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              5
                              %
                            features steeper variations since it is based on a combination between linear and non-linear laws.

Then, we have applied our mesh adaptation scheme to a second 3D part (see Fig. 38
                           (a)). This part features 16 circular holes with varying diameters on which source points are automatically generated as illustrated in Fig. 38(b). In this case, the accuracy objective is 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                              =
                              15
                              %
                            for all holes and the result obtained is shown in Fig. 39
                           .

Like in 2D, there are differences between imposed and size maps that cannot be avoided. Fig. 40
                            shows the relative difference (in %) between the target size distribution as imposed to the mesh generation process (Fig. 39(a)) and the actual size obtained after meshing. Here again, the target size is globally respected but local differences (in this case up to 50%) between imposed and actual size maps are obtained and cannot be avoided. This obviously induces negative effects on the accuracy of FEA results. Combined with the fact that element quality has also limitations that are inherent to automatic mesh generation processes, it makes that FEA accuracy target 
                              
                                 
                                    δ
                                 
                                 
                                    
                                       target
                                    
                                 
                                 
                                    i
                                 
                              
                            is likely to be slightly overcome in some cases.

We have started investigating the potential extension of concepts proposed in the previous paragraphs to other types of features. We indeed wondered whether linearity between 
                           
                              
                                 δ
                              
                              
                                 
                                    th
                                 
                              
                              
                                 
                                    ref
                                 
                              
                           
                         and 
                           
                              
                                 E
                              
                              
                                 
                                    ref
                                 
                              
                           
                         at stress concentration points, as observed for circular holes, is still verified. Thus, we apply the methodology presented in the previous sections to the case of a notched plate. This notched plate with the Von-Mises stress distribution obtained for the reference mesh is shown in Fig. 41
                        . Then, as for plates with a circular hole, sets of simulations are performed using various mesh sizing with the objective of fulfilling target values for 
                           
                              
                                 δ
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              1
                              )
                           
                        . Fig. 42
                         shows the evolution of 
                           
                              |
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 1
                                 )
                              
                              |
                           
                         with 
                           
                              
                                 E
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              1
                              )
                           
                         for this first notched plate. This result clearly confirms that the relationship between element size at the stress concentration point and FEA error estimate is also linear.

The same methodology is then applied to a second notched plate, for which the notch width is increased. This second notched plate with the Von-Mises stress distribution obtained for the reference mesh is shown in Fig. 43
                        . Then, as for the previous features, sets of simulations are performed using various mesh sizing. Fig. 44
                         shows the evolution of 
                           
                              |
                              
                                 
                                    δ
                                 
                                 
                                    
                                       ref
                                    
                                 
                              
                              
                                 (
                                 2
                                 )
                              
                              |
                           
                         with 
                           
                              
                                 E
                              
                              
                                 
                                    ref
                                 
                              
                           
                           
                              (
                              2
                              )
                           
                         for this second notched plate. Here again, we obtain a near to perfect linearity between element size at the concentration point and FEA error estimate at this point.

@&#CONCLUSION@&#

This paper presents a method that allows “a priori” adapting FEA meshes with quantitative accuracy objectives around circular holes. In some cases (especially in early design stages) this approach can be successfully used as an alternative to a posteriori mesh adaptation. In other cases it can be used as a preliminary mesh adaptation that will make that the iterative a posteriori mesh adaptation process will converge much faster. In all contexts, this additional tool is likely to allow performing more accurate FEA simulations in less time. Though a promising first step, this work requires significant additional work. As introduced in Section  3.6, studying the influence of 3D effects in stress distributions around circular holes in 3D is a first natural perspective of future work. The extension to other types of features, as introduced in the previous section, is another natural enhancement. While it is not necessarily a big challenge for simple features like notches and fillets, for which the same scheme as used here for circular holes can be applied, it may be more delicate to extend it to more complicated features.

We started working towards another important enhancement of the method, which is taking into account loads and boundary conditions in the a priori adaptation process. Indeed, as explained in Section  2.3, the same analysis feature is, or is not, the source of stress concentration, depending on the way this feature is loaded. Moreover, as shown for a circular hole in Fig. 45
                     , knowledge of the direction along which a given geometric feature is loaded is likely to allow a more localized, and, by the way, a more efficient mesh adaptation. In Fig. 45(a), load direction is along the hole axis which makes that no adaptation is required. In Fig. 45(b) adaptation is required but it is applied everywhere around the hole, like it is the case in the method presented in this paper, while the ideal process would be to use load direction to localize mesh refinement at concentration points like in Fig. 45(c) and (d).

Taking into account interactions between multiple features and interactions with boundaries is another subject of interest with respect to this work. Indeed, in the work as presented here, assumption is made that there is neither mutual influence between neighboring holes nor influence of the boundaries. If 2 (or more) holes are close enough or if holes are close to boundaries, it may have a significant impact on stress distribution and by the way on FEA error. Calculating vicinity with other holes and boundaries and talking it into account in mesh adaptation can be foreseen but requires important further investigation.

A last potential extension of the approach is investigating the use of anisotropic meshes. Indeed, since the second derivative of theoretical Von-Mises stress around a circular hole is not radially symmetric, using the load direction, along with an anisotropic mesh sizing function, is likely to bring about further optimization in the distribution of nodes and elements. Finally, the extension of this work to a posteriori mesh adaptation is also of some interest. We have seen in the introduction that one important drawback of a posteriori mesh adaptation is that it refines the mesh in zones where it does not need to be refined. Thorough analysis of geometry and loading, which is the basic idea underlying a priori mesh adaptation, could also successfully be applied with the objective of discriminating zones that should, or should not, be affected by the a posteriori mesh adaptation process.

@&#ACKNOWLEDGMENTS@&#

This study was carried out as part of a project supported by the Natural Sciences and Engineering Research Council of Canada (NSERC) (RPGIN/170335-2008) and UQTR foundation. In this paper we use Gmsh™  [45] for visualizing meshes, size maps and error distributions.

@&#REFERENCES@&#

