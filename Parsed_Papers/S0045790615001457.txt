@&#MAIN-TITLE@&#FPGA based accelerated 3D affine transform for real-time image processing applications

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           In the proposed algorithm, simultaneously 4 pixel/voxel locations can be transformed to compute AT of the entire image.


                        
                        
                           
                           The proposed architecture requires only relevant frames instead of all the frames simultaneously.


                        
                        
                           
                           The faster implementation of the affine transform is useful during image registration of the 3D bio-medical images.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Biomedical image processing

3D affine transform

Real-time

Hardware

@&#ABSTRACT@&#


               
               
                  Affine Transform (AT) is widely used in high-speed image processing systems. This transform plays an important role in various high-speed image processing applications. AT, an important process during the intensity-based image registration, is applied iteratively during the registration. This is also used for the analysis of the interior of an organ and to get a better view of the organs from various angles in 3D coordinate system. Hence, for real-time medical image registration and visualization of the acquired volumetric images, acceleration of AT is very much sought for. In this paper, a parallel and pipelined architecture of the proposed AT algorithm has been presented. This will accelerate the transform process and reduce the processing time of medical image registration. The architecture is mapped in Field-Programmable Gate Array (FPGA) for prototyping and verification. The results show that the computational complexity of the proposed parallel algorithm is almost 4 times better than that of the conventional algorithm.
               
            

@&#INTRODUCTION@&#

AT consists of various operations such as rotation, scaling, shearing and translation. This algorithm is highly computationally intensive as it involves matrix multiplication of trigonometric functions and interpolation. In high-speed imaging systems, AT plays an important role. The transform is applied on each and every pixel location of the image to obtain a transformed image. Hence, the computation time of the transformation also increases along with the size of the image. A parallel algorithm will help in faster processing of the transform and this will led to faster implementation of the high-speed imaging systems. Image registration is the process of overlaying two or more images of the same scene taken at different times from different viewpoints and/or by different sensors. It geometrically aligns two images called the reference image and sensed image [1]. AT is widely used for geometric alignment during image registration [2–4]. During the process of mapping points from one image to the corresponding points in another image, correct alignment of images is obtained iteratively [5]. The basic operations of any registration algorithm are the image rotation and shifting methods [6]. These are possible by applying AT on the 3D image [7]. These operations must be carried out several times for image registration [5,7–9]. The time spent in measuring is negligible compared to that of the transformation. On the CPU, the execution time is dominated by the transform [10]. A real-time implementation of image registration is required [6,11,12]. So, a fast technique for AT of 3D images is needed. Table 1
                      shows computation offered by different operations during image registration [10]. In computer graphics, 3D object is represented and displayed using polygon mesh model [10]. A polygon mesh model is a structure consisting of polygons represented by a list of coordinates called as polygon vertices. Thus the information stored to describe an object is a list of points or vertices [11]. But in medical imaging systems such as Computed Tomography (CT), an image is produced by physical measures such as X-ray absorption which has to be converted to 3D data by a mathematical reconstruction process. So, in the case of display of CT images, the data has to be stored as a 3D array of image elements called voxel. Each voxel contains a value that describes the material properties at its location. The volume data sets are acquired and pre-processed before display.

Most of the previous researchers have put more emphasis on affine rotation. However, other operations of AT are used as well in medical image processing [13]. In implementing a rotation operation, non-separable and separable rotation methods are used. A separable rotation method decomposes the rotation into two or more 1D transformation along X and Y directions. There are several decompositions such as two-pass [14] and three-pass algorithms for 2D images. For 3D AT, several authors have also proposed separable rotations such as two-pass or three-pass algorithms which are nothing but shear based decompositions of the rotation operations [15–17]. Though, the separable rotation method reduces the use of memory, it also increases artefacts and computational complexity. In non-separable implementation, people have designed application specific chip for image rotation using CORDIC (acronym for Coordinate Rotation DIgital Computer) algorithm [18]. A multiplication free algorithm for 2D images has been proposed which uses the relationship between two neighboring pixels [19]. A similar algorithm named AT by Removing Multiplications (ATRM) has also been proposed [20]. A new idea of combining back-projection and interpolation into a single step has been proposed by Fischer and del Río [21]. In this method the basic idea is to employ a 3D Bresenham line interpolation algorithm while simultaneously traversing its back-projection in the original volume. In [22], a new fast algorithm has been proposed which calculates AT of two voxel locations using a single transform operation. The algorithm exploits the relation between two voxel positions by shifting the origin (0, 0, 0) to the center slice of the image. This helps in reducing the computations in terms of matrix multiplications to obtain the AT of a 3D image.

In this paper, a complete hardware solution of our previously published algorithm [23] is presented. The algorithm in [23] was the modified version of our work [22,24]. For the registration of functional MRI, only small rotations and translations: 1–2° and 1–2 voxel dimensions are generally required [6]. So, without storing the complete image, transform operation can be performed by storing only some relevant frames of the image to minimize memory requirement. Moreover, this proposed modified algorithm is able to calculate AT of four voxel locations by performing a single transformation. This helps in further reducing the computations in terms of number of multiplications and also increasing the parallelism of the algorithm. The inherent parallelism of this algorithm reduces the hardware resources during implementation of the algorithm.

The paper is organized as follows. Mathematical analysis of the proposed algorithm is explained in Section 2. Section 3 furnishes the detailed architectural design of the proposed algorithm. Image quality comparison is made between the proposed algorithm and conventional one as well as Verilog simulation results are discussed in Section 4. Finally, the paper is concluded in Section 5.

The AT consists of four operations i.e. rotation, scaling, shearing and translation. All the operations of the 3D AT can be expressed by Eq. (1). However, to perform all operations with respect to the centre voxel location Eq. (1) is modified to Eq. (2). For different operations of AT the value of 
                        
                           
                              
                                 m
                              
                              
                                 ij
                              
                           
                        
                      only changes.
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      11
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      12
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      13
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      21
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      22
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      23
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      31
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      32
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      33
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             
                                                q
                                             
                                          
                                          
                                             
                                                r
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (2)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      q
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      r
                                                   
                                                   
                                                      3
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      11
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      12
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      13
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      21
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      22
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      23
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      31
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      32
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      33
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      z
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ×
                              
                                 
                                    
                                       
                                          
                                             
                                                p
                                                -
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      cent
                                                   
                                                
                                             
                                          
                                          
                                             
                                                q
                                                -
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      cent
                                                   
                                                
                                             
                                          
                                          
                                             
                                                r
                                                -
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      cent
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      cent
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Y
                                                   
                                                   
                                                      cent
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      cent
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 X
                              
                              
                                 cent
                              
                           
                           ,
                           
                              
                                 Y
                              
                              
                                 cent
                              
                           
                        
                      and 
                        
                           
                              
                                 Z
                              
                              
                                 cent
                              
                           
                        
                      are centre coordinates of the image.

Due to shifting of the centre of the image, each voxel location has symmetry position in the image. By exploiting the replication nature of the pixel locations, the ATPR (acronym for Affine Transform by Pixel Replication) algorithm [22] was able to calculate transform of 2 pixel locations in parallel. In this paper, an algorithm named Modified ATPR (MATPR) is proposed which can calculate transform of 4 voxel locations from a single transformation operation. Here, 3D image is taken frame by frame as a 2D image and the transform is applied on that frame. The proposed algorithm is explained mathematically as follows.
                        
                           (3)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                          =
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                13
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          offset
                                          (
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                          =
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                23
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                          =
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                33
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                z
                                             
                                          
                                          +
                                          offset
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           offset
                           (
                           1
                           )
                           =
                           
                              
                                 X
                              
                              
                                 cent
                              
                           
                        
                      , 
                        
                           offset
                           (
                           2
                           )
                           =
                           
                              
                                 Y
                              
                              
                                 cent
                              
                           
                        
                      and 
                        
                           offset
                           (
                           3
                           )
                           =
                           
                              
                                 Z
                              
                              
                                 cent
                              
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                    
                                       
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                11
                                             
                                          
                                          ×
                                          x
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                12
                                             
                                          
                                          ×
                                          y
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                21
                                             
                                          
                                          ×
                                          x
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                22
                                             
                                          
                                          ×
                                          y
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          =
                                          
                                             
                                                m
                                             
                                             
                                                31
                                             
                                          
                                          ×
                                          x
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                31
                                             
                                          
                                          ×
                                          y
                                       
                                    
                                 
                              
                           
                        
                     AT of pixel with coordinate 
                        
                           (
                           -
                           x
                           ,
                           -
                           y
                           ,
                           z
                           )
                        
                      is
                        
                           (5)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          ,
                                          z
                                          )
                                          =
                                          u
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                13
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          offset
                                          (
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          ,
                                          z
                                          )
                                          =
                                          v
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                23
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          ,
                                          z
                                          )
                                          =
                                          w
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                33
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                z
                                             
                                          
                                          +
                                          offset
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       
                                          u
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          )
                                          =
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                11
                                             
                                          
                                          ×
                                          x
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                12
                                             
                                          
                                          ×
                                          y
                                          =
                                          -
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          v
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          )
                                          =
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                21
                                             
                                          
                                          ×
                                          x
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                22
                                             
                                          
                                          ×
                                          y
                                          =
                                          -
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          w
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          )
                                          =
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                31
                                             
                                          
                                          ×
                                          x
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                32
                                             
                                          
                                          ×
                                          y
                                          =
                                          -
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          )
                                       
                                    
                                 
                              
                           
                        
                     Hence, while computing the AT of voxel with coordinate 
                        
                           (
                           x
                           ,
                           y
                           ,
                           z
                           )
                        
                     , the AT of the voxel with coordinate 
                        
                           (
                           -
                           x
                           ,
                           -
                           y
                           ,
                           z
                           )
                        
                      can be obtained without any additional multiplication operation. AT of two more voxels are computed at the same time by performing only nine multiplications instead of eighteen.

AT of voxel with coordinate 
                        
                           (
                           x
                           ,
                           y
                           +
                           offset
                           (
                           2
                           )
                           ,
                           z
                           )
                        
                      is
                        
                           (7)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          ,
                                          z
                                          )
                                          =
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                13
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          offset
                                          (
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          ,
                                          z
                                          )
                                          =
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                23
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          ,
                                          z
                                          )
                                          =
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                33
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                z
                                             
                                          
                                          +
                                          offset
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           (8)
                           
                              
                                 
                                    
                                    
                                       
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          =
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                12
                                             
                                          
                                          ×
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          =
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                22
                                             
                                          
                                          ×
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          +
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          =
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                31
                                             
                                          
                                          ×
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              
                           
                        
                     AT of voxel with coordinate 
                        
                           (
                           -
                           x
                           ,
                           -
                           y
                           -
                           offset
                           (
                           2
                           )
                           ,
                           z
                           )
                        
                      is
                        
                           (9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          ,
                                          z
                                          )
                                          =
                                          u
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                13
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                x
                                             
                                          
                                          +
                                          offset
                                          (
                                          1
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          ,
                                          z
                                          )
                                          =
                                          v
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                23
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                y
                                             
                                          
                                          +
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          ,
                                          z
                                          )
                                          =
                                          w
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          +
                                          
                                             
                                                m
                                             
                                             
                                                33
                                             
                                          
                                          ×
                                          z
                                          +
                                          
                                             
                                                t
                                             
                                             
                                                z
                                             
                                          
                                          +
                                          offset
                                          (
                                          3
                                          )
                                       
                                    
                                 
                              
                           
                        
                     where
                        
                           (10)
                           
                              
                                 
                                    
                                    
                                       
                                          u
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          =
                                          -
                                          u
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                12
                                             
                                          
                                          ×
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          v
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          =
                                          -
                                          v
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                22
                                             
                                          
                                          ×
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          w
                                          (
                                          -
                                          x
                                          ,
                                          -
                                          y
                                          -
                                          offset
                                          (
                                          2
                                          )
                                          )
                                          =
                                          -
                                          w
                                          (
                                          x
                                          ,
                                          y
                                          )
                                          -
                                          
                                             
                                                m
                                             
                                             
                                                31
                                             
                                          
                                          ×
                                          offset
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              
                           
                        
                     Hence, the AT of 4 voxel locations are obtained from the AT of only one voxel location with some extra addition operations. In this way, the computation reduces by a factor of four to get the AT of the entire image. The proposed MATPR algorithm, explained below, is a good proposition for VLSI implementation due to its inherent parallelism and regularity.


                        
                           
                              1.
                              Input the image size and transform parameters. /∗L
                                 
                                 =
                                 
                                 No. of rows, M
                                 
                                 =
                                 
                                 No. of columns and N
                                 
                                 =
                                 
                                 No. of frame. The symbols 
                                 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             11
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             12
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             13
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             21
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             22
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             23
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             31
                                          
                                       
                                    
                                  , 
                                    
                                       
                                          
                                             m
                                          
                                          
                                             32
                                          
                                       
                                       ,
                                       
                                          
                                             m
                                          
                                          
                                             33
                                          
                                       
                                    
                                  , 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             y
                                          
                                       
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             z
                                          
                                       
                                    
                                  
                                 are transform parameters and Q is the transformed image∗/
                              

calculate offset:


                                 
                                    
                                       (
                                       offset
                                       (
                                       1
                                       )
                                       ,
                                       offset
                                       (
                                       2
                                       )
                                       ,
                                       offset
                                       (
                                       3
                                       )
                                       )
                                       =
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             cent
                                          
                                       
                                       ,
                                       
                                          
                                             Y
                                          
                                          
                                             cent
                                          
                                       
                                       ,
                                       
                                          
                                             Z
                                          
                                          
                                             cent
                                          
                                       
                                       )
                                    
                                 
                              

Calculate constant parameter:


                                 
                                    
                                       
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       offset
                                       (
                                       2
                                       )
                                       ×
                                       
                                          
                                             m
                                          
                                          
                                             12
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       offset
                                       (
                                       2
                                       )
                                       ×
                                       
                                          
                                             m
                                          
                                          
                                             22
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             3
                                          
                                       
                                       =
                                       offset
                                       (
                                       3
                                       )
                                       ×
                                       
                                          
                                             m
                                          
                                          
                                             32
                                          
                                       
                                    
                                  and 
                                    
                                       (
                                       
                                          
                                             e
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             e
                                          
                                          
                                             3
                                          
                                       
                                       )
                                       =
                                       (
                                       offset
                                       (
                                       1
                                       )
                                       ,
                                       offset
                                       (
                                       2
                                       )
                                       ,
                                       offset
                                       (
                                       3
                                       )
                                       )
                                       +
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             x
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             y
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             z
                                          
                                       
                                       )
                                    
                                 .


                                 
                                    
                                       x
                                       =
                                       -
                                       
                                          
                                             L
                                             -
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                  to 0


                                 
                                    
                                       y
                                       =
                                       -
                                       
                                          
                                             M
                                             -
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                  to 0


                                 
                                    
                                       z
                                       =
                                       -
                                       
                                          
                                             N
                                             -
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                  to 
                                    
                                       
                                          
                                             N
                                             -
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              


                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                      =
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      ,
                                                      w
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            23
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            33
                                                         
                                                      
                                                      ×
                                                      z
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      )
                                                      =
                                                      -
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      ,
                                                      w
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            23
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            33
                                                         
                                                      
                                                      ×
                                                      z
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                      =
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      ,
                                                      w
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            23
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            33
                                                         
                                                      
                                                      ×
                                                      z
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            q
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            4
                                                         
                                                      
                                                      )
                                                      =
                                                      -
                                                      (
                                                      u
                                                      ,
                                                      v
                                                      ,
                                                      w
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            13
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            23
                                                         
                                                      
                                                      ×
                                                      z
                                                      ,
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            33
                                                         
                                                      
                                                      ×
                                                      z
                                                      )
                                                      +
                                                      (
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            e
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                      -
                                                      (
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            k
                                                         
                                                         
                                                            3
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                 /∗
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             1
                                          
                                       
                                       )
                                       ,
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             2
                                          
                                       
                                       )
                                       ,
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             3
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             3
                                          
                                       
                                       )
                                    
                                 , and 
                                 
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             4
                                          
                                       
                                       )
                                    
                                  
                                 are Affine Transform of voxel locations 
                                 
                                    
                                       (
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                       )
                                       ,
                                       (
                                       -
                                       x
                                       ,
                                       -
                                       y
                                       ,
                                       z
                                       )
                                       ,
                                       (
                                       x
                                       ,
                                       y
                                       +
                                       offset
                                       (
                                       2
                                       )
                                       ,
                                       z
                                       )
                                    
                                  
                                 and 
                                 
                                    
                                       (
                                       -
                                       x
                                       ,
                                       -
                                       y
                                       -
                                       offset
                                       (
                                       2
                                       )
                                       ,
                                       z
                                       )
                                    
                                  
                                 respectively.∗/

If 
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                  is within the source image then apply interpolation on voxels close to 
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             q
                                          
                                          
                                             u
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             u
                                          
                                       
                                       )
                                    
                                 
                              

Pixval u
                                 =new voxel value after interpolation.

Where u
                                 =1 to 4
                                    
                                       
                                          
                                             
                                                
                                                
                                                   
                                                      Q
                                                      [
                                                      x
                                                      +
                                                      offset
                                                      (
                                                      1
                                                      )
                                                      ,
                                                      y
                                                      +
                                                      offset
                                                      (
                                                      2
                                                      )
                                                      ,
                                                      z
                                                      +
                                                      offset
                                                      (
                                                      3
                                                      )
                                                      ]
                                                      =
                                                      pixval
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      Q
                                                      [
                                                      -
                                                      x
                                                      +
                                                      offset
                                                      (
                                                      1
                                                      )
                                                      ,
                                                      -
                                                      y
                                                      +
                                                      offset
                                                      (
                                                      2
                                                      )
                                                      ,
                                                      z
                                                      +
                                                      offset
                                                      (
                                                      3
                                                      )
                                                      ]
                                                      =
                                                      pixval
                                                      2
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      Q
                                                      [
                                                      x
                                                      +
                                                      offset
                                                      (
                                                      1
                                                      )
                                                      ,
                                                      y
                                                      +
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      offset
                                                      (
                                                      2
                                                      )
                                                      ,
                                                      z
                                                      +
                                                      offset
                                                      (
                                                      3
                                                      )
                                                      ]
                                                      =
                                                      pixval
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                
                                                   
                                                      Q
                                                      [
                                                      -
                                                      x
                                                      +
                                                      offset
                                                      (
                                                      1
                                                      )
                                                      ,
                                                      -
                                                      y
                                                      -
                                                      
                                                         
                                                            M
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                      +
                                                      offset
                                                      (
                                                      2
                                                      )
                                                      ,
                                                      z
                                                      +
                                                      offset
                                                      (
                                                      3
                                                      )
                                                      ]
                                                      =
                                                      pixval
                                                      4
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

End if

End for

End for

End for

The MATPR algorithm, explained in Section 2, has been implemented in FPGA. The architectural block diagram of the complete system is shown in Fig. 1
                     . According to the size of the input image, the coordinate generator unit generates values of x, y and z which are connected as inputs to the coordinate transformation unit.

The coordinate generator unit consists of a cascaded counter. The input selection unit generates the transform parameters according to the 2-Bit Input selector signal. Among the four combinations, three are used to select the parameters, which are obtained from the LUT for different rotations, and one is for the rest of the operations of the AT. Both the cosine and sine values of all angles are stored in the LUT in a single address location. The Affine Transformation as mentioned in Eq. (2) is performed by the coordinate transformation unit. The transformed coordinates may fall outside the image. The coordinate checker unit checks the coordinate value to ignore the particular coordinate if it falls outside the range of the image. Each unit of the block diagram is explained in detail in the following sections.

A 3D image can be rotated with respect to 
                           
                              X
                              ,
                              Y
                           
                         and Z axes. The AT parameters are different for rotation with respect to each axis. Hence, to store the rotation parameters, three LUTs i.e. LUT0, LUT1 and LUT2 have been used for rotation with respect to 
                           
                              X
                              ,
                              Y
                           
                         and Z axes respectively. For rotation operation, nine parameters are used. For any angle ‘
                           
                              θ
                           
                        ’, all the nine parameters are pre-computed and stored in the same location of the LUT. To store each parameter, 11 bits have been considered with 9 fractional bits. So, every location of the LUT is of 99 bits. For other operations except rotation, affine parameters are passed from the input directly. An input selection circuit is used to select the elements those make up the transformation matrix for input to the coordinate transformation unit depending upon the input selector as mentioned in Table 2
                        .


                        Fig. 2
                         shows the block diagram of the coordinate transform unit which transforms the destination voxel location to the corresponding source voxel location. The gray value of the source location is mapped to the corresponding destination voxel location of the output image. According to the proposed algorithm, four coordinates are computed simultaneously. Outputs of Block 11, Block 12 and Block 13 generate the coordinates of row, column and frame respectively. Internal architectures of these three blocks are the same but only inputs are changed. Fig. 3
                         shows the internal architecture diagram of Block 11. The symbols 
                           
                              x
                              ,
                              y
                           
                         and z are the outputs of three cascaded counters and they represent row, column and frame of destination voxel locations respectively. 
                           
                              offset
                              (
                              1
                              )
                              ,
                              offset
                              (
                              2
                              )
                           
                        , and 
                           
                              offset
                              (
                              3
                              )
                           
                         are the centre location of the image. After receiving the input by the transformation unit, the same computation is performed irrespective of the transformation parameter. So, in the proposed architecture, the same modules are used for all the operations of the AT. In Fig. 3, 
                           
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    e
                                 
                                 
                                    1
                                 
                              
                           
                         are not updated with 
                           
                              x
                              ,
                              y
                           
                         and z. So, it is calculated only once at the beginning of each operation and 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                           
                         is updated with every input of x and y.

In this architecture, the 3D image is considered as a stack of frames. The AT is applied sequentially frame by frame. Displacement will be very less for small angle rotation so we do not need to store total image in memory. When performing the transformation of the 
                           
                              R
                           
                        th frame, 
                           
                              (
                              R
                              +
                              t
                              )
                           
                        th to 
                           
                              (
                              R
                              -
                              t
                              )
                           
                        th frames have to be stored in the system memory so that the required source voxel can be accessed directly. The value of ‘t’ depends on the input parameters. For implementation of the proposed algorithm, considering maximum rotation angle of 
                           
                              6
                              °
                           
                        , 16 consecutive frames are stored in the system memory. Before starting the transformation operation, first 8 frames of the image are stored in the system memory. After that transformation operation is applied on 
                           
                              0
                           
                        th frame, both the transformation and storing of the next frame are performed simultaneously. It is very unlikely that 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              )
                              ,
                              (
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                              
                              )
                           
                         fall on the integer voxel points. To find out the exact gray value of these non-integer voxel locations, an interpolation technique is required. The proposed algorithm has been implemented using nearest neighborhood interpolation (NNI) as well as TriLinear Interpolation (TLI) techniques. In NNI, gray value of non-integer voxel point within the image is the nearest voxel gray value of that non-integer voxel. However, in TLI eight neighborhood voxel values of the non-integer voxel are required.

Details of implementation of interpolation are discussed in Section 3.4. Fig. 4
                         shows that the point ‘n’ is a non-integer voxel location within the image. To compute the gray value of voxel ‘n’ using TLI, gray value of eight voxel points A1_0, B1_0, A2_0, B2_0, A1_1, B1_1, A2_1 and B2_1 are required. In the proposed algorithm, transformations of four voxel locations are computed simultaneously. So, gray values of 32 voxel locations have to be accessed at single clock edge. The architecture for accessing 32 voxel locations is discussed below which helps to perform the interpolation in parallel.

A single frame ‘k’, is divided into four sub memories like RAMk_00, RAMk_01, RAMk_10 and RAMk_11 depending on the row and column positions as shown in Table 3
                        . The symbol ‘k’ is varying from 0 to 15 depending on the frame. These memories are dual port memory. Fig. 5
                         shows complete block diagram of memory distribution, corresponding accessing and selecting block.

The functionality of memory address generator is shown below
                           
                              (11)
                              
                                 
                                    
                                       
                                       
                                          
                                             A
                                             _
                                             adds
                                             _
                                             00
                                             =
                                             {
                                             Even
                                             (
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             Even
                                             (
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             A
                                             _
                                             adds
                                             _
                                             01
                                             =
                                             {
                                             Even
                                             (
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             odd
                                             (
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             A
                                             _
                                             adds
                                             _
                                             10
                                             =
                                             {
                                             odd
                                             (
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             Even
                                             (
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             A
                                             _
                                             adds
                                             _
                                             11
                                             =
                                             {
                                             odd
                                             (
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             InT
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             odd
                                             (
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             ,
                                             Int
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             +
                                             1
                                             )
                                             [
                                             6
                                             :
                                             1
                                             ]
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             Int
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             =
                                             Integer
                                             (
                                             
                                                
                                                   p
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        B_adds_00, B_adds_01, B_adds_10 and B_adds_11 can be generated in a similar way by putting 
                           
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    2
                                 
                              
                           
                         in place of 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    1
                                 
                              
                           
                         respectively in (11).

Internal architectures of Block1 to Block8 (vide Fig. 5) are the same with different inputs. Fig. 6
                         shows the internal structure of Block1. Initially, RAM0_00, RAM0_01, RAM0_10, RAM0_11 contain the data of 0th frame but after 
                           
                              16
                              ×
                              64
                              ×
                              64
                           
                         clock cycle, RAM0_00, RAM0_01, RAM0_10, RAM0_11 are updated with the data of 16th frame. Simultaneously, the transform of 7th frame is computed. As the maximum rotation angle of 
                           
                              6
                              °
                           
                         is considered for designing the architecture, the 0th and 16th frames are not required for source voxels. Hence, this memory is not to be accessed. Mem_rotation_cntrl is used as a control signal to pass input to the second stage mux. This signal is generated at the output of a 4-bit counter. This counter starts counting after 
                           
                              16
                              ×
                              64
                              ×
                              64
                           
                         clock cycles and incremented by one after each 
                           
                              64
                              ×
                              64
                           
                         clock cycles. So, after 
                           
                              16
                              ×
                              64
                              ×
                              64
                           
                         clock cycles 0th to 15th input positions of second stage mux are connected with the outputs of the memory which originally contain 1st to 16th frames respectively. Again, after 
                           
                              17
                              ×
                              64
                              ×
                              64
                           
                         clock cycles, 0th to 15th positions of second stage mux are connected with the outputs of the memory which originally contain 2nd to 17th frames respectively. Z1_sub_count is the difference between 7-bit counter output which starts after 
                           
                              16
                              ×
                              64
                              ×
                              64
                           
                         clock cycles and incremented by one after 
                           
                              64
                              ×
                              64
                           
                         clock cycles each time, and integer part of 
                           
                              
                                 
                                    r
                                 
                                 
                                    1
                                 
                              
                           
                        . Similarly, Z2_sub_count is the difference between 7-bit counter output and integer part of 
                           
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                           
                        . These two signals are used as selection line of the second stage mux. Z1_sub_count+1 and Z2_sub_count+1 are used to select just upper frames. For source voxel address 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    r
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        , the same architecture is used as shown in Fig. 5.
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             p
                                             1
                                             _
                                             q
                                             1
                                             _
                                             lm
                                             _
                                             0
                                             =
                                             accessed
                                             
                                             data
                                             
                                             corresponding
                                             
                                             to
                                             
                                             address
                                             (
                                             A
                                             _
                                             adds
                                             _
                                             lm
                                             ,
                                             Z
                                             1
                                             _
                                             sub
                                             _
                                             count
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             p
                                             1
                                             _
                                             q
                                             1
                                             _
                                             lm
                                             _
                                             1
                                             =
                                             accessed
                                             
                                             data
                                             
                                             corresponding
                                             
                                             to
                                             
                                             address
                                             (
                                             A
                                             _
                                             adds
                                             _
                                             lm
                                             ,
                                             Z
                                             1
                                             _
                                             sub
                                             _
                                             count
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             p
                                             2
                                             _
                                             q
                                             2
                                             _
                                             lm
                                             _
                                             0
                                             =
                                             accessed
                                             
                                             data
                                             
                                             corresponding
                                             
                                             to
                                             
                                             address
                                             (
                                             B
                                             _
                                             adds
                                             _
                                             lm
                                             ,
                                             Z
                                             2
                                             _
                                             sub
                                             _
                                             count
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             p
                                             2
                                             _
                                             q
                                             2
                                             _
                                             lm
                                             _
                                             1
                                             =
                                             accessed
                                             
                                             data
                                             
                                             corresponding
                                             
                                             to
                                             
                                             address
                                             (
                                             B
                                             _
                                             adds
                                             _
                                             lm
                                             ,
                                             Z
                                             2
                                             _
                                             sub
                                             _
                                             count
                                             +
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             where
                                             
                                             (
                                             lm
                                             )
                                             =
                                             (
                                             00
                                             ,
                                             01
                                             ,
                                             10
                                             ,
                                             11
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The expressions 
                           
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              _
                              frac
                              ,
                              
                                 
                                    q
                                 
                                 
                                    k
                                 
                              
                              _
                              frac
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                              _
                              frac
                           
                         are fraction parts of 
                           
                              
                                 
                                    p
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                           
                         respectively. Fig. 7
                         shows block diagram for TLI interpolation. The internal diagrams of TLI_1 to TLI_4 are the same. Each block is working simultaneously and computing the gray value of one non-integer voxel point each. In the next paragraph, one of the block diagrams has been discussed. In TLI, suppose ‘n’ (vide Fig. 4) is a non-integer voxel location within the image. To compute gray value of this point, first gray values of points 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                         have been computed using BiLinear Interpolation (BLI) followed by linear interpolation between 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                        . Fig. 8
                         shows block level circuit for TLI. BLI_20 and BLI_21 compute the gray values of points, 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           
                         respectively. After getting output from BLI_20 and BLI_21, NNI_2 computes final gray value. Internal structure of BLI_20 and BLI_21 are the same. Fig. 9
                         shows internal structure of BLI_20 (vide Fig. 8). Block Delay Element has been used to make a pipelined architecture. The fraction parts of row, column and frame are 
                           
                              dx
                              ,
                              dy
                           
                         and dz respectively. Lsb_row and Lsb_clm are LSB of integer part of the column. To compute the gray value of point 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                         (vide Fig. 4), the gray values of points 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                         are computed first using linear interpolation simultaneously. Then the gray value of point 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                         is computed from the gray values of points 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                         using linear interpolation. NNI_10 and NNI_20 in Fig. 9 compute gray values of points 
                           
                              
                                 
                                    m
                                 
                                 
                                    1
                                 
                              
                           
                         and 
                           
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                           
                         respectively and NNI_30 computes the gray value of point 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                        . Table 4
                         shows the gray values of four nearest voxel locations of the point 
                           
                              
                                 
                                    f
                                 
                                 
                                    m
                                 
                              
                           
                        .

In Section 3.3, we have discussed how to access 
                           
                              f
                              (
                              A
                              1
                              _
                              0
                              )
                              ,
                              f
                              (
                              B
                              1
                              _
                              0
                              )
                              ,
                              f
                              (
                              A
                              2
                              _
                              0
                              )
                           
                         and 
                           
                              f
                              (
                              B
                              2
                              _
                              0
                              )
                           
                        . Similarly, 
                           
                              f
                              (
                              A
                              1
                              _
                              1
                              )
                              ,
                              f
                              (
                              B
                              1
                              _
                              1
                              )
                              ,
                              f
                              (
                              A
                              2
                              _
                              1
                              )
                           
                         and 
                           
                              f
                              (
                              B
                              2
                              _
                              1
                              )
                           
                         can be accessed by increasing only second stage select line by one.


                        
                           
                              f
                              (
                              mi
                              )
                           
                        
                        =gray value at point 
                           
                              
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              ∈
                              (
                              1
                              ,
                              2
                              )
                           
                        
                        
                           
                              (12)
                              
                                 f
                                 (
                                 mi
                                 )
                                 =
                                 f
                                 (
                                 Ai
                                 _
                                 0
                                 )
                                 ×
                                 (
                                 1
                                 -
                                 dy
                                 )
                                 +
                                 dy
                                 ×
                                 f
                                 (
                                 Bi
                                 _
                                 0
                                 )
                                 =
                                 (
                                 f
                                 (
                                 Bi
                                 _
                                 0
                                 )
                                 -
                                 f
                                 (
                                 Ai
                                 _
                                 0
                                 )
                                 )
                                 ×
                                 dy
                                 +
                                 f
                                 (
                                 Ai
                                 _
                                 0
                                 )
                              
                           
                        When integer of the column is even and
                           
                              (13)
                              
                                 f
                                 (
                                 mi
                                 )
                                 =
                                 f
                                 (
                                 Bi
                                 _
                                 0
                                 )
                                 ×
                                 (
                                 1
                                 -
                                 dy
                                 )
                                 +
                                 dy
                                 ×
                                 f
                                 (
                                 Ai
                                 _
                                 0
                                 )
                                 =
                                 (
                                 f
                                 (
                                 Ai
                                 _
                                 0
                                 )
                                 -
                                 f
                                 (
                                 Bi
                                 _
                                 0
                                 )
                                 )
                                 ×
                                 dy
                                 +
                                 f
                                 (
                                 Bi
                                 _
                                 0
                                 )
                              
                           
                        when integer of the column is odd. Gray value of point will be computed by Eqs. (12) or (13) depending on LSB of integer part column. Gray value of point 
                           
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                              
                           
                         is 
                           
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                           
                        , which can be computed from Eqs. (12) and (13) by replacing 
                           
                              f
                              (
                              Ai
                              _
                              0
                              )
                              ,
                              f
                              (
                              Bi
                              _
                              0
                              )
                           
                         and dy with 
                           
                              f
                              (
                              mi
                              )
                           
                         and dx respectively and using integer part of row instead of integer part of column.

Similarly 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        , gray value of point 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           
                        , can be computed.

Either Eqs. (12) or (13) is selected by NNI_10 (vide Fig. 9). The internal circuit of NNI_10 (vide Fig. 9) is shown in Fig. 10
                        . NNI_20 (vide Fig. 9) and NNI_30 (vide Fig. 9) are similar to NNI_10 (vide Fig. 9). However, inputs are different. In the same way we can compute the gray value of the point 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                 
                              
                           
                        , that is 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        .

After getting 
                           
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                           
                         and 
                           
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           
                        , NNI_2 (vide Fig. 8) computes 
                           
                              Pixval
                              1
                           
                        , the gray value of non-integer voxel n.
                           
                              (14)
                              
                                 Pixval
                                 1
                                 =
                                 (
                                 
                                    
                                       F
                                    
                                    
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ×
                                 dz
                                 +
                                 
                                    
                                       F
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        
                     


                        Figs. 10 and 11
                         show the internal circuit diagram of NNI_10 and NNI_2 of Figs. 9 and 8 respectively.

@&#RESULTS AND DISCUSSION@&#

The conventional Affine Transformation and the proposed MATPR algorithms have been implemented using MATLAB. The test image sequences are CT phantom images of size 
                        
                           
                              
                                 64
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 128
                              
                              
                                 3
                              
                           
                           ,
                           
                              
                                 196
                              
                              
                                 3
                              
                           
                        
                      and MRI image of size 
                        
                           128
                           ×
                           128
                           ×
                           27
                        
                     . The voxel value of the image is represented by 8 bits per voxel. So, the images are of gray scale with values ranging between 0 and 255. The proposed MATPR algorithm is coded in Verilog HDL language and mapped into FPGA.


                        Fig. 12
                         shows the affine rotation of 3D CT phantom volume image of size 
                           
                              128
                              ×
                              128
                              ×
                              128
                           
                         by an angle of 
                           
                              45
                              °
                           
                         about X-, Y- and Z-axes using the conventional affine and the proposed algorithms. From the results, it can be observed that the visual image quality remains the same using the proposed MATPR algorithm.

In the proposed MATPR algorithm, symmetry among 4 pixel locations has been considered. To test the performance, all the algorithms have been run on a standard PC (CPU with 3GHz Intel Core2 Duo CPU, 3GB RAM) in MATLAB. Table 5
                            compares the computations in terms of number of matrix multiplications required to perform any transformation operation using different algorithms for various image sizes. It is evident from the Table 5 that MATPR algorithm requires 75% less No. of matrix multiplications compared to that of the conventional algorithm and computation is reduced by 50% compared to that of ATPR algorithm. Table 6
                            shows the average execution time required to obtain the AT of a complete image. The average time has been obtained by running the program 10 times using TLI method. In MATLAB, the program is executed sequentially. Due to the consideration of symmetry among pixel locations, though the No. of matrix multiplications is reduced, extra calculations are needed to obtain the AT. From Table 6, it can be observed that the average time required to obtain the AT in the proposed algorithm is less than that of the conventional algorithm.

The image quality performance is measured by using two parameters: Mean square error (MSE) and Peak signal to noise ratio (PSNR). MSE is calculated between the images obtained after transformation by using NNI and TLI methods for both the conventional and the proposed algorithms using Eq. (15). PSNR is also calculated using Eq. (16) to evaluate the qualitative performance of the proposed algorithm by comparing the original image with the image obtained after rotating back by the same angle from the Affine Transformed image.
                              
                                 (15)
                                 
                                    MSE
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                [
                                                f
                                                (
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                )
                                                -
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ́
                                                   
                                                
                                                (
                                                x
                                                ,
                                                y
                                                ,
                                                z
                                                )
                                                ]
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                3
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 N
                                 ×
                                 N
                                 ×
                                 N
                              
                            is the image size.
                              
                                 (16)
                                 
                                    PSNR
                                    =
                                    20
                                    ×
                                    log
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   MSE
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          f
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                    =pixel value of the original image at the location 
                                       
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                 


                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                ́
                                             
                                          
                                          (
                                          x
                                          ,
                                          y
                                          ,
                                          z
                                          )
                                       
                                    
                                    =Pixel value of the image obtained after rotating back the transformed image.


                           Fig. 13
                           (a) and (b) shows the PSNR obtained using the conventional and the proposed methods for TLI and NNI respectively. The PSNR is calculated by rotating the image in steps of 
                              
                                 1
                                 °
                              
                            angle starting from 
                              
                                 0
                                 °
                              
                            to 
                              
                                 90
                                 °
                              
                           . PSNRs in both the cases are found to be matching for all angles.

The algorithm is synthesized using Xilinx ISE Simulator and is mapped into FPGA. Both architectures (using NNI as well as TLI) are implemented by Verilog and simulation has been done by writing test bench. The hardware resources for the algorithm has been obtained after post, place and routing of the design in the Xilinx FPGA. The hardware implementation results and timing information are presented in Tables 7 and 8
                        
                         respectively.


                        Table 9
                         shows comparison between the implementation of the proposed algorithm in FPGA with GPU implementation. These show that the proposed method gives better throughput than that of the GPU implementation and further speed can be increased by latest generation of the FPGA. Table 10
                         shows the comparison of total time taken by the proposed algorithm and existing FPGA implementation [7].

@&#CONCLUSIONS@&#

In this paper, a 3D AT algorithm has been proposed and presented along with its LUT based parallel and pipelined hardware implementation. The architecture is designed by storing the relevant frames of the total image as the requirement of rotation angle is very small for image registration. A maximum of 
                        
                           6
                           °
                        
                      angle of rotation is considered in our architecture design which can be enhanced by increasing the number of frames in the system memory. From Fig. 13 this algorithm can be applied for any operation, although we have considered a maximum rotation of 
                        
                           6
                           °
                        
                     . This algorithm traverses only one fourth of voxel location of the image to obtain the transformation of complete image. By using the same architecture, all the operations of AT are possible. Due to faster implementation, the proposed algorithm is useful during image registration of 3D biomedical images, where iterative implementation of AT is required. It takes 16.7ms and 18.5ms to perform any operation of 3D AT for a 256 
                        
                           ×
                           256
                           ×
                           256
                        
                      image at frequencies of 258MHz and 233.65MHz using NNI and TLI techniques, respectively. The PSNR of the proposed algorithm is compared with that of the conventional algorithm to measure the quality of the transformed image and is found to be matching. The speed of the implementation in terms of volume rate is calculated and compared with that of the GPU implementation results. The results show that the proposed algorithm is faster compared to GPU while implemented in XC5VX95T FPGA and it can be made even faster by using advanced FPGAs. It can be conjectured that this faster implementation of the proposed 3D AT may be a good candidate for real-time medical image registration.

@&#REFERENCES@&#

