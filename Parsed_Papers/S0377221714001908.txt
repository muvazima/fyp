@&#MAIN-TITLE@&#The Red–Blue transportation problem

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Red–Blue TP, a new generalization of the transportation problem is presented.


                        
                        
                           
                           It is motivated by a patient assignment problem in hospitals.


                        
                        
                           
                           The problem’s complexity is established and two IP formulations are given.


                        
                        
                           
                           Three 1/2-approximation algorithms are presented for a maximization variant.


                        
                        
                           
                           A computational study discusses performance with respect to problem characteristics.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Transportation problem

Exclusionary constraints

Complexity

Approximation

Integer programming

@&#ABSTRACT@&#


               
               
                  This paper considers the Red–Blue Transportation Problem (Red–Blue TP), a generalization of the transportation problem where supply nodes are partitioned into two sets and so-called exclusionary constraints are imposed. We encountered a special case of this problem in a hospital context, where patients need to be assigned to rooms. We establish the problem’s complexity, and we compare two integer programming formulations. Furthermore, a maximization variant of Red–Blue TP is presented, for which we propose a constant-factor approximation algorithm. We conclude with a computational study on the performance of the integer programming formulations and the approximation algorithms, by varying the problem size, the partitioning of the supply nodes, and the density of the problem.
               
            

@&#INTRODUCTION@&#

Consider the well-known Transportation Problem (TP): given is a set of supply nodes S, each with supply 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                        
                      (
                        
                           i
                           ∈
                           S
                        
                     ), a set of demand nodes D, each with demand 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                        
                      (
                        
                           j
                           ∈
                           D
                        
                     ), with 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 S
                              
                           
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 ∈
                                 D
                              
                           
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                        
                     , and a bipartite graph (
                        
                           S
                           ∪
                           D
                           ,
                           E
                        
                     ), with a given cost 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                           
                        
                      for each edge 
                        
                           (
                           i
                           ,
                           j
                           )
                           ∈
                           E
                        
                     , where E is not necessarily complete. The question is how to send the flow from supply nodes to the demand nodes such that total cost is minimal. In this paper, we generalize this problem by associating a color, either red or blue, to each supply node. Thus, the set of supply nodes is partitioned into two sets R (red) and B (blue) such that 
                        
                           S
                           =
                           R
                           ∪
                           B
                        
                     , and 
                        
                           R
                           ∩
                           B
                           =
                           ∅
                        
                     . The additional requirement is that the set of supply nodes that actually supply a demand node should all have the same color. In other words, a demand node is only allowed to receive flow from supply nodes that are either all red or all blue. We refer to these constraints as color constraints. Obviously, the resulting problem is a generalization of the transportation problem since if all supply nodes have the same color, the TP arises. We will refer to our problem as the Red–Blue Transportation Problem (Red–Blue TP).

In Section 1.1 we discuss the practical application that motivated our study, followed by related literature in Section 1.2.

@&#MOTIVATION@&#

Although the Red–Blue TP may seem a purely theoretical generalization of the transportation problem, its motivation stems from a situation we encountered in practice. Consider a setting where patients in a hospital need to be assigned to rooms. Rooms are of limited capacity, and due to specific equipment, not all rooms are equally appropriate for each patient. For instance, a patient’s pathology may require oxygen to be available at the room; rooms that do not meet this requirement, need to be equipped with a mobile oxygen supply which is, for organizational reasons, less desirable. The Patient Admission Scheduling problem (PAS) consists in assigning patients to rooms in such a way that the medical concerns and personal wishes are fulfilled as much as possible. This problem has been defined by Demeester, Souffriau, De Causmaecker, and Vanden Berghe (2010), and studied further by Ceschia and Schaerf (2011). A key constraint in the patient admission scheduling problem is that male and female patients should not be assigned to the same room, which is common practice in hospitals (all over the world). Clearly, this situation can be modeled as a (special case of) Red–Blue TP: each patient is represented as a supply node with 
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , each room is represented as a demand node where the capacity of the room is represented by 
                           
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                           
                        , and the “appropriateness” of assigning patient i to room j is captured by cost 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                           
                        .

It is not hard to think of other practical applications of Red–Blue TP. For instance, imagine a situation where a number of goods need to be transported from a port to a warehouse. Several trucks are available for transportation, each driving according to a schedule that fixes the departure times at the port. Depending on delivery deadlines, some truck assignments are more suitable for particular goods than others. A Red–Blue TP instance arises if the goods can be divided into two types that cannot be assigned to the same truck, for instance because of incompatibilities of content (e.g. hazardous materials), ownership (e.g. rivaling business companies that are unwilling to have their goods transported on the same truck), or size (Cao & Uebe, 1995). Another application involves the transportation of football fans to the match using public railways: when assigning fans to trains, no fans of the opposing teams should be on the same train, to avoid hooliganism (Schreuder, 1992). In Section 4, we mention further applications of a maximization variant of our problem.

The Red–Blue transportation problem is a natural generalization of a classic problem in operations research. In the literature, several generalizations of the transportation problem have been described. The most well-known is probably the transshipment problem, in which the underlying graph need not be bipartite, and so-called transferring nodes, which have no net supply or demand, may exist (see e.g. Orden (1956)). The min-cost flow problem is a further generalization of the transshipment problem, introducing capacities on the arcs. In the fixed-charge transportation problem (Hirsch & Dantzig, 1968), a fixed cost may be incurred for every arc in the transportation network that is used. Numerous other generalizations of the transportation problem have been presented, for instance to solve spatial economic equilibrium problems (MacKinnon, 1975), and aircraft routing problems (Ferguson & Dantzig, 1955), or even to deal with wartime conditions where distances from some sources to some destinations are no longer definite (i.e. the gray transportation problem, see Bai, Mao, & Lu (2004)).

One generalized transportation problem is particularly related to the Red–Blue transportation problem, namely the Transportation Problem with Exclusionary Side Constraints (TPESC). Although the name TPESC was coined by Sun (2002), it was in fact introduced by Cao (1992). The phenomenon that not every set of supply nodes is allowed to send flow to a demand node, is something that TPESC and Red–Blue TP have in common. In TPESC, for each demand node 
                           
                              j
                              ∈
                              D
                           
                        , a set of pairs of supply nodes is given, denoted by 
                           
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                              =
                              {
                              {
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              }
                              |
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ∈
                              S
                              }
                           
                        . The problem is to send the flow from supply to demand nodes at minimum cost, such that each demand node 
                           
                              j
                              ∈
                              D
                           
                         only receives supply from at most one supply node for each pair of supply nodes present in 
                           
                              
                                 
                                    F
                                 
                                 
                                    j
                                 
                              
                           
                        .

It is not hard to see that Red–Blue TP is a special case of TPESC. Goossens and Spieksma (2009) show that TPESC is NP-hard, and becomes pseudo-polynomially solvable if the number of supply nodes is fixed. Furthermore, these authors study TPESC with identical exclusionary sets: they provide a pseudo-polynomial algorithm for the case with two demand nodes, and prove NP-hardness for the case with three demand nodes.

Another problem related to Red–Blue TP is the so-called Maximum Flow problem with Conflict Graph (MFCG), a problem studied by Pferschy and Schauer (2013). In the MFCG a directed graph with capacitated arcs, a source, and a sink are given. In addition, pairs of arcs (from the directed graph) are given; for some pairs of arcs the constraint is that at most one arc of the pair can carry flow (a negative disjunctive constraint), for other pairs of arcs the constraint is that at least one arc of the pair must carry flow (a positive disjunctive constraint). Pferschy and Schauer (2013) show that the problem of finding a maximum flow in a network under these disjunctive constraints is (strongly) NP-hard; even more they show that no polynomial time constant-factor approximation algorithm can exist (unless P=NP).

Observe that Red–Blue TP is a special case of MFCG; indeed, consider some demand 
                           
                              j
                              ∈
                              D
                           
                        . Now, by having negative disjunctive constraints for each pair of arcs that consist of one arc emanating from a red supply node to node j, and one arc emanating from a blue supply node to node j, an instance of Red–Blue TP arises. We point out that for our special case it is possible to find polynomial time constant factor approximation algorithms (see Section 4).

As a general statement of the complexity of Red–Blue TP, we provide the following theorem.
                        Theorem 1
                        
                           Red–Blue TP is NP-hard, even if 
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                              
                           
                           , and 
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 3
                                 
                                 ∀
                                 j
                                 ∈
                                 D
                              
                           
                           .
                        

We prove Theorem 1 by showing that the EXACT-3-COVER (X3C) problem can be reduced to the decision version of Red–Blue TP. The decision version of Red–Blue TP, denoted Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                           , concerns the question: does there exist a solution that sends all flow from the supply nodes to the demand nodes while satisfying demand, and while satisfying the color constraints, i.e. does there exist a feasible flow? X3C has been shown to be NP-complete (see e.g., Garey & Johnson, 1979), and is defined as follows:
                              
                                 
                                    Input: A set X with 
                                       
                                          |
                                          X
                                          |
                                          =
                                          3
                                          q
                                       
                                     and a collection C of 3-element subsets (i.e., triples) of X, with 
                                       
                                          |
                                          C
                                          |
                                          =
                                          k
                                       
                                    .


                                    Question: Does there exist a cover in C that covers X exactly, i.e. a subcollection 
                                       
                                          C
                                          ′
                                          ⊆
                                          C
                                       
                                     such that every 
                                       
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          X
                                       
                                     is contained in exactly one 
                                       
                                          
                                             
                                                C
                                             
                                             
                                                j
                                             
                                          
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    ?

Any instance of X3C (with 
                              
                                 |
                                 C
                                 |
                                 >
                                 q
                              
                           ) can be reduced to Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                            as follows. Associate to each element 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 X
                              
                            a blue supply node i with 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              
                           . Associate to each triple 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                              
                            a demand node j with 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 3
                              
                           . Create edges from supply to demand nodes corresponding to the membership relations (i.e. supply node 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                            is connected to demand node 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                                 ⇔
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                              
                           ). Add 
                              
                                 3
                                 (
                                 k
                                 -
                                 q
                                 )
                              
                            red supply nodes with 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                              
                            that are connected to all demand nodes. Observe that total supply equals total demand. The question is: does there exist a feasible flow in this instance of Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                           ?

Now we show that a yes-answer to the X3C instance directly corresponds to a yes-answer to the corresponding Red–Blue TP instance, and vice versa.

First, consider an X3C instance that is feasible, and thus has an exact cover 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                                 ⊆
                                 C
                              
                           . Then, each demand node corresponding to a 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       ′
                                    
                                 
                              
                            can be supplied by the blue supply nodes corresponding to the 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                 
                              
                           , and the remaining demand nodes can be supplied by the red supply nodes. Thus, the corresponding Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                            instance is also feasible.

Next, consider any feasible solution to the Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                            instance. Each demand node is supplied by either three red supply nodes or by three blue supply nodes. Moreover, there must exist q demand nodes each supplied by three blue supply nodes. These triples of blue supply nodes correspond to the triples in X3C that form a feasible solution.□

Notice that the above reduction can be generalized to show that Red–Blue TP with 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                           =
                           k
                        
                      is at least as hard as Exact Cover by k-sets.

If we put a cost of zero on the edges described in the above proof, and add some edges with a cost strictly larger than zero (corresponding to 
                        
                           
                              
                                 x
                              
                              
                                 i
                              
                           
                           
                           ∉
                           
                           
                              
                                 C
                              
                              
                                 j
                              
                           
                        
                     ), a polynomial-time algorithm with a constant performance ratio for Red–Blue TP would find a zero cost solution if one exists, and hence would be able to distinguish between the yes-instances and the no-instances of X3C. Therefore, the following corollary holds:
                        Corollary 1
                        
                           There is no constant-factor approximation algorithm for Red–Blue TP, even if 
                           
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 1
                                 
                                 ∀
                                 i
                                 ∈
                                 S
                              
                           
                           , and 
                           
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 3
                                 
                                 ∀
                                 j
                                 ∈
                                 D
                              
                           
                           , unless 
                           
                              
                                 P
                                 =
                                 NP
                              
                           
                           .
                        

Since the problem setting where, in addition to 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                           =
                           1
                        
                     , also 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                           =
                           1
                        
                      reduces to the assignment problem, the only setting for which the complexity is left open is the case when 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                           =
                           2
                        
                     . The special case of Red–Blue TP on a complete bipartite graph also has relevance. Relating back to the practical application of assigning patients to hospital rooms, patients can also be assigned to unsuitable rooms if necessary, when all other rooms are at capacity. Therefore, the assignment graph is, in this case, complete. The following theorem shows that this does not make the problem easy, even when all edge-costs are equal.
                        Theorem 2
                        
                           Red–Blue TP is NP-hard, even if G is a complete bipartite graph, all edge-costs are equal and there are only 2 supply nodes with equal supply.
                        

We prove Theorem 2 by showing that PARTITION can be reduced to Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                           . PARTITION has been shown to be NP-Complete (see e.g., Garey & Johnson, 1979) and is defined as follows:
                              
                                 
                                    Input: A set of integers 
                                       
                                          X
                                          =
                                          {
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                x
                                             
                                             
                                                n
                                             
                                          
                                          }
                                       
                                     with 
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          q
                                       
                                    
                                 


                                    Question: Does there exist a partition of X into 
                                       
                                          {
                                          
                                             
                                                X
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                X
                                             
                                             
                                                2
                                             
                                          
                                          }
                                       
                                     such that
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ∈
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 

The reduction is as follows. Create a demand node for each 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 X
                              
                            with 
                              
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                           . Next, create a blue and a red supply node, each with a supply of 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              
                           . Create edges between each supply/demand node pair so that the resulting bipartite graph is complete. Observe that total supply equals total demand by construction. The question is: does there exist a feasible assignment?

Consider a feasible PARTITION instance with a partition 
                              
                                 {
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                                 }
                              
                            of X such that 
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             j
                                          
                                       
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              
                           . It is clear that the corresponding Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                            instance is also feasible by supplying each demand node 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       1
                                    
                                 
                              
                            by the blue node and each demand node 
                              
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       2
                                    
                                 
                              
                            by the red one.

Next, consider that the Red–Blue 
                              
                                 
                                    
                                       TP
                                    
                                    
                                       D
                                    
                                 
                              
                            instance is feasible. In any feasible solution, a demand node 
                              
                                 x
                                 ∈
                                 X
                              
                            will be entirely supplied by either the blue supply node or the red supply node. Since total supply equals total demand, it must be so that in any feasible solution the sum of the demand nodes supplied by blue (red) supply nodes is equal to 
                              
                                 
                                    
                                       q
                                    
                                    
                                       2
                                    
                                 
                              
                           . Therefore, it must be so that when:
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    {
                                    x
                                    ∈
                                    X
                                    |
                                    corresponding
                                    
                                    demand
                                    
                                    node
                                    
                                    is
                                    
                                    supplied
                                    
                                    by
                                    
                                    the
                                    
                                    blue
                                    
                                    supply
                                    
                                    node
                                    }
                                 
                              
                           
                           
                              
                                 
                                    
                                       
                                          X
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    {
                                    x
                                    ∈
                                    X
                                    |
                                    corresponding
                                    
                                    demand
                                    
                                    node
                                    
                                    is
                                    
                                    supplied
                                    
                                    by
                                    
                                    the
                                    
                                    red
                                    
                                    supply
                                    
                                    node
                                    }
                                 
                              
                           then:
                              
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             ∈
                                             
                                                
                                                   X
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                           
                        

Thus the corresponding PARTITION instance is also feasible. □

Finally, consider the special case of Red–Blue TP where the number of demand nodes is fixed, but the capacity of the demand nodes is still part of the input. In this case, we provide the following lemma:
                        Lemma 1
                        
                           If 
                           
                              
                                 |
                                 D
                                 |
                              
                            
                           is fixed, Red–Blue TP is polynomially solvable.
                        

Red–Blue TP can be seen as a coloring problem, where the demand nodes are to be colored either blue or red in such a way that all blue (red) supply nodes can be assigned to blue (red) demand nodes. Given a coloring of demand nodes, the feasibility of Red–Blue TP can be determined by solving two transportation problems: the TP on the blue subgraph, and the problem on the red subgraph. If there are 
                              
                                 |
                                 D
                                 |
                              
                            demand nodes, then there are 
                              
                                 
                                    
                                       2
                                    
                                    
                                       |
                                       D
                                       |
                                    
                                 
                              
                            possible colorings of the demand nodes. Thus by solving 
                              
                                 2
                                 ×
                                 
                                    
                                       2
                                    
                                    
                                       |
                                       D
                                       |
                                    
                                 
                              
                            transportation problems, the feasibility of Red–Blue TP can be determined. Moreover, if a feasible solution exists, this algorithm will find an optimal solution. Since the TP can be solved in polynomial time, this enumeration can be done in time polynomial in the number of supply nodes.□

In this section we provide two integer programming formulations for Red–Blue TP and show that Formulation 2 is strictly stronger than Formulation 1. We refer to Table 1
                      for details on the notation.


                     Formulation 1 The decision variables are defined as follows:
                        
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          amount
                                          
                                          of
                                          
                                          supply
                                          
                                          that
                                          
                                          node
                                          
                                          i
                                          
                                          sends
                                          
                                          to
                                          
                                          node
                                          
                                          j
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            if
                                                            
                                                            demand
                                                            
                                                            node
                                                            
                                                            j
                                                            
                                                            is
                                                            
                                                            supplied
                                                            
                                                            by
                                                            
                                                            red
                                                            
                                                            nodes
                                                            ,
                                                         
                                                      
                                                      
                                                         
                                                            0
                                                         
                                                         
                                                            otherwise
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Red–Blue TP is modeled as follows:
                        
                           (1)
                           
                              Min
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       S
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                              ·
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     subject to:
                        
                           (2)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              
                              ∀
                              i
                              ∈
                              S
                           
                        
                     
                     
                        
                           (3)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              ·
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     
                     
                        
                           (4)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              ·
                              (
                              1
                              -
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     
                     
                        
                           (5)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              N
                              
                              ∀
                              i
                              ∈
                              S
                              ,
                              j
                              ∈
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     The objective function minimizes the total cost of sending supply to demand nodes j. Constraints (2) ensure that each supply node i sends its supply 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                        
                      to its appropriate demand nodes 
                        
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        
                     . Constraints (3) and (4) ensure that each demand node j receives 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                        
                      units of supply from either red or blue supply nodes. The decision variables 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                        
                      are defined for all feasible 
                        
                           (
                           i
                           ,
                           j
                           )
                        
                      pairs in Expression (5). The LP-relaxation of (1)–(6) arises when we replace (5) and (6) by 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                           ⩾
                           0
                           ,
                           ∀
                           i
                           ∈
                           S
                           ,
                           j
                           ∈
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        
                     , and 
                        
                           0
                           ⩽
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           ⩽
                           1
                           ,
                           ∀
                           j
                           ∈
                           D
                        
                     . The corresponding objective function value is denoted by 
                        
                           
                              
                                 V
                              
                              
                                 LP
                                 1
                              
                           
                        
                     .


                     Formulation 2 The second formulation corresponds to the integer model described by Sun (2002). It uses the same decision variables 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                        
                      as Formulation 1, but also uses decision variables 
                        
                           
                              
                                 y
                              
                              
                                 ij
                              
                           
                        
                      that are defined as follows:
                        
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                1
                                             
                                             
                                                if
                                                
                                                node
                                                
                                                i
                                                
                                                supplies
                                                
                                                node
                                                
                                                j
                                                ,
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Red–Blue TP is modeled as follows:
                        
                           (7)
                           
                              Min
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       S
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                              ·
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     subject to:
                        
                           (8)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              
                              ∀
                              i
                              ∈
                              S
                           
                        
                     
                     
                        
                           (9)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             S
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     
                     
                        
                           (10)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              
                                 min
                              
                              (
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              )
                              ·
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                              
                              
                              ∀
                              i
                              ∈
                              S
                              ,
                              j
                              ∈
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        
                     
                     
                        
                           (11)
                           
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    kj
                                 
                              
                              ⩽
                              1
                              
                              ∀
                              i
                              ∈
                              B
                              ,
                              k
                              ∈
                              R
                              ,
                              j
                              ∈
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              ∩
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                           
                        
                     
                     
                        
                           (12)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              N
                              ,
                              
                                 
                                    y
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              i
                              ∈
                              S
                              ,
                              j
                              ∈
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        
                     The objective function is the same as in Formulation 1, minimizing total cost. Constraints (8) ensure that each supply node i sends its supply 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                        
                      to its appropriate demand nodes 
                        
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        
                     , while constraint (9) ensures that 
                        
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                        
                      units of supply are sent to demand node j. Constraints (10) express that 
                        
                           
                              
                                 y
                              
                              
                                 ij
                              
                           
                        
                      takes the value 1, when 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                           >
                           0
                        
                     . Constraints (11) ensure that no red and blue supply node i and k supply the same demand node j.

The LP-relaxation of (7)–(12) arises when we replace (12) by 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                           ⩾
                           0
                           ,
                           0
                           ⩽
                           
                              
                                 y
                              
                              
                                 ij
                              
                           
                           ⩽
                           1
                           ,
                           ∀
                           i
                           ∈
                           S
                           ,
                           j
                           ∈
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        
                     . The corresponding objective function value is denoted by 
                        
                           
                              
                                 V
                              
                              
                                 LP
                                 2
                              
                           
                        
                     .
                        Theorem 3
                        
                           
                              
                                 
                                    
                                       V
                                    
                                    
                                       LP
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       V
                                    
                                    
                                       LP
                                       2
                                    
                                 
                              
                           , namely Formulation 2 is strictly stronger than Formulation 1.
                        

For any instance, take an optimal LP-solution of Formulation 2 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                            with its value denoted 
                              
                                 
                                    
                                       V
                                    
                                    
                                       LP
                                       2
                                    
                                 
                              
                           . A feasible LP-solution of Formulation 1 can be constructed by setting 
                              
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       y
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 /
                                 
                                    
                                       b
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 ∀
                                 j
                                 ∈
                                 D
                              
                           . It is easy to verify that this is a feasible solution for the LP-relaxation of (1)–(6) with value 
                              
                                 
                                    
                                       V
                                    
                                    
                                       LP
                                       2
                                    
                                 
                              
                           .

Consider the following example showing that Formulation 2 can be better than Formulation 1. Given the complete bipartite graph 
                              
                                 G
                                 (
                                 S
                                 ∪
                                 D
                                 ,
                                 E
                                 )
                              
                            with 
                              
                                 S
                                 =
                                 R
                                 ∪
                                 B
                                 ,
                                 R
                                 =
                                 {
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 }
                                 ,
                                 B
                                 =
                                 {
                                 
                                    
                                       i
                                    
                                    
                                       3
                                    
                                 
                                 }
                                 ,
                                 D
                                 =
                                 {
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       j
                                    
                                    
                                       3
                                    
                                 
                                 }
                              
                            and 
                              
                                 E
                                 =
                                 S
                                 ×
                                 D
                              
                           . Also, 
                              
                                 
                                    
                                       a
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 =
                                 2
                                 ,
                                 
                                    
                                       a
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 =
                                 1
                              
                           , and 
                              
                                 
                                    
                                       b
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 3
                              
                           . All drawn edges in Fig. 1
                            have 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 0
                              
                           , all other edges (not drawn) have 
                              
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 1
                              
                           . It is a fact that the LP-relaxation of Formulation 1 has an optimal value 
                              
                                 
                                    
                                       V
                                    
                                    
                                       LP
                                       1
                                    
                                 
                                 =
                                 0
                              
                            (Fig. 2
                           (a)), whereas the LP-relaxation of Formulation 2 has an optimal value 
                              
                                 
                                    
                                       V
                                    
                                    
                                       LP
                                       2
                                    
                                 
                                 =
                                 1
                              
                            (Fig. 2(b)). Thus, there are instances for which Formulation 2 is better than Formulation 1.□

Notice that the example in Fig. 1 also shows that the LP-relaxation of Formulation 1 can be arbitrarily bad compared to the integer optimum. That fact is also true for Formulation 2: in Fig. 3
                     (a) we give an instance with 
                        
                           R
                           =
                           {
                           
                              
                                 i
                              
                              
                                 1
                              
                           
                           }
                        
                     , 
                        
                           B
                           =
                           {
                           
                              
                                 i
                              
                              
                                 2
                              
                           
                           }
                        
                      where all drawn edges have cost 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                           
                           =
                           0
                        
                     , all other edges (not drawn) have 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                           
                           =
                           1
                        
                     . Also, 
                        
                           
                              
                                 a
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           =
                           
                              
                                 a
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           2
                        
                     , 
                        
                           
                              
                                 b
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           =
                           
                              
                                 b
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       3
                                    
                                 
                              
                           
                           =
                           1
                        
                     , and 
                        
                           
                              
                                 b
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       2
                                    
                                 
                              
                           
                           =
                           2
                        
                     . This instance has no integer solution with value 0, whereas the LP-relaxation of Formulation 2 allows a solution with value 
                        
                           
                              
                                 V
                              
                              
                                 LP
                                 2
                              
                           
                           =
                           0
                        
                      (Fig. 3(b)).

In this section, we consider the following variant of Red–Blue TP: we modify the objective function to maximization, with 
                        
                           
                              
                                 p
                              
                              
                                 ij
                              
                           
                        
                      denoting the profit gained from supplying one unit to demand node j from supply node i. Moreover, we do not insist on sending all flow. We refer to this variant as Max-Red–Blue TP. In this setting, the patient admission scheduling problem as described in Section 1.1 can be seen as assigning as many patients as possible (weighted by e.g. their need for treatment) to rooms. Another example is assigning students to trainers in sport classes, where students may have preferences for trainers (or the corresponding timetable), taking into account the constraint that boys and girls should not be together in the same class.

It is not difficult to see that Max-Red–Blue TP remains NP-hard. Indeed, this result follows from a minor adaptation of the proof of Theorem 1.

An IP-formulation of the maximization variant (corresponding to Formulation 1) is as follows:
                        
                           (13)
                           
                              Max
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       S
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    ij
                                 
                              
                              ·
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                        
                     subject to:
                        
                           (14)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       ∈
                                       
                                          
                                             D
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              
                              ∀
                              i
                              ∈
                              S
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             R
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              ·
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     
                     
                        
                           (16)
                           
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       ∈
                                       
                                          
                                             B
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              ·
                              (
                              1
                              -
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              )
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                              ∈
                              N
                              
                              ∀
                              i
                              ∈
                              S
                              ,
                              j
                              ∈
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                           
                        
                     
                     
                        
                           (18)
                           
                              
                                 
                                    y
                                 
                                 
                                    j
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                              
                              ∀
                              j
                              ∈
                              D
                           
                        
                     
                  

Observe that the LP-relaxation of (13)–(18) can be found by solving a transportation problem, consisting of (13) and (14), 
                        
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                                 ∪
                                 
                                    
                                       B
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                           ⩽
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                           ,
                           ∀
                           j
                           ∈
                           D
                        
                     , and 
                        
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                           ⩾
                           0
                           ,
                           ∀
                           i
                           ∈
                           S
                           ,
                           j
                           ∈
                           
                              
                                 D
                              
                              
                                 i
                              
                           
                        
                     . We denote the value of this formulation by 
                        
                           
                              
                                 V
                              
                              
                                 LP
                                 1
                              
                              
                                 max
                              
                           
                        
                     . This formulation only uses the x-variables; a feasible solution for the y-variables is given by 
                        
                           
                              
                                 y
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 ∑
                              
                              
                                 i
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       j
                                    
                                 
                              
                           
                           
                              
                                 x
                              
                              
                                 ij
                              
                           
                           /
                           
                              
                                 b
                              
                              
                                 j
                              
                           
                           ,
                           ∀
                           j
                           ∈
                           D
                        
                     .

The Max-Red–Blue TP setting is interesting to study with respect to approximation, as it does not suffer from the feasibility issue. Indeed, in this setting the 
                        
                           0
                        
                     -vector is always a feasible, be it the worst possible, solution. In the following subsections, we present three approximation algorithms for Max-Red–Blue TP; the final subsection deals with a number of generalizations of Max-Red–Blue TP.

Consider the algorithm described below. It consists of solving two transportation problems, and next selecting the best of the two corresponding solutions.
                           Algorithm 1
                           MAX-RB
                                 
                                    
                                       
                                       
                                          
                                             1: Solve a TP on the subgraph induced by 
                                                   
                                                      R
                                                      ∪
                                                      D
                                                   
                                                 (the red subgraph), and solve a TP on the subgraph induced by 
                                                   
                                                      B
                                                      ∪
                                                      D
                                                   
                                                 (the blue subgraph). The respective solution values are denoted by 
                                                   
                                                      V
                                                      (
                                                      R
                                                      )
                                                   
                                                 and 
                                                   
                                                      V
                                                      (
                                                      B
                                                      )
                                                   
                                                .
                                          
                                          
                                             2: Return the solution vector for which 
                                                   
                                                      max
                                                      (
                                                      V
                                                      (
                                                      R
                                                      )
                                                      ,
                                                      V
                                                      (
                                                      B
                                                      )
                                                      )
                                                   
                                                 is attained.
                                          
                                       
                                    
                                 
                              
                           

Despite its simplicity, the resulting solution vector cannot be arbitrarily bad. We use OPT for the value of an optimal solution to the Max-Red–Blue TP problem.
                           Theorem 4
                           
                              The approximation ratio of MAX-RB is 
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              and this bound is tight.
                           


                              
                                 
                                    (19)
                                    
                                       
                                          max
                                       
                                       (
                                       V
                                       (
                                       R
                                       )
                                       ,
                                       V
                                       (
                                       B
                                       )
                                       )
                                       ⩾
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       V
                                       (
                                       R
                                       )
                                       +
                                       V
                                       (
                                       B
                                       )
                                       )
                                    
                                 
                              
                              
                                 
                                    (20)
                                    
                                       ⩾
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       OPT
                                       .
                                    
                                 
                              
                           

The first inequality is trivial, the second follows from the observation that 
                                 
                                    V
                                    (
                                    R
                                    )
                                    +
                                    V
                                    (
                                    B
                                    )
                                 
                               is the value of an optimal solution to a relaxed version of our problem, namely one where the demands are doubled (i.e. 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                    ≔
                                    2
                                    
                                       
                                          b
                                       
                                       
                                          i
                                       
                                    
                                 
                              ), and where no color constraints are present.

Finally, we show that the bound is tight. Consider the example in Fig. 4
                              . For this instance, MAX-RB may find 
                                 
                                    V
                                    (
                                    R
                                    )
                                    =
                                    V
                                    (
                                    B
                                    )
                                    =
                                    2
                                 
                              . However, clearly 
                                 
                                    OPT
                                    =
                                    4
                                 
                              .□

The algorithm described below consists of solving three transportation problems, one of which corresponds to solving the LP-relaxation of (13)–(18).
                           Algorithm 2
                           TP+R
                                 
                                    
                                       
                                       
                                          
                                             1: Solve the LP-relaxation of (13)–(18). Call the resulting solution vector 
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                . Set 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      =
                                                      ∅
                                                   
                                                .
                                          
                                          
                                             2: for all 
                                                
                                                   
                                                      j
                                                      ∈
                                                      D
                                                   
                                                 
                                                do
                                             
                                          
                                          
                                             3: 
                                                if 
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      ⩾
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             4: 
                                                
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ≔
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ∪
                                                      {
                                                      j
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             5: 
                                                else
                                             
                                          
                                          
                                             6: 
                                                
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ≔
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ∪
                                                      {
                                                      j
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             7: 
                                                end if
                                             
                                          
                                          
                                             8: end for
                                             
                                          
                                          
                                             9: Solve two TPs, one on the subgraph induced by 
                                                   
                                                      R
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                , and one on 
                                                   
                                                      B
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                 and construct the overall solution with value 
                                                   
                                                      V
                                                      (
                                                      TP
                                                      +
                                                      R
                                                      )
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           


                              The approximation ratio of TP
                              
                              +
                              
                              R is 
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                               
                              and this bound is tight.
                           

Let 
                                 
                                    V
                                    (
                                    B
                                    ∪
                                    
                                       
                                          D
                                       
                                       
                                          B
                                       
                                    
                                    )
                                 
                               and 
                                 
                                    V
                                    (
                                    R
                                    ∪
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                    )
                                 
                               denote the value of solving the TP on the subgraph induced by 
                                 
                                    B
                                    ∪
                                    
                                       
                                          D
                                       
                                       
                                          B
                                       
                                    
                                 
                               and on the subgraph induced by 
                                 
                                    R
                                    ∪
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                 
                               respectively. Then:
                                 
                                    (21)
                                    
                                       V
                                       (
                                       TP
                                       +
                                       R
                                       )
                                       =
                                       V
                                       (
                                       B
                                       ∪
                                       
                                          
                                             D
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       +
                                       V
                                       (
                                       R
                                       ∪
                                       
                                          
                                             D
                                          
                                          
                                             R
                                          
                                       
                                       )
                                       ⩾
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              This inequality holds since 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               restricted to 
                                 
                                    j
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          B
                                       
                                    
                                 
                              , 
                                 
                                    i
                                    ∈
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                 
                               (or 
                                 
                                    j
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                    ,
                                    i
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          j
                                       
                                    
                                 
                              ) is a feasible solution to the transportation problem solved in line 9 of Algorithm 2. Hence, an optimal solution to that TP has a value at least as large as 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          
                                             
                                                D
                                             
                                             
                                                B
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                B
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          ij
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          ∗
                                       
                                    
                                 
                              .

Define 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    
                                       
                                          p
                                       
                                       
                                          ij
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ij
                                       
                                       
                                          ∗
                                       
                                    
                                 
                               for each 
                                 
                                    j
                                    ∈
                                    D
                                 
                              . Observe that 
                                 
                                    
                                       
                                          V
                                       
                                       
                                          LP
                                          1
                                       
                                       
                                          max
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          D
                                       
                                    
                                    
                                       
                                          v
                                       
                                       
                                          j
                                       
                                    
                                 
                              . By construction of the sets 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                 
                               and 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          B
                                       
                                    
                                 
                              , we have for each 
                                 
                                    j
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                 
                              :
                                 
                                    (22)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                       ⩾
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              and for each 
                                 
                                    j
                                    ∈
                                    
                                       
                                          D
                                       
                                       
                                          B
                                       
                                    
                                 
                              :
                                 
                                    (23)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                       ⩾
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               R
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         ∈
                                                         
                                                            
                                                               B
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              Thus:
                                 
                                    (24)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             ij
                                          
                                          
                                             ∗
                                          
                                       
                                       ⩾
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      B
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      R
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                ∈
                                                D
                                             
                                          
                                       
                                       
                                          
                                             v
                                          
                                          
                                             j
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             V
                                          
                                          
                                             LP
                                             1
                                          
                                          
                                             max
                                          
                                       
                                       ⩾
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       OPT
                                       .
                                    
                                 
                              
                           

Finally, we show that the bound is tight. Consider again the example in Fig. 4. In this case, the worst case optimal solution vector to the TP (note that there are several optimal solution vectors) is:
                                 
                                    (25)
                                    
                                       
                                          
                                             x
                                          
                                          
                                             12
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             21
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             32
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             41
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       
                                          
                                             x
                                          
                                          
                                             11
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             22
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             31
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             42
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

Thus, we get:
                                 
                                    (26)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       and
                                    
                                 
                              
                              
                                 
                                    (27)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                              
                           

Therefore, the worst case coloring is:
                                 
                                    (28)
                                    
                                       
                                          
                                             D
                                          
                                          
                                             R
                                          
                                       
                                       =
                                       {
                                       1
                                       ,
                                       2
                                       }
                                       ,
                                       
                                       
                                          
                                             D
                                          
                                          
                                             B
                                          
                                       
                                       =
                                       ∅
                                       .
                                    
                                 
                              
                           

Thus, solving the TPs on the subgraphs leads to:
                                 
                                    (29)
                                    
                                       V
                                       (
                                       TP
                                       +
                                       R
                                       )
                                       =
                                       V
                                       (
                                       B
                                       ∪
                                       
                                          
                                             D
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       +
                                       V
                                       (
                                       R
                                       ∪
                                       
                                          
                                             D
                                          
                                          
                                             R
                                          
                                       
                                       )
                                       =
                                       0
                                       +
                                       2
                                       =
                                       2
                                       .
                                    
                                 
                              
                           

Recall from the previous that 
                                 
                                    OPT
                                    =
                                    4
                                 
                              .□


                              
                                 
                                    
                                       
                                          V
                                       
                                       
                                          LP
                                          1
                                       
                                       
                                          max
                                       
                                    
                                    ⩽
                                    2
                                    ·
                                    OPT
                                 
                              .

This follows from the above since we actually show that 
                                 
                                    V
                                    (
                                    TP
                                    +
                                    R
                                    )
                                    ⩾
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          LP
                                          1
                                       
                                       
                                          max
                                       
                                    
                                 
                              . Since 
                                 
                                    OPT
                                    ⩾
                                    V
                                    (
                                    TP
                                    +
                                    R
                                    )
                                 
                              , the bound follows.□

In a variant of TP+R, we determine a color for demand nodes one by one, depending on which color contributes most to the objective function value in that demand node. Each time a demand node is colored, we resolve the TP taking this decision into account. We call this algorithm Iterated TP+R (ITP+R).
                           Algorithm 3
                           Iterated TP+R
                                 
                                    
                                       
                                       
                                          
                                             
                                                1: Set 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      =
                                                      ∅
                                                   
                                                .
                                          
                                          
                                             
                                                2: Solve a TP based on profits 
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                   
                                                . Call the resulting solution vector 
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                3: Find 
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            argmax
                                                         
                                                         
                                                            j
                                                            ∈
                                                            D
                                                            ⧹
                                                            (
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∪
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  R
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      =
                                                      
                                                         
                                                            argmax
                                                         
                                                         
                                                            j
                                                            ∈
                                                            D
                                                            ⧹
                                                            (
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                            ∪
                                                            
                                                               
                                                                  D
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            
                                                               
                                                                  B
                                                               
                                                               
                                                                  j
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            ij
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                4: if 
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            R
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      ⩾
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            ∈
                                                            B
                                                         
                                                      
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            
                                                               
                                                                  ij
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                   
                                                 
                                                then
                                             
                                          
                                          
                                             
                                                5: set 
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  R
                                                               
                                                            
                                                         
                                                      
                                                      ≔
                                                      ∅
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ≔
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ∪
                                                      {
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                                6: else
                                             
                                          
                                          
                                             
                                                7: set 
                                                   
                                                      
                                                         
                                                            R
                                                         
                                                         
                                                            
                                                               
                                                                  j
                                                               
                                                               
                                                                  B
                                                               
                                                            
                                                         
                                                      
                                                      ≔
                                                      ∅
                                                   
                                                 and 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ≔
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      ∪
                                                      {
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                                8: end if
                                             
                                          
                                          
                                             
                                                9: Go to line 2 until 
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                      =
                                                      D
                                                   
                                                .
                                          
                                          
                                             10: Solve two TPs, one on the subgraph induced by 
                                                   
                                                      R
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                   
                                                , and one on 
                                                   
                                                      B
                                                      ∪
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            B
                                                         
                                                      
                                                   
                                                , and get the overall solution value 
                                                   
                                                      V
                                                      (
                                                      ITP
                                                      +
                                                      R
                                                      )
                                                   
                                                .
                                          
                                       
                                    
                                 
                              
                           

Notice that Iterated TP+R consists of solving 
                           
                              |
                              D
                              |
                              +
                              2
                           
                         transportation problems. Although in a practical sense, this results in a good performance (see Section 5), from a worst-case point of view, this computational effort does not pay off.
                           Theorem 6
                           
                              The approximation ratio of Iterated TP
                              
                              +
                              
                              R is at most 
                              
                                 
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           

For the example in Fig. 4, the worst case optimal solution vector to the TP (note that there are several optimal solution vectors) is:
                                 
                                    (30)
                                    
                                       
                                          
                                             x
                                          
                                          
                                             12
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             21
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             32
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             41
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       
                                          
                                             x
                                          
                                          
                                             11
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             22
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             31
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             42
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

Thus, after the first iteration of the algorithm, we get:
                                 
                                    (31)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             ij
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             
                                                
                                                   ij
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                    
                                 
                              
                              
                                 
                                    (32)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                              
                           

Consider that we set 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    {
                                    2
                                    }
                                 
                              . Resolving the TP, the optimal solution vector is:
                                 
                                    (33)
                                    
                                       
                                          
                                             x
                                          
                                          
                                             12
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             21
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             41
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       
                                          
                                             x
                                          
                                          
                                             11
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             22
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             31
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             32
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             42
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

Thus:
                                 
                                    (34)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      1
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             1
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             1
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                    
                                 
                              
                              
                                 
                                    (35)
                                    
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       1
                                       ,
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                ∈
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             2
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                             2
                                          
                                          
                                             ∗
                                          
                                       
                                       =
                                       0
                                       .
                                    
                                 
                              
                           

And finally, 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          R
                                       
                                    
                                    =
                                    {
                                    1
                                    ,
                                    2
                                    }
                                 
                               and 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          B
                                       
                                    
                                    =
                                    ∅
                                 
                              . Solving the TPs on the subgraphs results in:
                                 
                                    (36)
                                    
                                       V
                                       (
                                       ITP
                                       +
                                       R
                                       )
                                       =
                                       V
                                       (
                                       B
                                       ∪
                                       
                                          
                                             D
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       +
                                       V
                                       (
                                       R
                                       ∪
                                       
                                          
                                             D
                                          
                                          
                                             R
                                          
                                       
                                       )
                                       =
                                       0
                                       +
                                       2
                                       =
                                       2
                                       .
                                    
                                 
                              
                           

Again, we know that 
                                 
                                    OPT
                                    =
                                    4
                                 
                              . Thus:
                                 
                                    (37)
                                    
                                       
                                          
                                             V
                                             (
                                             ITP
                                             +
                                             R
                                             )
                                          
                                          
                                             OPT
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                       
                                       □
                                    
                                 
                              
                           

In this section, we discuss a number of generalizations of Max-Red–Blue TP. One generalization arises when capacities are placed on the edges, i.e. for each edge, the flow transported over it cannot exceed the capacity of the edge. With a small modification (solving capacitated transportation problems on the red and the blue subgraph), the MAX-RB algorithm will produce a feasible solution to this problem. Moreover, MAX-RB still has a tight approximation ratio of 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                        , since the arguments used in Theorem 4 remain valid.

In another generalization, we allow any topology of the underlying graph. The graph no longer needs to be bipartite; supply nodes, as well as demand nodes, can be joined by an edge. Transferring nodes (i.e. nodes with zero net supply or demand), are allowed as well. The goal is to find a profit-maximizing way to send flow from supply nodes to demand nodes, such that each demand node receives its flow from supply nodes that are either all red or all blue. The MAX-RB algorithm can be adapted as follows: we solve an uncapacitated min-cost flow problem on the red (blue) subgraph, i.e. we set the supply of the blue (red) nodes equal to zero, and return the solution vector that results in the highest solution value. Also for this generalization, a tight approximation ratio of 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                         holds.

In a third generalization, we no longer impose that 
                           
                              R
                              ∩
                              B
                              =
                              ∅
                           
                        , instead we allow the existence of supply nodes that are both red and blue. We call these nodes colorful. The color constraints imply that a demand node can receive supply from either red nodes and colorful nodes, or blue nodes and colorful nodes. Of course, if all supply nodes are colorful, a TP arises. Again, it is easy to see that the MAX-RB keeps its approximation ratio of 
                           
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                           
                        ; the transportation problem on the red subgraph, as well as the one on the blue subgraph, now include the colorful supply nodes.

Finally, Max-Red–Blue TP can be generalized to a K-color variant. In this case, we are given a weighted bipartite graph 
                           
                              G
                              (
                              S
                              ∪
                              D
                              ,
                              E
                              )
                           
                         with 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    C
                                 
                                 
                                    K
                                 
                              
                              ⊆
                              S
                              ,
                              
                                 
                                    ⋃
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              =
                              S
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ∩
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              ∅
                           
                         for any 
                           
                              1
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              K
                           
                        , with 
                           
                              E
                              ⊆
                              S
                              ×
                              D
                           
                        . The problem is to find a maximum weighted flow from S to D with respect to supply and demand constraints, and the additional constraint that no two nodes 
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              1
                              ⩽
                              
                                 
                                    k
                                 
                                 
                                    1
                                 
                              
                              <
                              
                                 
                                    k
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              K
                           
                         can send flow to the same demand node 
                           
                              j
                              ∈
                              D
                           
                        . The MAX-RB algorithm can be generalized to this setting, by solving transportation problems on the subgraphs induced by 
                           
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                              ∪
                              D
                           
                        , for each color k. Also, the TP+R algorithm can be generalized to this setting by solving a transportation problem and next identifying which color gives the largest profit to each demand node. The proofs in Theorems 4 and 5 can trivially be generalized to show that both algorithms guarantee an approximation ratio of at least 
                           
                              
                                 
                                    1
                                 
                                 
                                    K
                                 
                              
                           
                        . However, the approximation ratio of the generalization of Iterated TP+R to this K-color setting remains open.

The following example shows that the bound 
                           
                              
                                 
                                    1
                                 
                                 
                                    K
                                 
                              
                           
                         is tight for both algorithms. Consider a complete bipartite graph 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              =
                              {
                              1
                              ,
                              …
                              ,
                              K
                              }
                              ,
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              =
                              {
                              K
                              +
                              1
                              ,
                              …
                              ,
                              2
                              K
                              }
                              ,
                              …
                              ,
                              
                                 
                                    C
                                 
                                 
                                    K
                                 
                              
                              =
                              {
                              (
                              K
                              -
                              1
                              )
                              K
                              +
                              1
                              ,
                              …
                              ,
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                              }
                           
                         and 
                           
                              D
                              =
                              {
                              1
                              ,
                              …
                              ,
                              K
                              }
                           
                        . All supply nodes have 
                           
                              
                                 
                                    a
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , all demand nodes have 
                           
                              
                                 
                                    b
                                 
                                 
                                    j
                                 
                              
                              =
                              K
                           
                        . We denote:
                           
                              (38)
                              
                                 1
                                 =
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       e
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          1
                                       
                                    
                                    
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          j
                                       
                                    
                                    
                                       
                                          ⋮
                                       
                                    
                                    
                                       
                                          K
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Then the profit matrix is:
                           
                              (39)
                              
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   ⋱
                                                
                                                
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         K
                                                         -
                                                         1
                                                      
                                                   
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Observe that the optimum value equals 
                           
                              
                                 
                                    K
                                 
                                 
                                    2
                                 
                              
                           
                        , which is achieved by sending all supply from the nodes in 
                           
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                           
                         to demand node k, 
                           
                              k
                              =
                              1
                              ,
                              …
                              ,
                              K
                           
                        . Further, observe that, when applying the generalization of MAX-RB, or the generalization of TP+R, it may happen that the supply of the nodes in each 
                           
                              
                                 
                                    C
                                 
                                 
                                    k
                                 
                              
                           
                         (
                           
                              1
                              ⩽
                              k
                              ⩽
                              K
                           
                        ) is distributed over the K demand nodes, leading to a value of K.

We have studied the behavior of the proposed formulations and heuristics with respect to the following problem characteristics:
                           
                              •
                              PS: the problem size (
                                    
                                       |
                                       S
                                       |
                                       +
                                       |
                                       D
                                       |
                                    
                                 , with 
                                    
                                       |
                                       S
                                       |
                                       =
                                       |
                                       D
                                       |
                                    
                                 ).

PR: the proportion of red supply nodes 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      |
                                                      R
                                                      |
                                                   
                                                   
                                                      |
                                                      S
                                                      |
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .

DEN: the density of the graph 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      |
                                                      E
                                                      |
                                                   
                                                   
                                                      |
                                                      S
                                                      |
                                                      ×
                                                      |
                                                      D
                                                      |
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .

To this purpose, we have generated a set of test instances according to a full factorial design with the characteristics described in Table 2
                        . The procedure for generating these instances is described in Appendix A; the instances are available online (Vancroonenburg, 2013).

For Red–Blue TP, we have tested and compared the tightness of the LP-relaxations of Formulations 1 and 2, as well as the average computation times for each formulation and its linear relaxation. It is important to note that due to the instance generation procedure, infeasible instances may be generated for which no solution to the integer formulations or the LP-relaxations exists. Thus, the results on these instances are not considered in the forthcoming discussion and table (the number of feasible instances is included in the table).

For the maximization version, Max-Red–Blue TP, we compare the performances of the approximation algorithms, MAX-RB, TP+R and Iterated TP+R, with respect to the integer optimum of Formulation 1. In this setting, feasibility is not an issue as the 
                           
                              0
                           
                        -vector is always a feasible solution.

This experimental setup has been coded in the C++ programming language and was compiled with the GNU Compiler Collection (GCC) 4.6.3. The IP-formulations and the LP-relaxation of Formulation 2 were implemented and solved with IBM Cplex 12.5, using the network simplex algorithm. The LP-formulation of Formulation 1 was implemented as a minimum-cost flow problem, and was implemented and solved with the network simplex algorithm in LEMON 1.3 (Library for Efficient Modeling and Optimization in Networks) from the COIN-OR initiative. The approximation algorithms MAX-RB, TP+R and Iterated TP+R also make use of a minimum-cost flow problem implementation in LEMON 1.3 for solving the transportation problem on the respective (sub) graphs.

All tests were done on a workstation computer equipped with two Intel Xeon 2670 2.6GHz processors and 128GB of main memory (RAM), which was running a Linux-based operating system. The MIP solver was configured to use only one processing thread, so this system was used to solve up to 16 instances in parallel (limiting the MIP solver to 8GB of memory for each instance).

@&#RESULTS@&#

The effect of increasing the problem size (PS) from 50 to 400 nodes is summarized in Table 3
                            for Red–Blue TP. For each setting of PS, the results are averaged over all feasible instances of 240 instances; 10 instances for each of the parameter settings of PR and DEN. It is clear that the computation time of both models increases as the problem size grows, and that the difference in computation time between the two formulations also increases, indicating that Formulation 2 scales worse than Formulation 1. This is expected, as Formulation 2 has a quadratic number of y variables for each source/destination pair, whereas Formulation 1 only has a y variable for each destination node. Furthermore, the exclusionary constraints are also quadratic in number for Formulation 2, whereas they are linear in number for Formulation 1.

We can clearly see that for both formulations, the LP-relaxation becomes tighter as the problem size increases; i.e. the gap, defined as 
                              
                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             IP
                                          
                                       
                                       -
                                       
                                          
                                             V
                                          
                                          
                                             LP
                                          
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             IP
                                          
                                       
                                    
                                 
                              
                           , decreases. Of course, then the difference between the LP-relaxations of both formulations also becomes smaller as the problem size grows. A possible explanation for this observation is that the impact of a single color constraint decreases when more nodes (or more edges) are present.

The proportion of red vs. blue nodes (PR) has a clear impact on the performance of both formulations, shown in Table 3. For each setting of PS, the results are averaged over all feasible instances of 320 instances; 10 instances for each of the parameter settings of PS and DEN. It shows that for Red–Blue TP the LP relaxation of Formulation 2 is tighter than Formulation 1, and the difference in tightness between the two formulations increases as the percentage of red nodes grows to 50%. However, as this percentage increases, the computation time for both formulations also grows, and faster for Formulation 2 than for Formulation 1. At 0% red nodes, both models reduce to the Transportation Problem, and the linear relaxation equals the integer optimum.

Finally, the effect of varying the density of the underlying graph (DEN), from 25% to 100% is also summarized in Table 3. For each setting of DEN, the results are averaged over all feasible instances of 480 instances; 10 instances for each of the parameter settings of PS and PR. It is clear that as the density grows to 100%, the gap between the integer optimum and the LP-relaxation of Formulation 1 and 2 decreases. Notice that computation times for Formulation 1 seem to be highest for a 50% density. For Formulation 2, the density for which computation times are highest, is larger, which can be explained by the fact that the number of constraints is directly dependent on the number of edges. Furthermore, the difference in gap between Formulation 1 and Formulation 2 becomes smaller as the density increases. Thus, the benefit of the stronger LP-relaxation of Formulation 2 again reduces as the density grows to 100%.

It is clear that although Formulation 2 has a tighter LP-relaxation than Formulation 1, this difference decreases as all factors considered (problem size, percentage red nodes, density) grow. Furthermore, in all cases the computation time increases much faster for Formulation 2 than for Formulation 1. This results in a large amount of computation time when trying to find an integer optimum using Formulation 2. Table 3 reports the number of instances that timed out after 3600s. It shows that for PS>200 nodes increasingly more instances cannot be solved in less than 1h, and in fact (not reported in the table) some instances cannot be solved to optimality in less than 24h. It is also clear that this is highly related to the ratio red/blue nodes. Therefore, we advocate using Formulation 1 over Formulation 2 in all cases.

We can also report the same effects concerning the problem size, proportion of red nodes, and the density for the maximization version of Red–Blue TP. Given that the results are basically the same, we have omitted the corresponding table from this paper.

The computational results for the approximation algorithms are summarized in Table 4
                           , showing the relative gap between the heuristic result and the integer optimum, as well as the computation time, while the problem size, the percentage of red nodes, and the density of the network increase.

Overall, the gap with the integer optimum is considerably smaller for the ITP+R heuristic (again, with an exception for the special case where all supply nodes have the same color) than both MAX-RB and TP+R. MAX-RB, obviously being the most naive algorithm, performs worst of all and almost reaches its worst case behavior on instances where the percentage of red nodes is equal to 50%. It must be noted, however, that none of these heuristics dominates any of the other heuristics. Indeed, for each of the heuristics, instances were found for which it outperforms the others.

The fact that with ITP+R, the number of transportation problems that need to be solved increases with the number of demand nodes explains that the computation time increases faster than with TP+R, where only three transportation problems need to be solved, irrespective of the problem size.

@&#CONCLUSION@&#

In this paper, we discussed Red–Blue TP, which is a very natural generalization of the transportation problem, namely where supply nodes receive one of two colors, and demand nodes cannot receive flow from supply nodes with different colors. We settled the complexity status, showing that Red–Blue TP is NP-hard, and a constant-factor approximation is not likely to exist, even in a number of special cases. We discussed two IP formulations: although we can show that one formulation is strictly stronger than the other, experimental results show that the stronger formulation requires increasingly more computation time than the weaker formulation, as the problem size, the percentage of red nodes, or the density of the graph increase.

We also considered a maximization variant of Red–Blue TP, which is interesting with respect to approximation. We developed three approximation algorithms, each of which guarantee an approximation ratio of 
                        
                           
                              
                                 1
                              
                              
                                 2
                              
                           
                        
                     . Computational experiments show that Iterated TP+R achieves the best approximation on most instances, at the expense of considerable computation times. Finally, we discussed a number of generalizations of Max-Red–Blue TP, including a variant with K colors.

@&#ACKNOWLEDGEMENTS@&#

This research is funded by a Ph.D. grant of the agency for Innovation by Science and Technology (IWT). This work is further supported by the Interuniversity Attraction Poles Programme initiated by the Belgian Science Policy Office, and by FWO grant G.0729.13.

The procedure for generating instances is described in Algorithm 4.
                        Algorithm 4
                        Red–Blue TP instance generation procedure
                              
                                 
                                    
                                    
                                       
                                          
                                             Require: 
                                                
                                                   |
                                                   S
                                                   |
                                                   ,
                                                   |
                                                   D
                                                   |
                                                   ,
                                                   PR
                                                   ,
                                                   DEN
                                                   ,
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   ,
                                                   seed
                                                
                                             
                                          
                                       
                                       
                                          
                                             1: 
                                                
                                                   RAND
                                                   ←
                                                   seed
                                                
                                             
                                          
                                       
                                       
                                          
                                             2: 
                                                
                                                   R
                                                   ←
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   PR
                                                   ·
                                                   |
                                                   S
                                                   |
                                                   }
                                                   ,
                                                   B
                                                   ←
                                                   {
                                                   PR
                                                   ·
                                                   |
                                                   S
                                                   |
                                                   +
                                                   
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   |
                                                   S
                                                   |
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                             3: 
                                                
                                                   S
                                                   ←
                                                   R
                                                   ∪
                                                   B
                                                   ,
                                                   D
                                                   ←
                                                   {
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   |
                                                   D
                                                   |
                                                   }
                                                
                                             
                                          
                                       
                                       
                                          
                                             4: 
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         total
                                                      
                                                   
                                                   ←
                                                   0
                                                
                                             
                                          
                                       
                                       
                                          
                                             5: for 
                                             
                                                
                                                   i
                                                   ←
                                                   1
                                                   ,
                                                   …
                                                   ,
                                                   |
                                                   S
                                                   |
                                                
                                              
                                             do
                                          
                                       
                                       
                                          
                                             6: 
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ←
                                                   RAND
                                                   (
                                                   1
                                                   ,
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                             7: 
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         total
                                                      
                                                   
                                                   ←
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         total
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             8: end for
                                          
                                       
                                       
                                          
                                             9: 
                                                
                                                   T
                                                   ←
                                                   UNIQUERAND
                                                   (
                                                   1
                                                   ,
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         total
                                                      
                                                   
                                                   -
                                                   1
                                                   ,
                                                   |
                                                   D
                                                   |
                                                   -
                                                   1
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          10: 
                                                
                                                   SORT
                                                   (
                                                   T
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          11: 
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   -
                                                   0
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         j
                                                         -
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         |
                                                         D
                                                         |
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         total
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         |
                                                         D
                                                         |
                                                         -
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          12: for 
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ∈
                                                   S
                                                   ×
                                                   D
                                                
                                              
                                             do
                                          
                                       
                                       
                                          13: 
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ←
                                                   RAND
                                                   (
                                                   0
                                                   ,
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         max
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          14: end for
                                          
                                       
                                       
                                          15: for 
                                             
                                                
                                                   k
                                                   ∈
                                                   (
                                                   1
                                                   -
                                                   DEN
                                                   )
                                                   ·
                                                   |
                                                   S
                                                   |
                                                   ×
                                                   |
                                                   D
                                                   |
                                                
                                             
                                          
                                       
                                       
                                          16: 
                                             
                                                
                                                   (
                                                   i
                                                   ,
                                                   j
                                                   )
                                                   ←
                                                   UNIQUERAND
                                                   (
                                                   S
                                                   ×
                                                   D
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          17: 
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ←
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          18: end for
                                          
                                       
                                       
                                          19: return Red-Blue TP 
                                                
                                                   (
                                                   S
                                                   ,
                                                   D
                                                   ,
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   ,
                                                   (
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                   ,
                                                   (
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   )
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The procedure generates Red–Blue TP instances according to the following parameters:
                        
                           •
                           
                              
                                 
                                    |
                                    S
                                    |
                                    ,
                                    |
                                    D
                                    |
                                 
                              : the number of supply and demand nodes,


                              PR: the percentage of red supply nodes in the graph,


                              DEN: the density of the graph,


                              
                                 
                                    
                                       
                                          S
                                       
                                       
                                          max
                                       
                                    
                                 
                              : the maximum supply for any give supply node,


                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          max
                                       
                                    
                                 
                              : the maximum cost (or profit, for Max-Red–Blue TP) for any given edge in the bipartite graph,


                              seed: a seed value for the pseudo-random number generator.

Supply nodes are generated with supply 
                        
                           
                              
                                 a
                              
                              
                                 i
                              
                           
                        
                      randomly selected in 
                        
                           [
                           1
                           ,
                           
                              
                                 S
                              
                              
                                 max
                              
                           
                           ]
                        
                     . The procedure ensures that total supply meets total demand by randomly dividing total supply over 
                        
                           |
                           D
                           |
                        
                      demand nodes (see Fig. A.5
                     ). First, 
                        
                           |
                           D
                           |
                           -
                           1
                        
                      unique numbers between 0 and 
                        
                           
                              
                                 S
                              
                              
                                 total
                              
                           
                        
                      (the total supply) are generated. Next, these numbers are sorted and the demand nodes are then generated as the pairwise difference between these numbers. Finally, to reduce the density of the graph, edges of the graph are randomly selected and removed (indicated by setting 
                        
                           
                              
                                 c
                              
                              
                                 ij
                              
                           
                           =
                           -
                           1
                        
                     ).

@&#REFERENCES@&#

