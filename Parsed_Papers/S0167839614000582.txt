@&#MAIN-TITLE@&#Local and global analysis of parametric solid sweeps

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A complete computational framework for solid sweep is proposed.


                        
                        
                           
                           A novel classification of sweeps into simple, decomposable & nondecomposable is given.


                        
                        
                           
                           A geometric invariant locates all the trim curves for nondecomposable sweeps.


                        
                        
                           
                           The funnel serves as the parametrization space for the envelope.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Solid sweep

Boundary representation

Parametric curves and surfaces

Solid modelling

@&#ABSTRACT@&#


               
               
                  In this work, we propose a structured computational framework for modelling the envelope of the swept volume, that is the boundary of the volume obtained by sweeping an input solid along a trajectory of rigid motions. Our framework is adapted to the well-established industry-standard brep format to enable its implementation in modern CAD systems. This is achieved via a “local analysis”, which covers parametrizations and singularities, as well as a “global theory” which tackles face-boundaries, self-intersections and trim curves. Central to the local analysis is the “funnel” which serves as a natural parameter space for the basic surfaces constituting the sweep. The trimming problem is reduced to the problem of surface–surface intersections of these basic surfaces. Based on the complexity of these intersections, we introduce a novel classification of sweeps as decomposable and non-decomposable. Further, we construct an invariant function θ on the funnel which efficiently separates decomposable and non-decomposable sweeps. Through a geometric theorem we also show intimate connections between θ, local curvatures and the inverse trajectory used in earlier works as an approach towards trimming. In contrast to the inverse trajectory approach of testing points, θ is a computationally robust global function. It is the key to a complete structural understanding, and an efficient computation of both, the singular locus and the trim curves, which are central to a stable implementation. Several illustrative outputs of a pilot implementation are included.
               
            

@&#INTRODUCTION@&#

This paper is motivated by the need for a robust implementation of solid sweeps in solid modelling kernels. The solid sweep is of course, the envelope surface of a solid which is swept in space by a family of rotations and translations. The uses of sweeps are many, e.g., in the design of scrolls,
                        1
                     
                     
                        1
                        Kinsley Inc., Timing screw for grouping and turning, https://www.youtube.com/watch?v=LooYoMM5DEo.
                      in CNC machining verification (Seok and Nestler, 2011a, 2011b), to detect collisions, and so on. Constant radius blends can be considered as the partial envelope of a sphere moving along a specified path. As with blends (Heidi, 2012), it is expected that a deeper mathematical understanding of solid sweep will lead to its rapid deployment and use.

A robust implementation of solid sweep poses the following requirements: (i) allow for input models specified in the industry-standard brep format, (ii) output the sweep envelope in the brep format, with effective evaluators, and finally, (iii) perform body-check, i.e., a check on the orientability, non-self-intersection, detection of singularities and so on. Thus there are some “local” parts and some “global” parts to a robust implementation of sweeps.

It is generally recognized that the harder parts of the local theory is in the smooth case, i.e., when faces of the swept solid meet each other smoothly. For in the non-smooth case, the added complexity in the local geometry of the sweep is exactly that of a curve moving in 3-space. This is of course well understood, and offered by many kernels as a basic surface type. As far as we know, the global situation in the non-smooth case, i.e., the topological structure of edges and vertices (i.e., the 1-cage) of the sweep has not been elucidated, but is also generally assumed to be simpler than the smooth case. In fact, much of existing literature has focused on a smooth single-face solid, as the key problem (Abdel-Malek and Yeh, 1997; Blackmore et al., 1997, 1999).

In this paper, we focus on the smooth multi-face solid. In Section 2, we start with the mathematical structure of the simple sweep (i.e., one without singularities and self-intersections). By the calculus of curves of contact, we set up a correspondence between the faces, edges and vertices of the envelope with those of the swept solid. This sets up the brep structure of the envelope. Next, we define the funnel as the parametrization space of a face of the envelope and construct a parametrization. We further elucidate the structure of the bounding edges/vertices of a face and provide several examples of simple sweeps from a pilot implementation.

In Section 3, we examine the trim structures. The funnel of Section 2 will remain the ambient parametrization of the faces. The correspondence will help us define the trim areas and trim curves which must be excised to form the correct envelope. We then define the function ℓ and use it to define elementary and singular trim curves.

In Section 4, we start with the decomposable sweep, i.e., one which may be partitioned into a suitable small collection of simple sweeps. In principle, the final envelope may be obtained by stable (transversal) boolean operations on this collection. We show that the trim curves so obtained are elementary. We next define a global invariant θ on the funnel, which is robustly and efficiently computable on the funnel and we show that 
                        θ
                        >
                        0
                      on (all) the funnels characterizes decomposability. This is an important step in the robust implementation of sweeps.

In Section 5, we prove some of the geometric properties of θ such as its invariance and show that it is the determinant of the transformation connecting two 2-frames on the envelope, and is thus an easily computable function on the surface. We show that the 
                        θ
                        =
                        0
                      curve on the funnel is also the singular locus for the envelope surface. We also show the relation of θ with the inverse trajectory (Blackmore et al., 1999).

In Section 6, we analyse the singular trim curve, i.e., where ℓ may hit zero. We show that there is a correspondence between singular trim curves and the curves in the zero-locus of θ. We also show that (i) singular trim curves make contact with the 
                        θ
                        =
                        0
                      curves, and (ii) excision at the singular trim curves excises all singularities of the envelope except at these points of contact. These points themselves are easily and robustly computed.

In Section 7 we summarize what has been achieved, viz., that the decomposability and the zero-locus of θ complement to give a complete understanding of all trim curves. We illustrate this through some examples. Finally, we outline future work.


                     Previous work. We now review existing related work. Perhaps the most elaborate proposal for the sweep surface 
                        E
                      is the sweep envelope differential equations (Blackmore et al., 1997) approach, where the authors (i) assume that surface S being swept is implicitly given by a function f, and (ii) derive a differential equation whose solution is the envelope. For any point p on the initial curve of contact, a Runge–Kutta marching yields a trajectory 
                        p
                        (
                        t
                        )
                      such that (i) 
                        p
                        (
                        0
                        )
                        =
                        p
                     , and (ii) 
                        p
                        (
                        t
                        )
                        ∈
                        C
                        (
                        t
                        )
                     , the curve of contact at time t. These trajectories presumably serve as the iso-parametric lines 
                        p
                        (
                        t
                        )
                        =
                        E
                        (
                        t
                        ,
                        u
                        (
                        p
                        )
                        )
                     . Determining whether 
                        p
                        (
                        t
                        )
                      is in the trimming set T is solved by using the inverse trajectory condition. This is implemented by using the second derivative of the function 
                        ϕ
                        (
                        x
                        ,
                        t
                        )
                        =
                        f
                        (
                        η
                        (
                        x
                        ,
                        t
                        )
                        )
                     , where η is the inverse trajectory of point x.

On the global front, the building of the envelope 
                        E
                      is done by selecting a collection of points on the initial curve of contact, developing trajectories, testing for membership in T and then using the points which pass to construct an approximation to the envelope. The drawbacks are clear. Typically, when S is presented as a brep, constructing an f which defines S is difficult. Furthermore, the choice of f seems to determine many computational and parametric issues, which is undesirable. The inverse-trajectory check remains poorly conditioned, especially when the second derivative of the function 
                        ϕ
                        (
                        x
                        ,
                        t
                        )
                      w.r.t. t is zero, a situation which arises repeatedly. The structure of the envelope is unknown at a point where this derivative is zero. A global understanding of T and the nature of the trim curves is missing. A surface is fit through the points which pass the inverse trajectory test. Hence, an important feature, namely, G1-discontinuity along the trim curve on the envelope is missed out by this method. Further, since only sampled points are subjected to inverse trajectory test, some portion of the trimming set T may be left undetected.

In Erdim and Ilies (2008), the authors give a membership test for a point in the object space to belong inside, outside or on the boundary of the swept volume. This is done by studying the interaction of inverse trajectory of the point in question with the solid at initial position. A curve-solid intersection is required to be computed for each point membership query which is computationally expensive, especially when the intersection is non-transversal, as noted by the authors. Further, this approach yields a procedural implicit representation of the envelope. In practice, a parametric representation is often desirable so that it is efficient to produce points on the envelope.

In Erdim and Ilies (2007) the authors work with 2D shapes and 2D motions and quantify singularities using inverse trajectories. This work is based on the computational framework described in Erdim and Ilies (2008) and involves computing intersections between 2D curves and 2D shapes. The authors remark that this work can be extended to the 3-dimensional case involving intersections between 3D curves and 3D solids. This approach has the same drawback as Erdim and Ilies (2008), namely a high computational cost and the obvious limitation of dimensionality.

In trimming self-intersections in swept volumes (Xu et al., 2008), the authors detect self-intersections by computing approximate curves of contact at a few discrete time instances which are then checked for intersections. Approximations are introduced at multiple levels, hence such an approach is not likely to meet the accuracy standards of most CAD kernels.

In Rossignac et al. (2007), the authors approximate the given trajectory by a continuous, piecewise screw motion and generate candidate faces of the swept surface. In order to performing trimming, inverse trajectory is used. Limitation of this method is clear, namely, restricted class of motions along which the sweep occurs.

In Zhang and Kim (2009), the authors present an error-bounded approximation of the envelope of the volume swept by a polyhedron along a parametric trajectory. Authors use volumetric approach using adaptive grid to provide guarantee about the correctness of the topology of the swept volume. This approach, however, cannot be readily extended to sweep smooth solids.

In this section we formulate the boundary of the volume obtained by sweeping a solid M along a given trajectory h.

We will use the boundary representation, also known as brep, which is a popular standard for representing a compact and oriented solid M by its boundary ∂M. The boundary ∂M separates the interior of M from the exterior of M and is represented using a set of faces, edges and vertices. See Fig. 1
                         for the brep of a solid where different faces are coloured differently. Faces meet in edges and edges meet in vertices. The brep consists of two interconnected pieces of information, viz., the geometric and the topological. The geometric information consists of the parametric description of the faces and edges while the topological information consists of orientation of the geometric entities and adjacency relations between them.

In this paper we consider solids whose boundary is formed by faces meeting smoothly. In the case when the faces do not meet smoothly, the added complexity in the local geometry of the sweep is exactly that of a curve moving in 3-space. This is of course well understood, and offered by many kernels as a basic surface type. The global geometry and topology for this case will be described in a later paper.


                        
                           Definition 1
                           A trajectory in 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                               is specified by a map
                                 
                                    
                                       h
                                       :
                                       I
                                       →
                                       
                                          (
                                          
                                             SO
                                          
                                          (
                                          3
                                          )
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                          )
                                       
                                       ,
                                       
                                       h
                                       (
                                       t
                                       )
                                       =
                                       
                                          (
                                          A
                                          (
                                          t
                                          )
                                          ,
                                          b
                                          (
                                          t
                                          )
                                          )
                                       
                                    
                                 
                               where I is a closed interval of 
                                 R
                              , 
                                 A
                                 (
                                 t
                                 )
                                 ∈
                                 
                                    SO
                                 
                                 (
                                 3
                                 )
                              ,
                                 2
                              
                              
                                 2
                                 
                                    
                                       
                                          SO
                                       
                                       (
                                       3
                                       )
                                       =
                                       {
                                       X
                                        is a 
                                       3
                                       ×
                                       3
                                        real matrix
                                       |
                                       
                                          
                                             X
                                          
                                          
                                             t
                                          
                                       
                                       ⋅
                                       X
                                       =
                                       I
                                       ,
                                       det
                                       (
                                       X
                                       )
                                       =
                                       1
                                       }
                                     is the special orthogonal group, i.e. the group of rotational transforms.
                               
                              
                                 b
                                 (
                                 t
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              . The parameter t represents time.

We assume that h is of class 
                           
                              
                                 C
                              
                              
                                 k
                              
                           
                         for some 
                           k
                           ≥
                           2
                        , i.e., partial derivatives of order up to k exist and are continuous.

We make the following key assumption about 
                           (
                           M
                           ,
                           h
                           )
                        . 
                           Assumption 2
                           The tuple 
                                 (
                                 M
                                 ,
                                 h
                                 )
                               is in a general position.


                        
                           Definition 3
                           The action of h (at time t in I) on M is given by 
                                 M
                                 (
                                 t
                                 )
                                 =
                                 {
                                 A
                                 (
                                 t
                                 )
                                 ⋅
                                 x
                                 +
                                 b
                                 (
                                 t
                                 )
                                 |
                                 x
                                 ∈
                                 M
                                 }
                              . The swept volume 
                              
                                 V
                               is the union 
                                 
                                    
                                       ⋃
                                    
                                    
                                       t
                                       ∈
                                       I
                                    
                                 
                                 M
                                 (
                                 t
                                 )
                               and the envelope 
                              
                                 E
                               is defined as the boundary of the swept volume 
                                 V
                              .

Clearly, for each point y of 
                           E
                         there must be an 
                           x
                           ∈
                           M
                         and a 
                           t
                           ∈
                           I
                         such that 
                           y
                           =
                           A
                           (
                           t
                           )
                           ⋅
                           x
                           +
                           b
                           (
                           t
                           )
                        . This sets up the following correspondence relation.


                        
                           Definition 4
                           The correspondence 
                              R is the set of tuples
                                 
                                    
                                       R
                                       =
                                       
                                          {
                                          (
                                          y
                                          ,
                                          x
                                          ,
                                          t
                                          )
                                          ∈
                                          E
                                          ×
                                          M
                                          ×
                                          I
                                          |
                                          y
                                          =
                                          A
                                          (
                                          t
                                          )
                                          ⋅
                                          x
                                          +
                                          b
                                          (
                                          t
                                          )
                                          }
                                       
                                    
                                 
                               For 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 I
                              , we set 
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 :
                                 =
                                 {
                                 (
                                 y
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 ∈
                                 R
                                 |
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 }
                              . Similarly, for 
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 E
                              , we define 
                                 
                                    
                                       R
                                    
                                    
                                    
                                       
                                          
                                             y
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                 
                                 :
                                 =
                                 {
                                 (
                                 y
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 ∈
                                 R
                                 |
                                 y
                                 =
                                 
                                    
                                       y
                                    
                                    
                                       0
                                    
                                 
                                 }
                              .

We will denote the interior of a set W by 
                           
                              
                                 W
                              
                              
                                 o
                              
                           
                        . It is clear that 
                           
                              
                                 V
                              
                              
                                 o
                              
                           
                           =
                           
                              
                                 ⋃
                              
                              
                                 t
                                 ∈
                                 I
                              
                           
                           M
                           
                              
                                 (
                                 t
                                 )
                              
                              
                                 o
                              
                           
                        . Therefore, we have


                        
                           Lemma 5
                           
                              If 
                              
                                 x
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                              
                              , then for all 
                              
                                 t
                                 ∈
                                 I
                              
                              , 
                              
                                 A
                                 (
                                 t
                                 )
                                 ⋅
                                 x
                                 +
                                 b
                                 (
                                 t
                                 )
                                 ∉
                                 E
                              
                              .
                           

Thus, the points in the interior of M do not contribute to 
                           E
                         at all and 
                           R
                           ⊂
                           E
                           ×
                           ∂
                           M
                           ×
                           I
                        .


                        
                           Lemma 6
                           
                              Assuming general position of 
                              
                                 (
                                 M
                                 ,
                                 h
                                 )
                              
                              , for any 
                              
                                 y
                                 ∈
                                 E
                              
                              , there are at most three distinct tuples 
                              
                                 (
                                 y
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                               
                              for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                               
                              which belong to 
                              
                                 
                                    
                                       R
                                    
                                    
                                    
                                       y
                                    
                                    
                                 
                              
                              .
                           


                        
                           Proof
                           For distinct tuples 
                                 (
                                 y
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ,
                                 (
                                 y
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                    
                                       y
                                    
                                    
                                 
                              , it is clear that 
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                              , for otherwise 
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                              . Therefore 
                                 ∂
                                 M
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                               and 
                                 ∂
                                 M
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                               intersect at point y. By Assumption 2 this intersection is transversal. Further, by the same assumption, at most 3 surfaces may intersect in a point.  □

It will be shown in the coming sections that for almost all points 
                           y
                           ∈
                           E
                         there is exactly one tuple 
                           (
                           y
                           ,
                           x
                           ,
                           t
                           )
                         in 
                           
                              
                                 R
                              
                              
                              
                                 y
                              
                              
                           
                        . This sets up the brep structure for 
                           E
                        . In the sweep example shown in Fig. 1, the correspondence R is illustrated via colour coding, i.e., for 
                           (
                           y
                           ,
                           x
                           ,
                           t
                           )
                           ∈
                           R
                        , the points y and x are shown in the same colour. The general position assumption on 
                           (
                           M
                           ,
                           h
                           )
                         can be formulated as the condition that the induced brep topology of 
                           E
                         remains invariant under a small perturbation of 
                           (
                           M
                           ,
                           h
                           )
                        .


                        
                           Definition 7
                           For a point 
                                 x
                                 ∈
                                 M
                              , define the trajectory of 
                              
                                 x
                               as the map 
                                 
                                    
                                       γ
                                    
                                    
                                       x
                                    
                                 
                                 :
                                 I
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                               given by 
                                 
                                    
                                       γ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 A
                                 (
                                 t
                                 )
                                 ⋅
                                 x
                                 +
                                 b
                                 (
                                 t
                                 )
                               and the velocity 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 t
                                 )
                               as 
                                 
                                    
                                       v
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       γ
                                    
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                                 ⋅
                                 x
                                 +
                                 
                                    
                                       b
                                    
                                    
                                       ′
                                    
                                 
                                 (
                                 t
                                 )
                              .

For a point 
                           x
                           ∈
                           ∂
                           M
                        , let 
                           N
                           (
                           x
                           )
                         be the unit outward normal to M at x. Define the function 
                           g
                           :
                           ∂
                           M
                           ×
                           I
                           →
                           R
                         as
                           
                              (1)
                              
                                 g
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 
                                    〈
                                    A
                                    (
                                    t
                                    )
                                    ⋅
                                    N
                                    (
                                    x
                                    )
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          x
                                       
                                    
                                    (
                                    t
                                    )
                                    〉
                                 
                              
                           
                         Thus, 
                           g
                           (
                           x
                           ,
                           t
                           )
                         is the dot product of the velocity vector with the unit normal at the point 
                           
                              
                                 γ
                              
                              
                                 x
                              
                           
                           (
                           t
                           )
                           ∈
                           ∂
                           M
                           (
                           t
                           )
                        .


                        Proposition 8 gives a necessary condition for a point 
                           x
                           ∈
                           ∂
                           M
                         to contribute a point on 
                           E
                         at time t, namely, 
                           
                              
                                 γ
                              
                              
                                 x
                              
                           
                           (
                           t
                           )
                        , and is a rewording in our notation of the statement in Blackmore et al. (1997) that the candidate set is the union of the ingress, the egress and the grazing set of points.


                        
                           Proposition 8
                           
                              For 
                              
                                 (
                                 y
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 ∈
                                 R
                               
                              and 
                              
                                 I
                                 =
                                 [
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ]
                              
                              , either (i) 
                              
                                 g
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 0
                               
                              or (ii) 
                              
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                               
                              and 
                              
                                 g
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 ≤
                                 0
                              
                              , or (iii) 
                              
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                               
                              and 
                              
                                 g
                                 (
                                 x
                                 ,
                                 t
                                 )
                                 ≥
                                 0
                              
                              .
                           

For the proof, refer Appendix A. 
                           Definition 9
                           For a fixed time instant 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 I
                              , the set 
                                 {
                                 
                                    
                                       γ
                                    
                                    
                                       x
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 |
                                 x
                                 ∈
                                 ∂
                                 M
                                 ,
                                 g
                                 (
                                 x
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                                 }
                               is referred to as the curve of contact at 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                               and denoted by 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . Observe that 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ⊂
                                 ∂
                                 M
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . The union of the curves of contact is referred to as the contact set and denoted by 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                              , i.e., 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 =
                                 
                                    
                                       ⋃
                                    
                                    
                                       t
                                       ∈
                                       I
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                              .

In the sweep example in Fig. 4, the curve of contact at 
                           t
                           =
                           0
                         is shown imprinted on the solid in red. The curves of contact are referred to as the characteristic curves in Peternell et al. (2005).


                        
                           Definition 10
                           Define projections 
                                 τ
                                 :
                                 R
                                 →
                                 I
                               and 
                                 Y
                                 :
                                 R
                                 →
                                 E
                               as: 
                                 τ
                                 (
                                 y
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 t
                               and 
                                 Y
                                 (
                                 y
                                 ,
                                 x
                                 ,
                                 t
                                 )
                                 =
                                 y
                              .


                        
                           Definition 11
                           A sweep 
                                 (
                                 M
                                 ,
                                 h
                                 ,
                                 I
                                 )
                               is said to be simple if for all 
                                 t
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       o
                                    
                                 
                              , 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 Y
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       t
                                    
                                 
                                 )
                              .

Note that, by Proposition 8, for any sweep, we have 
                           Y
                           (
                           
                              
                                 R
                              
                              
                                 t
                              
                           
                           )
                           ⊆
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                           (
                           t
                           )
                         for all 
                           t
                           ∈
                           
                              
                                 I
                              
                              
                                 o
                              
                           
                        . In a simple sweep, we require that 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                           (
                           t
                           )
                           =
                           Y
                           (
                           
                              
                                 R
                              
                              
                                 t
                              
                           
                           )
                        . In other words, every point on the contact-set appears on the envelope, and thus, no trimming of the contact-set is needed in order to obtain the envelope.


                        
                           Lemma 12
                           
                              For a simple sweep, for all 
                              
                                 y
                                 ∈
                                 E
                              
                              , 
                              
                                 
                                    
                                       R
                                    
                                    
                                    
                                       y
                                    
                                    
                                 
                               
                              is a singleton set.
                           


                        
                           Proof
                           We first show that for a simple sweep, for 
                                 t
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                              , 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 ∩
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 ∅
                              . Suppose that 
                                 y
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 ∩
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              . Clearly, 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 ⊂
                                 ∂
                                 M
                                 (
                                 t
                                 )
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊂
                                 ∂
                                 M
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              . Hence 
                                 y
                                 ∈
                                 ∂
                                 M
                                 (
                                 t
                                 )
                                 ∩
                                 ∂
                                 M
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              . By Assumption 2 about the general position of 
                                 (
                                 M
                                 ,
                                 h
                                 )
                              , 
                                 ∂
                                 M
                                 (
                                 t
                                 )
                               and 
                                 ∂
                                 M
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                               intersect transversally. Hence 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 ∩
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ≠
                                 ∅
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ∩
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 t
                                 )
                                 ≠
                                 ∅
                              . It follows by Lemma 5 that 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 t
                                 )
                                 ⊄
                                 Y
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       t
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ⊄
                                 Y
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                               which contradicts the fact that 
                                 (
                                 M
                                 ,
                                 h
                                 ,
                                 I
                                 )
                               is simple.

Now suppose that there are 2 tuples 
                                 (
                                 y
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                    
                                       y
                                    
                                    
                                 
                               for 
                                 i
                                 =
                                 1
                                 ,
                                 2
                              . Since ∂M is free from self-intersections it follows that 
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                               and 
                                 y
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                               which is a contradiction to the fact that 
                                 (
                                 M
                                 ,
                                 h
                                 ,
                                 I
                                 )
                               is simple.  □

Now we describe parametrizations of the various entities of the induced brep structure of 
                           E
                        . Here we restrict to the case of the simple sweep. The more general case is derived from this.

Let F be a face of ∂M. In general, F gives rise to a set of faces of 
                              E
                           . Below we describe a natural parametrization of these faces using the parametrization of the surface underlying the face F.


                           
                              Definition 13
                              A smooth/regular parametric surface in 
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  is a smooth map 
                                    S
                                    :
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    →
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  such that at all 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                  
                                 
                                    
                                       
                                          ∂
                                          S
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  and 
                                    
                                       
                                          ∂
                                          S
                                       
                                       
                                          ∂
                                          v
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                0
                                             
                                          
                                          )
                                       
                                    
                                    ∈
                                    
                                       
                                          R
                                       
                                       
                                          3
                                       
                                    
                                  are linearly independent. Here u and v are called the parameters of the surface.

Let S be the regular surface underlying the face F of ∂M. 
                              Definition 14
                              Define the function 
                                    f
                                    :
                                    
                                       
                                          R
                                       
                                       
                                          2
                                       
                                    
                                    ×
                                    I
                                    →
                                    R
                                  as 
                                    f
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    t
                                    )
                                    =
                                    g
                                    (
                                    S
                                    (
                                    u
                                    ,
                                    v
                                    )
                                    ,
                                    t
                                    )
                                 .

The domain of function f will be referred to as the parameter space. Note that f is easily and robustly computed. 
                              Definition 15
                              For an interval 
                                    I
                                    =
                                    [
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 , we define the following subsets of the parameter space
                                    
                                       
                                          L
                                          =
                                          
                                             {
                                             (
                                             u
                                             ,
                                             v
                                             ,
                                             t
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                             ×
                                             {
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                
                                             
                                             }
                                              such that 
                                             f
                                             (
                                             u
                                             ,
                                             v
                                             ,
                                             t
                                             )
                                             ≤
                                             0
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          F
                                          =
                                          
                                             {
                                             (
                                             u
                                             ,
                                             v
                                             ,
                                             t
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                             ×
                                             I
                                              such that 
                                             f
                                             (
                                             u
                                             ,
                                             v
                                             ,
                                             t
                                             )
                                             =
                                             0
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          R
                                          =
                                          
                                             {
                                             (
                                             u
                                             ,
                                             v
                                             ,
                                             t
                                             )
                                             ∈
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                             ×
                                             {
                                             
                                                
                                                   t
                                                
                                                
                                                   1
                                                
                                             
                                             }
                                              such that 
                                             f
                                             (
                                             u
                                             ,
                                             v
                                             ,
                                             t
                                             )
                                             ≥
                                             0
                                             }
                                          
                                       
                                    
                                 
                              

The set 
                              F
                            will be referred to as the funnel.

By Assumption 2 about the general position of 
                              (
                              M
                              ,
                              h
                              )
                            it follows that for all 
                              p
                              ∈
                              F
                           , the gradient 
                              ∇
                              f
                              (
                              p
                              )
                              =
                              
                                 
                                    [
                                    
                                       
                                          f
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    p
                                    )
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    p
                                    )
                                    ,
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    p
                                    )
                                    ]
                                 
                                 
                                    T
                                 
                              
                              ≠
                              
                                 
                                    0
                                 
                                 
                                    ¯
                                 
                              
                           . As a consequence, 
                              F
                            is a smooth, orientable surface in the parameter space.


                           
                              Definition 16
                              The set 
                                    {
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    t
                                    )
                                    ∈
                                    F
                                    |
                                    t
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    }
                                  will be referred to as the p-curve of contact at 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                  and denoted by 
                                    F
                                    (
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 .

We now define the sweep map from the parameter space to the object space. 
                              Definition 17
                              The sweep map is defined as follows.
                                    
                                       
                                          σ
                                          :
                                          
                                             
                                                R
                                             
                                             
                                                2
                                             
                                          
                                          ×
                                          I
                                          →
                                          
                                             
                                                R
                                             
                                             
                                                3
                                             
                                          
                                          ,
                                          
                                          σ
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          t
                                          )
                                          =
                                          A
                                          (
                                          t
                                          )
                                          ⋅
                                          S
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          +
                                          b
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              

Note that, σ is a smooth map, 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                              =
                              σ
                              (
                              F
                              )
                            and 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                              (
                              t
                              )
                              =
                              σ
                              (
                              F
                              (
                              t
                              )
                              )
                           . Here and later, by a slight abuse of notation, 
                              E
                           , 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                              (
                              t
                              )
                            denote the appropriate parts of complete 
                              E
                           , 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                              (
                              t
                              )
                            respectively resulting from the face 
                              F
                              ⊂
                              ∂
                              M
                            whose underlying surface is S. The surface patches 
                              σ
                              (
                              L
                              )
                            and 
                              σ
                              (
                              R
                              )
                            will be referred to as the left and right end-caps respectively.

The funnel, the contact-set, 
                              F
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            and 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            are shown schematically in Fig. 2
                           .

The condition 
                              f
                              =
                              0
                            can also be looked upon as the rank deficiency condition (Abdel-Malek and Yeh, 1997) of the Jacobian 
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                            of the sweep map σ. To make this precise, let
                              
                                 (2)
                                 
                                    
                                       
                                          J
                                       
                                       
                                          σ
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          3
                                          ×
                                          3
                                       
                                    
                                 
                              
                            where 
                              
                                 
                                    σ
                                 
                                 
                                    u
                                 
                              
                              =
                              A
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    ∂
                                    S
                                 
                                 
                                    ∂
                                    u
                                 
                              
                              (
                              u
                              ,
                              v
                              )
                           , 
                              
                                 
                                    σ
                                 
                                 
                                    v
                                 
                              
                              =
                              A
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    ∂
                                    S
                                 
                                 
                                    ∂
                                    v
                                 
                              
                              (
                              u
                              ,
                              v
                              )
                            and 
                              
                                 
                                    σ
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              ⋅
                              S
                              (
                              u
                              ,
                              v
                              )
                              +
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                           . Note that if 
                              S
                              (
                              u
                              ,
                              v
                              )
                              =
                              x
                            then 
                              
                                 
                                    σ
                                 
                                 
                                    t
                                 
                              
                              =
                              
                                 
                                    γ
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                            is the velocity, also denoted by 
                              V
                              (
                              u
                              ,
                              v
                              ,
                              t
                              )
                           . Observe that regularity of S ensures that 
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                            has rank at least 2. Further, it is easy to show that 
                              f
                              (
                              u
                              ,
                              v
                              ,
                              t
                              )
                            is a non-zero scalar multiple of the determinant of 
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                           . Therefore, the condition 
                              f
                              =
                              0
                            is precisely the rank deficiency condition of 
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                           .

For a simple sweep, by Proposition 8, Definition 11 and Definition 15 it follows that 
                              E
                              =
                              σ
                              (
                              L
                              ∪
                              F
                              ∪
                              R
                              )
                           . The surface patches 
                              σ
                              (
                              L
                              )
                            and 
                              σ
                              (
                              R
                              )
                            can be obtained from ∂M using Proposition 8 and Definition 15. The trim curve in parameter space for 
                              σ
                              (
                              L
                              )
                            is given by 
                              f
                              (
                              u
                              ,
                              v
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                            and that for 
                              σ
                              (
                              R
                              )
                            is given by 
                              f
                              (
                              u
                              ,
                              v
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              0
                           .

We now come to the parametrization of 
                              σ
                              (
                              F
                              )
                              =
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           . The non-singularity of f makes 
                              F
                            an effective parametrization space for 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           . Since time t is a central parameter of the sweep problem and is important in numerous applications, it is useful to have t as one of the parameters of 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           . Since in a simple sweep, 
                              σ
                              
                                 
                                    |
                                 
                                 
                                    F
                                 
                              
                              :
                              F
                              →
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                            is a diffeomorphism onto its image, we may address the problem of parameterizing 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                            by parameterizing the funnel 
                              F
                           . For most non-trivial sweeps there is no closed form solution for the parametrization of the envelope and we address this problem using the procedural paradigm which is now standard in many kernels and is described in Appendix C. In this approach, a set of evaluators are constructed for the curve/surface via numerical procedures which converge to the solution up to the required tolerance. This has the advantage of being computationally efficient as well as accurate.

We now look at the bounding edges of the faces resulting from the face F of ∂M, which are generated by the bounding edges of F.

We now briefly describe the computation of edges of 
                              E
                            via the correspondence R. If ∂M is composed of faces meeting smoothly, an edge e of ∂M will, in general, give rise to a set of edges in 
                              E
                           . We define the restriction of R to the edge e as follows. 
                              Definition 18
                              For an edge 
                                    e
                                    ∈
                                    ∂
                                    M
                                 , define 
                                    R
                                    (
                                    e
                                    )
                                    =
                                    {
                                    (
                                    y
                                    ,
                                    x
                                    ,
                                    t
                                    )
                                    ∈
                                    R
                                    |
                                    x
                                    ∈
                                    e
                                    }
                                 .

Let e be the intersection of faces 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                            in ∂M and let s denote the parameter of e. Since 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                            meet smoothly at e, at every point 
                              e
                              (
                              s
                              )
                            of e there is a well-defined normal. Hence we may define the following function on the parameter space 
                              R
                              ×
                              I
                           .


                           
                              Definition 19
                              Define the function 
                                    
                                       
                                          f
                                       
                                       
                                          e
                                       
                                    
                                    :
                                    R
                                    ×
                                    I
                                    →
                                    R
                                  as 
                                    
                                       
                                          f
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    =
                                    g
                                    (
                                    e
                                    (
                                    s
                                    )
                                    ,
                                    t
                                    )
                                 .

Note that the function 
                              
                                 
                                    f
                                 
                                 
                                    e
                                 
                              
                            is the restriction of the function f defined in Definition 14 to the parameter space curve 
                              (
                              u
                              (
                              s
                              )
                              ,
                              v
                              (
                              s
                              )
                              )
                            corresponding to the edge e so that 
                              e
                              (
                              s
                              )
                              =
                              S
                              (
                              u
                              (
                              s
                              )
                              ,
                              v
                              (
                              s
                              )
                              )
                            where S is the surface underlying face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           . The following lemma gives a necessary condition for a point 
                              e
                              (
                              s
                              )
                            to be on 
                              E
                            at time t. 
                              Lemma 20
                              
                                 For 
                                 
                                    (
                                    y
                                    ,
                                    e
                                    (
                                    s
                                    )
                                    ,
                                    t
                                    )
                                    ∈
                                    R
                                    (
                                    e
                                    )
                                  
                                 and 
                                 
                                    I
                                    =
                                    [
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                                 , either (i) 
                                 
                                    t
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    ≤
                                    0
                                 
                                 , or (ii) 
                                 
                                    t
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          1
                                       
                                    
                                  
                                 and 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    ≥
                                    0
                                  
                                 or (iii) 
                                 
                                    
                                       
                                          f
                                       
                                       
                                          e
                                       
                                    
                                    (
                                    s
                                    ,
                                    t
                                    )
                                    =
                                    0
                                 
                                 .
                              


                           
                              Proof
                              This follows from Proposition 8 and Definition 19.  □


                           Fig. 3
                            shows the edges of the envelope for the sweep example shown in Fig. 1. The correspondence for one of the edges of the envelope is also marked.

Let 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            denote the funnel corresponding to the contact set generated by face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           . The edge in parameter space which bounds 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                            is given by 
                              {
                              (
                              u
                              (
                              s
                              )
                              ,
                              v
                              (
                              s
                              )
                              ,
                              t
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ×
                              I
                              |
                              
                                 
                                    f
                                 
                                 
                                    e
                                 
                              
                              (
                              s
                              ,
                              t
                              )
                              =
                              0
                              }
                            which we will denote by 
                              
                                 
                                    F
                                 
                                 
                                    e
                                 
                              
                           . Note that 
                              
                                 
                                    F
                                 
                                 
                                    e
                                 
                              
                            is smooth if 
                              (
                              
                                 
                                    f
                                 
                                 
                                    s
                                 
                                 
                                    e
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                                 
                                    e
                                 
                              
                              )
                              =
                              (
                              
                                 
                                    f
                                 
                                 
                                    u
                                 
                              
                              ⋅
                              
                                 
                                    u
                                 
                                 
                                    s
                                 
                              
                              +
                              
                                 
                                    f
                                 
                                 
                                    v
                                 
                              
                              ⋅
                              
                                 
                                    v
                                 
                                 
                                    s
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                              )
                              ≠
                              (
                              0
                              ,
                              0
                              )
                            at all points in 
                              
                                 
                                    F
                                 
                                 
                                    e
                                 
                              
                           .

A vertex z on ∂M will, in general, give rise to a set of vertices on 
                              E
                           . We further restrict the correspondence R to z as 
                              R
                              (
                              z
                              )
                              =
                              {
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              ∈
                              R
                              |
                              x
                              =
                              z
                              }
                           . As ∂M is smooth, there is a well-defined normal at z. Hence we may define the function 
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              :
                              I
                              →
                              R
                            as 
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              (
                              t
                              )
                              =
                              g
                              (
                              z
                              ,
                              t
                              )
                           . If z is on the boundary of a face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           , z will have a set of coordinates in the parameter space of the surface S underlying the face 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                           , say 
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              )
                           , so that 
                              z
                              =
                              S
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              )
                           . It is easy to see that if 
                              (
                              y
                              ,
                              z
                              ,
                              t
                              )
                              ∈
                              R
                              (
                              z
                              )
                            and 
                              I
                              =
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ]
                            then either (i) 
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              (
                              t
                              )
                              ≤
                              0
                           , or (ii) 
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              (
                              t
                              )
                              ≥
                              0
                            or (iii) 
                              
                                 
                                    f
                                 
                                 
                                    z
                                 
                              
                              (
                              t
                              )
                              =
                              0
                           .

Three examples of simple sweeps are shown in Figs. 4, 5 and 6
                        
                        
                         which were generated using a pilot implementation of our algorithm in the ACIS 3D Modeler.
                           3
                        
                        
                           3
                           ACIS 3D Modeler, SPATIAL, www.spatial.com/products/3d-acis-modeling.
                         A curve of contact at the initial time is shown imprinted on the solid in Fig. 4.

Unlike in a simple sweep, all points of 
                        
                           
                              C
                           
                           
                              I
                           
                        
                      may not belong to the envelope. Fig. 7
                      shows an example of such a sweep. In Fig. 7(b) the contact set restricted to the later half of the sweep interval is shown after removing the set of points which does not belong to the envelope. We now define the subset of 
                        
                           
                              C
                           
                           
                              I
                           
                        
                      which needs to be excised in order to obtain 
                        E
                     . 
                        Definition 21
                        The trim set is defined as
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          I
                                       
                                    
                                    :
                                    =
                                    
                                       {
                                       x
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             I
                                          
                                       
                                       |
                                       ∃
                                       t
                                       ∈
                                       I
                                       ,
                                       x
                                       ∈
                                       
                                          
                                             M
                                          
                                          
                                             o
                                          
                                       
                                       (
                                       t
                                       )
                                       }
                                    
                                 
                              
                           
                        

By Lemma 5 it is clear that 
                        
                           
                              T
                           
                           
                              I
                           
                        
                        ∩
                        E
                        =
                        ∅
                     . The correspondence in Definition 4 does not capture the points of 
                        
                           
                              C
                           
                           
                              I
                           
                        
                      which do not belong to the envelope. In order to identify such points, we extend the correspondence of Definition 4 to 
                        
                           
                              C
                           
                           
                              I
                           
                        
                        ×
                        M
                        ×
                        I
                      as below.


                     
                        Definition 22
                        Let 
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              :
                              =
                              {
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                              ×
                              M
                              ×
                              I
                              |
                              y
                              =
                              A
                              (
                              t
                              )
                              ⋅
                              x
                              +
                              b
                              (
                              t
                              )
                              }
                           . As expected, we define 
                              τ
                              :
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              →
                              I
                            and 
                              Y
                              :
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              →
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                            as: 
                              τ
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              =
                              t
                            and 
                              Y
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              =
                              y
                           . Further, as before, 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              :
                              =
                              {
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              |
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              }
                           , 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                              
                              :
                              =
                              {
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                              |
                              y
                              =
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              }
                           .

A crucial observation is that, unlike the earlier correspondence, 
                        
                           
                              R
                           
                           
                              ˜
                           
                        
                        ⊄
                        
                           
                              C
                           
                           
                              I
                           
                        
                        ×
                        ∂
                        M
                        ×
                        I
                      simply because 
                        
                           
                              R
                           
                           
                              ˜
                           
                        
                      may contain a tuple 
                        (
                        y
                        ,
                        x
                        ,
                        t
                        )
                      where 
                        x
                        ∈
                        
                           
                              M
                           
                           
                              o
                           
                        
                     . In other words, for 
                        
                           
                              x
                           
                           
                              ′
                           
                        
                        ∈
                        ∂
                        M
                      and 
                        y
                        =
                        
                           
                              γ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        (
                        
                           
                              t
                           
                           
                              ′
                           
                        
                        )
                        ∈
                        
                           
                              C
                           
                           
                              I
                           
                        
                     , it may happen that 
                        
                           
                              γ
                           
                           
                              
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        (
                        
                           
                              t
                           
                           
                              ′
                           
                        
                        )
                        =
                        
                           
                              γ
                           
                           
                              x
                           
                        
                        (
                        t
                        )
                      for some 
                        t
                        ≠
                        
                           
                              t
                           
                           
                              ′
                           
                        
                      and some 
                        x
                        ∈
                        
                           
                              M
                           
                           
                              o
                           
                        
                     . In this case, 
                        
                           
                              
                                 
                                    R
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                           
                              y
                           
                           
                        
                      will not be a singleton set.


                     
                        Lemma 23
                        
                           The set 
                           
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            
                           is open in 
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           .
                        


                     
                        Proof
                        Consider a point 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . Then 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            for some 
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ∈
                              I
                           . Hence, there exists an open ball of non-zero radius r centred at 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                           , denote it by 
                              B
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ,
                              r
                              )
                           , which is itself contained in 
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           . Let 
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              B
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ,
                              r
                              )
                              ∩
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           . Then, 
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                              ⊂
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            and 
                              
                                 
                                    N
                                 
                                 
                                    0
                                 
                              
                            is open in 
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . Hence 
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            is open in 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           .  □

In general, the trim set will span several parts of 
                        
                           
                              C
                           
                           
                              I
                           
                        
                      corresponding to different faces of ∂M. For the ease of notation and presentation, in the rest of this paper, we will analyse the corresponding trim structures on the funnel of a fixed face F of ∂M. Thanks to the natural parametrizations (cf. Subsection 2.2), the migration of these trim structures across different funnels is an easy implementation detail. In view of this, we carry forward the notation developed in Subsection 2.2.1 through the rest of this paper.


                     
                        Definition 24
                        The pre-image of 
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            on the funnel under the map σ will be referred to as the p-trim set, denoted by 
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           , i.e., 
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                              )
                              ∩
                              F
                           .

An immediate corollary of Lemma 23 is: 
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      is open in 
                        F
                     .

One can also define similar parametric trim areas on the left and right caps (cf. 
                        L
                      and 
                        R
                      from Definition 15) and their counterparts in the object space. However, in this paper, we assume here that these trim structures are empty. Our analysis can be extended to also cover the non-empty case.


                     
                        Definition 25
                        The boundary of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       I
                                    
                                 
                                 ¯
                              
                            will be referred to as the trim curves and denoted by 
                              ∂
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . Here 
                              
                                 
                                    
                                       T
                                    
                                    
                                       I
                                    
                                 
                                 ¯
                              
                            denotes the closure of 
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            in 
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           . Similarly, the boundary of the closure 
                              
                                 
                                    p
                                    
                                       
                                          T
                                       
                                       
                                          I
                                       
                                    
                                 
                                 ¯
                              
                            of 
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            in 
                              F
                            will be referred to as the p-trim curves and denoted by 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           .

Note that 
                        E
                        ∩
                        
                           
                              T
                           
                           
                              I
                           
                        
                        =
                        ∅
                     , 
                        E
                        ∩
                        
                           
                              
                                 T
                              
                              
                                 I
                              
                           
                           ¯
                        
                        =
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      and 
                        σ
                        (
                        F
                        ∖
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                        )
                        =
                        E
                     . Since 
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      forms the boundary of the trim set, the problem of excising the trim set is reduced to the problem of computing the trim curves. Further, this computation is eventually reduced to guided parametric surface–surface intersections via the parametrization of 
                        σ
                        (
                        F
                        )
                      described in Section 2.2. In order to characterize the points of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      we define the following function.


                     
                        Definition 26
                        For 
                              p
                              =
                              (
                              u
                              ,
                              v
                              ,
                              t
                              )
                              ∈
                              F
                           , let 
                              σ
                              (
                              p
                              )
                              =
                              y
                           . Define 
                              L
                              :
                              F
                              →
                              
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                            as 
                              L
                              (
                              p
                              )
                              :
                              =
                              τ
                              (
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    y
                                 
                                 
                              
                              )
                           , where 
                              
                                 
                                    2
                                 
                                 
                                    R
                                 
                              
                            denotes the set of all subsets of 
                              R
                           . In other words, 
                              L
                              (
                              p
                              )
                            is the set of all time instances 
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                            (except t) such that some point of 
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              )
                            coincides with 
                              σ
                              (
                              p
                              )
                           .


                     
                        Lemma 27
                        
                           Let 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    p
                                    
                                       
                                          T
                                       
                                       
                                          I
                                       
                                    
                                 
                                 ¯
                              
                           
                           . Then 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            
                           iff 
                           
                              L
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            
                           contains an interval, and 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            
                           iff 
                           
                              L
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            
                           is a discrete set of cardinality either two or three.
                        


                     
                        Proof
                        Suppose first that 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . Let 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                           . Then 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            for some 
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ∈
                              I
                           . Let 
                              B
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ,
                              r
                              )
                            be an open ball of radius 
                              r
                              >
                              0
                            centred at 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                            contained in 
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           . Assume without loss of generality that 
                              A
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              I
                            and 
                              b
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           . By continuity of the trajectory h it follows that given 
                              r
                              >
                              0
                            there exists 
                              δ
                              t
                              >
                              0
                            such that for all 
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              +
                              δ
                              t
                              ]
                           , 
                              ‖
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              −
                              A
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              −
                              b
                              (
                              t
                              )
                              ‖
                              <
                              r
                           . Thus for each 
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              +
                              δ
                              t
                              ]
                           , there exists a point 
                              x
                              =
                              
                                 
                                    A
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              t
                              )
                              ⋅
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              −
                              b
                              (
                              t
                              )
                              )
                              ∈
                              B
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ,
                              r
                              )
                            satisfying 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              =
                              A
                              (
                              t
                              )
                              ⋅
                              x
                              +
                              b
                              (
                              t
                              )
                           , i.e., 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              t
                              )
                           . In other words, 
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              +
                              δ
                              t
                              ]
                              ∈
                              L
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                           .

Conversely, suppose that 
                              L
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            contains an interval 
                              [
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ]
                           , i.e., 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              M
                              (
                              t
                              )
                            for all 
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ]
                           . By Assumption 2 about the general position of 
                              (
                              M
                              ,
                              h
                              )
                            it follows that 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              t
                              )
                            for some 
                              t
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              ]
                           , i.e., 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            and 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . We have shown that for 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    p
                                    
                                       
                                          T
                                       
                                       
                                          I
                                       
                                    
                                 
                                 ¯
                              
                           , 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            iff 
                              L
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            contains an interval. Hence, 
                              L
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            is discrete iff 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           .

As 
                              ∂
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                              ⊂
                              E
                           , by Lemma 6, it follows that at all but finitely many points 
                              p
                              ∈
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           , 
                              L
                              (
                              p
                              )
                            is of cardinality 2 and at remaining points it is of cardinality 3.  □

From Lemma 27 it follows that for almost all points 
                        y
                        ∈
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      there are two points 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        ∈
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      such that 
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                        
                        )
                        =
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        )
                        =
                        y
                     . Fig. 8
                      schematically illustrates p-trim curves on 
                        F
                     . For every point 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      in the red portion of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                     , there is a point 
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                      in the green portion of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      such that 
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                        
                        )
                        =
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        )
                     .


                     
                        Definition 28
                        Define the function 
                              ℓ
                              :
                              F
                              →
                              R
                              ∪
                              ∞
                            as follows. For 
                              p
                              =
                              (
                              u
                              ,
                              v
                              ,
                              t
                              )
                              ∈
                              F
                           ,
                              
                                 
                                    ℓ
                                    (
                                    p
                                    )
                                    =
                                    
                                       inf
                                       
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          ∈
                                          L
                                          (
                                          p
                                          )
                                          ,
                                          
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                          ≠
                                          t
                                       
                                    
                                    
                                    
                                       ‖
                                       t
                                       −
                                       
                                          
                                             t
                                          
                                          
                                             ′
                                          
                                       
                                       ‖
                                    
                                    
                                    if 
                                    L
                                    (
                                    p
                                    )
                                     is not a singleton set
                                    ,
                                 
                              
                           
                           
                              
                                 
                                    
                                       ℓ
                                       (
                                       p
                                       )
                                    
                                    =
                                    ∞
                                    
                                    if 
                                    L
                                    (
                                    p
                                    )
                                     is a singleton set 
                                    
                                       (
                                       i.e.
                                       ,
                                       L
                                       (
                                       p
                                       )
                                       =
                                       {
                                       t
                                       }
                                       )
                                    
                                    .
                                 
                              
                            Further, we define 
                              
                                 t-sep
                              
                              =
                              
                                 
                                    inf
                                 
                                 
                                    p
                                    ∈
                                    F
                                 
                              
                              
                              ℓ
                              (
                              p
                              )
                           .

For 
                        p
                        ∈
                        F
                     , the function ℓ gives the ‘smallest’ time δt such that some point of 
                        M
                        (
                        t
                        ±
                        δ
                        t
                        )
                      coincides with 
                        σ
                        (
                        p
                        )
                     .

We classify trim curves as follows. 
                        Definition 29
                        A curve C of 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            is said to be elementary if there exists 
                              δ
                              >
                              0
                            such that for all 
                              p
                              ∈
                              C
                           , 
                              ℓ
                              (
                              p
                              )
                              >
                              δ
                           . It is said to be singular if 
                              
                                 
                                    inf
                                 
                                 
                                    p
                                    ∈
                                    C
                                 
                              
                              
                              ℓ
                              (
                              p
                              )
                              =
                              0
                           .


                     Figs. 8(a) and 8(b) schematically illustrate elementary and singular p-trim curves on 
                        F
                      respectively. Further observe that, 
                        
                           t-sep
                        
                        >
                        0
                      in case (a) and 0 in case (b). The trim curve in the example shown in Fig. 7 is elementary. The trim curves in examples shown in Figs. 12–15 are singular.

Before proceeding further, we introduce the following notation: for 
                        J
                        ⊂
                        I
                     , 
                        F
                        (
                        J
                        )
                        =
                        {
                        (
                        u
                        ,
                        v
                        ,
                        t
                        )
                        ∈
                        F
                        |
                        t
                        ∈
                        J
                        }
                     .


                     
                        Lemma 30
                        
                           All but finitely many points of elementary trim curves lie on the transversal intersections of two surface patches 
                           
                              σ
                              (
                              F
                              (
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                            
                           and the remaining points lie on the transversal intersection of three surface patches 
                           
                              σ
                              (
                              F
                              (
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                            
                           where, for 
                           
                              i
                              =
                              1
                              ,
                              2
                              ,
                              3
                           
                           , 
                           
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              I
                            
                           are subintervals.
                        


                     
                        Proof
                        Without loss of generality, assume that all curves of 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            are elementary, i.e., 
                              ∃
                              δ
                              >
                              0
                            such that for all 
                              p
                              ∈
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           , 
                              ℓ
                              (
                              p
                              )
                              >
                              δ
                           . By Lemma 27, all but finitely many points 
                              y
                              ∈
                              ∂
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            have two points 
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              =
                              (
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              =
                              (
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                            in 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            such that 
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              )
                              =
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              )
                              =
                              y
                           . Let 
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              :
                              =
                              F
                              (
                              [
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              −
                              δ
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              +
                              δ
                              ]
                              )
                            and 
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              :
                              =
                              F
                              (
                              [
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              −
                              δ
                              ,
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              +
                              δ
                              ]
                              )
                           . Then 
                              y
                              ∈
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              )
                              ∩
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              )
                           . It will be shown later (cf. Section 5.2) that 
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                            are tangential to 
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              )
                            respectively at y. By Assumption 2 about general position of 
                              (
                              M
                              ,
                              h
                              )
                           , 
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              )
                            intersect transversally at y. Hence, 
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    2
                                 
                              
                              )
                            intersect transversally at y.

At most finitely many points 
                              y
                              ∈
                              ∂
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            have three points 
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                            in 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            such that 
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              y
                           . By an argument similar to above, it can be shown that y lies on the transversal intersection of three surface patches 
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              )
                            for 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                            corresponding to appropriate subintervals 
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              I
                           . □


                     Fig. 7 shows an example in which a capsule is swept along a helical path while rotating about y-axis. The trim curves are elementary.

We now consider sweeps, which though not simple, can be divided into simple sweeps by partitioning the sweep interval. We show that in such sweeps, the trim curves can be obtained by transversal intersection of the contact set with itself, a task which the existing kernels can handle easily. Given an interval I, we call a partition 
                        P
                      of I into consecutive intervals 
                        
                           
                              I
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              I
                           
                           
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              I
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    P
                                 
                              
                           
                        
                      to be of width δ if 
                        max
                        {
                        
                           length
                        
                        (
                        
                           
                              I
                           
                           
                              1
                           
                        
                        )
                        ,
                        
                           length
                        
                        (
                        
                           
                              I
                           
                           
                              2
                           
                        
                        )
                        ,
                        …
                        ,
                        
                           length
                        
                        (
                        
                           
                              I
                           
                           
                              
                                 
                                    k
                                 
                                 
                                    P
                                 
                              
                           
                        
                        )
                        }
                        =
                        δ
                     . 
                        Definition 31
                        We say that the sweep 
                              (
                              M
                              ,
                              h
                              ,
                              I
                              )
                            is decomposable if there exists 
                              δ
                              >
                              0
                            such that for all partitions 
                              P
                            of I of width δ, each sweep 
                              (
                              M
                              ,
                              h
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                            is simple for 
                              i
                              =
                              1
                              ,
                              ⋯
                              ,
                              
                                 
                                    k
                                 
                                 
                                    P
                                 
                              
                           . A sweep which is not decomposable is called non-decomposable.


                     Fig. 9
                      schematically illustrates the difference between decomposable and non-decomposable sweeps. The example shown in Fig. 7 is of a decomposable sweep in which partitioning the sweep interval I into 2 equal halves will result in 2 simple sweeps.


                     
                        Proposition 32
                        
                           The sweep 
                           
                              (
                              M
                              ,
                              h
                              ,
                              I
                              )
                            
                           is decomposable iff 
                           
                              
                                 
                                    t-sep
                                 
                              
                              >
                              0
                           
                           . Further, if 
                           
                              
                                 
                                    t-sep
                                 
                              
                              >
                              0
                            
                           then all the p-trim curves are elementary.
                        


                     
                        Proof
                        Suppose first that 
                              
                                 t-sep
                              
                              >
                              0
                           . Let 
                              P
                            be a partition of I of width t-sep. We show that 
                              (
                              M
                              ,
                              h
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                            is simple for 
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              
                                 
                                    k
                                 
                                 
                                    P
                                 
                              
                           . Let 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            be the envelope and the contact set for 
                              (
                              M
                              ,
                              h
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                            respectively. By Proposition 8 (modulo end-caps), 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           . It needs to be shown that 
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ⊂
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                           . Suppose not. Let 
                              y
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              t
                              )
                            be such that 
                              y
                              ∉
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            for some 
                              t
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                           . Then, 
                              y
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           , i.e., 
                              y
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              )
                            for some 
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                           . By an argument similar to that given in Lemma 27 it can be shown that there exists 
                              δ
                              t
                              >
                              0
                            such that for all 
                              
                                 
                                    t
                                 
                                 
                                    ″
                                 
                              
                              ∈
                              [
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              −
                              δ
                              t
                              ,
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              +
                              δ
                              t
                              ]
                           , 
                              y
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    ″
                                 
                              
                              )
                           . Let 
                              y
                              =
                              σ
                              (
                              p
                              )
                            for 
                              p
                              =
                              (
                              u
                              ,
                              v
                              ,
                              t
                              )
                           . It follows that 
                              ℓ
                              (
                              p
                              )
                              <
                              ‖
                              t
                              −
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              ‖
                              ≤
                              
                                 length
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                              ≤
                              
                                 t-sep
                              
                           , leading to a contradiction. Hence, 
                              (
                              M
                              ,
                              h
                              ,
                              I
                              )
                            is decomposable.

Suppose now that 
                              (
                              M
                              ,
                              h
                              ,
                              I
                              )
                            is decomposable with width-parameter δ (cf. Definition 31). Consider a point 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              =
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ∈
                              F
                            and let 
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                           . Let 
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              =
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              −
                              δ
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ]
                            and 
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              =
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              +
                              δ
                              ]
                           . Further, let 
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            and 
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            be the envelope and contact-set for the sweeps 
                              (
                              M
                              ,
                              h
                              ,
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              )
                            respectively. Observe that 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                            for 
                              i
                              =
                              1
                              ,
                              2
                           . Let 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    i
                                 
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                              
                              =
                              {
                              (
                              y
                              ,
                              x
                              ,
                              t
                              )
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ×
                              M
                              ×
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              |
                              y
                              =
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              }
                           . As 
                              (
                              M
                              ,
                              h
                              ,
                              I
                              )
                            is decomposable with width-parameter δ, both 
                              (
                              M
                              ,
                              h
                              ,
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              )
                            and 
                              (
                              M
                              ,
                              h
                              ,
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              )
                            are simple, and hence, 
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              ⊂
                              
                                 
                                    E
                                 
                                 
                                    i
                                 
                              
                            for 
                              i
                              =
                              1
                              ,
                              2
                           . Therefore, 
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                            belongs to 
                              
                                 
                                    E
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    E
                                 
                                 
                                    2
                                 
                              
                           . By Lemma 12, 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    1
                                 
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    2
                                 
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                              
                            are both singleton sets. Further, 
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    1
                                 
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          ˜
                                       
                                    
                                 
                                 
                                 
                                    2
                                 
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                              
                              =
                              {
                              (
                              
                                 
                                    y
                                 
                                 
                                    0
                                 
                              
                              ,
                              x
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              }
                            for 
                              x
                              =
                              S
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              )
                              ∈
                              ∂
                              M
                           . Hence, 
                              ℓ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              >
                              δ
                           . Since for all 
                              p
                              ∈
                              F
                           , 
                              ℓ
                              (
                              p
                              )
                              >
                              δ
                           , we conclude that 
                              
                                 t-sep
                              
                              ≥
                              δ
                              >
                              0
                           .

Suppose that 
                              
                                 t-sep
                              
                              >
                              0
                           . Since 
                              ℓ
                              (
                              p
                              )
                              ≥
                              
                                 t-sep
                              
                            for all 
                              p
                              ∈
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            it follows that all the p-trim curves are elementary. □

The above proposition provides a natural test for decomposability. Further, coupled with Lemma 30, for a decomposable sweep, the problem of excising the trim set can be reduced to transversal intersections. However, note that, the very definition of t-sep is post-facto as it relies on the trim structures. Besides, it is the infimum value of the not necessarily continuous function ℓ and is difficult to compute. Thus, the above test of decomposability is not effective.

One of the key contributions of this paper is a novel geometric ‘invariant’ function on the funnel which is computed in closed form and serves the following objectives.
                        
                           (1)
                           Quick/efficient and simple detection of decomposability of sweeps, which occur most often in practice.

Generation of trim curves for non-decomposable sweeps.

Quantification and detection of singularities on the envelope.

For a point 
                        p
                        =
                        (
                        u
                        ,
                        v
                        ,
                        t
                        )
                        ∈
                        F
                     , let 
                        q
                        =
                        σ
                        (
                        p
                        )
                     . Recall from Section 2.2 that, 
                        
                           
                              J
                           
                           
                              σ
                           
                        
                        (
                        p
                        )
                        =
                        [
                        
                           
                              σ
                           
                           
                              u
                           
                        
                        
                           
                              σ
                           
                           
                              v
                           
                        
                        
                           
                              σ
                           
                           
                              t
                           
                        
                        ]
                      is of rank 2. As 
                        det
                        (
                        
                           
                              J
                           
                           
                              σ
                           
                        
                        (
                        p
                        )
                        )
                        =
                        0
                     , 
                        {
                        
                           
                              σ
                           
                           
                              u
                           
                        
                        (
                        p
                        )
                        ,
                        
                           
                              σ
                           
                           
                              v
                           
                        
                        (
                        p
                        )
                        ,
                        
                           
                              σ
                           
                           
                              t
                           
                        
                        (
                        p
                        )
                        }
                      are linearly dependent. Recall that 
                        
                           
                              σ
                           
                           
                              t
                           
                        
                        (
                        p
                        )
                        =
                        V
                        (
                        p
                        )
                      is the velocity of the point 
                        S
                        (
                        u
                        ,
                        v
                        )
                      at time t (cf. Section 2.2). As S is regular, the set 
                        {
                        
                           
                              σ
                           
                           
                              u
                           
                        
                        (
                        p
                        )
                        ,
                        
                           
                              σ
                           
                           
                              v
                           
                        
                        (
                        p
                        )
                        }
                      forms a basis for the tangent space to 
                        ∂
                        M
                        (
                        t
                        )
                     . Therefore, we must have 
                        
                           
                              σ
                           
                           
                              t
                           
                        
                        (
                        p
                        )
                        =
                        n
                        (
                        p
                        )
                        .
                        
                           
                              σ
                           
                           
                              u
                           
                        
                        (
                        p
                        )
                        +
                        m
                        (
                        p
                        )
                        .
                        
                           
                              σ
                           
                           
                              v
                           
                        
                        (
                        p
                        )
                      where n and m are well-defined (unique) on the funnel and are themselves continuous functions on the funnel.


                     
                        Definition 33
                        The function 
                              θ
                              :
                              F
                              →
                              R
                            is defined as follows.
                              
                                 (3)
                                 
                                    θ
                                    (
                                    p
                                    )
                                    =
                                    n
                                    (
                                    p
                                    )
                                    ⋅
                                    
                                       
                                          f
                                       
                                       
                                          u
                                       
                                    
                                    (
                                    p
                                    )
                                    +
                                    m
                                    (
                                    p
                                    )
                                    ⋅
                                    
                                       
                                          f
                                       
                                       
                                          v
                                       
                                    
                                    (
                                    p
                                    )
                                    −
                                    
                                       
                                          f
                                       
                                       
                                          t
                                       
                                    
                                    (
                                    p
                                    )
                                 
                              
                            where 
                              
                                 
                                    f
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                                 
                                    f
                                 
                                 
                                    v
                                 
                              
                            and 
                              
                                 
                                    f
                                 
                                 
                                    t
                                 
                              
                            denote partial derivatives of the function f w.r.t. u, v and t respectively at p, and n and m are as defined above.

Note that, unlike ℓ, θ is easily and robustly computable continuous function on the funnel. Now we are ready to state one of the main theorems of this paper.


                     
                        Theorem 34
                        
                           If for all 
                           
                              p
                              ∈
                              F
                           
                           , 
                           
                              θ
                              (
                              p
                              )
                              >
                              0
                           
                           , then the sweep is decomposable. Further, if there exists 
                           
                              p
                              ∈
                              F
                            
                           such that 
                           
                              θ
                              (
                              p
                              )
                              <
                              0
                           
                           , then the sweep is non-decomposable.
                        

The proof is given in Section 5.6 which highlights many other surprisingly strong properties of the function θ.


                     
                        Definition 35
                        The function θ partitions the funnel 
                              F
                            into three sets, viz. (i) 
                              
                                 
                                    F
                                 
                                 
                                    +
                                 
                              
                              :
                              =
                              {
                              p
                              ∈
                              F
                              |
                              θ
                              (
                              p
                              )
                              >
                              0
                              }
                           , (ii) 
                              
                                 
                                    F
                                 
                                 
                                    −
                                 
                              
                              :
                              =
                              {
                              p
                              ∈
                              F
                              |
                              θ
                              (
                              p
                              )
                              <
                              0
                              }
                            and (iii) 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              {
                              p
                              ∈
                              F
                              |
                              θ
                              (
                              p
                              )
                              =
                              0
                              }
                           . Further, we define 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    +
                                 
                              
                              :
                              =
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    +
                                 
                              
                              )
                           , 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    −
                                 
                              
                              :
                              =
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    −
                                 
                              
                              )
                            and 
                              
                                 
                                    
                                       
                                          C
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    0
                                 
                              
                              :
                              =
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              )
                           .


                     Fig. 10
                      schematically illustrates the sets 
                        
                           
                              F
                           
                           
                              +
                           
                        
                        ,
                        
                           
                              F
                           
                           
                              −
                           
                        
                      and 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      on the funnel and sets 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           
                              −
                           
                        
                        ,
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           
                              +
                           
                        
                      and 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           
                              0
                           
                        
                      on the contact set.

Note that, for 
                        (
                        M
                        ,
                        h
                        ,
                        I
                        )
                      in general position, either 
                        
                           
                              F
                           
                           
                              −
                           
                        
                      is a non-empty open set or 
                        F
                        =
                        
                           
                              F
                           
                           
                              +
                           
                        
                     . Whence, the above theorem provides an efficient ‘open’ test for decomposability, namely, a sweep 
                        (
                        M
                        ,
                        h
                        ,
                        I
                        )
                      is decomposable iff the open set 
                        
                           
                              F
                           
                           
                              −
                           
                        
                      is empty. By continuity of the function θ, the set 
                        
                           
                              F
                           
                           
                              −
                           
                        
                      is empty iff the set 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      is empty. Since 
                        F
                      is a smooth manifold, every point of 
                        F
                      is accessible via the procedural parametrization discussed in Appendix C. Most kernels will have an effective procedure for computing the set 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      provided ∇θ is non-zero on the curve 
                        
                           
                              F
                           
                           
                              0
                           
                        
                     . This is demonstrated in Section 5.3. Thus, all components of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      will be discovered for the same reason that most kernels discover all the intersections of two given solids.

In this section we prove some key properties of θ, namely, its invariance under the re-parametrization of the surface being swept and its relation with the notion of inverse trajectory used in earlier works. Finally, we use these properties along with Proposition 32, to prove Theorem 34.

We show that the function θ is invariant of the parametrization of ∂M and hence, intrinsic to the sweep.


                        
                           Theorem 36
                           
                              If 
                              
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                               
                              is a re-parametrization of the surface S so that 
                              
                                 q
                                 :
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 S
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              , and if 
                              
                                 g
                                 (
                                 q
                                 ,
                                 t
                                 )
                                 =
                                 0
                              
                              , then 
                              
                                 θ
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                                 =
                                 
                                    
                                       θ
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 t
                                 )
                              
                              .
                           


                        
                           Proof
                           Suppose as before that the boundary ∂M is specified by the parametrized surface S. Let 
                                 ϕ
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       2
                                    
                                 
                               be a re-parametrization map of S and 
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                                 :
                                 =
                                 S
                                 ∘
                                 ϕ
                              . Since ϕ is a diffeomorphism, dϕ is an isomorphism at every point in the entire domain of ϕ. Let 
                                 ϕ
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 (
                                 u
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 ,
                                 v
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 )
                              . For convenience of expression, we extend ϕ to define it on the parameter space of the sweep map σ so that 
                                 ϕ
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 t
                                 )
                                 =
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                              . Hence the re-parametrized sweep map (for 
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              ) is simply 
                                 
                                    
                                       σ
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 σ
                                 ∘
                                 ϕ
                              . Recall that 
                                 f
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                                 =
                                 〈
                                 
                                    
                                       N
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                                 ,
                                 V
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                                 〉
                              , where 
                                 
                                    
                                       N
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                               is the unit outward normal to 
                                 ∂
                                 M
                                 (
                                 t
                                 )
                               at the point 
                                 A
                                 (
                                 t
                                 )
                                 ⋅
                                 S
                                 (
                                 u
                                 ,
                                 v
                                 )
                                 +
                                 b
                                 (
                                 t
                                 )
                              . It is easy to check that 
                                 
                                    
                                       N
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                               can also be expressed as 
                                 A
                                 (
                                 t
                                 )
                                 ⋅
                                 (
                                 G
                                 ∘
                                 S
                                 )
                                 (
                                 u
                                 ,
                                 v
                                 )
                              , where 
                                 G
                                 :
                                 ∂
                                 M
                                 →
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               is the intrinsic Gauss map, 
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                               being the unit sphere and ∘ stands for the usual composition of functions. Thus,
                                 
                                    
                                       f
                                       (
                                       u
                                       ,
                                       v
                                       ,
                                       t
                                       )
                                       =
                                       
                                          〈
                                          
                                             
                                                N
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          t
                                          )
                                          ,
                                          V
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          t
                                          )
                                          〉
                                       
                                       =
                                       
                                          〈
                                          A
                                          (
                                          t
                                          )
                                          ⋅
                                          (
                                          G
                                          ∘
                                          S
                                          )
                                          (
                                          u
                                          ,
                                          v
                                          )
                                          ,
                                          V
                                          (
                                          u
                                          ,
                                          v
                                          ,
                                          t
                                          )
                                          〉
                                       
                                    
                                 
                               Similarly, computing with the re-parametrization 
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                              , and using the fact that 
                                 
                                    
                                       S
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 S
                                 ∘
                                 ϕ
                              , we have 
                                 
                                    
                                       f
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 f
                                 ∘
                                 ϕ
                              . Differentiating w.r.t. 
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                              , 
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                               and t we get 
                                 ∇
                                 
                                    
                                       f
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       ϕ
                                    
                                    
                                       T
                                    
                                 
                                 ⋅
                                 ∇
                                 f
                               where dϕ is the Jacobian of the map ϕ.

Observe that, from Eq. (3), for 
                                 
                                    
                                       p
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       ¯
                                    
                                 
                                 ,
                                 t
                                 )
                               and 
                                 p
                                 =
                                 ϕ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 =
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                              , 
                                 θ
                                 (
                                 p
                                 )
                                 =
                                 〈
                                 ∇
                                 f
                                 (
                                 p
                                 )
                                 ,
                                 z
                                 〉
                               where 
                                 z
                                 =
                                 (
                                 n
                                 ,
                                 m
                                 ,
                                 −
                                 1
                                 )
                               spans the null-space of 
                                 
                                    
                                       J
                                    
                                    
                                       σ
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       p
                                    
                                 
                               for 
                                 p
                                 ∈
                                 F
                              . In order to compute 
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                               for the re-parametrized sweep we see that 
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       J
                                    
                                    
                                       σ
                                    
                                 
                                 ∘
                                 d
                                 ϕ
                               and 
                                 
                                    
                                       z
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       ϕ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 z
                              . Now using 
                                 ∇
                                 
                                    
                                       f
                                    
                                    
                                       ¯
                                    
                                 
                                 =
                                 d
                                 
                                    
                                       ϕ
                                    
                                    
                                       T
                                    
                                 
                                 ⋅
                                 ∇
                                 f
                              , we get that
                                 
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ¯
                                          
                                       
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             ¯
                                          
                                       
                                       )
                                       =
                                       
                                          〈
                                          ∇
                                          
                                             
                                                f
                                             
                                             
                                                ¯
                                             
                                          
                                          (
                                          
                                             
                                                p
                                             
                                             
                                                ¯
                                             
                                          
                                          )
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                ¯
                                             
                                          
                                          〉
                                       
                                       =
                                       
                                          〈
                                          d
                                          
                                             
                                                ϕ
                                             
                                             
                                                T
                                             
                                          
                                          ⋅
                                          ∇
                                          f
                                          (
                                          p
                                          )
                                          ,
                                          d
                                          
                                             
                                                ϕ
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          ⋅
                                          z
                                          〉
                                       
                                       =
                                       
                                          〈
                                          ∇
                                          f
                                          (
                                          p
                                          )
                                          ,
                                          z
                                          〉
                                       
                                       =
                                       θ
                                       (
                                       p
                                       )
                                    
                                 
                               This proves the theorem. □

For a smooth point w of W, let 
                           
                              
                                 T
                              
                              
                                 W
                              
                           
                           (
                           w
                           )
                         denote the tangent space to W at w.

We show that the function θ arises out of the relation between two 2-frames on 
                           
                              
                                 T
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                              
                           
                        . Let 
                           p
                           =
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           ∈
                           F
                         be such that 
                           σ
                           (
                           p
                           )
                         is a smooth point of 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                        . We first compute a natural 2-frame 
                           X
                           (
                           p
                           )
                         in 
                           
                              
                                 T
                              
                              
                                 F
                              
                           
                           (
                           p
                           )
                        . Note that, 
                           F
                         being the zero level-set of the function f, 
                           ∇
                           f
                           
                              
                                 |
                              
                              
                                 p
                              
                           
                           ⊥
                           
                              
                                 T
                              
                              
                                 F
                              
                           
                           (
                           p
                           )
                        . We set 
                           β
                           :
                           =
                           (
                           −
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           ,
                           0
                           )
                         and note that 
                           β
                           ⊥
                           ∇
                           f
                        . It is easy to see that β is tangent to the p-curve-of-contact 
                           F
                           (
                           t
                           )
                        . Let 
                           α
                           :
                           =
                           ∇
                           f
                           ×
                           β
                           =
                           (
                           −
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           
                              
                                 f
                              
                              
                                 t
                              
                           
                           ,
                           −
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           
                              
                                 f
                              
                              
                                 t
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 u
                              
                              
                                 2
                              
                           
                           +
                           
                              
                                 f
                              
                              
                                 v
                              
                              
                                 2
                              
                           
                           )
                        . Here × is the cross-product in 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . Clearly, the set 
                           {
                           α
                           ,
                           β
                           }
                         forms a basis of 
                           
                              
                                 T
                              
                              
                                 F
                              
                           
                           (
                           p
                           )
                         if 
                           (
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           )
                           ≠
                           (
                           0
                           ,
                           0
                           )
                        . Since 
                           ∇
                           f
                           ≠
                           0
                        , if 
                           (
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           )
                         then 
                           
                              
                                 f
                              
                              
                                 t
                              
                           
                           ≠
                           0
                         and 
                           {
                           
                              
                                 α
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                           }
                           :
                           =
                           {
                           (
                           1
                           ,
                           0
                           ,
                           0
                           )
                           ,
                           (
                           0
                           ,
                           
                              
                                 f
                              
                              
                                 t
                              
                           
                           ,
                           0
                           )
                           }
                         serves as a basis for 
                           
                              
                                 T
                              
                              
                                 F
                              
                           
                           (
                           p
                           )
                        . Fig. 2 illustrates the basis 
                           {
                           α
                           ,
                           β
                           }
                         schematically.

The set 
                           {
                           
                              
                                 J
                              
                              
                                 σ
                              
                           
                           ⋅
                           α
                           ,
                           
                              
                                 J
                              
                              
                                 σ
                              
                           
                           ⋅
                           β
                           }
                           ⊆
                           
                              
                                 T
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                              
                           
                           (
                           σ
                           (
                           p
                           )
                           )
                         and can be expressed in terms of 
                           {
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 v
                              
                           
                           }
                         as follows
                           
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   σ
                                                
                                             
                                             ⋅
                                             α
                                          
                                          
                                             
                                                
                                                   J
                                                
                                                
                                                   σ
                                                
                                             
                                             ⋅
                                             β
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   u
                                                
                                             
                                          
                                          
                                             
                                                
                                                   σ
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    
                                       
                                          [
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ⋅
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                   +
                                                   n
                                                   ⋅
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         v
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   −
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ⋅
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         v
                                                      
                                                   
                                                   +
                                                   m
                                                   ⋅
                                                   (
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         v
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ︸
                                    
                                    
                                       D
                                       (
                                       p
                                       )
                                    
                                 
                              
                           
                         Note that,
                           
                              (4)
                              
                                 det
                                 
                                 
                                    (
                                    D
                                    (
                                    p
                                    )
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 (
                                 n
                                 ⋅
                                 
                                    
                                       f
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 m
                                 ⋅
                                 
                                    
                                       f
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       t
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    det
                                    (
                                    D
                                    (
                                    p
                                    )
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          f
                                       
                                       
                                          u
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          f
                                       
                                       
                                          v
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 θ
                                 (
                                 p
                                 )
                              
                           
                         Clearly, if 
                           (
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           )
                           ≠
                           (
                           0
                           ,
                           0
                           )
                         then 
                           det
                           (
                           D
                           (
                           p
                           )
                           )
                         is a positive scalar multiple of 
                           θ
                           (
                           p
                           )
                        . Again, if 
                           (
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           )
                           =
                           (
                           0
                           ,
                           0
                           )
                        , expressing 
                           {
                           
                              
                                 J
                              
                              
                                 σ
                              
                           
                           ⋅
                           
                              
                                 α
                              
                              
                                 ′
                              
                           
                           ,
                           
                              
                                 J
                              
                              
                                 σ
                              
                           
                           ⋅
                           
                              
                                 β
                              
                              
                                 ′
                              
                           
                           }
                         in terms of 
                           {
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 v
                              
                           
                           }
                         we see that 
                           det
                           (
                           D
                           (
                           p
                           )
                           )
                           =
                           θ
                           (
                           p
                           )
                           =
                           −
                           
                              
                                 f
                              
                              
                                 t
                              
                           
                        .

The above relation between 
                           {
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                           ,
                           
                              
                                 σ
                              
                              
                                 v
                              
                           
                           }
                         and 
                           {
                           
                              
                                 J
                              
                              
                                 σ
                              
                           
                           ⋅
                           α
                           ,
                           
                              
                                 J
                              
                              
                                 σ
                              
                           
                           ⋅
                           β
                           }
                         shows that if 
                           θ
                           (
                           p
                           )
                           ≠
                           0
                        , 
                           
                              
                                 T
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                              
                           
                           (
                           y
                           )
                         and 
                           
                              
                                 T
                              
                              
                                 ∂
                                 M
                                 (
                                 t
                                 )
                              
                           
                           (
                           y
                           )
                         are identical (as subspaces of 
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        ) for 
                           y
                           =
                           σ
                           (
                           p
                           )
                        , i.e., 
                           ∂
                           M
                           (
                           t
                           )
                         makes tangential contact with 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                         at y.

We give a sweep example which will demonstrate the non-singularity of the function θ. We show that on the set 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                        , 
                           ∇
                           θ
                           ≠
                           
                              
                                 0
                              
                              
                                 ¯
                              
                           
                        . Consider a sphere parametrized as 
                           S
                           (
                           u
                           ,
                           v
                           )
                           =
                           (
                           cos
                           
                           v
                           cos
                           
                           u
                           ,
                           cos
                           
                           v
                           sin
                           
                           u
                           ,
                           sin
                           
                           v
                           )
                        , 
                           v
                           ∈
                           [
                           −
                           
                              π
                              2
                           
                           ,
                           
                              π
                              2
                           
                           ]
                           ,
                           u
                           ∈
                           [
                           −
                           π
                           ,
                           π
                           ]
                         swept along a curvilinear trajectory given by 
                           h
                           (
                           t
                           )
                           =
                           (
                           A
                           (
                           t
                           )
                           ,
                           b
                           (
                           t
                           )
                           )
                        , 
                           A
                           (
                           t
                           )
                           =
                           I
                        , 
                           b
                           (
                           t
                           )
                           =
                           (
                           
                              1
                              2
                           
                           cos
                           
                           2
                           t
                           ,
                           
                              1
                              2
                           
                           sin
                           
                           2
                           t
                           ,
                           0
                           )
                        , 
                           t
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                        . The unit outward normal at 
                           S
                           (
                           u
                           ,
                           v
                           )
                         at time t is given by 
                           
                              
                                 N
                              
                              
                                 ˆ
                              
                           
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           =
                           (
                           cos
                           
                           v
                           cos
                           
                           u
                           ,
                           cos
                           
                           v
                           sin
                           
                           u
                           ,
                           sin
                           
                           v
                           )
                         and velocity is given by 
                           V
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           =
                           (
                           −
                           sin
                           
                           2
                           t
                           ,
                           cos
                           
                           2
                           t
                           ,
                           0
                           )
                        . The envelope function is 
                           f
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           =
                           〈
                           
                              
                                 N
                              
                              
                                 ˆ
                              
                           
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           ,
                           V
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           〉
                           =
                           cos
                           
                           v
                           sin
                           (
                           u
                           −
                           2
                           t
                           )
                        . The funnel 
                           F
                         is given by (i) 
                           u
                           =
                           2
                           t
                           −
                           π
                        , 
                           v
                           ∈
                           [
                           −
                           
                              π
                              2
                           
                           ,
                           
                              π
                              2
                           
                           ]
                         and (ii) 
                           u
                           =
                           2
                           t
                        , 
                           v
                           ∈
                           [
                           −
                           
                              π
                              2
                           
                           ,
                           
                              π
                              2
                           
                           ]
                        . Hence, u and v can serve as local parameters of 
                           F
                        . In component (ii) of the funnel, we see that 
                           θ
                           >
                           0
                        , hence we will only consider component (i). On 
                           F
                        , 
                           
                              
                                 σ
                              
                              
                                 t
                              
                           
                           =
                           n
                           ⋅
                           
                              
                                 σ
                              
                              
                                 u
                              
                           
                           +
                           m
                           ⋅
                           
                              
                                 σ
                              
                              
                                 v
                              
                           
                         where 
                           n
                           =
                           
                              
                                 −
                                 1
                              
                              
                                 cos
                                 
                                 v
                              
                           
                         and 
                           m
                           =
                           0
                        , whence, 
                           θ
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           =
                           n
                           ⋅
                           
                              
                                 f
                              
                              
                                 u
                              
                           
                           +
                           m
                           ⋅
                           
                              
                                 f
                              
                              
                                 v
                              
                           
                           −
                           
                              
                                 f
                              
                              
                                 t
                              
                           
                           =
                           2
                           cos
                           
                           v
                           −
                           1
                        . The set 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                         is given by 
                           v
                           =
                           ±
                           
                              π
                              3
                           
                        , 
                           u
                           =
                           2
                           t
                           −
                           π
                        . On 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                        , 
                           
                              
                                 ∂
                                 θ
                              
                              
                                 ∂
                                 u
                              
                           
                           =
                           0
                         and 
                           
                              
                                 ∂
                                 θ
                              
                              
                                 ∂
                                 v
                              
                           
                           =
                           2
                           sin
                           
                           v
                           ≠
                           0
                        .

An important consequence of non-singularity of θ is that its zero set, i.e., 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                         can be computed robustly and easily.

Now we characterize the cusp-singular points of 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                        . Geometrically, these are precisely the points where 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                         intersects itself non-transversally. At such points, the dimension of 
                           
                              
                                 T
                              
                              
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                              
                           
                         drops below 2. Identification of such points is important because any parametrization of 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                         will be degenerate in the neighbourhood of such points. Toward this, consider the following restriction of σ to the funnel: 
                           σ
                           
                              
                                 |
                              
                              
                                 F
                              
                           
                           :
                           F
                           →
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                        . Note that 
                           σ
                           
                              
                                 |
                              
                              
                                 F
                              
                           
                           (
                           F
                           )
                           =
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                        .


                        
                           Definition 37
                           The set 
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                               is said to have a cusp-singularity at a point 
                                 σ
                                 (
                                 p
                                 )
                                 =
                                 x
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                               if 
                                 σ
                                 
                                    
                                       |
                                    
                                    
                                       F
                                    
                                 
                               fails to be an immersion at p.

A basic result about immersion (see Guillemin and Pollack, 1974) implies that if 
                           σ
                           
                              
                                 |
                              
                              
                                 F
                              
                           
                         is an immersion at a point p, then there is a neighbourhood 
                           N
                         of p such that 
                           σ
                           
                              
                                 |
                              
                              
                                 F
                              
                           
                         is a local diffeomorphism from 
                           N
                         onto its image.


                        
                           Lemma 38
                           
                              Let 
                              
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 F
                               
                              and 
                              
                                 σ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                              
                              . The point 
                              
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                               
                              is a cusp-singularity iff 
                              
                                 θ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                              
                              .
                           


                        
                           Proof
                           From Subsection 5.2, 
                                 θ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 )
                               is a positive multiple of the determinant relating frames 
                                 {
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       v
                                    
                                 
                                 }
                               and 
                                 {
                                 
                                    
                                       J
                                    
                                    
                                       σ
                                    
                                 
                                 ⋅
                                 α
                                 ,
                                 
                                    
                                       J
                                    
                                    
                                       σ
                                    
                                 
                                 ⋅
                                 β
                                 }
                               at 
                                 
                                    
                                       x
                                    
                                    
                                       0
                                    
                                 
                              . Since the set 
                                 {
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       σ
                                    
                                    
                                       v
                                    
                                 
                                 }
                               is always linearly independent, it follows that 
                                 {
                                 
                                    
                                       J
                                    
                                    
                                       σ
                                    
                                 
                                 ⋅
                                 α
                                 ,
                                 
                                    
                                       J
                                    
                                    
                                       σ
                                    
                                 
                                 ⋅
                                 β
                                 }
                               is linearly dependent iff 
                                 σ
                                 
                                    
                                       |
                                    
                                    
                                       F
                                    
                                 
                               fails to be an immersion at 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                               iff 
                                 θ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                              . □

In other words, the set 
                           
                              
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                              
                              
                                 0
                              
                           
                         is the set of cusp-singular points in 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                        .

We now show the relation of the function θ with inverse trajectory (Blackmore et al., 1999; Erdim and Ilies, 2008) used by previous authors. Given a trajectory h and a fixed point x in object-space, the inverse trajectory of x is the set of points in the object-space which get mapped to x at some time instant by h, i.e. 
                           {
                           z
                           ∈
                           
                              
                                 R
                              
                              
                                 3
                              
                           
                           |
                           ∃
                           t
                           ∈
                           [
                           0
                           ,
                           1
                           ]
                           ,
                           A
                           (
                           t
                           )
                           ⋅
                           z
                           +
                           b
                           (
                           t
                           )
                           =
                           x
                           }
                        .


                        
                           Definition 39
                           Given a trajectory h, the inverse trajectory 
                              
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                               is defined as the map 
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                                 :
                                 I
                                 →
                                 (
                                 
                                    SO
                                 
                                 (
                                 3
                                 )
                                 ,
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                                 )
                               given by 
                                 
                                    
                                       h
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 (
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 −
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 t
                                 )
                                 ⋅
                                 b
                                 (
                                 t
                                 )
                                 )
                              . Thus, for a fixed point 
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              , the inverse trajectory of x is the map 
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 :
                                 I
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                               given by 
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 t
                                 )
                                 ⋅
                                 (
                                 x
                                 −
                                 b
                                 (
                                 t
                                 )
                                 )
                              .

The range of 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                         is 
                           {
                           
                              
                                 A
                              
                              
                                 t
                              
                           
                           (
                           t
                           )
                           ⋅
                           x
                           −
                           
                              
                                 A
                              
                              
                                 t
                              
                           
                           (
                           t
                           )
                           ⋅
                           b
                           (
                           t
                           )
                           |
                           t
                           ∈
                           I
                           }
                        . We list some facts about 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                         in Appendix B which will be used in proving Theorem 40.

For the inverse trajectory 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                         of a point 
                           x
                           ∈
                           ∂
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        , let π be the projection of 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                         on 
                           ∂
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        . Let 
                           λ
                           (
                           t
                           )
                         be the signed distance of 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           (
                           t
                           )
                         from 
                           ∂
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        . If the point 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           (
                           t
                           )
                         is in 
                           
                              
                                 M
                              
                              
                                 o
                              
                           
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        , 
                           
                              Ext
                           
                           (
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           )
                         (the exterior of M) or on the surface 
                           ∂
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        , then 
                           λ
                           (
                           t
                           )
                         is negative, positive or zero respectively. Then we have 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           (
                           t
                           )
                           −
                           π
                           (
                           t
                           )
                           =
                           λ
                           (
                           t
                           )
                           N
                           (
                           t
                           )
                        , where 
                           π
                           (
                           t
                           )
                         is the projection of 
                           
                              
                                 y
                              
                              
                                 ¯
                              
                           
                           (
                           t
                           )
                         on 
                           ∂
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         along the unit outward pointing normal 
                           N
                           (
                           t
                           )
                         to 
                           ∂
                           M
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         at 
                           π
                           (
                           t
                           )
                        . This is illustrated in Fig. 11
                        . So, the following relation holds for λ.
                           
                              (6)
                              
                                 λ
                                 (
                                 t
                                 )
                                 =
                                 
                                    〈
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    t
                                    )
                                    −
                                    π
                                    (
                                    t
                                    )
                                    ,
                                    N
                                    (
                                    t
                                    )
                                    〉
                                 
                              
                           
                        
                     


                        
                           Theorem 40
                           
                              For 
                              
                                 p
                                 =
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ∈
                                 F
                              
                              ,
                              
                                 
                                    
                                       θ
                                       (
                                       p
                                       )
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             ¨
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       =
                                       〈
                                       −
                                       
                                          
                                             σ
                                          
                                          
                                             ¨
                                          
                                       
                                       +
                                       2
                                       
                                          
                                             A
                                          
                                          
                                             ˙
                                          
                                       
                                       ⋅
                                       V
                                       ,
                                       N
                                       〉
                                       +
                                       κ
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               
                              where 
                              
                                 
                                    
                                        
                                    
                                    
                                       ¨
                                    
                                 
                               
                              denotes the second derivative of λ, κ is the normal curvature of S at 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 )
                               
                              along velocity 
                              
                                 V
                                 (
                                 p
                                 )
                              
                              , N is the unit outward normal to S at 
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 )
                               
                              and 
                              
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 〈
                                 V
                                 (
                                 p
                                 )
                                 ,
                                 V
                                 (
                                 p
                                 )
                                 〉
                              
                              .
                           


                        
                           Proof
                           Differentiating Eq. (6) with respect to time and denoting derivative w.r.t. t by 
                                 
                                    
                                        
                                    
                                    
                                       ˙
                                    
                                 
                              , we get
                                 
                                    (7)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ˙
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          〈
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          t
                                          )
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                          N
                                          (
                                          t
                                          )
                                          〉
                                       
                                       +
                                       
                                          〈
                                          
                                             
                                                y
                                             
                                             
                                                ¯
                                             
                                          
                                          (
                                          t
                                          )
                                          −
                                          π
                                          (
                                          t
                                          )
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          t
                                          )
                                          〉
                                       
                                    
                                 
                              
                              
                                 
                                    (8)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ¨
                                          
                                       
                                       (
                                       t
                                       )
                                       =
                                       
                                          〈
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          t
                                          )
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                          N
                                          (
                                          t
                                          )
                                          〉
                                       
                                       +
                                       2
                                       
                                          〈
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          t
                                          )
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          t
                                          )
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          t
                                          )
                                          〉
                                       
                                       +
                                       
                                          〈
                                          
                                             
                                                y
                                             
                                             
                                                ¯
                                             
                                          
                                          (
                                          t
                                          )
                                          −
                                          π
                                          (
                                          t
                                          )
                                          ,
                                          
                                             
                                                N
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          t
                                          )
                                          〉
                                       
                                    
                                 
                               At 
                                 t
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              , 
                                 
                                    
                                       y
                                    
                                    
                                       ¯
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 π
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . Since 
                                 
                                    
                                       y
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 V
                                 (
                                 p
                                 )
                                 ⊥
                                 N
                                 (
                                 p
                                 )
                              , it follows from Eq. (18) that 
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ⊥
                                 N
                                 (
                                 p
                                 )
                              . It is easy to verify that 
                                 
                                    
                                       π
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             y
                                          
                                          
                                             ¯
                                          
                                       
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . Hence,
                                 
                                    (9)
                                    
                                       λ
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          
                                             λ
                                          
                                          
                                             ˙
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       =
                                       0
                                    
                                 
                               From Eq. (8) and Eq. (20) it follows that
                                 
                                    (10)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ¨
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          〈
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ,
                                          N
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          〉
                                       
                                       =
                                       
                                          〈
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          +
                                          2
                                          
                                             
                                                A
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ⋅
                                          
                                             
                                                y
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          −
                                          
                                             
                                                π
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ,
                                          N
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          〉
                                       
                                    
                                 
                               Since 
                                 π
                                 (
                                 t
                                 )
                                 ∈
                                 S
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                               for all t in some neighbourhood U of 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                              , we have that 
                                 〈
                                 
                                    
                                       π
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 N
                                 (
                                 t
                                 )
                                 〉
                                 =
                                 0
                              , 
                                 ∀
                                 t
                                 ∈
                                 U
                              . Hence 
                                 〈
                                 
                                    
                                       π
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 N
                                 (
                                 t
                                 )
                                 〉
                                 +
                                 〈
                                 
                                    
                                       π
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 t
                                 )
                                 〉
                                 =
                                 0
                              , 
                                 ∀
                                 t
                                 ∈
                                 U
                              . Hence 
                                 −
                                 〈
                                 
                                    
                                       π
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 N
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 〉
                                 =
                                 〈
                                 
                                    
                                       π
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 〉
                                 =
                                 〈
                                 
                                    
                                       π
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       π
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 )
                                 〉
                                 =
                                 〈
                                 
                                    
                                       y
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 )
                                 〉
                                 =
                                 〈
                                 V
                                 (
                                 p
                                 )
                                 ,
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 V
                                 (
                                 p
                                 )
                                 )
                                 〉
                                 =
                                 κ
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                              . Here 
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                               is the differential of the Gauss map, i.e. the curvature tensor of 
                                 S
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                               at point x. Using this in Eq. (10) and the fact that 
                                 
                                    
                                       y
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       ˙
                                    
                                 
                                 (
                                 p
                                 )
                              , 
                                 
                                    
                                       y
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 p
                                 )
                               we get
                                 
                                    (11)
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             ¨
                                          
                                       
                                       (
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       =
                                       
                                          〈
                                          −
                                          
                                             
                                                σ
                                             
                                             
                                                ¨
                                             
                                          
                                          (
                                          p
                                          )
                                          +
                                          2
                                          
                                             
                                                A
                                             
                                             
                                                ˙
                                             
                                          
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          ⋅
                                          V
                                          (
                                          p
                                          )
                                          ,
                                          N
                                          (
                                          
                                             
                                                t
                                             
                                             
                                                0
                                             
                                          
                                          )
                                          〉
                                       
                                       +
                                       κ
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                               Recalling definition of 
                                 θ
                                 (
                                 p
                                 )
                               from Eq. (3)
                              
                                 
                                    
                                       l
                                       
                                          
                                             f
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       m
                                       
                                          
                                             f
                                          
                                          
                                             v
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       〈
                                       l
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       m
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             v
                                          
                                       
                                       ,
                                       V
                                       〉
                                       +
                                       〈
                                       
                                          
                                             N
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       l
                                       
                                          
                                             V
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       m
                                       
                                          
                                             V
                                          
                                          
                                             v
                                          
                                       
                                       〉
                                       −
                                       〈
                                       
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       V
                                       〉
                                       −
                                       〈
                                       
                                          
                                             N
                                          
                                          
                                             ˆ
                                          
                                       
                                       ,
                                       
                                          
                                             V
                                          
                                          
                                             t
                                          
                                       
                                       〉
                                    
                                 
                               Here 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       
                                          
                                             N
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       σ
                                    
                                    
                                       v
                                    
                                 
                                 )
                               where 
                                 
                                    
                                       G
                                    
                                    
                                       ⁎
                                    
                                 
                               is the shape operator (differential of the Gauss map) of 
                                 S
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                               at 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       0
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . Also, 
                                 
                                    
                                       V
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 ⋅
                                 
                                    
                                       S
                                    
                                    
                                       u
                                    
                                 
                               and 
                                 
                                    
                                       V
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 ⋅
                                 
                                    
                                       S
                                    
                                    
                                       v
                                    
                                 
                              . Assume without loss of generality that 
                                 A
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 I
                               and 
                                 b
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                              , hence 
                                 
                                    
                                       N
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 A
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 ⋅
                                 N
                                 =
                                 N
                              , 
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       u
                                    
                                 
                               and 
                                 
                                    
                                       σ
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       S
                                    
                                    
                                       v
                                    
                                 
                              . Using Eq. (16) and the fact that 
                                 V
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 l
                                 
                                    
                                       σ
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 m
                                 
                                    
                                       σ
                                    
                                    
                                       v
                                    
                                 
                               we get
                                 
                                    (12)
                                    
                                       l
                                       
                                          
                                             f
                                          
                                          
                                             u
                                          
                                       
                                       +
                                       m
                                       
                                          
                                             f
                                          
                                          
                                             v
                                          
                                       
                                       −
                                       
                                          
                                             f
                                          
                                          
                                             t
                                          
                                       
                                       =
                                       
                                          〈
                                          
                                             
                                                G
                                             
                                             
                                                ⁎
                                             
                                          
                                          ⋅
                                          V
                                          ,
                                          V
                                          〉
                                       
                                       +
                                       2
                                       〈
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                       ⋅
                                       V
                                       ,
                                       N
                                       〉
                                       −
                                       〈
                                       
                                          
                                             V
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       N
                                       〉
                                       =
                                       κ
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       +
                                       〈
                                       2
                                       
                                          
                                             A
                                          
                                          
                                             t
                                          
                                       
                                       ⋅
                                       V
                                       −
                                       
                                          
                                             V
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       N
                                       〉
                                    
                                 
                               From Eqs. (11) and (12) and the fact that 
                                 
                                    
                                       ∂
                                       σ
                                    
                                    
                                       ∂
                                       
                                          
                                             t
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       t
                                    
                                 
                               we get 
                                 θ
                                 (
                                 p
                                 )
                                 =
                                 l
                                 
                                    
                                       f
                                    
                                    
                                       u
                                    
                                 
                                 +
                                 m
                                 
                                    
                                       f
                                    
                                    
                                       v
                                    
                                 
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                 
                                 )
                              . □

From Theorem 40 it is clear that the function θ is intimately connected with the curvature of the solid and that of the trajectory. Further, unlike in the approaches in Blackmore et al. (1999) and Erdim and Ilies (2008) in which every sampled point of 
                           
                              
                                 C
                              
                              
                                 I
                              
                           
                         must be subjected to the inverse trajectory test in order to perform trimming, we show in the following section that ultimately only a few points of 
                           
                              
                                 F
                              
                              
                                 0
                              
                           
                         are used for computing the trim curves. Hence, the trim set 
                           
                              
                                 T
                              
                              
                                 I
                              
                           
                        , including the region 
                           
                              
                                 F
                              
                              
                                 −
                              
                           
                        , need not be explored at all.

We now give the proof of Theorem 34 which gives an efficient test for decomposability using the function θ.


                        
                           Theorem 34
                           
                              If for all 
                              
                                 p
                                 ∈
                                 F
                              
                              , 
                              
                                 θ
                                 (
                                 p
                                 )
                                 >
                                 0
                              
                              , then the sweep is decomposable. Further, if there exists 
                              
                                 p
                                 ∈
                                 F
                               
                              such that 
                              
                                 θ
                                 (
                                 p
                                 )
                                 <
                                 0
                              
                              , then the sweep is non-decomposable.
                           


                        
                           Proof
                           Suppose that for all 
                                 p
                                 ∈
                                 F
                              , 
                                 θ
                                 (
                                 p
                                 )
                                 >
                                 0
                              . For 
                                 p
                                 ∈
                                 F
                              , let 
                                 t
                                 (
                                 p
                                 )
                               denote the t-coordinate of p. Consider the set of points 
                                 P
                                 =
                                 {
                                 p
                                 ∈
                                 F
                                 |
                                 ∃
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 F
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 ≠
                                 p
                                 ,
                                 σ
                                 (
                                 p
                                 )
                                 =
                                 σ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                  and 
                                 
                                    
                                       σ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 σ
                                 (
                                 p
                                 )
                                 )
                                 =
                                 {
                                 p
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 }
                                 }
                              . Note that, by the general position assumption, there are only finitely many points 
                                 p
                                 ∈
                                 F
                               such that 
                                 
                                    
                                       σ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 σ
                                 (
                                 p
                                 )
                                 )
                               is of cardinality greater than two. Hence such points may be ignored in the following discussion. By the general position assumption, P is a collection of smooth curves in 
                                 F
                              . For 
                                 p
                                 ∈
                                 P
                              , let 
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                               denote the unique point in P such that 
                                 p
                                 ≠
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                               and 
                                 σ
                                 (
                                 p
                                 )
                                 =
                                 σ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 )
                              . Further, we define 
                                 δ
                                 (
                                 p
                                 )
                                 =
                                 ‖
                                 t
                                 (
                                 p
                                 )
                                 −
                                 t
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ‖
                              . Let 
                                 δ
                                 :
                                 =
                                 
                                    
                                       inf
                                    
                                    
                                       p
                                       ∈
                                       P
                                    
                                 
                                 
                                 δ
                                 (
                                 p
                                 )
                              . Consider two cases as follows:


                              Case (i): 
                              
                                 δ
                                 =
                                 0
                              , i.e., there exists a sequence 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 )
                               in a curve C of P such that 
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 
                                 δ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 0
                              . Hence there exists 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                               (closure of C) which is a limit point of 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 )
                              . Since 
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 
                                 δ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 ‖
                                 t
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 −
                                 t
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ‖
                                 =
                                 0
                               and ∂M is free from self-intersections, we have that 
                                 
                                    
                                       lim
                                    
                                    
                                       n
                                       →
                                       ∞
                                    
                                 
                                 ‖
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                 
                                 −
                                 
                                    
                                       p
                                    
                                    
                                       n
                                    
                                    
                                       ′
                                    
                                 
                                 ‖
                                 =
                                 0
                              . Hence, for a small neighbourhood 
                                 N
                               of 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                               in 
                                 F
                              , we may parametrize the smooth curve 
                                 
                                    
                                       C
                                    
                                    
                                       ¯
                                    
                                 
                                 ∩
                                 N
                               by a map γ so that 
                                 γ
                                 (
                                 0
                                 )
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                               and, for 
                                 s
                                 ≠
                                 0
                              , 
                                 γ
                                 (
                                 s
                                 )
                                 ,
                                 γ
                                 (
                                 −
                                 s
                                 )
                                 ∈
                                 C
                                 ∩
                                 N
                               and 
                                 σ
                                 (
                                 γ
                                 (
                                 s
                                 )
                                 )
                                 =
                                 σ
                                 (
                                 γ
                                 (
                                 −
                                 s
                                 )
                                 )
                              . Let 
                                 Γ
                                 (
                                 s
                                 )
                                 :
                                 =
                                 σ
                                 (
                                 γ
                                 (
                                 s
                                 )
                                 )
                              . Note that 
                                 Γ
                                 (
                                 s
                                 )
                                 =
                                 Γ
                                 (
                                 −
                                 s
                                 )
                              . Now,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   Γ
                                                
                                                
                                                   d
                                                   s
                                                
                                             
                                             |
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          lim
                                          
                                             Δ
                                             s
                                             →
                                             0
                                          
                                       
                                       
                                       
                                          
                                             Γ
                                             (
                                             Δ
                                             s
                                             )
                                             −
                                             Γ
                                             (
                                             0
                                             )
                                          
                                          
                                             Δ
                                             s
                                          
                                       
                                       =
                                       
                                          lim
                                          
                                             Δ
                                             s
                                             →
                                             0
                                          
                                       
                                       
                                       
                                          
                                             Γ
                                             (
                                             0
                                             )
                                             −
                                             Γ
                                             (
                                             −
                                             Δ
                                             s
                                             )
                                          
                                          
                                             Δ
                                             s
                                          
                                       
                                       =
                                       
                                          lim
                                          
                                             Δ
                                             s
                                             →
                                             0
                                          
                                       
                                       
                                       
                                          
                                             Γ
                                             (
                                             0
                                             )
                                             −
                                             Γ
                                             (
                                             Δ
                                             s
                                             )
                                          
                                          
                                             Δ
                                             s
                                          
                                       
                                       =
                                       −
                                       
                                          lim
                                          
                                             Δ
                                             s
                                             →
                                             0
                                          
                                       
                                       
                                       
                                          
                                             Γ
                                             (
                                             Δ
                                             s
                                             )
                                             −
                                             Γ
                                             (
                                             0
                                             )
                                          
                                          
                                             Δ
                                             s
                                          
                                       
                                    
                                 
                              
                           

Hence,
                                 
                                    
                                       
                                          
                                             
                                                
                                                   d
                                                   Γ
                                                
                                                
                                                   d
                                                   s
                                                
                                             
                                             |
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       
                                          
                                             J
                                          
                                          
                                             σ
                                          
                                       
                                       
                                          
                                             |
                                          
                                          
                                             γ
                                             (
                                             0
                                             )
                                          
                                       
                                       .
                                       
                                          
                                             
                                                
                                                   d
                                                   γ
                                                
                                                
                                                   d
                                                   s
                                                
                                             
                                             |
                                          
                                          
                                             0
                                          
                                       
                                       =
                                       0
                                    
                                 
                               Since 
                                 
                                    
                                       d
                                       γ
                                    
                                    
                                       d
                                       s
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       0
                                    
                                 
                                 ∈
                                 
                                    
                                       T
                                    
                                    
                                       F
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 )
                              , the map 
                                 σ
                                 
                                    
                                       |
                                    
                                    
                                       F
                                    
                                 
                                 :
                                 F
                                 →
                                 
                                    
                                       C
                                    
                                    
                                       I
                                    
                                 
                               fails to be an immersion at 
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                               and by Lemma 38 we get that 
                                 θ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       0
                                    
                                 
                                 )
                                 =
                                 0
                              , which is a contradiction to the hypothesis.


                              Case (ii): 
                              
                                 δ
                                 >
                                 0
                              . Let 
                                 {
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       k
                                    
                                 
                                 }
                               be a partition of I of width 
                                 
                                    δ
                                    2
                                 
                              . Let 
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                               and 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               denote the funnel and the contact set corresponding to subinterval 
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                              . Then it is clear that for each i, 
                                 σ
                                 :
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 →
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               is a diffeomorphism, i.e., for each i, 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ∩
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 =
                                 ∅
                               for all 
                                 t
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 t
                                 ≠
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                              . We show that the subproblems 
                                 (
                                 M
                                 ,
                                 h
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                                 )
                               are simple for all i. Suppose not, i.e., for some i, there exists 
                                 t
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                               such that 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 t
                                 )
                                 ∩
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 )
                                 ≠
                                 ∅
                               for some 
                                 
                                    
                                       t
                                    
                                    
                                       ′
                                    
                                 
                                 ∈
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                              . Hence the trim set 
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               is not empty. By Lemma 30, for all but finitely many points in 
                                 ∂
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               there are two points 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 ∂
                                 p
                                 
                                    
                                       T
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                               such that 
                                 σ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 =
                                 σ
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 y
                              . If 
                                 
                                    
                                       p
                                    
                                    
                                       1
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                               and 
                                 
                                    
                                       p
                                    
                                    
                                       2
                                    
                                 
                                 ∈
                                 
                                    
                                       F
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                               then it follows that 
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       1
                                    
                                 
                                 )
                                 ∩
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       t
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 y
                               leading to contradiction. Hence, the subproblems 
                                 (
                                 M
                                 ,
                                 h
                                 ,
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                                 )
                               are simple for all i. It follows that 
                                 (
                                 M
                                 ,
                                 h
                                 ,
                                 I
                                 )
                               is decomposable with width-parameter 
                                 
                                    δ
                                    2
                                 
                              .

Hence we have proved that if for all 
                                 p
                                 ∈
                                 F
                              , 
                                 θ
                                 (
                                 p
                                 )
                                 >
                                 0
                               then the sweep is decomposable.

Suppose now that there exists 
                                 p
                                 =
                                 (
                                 u
                                 ,
                                 v
                                 ,
                                 t
                                 )
                                 ∈
                                 F
                               such that 
                                 θ
                                 (
                                 p
                                 )
                                 <
                                 0
                              . Let 
                                 y
                                 =
                                 σ
                                 (
                                 p
                                 )
                              . Recall the definition of the function λ from Eq. (6) and relation 
                                 θ
                                 (
                                 p
                                 )
                                 =
                                 
                                    
                                       λ
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 t
                                 )
                               from Theorem 40. Clearly, if 
                                 
                                    
                                       λ
                                    
                                    
                                       ¨
                                    
                                 
                                 (
                                 t
                                 )
                                 <
                                 0
                              , then t is a local maxima of the function λ and the inverse trajectory of y intersects 
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 t
                                 )
                              . So, there exists 
                                 ϵ
                                 >
                                 0
                               such that for all 
                                 δ
                                 ∈
                                 (
                                 0
                                 ,
                                 ϵ
                                 )
                              , there exists 
                                 
                                    
                                       w
                                    
                                    
                                       δ
                                    
                                 
                                 ∈
                                 
                                    
                                       M
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 t
                                 )
                               such that 
                                 A
                                 (
                                 t
                                 +
                                 δ
                                 )
                                 ⋅
                                 
                                    
                                       w
                                    
                                    
                                       δ
                                    
                                 
                                 +
                                 b
                                 (
                                 t
                                 +
                                 δ
                                 )
                                 =
                                 y
                              . Hence, the interval 
                                 [
                                 t
                                 ,
                                 t
                                 +
                                 δ
                                 ]
                                 ⊂
                                 L
                                 (
                                 p
                                 )
                              . Thus 
                                 ℓ
                                 (
                                 p
                                 )
                                 =
                                 0
                               and hence 
                                 
                                    t-sep
                                 
                                 =
                                 0
                              . By Proposition 32, the sweep is non-decomposable. □

In this section we look at singular p-trim curves, i.e., a curve C of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      where 
                        
                           
                              inf
                           
                           
                              p
                              ∈
                              C
                           
                        
                        
                        ℓ
                        (
                        p
                        )
                        =
                        0
                     . We show that 
                        
                           
                              C
                           
                           
                              I
                           
                           
                              −
                           
                        
                        ⊂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      and that 
                        
                           
                              C
                           
                           
                              I
                           
                           
                              0
                           
                        
                      makes contact with 
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                     , thereby providing a seed for tracing 
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                     . Fig. 18(b) schematically illustrates singular p-trim curves. Figs. 12–17
                     
                     
                     
                     
                     
                      show six examples of non-decomposable sweeps and the associated singular trim curves. In Figs. 12–15 the 1-cage of the envelope, i.e., the swept edges are shown with the portion where 
                        θ
                        >
                        0
                      shown in black and the portion where 
                        θ
                        <
                        0
                      shown in green. The curve 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           
                              0
                           
                        
                      is shown in red and the trim curve 
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      is shown in blue.

In Figs. 16(a) and 17(a), curves of contact at a few time instances are shown. The portions of 
                        
                           
                              C
                           
                           
                              I
                           
                        
                        (
                        t
                        )
                      where 
                        θ
                        >
                        0
                      and 
                        θ
                        <
                        0
                      on 
                        F
                        (
                        t
                        )
                      are shown in black and green respectively. In Figs. 16(b) and 17(b) the portion where θ is negative is excised, the curve 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           
                              0
                           
                        
                      is shown in red and the trim curve 
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      is shown in blue. Note that 
                        
                           
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                           
                           
                              0
                           
                        
                      and 
                        ∂
                        
                           
                              T
                           
                           
                              I
                           
                        
                      make contact, as we explain in this section. Fig. 19 schematically illustrates the interaction between curves of contact in non-decomposable sweeps.


                     
                        Proposition 41
                        
                           If C is a singular p-trim curve and 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              C
                            
                           is a limit-point of 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              )
                              ⊂
                              C
                            
                           such that 
                           
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              
                              ℓ
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              0
                           
                           , then 
                           
                              θ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           
                           .
                        


                     
                        Proof
                        For 
                              p
                              ∈
                              F
                           , let 
                              t
                              (
                              p
                              )
                            denote the t-coordinate of p. By Lemma 27 it follows that for each 
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              ∈
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              )
                            there exists 
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              C
                            such that 
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              )
                              =
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              )
                           . Since 
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              ‖
                              t
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              )
                              −
                              t
                              (
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              )
                              ‖
                              =
                              0
                            and ∂M is free from self-intersections, we have that 
                              
                                 
                                    lim
                                 
                                 
                                    n
                                    →
                                    ∞
                                 
                              
                              ‖
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              −
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                                 
                                    ′
                                 
                              
                              ‖
                              =
                              0
                           . Hence, for a small neighbourhood 
                              N
                            of 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                            in 
                              F
                           , we may parametrize 
                              C
                              ∩
                              N
                            by a map γ so that 
                              γ
                              (
                              0
                              )
                              =
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                            and, for 
                              s
                              ≠
                              0
                           , 
                              γ
                              (
                              s
                              )
                              ,
                              γ
                              (
                              −
                              s
                              )
                              ∈
                              N
                              ∩
                              C
                            and 
                              σ
                              (
                              γ
                              (
                              −
                              s
                              )
                              )
                              =
                              σ
                              (
                              γ
                              (
                              s
                              )
                              )
                           . Let 
                              Γ
                              (
                              s
                              )
                              :
                              =
                              σ
                              (
                              γ
                              (
                              s
                              )
                              )
                           . Then,
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                Γ
                                             
                                             
                                                d
                                                s
                                             
                                          
                                          |
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       lim
                                       
                                          Δ
                                          s
                                          →
                                          0
                                       
                                    
                                    
                                    
                                       
                                          Γ
                                          (
                                          Δ
                                          s
                                          )
                                          −
                                          Γ
                                          (
                                          0
                                          )
                                       
                                       
                                          Δ
                                          s
                                       
                                    
                                    =
                                    
                                       lim
                                       
                                          Δ
                                          s
                                          →
                                          0
                                       
                                    
                                    
                                    
                                       
                                          Γ
                                          (
                                          0
                                          )
                                          −
                                          Γ
                                          (
                                          −
                                          Δ
                                          s
                                          )
                                       
                                       
                                          Δ
                                          s
                                       
                                    
                                    =
                                    
                                       lim
                                       
                                          Δ
                                          s
                                          →
                                          0
                                       
                                    
                                    
                                    
                                       
                                          Γ
                                          (
                                          0
                                          )
                                          −
                                          Γ
                                          (
                                          Δ
                                          s
                                          )
                                       
                                       
                                          Δ
                                          s
                                       
                                    
                                    =
                                    −
                                    
                                       lim
                                       
                                          Δ
                                          s
                                          →
                                          0
                                       
                                    
                                    
                                    
                                       
                                          Γ
                                          (
                                          Δ
                                          s
                                          )
                                          −
                                          Γ
                                          (
                                          0
                                          )
                                       
                                       
                                          Δ
                                          s
                                       
                                    
                                 
                              
                           
                        

Hence,
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                Γ
                                             
                                             
                                                d
                                                s
                                             
                                          
                                          |
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    
                                       
                                          J
                                       
                                       
                                          σ
                                       
                                    
                                    
                                       
                                          |
                                       
                                       
                                          γ
                                          (
                                          0
                                          )
                                       
                                    
                                    .
                                    
                                       
                                          
                                             
                                                d
                                                γ
                                             
                                             
                                                d
                                                s
                                             
                                          
                                          |
                                       
                                       
                                          0
                                       
                                    
                                    =
                                    0
                                 
                              
                            Since 
                              
                                 
                                    d
                                    γ
                                 
                                 
                                    d
                                    s
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    F
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                           , the map 
                              σ
                              
                                 
                                    |
                                 
                                 
                                    F
                                 
                              
                              :
                              F
                              →
                              
                                 
                                    C
                                 
                                 
                                    I
                                 
                              
                            fails to be an immersion at 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                            and by Lemma 38 we conclude that 
                              θ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           . □


                     
                        Definition 42
                        A limit point p of a singular p-trim curve C such that 
                              θ
                              (
                              p
                              )
                              =
                              0
                            will be called a singular trim point.

In Fig. 18
                     
                     (b) a singular trim point 
                        
                           
                              p
                           
                           
                              0
                           
                        
                      is shown on 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                     .


                     
                        Proposition 43
                        
                           If 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              F
                            
                           such that 
                           
                              θ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              <
                              0
                            
                           then 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           
                           .
                        


                     
                        Proof
                        Let 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              =
                              (
                              
                                 
                                    u
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ∈
                              F
                           . Recall the definition of the function λ from Eq. (6) and relation 
                              θ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    λ
                                 
                                 
                                    ¨
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            from Theorem 40. Clearly, if 
                              
                                 
                                    λ
                                 
                                 
                                    ¨
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              <
                              0
                           , then 
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                            is a local maxima of the function λ and the inverse trajectory of 
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            intersects 
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            and 
                              σ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              ∈
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . Hence, if 
                              θ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              <
                              0
                            then 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . □


                     Propositions 41 and 43 link the curves of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      to the curves of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                     . We see that every curve of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      lies inside a curve of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      and every curve C of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      has a curve 
                        
                           
                              F
                           
                           
                              C
                           
                           
                              0
                           
                        
                      of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      which makes contact with it. We have already seen that 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      is a collection of curves on which ∇θ is non-zero. Thus, the computation of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      in modern kernels is straightforward. The task before us is now to locate the points of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                        ∩
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                      which is enabled by the following function.


                     
                        Definition 44
                        Let Ω be a parametrization of a curve 
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                            of 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                           . Let 
                              Ω
                              (
                              
                                 
                                    s
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              ∈
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                            and 
                              
                                 
                                    z
                                 
                                 
                                    ¯
                                 
                              
                              :
                              =
                              (
                              n
                              ,
                              m
                              ,
                              −
                              1
                              )
                              ∈
                              
                                 null
                              
                              (
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                              )
                            at 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                           , i.e., 
                              n
                              
                                 
                                    σ
                                 
                                 
                                    u
                                 
                              
                              +
                              m
                              
                                 
                                    σ
                                 
                                 
                                    v
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    t
                                 
                              
                           . Define the function 
                              ϱ
                              :
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                              →
                              R
                            as follows.
                              
                                 (13)
                                 
                                    ϱ
                                    (
                                    
                                       
                                          s
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    =
                                    
                                       〈
                                       
                                          
                                             z
                                          
                                          
                                             ¯
                                          
                                       
                                       ×
                                       
                                          
                                             
                                                
                                                   d
                                                   Ω
                                                
                                                
                                                   d
                                                   s
                                                
                                             
                                             |
                                          
                                          
                                             
                                                
                                                   s
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       ,
                                       ∇
                                       f
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   p
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       〉
                                    
                                 
                              
                            where × is the cross-product in 
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                           .

Here, ϱ is a measure of the oriented angle between the tangent at 
                        
                           
                              p
                           
                           
                              0
                           
                        
                      to 
                        
                           
                              F
                           
                           
                              i
                           
                           
                              0
                           
                        
                      and the kernel (line) of the Jacobian 
                        
                           
                              J
                           
                           
                              σ
                           
                        
                      restricted to the tangent space 
                        
                           
                              T
                           
                           
                              F
                           
                        
                        (
                        
                           
                              p
                           
                           
                              0
                           
                        
                        )
                     .


                     
                        Proposition 45
                        
                           Every singular p-trim curve C makes contact with a curve 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                            
                           of 
                           
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                            
                           so that if 
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                            
                           is a singular trim point of C then 
                           
                              ϱ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           
                           . Furthermore, at such points, 
                           
                              
                                 
                                    ϱ
                                 
                                 
                                    ′
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              ≠
                              0
                            
                           where 
                           
                              
                                 
                                    ϱ
                                 
                                 
                                    ′
                                 
                              
                            
                           refers to the derivative of ϱ along the curve 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                                 
                                    0
                                 
                              
                           
                           .
                        


                     
                        Proof
                        We know from Proposition 43 that 
                              
                                 
                                    F
                                 
                                 
                                    −
                                 
                              
                              ⊂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                           . Since 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                            and 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            form the boundaries of 
                              
                                 
                                    F
                                 
                                 
                                    −
                                 
                              
                            and 
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            respectively, 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                            and a singular p-trim curve C of 
                              ∂
                              p
                              
                                 
                                    T
                                 
                                 
                                    I
                                 
                              
                            meet tangentially at the singular trim point. Further, it was shown in the proof of Proposition 41 that at a singular trim point 
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                           , 
                              
                                 
                                    T
                                 
                                 
                                    C
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                            is the null-space of the Jacobian 
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           . Since 
                              
                                 
                                    T
                                 
                                 
                                    C
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                           , 
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    
                                       
                                          p
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              )
                              =
                              0
                           . Since the function ϱ measures the oriented angle between 
                              
                                 null
                              
                              (
                              
                                 
                                    J
                                 
                                 
                                    σ
                                 
                              
                              )
                            and 
                              
                                 
                                    T
                                 
                                 
                                    
                                       
                                          F
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           , it follows that 
                              ϱ
                              (
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           .

The derivative 
                              
                                 
                                    ϱ
                                 
                                 
                                    ′
                                 
                              
                              ≠
                              0
                            at singular trim points for non-decomposable sweeps shown in Fig. 16 and Fig. 17. □

The curves of 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      can be parametrized via the procedural approach. Further, Proposition 45 confirms that for every singular p-trim curve, we may use the function ϱ to locate a singular trim point p in 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      in a computationally robust manner. Thus, via θ and ϱ we may access every component of 
                        ∂
                        p
                        
                           
                              T
                           
                           
                              I
                           
                        
                     .


                     
                        Proposition 46
                        
                           In the generic situation, (i) the singular p-trim curve C has a finite set of singular trim points. Each of these points lie on a curve of 
                           
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                           
                           . (ii) For all but finitely many non-singular points 
                           
                              p
                              ∈
                              C
                           
                           , the image 
                           
                              σ
                              (
                              p
                              )
                            
                           lies on the transversal intersection of two surface patches 
                           
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              )
                            
                           and the remaining non-singular points lie on intersection of three surface patches 
                           
                              σ
                              (
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              )
                            
                           where 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              F
                            
                           corresponds to the subinterval 
                           
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              ⊂
                              I
                           
                           .
                        


                     
                        Proof
                        It follows from Proposition 41 that the singular trim points lie on 
                              
                                 
                                    F
                                 
                                 
                                    0
                                 
                              
                           . Since at a non-singular trim point 
                              p
                              ∈
                              C
                           , 
                              ℓ
                              (
                              p
                              )
                              >
                              0
                           , the proof for (ii) is identical to the proof for Lemma 30 about elementary trim curves. □

We now describe the tracing of a singular p-trim curve C once a point 
                        
                           
                              p
                           
                           
                              0
                           
                        
                      in 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      has been located where ϱ is zero. Since 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      and C meet tangentially at 
                        
                           
                              p
                           
                           
                              0
                           
                        
                     , starting at 
                        
                           
                              p
                           
                           
                              0
                           
                        
                      we take small steps in direction 
                        
                           
                              d
                              Ω
                           
                           
                              d
                              s
                           
                        
                        
                           
                              |
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                           
                        
                      and 
                        −
                        
                           
                              d
                              Ω
                           
                           
                              d
                              s
                           
                        
                        
                           
                              |
                           
                           
                              
                                 
                                    p
                                 
                                 
                                    0
                                 
                              
                           
                        
                      to obtain points 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                           
                              ′
                           
                        
                      respectively which are fed to a Newton–Raphson solver which returns points 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                      such that 
                        
                           
                              p
                           
                           
                              1
                           
                        
                        ,
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        ∈
                        F
                     , 
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                        
                        )
                        =
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        )
                      and 
                        t
                        (
                        
                           
                              p
                           
                           
                              1
                           
                        
                        )
                        −
                        t
                        (
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        )
                        =
                        t
                        (
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                        
                        )
                        −
                        t
                        (
                        
                           
                              
                                 
                                    p
                                 
                                 
                                    ˜
                                 
                              
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        )
                     . Let 
                        
                           
                              q
                           
                           
                              1
                           
                        
                        :
                        =
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                        
                        )
                        =
                        σ
                        (
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                        )
                     . Here, 
                        t
                        (
                        p
                        )
                      denotes the t-coordinate of p. The point 
                        
                           
                              q
                           
                           
                              1
                           
                        
                      is on the trim curve and the points 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                      are on the p-trim curve C. Since points 
                        
                           
                              p
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              p
                           
                           
                              1
                           
                           
                              ′
                           
                        
                      are non-singular, these can be fed as starting points to any of the known surface–surface intersection algorithms to compute the trim curve.

Note that, for trimming, unlike in the inverse trajectory approach (Blackmore et al., 1997, 1999), our method does not rely on identifying all the points where θ is negative. Further, the funnel being a smooth surface, every point of 
                        F
                      is accessible via the procedural parametrization (discussed in Appendix C). On this surface, the curve 
                        
                           
                              F
                           
                           
                              0
                           
                        
                      is computed. This guarantees that no portion of 
                        
                           
                              F
                           
                           
                              −
                           
                        
                      will be left out.


                     Fig. 20
                      schematically illustrates a scenario in which a singular p-trim curve is nested inside an elementary p-trim curve. Note that the sweep is non-decomposable and this will be detected by the presence of points on 
                        F
                      where 
                        θ
                        ≤
                        0
                     . Further, the region bounded by the singular p-trim curve needs to be excised before a surface–surface intersection algorithm can trace the elementary trim curves since no neighbourhood of 
                        
                           
                              C
                           
                           
                              I
                           
                           
                              0
                           
                        
                      (where θ is zero) can be parametrized. Our analysis will first successfully identify and excise the region bound by the singular p-trim curves. After parameterizing the remaining part, the task of excising the regions bound by elementary p-trim curves can be handled by existing kernels.

@&#DISCUSSION@&#

This paper develops a mathematical framework for the implementation of the “generic” solid sweep in modern solid modelling kernels. This is done via a complete understanding of singularities and of self-intersections within the envelope and the notion of decomposability. This in turn is done through the important invariant θ by which all trim-curves are either stable surface–surface intersections or are caught by θ.

We now detail certain implementation issues. Firstly, the use of funnel as the parametrization space and the so called “procedural” framework is now standard, see e.g., the ACIS kernel. Secondly, the non-generic case in the sweep, as in blends or surface–surface intersections, will need careful programming and convergence with existing kernel methods for handling degeneracy. Next, while we have not tackled the case when the trim curves intersect the left/right caps, that analysis is not difficult and we skip it for want of space. Finally, the non-smooth sweep is a step away. The local geometry is already available. The trim curves and other combinatorial/topological properties of the smooth and non-smooth case are tackled in a later paper.

Mathematically, our framework may also extend to more complicated cases where the curves of contact are not simple. This calls for a more Morse-theoretic analysis which should yield rich structural insights. The invariant θ is surprisingly strong and needs to be studied further.

Recall the statement of Proposition 8 that for 
                        (
                        y
                        ,
                        x
                        ,
                        t
                        )
                        ∈
                        R
                      and 
                        I
                        =
                        [
                        
                           
                              t
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              t
                           
                           
                              1
                           
                        
                        ]
                     , either (i) 
                        t
                        =
                        
                           
                              t
                           
                           
                              0
                           
                        
                      and 
                        g
                        (
                        x
                        ,
                        t
                        )
                        ≤
                        0
                     , or (ii) 
                        t
                        =
                        
                           
                              t
                           
                           
                              1
                           
                        
                      and 
                        g
                        (
                        x
                        ,
                        t
                        )
                        ≥
                        0
                      or (iii) 
                        g
                        (
                        x
                        ,
                        t
                        )
                        =
                        0
                     .


                     
                        Proof
                        Let 
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    3
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                            be defined as 
                              (
                              1
                              ,
                              0
                              ,
                              0
                              ,
                              0
                              )
                           , 
                              (
                              0
                              ,
                              1
                              ,
                              0
                              ,
                              0
                              )
                           , 
                              (
                              0
                              ,
                              0
                              ,
                              1
                              ,
                              0
                              )
                            and 
                              (
                              0
                              ,
                              0
                              ,
                              0
                              ,
                              1
                              )
                            respectively. We define the following objects in 
                              
                                 
                                    R
                                 
                                 
                                    4
                                 
                              
                            where the fourth dimension is time. Let 
                              Z
                              :
                              =
                              {
                              (
                              A
                              (
                              t
                              )
                              ⋅
                              x
                              +
                              b
                              (
                              t
                              )
                              ,
                              t
                              )
                              |
                               where 
                              x
                              ∈
                              M
                               and 
                              t
                              ∈
                              I
                              }
                            and 
                              X
                              :
                              =
                              {
                              (
                              A
                              (
                              t
                              )
                              ⋅
                              x
                              +
                              b
                              (
                              t
                              )
                              ,
                              t
                              )
                              |
                               where 
                              x
                              ∈
                              ∂
                              M
                               and 
                              t
                              ∈
                              I
                              }
                           . Note that Z is a four dimensional topological manifold and X is a three dimensional submanifold of Z. Further, a point 
                              (
                              x
                              ,
                              t
                              )
                            lies in 
                              
                                 
                                    Z
                                 
                                 
                                    o
                                 
                              
                            if 
                              t
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    o
                                 
                              
                            and 
                              x
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              t
                              )
                           . Further, if 
                              I
                              =
                              [
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ]
                           , 
                              ∂
                              Z
                              =
                              X
                              ∪
                              (
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ∪
                              (
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                            forms the boundary of Z. Define the projection 
                              μ
                              :
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              ×
                              I
                              →
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                            is defined as 
                              μ
                              (
                              x
                              ,
                              t
                              )
                              =
                              x
                            and the projection 
                              τ
                              :
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              ×
                              I
                              →
                              R
                            is defined as 
                              τ
                              (
                              x
                              ,
                              t
                              )
                              =
                              t
                           . By Lemma 5, for a point 
                              w
                              ∈
                              μ
                              (
                              Z
                              )
                           , if 
                              
                                 
                                    μ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              w
                              )
                              ∩
                              
                                 
                                    Z
                                 
                                 
                                    o
                                 
                              
                              ≠
                              ∅
                            then 
                              w
                              ∉
                              E
                           . Hence a necessary condition for w to be in 
                              E
                            is that the line 
                              
                                 
                                    μ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              w
                              )
                            should be tangent to ∂Z which is a three dimensional manifold which is smooth everywhere except at 
                              (
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            and at 
                              (
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                           . For 
                              w
                              ∈
                              
                                 
                                    M
                                 
                                 
                                    o
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           , the outward normal to ∂Z at 
                              (
                              w
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            is given by 
                              −
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                            and the outward normal to ∂Z at 
                              (
                              w
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ∈
                              (
                              
                                 
                                    M
                                 
                                 
                                    0
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              )
                            is given by 
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                           . We now compute the outward normal to ∂Z at 
                              (
                              w
                              ,
                              t
                              )
                              ∈
                              X
                           . The manifold X is diffeomorphic to 
                              ∂
                              M
                              ×
                              I
                           , i.e., the cross product of ∂M which is a 2-dimensional manifold and I which is a 1-dimensional manifold, with the diffeomorphism given by 
                              d
                              :
                              ∂
                              M
                              ×
                              I
                              →
                              X
                           , 
                              d
                              (
                              x
                              ,
                              t
                              )
                              =
                              (
                              A
                              (
                              t
                              )
                              ⋅
                              x
                              +
                              b
                              (
                              t
                              )
                              ,
                              t
                              )
                           . Hence, if 
                              {
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              }
                            spans 
                              
                                 
                                    T
                                 
                                 
                                    ∂
                                    M
                                 
                              
                              (
                              x
                              )
                            and {1} spans 
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              (
                              t
                              )
                            then the tangent space of 
                              ∂
                              M
                              ×
                              I
                            at 
                              (
                              x
                              ,
                              t
                              )
                            is spanned by 
                              {
                              (
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              0
                              )
                              ,
                              (
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              0
                              )
                              ,
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                              }
                            and 
                              
                                 
                                    T
                                 
                                 
                                    X
                                 
                              
                              (
                              w
                              ,
                              t
                              )
                            is spanned by 
                              {
                              (
                              A
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    y
                                 
                                 
                                    1
                                 
                              
                              ,
                              0
                              )
                              ,
                              (
                              A
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              0
                              )
                              ,
                              (
                              
                                 
                                    A
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              ⋅
                              x
                              +
                              
                                 
                                    b
                                 
                                 
                                    ′
                                 
                              
                              (
                              t
                              )
                              ,
                              1
                              )
                              }
                           . Hence, the outward normal to ∂Z at 
                              (
                              w
                              ,
                              t
                              )
                            is 
                              (
                              A
                              (
                              t
                              )
                              ⋅
                              N
                              (
                              x
                              )
                              ,
                              −
                              〈
                              A
                              (
                              t
                              )
                              ⋅
                              N
                              (
                              x
                              )
                              ,
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              (
                              t
                              )
                              〉
                              )
                           . Consider now three cases as follows.


                           Case (i): 
                           
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                           . At any point 
                              (
                              w
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ∈
                              (
                              ∂
                              M
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            there is a cone of outward normals given by 
                              α
                              
                                 [
                                 
                                    
                                       
                                          A
                                          (
                                          t
                                          )
                                          ⋅
                                          N
                                          (
                                          x
                                          )
                                       
                                    
                                    
                                       
                                          −
                                          〈
                                          A
                                          (
                                          t
                                          )
                                          ⋅
                                          N
                                          (
                                          x
                                          )
                                          ,
                                          
                                             
                                                v
                                             
                                             
                                                x
                                             
                                          
                                          (
                                          t
                                          )
                                          〉
                                       
                                    
                                 
                                 ]
                              
                              −
                              β
                              
                                 
                                    
                                       
                                          e
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    4
                                 
                              
                            where 
                              α
                              ,
                              β
                              ∈
                              R
                            and 
                              α
                              ,
                              β
                              ≥
                              0
                           . So if the line 
                              
                                 
                                    μ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              w
                              )
                            is tangent to ∂Z at 
                              (
                              w
                              ,
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                            then
                              
                                 
                                    
                                       〈
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             4
                                          
                                       
                                       ,
                                       α
                                       
                                          [
                                          
                                             
                                                
                                                   A
                                                   (
                                                   t
                                                   )
                                                   ⋅
                                                   N
                                                   (
                                                   x
                                                   )
                                                
                                             
                                             
                                                
                                                   −
                                                   〈
                                                   A
                                                   (
                                                   t
                                                   )
                                                   ⋅
                                                   N
                                                   (
                                                   x
                                                   )
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   〉
                                                
                                             
                                          
                                          ]
                                       
                                       −
                                       β
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             4
                                          
                                       
                                       〉
                                    
                                    =
                                    0
                                 
                              
                            for some α, β where 
                              α
                              >
                              0
                            and 
                              β
                              ≥
                              0
                           . Solving the above for 
                              〈
                              A
                              (
                              t
                              )
                              ⋅
                              N
                              (
                              x
                              )
                              ,
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              (
                              t
                              )
                              〉
                            we get 
                              〈
                              A
                              (
                              t
                              )
                              ⋅
                              N
                              (
                              x
                              )
                              ,
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              (
                              t
                              )
                              〉
                              =
                              −
                              
                                 β
                                 α
                              
                              ≤
                              0
                           . Hence 
                              g
                              (
                              x
                              ,
                              t
                              )
                              ≤
                              0
                           .


                           Case (ii): 
                           
                              t
                              =
                              
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                           . Proof is similar to case (i).


                           Case (iii): 
                           
                              t
                              ∈
                              
                                 
                                    I
                                 
                                 
                                    o
                                 
                              
                           . If the line 
                              
                                 
                                    μ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              w
                              )
                            is tangent to X at 
                              (
                              w
                              ,
                              t
                              )
                           , we have
                              
                                 
                                    
                                       〈
                                       
                                          [
                                          
                                             
                                                
                                                   A
                                                   (
                                                   t
                                                   )
                                                   ⋅
                                                   N
                                                   (
                                                   x
                                                   )
                                                
                                             
                                             
                                                
                                                   −
                                                   〈
                                                   A
                                                   (
                                                   t
                                                   )
                                                   ⋅
                                                   N
                                                   (
                                                   x
                                                   )
                                                   ,
                                                   
                                                      
                                                         v
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                   (
                                                   t
                                                   )
                                                   〉
                                                
                                             
                                          
                                          ]
                                       
                                       ,
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             4
                                          
                                       
                                       〉
                                    
                                    =
                                    0
                                 
                              
                            It follows that 
                              〈
                              A
                              (
                              t
                              )
                              ⋅
                              N
                              (
                              x
                              )
                              ,
                              
                                 
                                    v
                                 
                                 
                                    x
                                 
                              
                              (
                              t
                              )
                              〉
                              =
                              g
                              (
                              x
                              ,
                              t
                              )
                              =
                              0
                           . □

Recall the inverse trajectory of a fixed point x as 
                        
                           
                              y
                           
                           
                              ¯
                           
                        
                        (
                        t
                        )
                        =
                        
                           
                              A
                           
                           
                              t
                           
                        
                        (
                        t
                        )
                        ⋅
                        (
                        x
                        −
                        b
                        (
                        t
                        )
                        )
                     . We will denote the trajectory of x by 
                        y
                        :
                        [
                        0
                        ,
                        1
                        ]
                        →
                        
                           
                              R
                           
                           
                              3
                           
                        
                     , 
                        y
                        (
                        t
                        )
                        =
                        A
                        (
                        t
                        )
                        ⋅
                        x
                        +
                        b
                        (
                        t
                        )
                     . We now note a few useful facts about 
                        
                           
                              y
                           
                           
                              ¯
                           
                        
                     . We assume without loss of generality that 
                        A
                        (
                        
                           
                              t
                           
                           
                              0
                           
                        
                        )
                        =
                        I
                      and 
                        b
                        (
                        
                           
                              t
                           
                           
                              0
                           
                        
                        )
                        =
                        0
                     . Denoting the derivative with respect to t by 
                        
                           
                               
                           
                           
                              ˙
                           
                        
                     , we have
                        
                           (14)
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ˙
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˙
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ⋅
                              
                                 (
                                 x
                                 −
                                 b
                                 (
                                 t
                                 )
                                 )
                              
                              −
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    b
                                 
                                 
                                    ˙
                                 
                              
                              (
                              t
                              )
                           
                        
                      Since 
                        A
                        ∈
                        
                           SO
                        
                        (
                        3
                        )
                      we have,
                        
                           (15)
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ⋅
                              A
                              (
                              t
                              )
                              =
                              I
                              ,
                              
                              ∀
                              t
                           
                        
                      Differentiating Eq. (15) w.r.t. t we get
                        
                           (16)
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˙
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              +
                              
                                 
                                    A
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           
                        
                     
                     
                        
                           (17)
                           
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ¨
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              +
                              2
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˙
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ⋅
                              
                                 
                                    A
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              +
                              
                                 
                                    A
                                 
                                 
                                    ¨
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              0
                           
                        
                      Using Eq. (14) and Eq. (16) we get
                        
                           (18)
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              −
                              
                                 
                                    A
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ⋅
                              x
                              −
                              
                                 
                                    b
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              −
                              
                                 
                                    y
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        
                      Differentiating Eq. (14) w.r.t. time we get
                        
                           (19)
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ¨
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ¨
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ⋅
                              
                                 (
                                 x
                                 −
                                 b
                                 (
                                 t
                                 )
                                 )
                              
                              −
                              2
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˙
                                       
                                    
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    b
                                 
                                 
                                    ˙
                                 
                              
                              (
                              t
                              )
                              −
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                              (
                              t
                              )
                              ⋅
                              
                                 
                                    b
                                 
                                 
                                    ¨
                                 
                              
                              (
                              t
                              )
                           
                        
                      Using Eqs. (19), (16) and (17) we get
                        
                           (20)
                           
                              
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    ¨
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              =
                              −
                              
                                 
                                    y
                                 
                                 
                                    ¨
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              +
                              2
                              
                                 
                                    A
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                              ⋅
                              
                                 
                                    y
                                 
                                 
                                    ˙
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              )
                           
                        
                     
                  

We now describe the parametrization of 
                        F
                      assuming that the sweep 
                        (
                        M
                        ,
                        h
                        ,
                        I
                        )
                      is simple. We obtain a procedural parametrization of 
                        F
                      which is an abstract way of defining curves and surfaces. This approach relies on the fact that from the user's point of view, a parametric surface(curve) in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      is a map from 
                        
                           
                              R
                           
                           
                              2
                           
                        
                        (
                        R
                        )
                      to 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      and hence is merely a set of programs which allow the user to query the key attributes of the surface(curve), e.g. its domain and to evaluate the surface(curve) and its derivatives at the given parameter value. This approach to defining geometry is especially useful when closed form formulae are not available for the parametrization map and one must resort to iterative numerical methods. We use the Newton–Raphson (NR) method for this purpose. As an example, the parametrization of the intersection curve of two surfaces is computed procedurally in Markot and Magedson (1990). This approach has the advantage of being computationally efficient as well as accurate. For a detailed discussion on the procedural framework.
                        4
                     
                     
                        4
                        Milind Sohoni, Computer aided geometric design course notes, www.cse.iitb.ac.in/~sohoni/336/main.ps.
                     
                  

The computational framework is as follows. Given S and h, an approximate funnel is first computed, which we will refer to as the seed surface. Now, when the user wishes to evaluate 
                        F
                      or its derivative at some parameter value, an NR method will be started with seed obtained from the seed surface. The NR method will converge, upto the required tolerance, to the required point on 
                        F
                     , or to its derivative, as required. Here, the precision of the evaluation is only restricted by the finite precision of the computer and hence is accurate. It has the advantage that if a tighter degree of tolerance is required while evaluation of the surface or its derivative, the seed surface does not need to be recomputed. Thus, for the procedural definition of 
                        F
                      we need the following:
                        
                           (1)
                           an NR formulation for computing points on 
                                 F
                               and its derivatives, which we describe in Section C.1,

seed surface for seeding the NR procedure, which we describe in Section C.2.

Recall that 
                        F
                        =
                        
                           
                              ⋃
                           
                           
                              t
                              ∈
                              I
                           
                        
                        F
                        (
                        t
                        )
                     . This suggests a natural parametrization of 
                        F
                      in which one of the surface parameters is time t. We will call the other parameter p and denote the seed surface by 
                        
                           F
                           ¯
                        
                      which is a map from the parameter space of 
                        F
                      to the parameter space of the sweep map σ, i.e. 
                        
                           F
                           ¯
                        
                        (
                        p
                        ,
                        t
                        )
                        =
                        (
                        
                           
                              u
                           
                           
                              ¯
                           
                        
                        (
                        p
                        ,
                        t
                        )
                        ,
                        
                           
                              v
                           
                           
                              ¯
                           
                        
                        (
                        p
                        ,
                        t
                        )
                        ,
                        t
                        )
                      and while the point 
                        
                           F
                           ¯
                        
                        (
                        p
                        ,
                        t
                        )
                      may not belong to 
                        F
                     , it is close to 
                        F
                     . We make the following assumption about 
                        
                           F
                           ¯
                        
                     . 
                        Assumption 47
                        At every point on the iso-t curve of 
                              
                                 F
                                 ¯
                              
                           , the normal plane to the iso-t curve intersects the iso-t curve of 
                              F
                            in exactly one point.

Note that this is not a very strong assumption and holds true in practice even with rather sparse sampling of points for the seed surface. We now describe the Newton–Raphson formulation for evaluating points on 
                        F
                      and its derivatives at a given parameter value.

Recall that the points on 
                           F
                         were characterized by the tangency condition 
                           f
                           (
                           u
                           ,
                           v
                           ,
                           t
                           )
                           =
                           0
                        . Introducing the parameters 
                           (
                           p
                           ,
                           t
                           )
                         of 
                           F
                        , we rewrite this equation 
                           ∀
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        :
                           
                              (21)
                              
                                 f
                                 
                                    (
                                    u
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                    v
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    〈
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                    
                                       (
                                       u
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ,
                                       v
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    ,
                                    V
                                    
                                       (
                                       u
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ,
                                       v
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                       ,
                                       
                                          
                                             t
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                    〉
                                 
                                 =
                                 0
                              
                           
                         So, given 
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        , we have one equation in two unknowns, viz. 
                           u
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         and 
                           v
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        . 
                           F
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         is defined as the intersection of the plane normal to the iso-t (for 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                        ) curve of 
                           
                              F
                              ¯
                           
                         at 
                           
                              F
                              ¯
                           
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         with the iso-t (for 
                           t
                           =
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                        ) curve of 
                           F
                         which is nothing but 
                           F
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        . Recall that 
                           F
                           (
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         is given by 
                           (
                           u
                           (
                           p
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           ,
                           v
                           (
                           p
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         where u, v, 
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                         obey Eq. (21). Henceforth, we will suppress the notation that 
                           u
                           ,
                           v
                           ,
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                         and 
                           
                              
                                 v
                              
                              
                                 ¯
                              
                           
                         are functions of p and t. Also, all the evaluations will be understood to be done at parameter values 
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        . The tangent to iso-t curve of 
                           
                              F
                              ¯
                           
                         at 
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         is given by
                           
                              (22)
                              
                                 
                                    
                                       ∂
                                       
                                          F
                                          ¯
                                       
                                    
                                    
                                       ∂
                                       p
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          ∂
                                          
                                             
                                                u
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                          
                                             
                                                v
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    ,
                                    0
                                    )
                                 
                              
                           
                         Hence, 
                           F
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                         is the solution of simultaneous system of Eqs. (21) and (23)
                        
                           
                              (23)
                              
                                 
                                    〈
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    −
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          ∂
                                          
                                             F
                                             ¯
                                          
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    〉
                                 
                                 =
                                 0
                              
                           
                         Eq. (21) and Eq. (23) give us a system of two equations in two unknowns, u and v and hence can be put into NR framework by computing their first order derivatives w.r.t. u and v. For any given parameter value 
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        , we seed the NR method with the point 
                           (
                           
                              
                                 u
                              
                              
                                 ¯
                              
                           
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           ,
                           
                              
                                 v
                              
                              
                                 ¯
                              
                           
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           )
                         and solve Eq. (21) and Eq. (23) for 
                           (
                           u
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           ,
                           v
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                           )
                         and compute 
                           F
                           (
                           
                              
                                 p
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 0
                              
                           
                           )
                        .

Having computed 
                           F
                           (
                           p
                           ,
                           t
                           )
                         we now compute first order derivatives of 
                           F
                         assuming that they exist. In order to compute 
                           
                              
                                 ∂
                                 F
                              
                              
                                 ∂
                                 p
                              
                           
                        , we differentiate Eq. (21) and Eq. (23) w.r.t. p to obtain
                           
                              (24)
                              
                                 
                                    〈
                                    
                                       
                                          ∂
                                          
                                             
                                                N
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    
                                       
                                          ∂
                                          u
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                          
                                             
                                                N
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ∂
                                          v
                                       
                                    
                                    
                                       
                                          ∂
                                          v
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    ,
                                    V
                                    〉
                                 
                                 +
                                 
                                    〈
                                    
                                       
                                          N
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          ∂
                                          V
                                       
                                       
                                          ∂
                                          u
                                       
                                    
                                    
                                       
                                          ∂
                                          u
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          ∂
                                          V
                                       
                                       
                                          ∂
                                          v
                                       
                                    
                                    
                                       
                                          ∂
                                          v
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    〉
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    〈
                                    
                                       (
                                       
                                          
                                             ∂
                                             u
                                          
                                          
                                             ∂
                                             p
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                             v
                                          
                                          
                                             ∂
                                             p
                                          
                                       
                                       ,
                                       0
                                       )
                                    
                                    −
                                    
                                       (
                                       
                                          
                                             ∂
                                             
                                                
                                                   u
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∂
                                             p
                                          
                                       
                                       ,
                                       
                                          
                                             ∂
                                             
                                                
                                                   v
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             ∂
                                             p
                                          
                                       
                                       ,
                                       0
                                       )
                                    
                                    ,
                                    
                                       
                                          ∂
                                          
                                             F
                                             ¯
                                          
                                       
                                       
                                          ∂
                                          p
                                       
                                    
                                    〉
                                 
                                 +
                                 
                                    〈
                                    (
                                    u
                                    ,
                                    v
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    −
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                    
                                       
                                          v
                                       
                                       
                                          ¯
                                       
                                    
                                    ,
                                    
                                       
                                          t
                                       
                                       
                                          0
                                       
                                    
                                    )
                                    ,
                                    
                                       
                                          
                                             
                                                ∂
                                             
                                             
                                                2
                                             
                                          
                                          
                                             F
                                             ¯
                                          
                                       
                                       
                                          ∂
                                          
                                             
                                                p
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    〉
                                 
                                 =
                                 0
                              
                           
                         Eq. (24) and Eq. (25) give a system of two equations in two unknowns, viz., 
                           
                              
                                 ∂
                                 u
                              
                              
                                 ∂
                                 p
                              
                           
                         and 
                           
                              
                                 ∂
                                 v
                              
                              
                                 ∂
                                 p
                              
                           
                         and can be put into NR framework by computing first order derivatives w.r.t. 
                           
                              
                                 ∂
                                 u
                              
                              
                                 ∂
                                 p
                              
                           
                         and 
                           
                              
                                 ∂
                                 v
                              
                              
                                 ∂
                                 p
                              
                           
                        . Note that Eq. (24) and Eq. (25) also involve u and v whose computation we have already described. After computing 
                           
                              
                                 ∂
                                 u
                              
                              
                                 ∂
                                 p
                              
                           
                         and 
                           
                              
                                 ∂
                                 v
                              
                              
                                 ∂
                                 p
                              
                           
                        , 
                           
                              
                                 ∂
                                 F
                              
                              
                                 ∂
                                 p
                              
                           
                         can be computed as 
                           (
                           
                              
                                 ∂
                                 u
                              
                              
                                 ∂
                                 p
                              
                           
                           ,
                           
                              
                                 ∂
                                 v
                              
                              
                                 ∂
                                 p
                              
                           
                           ,
                           0
                           )
                        . 
                           
                              
                                 ∂
                                 F
                              
                              
                                 ∂
                                 t
                              
                           
                         can similarly be computed by differentiating Eq. (21) and Eq. (23) w.r.t. t. Higher order derivatives can be computed in a similar manner.

The seed surface is constructed by sampling a few points on the funnel and fitting a tensor product B-spline surface through these points. For this, we first sample a few time instants, say, 
                           I
                           =
                           {
                           
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 t
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 t
                              
                              
                                 n
                              
                           
                           }
                         from the time interval of the sweep. For each 
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           ∈
                           I
                        , we sample a few points on the p-curve of contact 
                           F
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                        . For this, we begin with one point p on 
                           F
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                         and compute the tangent to 
                           F
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                         at p, call it z. Then 
                           p
                           +
                           z
                         is used as a seed in Newton–Raphson method to obtain the next point on 
                           F
                           (
                           
                              
                                 t
                              
                              
                                 i
                              
                           
                           )
                         and this process is repeated.

While we do not know of any structured way of choosing the number of sampled points, in practice even a small number of points suffice to ensure that Assumption 47 is valid.

@&#REFERENCES@&#

