@&#MAIN-TITLE@&#Adaptive B-spline neural network based nonlinear equalization for high-order QAM systems with nonlinear transmit high power amplifier

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Complex-valued B-spline nonlinear equalizer for Hammerstain channels.


                        
                        
                           
                           Alternative least squares algorithm for Hammerstain channel modeling.


                        
                        
                           
                           Pseudo training data based least squares algorithm for B-spline inverting model.


                        
                        
                           
                           Decision-directed adaptation to track the time-varying channel.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Quadrature amplitude modulation

Peak-to-average power ratio

Nonlinear high power amplifier

Hammerstein channel

B-spline neural network

Equalization

@&#ABSTRACT@&#


               
               
                  High bandwidth-efficiency quadrature amplitude modulation (QAM) signaling widely adopted in high-rate communication systems suffers from a drawback of high peak-to-average power ratio, which may cause the nonlinear saturation of the high power amplifier (HPA) at transmitter. Thus, practical high-throughput QAM communication systems exhibit nonlinear and dispersive channel characteristics that must be modeled as a Hammerstein channel. Standard linear equalization becomes inadequate for such Hammerstein communication systems. In this paper, we advocate an adaptive B-Spline neural network based nonlinear equalizer. Specifically, during the training phase, an efficient alternating least squares (LS) scheme is employed to estimate the parameters of the Hammerstein channel, including both the channel impulse response (CIR) coefficients and the parameters of the B-spline neural network that models the HPA's nonlinearity. In addition, another B-spline neural network is used to model the inversion of the nonlinear HPA, and the parameters of this inverting B-spline model can easily be estimated using the standard LS algorithm based on the pseudo training data obtained as a natural byproduct of the Hammerstein channel identification. Nonlinear equalisation of the Hammerstein channel is then accomplished by the linear equalization based on the estimated CIR as well as the inverse B-spline neural network model. Furthermore, during the data communication phase, the decision-directed LS channel estimation is adopted to track the time-varying CIR. Extensive simulation results demonstrate the effectiveness of our proposed B-Spline neural network based nonlinear equalization scheme.
               
            

@&#INTRODUCTION@&#

High-order quadrature amplitude modulation (QAM) signaling [1] has found its way into many recent high-rate wireless communications system standards, owing to its desired property of high achievable bandwidth efficiency. The higher the order of QAM signaling, the better the bandwidth efficiency but also the higher the peak-to-average power ratio (PAPR) of the resulting transmit signal. As practical high power amplifiers (HPAs) exhibit nonlinear saturation characteristics [2–6], the high PAPR signal may drive the HPA at transmitter into the nonlinear saturation region, which will significantly degrade the system's achievable bit error rate (BER) performance. An effective means of compensating the nonlinear distortions of HPA is to implement a digital predistorter at the transmitter, and various predistorter techniques have been developed [7–13], which are capable of achieving excellent performance. However, implementing the predistorter is attractive for the downlink, where the base station (BS) transmitter has the sufficient hardware and software capacities to accommodate the hardware and computational requirements for implementing digital predistorter. By contrast, in the uplink, implementing predistorter at transmitter is much more difficult, because it is extremely challenging for a pocket-size handset to absorb the additional hardware and computational complexity required. Alternatively, in the uplink, the nonlinear distortions of the transmitter HPA can be dealt with at the BS receiver, which has sufficient hardware and software resources.

With the nonlinear HPA at transmitter, the high-order QAM uplink is a complex-valued (CV) nonlinear Hammerstein system and, moreover, the received signal is further impaired by the channel additive white Gaussian noise (AWGN) while the coefficients of the channel impulse response (CIR) are time-varying. Therefore, nonlinear equalization of such a CV time-varying Hammerstein channel is a challenging task. A recent work [14] developed a generic method for identification and inversion of CV stationary Hammerstein systems based on a novel CV B-spline neural network approach. In this paper, we advocate the extension of this CV B-spline neural network based approach to nonlinear equalization of the time-varying QAM uplink with the nonlinear HPA at transmitter. Our original contribution is twofold.

Firstly, during the training phase, we propose a similar approach to the one adopted by [14] to construct a nonlinear equalizer. More specifically, as in [14], a CV B-spline neural network is utilized to model the HPA's nonlinearity, and an efficient alternating least squares (ALS) identification algorithm is employed to estimate the CIR coefficients as well as the parameters of the CV B-spline neural network that models the static nonlinearity of the Hammerstein channel. Nonlinear equalization can then be naturally accomplished by standard linear equalization based on the CIR as well as the inversion of the HPA's nonlinearity. The inversion of the HPA's nonlinearity is implemented in [14] as a root finding problem based on the estimated B-spline neural network, which requires to carry out the iterative root finding procedure for detecting every data symbol and is time-consuming. We adopt a more efficient approach of directly inverting the HPA's nonlinearity. Specifically, we use another CV B-spline neural network to model the inversion of the HPA nonlinearity. Although the HPA's output at the transmitter is unobservable at the receiver for identifying this inverse model, the pseudo training data obtained as a natural byproduct of the Hammerstein channel identification can be used to estimate the parameters of the inverting B-spline model using the standard least squares (LS) algorithm. Secondly, in order to cope with the fading CIR, during the data communication phase, the usual decision-directed (DD) LS channel estimator is employed to track the time-varying CIR coefficients and, therefore, to adapt the equalizer. Extensive simulation results are presented to demonstrate the effectiveness of our proposed B-spline neural network based nonlinear equalizer for combating the detrimental effects of the Hammerstein channel.

The remainder of this paper is organized as follows. Section 2 presents the high-order QAM uplink, where the channel is modelled as a CV Hammerstein system with the nonlinear HPA at the transmitter and the fading CIR, while a nonlinear equalizer is required at the receiver to combat the adverse effects of the Hammerstein channel. Our adaptive B-spline neural network based nonlinear equalizer is detailed in Section 3, and the simulation results are presented in Section 4. Our concluding remarks are offered in Section 5.

Throughout our discussions, a CV number 
                        x
                        ∈
                        C
                      is represented either by the rectangular form 
                        x
                        =
                        
                           
                              x
                           
                           
                              R
                           
                        
                        +
                        j
                        
                           
                              x
                           
                           
                              I
                           
                        
                     , where 
                        j
                        =
                        
                           
                              −
                              1
                           
                        
                     , while 
                        
                           
                              x
                           
                           
                              R
                           
                        
                        =
                        ℜ
                        [
                        x
                        ]
                      and 
                        
                           
                              x
                           
                           
                              I
                           
                        
                        =
                        ℑ
                        [
                        x
                        ]
                      denote the real and imaginary parts of x, or alternatively by the polar form 
                        x
                        =
                        |
                        x
                        |
                        ⋅
                        
                           
                              e
                           
                           
                              j
                              
                                 
                                    ∠
                                 
                                 
                                    x
                                 
                              
                           
                        
                      with 
                        |
                        x
                        |
                      denoting the amplitude of x and 
                        
                           
                              ∠
                           
                           
                              x
                           
                        
                      its phase. 
                        E
                        [
                         
                        ]
                      denotes the expectation operator, while 
                        
                           
                              (
                               
                              )
                           
                           
                              −
                              1
                           
                        
                      denotes the inversion. The conjugate operation is denoted by 
                        
                           
                              (
                               
                              )
                           
                           
                              ⁎
                           
                        
                     , while 
                        
                           
                              (
                               
                              )
                           
                           
                              T
                           
                        
                      and 
                        
                           
                              (
                               
                              )
                           
                           
                              H
                           
                        
                      represent the transpose and conjugate transpose operators, respectively. The 
                        L
                        ×
                        L
                      identify matrix is denoted by 
                        
                           
                              I
                           
                           
                              L
                           
                        
                     .

We consider the M-QAM signaling and, therefore, the transmitted symbols 
                        x
                        (
                        k
                        )
                        ∈
                        C
                     , where k denotes the symbol index, take the values from the M-QAM symbol set
                        
                           (1)
                           
                              X
                              =
                              {
                              d
                              (
                              2
                              l
                              −
                              
                                 M
                              
                              −
                              1
                              )
                              +
                              j
                              ⋅
                              d
                              (
                              2
                              q
                              −
                              
                                 M
                              
                              −
                              1
                              )
                              ,
                              1
                              ≤
                              l
                              ,
                              q
                              ≤
                              
                                 M
                              
                              }
                              ,
                           
                        
                      with 2d being the minimum distance between symbol points.

With the transmitter HPA exhibiting nonlinear saturation characteristics, the high-order QAM uplink can be represented by the generic CV Hammerstein system consisting of a cascade of two subsystems: a CV nonlinear static function 
                           Ψ
                           (
                           •
                           )
                           :
                           C
                           →
                           C
                         that represents the HPA at the transmitter, followed by a CV linear dynamic system with a finite-duration impulse response (FIR) filter of order 
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                         which represents the dispersive channel. Furthermore, the received signal 
                           y
                           (
                           k
                           )
                           ∈
                           C
                         is corrupted by the channel AWGN 
                           n
                           (
                           k
                           )
                           ∈
                           C
                        . Therefore, 
                           y
                           (
                           k
                           )
                         is represented by
                           
                              (2)
                              
                                 w
                                 (
                                 k
                                 )
                                 =
                                 Ψ
                                 
                                    (
                                    x
                                    (
                                    k
                                    )
                                    )
                                 
                                 ,
                              
                           
                        
                        
                           
                              (3)
                              
                                 y
                                 (
                                 k
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       
                                          L
                                       
                                       
                                          h
                                       
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       i
                                    
                                 
                                 w
                                 (
                                 k
                                 −
                                 i
                                 )
                                 +
                                 n
                                 (
                                 k
                                 )
                                 ,
                              
                           
                         where the channel AWGN has the power of 
                           E
                           [
                           
                              
                                 |
                                 n
                                 (
                                 k
                                 )
                                 |
                              
                              
                                 2
                              
                           
                           ]
                           =
                           2
                           
                              
                                 σ
                              
                              
                                 n
                              
                              
                                 2
                              
                           
                        , and 
                           h
                           =
                           
                              
                                 [
                                 
                                    
                                       h
                                    
                                    
                                       0
                                    
                                 
                                  
                                 
                                    
                                       h
                                    
                                    
                                       1
                                    
                                 
                                 ⋯
                                 
                                    
                                       h
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                         is the CIR coefficient vector, while the HPA output 
                           w
                           (
                           k
                           )
                         is unobserved and, therefore, is unavailable at the receiver.

The most widely used HPA is the solid state power amplifier [5,6], whose nonlinearity 
                           Ψ
                           (
                            
                           )
                         is constituted by the HPA's amplitude response 
                           A
                           (
                           r
                           )
                         and phase response 
                           ϒ
                           (
                           r
                           )
                         given by
                           
                              (4)
                              
                                 A
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             a
                                          
                                       
                                       r
                                    
                                    
                                       
                                          (
                                          1
                                          +
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            g
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      r
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         sat
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                                2
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       
                                          
                                             1
                                             
                                                2
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      a
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 ϒ
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             α
                                          
                                          
                                             ϕ
                                          
                                       
                                       
                                          
                                             r
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    
                                       1
                                       +
                                       
                                          
                                             (
                                             
                                                r
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      ϕ
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                 [degree]
                                 ,
                              
                           
                         where r denotes the amplitude of the input to the HPA, 
                           
                              
                                 g
                              
                              
                                 a
                              
                           
                         is the small gain signal, 
                           
                              
                                 β
                              
                              
                                 a
                              
                           
                         is the smoothness factor and 
                           
                              
                                 A
                              
                              
                                 sat
                              
                           
                         is the saturation level, while the parameters of the phase response, 
                           
                              
                                 α
                              
                              
                                 ϕ
                              
                           
                        . 
                           
                              
                                 β
                              
                              
                                 ϕ
                              
                           
                        , 
                           
                              
                                 q
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 q
                              
                              
                                 2
                              
                           
                        , are adjusted to match the specific amplifier's characteristics. The NEC GaAs power amplifier used in the recent wireless standards [5,6] for example has the parameter set
                           
                              (6)
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    19
                                    ,
                                    
                                    
                                       
                                          β
                                       
                                       
                                          a
                                       
                                    
                                    =
                                    0.81
                                    ,
                                    
                                    
                                       
                                          A
                                       
                                       
                                          sat
                                       
                                    
                                    =
                                    1.4
                                    ;
                                 
                              
                              
                                 
                                    
                                       
                                          α
                                       
                                       
                                          ϕ
                                       
                                    
                                    =
                                    −
                                    48000
                                    ,
                                    
                                    
                                       
                                          β
                                       
                                       
                                          ϕ
                                       
                                    
                                    =
                                    0.123
                                    ,
                                    
                                    
                                       
                                          q
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    3.8
                                    ,
                                    
                                    
                                       
                                          q
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    3.7
                                    .
                                 
                              
                           
                         Therefore, given the input 
                           x
                           (
                           k
                           )
                           =
                           |
                           x
                           (
                           k
                           )
                           |
                           ⋅
                           
                              
                                 e
                              
                              
                                 j
                                 
                                    
                                       ∠
                                    
                                    
                                       x
                                       (
                                       k
                                       )
                                    
                                 
                              
                           
                         to the HPA, the output of the HPA can be expressed as
                           
                              (7)
                              
                                 w
                                 (
                                 k
                                 )
                                 =
                                 A
                                 (
                                 |
                                 x
                                 (
                                 k
                                 )
                                 |
                                 )
                                 ⋅
                                 
                                    
                                       e
                                    
                                    
                                       j
                                       (
                                       
                                          
                                             ∠
                                          
                                          
                                             x
                                             (
                                             k
                                             )
                                          
                                       
                                       +
                                       ϒ
                                       (
                                       |
                                       x
                                       (
                                       k
                                       )
                                       |
                                       )
                                       )
                                    
                                 
                                 .
                              
                           
                         The operating status of the HPA may be specified by the output back-off (OBO), which is defined as the ratio of the maximum output power 
                           
                              
                                 P
                              
                              
                                 max
                              
                           
                         of the HPA to the average output power 
                           
                              
                                 P
                              
                              
                                 aop
                              
                           
                         of the HPA output signal, given by
                           
                              (8)
                              
                                 OBO
                                 =
                                 10
                                 ⋅
                                 
                                    
                                       log
                                    
                                    
                                       10
                                    
                                 
                                 ⁡
                                 
                                    
                                       
                                          P
                                       
                                       
                                          max
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          aop
                                       
                                    
                                 
                                 .
                              
                           
                         The smaller OBO is, the more the HPA is operating into the nonlinear saturation region.

To model the time-varying nature of the CIR, it is usually assumed that the CIR taps 
                           {
                           
                              
                                 h
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 h
                              
                              
                                 1
                              
                           
                           ,
                           ⋯
                           ,
                           
                              
                                 h
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                              
                           
                           }
                         follow the Rayleigh fading distribution with a given fading rate [15]. In this paper, we consider the slow fading scenario. More specifically, as transmission is organized in frames and each frame contains 
                           
                              
                                 N
                              
                              
                                 F
                              
                           
                         symbols, we assume that within a frame, the CIR taps remain constant, while between frames the CIR taps are faded with the normalized Doppler frequency of 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                        .

To combat the adverse efforts of the dispersive CIR, the standard linear equalizer takes the form of an FIR filter with the order 
                           
                              
                                 L
                              
                              
                                 g
                              
                           
                        , and the output of this linear equalizer is
                           
                              (9)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 k
                                 −
                                 ι
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       
                                          L
                                       
                                       
                                          g
                                       
                                    
                                 
                                 
                                    
                                       g
                                    
                                    
                                       i
                                    
                                    
                                       ⁎
                                    
                                 
                                 y
                                 (
                                 k
                                 −
                                 i
                                 )
                                 ,
                              
                           
                         where ι is known as the decision delay. In particular, if the CIR is minimum phase, 
                           ι
                           =
                           0
                        . If the HPA at the transmitter were linear, 
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                           (
                           k
                           −
                           ι
                           )
                         would be a sufficient statistic for estimating the transmitted data symbol 
                           x
                           (
                           k
                           −
                           ι
                           )
                        . To guarantee an accurate equalization, the length of the linear equalizer 
                           
                              
                                 L
                              
                              
                                 g
                              
                           
                         should be chosen to be three to four times of the length of 
                           h
                        , but not too long in order not to amplify the noise in the input signal too much. The well-known minimum mean square error (MMSE) solution [16] can readily be applied to obtain the linear equalizer's weight vector 
                           g
                           =
                           
                              
                                 [
                                 
                                    
                                       g
                                    
                                    
                                       0
                                    
                                 
                                 
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 ⋯
                                 
                                    
                                       g
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             g
                                          
                                       
                                    
                                 
                                 ]
                              
                              
                                 T
                              
                           
                        . Define the CIR coefficient matrix 
                           H
                           ∈
                           
                              
                                 C
                              
                              
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       g
                                    
                                 
                                 +
                                 1
                                 )
                                 ×
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       H
                                    
                                 
                                 +
                                 1
                                 )
                              
                           
                        
                        
                           
                              (10)
                              
                                 H
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋯
                                          
                                          
                                             ⋱
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ι
                                                
                                             
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 L
                              
                              
                                 H
                              
                           
                           =
                           
                              
                                 L
                              
                              
                                 h
                              
                           
                           +
                           
                              
                                 L
                              
                              
                                 g
                              
                           
                        . Then the MMSE solution of 
                           g
                         is expressed as
                           
                              (11)
                              
                                 
                                    
                                       g
                                    
                                    
                                       MMSE
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             H
                                          
                                          
                                             H
                                          
                                       
                                       +
                                       
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   H
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ι
                                    
                                 
                                 ,
                              
                           
                         in which 
                           
                              
                                 σ
                              
                              
                                 w
                              
                              
                                 2
                              
                           
                           =
                           E
                           [
                           |
                           Ψ
                           (
                           x
                           (
                           k
                           )
                           )
                           
                              
                                 |
                              
                              
                                 2
                              
                           
                           ]
                         is the power of 
                           w
                           (
                           k
                           )
                         which needs to be estimated. The optimal value for ι can be chosen to minimise the MMSE of the combined linear system of 
                           h
                         and 
                           g
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       J
                                    
                                    
                                       cmmse
                                    
                                 
                                 (
                                 ι
                                 )
                                 =
                                 
                                    
                                       σ
                                    
                                    
                                       w
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 1
                                 −
                                 
                                    
                                       h
                                    
                                    
                                       ι
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       (
                                       H
                                       
                                          
                                             H
                                          
                                          
                                             H
                                          
                                       
                                       +
                                       
                                          
                                             2
                                             
                                                
                                                   σ
                                                
                                                
                                                   n
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             
                                                σ
                                             
                                             
                                                w
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          
                                             I
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   H
                                                
                                             
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       h
                                    
                                    
                                       ι
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

Since the transmitter HPA is nonlinear, the linear equalizer (9) alone is insufficient for estimating the transmitted data symbol 
                           x
                           (
                           k
                           −
                           ι
                           )
                        . If the inversion of the HPA's nonlinearity, 
                           
                              
                                 Ψ
                              
                              
                                 −
                                 1
                              
                           
                           (
                            
                           )
                        , is known, then the transmitter HPA's nonlinear distortion can be removed, yielding the estimate of 
                           x
                           (
                           k
                           −
                           ι
                           )
                        
                        
                           
                              (13)
                              
                                 
                                    
                                       x
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 k
                                 −
                                 ι
                                 )
                                 =
                                 
                                    
                                       Ψ
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 k
                                 −
                                 ι
                                 )
                                 )
                                 .
                              
                           
                        
                     

As discussed in the previous section, in order to accomplish the equalization objective, it is necessary to identify the Hammerstein channel, including both the CIR 
                        h
                      and the HPA's nonlinearity 
                        Ψ
                        (
                         
                        )
                     , as well as to invert the nonlinearity 
                        Ψ
                        (
                         
                        )
                     .

Note that the HPA's nonlinearity, (4) and (5), is unknown to the receiver and 
                           w
                           (
                           k
                           )
                         is unobserved. We adopt the CV B-spline neural network [14,17,18] to represent the mapping 
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                           =
                           
                              
                                 Ψ
                              
                              
                                 ˆ
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 R
                              
                           
                           +
                           j
                           ⋅
                           
                              
                                 x
                              
                              
                                 I
                              
                           
                           )
                           :
                           
                           C
                           →
                           C
                         that is the estimate of 
                           Ψ
                           (
                            
                           )
                        . Before introducing the B-spline modeling of 
                           Ψ
                           (
                            
                           )
                        , we point out that the HPA 
                           Ψ
                           (
                            
                           )
                         satisfies the following conditions.
                           
                              1)
                              
                                 
                                    Ψ
                                    (
                                     
                                    )
                                  is a one to one mapping, i.e. it is an invertible and continuous function.


                                 
                                    
                                       
                                          x
                                       
                                       
                                          R
                                       
                                    
                                  and 
                                    
                                       
                                          x
                                       
                                       
                                          I
                                       
                                    
                                  are upper and lower bounded by some finite and known real values, where 
                                    x
                                    =
                                    
                                       
                                          x
                                       
                                       
                                          R
                                       
                                    
                                    +
                                    j
                                    ⋅
                                    
                                       
                                          x
                                       
                                       
                                          I
                                       
                                    
                                  denotes the input to the HPA 
                                    Ψ
                                    (
                                     
                                    )
                                 . Furthermore, the distributions of 
                                    
                                       
                                          x
                                       
                                       
                                          R
                                       
                                    
                                  and 
                                    
                                       
                                          x
                                       
                                       
                                          I
                                       
                                    
                                  are identical.

A set of univariate B-spline basis functions for 
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                           ∈
                           R
                         is parametrised by the order 
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                         of a piecewise polynomial and a knot sequence which is a set of values defined on the real line that break it up into a number of intervals. To have 
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                         basis functions, the knot sequence is specified by 
                           (
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                           +
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                           +
                           1
                           )
                         knot values, 
                           {
                           
                              
                                 U
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 1
                              
                           
                           ,
                           ⋯
                           ,
                           
                              
                                 U
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                              
                           
                           }
                        , with
                           
                              (14)
                              
                                 
                                    
                                       U
                                    
                                    
                                       0
                                    
                                 
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       −
                                       2
                                    
                                 
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       min
                                    
                                 
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                    
                                 
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       max
                                    
                                 
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                       +
                                       2
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             d
                                          
                                       
                                       +
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                    
                                 
                                 .
                              
                           
                         At each end, there are 
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                           −
                           1
                         “external” knots that are outside the input region and one boundary knot. As a result, the number of “internal” knots is 
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                           +
                           1
                           −
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                        . Given the set of predetermined knots (14), the set of 
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                         B-spline basis functions can be formed by using the De Boor recursion [19], yielding for 
                           1
                           ≤
                           l
                           ≤
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                           +
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                        ,
                           
                              (15)
                              
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       d
                                       ,
                                       0
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             1
                                             ,
                                          
                                          
                                             if 
                                             
                                                
                                                   U
                                                
                                                
                                                   l
                                                   −
                                                   1
                                                
                                             
                                             ≤
                                             
                                                
                                                   x
                                                
                                                
                                                   d
                                                
                                             
                                             <
                                             
                                                
                                                   U
                                                
                                                
                                                   l
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             otherwise
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                         as well as for 
                           l
                           =
                           1
                           ,
                           ⋯
                           ,
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                           +
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                           −
                           p
                         and 
                           p
                           =
                           1
                           ,
                           ⋯
                           ,
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                        ,
                           
                              (16)
                              
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       d
                                       ,
                                       p
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                       
                                       −
                                       
                                          
                                             U
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             p
                                             +
                                             l
                                             −
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             U
                                          
                                          
                                             l
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       d
                                       ,
                                       p
                                       −
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 +
                                 
                                    
                                       
                                          
                                             U
                                          
                                          
                                             p
                                             +
                                             l
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                       
                                    
                                    
                                       
                                          
                                             U
                                          
                                          
                                             p
                                             +
                                             l
                                          
                                       
                                       −
                                       
                                          
                                             U
                                          
                                          
                                             l
                                          
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       l
                                       +
                                       1
                                    
                                    
                                       (
                                       d
                                       ,
                                       p
                                       −
                                       1
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 )
                                 .
                              
                           
                         Here we have the subscript/superscript 
                           d
                           =
                           R
                         or I.

The De Boor recursion is illustrated in Fig. 1
                        . 
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                           =
                           3
                         to 4 is sufficient for most practical applications. The number of B-spline basis functions should be chosen to be sufficiently large to provide accurate approximation capability but not too large as to cause overfitting and to impose unnecessary modeling complexity. More specifically, 
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                           =
                           6
                         to 10 is usually sufficient for accurate modeling in the finite and known interval 
                           [
                           
                              
                                 U
                              
                              
                                 min
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 max
                              
                           
                           ]
                        . The two boundary knots are obviously related to the known values 
                           
                              
                                 U
                              
                              
                                 min
                              
                           
                         and 
                           
                              
                                 U
                              
                              
                                 max
                              
                           
                        , respectively. The 
                           
                              
                                 N
                              
                              
                                 d
                              
                           
                           +
                           1
                           −
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                         internal knots may be uniformly spaced in the interval 
                           [
                           
                              
                                 U
                              
                              
                                 min
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 max
                              
                           
                           ]
                        . The extrapolation capability of the B-spline model is influenced by the choice of the external knots. Note that there exist no data for 
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                           <
                           
                              
                                 U
                              
                              
                                 min
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                           >
                           
                              
                                 U
                              
                              
                                 max
                              
                           
                         in identification but it is desired that the B-spline model has certain extrapolating capability outside the interval 
                           [
                           
                              
                                 U
                              
                              
                                 min
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 max
                              
                           
                           ]
                        . The external knots can be set empirically to meet the required extrapolation capability. In fact, since no data appears outside 
                           [
                           
                              
                                 U
                              
                              
                                 min
                              
                           
                           ,
                           
                              
                                 U
                              
                              
                                 max
                              
                           
                           ]
                        , the precise choice of these external knots does not really matter, in terms of modeling accuracy. Also note that for QAM signals, the distribution of 
                           
                              
                                 x
                              
                              
                                 d
                              
                           
                         is naturally symmetric and, therefore, the knot sequence should be chosen to be symmetric too.

Using the tensor product between the two sets of univariate B-spline basis functions [20], 
                           
                              
                                 B
                              
                              
                                 l
                              
                              
                                 (
                                 R
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 )
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 R
                              
                           
                           )
                         for 
                           1
                           ≤
                           l
                           ≤
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                         and 
                           
                              
                                 B
                              
                              
                                 m
                              
                              
                                 (
                                 I
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 )
                              
                           
                           (
                           
                              
                                 x
                              
                              
                                 I
                              
                           
                           )
                         for 
                           1
                           ≤
                           m
                           ≤
                           
                              
                                 N
                              
                              
                                 I
                              
                           
                        , a set of the new B-spline basis functions 
                           
                              
                                 B
                              
                              
                                 l
                                 ,
                                 m
                              
                              
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 )
                              
                           
                           (
                           x
                           )
                         can be formed and used in the CV B-spline neural network, giving rise to
                           
                              (17)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 
                                    
                                       Ψ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          R
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       l
                                       ,
                                       m
                                    
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                                 
                                    
                                       ω
                                    
                                    
                                       l
                                       ,
                                       m
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          R
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       l
                                    
                                    
                                       (
                                       R
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       R
                                    
                                 
                                 )
                                 
                                    
                                       B
                                    
                                    
                                       m
                                    
                                    
                                       (
                                       I
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       I
                                    
                                 
                                 )
                                 
                                    
                                       ω
                                    
                                    
                                       l
                                       ,
                                       m
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 ω
                              
                              
                                 l
                                 ,
                                 m
                              
                           
                           =
                           
                              
                                 ω
                              
                              
                                 l
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       R
                                    
                                 
                              
                           
                           +
                           j
                           ⋅
                           
                              
                                 ω
                              
                              
                                 l
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       I
                                    
                                 
                              
                           
                           ∈
                           C
                        , 
                           1
                           ≤
                           l
                           ≤
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                         and 
                           1
                           ≤
                           m
                           ≤
                           
                              
                                 N
                              
                              
                                 I
                              
                           
                        , are the CV weights. Denote the weight vector of the B-spline model (17) as
                           
                              (18)
                              
                                 ω
                                 =
                                 
                                    
                                       [
                                       
                                          
                                             ω
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                       
                                        
                                       
                                          
                                             ω
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       ⋯
                                       
                                          
                                             ω
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                       
                                       ⋯
                                       
                                          
                                             ω
                                          
                                          
                                             
                                                
                                                   N
                                                
                                                
                                                   R
                                                
                                             
                                             ,
                                             
                                                
                                                   N
                                                
                                                
                                                   I
                                                
                                             
                                          
                                       
                                       ]
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 N
                              
                              
                                 B
                              
                           
                           =
                           
                              
                                 N
                              
                              
                                 R
                              
                           
                           
                              
                                 N
                              
                              
                                 I
                              
                           
                        . The task of identifying the nonlinearity 
                           Ψ
                           (
                            
                           )
                         is turned into one of estimating the parameter vector.


                        
                           Remark 1
                           Because of the piecewise nature of B-spline functions, given a value 
                                 
                                    
                                       x
                                    
                                    
                                       d
                                    
                                 
                                 ∈
                                 [
                                 
                                    
                                       U
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       U
                                    
                                    
                                       max
                                    
                                 
                                 ]
                              , there are only 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 1
                               basis functions with nonzero values at most. This is advantageous as 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                               can be set to a quite low value, e.g. 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 4
                               is often sufficient. The complexity of the De Boor recursion is, therefore, on the order of 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                    
                                       2
                                    
                                 
                               
                              [17,19]. Fig. 2
                               shows the complexity of generating the B-spline basis function set for 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 4
                               using the De Boor recursion. Note that the complexity does not depend on the number of basis functions 
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                               employed. For the B-spline model with the polynomial degree 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 =
                                 4
                              , the total computational requirements are 26 additions and 38 multiplications at most.

Thus, in the tensor-product B-spline model of (17), there are only 
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                               nonzero basis functions at most for any given input. This is in fact comparable to the conventional polynomial modeling. For the polynomial model with the polynomial degree 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                              , there are also 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                                 +
                                 1
                               basis functions which are given by
                                 
                                    
                                       1
                                       ,
                                        
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                       
                                       ,
                                        
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                          
                                             2
                                          
                                       
                                       ,
                                       ⋯
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             d
                                          
                                          
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               Thus, the tensor-product polynomial model also have 
                                 
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                    
                                       2
                                    
                                 
                               nonzero basis functions.


                        
                           Remark 2
                           B-splines have been widely studied in the subjects of approximation theory and numerical analysis, owing to their many desired properties. In particular, the B-spline basis functions as model basis have the best approximation capability, because the basis function is complete. Although any polynomial function can also be used to approximate a continuous function, the B-spline functions are proven to be optimally stable bases [21–23]. A critical aspect to consider in a model representation is its stability with respect to perturbation of the model parameters, because in any identification, the data are inevitably noisy, which will perturb the model parameters away from their true values. A significant advantage of using the B-spline model with De Boor algorithm for functional approximation over many other polynomial forms is its superior numerical stability [21–23]. Let us further analyze this aspect. Assume that the real-valued true system can be represented by the polynomial model of degree 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                               as
                                 
                                    
                                       y
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                    
                                 
                               as well as by the following B-spline model exactly
                                 
                                    
                                       y
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             d
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       )
                                       ,
                                    
                                 
                               where 
                                 y
                                 ,
                                 x
                                 ∈
                                 R
                              . Because the identification data are noisy, the estimated model coefficients are perturbed from their true values to 
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                               for the polynomial model, and to 
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                               for the B-spline model. Assume that all the estimation noises 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                               are bounded, namely, 
                                 |
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 <
                                 
                                    
                                       ε
                                    
                                    
                                       max
                                    
                                 
                              . The upper bound of 
                                 |
                                 y
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                                 |
                               for the B-spline model can be worked out to be
                                 
                                    
                                       |
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             d
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       )
                                       −
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             d
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       )
                                       |
                                       <
                                       
                                          
                                             ε
                                          
                                          
                                             max
                                          
                                       
                                       ⋅
                                       |
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                             
                                             
                                                d
                                             
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             d
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       )
                                       |
                                       =
                                       
                                          
                                             ε
                                          
                                          
                                             max
                                          
                                       
                                       .
                                    
                                 
                               Observe that the upper bound of the B-spline model output perturbation only depends on the upper bound of the perturbation noise, and it does not depend on the input value x, the number of basis functions 
                                 
                                    
                                       N
                                    
                                    
                                       d
                                    
                                 
                               or the polynomial degree 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                              . This confirms that the B-spline model has the maximum numerical robustness, which is well-known. Optimality of the B-spline model in terms of numerical stability is due to the convexity of its model bases, i.e. they are all positive and sum to one. By contrast, the upper bound of 
                                 |
                                 y
                                 −
                                 
                                    
                                       y
                                    
                                    
                                       ˆ
                                    
                                 
                                 |
                               for the polynomial model can be worked out to be
                                 
                                    
                                       |
                                       y
                                       −
                                       
                                          
                                             y
                                          
                                          
                                             ˆ
                                          
                                       
                                       |
                                       =
                                       |
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       −
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   a
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                       
                                       ⋅
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       |
                                       <
                                       
                                          
                                             ε
                                          
                                          
                                             max
                                          
                                       
                                       ⋅
                                       |
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                       |
                                    
                                 
                               Observe that the upper bound of the polynomial model output perturbation depends not only on the upper bound of the perturbation noise but also on the input value x and the polynomial degree 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                              . The higher the polynomial degree 
                                 
                                    
                                       P
                                    
                                    
                                       o
                                    
                                 
                              , the more serious the polynomial model may be perturbed, a well-known drawback of using polynomial modeling.

The excellent numerical stability of the B-spline model is illustrated using a simple example. Fig. 3
                              (a) plots a quadratic polynomial function 
                                 y
                                 =
                                 0.001
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 0.02
                                 x
                                 +
                                 0.1
                               defined over 
                                 x
                                 ∈
                                 [
                                 0
                                 ,
                                 20
                                 ]
                               in solid line. Based on the knot sequence of 
                                 {
                                 −
                                 5
                                 ,
                                 −
                                 4
                                 ,
                                 0
                                 ,
                                 20
                                 ,
                                 24
                                 ,
                                 25
                                 }
                              , this function is modeled as a quadratic B-spline model of 
                                 y
                                 =
                                 0.14
                                 
                                    
                                       B
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       d
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                                 −
                                 0.10
                                 
                                    
                                       B
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       d
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                                 +
                                 0.14
                                 
                                    
                                       B
                                    
                                    
                                       3
                                    
                                    
                                       (
                                       d
                                       ,
                                       2
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                              , which is depicted in Fig. 3(b) in solid line. We now draw three noises 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                              , 
                                 1
                                 ≤
                                 i
                                 ≤
                                 3
                              , from a uniformly distributed random number (UDRN) in 
                                 [
                                 −
                                 0.0001
                                 ,
                                 0.0001
                                 ]
                              , and add them to the three parameters in the two models, respectively, to simulate the effects of the noise in identification. Figs. 3(a) and (b) depict the ten sets of the perturbed functions in dashed line generated by perturbing the two models, respectively. It can be clearly seen from Fig. 3(a) that the polynomial model is seriously perturbed, but there is no noticeable change at all in Fig. 3(b) for the quadratic B-spline model. To further demonstrate the maximum robustness of the B-spline model, we next draw three perturbation noises from a UDRN in 
                                 [
                                 −
                                 0.001
                                 ,
                                 0.001
                                 ]
                              , and add them to the three parameters of the B-spline model. Again, the B-spline model is hardly affected, as can be seen from Fig. 3(c). We then draw three perturbation noises from a UDRN in 
                                 [
                                 −
                                 0.01
                                 ,
                                 0.01
                                 ]
                               to add to the three B-spline parameters, and the results obtained are shown in Fig. 3(d). Observe from Figs. 3(a) and (d) that, despite of the fact that the strength of the perturbation noise added to the B-spline model coefficients is 100 times larger than that added to the polynomial model coefficients, the B-spline model is much less seriously perturbed than the polynomial model.

The identification of the Hammerstein channel (2) and (3) then involves estimating the parameter vector 
                              ω
                            of the CV B-spline neural network (17) that represents the HPA nonlinearity 
                              Ψ
                              (
                               
                              )
                            as well as the CIR coefficient vector 
                              h
                           . Note that during the identification of this Hammerstein channel, 
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                            can be assumed because if this is not the case, 
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                            can always be absorbed into the CV static nonlinearity 
                              Ψ
                              (
                               
                              )
                           , and the CIR coefficients are re-scaled as 
                              
                                 
                                    h
                                 
                                 
                                    i
                                 
                              
                              /
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                            for 
                              0
                              ≤
                              i
                              ≤
                              
                                 
                                    L
                                 
                                 
                                    h
                                 
                              
                           . Consider the joint estimation of 
                              ω
                            and 
                              h
                            based on a block of the training data with K samples 
                              
                                 
                                    {
                                    x
                                    (
                                    k
                                    )
                                    ,
                                    y
                                    (
                                    k
                                    )
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                           . The identification task can be formulated as the one that minimizes the cost function
                              
                                 (19)
                                 
                                    
                                       
                                          J
                                       
                                       
                                          icf
                                       
                                    
                                    =
                                    
                                       1
                                       K
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       
                                          |
                                          e
                                          (
                                          k
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       K
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    
                                       
                                          |
                                          y
                                          (
                                          k
                                          )
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                ˆ
                                             
                                          
                                          (
                                          k
                                          )
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                            subject to the constraint 
                              
                                 
                                    h
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                           , in which the model prediction 
                              
                                 
                                    y
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                            is given by
                              
                                 (20)
                                 
                                    
                                       
                                          y
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    k
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    k
                                    −
                                    i
                                    )
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       
                                          h
                                       
                                       
                                          i
                                       
                                    
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          l
                                          ,
                                          m
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                          )
                                       
                                    
                                    (
                                    x
                                    (
                                    k
                                    −
                                    i
                                    )
                                    )
                                    
                                       
                                          ω
                                       
                                       
                                          l
                                          ,
                                          m
                                       
                                    
                                    .
                                 
                              
                            Note that the cost function (19) is convex with respect to 
                              h
                            when fixing 
                              ω
                           , and it is convex with respect to 
                              ω
                            given a fixed 
                              h
                           . This is simply because the model (20) can be viewed as two different linear regression models, namely, one is with respect to 
                              h
                            when fixing 
                              ω
                            and the other is with respect to 
                              ω
                            given a fixed 
                              h
                           , each problem having a closed-form solution. According to [24,25], the estimates of 
                              ω
                            and 
                              h
                            are unbiased, irrespective the optimization algorithm used to minimize the cost function (19). We adopt the following efficient ALS procedure to estimate both 
                              ω
                            and 
                              h
                           .

Noting 
                                 
                                    
                                       h
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 1
                              , define the amalgamated parameter vector as
                                 
                                    (21)
                                    
                                       θ
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   ω
                                                
                                                
                                                   T
                                                
                                             
                                              
                                             
                                                
                                                   h
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   ω
                                                
                                                
                                                   T
                                                
                                             
                                              
                                             
                                                
                                                   h
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                
                                                   ω
                                                
                                                
                                                   T
                                                
                                             
                                             ⋯
                                             
                                                
                                                   h
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   ω
                                                
                                                
                                                   T
                                                
                                             
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             (
                                             
                                                
                                                   L
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             1
                                             )
                                             
                                                
                                                   N
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               and the B-spline basis function vector 
                                 ϕ
                                 (
                                 k
                                 )
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                               for the input 
                                 x
                                 (
                                 k
                                 )
                               as
                                 
                                    (22)
                                    
                                       ϕ
                                       (
                                       k
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             (
                                             k
                                             )
                                              
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             (
                                             k
                                             )
                                             ⋯
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   l
                                                   ,
                                                   m
                                                
                                             
                                             (
                                             k
                                             )
                                             ⋯
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                             (
                                             k
                                             )
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                               with
                                 
                                    (23)
                                    
                                       
                                          
                                             ϕ
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                       
                                       (
                                       k
                                       )
                                       =
                                       
                                          
                                             B
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       (
                                       k
                                       )
                                       )
                                       ,
                                        
                                       1
                                       ≤
                                       l
                                       ≤
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                       ,
                                       1
                                       ≤
                                       m
                                       ≤
                                       
                                          
                                             N
                                          
                                          
                                             I
                                          
                                       
                                       .
                                    
                                 
                               Further define the desired output vector as
                                 
                                    (24)
                                    
                                       y
                                       =
                                       
                                          
                                             [
                                             y
                                             (
                                             1
                                             )
                                              
                                             y
                                             (
                                             2
                                             )
                                             ⋯
                                             y
                                             (
                                             K
                                             )
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             K
                                          
                                       
                                       ,
                                    
                                 
                               and the regression matrix 
                                 P
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       K
                                       ×
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       +
                                       1
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                               as
                                 
                                    (25)
                                    
                                       P
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   k
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   K
                                                   )
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   K
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                   (
                                                   K
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                       .
                                    
                                 
                               Then the LS estimate of 
                                 θ
                               is readily given by
                                 
                                    (26)
                                    
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   T
                                                
                                             
                                             P
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             P
                                          
                                          
                                             T
                                          
                                       
                                       y
                                       .
                                    
                                 
                               Obviously, 
                                 
                                    
                                       θ
                                    
                                    
                                       ˆ
                                    
                                 
                               is a unique and unbiased estimate of 
                                 θ
                              . Therefore, the first 
                                 
                                    
                                       N
                                    
                                    
                                       B
                                    
                                 
                               elements of 
                                 
                                    
                                       θ
                                    
                                    
                                       ˆ
                                    
                                 
                               provide a unique and unbiased LS estimate for the weight vector of the CV B-spline neural network 
                                 ω
                              , which will be denoted as 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       0
                                       )
                                    
                                 
                              .

For 
                                 1
                                 ≤
                                 τ
                                 ≤
                                 
                                    
                                       τ
                                    
                                    
                                       max
                                    
                                 
                              , where 
                                 
                                    
                                       τ
                                    
                                    
                                       max
                                    
                                 
                               is the maximum number of iterations, perform:


                              a) Given the fixed 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       −
                                       1
                                       )
                                    
                                 
                              , calculate the LS estimate 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                              . Specifically, define the regression matrix 
                                 Q
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       K
                                       ×
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       +
                                       1
                                       )
                                    
                                 
                               as
                                 
                                    (27)
                                    
                                       Q
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   1
                                                   )
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   0
                                                   )
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   1
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   k
                                                   )
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   k
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   k
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                                
                                                   ⋮
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   K
                                                   )
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   K
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   ⋯
                                                
                                                
                                                   
                                                      
                                                         w
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                   (
                                                   K
                                                   −
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ]
                                       
                                       ,
                                    
                                 
                               in which
                                 
                                    (28)
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                       (
                                       k
                                       )
                                       =
                                       
                                          
                                             Ψ
                                          
                                          
                                             ˆ
                                          
                                       
                                       (
                                       x
                                       (
                                       k
                                       )
                                       )
                                       =
                                       
                                          ∑
                                          
                                             l
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                             
                                             
                                                R
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             m
                                             =
                                             1
                                          
                                          
                                             
                                                N
                                             
                                             
                                                I
                                             
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       (
                                       k
                                       )
                                       )
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                          
                                             (
                                             τ
                                             −
                                             1
                                             )
                                          
                                       
                                       .
                                    
                                 
                               Then the LS estimate 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                               is readily given by
                                 
                                    (29)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                      ̲
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   Q
                                                
                                                
                                                   H
                                                
                                             
                                             Q
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             H
                                          
                                       
                                       y
                                       ,
                                    
                                 
                              
                              
                                 
                                    (30)
                                    
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                      ̲
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                       /
                                       
                                          
                                             
                                                
                                                   
                                                      h
                                                      ̲
                                                   
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             0
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                       ,
                                       
                                       0
                                       ≤
                                       i
                                       ≤
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       .
                                    
                                 
                               Since 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       −
                                       1
                                       )
                                    
                                 
                               is a unique and unbiased estimate of 
                                 ω
                              , the LS estimate 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                               is guaranteed to be a unique and unbiased estimate of 
                                 h
                              .


                              b) Given the fixed 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                              , calculate the LS estimate 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                              . Specifically, introduce
                                 
                                    (31)
                                    
                                       
                                          
                                             φ
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                       
                                       (
                                       k
                                       )
                                       =
                                       
                                          ∑
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             
                                                L
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             i
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                       
                                          
                                             B
                                          
                                          
                                             l
                                             ,
                                             m
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   o
                                                
                                             
                                             )
                                          
                                       
                                       (
                                       x
                                       (
                                       k
                                       −
                                       i
                                       )
                                       )
                                       ∈
                                       C
                                       .
                                    
                                 
                               Now introduce the regressor vector 
                                 φ
                                 (
                                 k
                                 )
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                    
                                 
                               given by
                                 
                                    (32)
                                    
                                       φ
                                       (
                                       k
                                       )
                                       =
                                       
                                          
                                             [
                                             
                                                
                                                   φ
                                                
                                                
                                                   1
                                                   ,
                                                   1
                                                
                                             
                                             (
                                             k
                                             )
                                              
                                             
                                                
                                                   φ
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             (
                                             k
                                             )
                                             ⋯
                                             
                                                
                                                   φ
                                                
                                                
                                                   l
                                                   ,
                                                   m
                                                
                                             
                                             (
                                             k
                                             )
                                             ⋯
                                             
                                                
                                                   φ
                                                
                                                
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         I
                                                      
                                                   
                                                
                                             
                                             (
                                             k
                                             )
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ,
                                    
                                 
                               and define the regression matrix
                                 
                                    (33)
                                    
                                       S
                                       =
                                       
                                          
                                             [
                                             φ
                                             (
                                             1
                                             )
                                              
                                             φ
                                             (
                                             2
                                             )
                                             ⋯
                                             φ
                                             (
                                             K
                                             )
                                             ]
                                          
                                          
                                             T
                                          
                                       
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             K
                                             ×
                                             
                                                
                                                   N
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                       .
                                    
                                 
                               Then the LS estimate 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                               is readily given by
                                 
                                    (34)
                                    
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             τ
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                
                                                   S
                                                
                                                
                                                   H
                                                
                                             
                                             S
                                             )
                                          
                                          
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             S
                                          
                                          
                                             H
                                          
                                       
                                       y
                                       .
                                    
                                 
                               Since 
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                               is a unique and unbiased estimate of 
                                 h
                              , the LS estimate 
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       τ
                                       )
                                    
                                 
                               must be a unique and unbiased estimate of 
                                 ω
                              .

A few iterations are sufficient for this estimation procedure to arrive at a highly accurate and joint unbiased estimate of 
                                 h
                               and 
                                 ω
                               that is the unique minimum solution of the cost function (20).


                              
                                 Remark 3
                                 It is clear that this ALS procedure guarantees to converge, in fact, in no more than one iteration. A few iterations, typically 2 to 3, are adopted to improve the estimation accuracy or to reduce the estimation variances. More specifically, since 
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                       
                                     is a unique and unbiased estimate of 
                                       ω
                                    , 
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                     is guaranteed to be a unique and unbiased estimate of 
                                       h
                                    . On the other hand, the unique and unbiased estimate 
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                     of the high-dimensional amalgamated parameter vector 
                                       θ
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             (
                                             
                                                
                                                   L
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             1
                                             )
                                             
                                                
                                                   N
                                                
                                                
                                                   B
                                                
                                             
                                          
                                       
                                     may have relative high estimation variances, owing to the low ratio of the available training data over the dimension 
                                       (
                                       
                                          
                                             L
                                          
                                          
                                             h
                                          
                                       
                                       +
                                       1
                                       )
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                    . Consequently, The first 
                                       
                                          
                                             N
                                          
                                          
                                             B
                                          
                                       
                                     elements of 
                                       
                                          
                                             θ
                                          
                                          
                                             ˆ
                                          
                                       
                                    , i.e. 
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                       
                                     may have a relatively poor estimation accuracy. With the fixed 
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    , the LS estimate 
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                     has lower estimation variance than 
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             0
                                             )
                                          
                                       
                                    . In the second iteration, the estimation accuracy of 
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                     will be further enhanced, in comparison to the estimation accuracy of 
                                       
                                          
                                             
                                                
                                                   h
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                
                                                   ω
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                    .

With the estimated HPA's nonlinearity 
                              
                                 
                                    Ψ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                               
                              )
                            and the CIR tap vector 
                              
                                 
                                    h
                                 
                                 
                                    ˆ
                                 
                              
                           , an estimated noise power is readily given by 
                              2
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    J
                                 
                                 
                                    icf
                                 
                              
                              (
                              
                                 
                                    h
                                 
                                 
                                    ˆ
                                 
                              
                              ,
                              
                                 
                                    ω
                                 
                                 
                                    ˆ
                                 
                              
                              )
                           , while an estimate for the power of the unobserved 
                              w
                              (
                              k
                              )
                            is given by
                              
                                 (35)
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          w
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       K
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    |
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    k
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       K
                                    
                                    
                                       ∑
                                       
                                          k
                                          =
                                          1
                                       
                                       K
                                    
                                    |
                                    
                                       
                                          Ψ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    x
                                    (
                                    k
                                    )
                                    )
                                    
                                       
                                          |
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                            Then the linear equalizer's weight vector 
                              
                                 
                                    
                                       
                                          g
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    MMSE
                                 
                              
                            is readily provided by (11) based on the estimates of 
                              
                                 
                                    h
                                 
                                 
                                    ˆ
                                 
                              
                           , 
                              2
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                            and 
                              
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                           .

Given 
                              Ψ
                              (
                              •
                              )
                           , we need to compute its inversion as defined by 
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              −
                              ι
                              )
                              =
                              
                                 
                                    Ψ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              −
                              ι
                              )
                              )
                            of (13) in order to complete the nonlinear equalization. This task is identical to find the CV root of 
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                              =
                              Ψ
                              (
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                              )
                           , given 
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                           , which can be solved iteratively based on the Gauss–Newton algorithm [14,17,18]. Given the estimated 
                              
                                 
                                    Ψ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                               
                              )
                            and during the data detection, the strategy of [14,17,18] requires to iteratively calculate the root of 
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              −
                              ι
                              )
                              =
                              
                                 
                                    Ψ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              −
                              ι
                              )
                              )
                            for each linearly equalized received signal sample 
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              −
                              ι
                              )
                            in order to obtain the estimate 
                              
                                 
                                    x
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              −
                              ι
                              )
                            of the transmitted data symbol 
                              x
                              (
                              k
                              −
                              ι
                              )
                           . In order to avoid the iterative root finding procedure for every sample 
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                           , it is more efficient to directly construct a mapping to model 
                              x
                              (
                              k
                              )
                              =
                              Φ
                              (
                              w
                              (
                              k
                              )
                              )
                              =
                              
                                 
                                    Ψ
                                 
                                 
                                    −
                                    1
                                 
                              
                              (
                              w
                              (
                              k
                              )
                              )
                           . We adopt another CV B-spline neural network to represent the inverse mapping 
                              Φ
                              (
                              w
                              (
                              k
                              )
                              )
                           . To learn the mapping 
                              x
                              (
                              k
                              )
                              =
                              Φ
                              (
                              w
                              (
                              k
                              )
                              )
                           , however, a training data set 
                              {
                              w
                              (
                              k
                              )
                              ,
                              x
                              (
                              k
                              )
                              }
                            would be needed but 
                              w
                              (
                              k
                              )
                            is unobservable and, therefore, is not available. Fortunately, in the Hammerstein channel identification, we already obtain an estimate 
                              
                                 
                                    Ψ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                               
                              )
                            for the HPA's nonlinearity 
                              Ψ
                              (
                               
                              )
                           . Therefore, we may construct the “pseudo” training data set 
                              
                                 
                                    {
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    x
                                    (
                                    k
                                    )
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                            for identifying the inverse mapping 
                              Φ
                              (
                               
                              )
                           , where 
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                            is computed based on the estimated 
                              
                                 
                                    Ψ
                                 
                                 
                                    ˆ
                                 
                              
                              (
                               
                              )
                           .

More specifically, define the two knot sequences similar to (14) for 
                              
                                 
                                    w
                                 
                                 
                                    R
                                 
                              
                            and 
                              
                                 
                                    w
                                 
                                 
                                    I
                                 
                              
                           . Similar to (17), we construct the inverting B-spline neural network
                              
                                 (36)
                                 
                                    
                                       
                                          x
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       
                                          Φ
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    w
                                    )
                                    =
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          l
                                          ,
                                          m
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                          )
                                       
                                    
                                    (
                                    w
                                    )
                                    
                                       
                                          α
                                       
                                       
                                          l
                                          ,
                                          m
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             R
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          m
                                          =
                                          1
                                       
                                       
                                          
                                             N
                                          
                                          
                                             I
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          l
                                       
                                       
                                          (
                                          R
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          R
                                       
                                    
                                    )
                                    
                                       
                                          B
                                       
                                       
                                          m
                                       
                                       
                                          (
                                          I
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                o
                                             
                                          
                                          )
                                       
                                    
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          I
                                       
                                    
                                    )
                                    
                                       
                                          α
                                       
                                       
                                          l
                                          ,
                                          m
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    B
                                 
                                 
                                    l
                                 
                                 
                                    (
                                    R
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    R
                                 
                              
                              )
                            and 
                              
                                 
                                    B
                                 
                                 
                                    m
                                 
                                 
                                    (
                                    I
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    I
                                 
                              
                              )
                            are respectively calculated based on (15) and (16), while
                              
                                 (37)
                                 
                                    α
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                α
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                          
                                           
                                          
                                             
                                                α
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                          
                                          ⋯
                                          
                                             
                                                α
                                             
                                             
                                                l
                                                ,
                                                m
                                             
                                          
                                          ⋯
                                          
                                             
                                                α
                                             
                                             
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      R
                                                   
                                                
                                                ,
                                                
                                                   
                                                      N
                                                   
                                                   
                                                      I
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    ∈
                                    
                                       
                                          C
                                       
                                       
                                          
                                             
                                                N
                                             
                                             
                                                B
                                             
                                          
                                       
                                    
                                 
                              
                            is the parameter vector of this inverting B-spline neural network. Here for notational simplicity, we assume that the same number of basis functions and the same polynomial degree are used for the two B-spline neural networks that model 
                              Ψ
                              (
                              x
                              )
                            and 
                              Φ
                              (
                              w
                              )
                           . Over the pseudo training data set 
                              
                                 
                                    {
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    (
                                    k
                                    )
                                    ,
                                    x
                                    (
                                    k
                                    )
                                    }
                                 
                                 
                                    k
                                    =
                                    1
                                 
                                 
                                    K
                                 
                              
                           , the regression matrix 
                              
                                 
                                    B
                                 
                                 
                                    ˆ
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    K
                                    ×
                                    
                                       
                                          N
                                       
                                       
                                          B
                                       
                                    
                                 
                              
                            can be formed as
                              
                                 (38)
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                    =
                                    
                                       [
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                2
                                                )
                                             
                                          
                                          
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                             
                                                ⋮
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      1
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                K
                                                )
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      1
                                                      ,
                                                      2
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                K
                                                )
                                             
                                             
                                                ⋯
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                         ¯
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            I
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            o
                                                         
                                                      
                                                      )
                                                   
                                                
                                                (
                                                K
                                                )
                                             
                                          
                                       
                                       ]
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    
                                       B
                                       ¯
                                    
                                 
                                 
                                    l
                                    ,
                                    m
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                              
                              (
                              k
                              )
                              =
                              
                                 
                                    B
                                 
                                 
                                    l
                                    ,
                                    m
                                 
                                 
                                    (
                                    
                                       
                                          P
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                              
                              (
                              
                                 
                                    w
                                 
                                 
                                    ˆ
                                 
                              
                              (
                              k
                              )
                              )
                           , while the associated desired output vector is given by
                              
                                 (39)
                                 
                                    x
                                    =
                                    
                                       
                                          [
                                          x
                                          (
                                          1
                                          )
                                           
                                          x
                                          (
                                          2
                                          )
                                          ⋯
                                          x
                                          (
                                          K
                                          )
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    .
                                 
                              
                            Then the LS solution for 
                              α
                            is readily given by 
                              
                                 
                                    α
                                 
                                 
                                    ˆ
                                 
                              
                              =
                              
                                 
                                    (
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                 
                                 
                                    −
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          B
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    T
                                 
                              
                              x
                           .

During the data communication phase, since the transmitter HPA 
                           Ψ
                           (
                            
                           )
                         remains the same, the estimated HPA's nonlinearity 
                           
                              
                                 Ψ
                              
                              
                                 ˆ
                              
                           
                           (
                            
                           )
                         and its inversion 
                           
                              
                                 Φ
                              
                              
                                 ˆ
                              
                           
                           (
                            
                           )
                           =
                           
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 −
                                 1
                              
                           
                           (
                            
                           )
                         obtained during the training remain valid. Therefore, we do not need to update these two B-spline models' parameter vectors, 
                           
                              
                                 ω
                              
                              
                                 ˆ
                              
                           
                         and 
                           
                              
                                 α
                              
                              
                                 ˆ
                              
                           
                        . However, as the CIR changes from frame to frame, the estimated CIR tap vector 
                           
                              
                                 h
                              
                              
                                 ˆ
                              
                           
                         obtained during the training must be adapted. We adopt a decision-directed (DD) LS estimator to update the CIR coefficient vector during the data communication.

Specifically, let f be the data frame index, while 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 (
                                 f
                                 )
                              
                           
                         and 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 MMSE
                              
                              
                                 (
                                 f
                                 )
                              
                           
                         denote the estimated CIR tap vector and the corresponding linear equalizer weight vector, respectively, after the detection of the f-th data frame. Also the training based estimates are denoted as 
                           
                              
                                 h
                              
                              
                                 ˆ
                              
                           
                           =
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 (
                                 0
                                 )
                              
                           
                         and 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 MMSE
                              
                           
                           =
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 MMSE
                              
                              
                                 (
                                 0
                                 )
                              
                           
                        , respectively. Given 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 MMSE
                              
                              
                                 (
                                 f
                                 −
                                 1
                                 )
                              
                           
                         and 
                           
                              
                                 Φ
                              
                              
                                 ˆ
                              
                           
                           (
                            
                           )
                           =
                           
                              
                                 
                                    
                                       Ψ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 −
                                 1
                              
                           
                           (
                            
                           )
                        , the detection of the f-th data frame is carried out by performing the nonlinear equalization of (9) and (13), and then quantising the resulting 
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           (
                           k
                           )
                         to obtain the hard decisions 
                           
                              
                                 x
                              
                              
                                 ˜
                              
                           
                           (
                           k
                           )
                         for 
                           1
                           ≤
                           k
                           ≤
                           
                              
                                 N
                              
                              
                                 F
                              
                           
                        . Given the estimate of the HPA 
                           
                              
                                 Ψ
                              
                              
                                 ˆ
                              
                           
                           (
                            
                           )
                         and based on the hard decisions of 
                           
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 k
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                              
                           
                        , the DD estimate of the HPA's output can be calculated according to
                           
                              (40)
                              
                                 
                                    
                                       w
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 k
                                 )
                                 =
                                 
                                    
                                       Ψ
                                    
                                    
                                       ˆ
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 k
                                 )
                                 )
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          R
                                       
                                    
                                 
                                 
                                    ∑
                                    
                                       m
                                       =
                                       1
                                    
                                    
                                       
                                          N
                                       
                                       
                                          I
                                       
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       l
                                       ,
                                       m
                                    
                                    
                                       (
                                       
                                          
                                             P
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       ˜
                                    
                                 
                                 (
                                 k
                                 )
                                 )
                                 
                                    
                                       
                                          
                                             ω
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       l
                                       ,
                                       m
                                    
                                 
                                 .
                              
                           
                         By constructing the DD regression matrix 
                           
                              
                                 Q
                              
                              
                                 ˜
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                                 ×
                                 (
                                 
                                    
                                       L
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 1
                                 )
                              
                           
                         as
                           
                              (41)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       ˜
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             1
                                             )
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             0
                                             )
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             1
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             k
                                             )
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             k
                                             −
                                             1
                                             )
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             k
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   F
                                                
                                             
                                             )
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   F
                                                
                                             
                                             −
                                             1
                                             )
                                          
                                          
                                             ⋯
                                          
                                          
                                             
                                                
                                                   w
                                                
                                                
                                                   ˜
                                                
                                             
                                             (
                                             
                                                
                                                   N
                                                
                                                
                                                   F
                                                
                                             
                                             −
                                             
                                                
                                                   L
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         and denoting the corresponding channel observation vector as 
                           
                              
                                 y
                              
                              
                                 ˜
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    
                                       N
                                    
                                    
                                       F
                                    
                                 
                              
                           
                        , the DD LS estimate is readily be obtained as
                           
                              (42)
                              
                                 
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       f
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             
                                                
                                                   Q
                                                
                                                
                                                   ˜
                                                
                                             
                                          
                                          
                                             H
                                          
                                       
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       
                                          
                                             Q
                                          
                                          
                                             ˜
                                          
                                       
                                    
                                    
                                       H
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       ˜
                                    
                                 
                                 .
                              
                           
                         Given 
                           
                              
                                 
                                    
                                       h
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 (
                                 f
                                 )
                              
                           
                         as well as the training based estimates 
                           2
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 n
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 
                                    
                                       σ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 w
                              
                              
                                 2
                              
                           
                        , we can obtain an updated linear equalizer's weight vector 
                           
                              
                                 
                                    
                                       g
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 MMSE
                              
                              
                                 (
                                 f
                                 )
                              
                           
                         according to (11). Algorithm 1
                         summarizes the detection of each data frame, which involves two iterations of the above-mentioned DD adaptation.


                        
                           Remark 4
                           While maintaining a high system throughput, this decision-directed updating scheme introduces a fixed delay in detecting each data frame. Since this delay is constant for every data frame, it will not cause problem even to real-time applications. Alternative would be to allocate part of each data frame, e.g. 10%, for training, at a cost of significantly reducing the achievable system throughput.

For most practical systems, the transmitter HPA can be modeled by a CV static nonlinear mapping. In some systems, HPAs may exhibit memory [26]. By modeling an HPA with memory as a Hammerstein system, namely, a CV static nonlinearity 
                           Ψ
                           (
                           •
                           )
                           :
                           C
                           →
                           C
                         followed by a FIR linear filter, then the combined HPA and dispersive channel can also be represented by our model of (2) and (3), where the linear filter (3) is the convolution of the HPA's FIR filter and the dispersive channel. Thus, the nonlinear equalization approach developed in this work can be applied directly to this class of nonlinear HPAs with memory.

Another popular model for nonlinear HPAs with memory is the Wiener model [4] which represents an HPA with memory by a FIR filter followed by a CV static nonlinearity. This class of nonlinear dispersive channels with the Wiener HPA at transmitter is depicted in the top part of Fig. 4
                        , while the bottom part of Fig. 4 illustrates the corresponding nonlinear equalizer design. The same tensor-product B-spline model of (17) can be adopted to model the CV static nonlinearity 
                           Ψ
                           (
                           •
                           )
                        . However, the identification of the nonlinear system illustrated in Fig. 4 is a much more difficult task. In particular, nonlinear estimation methods, such as the gradient-based algorithms [13,18,27] and the evolutionary algorithms [12], must be employed in order to estimate the parameter vectors of the linear filter 
                           
                              
                                 FIR
                              
                              
                                 HPA
                              
                           
                           (
                           •
                           )
                        , the B-spline model of the CV static nonlinearity 
                           Ψ
                           (
                           •
                           )
                         and the linear filter 
                           
                              
                                 FIR
                              
                              
                                 chn
                              
                           
                           (
                           •
                           )
                        , which are inherently high complexity and may suffers from the drawback of slow convergence.

Once the estimates of 
                           
                              
                                 FIR
                              
                              
                                 HPA
                              
                           
                           (
                           •
                           )
                        , 
                           Ψ
                           (
                           •
                           )
                         and 
                           
                              
                                 FIR
                              
                              
                                 chn
                              
                           
                           (
                           •
                           )
                         are obtained, it is straightforward to applied the nonlinear equalizer design presented in this work. Specifically, the partial equalizers 
                           
                              
                                 FIR
                              
                              
                                 chn
                              
                              
                                 −
                                 1
                              
                           
                           (
                           •
                           )
                         and 
                           
                              
                                 FIR
                              
                              
                                 HPA
                              
                              
                                 −
                                 1
                              
                           
                           (
                           •
                           )
                         can readily be obtained based on the estimates of 
                           
                              
                                 FIR
                              
                              
                                 chn
                              
                           
                           (
                           •
                           )
                         and 
                           
                              
                                 FIR
                              
                              
                                 HPA
                              
                           
                           (
                           •
                           )
                        , respectively. The inverse nonlinearity 
                           
                              
                                 Ψ
                              
                              
                                 −
                                 1
                              
                           
                           (
                           •
                           )
                         can be modeled by the same inverting B-spline model of (36), whose parameters can be estimated in a similar manner based on the pseudo training data 
                           
                              
                                 {
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       O
                                    
                                 
                                 (
                                 k
                                 )
                                 ,
                                 
                                    
                                       
                                          
                                             w
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       I
                                    
                                 
                                 (
                                 k
                                 )
                                 }
                              
                              
                                 k
                                 =
                                 1
                              
                              
                                 K
                              
                           
                         calculated using the estimates of 
                           
                              
                                 FIR
                              
                              
                                 HPA
                              
                           
                           (
                           •
                           )
                         and 
                           Ψ
                           (
                           •
                           )
                        .

We considered the 64-QAM Hammerstein communication system in which the HPA employed was described by (4) and (5) with the parameter set given in (6). We assumed a quasi-frame-static Rayleigh multipath channel with an exponentially decreasing power delay profile, where the average gain for the lth path was given by
                        
                           (43)
                           
                              E
                              [
                              |
                              
                                 
                                    h
                                 
                                 
                                    l
                                 
                              
                              |
                              ]
                              =
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       l
                                       η
                                    
                                 
                              
                              ,
                              
                              0
                              ≤
                              l
                              ≤
                              
                                 
                                    L
                                 
                                 
                                    h
                                 
                              
                              .
                           
                        
                      In the simulation, the channel degradation factor was chosen to be 
                        η
                        =
                        2
                      while the channel length was set to 
                        
                           
                              L
                           
                           
                              h
                           
                        
                        =
                        3
                     . Each frame contained 
                        
                           
                              N
                           
                           
                              F
                           
                        
                        =
                        2000
                      64-QAM data symbols, while the first frame was used for training, yielding 
                        K
                        =
                        
                           
                              N
                           
                           
                              F
                           
                        
                        =
                        2000
                     . The CIR coefficients 
                        
                           
                              h
                           
                           
                              l
                           
                        
                      for 
                        0
                        ≤
                        l
                        ≤
                        
                           
                              L
                           
                           
                              h
                           
                        
                      changed at the beginning of each frame according to a Rayleigh fading distribution with the normalized Doppler frequency of 
                        
                           
                              f
                           
                           
                              d
                           
                        
                        =
                        0.0001
                     , but they remained constant within a frame. The linear equalizer's length was chosen to be 
                        
                           
                              L
                           
                           
                              g
                           
                        
                        =
                        15
                      and the decision delay was set to 
                        ι
                        =
                        0
                     . The piecewise quartic polynomial of 
                        
                           
                              P
                           
                           
                              o
                           
                        
                        =
                        4
                      was chosen as the B-spline basis function, and the number of B-spline basis functions was set to 
                        
                           
                              N
                           
                           
                              R
                           
                        
                        =
                        
                           
                              N
                           
                           
                              I
                           
                        
                        =
                        8
                     . The empirically determined knot sequences for the two B-spline models covering different HPA operating conditions are listed in Table 1
                     . The system's signal-to-noise ratio (SNR) was defined as 
                        SNR
                        =
                        
                           
                              E
                           
                           
                              s
                           
                        
                        /
                        
                           
                              N
                           
                           
                              o
                           
                        
                     , where 
                        
                           
                              E
                           
                           
                              s
                           
                        
                      was the average power of the input signal 
                        x
                        (
                        k
                        )
                      to the HPA and 
                        
                           
                              N
                           
                           
                              o
                           
                        
                        =
                        2
                        
                           
                              σ
                           
                           
                              n
                           
                           
                              2
                           
                        
                      was the channel AWGN's power.

We first considered the stationary channel, whose CIR tap vector 
                           h
                         is listed in Table 2
                        , in order to evaluate the training performance of the proposed B-spline neural network based nonlinear equalizer. The ALS algorithm of Section 3.2 was used to identify this Hammerstein channel, specifically, to provide both the estimates of the CIR vector 
                           
                              
                                 h
                              
                              
                                 ˆ
                              
                           
                         and the B-spline neural network's weight vector 
                           
                              
                                 ω
                              
                              
                                 ˆ
                              
                           
                        . It was observed that no more than four iterations were sufficient for the algorithm to obtain the highly accurate estimation results as summarized in Table 2 as well as illustrated in Fig. 5
                        . Indeed, observe from Table 2 that the identification of the CIR tap vector in the nonlinear Hammerstein channel was achieved with high precision even under the adverse operational condition of 
                           OBO
                           =
                           5
                            
                           dB
                         and 
                           
                              
                                 E
                              
                              
                                 s
                              
                           
                           /
                           
                              
                                 N
                              
                              
                                 o
                              
                           
                           =
                           5
                            
                           dB
                        . Note that under the HPA operational condition of 
                           OBO
                           =
                           5
                            
                           dB
                        , the peak amplitude of 
                           |
                           x
                           (
                           k
                           )
                           |
                         was less than 0.09, while under the condition of 
                           OBO
                           =
                           8
                            
                           dB
                        , the peak amplitude of 
                           |
                           x
                           (
                           k
                           )
                           |
                         was less than 0.06. The results of Fig. 5 clearly demonstrate the capability of the proposed CV B-spline neural network to accurately model the HPA's nonlinearity 
                           Ψ
                           (
                            
                           )
                        . To be more specifically, within the HPA's operational input range, the estimated amplitude response exhibits negligible deviation from the true HPA's amplitude response, while the maximum error in the estimated phase response is no more than 0.01 radian. From Fig. 5, it can also be seen that the channel noise 
                           n
                           (
                           k
                           )
                         has little effort on the accuracy of the amplitude response estimate, but the noise has noticeable influence on the accuracy of the phase response estimate.

The effectiveness of the proposed CV B-spline inversion based on the pseudo training data is next demonstrated, and Fig. 6
                         depicts the combined response of the HPA's true nonlinearity and its estimated inversion obtained under the operating conditions of 
                           OBO
                           =
                           5
                            
                           dB
                         and 
                           
                              
                                 E
                              
                              
                                 s
                              
                           
                           /
                           
                              
                                 N
                              
                              
                                 o
                              
                           
                           =
                           5
                            
                           dB
                         as well as 
                           OBO
                           =
                           5
                            
                           dB
                         and 
                           
                              
                                 E
                              
                              
                                 s
                              
                           
                           /
                           
                              
                                 N
                              
                              
                                 o
                              
                           
                           =
                           10
                            
                           dB
                        , respectively. The results of Fig. 6 show that the CV B-spline inversion estimated based on the pseudo training data is highly accurate. Specifically, within the HPA's operating input range, the combined amplitude response of the HPA's true nonlinearity and the estimated B-spline inversion matches the ideal response, while the combined phase response only deviates from the ideal response of zero by no more than 0.01 radian. For the given operating condition of 
                           OBO
                           =
                           8
                            
                           dB
                         and 
                           
                              
                                 E
                              
                              
                                 b
                              
                           
                           /
                           
                              
                                 N
                              
                              
                                 o
                              
                           
                           =
                           10
                            
                           dB
                        , Fig. 7
                         plots the HPA's input signal 
                           x
                           (
                           k
                           )
                        , the noisy Hammerstein channel's output signal 
                           y
                           (
                           k
                           )
                        , the linearly equalized signal 
                           
                              
                                 w
                              
                              
                                 ˆ
                              
                           
                           (
                           k
                           )
                         based on the estimated CIR 
                           
                              
                                 h
                              
                              
                                 ˆ
                              
                           
                        , and the nonlinearly equalized signal 
                           
                              
                                 x
                              
                              
                                 ˆ
                              
                           
                           (
                           k
                           )
                         based on the estimated CIR 
                           
                              
                                 h
                              
                              
                                 ˆ
                              
                           
                         and the estimated B-spline inversion 
                           
                              
                                 Φ
                              
                              
                                 ˆ
                              
                           
                           (
                            
                           )
                        . The results of Fig. 7 further illustrate the power of the proposed B-spline neural network based nonlinear equalizer for combating the dispersive channel as well as compensating the transmitter HPA's nonlinearity.

The achievable BER performance of the proposed nonlinear equalizer constructed based on the estimated CIR 
                           
                              
                                 h
                              
                              
                                 ˆ
                              
                           
                         and the estimated B-spline inversion 
                           
                              
                                 Φ
                              
                              
                                 ˆ
                              
                           
                           (
                            
                           )
                         are depicted in Fig. 8
                         under the two operating conditions of the transmitter HPA, in comparison to the BER performance attained by the standard linear equalizer. It can be seen from Fig. 8 that as expected, the linear equalization alone is incapable of compensating the transmitter HPA's nonlinearity. More specifically, for the 64-QAM signaling, the HPA operates at 
                           OBO
                           =
                           5
                            
                           dB
                         exhibits the relatively severe nonlinearity and as a result, the linear equalizer performs poorly with a high error floor of above 
                           
                              
                                 10
                              
                              
                                 −
                                 2
                              
                           
                        . By adopting the proposed nonlinear equalizer, a large part of the nonlinearity is removed, which enables the equalizer to lower the error floor by the three orders of magnitude, compared with the linear equalizer. Even when the transmitter HPA operates under the condition of 
                           OBO
                           =
                           8
                            
                           dB
                        , which only exhibits relatively mild nonlinearity, the linear equalizer still shows an error floor of above 
                           
                              
                                 10
                              
                              
                                 −
                                 4
                              
                           
                        . By contrast, the proposed nonlinear equalizer significantly outperforms the linear equalizer, as confirmed in Fig. 8.

As mentioned in Section 3.1, two tensor-product polynomial models, both having a polynomial degree of 
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                         in each dimension, can also be utilized to estimate the CV HPA's static nonlinearity 
                           Ψ
                           (
                           •
                           )
                         and its inversion 
                           
                              
                                 Ψ
                              
                              
                                 −
                                 1
                              
                           
                           (
                           •
                           )
                        , respectively, based on the same identification procedure developed in Section 3, yielding a polynomial based nonlinearity equalizer. In our simulation study, we also adopted the tensor-product polynomial model of degree 
                           
                              
                                 P
                              
                              
                                 o
                              
                           
                           =
                           4
                        , which had 25 basis functions that was comparable to the tensor-product B-spline model of at most 25 nonzero basis functions for any given input. The achievable BER performance of this polynomial based nonlinear equalizer are also shown in Fig. 8, where it can be seen that the performance of the polynomial based nonlinear equalizer is slightly inferior to that of the proposed B-spline based nonlinear equalizer, particularly when the HPA is operating in the severe nonlinear region.

We then investigated the achievable performance of the proposed decision-directed adaptive B-spline nonlinear equalizer based on the DD adaptive scheme of Algorithm 1, under the environment of frame-fading CIR, where the CIR tap coefficients faded at the beginning of each frame with the normalized Doppler frequency of 
                           
                              
                                 f
                              
                              
                                 d
                              
                           
                           =
                           0.0001
                        , but they remained constant within each frame. Fig. 9
                         compares the performance of the proposed DD adaptive B-spline nonlinear equalizer with that of the non-adaptive B-spline nonlinear equalizer which was fixed based on the training results obtained in the first frame. As expected, the non-adaptive nonlinear equalizer is unable to track the time-varying channel, and its BER performance is very poor. By contrast, with the aid of the DD adaptive scheme of Algorithm 1, the DD adaptive B-spline nonlinear equalizer is capable of tracking the time-varying channel reasonably well and, consequently, significantly improves the attainable BER performance. Observe from Fig. 9 that for the extremely low SNR conditions, the DD adaptive nonlinear equalizer actually performs worse than the non-adaptive one. Specifically, given the 
                           OBO
                           =
                           5
                            
                           dB
                         and 
                           SNR
                           ≤
                           −
                           1
                            
                           dB
                         as well as given the 
                           OBO
                           =
                           8
                            
                           dB
                         and 
                           SNR
                           ≤
                           −
                           3
                            
                           dB
                         the non-adaptive equalizer outperforms the DD adaptive equalizer. This is due to the well-known error propagation phenomenon. Under such extremely low SNR conditions, a large portion of the decisions are erroneous, which degrade the DD adaptive algorithm severely. Fig. 10
                         compares the performance of the DD adaptive B-spline based nonlinear equalizer with that of the DD adaptive polynomial based nonlinear equalizer. The results of Fig. 10 demonstrate that the DD adaptive B-spline based nonlinear equalizer outperforms the DD adaptive polynomial based nonlinear equalizer.

@&#CONCLUSIONS@&#

We have proposed a novel CV B-spline neural network based nonlinear equalizer for the nonlinear Hammerstein communication system that employs high-order QAM signaling with nonlinear transmitter high power amplifier and communicates over the dispersive channel. Specifically, we have extended a recent development of the CV B-spline neural network based approach to construct nonlinear equalizer for Hammerstein channels, which employs a CV B-spline neural network to model the HPA's nonlinearity as well as uses another CV B-spline neural network to model the inversion of the HPA's nonlinearity. During training, the Hammerstein channel model parameters that include the CIR coefficients and the B-spline neural network weights can readily be estimated using a highly efficient ALS algorithm, while the weights of the B-spline inversion model can be identified using a standard LS algorithm based on the pseudo training data as a natural by-product of the Hammerstein channel model identification. Moreover, a decision-directed adaptive algorithm has been adopted to track the time-varying channel during data communication. The effectiveness of our proposed nonlinear equalization approach has been demonstrated in a simulation study, and the results obtained confirm that our B-spline neural network based nonlinear equalizer is capable of efficiently combating the dispersive transmission medium and compensating the detrimental transmitter HPA's nonlinearity as well as effectively tracking the time-varying channel.

@&#REFERENCES@&#

