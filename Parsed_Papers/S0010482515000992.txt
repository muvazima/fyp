@&#MAIN-TITLE@&#Multi-class biological tissue classification based on a multi-classifier: Preliminary study of an automatic output power control for ultrasonic surgical units

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We applied a machine learning algorithm-based classification method.


                        
                        
                           
                           We developed a device for measuring the impedance characteristics of in vivo tissues.


                        
                        
                           
                           Novel multi-classifier could automatically detect 6 classes of tissue effectively.


                        
                        
                           
                           The multi-classifier with an electrode of 3mm invasive type showed the best performance.


                        
                        
                           
                           Introduced model could be applied in ischemia monitoring and tumor detection.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ultrasonic surgical units

Power auto-control

Impedance

Tissue classification

Multi-classifier

@&#ABSTRACT@&#


               
               
                  Ultrasonic surgical units (USUs) have the advantage of minimizing tissue damage during surgeries that require tissue dissection by reducing problems such as coagulation and unwanted carbonization, but the disadvantage of requiring manual adjustment of power output according to the target tissue. In order to overcome this limitation, it is necessary to determine the properties of in vivo tissues automatically. We propose a multi-classifier that can accurately classify tissues based on the unique impedance of each tissue. For this purpose, a multi-classifier was built based on single classifiers with high classification rates, and the classification accuracy of the proposed model was compared with that of single classifiers for various electrode types (Type-I: 6mm invasive; Type-II: 3mm invasive; Type-III: surface). The sensitivity and positive predictive value (PPV) of the multi-classifier by cross checks were determined. According to the 10-fold cross validation results, the classification accuracy of the proposed model was significantly higher (p<0.05 or <0.01) than that of existing single classifiers for all electrode types. In particular, the classification accuracy of the proposed model was highest when the 3mm invasive electrode (Type-II) was used (sensitivity=97.33–100.00%; PPV=96.71–100.00%). The results of this study are an important contribution to achieving automatic optimal output power adjustment of USUs according to the properties of individual tissues.
               
            

@&#INTRODUCTION@&#

Ultrasonic surgical units (USUs) that are used in laparoscopic and thoracoscopic surgery have been developed to overcome problems such as spark, charring, and inefficient coagulation associated with electrosurgical units [1–5]. However, USUs have the limitation that the surgeons have to manually control the optimal output power according to properties of the tissue [6,7]. This subjective procedure could lead to a process of trial and error and might delay the operation time [7]. Therefore, it is necessary to develop a method to control the optimal output power of USUs automatically.

To develop such a method, in vivo tissues must be automatically distinguished, preferentially. The impedance that refers to the electrical characteristics of the tissue, which are dependent on the properties of the cells that make up the tissue at the molecular level and differ from tissue to tissue, can be used to classify the type of tissue. To date, impedance characteristics of tissues have been investigated in various medical fields, including dentistry [8] and internal medicine [9], mostly to classify normal and lesion tissues in conditions such as ischemia [10–12] and tumors [13–15]. Åberg et al. analyzed impedance data of normal tissue and denatured tissue (birthmarks, melanomas, and other human skin cancers) using a binary classification algorithm to determine the presence of disease [14]. More recently, Kalvøy et al. classified heterogeneous tissues for drug administration. They applied a partial least-squares discriminate analysis (PLS-DA) algorithm to the impedance data in order to classify two tissue types: muscle and fat [16]. However, the tissues encountered during laparoscopic and thoracoscopic surgeries are more diverse, not only muscle and fat tissues but also liver or lung tissues. Moreover, because the impedance values of tissues were reported to have a non-linear distribution [16,17], a higher order polynomial should be needed to classify the class of tissues. The impedance characteristics of muscle, fat, liver, and lung tissues extracted from pigs (
                     Fig. 1(A)) showed non-linear distribution by each other as shown in Fig. 1(B) in this study. Therefore, the methods used in previous studies, such as binary classification, linear classification, and statistical analysis, have limitations for the classification of more than three types of tissue with a non-linear distribution of impedance.

In order to classify the intrinsic impedance value of multiple classes of tissue with a non-linear distribution, we applied a machine learning algorithm-based classification method that uses the inherent unique properties of the multi-dimensional input data. This approach has been applied in the fields of behavior pattern analysis [18], biometrics [19], and even in clinical areas such as prediction and diagnosis of disease [20,21]. However, previous studies have reported that there are differences in classification performance among each classifier with the same data set and limitations in the accuracy of multi-dimensional class classification with a single classifier [22]. For these reasons, recent studies have used a multi-classifier as a method of combining the results of several single classifiers; this approach has resulted in a higher classification rate than that achieved using single classifiers [20,21,23,24].

The goal of this study was to introduce a multi-classifier with increased accuracy of multi-class tissue classification based on the intrinsic impedance values of each in vivo tissue, with the ultimate aim of automatic optimal output power adjustment of USUs used in surgery. For this purpose, the classification performance of previously introduced single classifiers was analyzed using the electrical properties of tissues measured with the newly developed impedance measurement device. A multi-classifier that effectively classifies the multi-class tissue was introduced by combining the best single classifiers, and its performance was compared and analyzed with that of the former single classifiers. The results of this study are expected to be an important contribution toward performing tissue cutting and coagulation with minimum in vivo tissue damage during surgery using USUs.

@&#METHODS@&#

This study aimed to increase the classification rate of multiple tissues using the unique impedance characteristics of different in vivo tissues. By applying a waveform of a particular frequency through the electrodes, the newly developed device obtained a feedback signal passing through the tissue using another electrode, as shown in 
                        Fig. 2(A). The impedance values of each tissue were calculated by the device and stored in the storage memory as a database. The paired subdermal electrodes (Medtronic Inc., Minneapolis, MN, USA) were distinguished as invasive (6mm and 3mm) or non-invasive (surface) types, which can be attached to the end of the ultrasonic surgical knife to analyze the classification rate of multiple tissues according to the invasion depth. The distance between the electrodes was 2.5mm (Fig. 2(B)). To summarize, Type-I (6mm invasive), Type-II (3mm invasive), and Type-III (surface) paired subdermal electrodes were used to measure the impedance of the tissues, and the tissue classification rate for each electrode type was analyzed.

The main hardware structure for tissue classification consisted of a MSP430 microcontroller unit (MCU) (Texas Instruments Inc., Dallas, TX, USA) and an AD5933 analog circuit (Analog Devices Inc., Norwood MA, USA). The AD5933 module has a maximum frequency range of 100kHz, and has both a fast response and high accuracy [25]. The MSP430 MCU was implemented for AD5933 module operation, data acquisition, and PC communication, and included a noise prevention shielded cable, communication cable, and power supply (Fig. 2(C)). Real-time hardware control and data storage were performed by PC software LabVIEW2012 (National Instruments Inc., Austin, TX, USA).

The target tissues used in this experiment including fat and muscle which account for a large percentage of the human body, the liver which is the major intrathoracic organ in which laparoscopic surgery is performed, and the lung which is the major organ in the abdominal cavity and the site of thoracoscopic surgery [26,27]. Additionally, muscle and fat tissue were extracted from both the abdomen and neck regions because there is a possibility of heterogeneity according to the site in spite of the same tissue [28,29]. Therefore, a total of 6 tissues (muscle in neck and abdomen, fat in neck and abdomen, liver, and lung) were used in this study. The tissues were freshly acquired from 10 pigs within 2h of slaughter [30]. Fifteen different samples of each tissue of at least 3cm2 in area were extracted from each pig, and a total of 150 measurement trials (10 pigs×15 samples) for each tissue were performed in this study. To ensure homogeneity among tissue samples and among electrode positions, all experiments were conducted under the supervision of an experienced veterinarian on the same day [16].

It has been reported that the effect of electrode polarization impedance, which is a potential source of error [16], increases at a low frequency (less than 10kHz) when paired subdermal electrodes are used to measure the impedance. To minimize external influences such as radiation and inducement at high frequencies [31,32], a measurement frequency range from 10kHz to 100kHz was set by the AD5933 module and the tissue samples were measured by varying the frequency at 10kHz intervals considering the calculation time for real-time tissue classification. In other words, 10 respective impedance magnitudes (|Z|) and phases (degree) were measured for 150 samples of each tissue, and the same process was repeated for three different electrode types (Type-I, II, and III).

The classification performance of various single classifiers and a multi-classifier which was generated by the combination of single classifiers were compared and analyzed to improve the accuracy of the multi-class tissue classification rate based on the impedance value of six specific classes of tissue. The most common classifiers with a simple expedient and fast computation speed (support vector machine (SVM), k-nearest neighbors (k-NN), decision tree (DT), quadratic discriminant analysis (QDA), random forest (RF)) were used in this study [33–37]. All of the algorithms were implemented using MATLAB R2012a (The MathWorks Inc., Natick, MA, USA).

The input variable selection process was applied to enhance the classification performance of single classifiers (SVM, k-NN, QDA, DT, and RF) and the proposed multi-classifier. As shown in 
                           Fig. 3, a simple genetic algorithm (GA) was used for proper input variable selection to increase the classification performance of each single classifier [38,39]. The initial GA input data was composed of 0 (exclude) and 1 (include) which were generated via a random generator. A total of 20 samples of impedance spectra measured from 10kHz to 100kHz (i.e., 10 respective magnitudes and phases of impedance measured over the range of 10–100kHz) were used. A total of 900 data sets were partitioned into training (50%), validation (25%), and test (25% of examples) sets in three different random ways, and the fitness function of the GA was trained by classification accuracy of each classifier. The number of repetitions was 1000 generations, the cross rate and mutation rate were set to 0.7 and 0.001, respectively, and the roulette wheel selection method was used. However, the problem is that the first generation of the GA are randomly generated due to its characteristic; and two separate binary input combinations may have an equally excellent performance (has the highest fitness) during the GA process [40]. In order to solve this problem, the frequency of each feature through the 10 genetic algorithm cycles was scored, and the features were selected in an order of frequency using a forward selection method to maximize the each classifier’s performance [41,42]. The data set was also divided into training (50%), validation (25%), and test (25% of examples) sets during our last forward selection step. The same GA process was repeated for the electrode types and classifier types.

The characteristics of the single classifiers that were used to automatically determine the 6 classes of tissues are as follows: (1) SVM is a method that projects the data onto a space of higher dimension for a linear classification [43]. To classify the boundaries between the classes of in vivo tissue in a form of hyperplane, the impedance data measured in each tissue were projected through a function conversion. Polynomial kernel function was used for the classification of data with nonlinear distribution in SVM. (2) k-NN is a method that determines which class the input pattern belongs to among the stored patterns [44]. Since the measured tissue needed to be placed in one class, k was set as 1 and classification was performed based on the vector range with the closest distance from the target. (3) DT is one of the methods for data mining analysis that classify the tissues with entropy characteristics periodically [44]. The final 6 terminal nodes indicate the classification result of 6 classes of tissue. (4) QDA is a classification method that finds the feature combination with a quadratic discriminant function, so that the input data can be classified into a plurality of classes [44]. The class of the measured tissue is determined by maximizing the ratio of scatter between the 6 classes and the within-class scatter. (5) RF is an ensemble classifier that consists of a multi-binary tree and can solve the problem of multi-class classification. RF is also a very useful tool for real-time application since the processing speed and learning is faster than that of SVM or neural networks [36,37].


                           
                           Fig. 4 illustrates the overall structure of the multi-classifier for multi-class tissue classification. The expected output (type of tissue) is calculated by applying the input variables from the input variable selection process to each classification model (SVM, k-NN, QDA, DT, and RF), which correspond to the beta classifier. The results of each classification model can either discriminate each tissue accurately or contain an error. Furthermore, the results from each classification model may agree with one another or may be discrepant. For example, when the k-NN and SVM classification results classify a target tissue as fat tissue whereas the QDA, DT, and RF methods classify it as a muscle tissue, the final classification comes into question. Therefore, after choosing classifiers with a high classification rate, the results by the base classifier were trained in the meta classifier stage to determine the final tissue. An artificial neural network (ANN) was used in the meta classifier stage; the ANN model was trained with tissue classification results from each classifier as input and the actual tissue of interest as output. The ANN was designed as a feed-forward network with one input layer, one hidden layer, and one output layer, and the number of neurons in the hidden layer was selected as 8 using a Kolmogorov’s method [45,46]. A gradient steepest descent method-based error back-propagation algorithm was used at training [47], and a bipolar sigmoid function was used as a transfer function. A maximum 1000 rounds of training procedure and 1% error limit were set, and the 1000 rounds of training were performed [48].

To confirm that data acquired with the impedance measurement prototype follow normal distribution, respectively, the data normality of all variables analyzed were verified by means of the Shapiro–Wilk test. 10-fold cross validation (10F-CV) was carried out 10 times to evaluate the classification performance of the single classifiers and multi-classifier. Among the total input and output data sets, 10 respective sets of training and verification data were randomly sampled. The results obtained through this process were compared according to classifier algorithm and electrode type. ANOVA with Tukey’s post hoc analysis was performed to verify differences among impedances (magnitude and phase values) and among the classification rates of single classifiers for each electrode. The Student t-test was used to provide the classification rate of the multi-classifier. The significance level was set to p<0.05 or 0.01 and all analyses were conducted using software PASW Statistics 18 (v. 18, SPSS Inc. Chicago, IL, USA).

@&#RESULTS@&#

The impedance magnitude and phase spectroscopy data measured from three types of electrodes, Type-I (6mm invasive), Type-II (3mm invasive), and Type-III (surface), over a range of 10–100kHz at 10kHz intervals are shown in 
                        Fig. 5. For all electrodes, the significant difference of impedance magnitudes was only observed between the muscle and fat tissues (p<0.05). Also, the impedance magnitude showed no difference depending on the site of extraction for muscle or fat tissue. The impedance phase of lung and liver tissue showed a larger value compared to the impedance phases of other tissues for Type I and III electrodes (p<0.05). However, the impedance phases for muscle and fat tissue were not classified with significance. The impedance phase for each tissue with Type-II electrodes showed that none of these tissues was classified.

The 20 impedance spectra (10 for magnitude and 10 for phase of impedance) shown in Fig. 4 are allowable input variables for each categorizer; but in this paper we selected input variables that maximize the performance of 5 single classifiers (SVM, k-NN, DT, QDA, and RF) and can reduce the calculation time, as shown in 
                        Table 1. Numbers 1 to 10 in the magnitude and phase columns shown in Table 1 refer to the measured frequency from 10 to 100kHz. Through the GA process, the frequency with the highest classification rate was selected as an input variable according to the electrode type. For example, when a Type-I (6mm invasive) electrode is applied to the SVM model, a magnitude corresponding to 20, 30, and 50kHz and phase corresponding to 10, 30, 40, 60, and 80kHz showed the highest classification rate for the 6 classes of tissues.


                        
                        Table 2 shows the data from 10 repeated rounds of 10F-CV (%) of each classifier and electrode type in 6-class tissue classification. After post-hoc analysis, Type-I and Type-II electrodes were shown to have a higher classification rate for SVM, QDA, and RF with a significance value of 0.05, and Type-III was shown to have a classification rate in the order of k-NN, DT<RF, QDA<QDA, SVM (p<0.05). Therefore, SVM, QDA, and RF as single classifiers have the highest classification rate for all electrode types.


                        
                        Fig. 6 shows the average (with standard deviation) classification rates for each classifier and the proposed model according to the three electrode types. In the case of the 6mm invasive electrode (Type-I), the model suggested in this research had higher classification results compared to the single classifiers SVM, QDA (p<0.05) and RF (p<0.01). In the case of the Type-II electrode, the proposed model showed higher classification results with significance level of 0.01 compared to the results for all three selected single classifiers. For the Type-III electrode, the classification rate of the proposed model was higher than that of the SVM model (p<0.01), and the QDA and RF models (p<0.05).


                        
                        Table 3 compares the results predicted using the proposed multi-classifier for three electrode types and six target tissues. The proposed model was evaluated using a sensitivity and positive predictive value (PPV); sensitivity was defined as the true positives/(true positives+false negatives), and PPV was defined as the true positives/total number of test positives. The sensitivity and PPV calculated in each electrode type were as follows: the range of 82.00–98.67% and 83.85–98.01% in Type-I, 97.33–100.00% and 96.71–100.00% in Type-II, 78.00–97.33% and 80.37–97.28% in Type-III. According to the result, Type-II electrode showed the best classification performance, whereas, Type-I and Type-III electrodes showed the lower classification performance due to the relative misclassification in two tissues (muscle and fat) where the both, respectively, had two homogeneous tissues extracted from different regions (abdomen and neck).

@&#DISCUSSION AND CONCLUSIONS@&#

A novel multi-classifier composed with a combination of single classifiers was proposed in this study for an automatic classification of the 6 classes of in vivo tissues (muscle in neck and abdomen, fat in neck and abdomen, liver, and lung). The multi-classifier was designed using three single classifiers (SVM, QDA, and RF) that showed a high classification rate, whereas k-NN and DT, which showed a relatively poor classification rate, were excluded. The k-NN and DT had a limitation of classification rate reduction, as compared with other classifiers, in classifying the data with noise or mismatched distribution from the training dataset [49,50]. In this study, the target classification objects included not only muscle and fat tissues extracted from abdomen and neck regions but also liver and lung tissues. For this reason, the impedance characteristics of all tissues were constructed with very complex interactions; and therefore, the k-NN and DT probably showed a relatively poor classification rate. The relatively higher classification rate in SVM, QDA, and RF is believed to be achieved by their characteristic of proposing an optimal margin [51] and decreasing a bias that can be caused during a classification process, where it distributes the non-linear distribution into multi-dimensional class [52,53].

The difference in accuracy by each single classifier was based on the impedance characteristics of each tissue, such as magnitude and phase. All types of electrode (Type-I, II, and III) used in this research showed the largest magnitudes for the fat tissues (p<0.05). This result consistent with the results of previous study [16] and it is because the fat tissue has higher resistance than other in vivo tissues [54]. The impedance characteristics of the other tissues (i.e., muscle, liver, and lung tissues) appeared to have non-linear impedance distribution values, and it was not possible to classify significant differences using the statistical or linear methods. Therefore, we have proposed the multi-classifier in this study which showed higher classification accuracy than any existing single classifier such as SVM, QDA, and RF for all electrode types (p<0.05 or 0.01). Also, in classifying the multi-class tissue, low SD values (0.70–2.60) of classification accuracy ensure high reproducibility of the model [55–57]. Therefore, this will allow the proposed model to be more robust compared to the use of single classifiers.

The classification accuracy of the proposed model by electrode type showed a better result for the invasive type electrodes (Types I and II) than non-invasive type electrode (Type-III) (I vs. III: p<0.05; II vs. III: p<0.01). The higher classification rate with invasive type electrodes can be explained by the low deviation at measured impedance data, as a result of reduced influence of surroundings, resulting in a more consistent measurement. However, they also had a disadvantage of directly inserting the electrodes into tissues. Even the surface type electrode had a lower classification rate; it could minimize tissue damages by not invading the tissue. In addition, the result for the classification rate of the Type-II electrode was higher (p<0.01) with smaller deviations than achieved with the Type-I electrode, even though both were the same invasive type of electrode, should be addressed in detail through future study.

According to the classification results of the proposed model for each tissue (Table 3), both the sensitivity (97.33–100.00%) and the PPV (96.71–100.00%) were the highest when using a Type-II electrode. This result implies that it is possible to achieve the best 6-tissue classification when using the proposed multi-classifier and a 3-mm invasive-type electrode. The classification rates with Type-I (91.55±2.60%) and Type-III (89.67±1.89%) electrodes were relatively lower compared with Type-II (98.67±0.70%), and the sensitivity and PPV in muscle and fat tissue tended to be low. This result indicates that the classification error mainly occurred in tissues extracted from different regions in spite of the same tissue when using the 6-mm invasive and surface-type electrodes. The high and low of classification rate by each electrode type could be clearly evaluated through cross checks of sensitivity and PPV results.

In this study, the proposed multi-classifier has overcome the limitation preventing classification of various types of tissues that have impedance spectroscopy of non-linear distribution. By directly applying the multi-classifier during thoracoscopic or laparoscopic surgery, the proposed multi-classifier will provide quantitative data for automatic control of the optimal output power adjustment of USUs and can be expected to reduce the problem of a delay in operation time in the surgical environment. Additionally, the multi-classifier can be applied to detection of lesion tissues such as tumors and ischemia in diverse research fields.

There were, however, several limitations to this study that affected our ability to draw conclusions, as follows. (1) The number of data samples used in this study was 900 measurements in total. The sample size is considered to be sufficient compared to that of the previous research [58]. However, since the target samples were limited to 6 classes, a classifier that covers the entire range of tissues needs to additional research, and needs to include the various types of tissues as well as a sufficient sample size. (2) The target tissues used in this study were extracted from pigs. In order to applicate our proposed multi-classifier to ultrasonic surgical devices, the heterogeneity between the human and pig tissues should be considered. Therefore, the evaluation on realistic use, compatibility, and stability of this approach should be carried out through in vivo experiments targeted on the certain variables of human tissues (e.g., young vs. old, normal vs. abnormal, male vs. female, etc.) which may have an influence in the real surgical situations. In addition, environmental conditions (e.g., temperature, humidity, heat, carbonization, etc.) that can occur in an actual surgery process need to be considered. When the changes of tissue properties caused by the external environmental changes encountered during the real surgery are compensated; it is believed that the proposed methodology can be applied to humans. For this reason, the proposed multi-classifier requires further studies to classify tissues robustly. (3) Spectroscopy should be performed in subdivided frequencies and over a wider frequency band for improved classification accuracy. The feature selection process which has an intimate effect on the classification result should be also considered. (4) Even though the proposed model shows higher accuracy compared to the single classifiers considered in this study, it makes the pipeline complex, and is difficult to determine when error happens. Therefore, in the future, reducing the complex system and computational resources of the proposed model is required while maintaining its accuracy. (5) The external conditions were different from those in previous studies; therefore, it is hard to say which method is more accurate. However, the prediction accuracy between the previously proposed single classifiers and the multi-classifier was compared using the same dataset that was extracted in the previous study.

None.

@&#ACKNOWLEDGEMENTS@&#

This work was supported by the Technological Innovation R&D Program (project no. S2055622) funded by the Small and Medium Business Administration (SMBA, Korea).

@&#REFERENCES@&#

