@&#MAIN-TITLE@&#Dimension of trivariate C
               1 splines on bipyramid cells

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We introduce bipyramid cells in 
                                 
                                    
                                       R
                                    
                                    
                                       3
                                    
                                 
                              .


                        
                        
                           
                           We improve the lower bound on the dimension of 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                               splines for bipyramids.


                        
                        
                           
                           We derive a new upper bound that is equal to the known lower bound in most cases.


                        
                        
                           
                           We use tools from algebraic geometry and Bernstein–Bézier analysis.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Bipyramid

Dimension

Trivariate spline

Cell

Supersmoothness

@&#ABSTRACT@&#


               
               
                  We study the dimension of trivariate 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      splines on bipyramid cells, that is, cells with 
                        n
                        +
                        2
                      boundary vertices, n of which are coplanar with the interior vertex. We improve the earlier lower bound on the dimension given by J. Shan. Moreover, we derive a new upper bound that is equal to the known lower bound in most cases. In the remaining cases, our upper bound is close to the known lower bound, and we conjecture that the dimension coincides with the upper bound. We use tools from both algebraic geometry and Bernstein–Bézier analysis.
               
            

@&#INTRODUCTION@&#

Smooth piecewise polynomial functions, or splines, are used widely in approximation theory, computer aided geometric design, image analysis, and numerical analysis. Key tools for analyzing multivariate spline spaces come from two fields: classical approximation theory and applied algebraic geometry. The two fields and the two corresponding research communities use entirely different approaches: Bernstein–Bézier analysis (see the survey of Alfeld, 2016, in this issue) and homological techniques (see the survey of Schenck, 2016, in this issue). For a full treatise on Bernstein–Bézier analysis, we refer the reader to Lai and Schumaker (2007). The homological approach to multivariate splines is explained in several papers, see Mourrain and Villamizar (2014), Schenck and Stilman (1997) and Billera (1988).

In this paper we are concerned with trivariate splines. Let 
                        
                           
                              P
                           
                           
                              d
                           
                        
                      denote the set of polynomials in three variables of degree ≤d. A spline is a piecewise-polynomial function defined on a domain 
                        Ω
                        ⊂
                        
                           
                              R
                           
                           
                              3
                           
                        
                      that belongs to a certain smoothness class. More precisely, for a fixed tetrahedral partition Δ of the underlying domain Ω, our spline space of interest is defined as
                        
                           (1)
                           
                              
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Δ
                                 )
                                 =
                                 {
                                 s
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       r
                                    
                                 
                                 (
                                 Ω
                                 )
                                 :
                                 s
                                 
                                    
                                       |
                                    
                                    
                                       T
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       d
                                    
                                 
                                 
                                 for each tetrahedron
                                 
                                 T
                                 ∈
                                 Δ
                                 }
                                 .
                              
                           
                        
                      Finding the exact dimensions of spaces 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                        (
                        Δ
                        )
                      of trivariate splines remains an open problem. While the dimension of any particular spline can be computed using software such as Macaulay2, or the java applet (Alfeld), general formulae are still unknown. This problem is inherited from bivariate splines, where the dimension remains unknown for 
                        d
                        ≤
                        3
                        r
                        +
                        1
                     . As it is shown in section 17.8 in Lai and Schumaker (2007), there is a tight connection between trivariate and bivariate cases, and there is no hope to resolve the trivariate case before the dimension of bivariate splines is known for all values of d and r. We note that despite this difficulty, the dimensions of trivariate splines are known for few very special partitions, including the so-called macro-element or finite-element spaces. For example, trivariate splines on the Alfeld, the Clough–Tocher and Worsey–Piper splits, see Lai and Schumaker (2007) and references therein. Other examples do not qualify as finite-element spaces, but are built on very special grids, see Schumaker and Sorokina (2004) for an example. The first and only formula for a dimension of a trivariate spline space on a tetrahedral partition of a somewhat general nature is for the so-called oranges, see Theorem 17.30 in Lai and Schumaker (2007). An orange, see Fig. 1
                     , is a union of tetrahedra all sharing the same edge, 
                        [
                        u
                        ,
                        v
                        ]
                      in Fig. 1, and pairwise sharing common triangular faces. The goal of this paper is to provide a second example of such a general formula for a partition that we call a bipyramid cell, see Fig. 2
                     . A bipyramid cell is a special case of the so-called interior cell. An interior cell is a collection of tetrahedra all sharing an interior vertex (cf. Section 17.8.1 in Lai and Schumaker, 2007). Note that a bipyramid cell is very different from an orange. An orange is not an interior cell, and all smoothness conditions associated with it are essentially bivariate. The smoothness conditions associated with the bipyramid cell include purely trivariate ones. Because of this difficulty, we have been able to analyze the case for 
                        r
                        =
                        1
                      in (1) only.

A large part of research in the area of trivariate splines has focused on obtaining upper and lower bounds on the dimension of trivariate spline spaces. Several results have been obtained for bounding the dimension of general splines either below or above, see Mourrain and Villamizar (2014), Lau (2005), Alfeld and Schumaker (2008), Alfeld (1996), and Shan (2014). None of the bounds cited above are tight enough to obtain exact dimensions. In this paper, we prove new upper bounds for the bipyramid cells that allow us to obtain exact dimensions in three out of four subcases; in the last subcase our new upper bound is very close to the known lower bound, and we conjecture that the dimension is equal to the upper bound.

Finally, we prove that the lower bound in Shan (2014) has a typo; fixing this leads to an improved lower bound. We compare the improved lower bound to our new upper bound. The lower bound is obtained using homological techniques, while the upper bound is proved using Bernstein–Bézier analysis.

The paper is organized as follows. In Section 2 we introduce bipyramid cells, and study their geometry. In Section 3 we fix the bound in Shan (2014), and derive the lower bound for the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        Δ
                        )
                      on bipyramid cells. In Section 4 we prove a result on supersmoothness needed to obtain our new upper bound. Section 5 contains several results on the dimension of bivariate splines that are also needed to derive the new upper bound. The main results of this paper concerning the new upper bound and the exact dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        Δ
                        )
                      on bipyramid cells are in Section 6. We conclude with remarks and conjectures in Section 7.

To begin, we define a class of partitions in 
                        
                           
                              R
                           
                           
                              3
                           
                        
                      called bipyramid cells, see e.g. Fig. 2. 
                        Definition 2.1
                        A bipyramid cell is a tetrahedral partition Δ such that:
                              
                                 •
                                 there is exactly one interior vertex 
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                    ;


                                    n boundary vertices 
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                     through 
                                       
                                          
                                             v
                                          
                                          
                                             n
                                          
                                       
                                     are coplanar along with 
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                    , and form a polygon surrounding 
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                     in the base plane 
                                    
                                       B
                                       :
                                       =
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             n
                                          
                                       
                                       ]
                                    ;

each vertex 
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    , is connected to 
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                     by the interior edges 
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    ;

two boundary vertices 
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     lie outside the base plane B, are on opposite sides of B, and are connected to 
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                     by the interior edges 
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       ]
                                     and 
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                       ]
                                    ; and

vertices 
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                     and 
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     connect to the boundary vertices 
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                    , 
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    .

It is easy to check that these conditions force Δ to be shellable with no holes or cavities, see Lai and Schumaker (2007) for a discussion of the importance of these facts. For simplicity, and without loss of generality, we can assume that the interior vertex 
                        
                           
                              v
                           
                           
                              0
                           
                        
                      is located at the origin, and the n coplanar boundary vertices lie in the base xy-plane. For the remainder of this paper, we will assume that Δ is a bipyramid cell. Our goal is to find the dimension of the spline space 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        Δ
                        )
                     . The next lemma summarizes several immediately obvious facts about Δ.


                     
                        Lemma 2.2
                        
                           In a bipyramid cell the following holds:
                           
                              
                                 (1)
                                 
                                    there are 2n tetrahedra, 3n interior triangular faces, and 
                                    
                                       n
                                       +
                                       2
                                     
                                    interior edges;
                                 


                                    the number of different slopes m formed by the coplanar interior edges 
                                    
                                       [
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                       ]
                                    
                                    , 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    
                                    , in the base plane satisfies 
                                    
                                       2
                                       ≤
                                       ⌈
                                       
                                          n
                                          2
                                       
                                       ⌉
                                       ≤
                                       m
                                       ≤
                                       n
                                    
                                    ; and
                                 


                                    the number of distinct planes h containing the interior triangular faces is as follows:
                                 


                                    Case 1 (Generic): 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     
                                    are not collinear with 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                    
                                    , and the plane containing 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                    , 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                     
                                    does not contain any other 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                    
                                    . Then 
                                    
                                       h
                                       =
                                       2
                                       m
                                       +
                                       1
                                    
                                    ;
                                 


                                    Case 2 (Coplanar): 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     
                                    are not collinear with 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                    
                                    , and the plane containing 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                    
                                    , 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                     
                                    contains at least one other 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                       
                                    
                                    , 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       n
                                    
                                    . Then 
                                    
                                       h
                                       =
                                       2
                                       m
                                    
                                    ;
                                 


                                    Case 3 (Collinear): 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                     
                                    and 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             n
                                             +
                                             2
                                          
                                       
                                     
                                    are collinear with 
                                    
                                       
                                          
                                             v
                                          
                                          
                                             0
                                          
                                       
                                    
                                    . Then 
                                    
                                       h
                                       =
                                       m
                                       +
                                       1
                                    
                                    .
                                 

For further investigation, we split the coplanar case into two subcases as follows:

• Coplanar Case I: 
                        
                           
                              v
                           
                           
                              n
                              +
                              1
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              n
                              +
                              2
                           
                        
                      are not collinear with 
                        
                           
                              v
                           
                           
                              0
                           
                        
                     , and the plane containing 
                        
                           
                              v
                           
                           
                              n
                              +
                              1
                           
                        
                     , 
                        
                           
                              v
                           
                           
                              n
                              +
                              2
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              0
                           
                        
                      contains exactly one other 
                        
                           
                              v
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        n
                     .

• Coplanar Case II: 
                        
                           
                              v
                           
                           
                              n
                              +
                              1
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              n
                              +
                              2
                           
                        
                      are not collinear with 
                        
                           
                              v
                           
                           
                              0
                           
                        
                     , and the plane containing 
                        
                           
                              v
                           
                           
                              n
                              +
                              1
                           
                        
                     , 
                        
                           
                              v
                           
                           
                              n
                              +
                              2
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              0
                           
                        
                      contains exactly two other 
                        
                           
                              v
                           
                           
                              i
                           
                        
                     , 
                        i
                        =
                        1
                        ,
                        …
                        ,
                        n
                     .


                     Fig. 2 shows an example of the collinear case; Fig. 3
                      shows an example of the coplanar case II, where vertices 
                        
                           
                              v
                           
                           
                              0
                           
                        
                     , 
                        
                           
                              v
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              v
                           
                           
                              4
                           
                        
                     , 
                        
                           
                              v
                           
                           
                              7
                           
                        
                     , 
                        
                           
                              v
                           
                           
                              8
                           
                        
                      lie in the same plane (shaded). Fig. 4
                      shows an example of the generic case, and finally Fig. 5
                      shows an example of the coplanar case I. Next, we need to classify small values of h for the results in the next section. If 
                        h
                        ≥
                        6
                     , the results in the next sections do not require knowledge of the particular geometry of Δ. Since in the collinear case we will compute the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        Δ
                        )
                      without using any lower bounds, the following lemma is stated for the non-collinear cases only.


                     
                        Lemma 2.3
                        
                           In a bipyramid cell with non-collinear 
                           
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           
                           , 
                           
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                           
                           , the following holds:
                        


                           If 
                           
                              h
                              =
                              4
                           
                           , then it is the coplanar case II with 
                           
                              m
                              =
                              2
                           
                           , and 
                           
                              n
                              =
                              4
                           
                           .
                        


                           If 
                           
                              h
                              =
                              5
                           
                           , then it is the generic case with 
                           
                              m
                              =
                              2
                           
                           , and 
                           
                              n
                              =
                              4
                           
                           .
                        


                     
                        Proof
                        If 
                              h
                              =
                              3
                           , then we must be in the collinear case where 
                              h
                              =
                              m
                              +
                              1
                           , 
                              m
                              =
                              2
                           , and 
                              n
                              =
                              4
                           . Then 
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                            are collinear with 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , and there are only two different slopes. Thus, the partition must form an octahedron whose main diagonals intersect at the interior vertex 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           .

If 
                              h
                              =
                              4
                           , then we have two possibilities. One possibility is the coplanar case II with 
                              h
                              =
                              2
                              m
                           , 
                              m
                              =
                              2
                           , and 
                              n
                              =
                              4
                           . The base vertices form a quadrilateral where opposite vertices are collinear with 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           . The vertices 
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            are not collinear, and the plane containing 
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                           , and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            also contains two opposite 
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           . The other possibility is the collinear case with 
                              h
                              =
                              m
                              +
                              1
                           , 
                              m
                              =
                              3
                           , and 
                              3
                              ≤
                              n
                              ≤
                              6
                           . Then 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                            are collinear with 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , and there are three different slopes in the base plane.

If 
                              h
                              =
                              5
                           , then we have two possibilities. One possibility is the collinear case with 
                              h
                              =
                              m
                              +
                              1
                           , with 
                              m
                              =
                              4
                            and 
                              4
                              ≤
                              n
                              ≤
                              8
                           . In this case, 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            are collinear. The other possibility is the generic case with 
                              h
                              =
                              2
                              m
                              +
                              1
                            with 
                              m
                              =
                              2
                           , and 
                              n
                              =
                              4
                           . Then 
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                            are not collinear with 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , and the plane containing 
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                           , and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            does not contain any other vertices. This is another octahedral case.  □

Results in this section follow from both Mourrain and Villamizar (2014) and Shan (2014). We use the terminology from the latter since it is better suited for our partition. Remark 7.1 in Section 7 shows how to use Mourrain and Villamizar (2014) to obtain the lower bound of this section. To simplify the notation in Shan (2014), we introduce the quantity 
                        J
                        (
                        h
                        ,
                        k
                        )
                     , which depends on the number of distinct planes h, containing the interior triangular faces, and a parameter, k, that runs from 0 to the degree of the spline, d. For a ring R of trivariate polynomials, we define 
                        J
                        (
                        h
                        ,
                        k
                        )
                      to be the dimension of the graded module 
                        
                           
                              (
                              R
                              /
                              J
                              )
                           
                           
                              k
                           
                        
                     , where J is the ideal generated by the squares of the linear forms which define the h distinct planes passing through the interior vertex 
                        
                           
                              v
                           
                           
                              0
                           
                        
                     , and k is the degree of the polynomials, see the survey of Schenck (2016) in this issue for additional information on the module.


                     
                        Lemma 3.1
                        
                           In a bipyramid cell with non-collinear 
                           
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           
                           , 
                           
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                            
                           and 
                           
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                           
                           , the following holds:
                           
                              
                                 
                                    
                                       
                                          
                                             J
                                             (
                                             h
                                             ,
                                             0
                                             )
                                             =
                                             1
                                              for any 
                                             h
                                             ;
                                             
                                             J
                                             (
                                             h
                                             ,
                                             1
                                             )
                                             =
                                             3
                                              for any 
                                             h
                                             ;
                                          
                                       
                                       
                                          
                                             J
                                             (
                                             4
                                             ,
                                             2
                                             )
                                             =
                                             2
                                             ;
                                             
                                             J
                                             (
                                             5
                                             ,
                                             2
                                             )
                                             =
                                             1
                                             ;
                                             
                                             J
                                             (
                                             h
                                             ,
                                             k
                                             )
                                             =
                                             0
                                              otherwise
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        We first reproduce the more general result for cells that appears in Shan (2014), changing to our notation:
                              
                                 
                                    
                                       
                                          
                                             J
                                             (
                                             h
                                             ,
                                             0
                                             )
                                             =
                                             1
                                             ,
                                              for any 
                                             h
                                             ,
                                          
                                          
                                             
                                             J
                                             (
                                             h
                                             ,
                                             1
                                             )
                                             =
                                             3
                                             ,
                                              for any 
                                             h
                                             ,
                                          
                                       
                                       
                                          
                                             J
                                             (
                                             3
                                             ,
                                             k
                                             )
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         3
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         =
                                                         3
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         ≥
                                                         4
                                                         ;
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             J
                                             (
                                             4
                                             ,
                                             k
                                             )
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         2
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         ≥
                                                         3
                                                         ;
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             J
                                             (
                                             5
                                             ,
                                             k
                                             )
                                             =
                                             
                                                {
                                                
                                                   
                                                      
                                                         1
                                                          or 
                                                         2
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                      
                                                         if 
                                                         k
                                                         ≥
                                                         3
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             J
                                             (
                                             h
                                             ,
                                             k
                                             )
                                             =
                                             0
                                             ,
                                              for any 
                                             k
                                             ≥
                                             2
                                             ,
                                             
                                             h
                                             ≥
                                             6
                                             .
                                          
                                       
                                    
                                 
                              
                            Note that, in the more general case covered in Shan (2014), 
                              J
                              (
                              5
                              ,
                              2
                              )
                            is multi-valued. For bipyramid cells, it follows from Lemma 2.3 that the only case with 
                              h
                              =
                              5
                            is the generic case. In this case, after a change of variables, we have 
                              J
                              =
                              〈
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    z
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    (
                                    z
                                    −
                                    α
                                    x
                                    )
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    (
                                    z
                                    −
                                    β
                                    y
                                    )
                                 
                                 
                                    2
                                 
                              
                              〉
                           , for some non-zero 
                              α
                              ,
                              β
                              ∈
                              R
                           . Clearly, 
                              
                                 dim
                              
                              
                                 
                                    (
                                    R
                                    /
                                    J
                                    )
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                              =
                              J
                              (
                              5
                              ,
                              2
                              )
                           . We next note that, for all bipyramid cases except the collinear one, the minimal number of generators of J is equal to either the number of distinct planes containing the interior triangular faces (i.e. h), or 6 if 
                              h
                              >
                              6
                           . Since we do not discuss the collinear case in this lemma, this completes the proof.  □


                     
                        Remark 3.2
                        It is easy to see that in the collinear case, the line formed by 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , and 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                            might be shared by an arbitrarily large number of planes. However, in this case J cannot be six-generated, as it is claimed in Shan (2014). In Section 6, we obtain the exact dimension of trivariate splines on bipyramids in the collinear case without referring to any lower bounds. Therefore, we omit the discussion of a lower bound for this case.

We next discuss the lower bound for splines on any cell proved in Shan (2014). Let 
                        
                           
                              f
                           
                           
                              i
                           
                        
                      denote the number of i-dimensional interior faces of the partition: 
                        
                           
                              f
                           
                           
                              3
                           
                        
                      is the number of tetrahedra, 
                        
                           
                              f
                           
                           
                              2
                           
                        
                      is the number of interior triangular faces, and 
                        
                           
                              f
                           
                           
                              1
                           
                        
                      is the number of interior edges. Additionally, let 
                        
                           
                              h
                           
                           
                              e
                           
                        
                      be the number of planes containing all triangular faces attached to the edge e, let 
                        
                           
                              f
                           
                           
                              1
                              ,
                              2
                           
                        
                      be the number of interior edges with 
                        
                           
                              h
                           
                           
                              e
                           
                        
                        =
                        2
                     , let 
                        
                           
                              f
                           
                           
                              1
                              ,
                              3
                           
                        
                      be the number of interior edges with 
                        
                           
                              h
                           
                           
                              e
                           
                        
                        =
                        3
                     , and let 
                        
                           
                              f
                           
                           
                              1
                              ,
                              4
                           
                        
                      be the number of interior edges with 
                        
                           
                              h
                           
                           
                              e
                           
                        
                        ≥
                        4
                     . The following bound is proved in (Shan, 2014): 
                        Theorem 3.3
                        
                           If Δ is a cell, 
                           
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                            
                           is bounded below as
                           
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             Δ
                                             )
                                          
                                          
                                             ≥
                                          
                                          
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   3
                                                
                                             
                                             −
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            +
                                                            3
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         3
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             2
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             −
                                             3
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                
                                             
                                             −
                                             3
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   4
                                                
                                             
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         3
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             +
                                             2
                                             (
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   3
                                                
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   4
                                                
                                             
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         3
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   f
                                                
                                                
                                                   1
                                                   ,
                                                   2
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         3
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             
                                                ∑
                                                
                                                   k
                                                   =
                                                   0
                                                
                                                d
                                             
                                             J
                                             (
                                             h
                                             ,
                                             k
                                             )
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

Next we apply Theorem 3.3 to the case of bipyramid cells. From Lemma 2.2, we know that
                        
                           
                              
                                 
                                    
                                       f
                                    
                                    
                                       3
                                    
                                 
                                 =
                                 2
                                 n
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 3
                                 n
                                 ,
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 n
                                 +
                                 2
                                 ,
                                 
                                 and
                                 
                                 
                                    
                                       f
                                    
                                    
                                       1
                                       ,
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       1
                                       ,
                                       4
                                    
                                 
                                 =
                                 n
                                 +
                                 2
                                 −
                                 
                                    
                                       f
                                    
                                    
                                       1
                                       ,
                                       2
                                    
                                 
                                 .
                              
                           
                        
                      We can thus rewrite the bound in Theorem 3.3 as follows
                        
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                    
                                    
                                       ≥
                                    
                                    
                                       2
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      d
                                                      +
                                                      3
                                                   
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       (
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       −
                                       6
                                       )
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       (
                                       2
                                       n
                                       +
                                       4
                                       −
                                       2
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       )
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          d
                                       
                                       J
                                       (
                                       h
                                       ,
                                       k
                                       )
                                       .
                                    
                                 
                              
                           
                        
                      Applying a variety of combinatorial identities, Lemma 2.3 and Lemma 3.1, we obtain 
                        Corollary 3.4
                        
                           Let Δ be a bipyramid cell. Then for 
                           
                              d
                              ≥
                              2
                            
                           the following holds:
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≥
                                       6
                                       d
                                       −
                                       2
                                       +
                                       
                                          
                                             f
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                       
                                       (
                                       d
                                       −
                                       1
                                       )
                                       +
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          ∑
                                          
                                             k
                                             =
                                             2
                                          
                                          d
                                       
                                       J
                                       (
                                       h
                                       ,
                                       k
                                       )
                                       .
                                    
                                 
                              
                            
                           In the coplanar case I we have 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              1
                           
                           , 
                           
                              h
                              ≥
                              6
                           
                           . Thus
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≥
                                       7
                                       d
                                       −
                                       3
                                       +
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                            
                           In the coplanar case II, if 
                           
                              m
                              ≥
                              3
                           
                           , then 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              2
                           
                           , and 
                           
                              h
                              ≥
                              6
                           
                           . If 
                           
                              m
                              =
                              2
                           
                           , then 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              4
                            
                           and 
                           
                              h
                              =
                              4
                           
                           . Thus
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≥
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          {
                                          
                                             
                                                
                                                   10
                                                   d
                                                   −
                                                   8
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   8
                                                   d
                                                   −
                                                   4
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            
                           Moreover, in the generic case if 
                           
                              m
                              ≥
                              3
                           
                           , we have 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              0
                           
                           . If 
                           
                              m
                              =
                              2
                           
                           , then 
                           
                              
                                 
                                    f
                                 
                                 
                                    1
                                    ,
                                    2
                                 
                              
                              =
                              2
                           
                           . Thus
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≥
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          {
                                          
                                             
                                                
                                                   8
                                                   d
                                                   −
                                                   5
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   6
                                                   d
                                                   −
                                                   2
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     Corollary 3.4 can be obtained from Mourrain and Villamizar (2014) as well, see Remark 7.1.

The result in this section is essential for obtaining our upper bound in Sections 5 and 6. We use the notation of Definition 2.1, and square brackets for the convex hull. As in Lai and Schumaker (2007), a bivariate (interior) cell is a collection of triangles all sharing an interior vertex. 
                        Theorem 4.1
                        
                           Any spline s in the space 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                            
                           of trivariate 
                           
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            
                           splines on a bipyramid with the base 
                           
                              B
                              :
                              =
                              [
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ]
                            
                           and interior vertex 
                           
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ∈
                              B
                            
                           has the following supersmoothness: if a vertex 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           
                           , 
                           
                              1
                              ≤
                              i
                              ≤
                              n
                           
                           , is not coplanar with 
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                              ]
                           
                           , then all derivatives of s of order two across 
                           
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                              ]
                            
                           in any direction coplanar with B are continuous.
                        


                     
                        Proof
                        We first note that if 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            is collinear with 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                           , then there is a plane containing 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           , for any of the remaining 
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                           . Thus, we let 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            be not collinear with 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                           . Without loss of generality, let 
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                            be not coplanar with 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                              ]
                           , see Fig. 4. Fix an arbitrary point 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                            in the interior of the edge 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                              ]
                           , and consider any cross-section of the double pyramid by a plane passing through 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                           , parallel to 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                              ]
                           , and not containing 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                              ]
                           . In Fig. 4, it is the quadrilateral 
                              [
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    7
                                 
                              
                              ]
                           . Such a cross-section contains a bivariate cell Q with the interior vertex 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                            and four interior edges. Two of them lie in B and are collinear, and the other two are not collinear. In Fig. 4, the collinear ones are 
                              [
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ]
                            and 
                              [
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    4
                                 
                              
                              ]
                           , while 
                              [
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    6
                                 
                              
                              ]
                            is parallel to 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                              ]
                            by construction, and thus 
                              [
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    7
                                 
                              
                              ]
                            is not collinear with 
                              [
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    6
                                 
                              
                              ]
                           .

It clearly suffices to prove that the bivariate spline 
                              
                                 
                                    s
                                 
                                 
                                    ˜
                                 
                              
                              =
                              s
                              
                                 
                                    |
                                 
                                 
                                    Q
                                 
                              
                            has supersmoothness two at 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                            in the direction of the two collinear edges. In Fig. 4, we need to prove that 
                              
                                 
                                    s
                                 
                                 
                                    ˜
                                 
                              
                            has a second order continuous derivative at 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                            in the direction 
                              [
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              ]
                           . The required supersmoothness immediately follows from Theorem 3.2 in Sorokina (2010). Since 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                            is an arbitrary point on the edge 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                              ]
                            such bivariate supersmoothness holds across the whole edge 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    5
                                 
                              
                              ]
                           .

To complete the proof, we note that if 
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                              
                            is coplanar with 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                              ]
                           , as in Fig. 5 
                           
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            is coplanar with 
                              [
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    6
                                 
                              
                              ,
                              
                                 
                                    v
                                 
                                 
                                    7
                                 
                              
                              ]
                           , then Q is formed by two pairs of collinear edges. In Fig. 5, 
                              
                                 
                                    u
                                 
                                 
                                    6
                                 
                              
                           , 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                           , 
                              
                                 
                                    u
                                 
                                 
                                    7
                                 
                              
                            are collinear, and so are 
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                           , 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    u
                                 
                                 
                                    5
                                 
                              
                           . The bivariate spline 
                              
                                 
                                    s
                                 
                                 
                                    ˜
                                 
                              
                              =
                              s
                              
                                 
                                    |
                                 
                                 
                                    Q
                                 
                              
                            does not have continuous second order derivatives in either direction at 
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                           , see e.g. section 4 of Sorokina (2010). Thus, the non-coplanarity condition on the statement of the theorem is essential.  □

To prove our upper bound in the next section, we need to compute the dimension of bivariate 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      splines 
                        
                           
                              S
                           
                           
                              k
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                        )
                      over the triangulation 
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                      of the base B of the bipyramid, 
                        0
                        ≤
                        k
                        ≤
                        d
                     . We note that 
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                      is an interior bivariate cell, i.e., a collection of triangles sharing the interior vertex 
                        
                           
                              v
                           
                           
                              0
                           
                        
                     .


                     
                        Lemma 5.1
                        
                           Let 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                            
                           be a bivariate cell with n edges and m slopes. Then
                           
                              
                                 (2)
                                 
                                    
                                       
                                          dim
                                          ⁡
                                          
                                             
                                                S
                                             
                                             
                                                0
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                Δ
                                             
                                             
                                                B
                                             
                                          
                                          )
                                          =
                                          1
                                          ,
                                          
                                          dim
                                          ⁡
                                          
                                             
                                                S
                                             
                                             
                                                1
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                Δ
                                             
                                             
                                                B
                                             
                                          
                                          )
                                          =
                                          3
                                          ,
                                           and for 
                                          k
                                          ≥
                                          2
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          dim
                                          ⁡
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          
                                             
                                                Δ
                                             
                                             
                                                B
                                             
                                          
                                          )
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      4
                                                      +
                                                      4
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      m
                                                      =
                                                      2
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      3
                                                      +
                                                      n
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                            
                                                            
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                         )
                                                      
                                                      ,
                                                   
                                                   
                                                      
                                                         if 
                                                      m
                                                      ≥
                                                      3
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        Clearly, splines in 
                              
                                 
                                    S
                                 
                                 
                                    0
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                            and 
                              
                                 
                                    S
                                 
                                 
                                    1
                                 
                                 
                                    1
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                            are bivariate polynomials whose dimensions are 1 and 3, respectively. Using Theorem 9.3 from Lai and Schumaker (2007) (originally proved in Schumaker, 1979), for 
                              k
                              ≥
                              2
                           , we obtain
                              
                                 (3)
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       3
                                       +
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   k
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             −
                                             j
                                             (
                                             m
                                             −
                                             1
                                             )
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       .
                                    
                                 
                              
                            We next simplify (3) for various values of m. If 
                              m
                              =
                              2
                           , then 
                              n
                              =
                              4
                            and
                              
                                 
                                    
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             −
                                             j
                                             (
                                             m
                                             −
                                             1
                                             )
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             k
                                             −
                                             1
                                          
                                       
                                       
                                          
                                             (
                                             2
                                             −
                                             j
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       =
                                       1
                                       .
                                    
                                 
                              
                            If 
                              m
                              ≥
                              3
                           , then 
                              2
                              −
                              j
                              (
                              m
                              −
                              1
                              )
                              ≤
                              0
                              ⇔
                              2
                              ≤
                              j
                              (
                              m
                              −
                              1
                              )
                           . Since j starts at 1 and 
                              m
                              ≥
                              3
                           , the minimum value of 
                              j
                              (
                              m
                              −
                              1
                              )
                            is 2, so the inequality is always true. Therefore 
                              
                                 
                                    (
                                    2
                                    −
                                    j
                                    (
                                    m
                                    −
                                    1
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              0
                           , so the sum evaluates to 0, and the result follows.  □

For 
                        k
                        =
                        d
                     , due to additional supersmoothness described in Theorem 4.1, we can no longer use Theorem 9.3 in Lai and Schumaker (2007). Let 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                              ,
                              ⁎
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                        )
                      be the restriction of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        Δ
                        )
                      on B, i.e., the subspace of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                        )
                      with the supersmoothness described in Theorem 4.1. It then follows from Theorem 9.25 in Lai and Schumaker (2007) that
                        
                           (4)
                           
                              
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       1
                                       ,
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       B
                                    
                                 
                                 )
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       1
                                    
                                    n
                                 
                                 
                                    ∑
                                    
                                       j
                                       =
                                       2
                                    
                                    d
                                 
                                 (
                                 j
                                 −
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 3
                                 +
                                 
                                    ∑
                                    
                                       j
                                       =
                                       2
                                    
                                    d
                                 
                                 
                                    
                                       (
                                       j
                                       +
                                       1
                                       −
                                       
                                          
                                             ϵ
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                    
                                       +
                                    
                                 
                                 ,
                              
                           
                        
                      where 
                        
                           
                              r
                           
                           
                              i
                           
                        
                      is the smoothness across the edge 
                        [
                        
                           
                              v
                           
                           
                              0
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              i
                           
                        
                        ]
                     , 
                        
                           
                              ϵ
                           
                           
                              j
                           
                        
                        :
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              n
                           
                        
                        
                           
                              m
                           
                           
                              i
                              ,
                              j
                           
                        
                     , and
                        
                           
                              
                                 
                                    
                                       m
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 :
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             if there exists 
                                             l
                                              with 
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   α
                                                
                                                
                                                   l
                                                
                                             
                                              and 
                                             
                                                
                                                   r
                                                
                                                
                                                   l
                                                
                                             
                                             <
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             0
                                             ,
                                          
                                          
                                             if there exists 
                                             l
                                             >
                                             i
                                              with 
                                             
                                                
                                                   α
                                                
                                                
                                                   i
                                                
                                             
                                             =
                                             
                                                
                                                   α
                                                
                                                
                                                   l
                                                
                                             
                                              and 
                                             
                                                
                                                   r
                                                
                                                
                                                   l
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          
                                             j
                                             −
                                             
                                                
                                                   r
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                      We next simplify (4) further by considering each case of Section 2. 
                        Lemma 5.2
                        
                           Let 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                            
                           be a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and let 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                            
                           be the restriction of 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                            
                           on B. In the generic case, 
                           
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                              =
                              6
                           
                           , 
                           
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    3
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                              =
                              12
                           
                           , if 
                           
                              m
                              =
                              2
                            
                           and for all remaining cases
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                             ,
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   9
                                                   +
                                                   4
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ∧
                                                   d
                                                   ≥
                                                   4
                                                   ,
                                                
                                             
                                             
                                                
                                                   7
                                                   +
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   3
                                                   ∧
                                                   d
                                                   ≥
                                                   3
                                                   ,
                                                
                                             
                                             
                                                
                                                   6
                                                   +
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   4
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        In this case, Theorem 4.1 yields 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                           , for all 
                              i
                              =
                              1
                              ,
                              …
                              ,
                              n
                           , and 
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                 
                              
                              =
                              m
                              (
                              j
                              −
                              2
                              )
                            for all 
                              j
                              ≥
                              2
                           . Substituting the values for 
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                 
                              
                            and 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            in (4), we obtain
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                   ,
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   1
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   3
                                                
                                                d
                                             
                                             (
                                             j
                                             −
                                             2
                                             )
                                             +
                                             3
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   2
                                                
                                                d
                                             
                                             
                                                
                                                   (
                                                   j
                                                   +
                                                   1
                                                   −
                                                   m
                                                   (
                                                   j
                                                   −
                                                   2
                                                   )
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             n
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             6
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   3
                                                
                                                d
                                             
                                             
                                                
                                                   (
                                                   2
                                                   m
                                                   +
                                                   1
                                                   −
                                                   j
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                            Since 
                              m
                              ≥
                              2
                           , we have
                              
                                 
                                    
                                       2
                                       m
                                       +
                                       1
                                       −
                                       j
                                       (
                                       m
                                       −
                                       1
                                       )
                                       ≤
                                       0
                                       ⇔
                                       2
                                       m
                                       +
                                       1
                                       ≤
                                       j
                                       (
                                       m
                                       −
                                       1
                                       )
                                       ⇔
                                       j
                                       ≥
                                       2
                                       +
                                       
                                          3
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                            Since j starts at 3, once 
                              m
                              ≥
                              4
                           , the inequality is always true. Therefore, 
                              
                                 
                                    (
                                    2
                                    m
                                    +
                                    1
                                    −
                                    j
                                    (
                                    m
                                    −
                                    1
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              0
                            if 
                              m
                              ≥
                              4
                           , and the cases 
                              m
                              =
                              2
                            and 
                              m
                              =
                              3
                            must be computed separately. If 
                              m
                              =
                              3
                           , then 
                              j
                              =
                              3
                            is the only positive term and 
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    3
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    (
                                    2
                                    m
                                    +
                                    1
                                    −
                                    j
                                    (
                                    m
                                    −
                                    1
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              1
                           . If 
                              m
                              =
                              2
                           , we have two non-negative terms 
                              j
                              =
                              3
                           , and 
                              j
                              =
                              4
                           , and 
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    3
                                 
                                 
                                    d
                                 
                              
                              
                                 
                                    (
                                    2
                                    m
                                    +
                                    1
                                    −
                                    j
                                    (
                                    m
                                    −
                                    1
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              3
                           .

For 
                              d
                              =
                              2
                           , the dimension formula yields 
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    2
                                 
                                 
                                    2
                                 
                              
                              (
                              j
                              −
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              3
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    2
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    (
                                    j
                                    +
                                    1
                                    −
                                    m
                                    (
                                    j
                                    −
                                    2
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                           . Since 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                            for all i, and 
                              j
                              =
                              2
                           , the first sum is a summation of zeros, and the second summation has only one term, namely 
                              
                                 
                                    (
                                    2
                                    +
                                    1
                                    −
                                    m
                                    (
                                    2
                                    −
                                    2
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              3
                           . Therefore, the dimension is 6.

For 
                              d
                              =
                              3
                           , the dimension formula gives 
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    2
                                 
                                 
                                    3
                                 
                              
                              (
                              j
                              −
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              3
                              +
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    2
                                 
                                 
                                    3
                                 
                              
                              
                                 
                                    (
                                    j
                                    +
                                    1
                                    −
                                    m
                                    (
                                    j
                                    −
                                    2
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                           . Again, since 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                              =
                              2
                            for all i, the double summation becomes 
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              (
                              3
                              −
                              2
                              )
                              =
                              n
                           . The second sum is equal to 
                              3
                              +
                              
                                 
                                    (
                                    4
                                    −
                                    m
                                    )
                                 
                                 
                                    +
                                 
                              
                           , so the value depends on m. Considering the cases 
                              m
                              =
                              2
                           , 
                              m
                              =
                              3
                           , and 
                              m
                              ≥
                              4
                            completes the proof.  □


                     
                        Lemma 5.3
                        
                           Let 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                            
                           be a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and let 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                            
                           be the restriction of 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                            
                           on B. In the first coplanar case I, we have
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                             ,
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       (
                                       n
                                       −
                                       1
                                       )
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       5
                                       .
                                    
                                 
                              
                           
                        

In this case, the plane containing 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                           , and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            contains exactly one boundary vertex of B. Without loss of generality, assume that it is 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                           . Then Theorem 4.1 yields
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       :
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if 
                                                   i
                                                   =
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   ,
                                                
                                                
                                                   if 
                                                   2
                                                   ≤
                                                   i
                                                   ≤
                                                   n
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            Moreover, 
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                 
                              
                              =
                              (
                              j
                              −
                              1
                              )
                              +
                              (
                              m
                              −
                              1
                              )
                              (
                              j
                              −
                              2
                              )
                           , for all 
                              j
                              ≥
                              2
                           . We substitute the values for 
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                 
                              
                            and 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            in (4)
                           
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                   ,
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   2
                                                
                                                d
                                             
                                             (
                                             j
                                             −
                                             1
                                             )
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   2
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   3
                                                
                                                d
                                             
                                             (
                                             j
                                             −
                                             2
                                             )
                                             +
                                             3
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   2
                                                
                                                d
                                             
                                             
                                                
                                                   (
                                                   2
                                                   −
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                   (
                                                   j
                                                   −
                                                   2
                                                   )
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             (
                                             n
                                             −
                                             1
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             5
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   3
                                                
                                                d
                                             
                                             
                                                
                                                   (
                                                   2
                                                   m
                                                   −
                                                   j
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                            Since 
                              m
                              ≥
                              3
                           , we have
                              
                                 
                                    
                                       2
                                       m
                                       −
                                       j
                                       (
                                       m
                                       −
                                       1
                                       )
                                       ≤
                                       0
                                       ⇔
                                       2
                                       m
                                       ≤
                                       j
                                       (
                                       m
                                       −
                                       1
                                       )
                                       ⇔
                                       j
                                       ≥
                                       2
                                       +
                                       
                                          2
                                          
                                             m
                                             −
                                             1
                                          
                                       
                                       .
                                    
                                 
                              
                            Since j starts at 3 and 
                              m
                              ≥
                              3
                           , the inequality is always true. Therefore, 
                              
                                 
                                    (
                                    2
                                    m
                                    −
                                    j
                                    (
                                    m
                                    −
                                    1
                                    )
                                    )
                                 
                                 
                                    +
                                 
                              
                              =
                              0
                           , and the result follows.  □


                     
                        Lemma 5.4
                        
                           Let 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                            
                           be a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and let 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                            
                           be the restriction of 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                            
                           on B. In the second coplanar case II, 
                           
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                              =
                              7
                           
                           , and for 
                           
                              d
                              ≥
                              3
                           
                           , we have
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                             ,
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       2
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       (
                                       n
                                       −
                                       2
                                       )
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      d
                                                      −
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          {
                                          
                                             
                                                
                                                   6
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   5
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        In this case, the plane containing 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                           , and 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            contains exactly two boundary vertices of B. Without loss of generality, assume they are 
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                            and 
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                           , and they are collinear with 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                           . Then Theorem 4.1 yields
                              
                                 
                                    
                                       
                                          
                                             r
                                          
                                          
                                             i
                                          
                                       
                                       :
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if 
                                                   i
                                                   =
                                                   1
                                                    or 
                                                   i
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   ,
                                                
                                                
                                                   if 
                                                   3
                                                   ≤
                                                   i
                                                   ≤
                                                   n
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Moreover, 
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                 
                              
                              =
                              (
                              j
                              −
                              1
                              )
                              +
                              (
                              m
                              −
                              1
                              )
                              (
                              j
                              −
                              2
                              )
                           , for all 
                              j
                              ≥
                              2
                           . Note that 
                              
                                 
                                    ϵ
                                 
                                 
                                    j
                                 
                              
                            does not change between coplanar cases I and II, but the difference in 
                              
                                 
                                    r
                                 
                                 
                                    i
                                 
                              
                            must be taken into account for the first part of the formula. Another difference with the previous case is that the value of 
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              =
                              1
                           . Thus
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                   ,
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             2
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   2
                                                
                                                d
                                             
                                             (
                                             j
                                             −
                                             1
                                             )
                                             +
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   3
                                                
                                                n
                                             
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   3
                                                
                                                d
                                             
                                             (
                                             j
                                             −
                                             2
                                             )
                                             +
                                             3
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   2
                                                
                                                d
                                             
                                             
                                                
                                                   (
                                                   2
                                                   −
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                   (
                                                   j
                                                   −
                                                   2
                                                   )
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             2
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             (
                                             n
                                             −
                                             2
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             5
                                             +
                                             
                                                ∑
                                                
                                                   j
                                                   =
                                                   3
                                                
                                                d
                                             
                                             
                                                
                                                   (
                                                   2
                                                   m
                                                   −
                                                   j
                                                   (
                                                   m
                                                   −
                                                   1
                                                   )
                                                   )
                                                
                                                
                                                   +
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                            and the result follows for 
                              d
                              ≥
                              3
                           . When 
                              d
                              =
                              2
                           , the double summation has only two non-zero terms of 1, so 
                              dim
                              ⁡
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                              =
                              2
                              +
                              3
                              +
                              2
                              =
                              7
                           .  □

In the collinear case, there is no supersmoothness associated with the base cell and one can use Lemma 5.1 to compute the dimension. 
                        Lemma 5.5
                        
                           Let 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                            
                           be a bivariate cell with n edges and m slopes in the base B of a bipyramid cell, and let 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                    ,
                                    ⁎
                                 
                              
                              (
                              
                                 
                                    Δ
                                 
                                 
                                    B
                                 
                              
                              )
                            
                           be the restriction of 
                           
                              
                                 
                                    S
                                 
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                            
                           on B. In the collinear case, we have
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                             ,
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          {
                                          
                                             
                                                
                                                   4
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   3
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In this section we obtain a new upper bound using the results from Section 5 with the help of Bernstein–Bézier methods (see the survey of Alfeld, 2016 for the terminology). The advantage of this upper bound over the upper bound of Mourrain and Villamizar (2014) is that our upper bound does not require knowing a priori that the module of 
                        
                           
                              C
                           
                           
                              r
                           
                        
                      splines over bipyramids is free. We start by defining levels in a bipyramid. 
                        Definition 6.1
                        Let 
                              B
                              :
                              =
                              [
                              
                                 
                                    v
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    v
                                 
                                 
                                    n
                                 
                              
                              ]
                            be the base, 
                              
                                 
                                    v
                                 
                                 
                                    0
                                 
                              
                            be the interior vertex, and 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           , 
                              
                                 
                                    v
                                 
                                 
                                    n
                                    +
                                    2
                                 
                              
                            be the two remaining vertices of a bipyramid. The k-th level of Δ (denoted 
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                           ) is the cross-section of Δ by the plane parallel to B and passing through the point
                              
                                 
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         d
                                                         −
                                                         k
                                                         )
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         +
                                                         k
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               n
                                                               +
                                                               1
                                                            
                                                         
                                                      
                                                      d
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   0
                                                   ≤
                                                   k
                                                   ≤
                                                   d
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         (
                                                         d
                                                         +
                                                         k
                                                         )
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         −
                                                         k
                                                         
                                                            
                                                               v
                                                            
                                                            
                                                               n
                                                               +
                                                               2
                                                            
                                                         
                                                      
                                                      d
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   −
                                                   d
                                                   ≤
                                                   k
                                                   <
                                                   0
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Each 
                        
                           
                              Δ
                           
                           
                              k
                           
                        
                      is a bivariate cell of the same geometry as the base cell 
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                        =
                        :
                        
                           
                              Δ
                           
                           
                              0
                           
                        
                     . To explain the method, we first note that all domain points of 
                        s
                        ∈
                        
                           
                              S
                           
                           
                              d
                           
                           
                              r
                           
                        
                        (
                        Δ
                        )
                      can be placed on the 
                        2
                        d
                        +
                        1
                      levels parallel to the base B. Clearly, if we simply ignore all smoothness conditions involving domain points from different levels and consider each level separately, the dimension of 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                           
                        
                        (
                        Δ
                        )
                      can only decrease. Thus, we obtain the following upper bound on the dimension of splines over bipyramids
                        
                           (5)
                           
                              
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Δ
                                 )
                                 ≤
                                 
                                    ∑
                                    
                                       k
                                       =
                                       −
                                       d
                                    
                                    d
                                 
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       d
                                       −
                                       |
                                       k
                                       |
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       k
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                      where 
                        
                           
                              S
                           
                           
                              d
                              −
                              |
                              k
                              |
                           
                           
                              1
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              k
                           
                        
                        )
                      is the space of bivariate splines of degree 
                        d
                        −
                        |
                        k
                        |
                      and smoothness 1 over 
                        
                           
                              Δ
                           
                           
                              k
                           
                        
                     . We then note that the bound (5) can be immediately improved. First, if we set all coefficients corresponding to the domain points in the levels 
                        
                           
                              Δ
                           
                           
                              0
                           
                        
                     , and 
                        
                           
                              Δ
                           
                           
                              1
                           
                        
                     , then all coefficients associated with the level 
                        
                           
                              Δ
                           
                           
                              −
                              1
                           
                        
                      are defined by 
                        
                           
                              C
                           
                           
                              1
                           
                        
                      smoothness conditions across the base B. Since 
                        
                           
                              Δ
                           
                           
                              k
                           
                        
                      and 
                        
                           
                              Δ
                           
                           
                              −
                              k
                           
                        
                      are simply shifts of the same bivariate cell 
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                     , we obtain
                        
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             |
                                             k
                                             |
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       =
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             |
                                             k
                                             |
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             −
                                             k
                                          
                                       
                                       )
                                       =
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             |
                                             k
                                             |
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       ,
                                       
                                       ∀
                                       k
                                       ,
                                        and 
                                    
                                 
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             0
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       1
                                       ,
                                       
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       =
                                       3
                                       .
                                    
                                 
                              
                           
                        
                      Additionally, Theorem 4.1 combined with the results in Section 5 implies that
                        
                           
                              
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       B
                                    
                                 
                                 )
                                 =
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       1
                                       ,
                                       ⁎
                                    
                                 
                                 (
                                 
                                    
                                       Δ
                                    
                                    
                                       B
                                    
                                 
                                 )
                                 ,
                              
                           
                        
                      where 
                        
                           
                              S
                           
                           
                              d
                           
                           
                              1
                              ,
                              ⁎
                           
                        
                        (
                        
                           
                              Δ
                           
                           
                              B
                           
                        
                        )
                      is defined in Section 5. Thus, for 
                        d
                        ≥
                        2
                     , the bound (5) improves to
                        
                           (6)
                           
                              
                                 dim
                                 ⁡
                                 
                                    
                                       S
                                    
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Δ
                                 )
                                 ≤
                                 
                                    {
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   2
                                                
                                                
                                                   1
                                                   ,
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                             +
                                             5
                                             ,
                                          
                                          
                                             if 
                                             d
                                             =
                                             2
                                             ,
                                          
                                       
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                   ,
                                                   ⁎
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                             +
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                   −
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                             +
                                             2
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   2
                                                
                                                
                                                   d
                                                   −
                                                   2
                                                
                                             
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   k
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             
                                                
                                                   Δ
                                                
                                                
                                                   B
                                                
                                             
                                             )
                                             +
                                             8
                                             ,
                                          
                                          
                                             if 
                                             d
                                             ≥
                                             3
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                      To further simplify (6), we note that
                        
                           
                              
                                 
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             2
                                          
                                          
                                             d
                                             −
                                             2
                                          
                                       
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             k
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                    
                                    
                                       =
                                    
                                    
                                       
                                          ∑
                                          
                                             k
                                             =
                                             2
                                          
                                          
                                             d
                                             −
                                             2
                                          
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   4
                                                   +
                                                   4
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   3
                                                   +
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               k
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          {
                                          
                                             
                                                
                                                   4
                                                   (
                                                   d
                                                   −
                                                   3
                                                   )
                                                   +
                                                   4
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   4
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   3
                                                   (
                                                   d
                                                   −
                                                   3
                                                   )
                                                   +
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      Thus, for 
                        d
                        ≥
                        3
                     , the bound (6) simplifies to
                        
                           (7)
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                    
                                    
                                       ≤
                                    
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                             ,
                                             ⁎
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                       +
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             1
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             B
                                          
                                       
                                       )
                                    
                                 
                                 
                                    
                                    
                                    
                                       +
                                       
                                          {
                                          
                                             
                                                
                                                   8
                                                   d
                                                   −
                                                   16
                                                   +
                                                   8
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   8
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   6
                                                   d
                                                   −
                                                   10
                                                   +
                                                   2
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   −
                                                   2
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  d
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                      We are now ready to prove the main results of our paper.


                     
                        Theorem 6.2
                        
                           Let Δ be a bipyramid cell. In the collinear case, for 
                           
                              d
                              ≥
                              2
                           
                           , the following holds
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   8
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   12
                                                   (
                                                   d
                                                   −
                                                   1
                                                   )
                                                   +
                                                   
                                                      
                                                         (
                                                         3
                                                         −
                                                         d
                                                         )
                                                      
                                                      
                                                         +
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   n
                                                   (
                                                   d
                                                   −
                                                   1
                                                   )
                                                   +
                                                   6
                                                   d
                                                   −
                                                   4
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        In this case, the upper bound (6) is equal to the dimension since the only 
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                            smoothness condition involving coefficients associated with different levels has been taken into account. As a result, for 
                              d
                              =
                              2
                           , using Lemma 5.1 in the bound (6), we have
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   13
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   8
                                                   +
                                                   n
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            For 
                              d
                              ≥
                              3
                           , combining Lemma 5.5 and Lemma 5.1 in the bound (7), we obtain
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             Δ
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         8
                                                         +
                                                         4
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         4
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         6
                                                         +
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         ≥
                                                         3
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             +
                                             
                                                {
                                                
                                                   
                                                      
                                                         8
                                                         d
                                                         −
                                                         16
                                                         +
                                                         8
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         8
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         6
                                                         d
                                                         −
                                                         10
                                                         +
                                                         2
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         2
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         ≥
                                                         3
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         8
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         12
                                                         (
                                                         d
                                                         −
                                                         1
                                                         )
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         n
                                                         (
                                                         d
                                                         −
                                                         1
                                                         )
                                                         +
                                                         6
                                                         d
                                                         −
                                                         4
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         ≥
                                                         3
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            Combining the formulae for 
                              d
                              =
                              2
                           , and 
                              d
                              ≥
                              3
                            completes the proof.  □


                     Remark 7.2 shows how to extend this result to higher values of r.


                     
                        Theorem 6.3
                        
                           Let Δ be a bipyramid cell. In the coplanar case I, for 
                           
                              d
                              ≥
                              2
                           
                           , the following holds
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       =
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       7
                                       d
                                       −
                                       3
                                       .
                                    
                                 
                              
                           
                        


                     
                        Proof
                        For 
                              d
                              =
                              2
                           , using the bound (6) and Lemma 5.3 we obtain the following upper bound
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       11
                                       ,
                                    
                                 
                              
                            which is equal to the lower bound of Lemma 3.4. We now consider 
                              d
                              ≥
                              3
                           . Recall that 
                              m
                              ≠
                              2
                            in this case. Using Lemma 5.3 and Lemma 5.1 the bound (7), we obtain the following upper bound
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             Δ
                                             )
                                          
                                          
                                             ≤
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             (
                                             n
                                             −
                                             1
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             n
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             6
                                             d
                                             −
                                             2
                                             +
                                             2
                                             n
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         3
                                                      
                                                   
                                                
                                                )
                                             
                                             −
                                             2
                                             n
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             7
                                             d
                                             −
                                             3
                                             +
                                             2
                                             n
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         3
                                                      
                                                   
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                            Combining the results for 
                              d
                              =
                              2
                           , and 
                              d
                              ≥
                              3
                           , and comparing them with the corresponding lower bound in Lemma 3.4 completes the proof.  □


                     
                        Theorem 6.4
                        
                           Let Δ be a bipyramid cell. In the coplanar case II, for 
                           
                              d
                              ≥
                              2
                           
                           , the following holds
                           
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       =
                                       
                                          {
                                          
                                             
                                                
                                                   8
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   10
                                                   d
                                                   −
                                                   8
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   2
                                                   n
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               d
                                                            
                                                         
                                                         
                                                            
                                                               3
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   +
                                                   8
                                                   d
                                                   −
                                                   4
                                                   ,
                                                
                                                
                                                   
                                                      if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                     
                        Proof
                        For 
                              d
                              =
                              2
                           , using the bound (6) and Lemma 5.4 we obtain the following upper bound
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       12
                                       ,
                                    
                                 
                              
                            which is equal to the lower bound of Lemma 3.4 if 
                              m
                              ≥
                              3
                           . We now consider 
                              d
                              ≥
                              3
                           . Using Lemma 5.3 and Lemma 5.1 the bound (7), we obtain the following upper bound
                              
                                 
                                    
                                       
                                          
                                             dim
                                             ⁡
                                             
                                                
                                                   S
                                                
                                                
                                                   d
                                                
                                                
                                                   1
                                                
                                             
                                             (
                                             Δ
                                             )
                                          
                                          
                                             ≤
                                          
                                          
                                             2
                                             
                                                (
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             (
                                             n
                                             −
                                             2
                                             )
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            d
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                {
                                                
                                                   
                                                      
                                                         10
                                                         +
                                                         4
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         8
                                                         +
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         ≥
                                                         3
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             +
                                             
                                                {
                                                
                                                   
                                                      
                                                         8
                                                         d
                                                         −
                                                         16
                                                         +
                                                         8
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         8
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         6
                                                         d
                                                         −
                                                         10
                                                         +
                                                         2
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         −
                                                         2
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        d
                                                                        −
                                                                        1
                                                                     
                                                                  
                                                               
                                                               
                                                                  
                                                                     2
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         ≥
                                                         3
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                {
                                                
                                                   
                                                      
                                                         8
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         10
                                                         d
                                                         −
                                                         8
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         =
                                                         2
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         2
                                                         n
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     d
                                                                  
                                                               
                                                               
                                                                  
                                                                     3
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         8
                                                         d
                                                         −
                                                         4
                                                         ,
                                                      
                                                      
                                                         if 
                                                         m
                                                         ≥
                                                         3
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            Combining the results for 
                              d
                              =
                              2
                           , and 
                              d
                              ≥
                              3
                           , and comparing them with the corresponding lower bound in Lemma 3.4 completes the proof.  □


                     
                        Theorem 6.5
                        
                           Let Δ be a bipyramid cell. In the generic case, for 
                           
                              d
                              ≥
                              2
                           
                           , and 
                           
                              m
                              ≥
                              3
                           
                           , the following bounds hold
                           
                              
                                 
                                    
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       6
                                       d
                                       −
                                       2
                                       ≤
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       6
                                       d
                                       −
                                       1
                                       +
                                       
                                          
                                             (
                                             4
                                             −
                                             m
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       .
                                    
                                 
                              
                            
                           Moreover, for 
                           
                              m
                              =
                              2
                           
                           , dim 
                           
                              
                                 
                                    S
                                 
                                 
                                    2
                                 
                                 
                                    1
                                 
                              
                              (
                              Δ
                              )
                              =
                              11
                           
                           , and for 
                           
                              d
                              ≥
                              3
                           
                           , the following bounds hold
                           
                              
                                 
                                    
                                       8
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       8
                                       d
                                       −
                                       5
                                       ≤
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       8
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       8
                                       d
                                       −
                                       3
                                       −
                                       
                                          
                                             (
                                             4
                                             −
                                             d
                                             )
                                          
                                          
                                             +
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        


                     
                        Proof
                        In the generic case, there are more subcases to consider following the structure in Lemma 5.2. We start with 
                              d
                              =
                              2
                           . Using the bound (6), and Lemma 5.2 for the upper bound and Lemma 3.4 for the lower bound we obtain the following estimate
                              
                                 
                                    
                                       11
                                       ≥
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             2
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≥
                                       
                                          {
                                          
                                             
                                                
                                                   11
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   =
                                                   2
                                                   ,
                                                
                                             
                                             
                                                
                                                   10
                                                   ,
                                                
                                                
                                                   if 
                                                   m
                                                   ≥
                                                   3
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                              
                            Similarly, in the case 
                              d
                              =
                              3
                           , and 
                              m
                              =
                              2
                           , we have
                              
                                 
                                    
                                       27
                                       ≤
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             3
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       28
                                       .
                                    
                                 
                              
                            We now consider 
                              m
                              =
                              2
                           , and 
                              d
                              ≥
                              4
                           . Combining Lemma 3.4 and (6) we obtain
                              
                                 
                                    
                                       8
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       8
                                       d
                                       −
                                       5
                                       ≤
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       8
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       8
                                       d
                                       −
                                       3
                                       .
                                    
                                 
                              
                            For 
                              m
                              =
                              3
                           , and 
                              d
                              ≥
                              3
                           , we obtain
                              
                                 
                                    
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       6
                                       d
                                       −
                                       2
                                       ≤
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       6
                                       d
                                       .
                                    
                                 
                              
                            We finally consider 
                              m
                              ≥
                              4
                           , and 
                              d
                              ≥
                              3
                           . Using (7), Lemma 5.2 and Lemma 3.4 we obtain the following tight bounds
                              
                                 
                                    
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       6
                                       d
                                       −
                                       2
                                       ≤
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       Δ
                                       )
                                       ≤
                                       2
                                       n
                                       
                                          (
                                          
                                             
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   3
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       6
                                       d
                                       −
                                       1
                                       .
                                    
                                 
                              
                            Combining all these subcases completes the proof.  □

Through the combination of homological and Bernstein–Bézier methods, we have been able to provide exact dimensions of trivariate splines on bipyramid cells in most cases, and tight bounds in one subcase. While limited to the case 
                        r
                        =
                        1
                      and a specific type of partition, our hope is that the methods contained in this paper can be refined and extended to other classes of trivariate splines. We conclude the paper with several remarks.


                     
                        Remark 7.1
                        Theorem 5.1 in Mourrain and Villamizar (2014) applied directly to the bipyramid case yields a weaker lower bound than the one in Shan (2014). However, working through the proof and making necessary adjustments improves the result and matches the bound in Theorem 3.3. Indeed, in the proof of Theorem 5.1 in Mourrain and Villamizar (2014) we find
                              
                                 (8)
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       ≥
                                       dim
                                       ⁡
                                       
                                          
                                             R
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             i
                                             =
                                             1
                                          
                                          2
                                       
                                       
                                          
                                             (
                                             −
                                             1
                                             )
                                          
                                          
                                             i
                                          
                                       
                                       dim
                                       ⁡
                                       
                                          ⨁
                                          
                                             β
                                             ∈
                                             
                                                
                                                   Δ
                                                
                                                
                                                   3
                                                   −
                                                   i
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                       J
                                       
                                          
                                             (
                                             β
                                             )
                                          
                                          
                                             k
                                          
                                       
                                       +
                                       dim
                                       ⁡
                                       
                                          ⨁
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             
                                                f
                                             
                                             
                                                0
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          
                                             J
                                          
                                          
                                             ˜
                                          
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   γ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                    
                                 
                              
                            where the notation matches the one in Section 4 of Schenck (2016). In the case of a cell partition, 
                              
                                 
                                    f
                                 
                                 
                                    0
                                 
                                 
                                    0
                                 
                              
                              =
                              1
                           , and 
                              
                                 
                                    J
                                 
                                 
                                    ˜
                                 
                              
                              (
                              γ
                              )
                              =
                              J
                              (
                              γ
                              )
                           , where γ is the single interior vertex. Moreover, for 
                              r
                              =
                              1
                           , and particularly in the bipyramid case, the values of 
                              J
                              
                                 
                                    (
                                    γ
                                    )
                                 
                                 
                                    k
                                 
                              
                            can be explicitly computed. This is exactly what is done in Shan (2014), and stated in Lemma 3.1. Using Lemma 3.1 in bound (8) in the proof of Theorem 5.1 in Mourrain and Villamizar (2014), yields the lower bound of Corollary 3.4.

In the collinear case, one can easily generalize the result to an arbitrary value of 
                              r
                              ≤
                              d
                           . Indeed, using the addition of the dimension associated with the bivariate layers 
                              
                                 
                                    Δ
                                 
                                 
                                    k
                                 
                              
                           , 
                              k
                              =
                              −
                              d
                              ,
                              …
                              ,
                              0
                              ,
                              …
                              ,
                              d
                            and smoothness r across the base 
                              
                                 
                                    Δ
                                 
                                 
                                    0
                                 
                              
                            we obtain
                              
                                 
                                    
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       Δ
                                       )
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             0
                                          
                                          r
                                       
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             k
                                          
                                          
                                             r
                                          
                                       
                                       (
                                       
                                          
                                             Δ
                                          
                                          
                                             k
                                          
                                       
                                       )
                                       +
                                       2
                                       
                                          ∑
                                          
                                             k
                                             =
                                             r
                                             +
                                             1
                                          
                                          d
                                       
                                       dim
                                       ⁡
                                       
                                          
                                             S
                                          
                                          
                                             d
                                             −
                                             k
                                          
                                          
                                             r
                                          
                                       
                                       ,
                                    
                                 
                              
                            where each dimension can be computed using Theorem 9.3 in Lai and Schumaker (2007). For 
                              r
                              =
                              1
                           , Theorem 6.2 provides a closed-form expression for the sum. For higher values of r, the closed-form expression can be obtained as well; however, it does not look as elegant as the one of Theorem 6.2.

In all examples of the generic case of Theorem 6.5 that we have checked using software, the dimension of the spline space has matched our upper bound. Per Shan (2014), when the dimension does not match the lower bound used in this paper, the implication is that 
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    d
                                 
                              
                              dim
                              ⁡
                              
                                 
                                    H
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    (
                                    R
                                    /
                                    J
                                    )
                                 
                                 
                                    k
                                 
                              
                              ≠
                              0
                           .


                     
                        Remark 7.4
                        In comparison to the upper bound of Mourrain and Villamizar (2014), if the module of splines is not known to be free, our upper bound of Section 6 is a significant improvement, though it is limited to the case of bipyramid cells. The upper bound of Mourrain and Villamizar (2014) is a powerful general tool because it can be applied in many more situations than ours.

@&#REFERENCES@&#

