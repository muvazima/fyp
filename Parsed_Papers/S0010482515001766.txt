@&#MAIN-TITLE@&#Adaptive image inversion of contrast 3D echocardiography for enabling automated analysis

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Contrast 3d echocardiography suffers from high speckle.


                        
                        
                           
                           The automated analysis from contrast 3d echocardiography is a difficult task.


                        
                        
                           
                           Contrast image inversion is proposed to match appearance with non-contrast image.


                        
                        
                           
                           An automatic threshold estimation method is proposed to enable image inversion.


                        
                        
                           
                           The contrast image inversion enables LV segmentation using non-contrast methods.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Contrast 3D echocardiography

3D echocardiography

Image inversion

LV segmentation

Histogram analysis

@&#ABSTRACT@&#


               
               
                  Introduction
                  Contrast 3D echocardiography (C3DE) is commonly used to enhance the visual quality of ultrasound images in comparison with non-contrast 3D echocardiography (3DE). Although the image quality in C3DE is perceived to be improved for visual analysis, however it actually deteriorates for the purpose of automatic or semi-automatic analysis due to higher speckle noise and intensity inhomogeneity. Therefore, the LV endocardial feature extraction and segmentation from the C3DE images remains a challenging problem.
               
               
                  Methods
                  To address this challenge, this work proposes an adaptive pre-processing method to invert the appearance of C3DE image. The image inversion is based on an image intensity threshold value which is automatically estimated through image histogram analysis.
               
               
                  Results
                  In the inverted appearance, the LV cavity appears dark while the myocardium appears bright thus making it similar in appearance to a 3DE image. Moreover, the resulting inverted image has high contrast and low noise appearance, yielding strong LV endocardium boundary and facilitating feature extraction for segmentation.
               
               
                  Conclusions
                  Our results demonstrate that the inverse appearance of contrast image enables the subsequent LV segmentation.
               
            

@&#INTRODUCTION@&#

Cardiovascular disease (CVD) is the leading cause of deaths worldwide [1]. To reduce the number of CVD mortality rate, it is necessary to have an efficient diagnostic method for timely detection and monitoring of disease status. For this purpose, cardiac imaging is frequently used by the cardiologist for the diagnosis of CVD and the study of cardiac structure as well as its function by automatic or semi-automatic analysis. Moreover, the segmentation of left ventricle (LV) endocardium or epicardium boundaries is an active area of research.

Among the cardiac imaging modalities, the echocardiography is generally accepted as a quick, non-invasive, cost effective and practical method for examining and exploring the cardiac structure as well as its function at rest and during stress. Real-time three-dimensional echocardiography (3DE) is a relatively recent addition to the echocardiography imaging scene [2] with success in providing more accurate and useful results. Despite the fact of being widely used in a large proportion of patients, the 3DE occasionally fails to produce diagnostically useful images [3]. The image quality is known to be affected by ultrasound physics and influenced by factors such as fat, rib spacing, ultrasound reflection angle, and lung breathing [3,4]. Therefore, the echocardiography suffers from intensity dropout, missing features and speckle noise. These artefacts may further lead to inaccurate assessment and anomalous interpretation of the cardiac structure. 
                     Fig. 1 presents some examples of 2D cross-sections from 3DE images with intensity dropout, where the arrows point to the missing anatomical structures.

To tackle these limitations, contrast enhanced 3d echocardiography (C3DE) scans are acquired as an alternative choice with relatively improved image quality for patients with poor acoustic window. In contrast echocardiography, the contrast agent drugs containing hyper-echoic micro-bubbles are injected intravenously. The ultrasound characteristics of these contrast agents are distinctly different from the blood and the cardiac tissue. The contrast agents intravenously mixed in the blood produce strong backscatter to the ultrasound waves, thus causing an increase in the echocardiographic signal and resulting in better image quality [6].

The concentration of micro-bubbles in the LV blood pool is much higher than in vessels of the cardiac muscles, thus resulting in inverted image appearance (see 
                     Fig. 2) compared with routine 3DE image and often provides a clear LV endocardium boundary [7]. The visual appearance of endocardial delineation is often improved in contrast echocardiography, thus enhancing the cardiologist׳s diagnostic ability. Cardiologists often choose the contrast images over non-contrast images, when corresponding non-contrast image quality is poor due to poor acoustic window.

Although the image quality in C3DE is perceived to be improved for visual analysis, it seems to deteriorate for the purpose of automatic or semi-automatic analysis due to high speckle noise and intensity inhomogeneity within the LV cavity. In the C3DE images, due to this inverted appearance compared to the 3DE, the LV segmentation methods proposed for 3DE images fail on the C3DE images. Moreover, the commercial software (QLAB [8] and TomTec [9]) do not presently support automatic or semi-automatic C3DE segmentation. Therefore, the LV endocardial feature extraction and segmentation from C3DE images remain challenging problems. In the previous literature, no considerable work has been done to address these issues. Hence, there is a genuine need for the exploration of C3DE pre-processing technique to enable automated image analysis.

The C3DE image analysis appears to face the following difficulties, due to image quality, which hinder the subsequent automatic or semi-automatic image analysis:
                        
                           a)
                           Contrast intensity inhomogeneity within the LV cavity, as a result of reflection and scattering of the ultrasound beam by many uncorrelated free moving contrast microbubbles (see 
                              Fig. 3(a)).

There is a relatively low contrast or slow intensity change between brighter LV cavity and the myocardium border (see Fig. 3(b)). This low contrast between myocardium border and the LV cavity can obstruct the traditional LV edge driven feature extraction.

This work proposes an adaptive automatic pre-processing technique for image inversion in which the new inverted representation of a C3DE image is constructed to overcome the abovementioned difficulties. This inverted representation facilitates the further automatic or semi-automatic analysis.

This paper is organized as follows: Section 2 describes the relevant research work. Section 3 briefly elaborates the proposed work. Further, Sections 4 and 5 present and discuss the results, respectively. Towards the end, the paper ends with concluding remarks in Section 6.

@&#RELATED WORK@&#

To the best of our knowledge, there has been no previous work in the literature on C3DE pre-processing to assist in subsequent image analysis. However, considerable work has been done in ultrasound and echocardiography image enhancement. Zwirn and Akselrod [10] proposed a histogram based technique for the noise reduction in the echocardiographic images. They used an adaptive method of brightness transfer function to increase the spread of the grey level histogram in order to improve image quality. The obtained results were found to be better in contrast with richer grey-levels within the cardiac muscle. Tay et al. [11] presented a technique of speckle reduction and homogenisation in cardiac ultrasound images. In their method, image homogenisation is achieved by decreasing the pixel variation in the inhomogeneous region by an iterative method that smoothes at each iteration only outlying pixel values by local mean. Chang et al. [12] presented an image contrast enhancement technique which is based on a histogram transformation of local standard deviation. Their adaptive contrast enhancement algorithm has a capability to reduce noise and ringing effect while resulting in image enhancement. Modersitzki and Wirtz [13] proposed to combine homogenisation and registration of synthetic data as well as real life histology image data. Their technique is based on the comparison of the reference image with template image (i.e. a sub-image). For the image homogenization, they used a threshold method for comparison with the reference image.

In the literature, there has been only one previous work by Ma et al. [7] on LV segmentation from the C3DE images. They proposed an LV segmentation algorithm using 3D active shape models. The C3DE scans were obtained from a fast rotating ultrasound (FRU) transducer. However, the FRU transducer is not commonly used in cardiology clinics due to the recent availability of volumetric matrix-array transducers by leading scanner manufacturers for C3DE scan acquisition. To the best of our knowledge, there has been no previous attempt in the published literature for LV segmentation from the C3DE scans obtained from volumetric matrix-array transducer. This further illustrates the challenges faced in LV segmentation from the C3DE images.

Although there has been little work in C3DE segmentation, but considerable research has been done on 3DE LV segmentation algorithms. A common approach is to treat echocardiographic LV segmentation as a contour finding approach. Mignotte and Meunier [14] used active contour model for the LV short axis segmentation, they used a statistical external energy in a discrete active contour for the segmentation, and according to their work it has been suggested that their method was suitable in ultrasound images to deal with significant noise and missing boundaries. Deopujari and Dubey [15] presented a technique for LV segmentation using active contour model and used low pass Gaussian smoothing for edge detection. Rajpoot et al. [16] have conducted recent work in feature extraction using phase base method on the fused multi-view 3DE images and then LV segmentation by active contour model.

In [10], Zwirn and Akselrod proposed a method of fitting curve to image histogram for estimating two thresholds to identify the myocardium border and LV cavity. They further applied the histogram equalization to transform image intensity for image enhancement. In comparison, our work focuses on threshold estimation method by histogram analysis for building a new inverse image representation. Moreover, their proposed method was applied on non-contrast 2D echocardiography while our method was designed and applied on C3DE.

In this work, we focus on image inversion to enable LV segmentation from the C3DE images such that the 3DE segmentation algorithms may be applied to C3DE images.

@&#METHODS@&#

The proposed work consists of estimating automatic threshold by a data analysis process through histogram analysis. Subsequently, this threshold is utilized to construct the inverse image. Below, we describe: (a) the simple scheme of inverse image construction, and (ii) the method for estimation of threshold through histogram analysis.

We propose here to build an alternate inverse image representation, corresponding to a C3DE image, such that the blood pool noise is suppressed and the image contrast between blood pool and myocardium is enhanced. In this new representation, the blood pool appears dark and the myocardium appears bright. With this simple alternate representation trick, the segmentation methods proposed for 3DE images can be applied to C3DE inverse image.

In this method, we propose to invert very bright high-intensity pixels in LV cavity, while keeping the medium or low-intensity pixels unperturbed. For a given C3DE image 
                           
                              
                                 I
                              
                              
                                 c
                              
                           
                        , the following intensity transformation is proposed to generate the inverse image 
                           
                              
                                 I
                              
                              
                                 i
                              
                           
                        :
                           
                              (1)
                              
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       x
                                       ,
                                       y
                                       ,
                                       z
                                    
                                    )
                                 
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               I
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               x
                                                               ,
                                                               y
                                                               ,
                                                               z
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   ,
                                                   z
                                                   )
                                                   >
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         ,
                                                         y
                                                         ,
                                                         z
                                                      
                                                      )
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         c
                                                      
                                                   
                                                   (
                                                   x
                                                   ,
                                                   y
                                                   ,
                                                   z
                                                   )
                                                   ≤
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         is an intensity threshold specific to image properties. This threshold 
                           
                              
                                 T
                              
                              
                                 h
                                 
                              
                           
                        is a specific intensity value which differentiates the very bright high-intensity pixels corresponding to LV cavity from medium-intensity and low-intensity pixels corresponding to myocardium. Here, we consider that the pixels with intensity value above 
                           
                              
                                 T
                              
                              
                                 h
                                 
                              
                           
                         need to be inverted.

Threshold estimation is a vital part of inverse image construction because it is tedious to find manual threshold for each new C3DE image. As described above, threshold 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         depends on image properties thus each C3DE image may have a different 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         value. For determination of 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                        , our analysis is based on the C3DE dataset grey level histogram. We propose below: (i) a method to analyse image properties from histogram analysis of training images, and (ii) a method to estimate threshold for a new test image from its image specific properties.

The algorithmic steps of the training process are described below:
                           
                              i.
                              Data analysis and training
                                    
                                       1.
                                       Grey level histogram shape analysis of a C3DE image by quantitatively calculating the bin percentage (
                                             b
                                             p
                                          ) of first ten intensity bins:
                                             
                                                (2)
                                                
                                                   b
                                                   p
                                                   (
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         10
                                                      
                                                   
                                                   )
                                                   =
                                                   
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               =
                                                               1
                                                               
                                                            
                                                            
                                                               10
                                                            
                                                         
                                                         h
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                            ∑
                                                            
                                                               k
                                                               =
                                                               1
                                                               
                                                            
                                                            
                                                               L
                                                               −
                                                               1
                                                            
                                                         
                                                         h
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   ×
                                                   100
                                                
                                             
                                          where 
                                             
                                                
                                                   r
                                                
                                                
                                                   k
                                                
                                             
                                           denotes intensity value, 
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                )
                                             
                                           denotes the frequency of intensity 
                                             
                                                
                                                   r
                                                
                                                
                                                   k
                                                
                                             
                                          , and 
                                             L
                                             −
                                             1
                                           is the largest intensity value (
                                             L
                                             
                                             =
                                             
                                             256
                                           in this case). By analysing the 
                                             b
                                             p
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   10
                                                
                                             
                                             )
                                           values of our data (size of data as mentioned in Section 4) as in 
                                          Table 1, we observed that the histogram of a C3DE dataset typically has one of the three different curve shapes while this 
                                             b
                                             p
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   10
                                                
                                             
                                             )
                                           value may indicate the shape of the curve. The three types of histograms are shown in 
                                          Fig. 4.

The 
                                             b
                                             p
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   10
                                                
                                             
                                             )
                                           values for end-diastolic and end-systolic phase images from these observed categories is reported in Table 1. Thus, based upon the bin percentage 
                                             b
                                             p
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   10
                                                
                                             
                                             )
                                           value of an image, the C3DE image 
                                             f
                                           can be categorized or placed into one of the three categories as below:
                                             
                                                (3)
                                                
                                                   f
                                                   ∈
                                                   
                                                      {
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     C
                                                                     a
                                                                     t
                                                                     1
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     b
                                                                     p
                                                                     (
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           10
                                                                        
                                                                     
                                                                     )
                                                                     
                                                                     <
                                                                     
                                                                     b
                                                                     p
                                                                     1
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     C
                                                                     a
                                                                     t
                                                                     2
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     b
                                                                     p
                                                                     1
                                                                     ≤
                                                                     b
                                                                     p
                                                                     (
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           10
                                                                        
                                                                     
                                                                     )
                                                                     
                                                                     <
                                                                     
                                                                     b
                                                                     p
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     C
                                                                     a
                                                                     t
                                                                     3
                                                                     ,
                                                                  
                                                               
                                                               
                                                                  
                                                                     b
                                                                     p
                                                                     (
                                                                     
                                                                        
                                                                           r
                                                                        
                                                                        
                                                                           10
                                                                        
                                                                     
                                                                     )
                                                                     
                                                                     ≥
                                                                     
                                                                     b
                                                                     p
                                                                     2
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          where 
                                             b
                                             p
                                             1
                                           and 
                                             b
                                             p
                                             2
                                           are constants that differentiate amongst the three categories (as shown in Fig. 4) of histogram shapes. In this work, the following values were used: 
                                             b
                                             p
                                             1
                                             =
                                             16
                                           and 
                                             b
                                             p
                                             2
                                             =
                                             30
                                           with the help of analysis based on Table 1.

Find the manual threshold (
                                             
                                                
                                                   T
                                                
                                                
                                                   
                                                   m
                                                
                                             
                                          ) for each image, for the sake of training. The threshold represents an intensity value which separates the LV cavity and myocardium border and it has been obtained by visual analysis under expert guidance. This threshold is used to derive the automatic method for threshold estimation. 
                                          Fig. 5(c) shows an inverse image, which is constructed by a manual threshold value 
                                             
                                                
                                                   T
                                                
                                                
                                                   m
                                                
                                             
                                           (from Fig. 5(b)), which clearly separates the LV cavity and the myocardium.

Find the relationship between frequency at manual threshold intensity value and the peak frequency of image 
                                             f
                                          :
                                             
                                                (4)
                                                
                                                   F
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         t
                                                         /
                                                         p
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         f
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         h
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     t
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         P
                                                         F
                                                         
                                                            (
                                                            f
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (5)
                                                
                                                   where
                                                   
                                                   P
                                                   F
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                   =
                                                   m
                                                   a
                                                   x
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               h
                                                            
                                                            
                                                               f
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     r
                                                                  
                                                                  
                                                                     k
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       


                                          
                                             F
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                           is the frequency relation between frequency at manual threshold 
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                )
                                             
                                           and peak frequency 
                                             P
                                             F
                                             
                                                (
                                                f
                                                )
                                             
                                           for image 
                                             f
                                          . The peak frequency is selected as the maximum value in the histogram 
                                             
                                                
                                                   h
                                                
                                                
                                                   f
                                                
                                             
                                           of image 
                                             f
                                           (see Fig. 5(b)). Within a category of C3DE images, the 
                                             F
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                           values are found to be similar as it can be seen in 
                                          Table 2. Thus, by finding the frequency relationship 
                                             F
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                           and the peak frequency 
                                             P
                                             F
                                           of a new image from histogram analysis, we believe that it can be helpful in estimating the threshold 
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                
                                             
                                           automatically.

Find the mean frequency relation 
                                             F
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                           and mean peak frequency from all images within a category 
                                             c
                                          :
                                             
                                                (6)
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               R
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         /
                                                         p
                                                      
                                                   
                                                   (
                                                   c
                                                   )
                                                   =
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   F
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         t
                                                         /
                                                         p
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ,
                                                         i
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (7)
                                                
                                                   
                                                      
                                                         P
                                                         F
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                   (
                                                   c
                                                   )
                                                   =
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         
                                                            
                                                               N
                                                            
                                                            
                                                               c
                                                            
                                                         
                                                      
                                                   
                                                   P
                                                   F
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                             
                                          where 
                                             
                                                
                                                   N
                                                
                                                
                                                   c
                                                
                                             
                                           is the number of images in category 
                                             c
                                          , 
                                             F
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                   i
                                                
                                                )
                                             
                                           is the frequency relation for image 
                                             i
                                          , 
                                             
                                                
                                                   
                                                      
                                                         F
                                                         R
                                                      
                                                      
                                                         ¯
                                                      
                                                   
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                             (
                                             c
                                             )
                                           is the mean of 
                                             F
                                             
                                                
                                                   R
                                                
                                                
                                                   t
                                                   /
                                                   p
                                                
                                             
                                           for all images of category 
                                             c
                                          , 
                                             P
                                             F
                                             
                                                (
                                                i
                                                )
                                             
                                           is the peak frequency for image 
                                             i
                                          , and 
                                             
                                                
                                                   P
                                                   F
                                                
                                                
                                                   ¯
                                                
                                             
                                             
                                                (
                                                c
                                                )
                                             
                                           is the mean peak frequency for category c.

This now completes the description of the steps required to train and conduct data analysis which is further utilized in the automatic threshold estimation.

Automatic threshold estimation (ATE)

From the above analysis, it was observed that the frequency relationship 
                                    F
                                    
                                       
                                          R
                                       
                                       
                                          t
                                          /
                                          p
                                       
                                    
                                  is similar (Table 2) within a category 
                                    c
                                 . Thus, any new C3DE image which falls in one of the above mentioned three categories would have its frequency relation 
                                    F
                                    
                                       
                                          R
                                       
                                       
                                          t
                                          /
                                          p
                                       
                                    
                                  value close to mean frequency relation 
                                    
                                       
                                          
                                             
                                                F
                                                R
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          t
                                          /
                                          p
                                       
                                    
                                    (
                                    c
                                    )
                                 . Therefore, we can find the threshold 
                                    
                                       
                                          T
                                       
                                       
                                          h
                                          
                                       
                                    
                                  of a C3DE image by finding the 
                                    F
                                    
                                       
                                          R
                                       
                                       
                                          t
                                          /
                                          p
                                       
                                    
                                  of that image. The 
                                    F
                                    
                                       
                                          R
                                       
                                       
                                          t
                                          /
                                          p
                                       
                                    
                                  of a C3DE image is proposed to be computed using the following steps:
                                    
                                       1.
                                       Compute the histogram of a new C3DE image 
                                             f
                                          .

Determine the image categorization based upon bin percentage 
                                             b
                                             p
                                             (
                                             
                                                
                                                   r
                                                
                                                
                                                   10
                                                
                                             
                                             )
                                          .

Find the displacement gap 
                                             d
                                             i
                                             s
                                             p
                                             
                                                [
                                                
                                                   P
                                                   F
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                
                                                ]
                                             
                                           of peak frequency (PF) of the image 
                                             f
                                           with the mean peak frequency (
                                             
                                                
                                                   P
                                                   F
                                                
                                                
                                                   ¯
                                                
                                             
                                          ) of that category:
                                             
                                                (8)
                                                
                                                   d
                                                   i
                                                   s
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         [
                                                         P
                                                         F
                                                         
                                                            (
                                                            f
                                                            )
                                                         
                                                         ,
                                                         
                                                         
                                                            
                                                               P
                                                               F
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         
                                                            (
                                                            c
                                                            )
                                                         
                                                         ]
                                                         
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         P
                                                         F
                                                         (
                                                         f
                                                         )
                                                         −
                                                         
                                                         
                                                            
                                                               P
                                                               F
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         
                                                            (
                                                            c
                                                            )
                                                         
                                                      
                                                      
                                                         
                                                         
                                                            
                                                               P
                                                               F
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                         
                                                            (
                                                            c
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       

Find the frequency relationship estimate 
                                             F
                                             R
                                             
                                                (
                                                
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         x
                                                      
                                                   
                                                
                                                )
                                             
                                           for the current test C3DE image 
                                             f
                                          :
                                             
                                                (9)
                                                
                                                   F
                                                   R
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      (
                                                      
                                                         1
                                                         −
                                                         
                                                         α
                                                         ×
                                                         d
                                                         i
                                                         s
                                                         p
                                                      
                                                      )
                                                   
                                                   ×
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                               R
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         t
                                                         /
                                                         p
                                                      
                                                   
                                                   (
                                                   c
                                                   )
                                                
                                             
                                          where 
                                             α
                                           is the displacement coefficient. The value of 
                                             α
                                           was found by empirical analysis on an arbitrarily selected subset of 23 image frames from different points in the cardiac cycle of 3 subjects. The automatic threshold determined by changing the value of 
                                             α
                                           was then tested according to the average threshold estimation error. This error is measured as the absolute difference between automatically estimated threshold and manual reference threshold—please see Eq. (11) in the next section for a description of the error measure. By changing the value of 
                                             α
                                           from 0
                                             .5
                                           to 
                                             1.5
                                           in step of 
                                             0.5
                                          , we obtained mean threshold estimation error of 
                                             4.30
                                             ±
                                             3.18
                                          , 
                                             8.0
                                             ±
                                             5.93
                                          , and 
                                             12.39
                                             ±
                                             9.41
                                          , respectively. Therefore, due to smallest error, we selected displacement coefficient 
                                             α
                                             =
                                             0.5
                                           for all the subsequent experiments and further systematic validation as presented in the next section.

Find the threshold frequency:
                                             
                                                (10)
                                                
                                                   h
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   P
                                                   F
                                                   
                                                      (
                                                      f
                                                      )
                                                   
                                                   ×
                                                   
                                                   F
                                                   R
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               x
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                          
                                       

Thus the intensity level with 
                                             h
                                             
                                                (
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                )
                                             
                                           frequency will be the image-specific threshold value 
                                             
                                                
                                                   T
                                                
                                                
                                                   h
                                                   
                                                
                                             
                                           for a new C3DE image 
                                             f
                                          .

@&#RESULTS@&#

We obtained C3DE scan sequences from 16 subjects which were recorded at the Alberta University Hospital, Canada. The recordings were acquired with a volumetric matrix-array X5 probe using a Philips iE33 ultrasound system. The image spatial dimensions for each scan were either 160×144×208 or 192×176×208 depending on the settings of the ultrasound system. It is noted that the C3DE is not yet used in routine clinical practice and it is used primarily for research studies, thus the data size may seem small size but it is a good-size representative sample.

The C3DE images are analysed and the training is conducted according to the proposed steps described above. Subsequently, the algorithm can estimate the threshold for a new C3DE test image as per the aforementioned steps. Subsequently, the inverse image is constructed by the proposed mapping in Eq. (1), while the threshold value 
                           
                              
                                 T
                              
                              
                                 h
                              
                           
                         is automatically estimated. The inversion results are shown in Figs. 7(c) and 8(c). These results assist in the subsequent C3DE image analysis i.e. LV segmentation.


                        
                           
                              i.
                              Validation of automatic threshold estimation

Automatic threshold estimation is validated through different schemes of training and testing described below. The proposed technique of automatic threshold estimation is initially trained on a collection of C3DE images, including end diastolic (ED) and end systolic (ES) frames. The performance of proposed method is validated by finding the mean of absolute difference error between the manual reference threshold (
                                    
                                       
                                          T
                                       
                                       
                                          
                                          m
                                       
                                    
                                    )
                                  and the automatic threshold 
                                    (
                                    
                                       
                                          T
                                       
                                       
                                          h
                                          
                                       
                                    
                                    )
                                  of C3DE image:
                                    
                                       (11)
                                       
                                          
                                             
                                                
                                                   E
                                                   =
                                                   
                                                      |
                                                      
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               
                                                               m
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               T
                                                            
                                                            
                                                               h
                                                               
                                                            
                                                         
                                                      
                                                      |
                                                   
                                                
                                             
                                             
                                                
                                                   and
                                                
                                             
                                             
                                                
                                                   
                                                      E
                                                      ¯
                                                   
                                                   =
                                                   
                                                   
                                                      1
                                                      n
                                                   
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      n
                                                   
                                                   
                                                      
                                                         E
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 where 
                                    n
                                  is the number of images.

We present here the validation conducted through various schemes, as below:
                                    
                                       1.
                                       Training on ED images and validation on ED images (see 
                                          Table 3 for results).

Training on ES images and validation on ES images (see 
                                          Table 4 for results).

Training on ES images and validation on ED images (see 
                                          Table 5 for results).

Training on ED images and validation on ES images (see 
                                          Table 6 for results).

Leave one out validation of ES images and ED images collectively: the unbiased validation of proposed technique is carried out by leave-one out (LOO) cross validation. In LOO cross validation, for each of the N experiments (N referring to the total number of images), N−1 C3DE images were used in training and the trained algorithm was then tested on one excluded C3DE image. This process is performed N times to validate the whole dataset (see 
                                          Table 7 for results).

Validation by semi-automatic segmentation

In an inverted C3DE image (see Figs. 7(c) and 8(c)), the endocardial delineation is clearer with very little noise in the LV blood pool cavity and the image contrast has increased between the blood pool and the myocardium. Thus, the inverse image construction enables the application of a 3DE LV segmentation method on C3DE images.

In order to evaluate the LV segmentation on a C3DE image, we apply a conventional semi-automatic segmentation method which is image-driven and derives its driving force from the image edges. The use of gradient based intensity edges for segmentation has become possible only as a result of inverse image construction. This segmentation method is based on 3D level set methods implementation of geodesic active contour [17] found in open-source software ITK-Snap [18]. The segmentation was performed on 3D images. For validation, we took a total of 32 2D slices, with 16 slices each from 2-chamber view and 4-chamber view, respectively. In order to test images from each category, we chose 8 slices from category (1), 12 slices from category (2), and 12 from category (3). The 2D slices from ED time point images were taken and the LV endocardial border was manually traced under the guidance of an expert cardiologist. The manually traced border was used as a ground truth to evaluate the traced LV endocardial border obtained from the semi-automatic method. The segmentation results are shown in Figs. 7 and 8. Since our scope was limited to image inversion, thus we computed two simple measures for quantitatively validating LV segmentation i.e. Dice similarity index and mean contour distance.
                                    
                                       1.
                                       Dice similarity index (DSI) [19] is computed as a measure of area overlap between the reference contour (
                                             
                                                
                                                   C
                                                
                                                
                                                   r
                                                   e
                                                   f
                                                
                                             
                                          ) and the automatic contour (
                                             
                                                
                                                   C
                                                
                                                
                                                   a
                                                   u
                                                   t
                                                   o
                                                
                                             
                                          ), giving a measurement value between 0 (no overlap) and 1 (full overlap). DSI is measured as:
                                             
                                                (12)
                                                
                                                   D
                                                   S
                                                   I
                                                   =
                                                   
                                                   
                                                      
                                                         2
                                                         (
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               r
                                                               e
                                                               f
                                                            
                                                         
                                                         ∩
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               a
                                                               u
                                                               t
                                                               o
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               r
                                                               e
                                                               f
                                                            
                                                         
                                                         +
                                                         
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               a
                                                               u
                                                               t
                                                               o
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          where ∩ represent the intersection between the two contour. We have calculated the overlap of semi-automatic LV cavities with the ground truth segmented LV cavities and the DSI results are shown in 
                                          Table 8.

Mean contour distance (MCD) is the mean contour distance 
                                             (
                                             
                                                
                                                   d
                                                
                                                
                                                   m
                                                   e
                                                   a
                                                   n
                                                
                                             
                                             )
                                           between the segmented contour (
                                             
                                                
                                                   C
                                                
                                                
                                                   a
                                                   u
                                                   t
                                                   o
                                                
                                             
                                          ) and the reference contour (
                                             
                                                
                                                   C
                                                
                                                
                                                   r
                                                   e
                                                   f
                                                
                                             
                                          ) which is defined as:
                                             
                                                (13)
                                                
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         m
                                                         e
                                                         a
                                                         n
                                                      
                                                   
                                                   =
                                                   
                                                      1
                                                      2
                                                   
                                                   
                                                      [
                                                      
                                                         
                                                            d
                                                            ¯
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     r
                                                                     e
                                                                     f
                                                                  
                                                               
                                                               ,
                                                               
                                                               
                                                                  
                                                                     C
                                                                  
                                                                  
                                                                     a
                                                                     u
                                                                     t
                                                                     o
                                                                  
                                                               
                                                            
                                                            )
                                                         
                                                         +
                                                         
                                                            d
                                                            ¯
                                                         
                                                         (
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               a
                                                               u
                                                               t
                                                               o
                                                            
                                                         
                                                         ,
                                                         
                                                         
                                                            
                                                               C
                                                            
                                                            
                                                               r
                                                               e
                                                               f
                                                            
                                                         
                                                         )
                                                      
                                                      ]
                                                   
                                                
                                             
                                          where 
                                             
                                                d
                                                ¯
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         r
                                                         e
                                                         f
                                                      
                                                   
                                                   ,
                                                   
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         a
                                                         u
                                                         t
                                                         o
                                                      
                                                   
                                                
                                                )
                                             
                                           is the mean of distances between every contour pixel in reference contour and the closest contour pixel in auto contour. The MCD results are shown in 
                                          Table 9.

@&#DISCUSSION@&#

The performance of ATE of threshold 
                           
                              
                                 T
                              
                              
                                 h
                                 
                              
                           
                         through five validation schemes is presented in Table 3 to Table 7 respectively, which demonstrates the close match with manual threshold 
                           
                           
                              
                                 T
                              
                              
                                 
                                 m
                                 
                              
                           
                         with a reasonable mean error. Through visual analysis of inverted image by changing the threshold manually, we observed that the variation in the threshold value by up to 10 points (intensity level) is tolerable (please see 
                        Fig. 6 illustrating this observation). In ATE, first two validation schemes are considered to be biased because same images are used in training and validation (Tables 3 and 4). From the results, we can observe that the maximum error of 5.7±1.9 for ED time images and 5.4±3.9 on ES images is quite acceptable. Next three validation schemes are completely unbiased since the algorithm is trained and validated on completely different images. The unbiased training of ES images and then validation on ED images (see Table 5) yields the mean error of 9.8±6.2 of category 3, which is under the tolerable range. Moreover, the results of fourth scheme (ED training, ES validation) and fifth validation scheme (LOO) are given in Tables 6 and 7 respectively, which have maximum mean errors of 7.6±4.6 and 6.92±5.6, respectively, which is well within the tolerable limit of threshold.

Another point that can be noticed is that largest mean error belongs to third category of images in all validation schemes. The possible reason for largest error for this category is the diverse properties (i.e. histogram curve, peak frequency etc.) of C3DE images that fall in this category.

The qualitative results of image inversion and subsequent LV segmentation are presented in 
                        
                        Figs. 7 and 8, respectively. The native C3DE image is shown in Figs. 7(a) and 8(a). The gradient information in Figs. 7(b) and 8(b) clearly shows that it is hard to extract LV cavity from C3DE image without pre-processing. The inverted image constructed by the proposed method from C3DE image is shown in Figs. 7(c) and 8(c). This new inverse appearance makes it possible to employ an image-driven LV segmentation method. According to gradient information of inverse image (Figs. 7(d) and 8(d)), the LV cavity is clearer, which can be relatively easily segmented. The results of semi-automatic segmentation are shown in Figs. 7(e) and 8(e), which clearly show reasonable segmentation accuracy. Figs. 7(f) and 8(f) show the visual overlay comparison of reference contour (i.e. ground truth) with the contour obtained through the semi-automatic image-driven method. We can observe a close match between the reference and semi-automatic contours. It clearly shows that the LV segmentation becomes possible by image inversion method.

Moreover, the quantitative evaluation using Dice similarity index (DSI) and mean contour distance (MCD) are presented in Tables 8 and 9, respectively. It can be observed that the DSI mean values of 2-chamber view and 4-chamber view illustrate a good overlap of the LV reference contour and automatic contour cavity. The average MCD error across all 3 categories is 2.49±0.59mm which is fairly acceptable.

For comparison of our segmentation results with literature, as mentioned earlier, only Ma et al. [7] worked on LV segmentation from C3DE. They used C3DE scans which were obtained from a fast rotating ultrasound transducer whose image properties are different than that of C3DE images acquired by a matrix array transducer. Furthermore, the fast rotating ultrasound transducer is not commonly used in the cardiology clinics. Therefore, it is not possible to directly compare our work with previous C3DE segmentation. Moreover, our work focuses primarily on image inversion. Nonetheless, the DSI and MCD errors obtained are comparable to error reported earlier in literature for 3DE segmentation and the error is within the inter-rater and intra-rater variability. The work in [5] reported real-time 3DE LV segmentation DSI and MCD to be 0.88±0.04 and 1.93±0.62mm, respectively. We note that image quality of C3DE image is more challenging and, therefore the quantitative validation further verifies our claim regarding the match between manual and semi-automatic LV delineation.

The results demonstrate, as presented and discussed in previous sub-sections, that the C3DE image inversion can create a new image representation that enables semi-automatic LV segmentation. Here, we discuss the limitations and any concerns of this inversion approach. In terms of method design, the approach is reliant on the threshold which is estimated by bin percentage analysis from the image histogram. This step is data driven and may be revised in a future study with availability of a larger dataset. Furthermore, the training of threshold estimation is dependent on the availability of a manual threshold which is somewhat subjective to choose. It should be noted that the image inversion can be considered as a pre-processing step like image enhancement which is often qualitative and may occasionally compromise image information. Thus, the risks associated with such pre-processing steps (e.g. noise suppression, contrast enhancement, etc.) are similar in image inversion. The objective of image inversion, in this work, is not to produce a standalone image representation but rather enable subsequent analysis. Moreover, considering the LV segmentation from an inverted C3DE image, the risk associated due to inversion is similar to performing LV segmentation on a non-inverted C3DE scan where the intensity inhomogeneity and unclear edges are even more prominent.

@&#CONCLUSIONS@&#

Even though the image quality in C3DE is perceived to be improved for visual analysis, but it seems to deteriorate for the purpose of automatic or semi-automatic analysis due to two main issues: (i) the contrast inhomogeneity within the LV cavity, and (ii) the relatively low contrast between the LV cavity and the myocardium border. Thus, the LV endocardial segmentation from C3DE images remains a challenging problem with little published work in the literature. To deal with this challenge, we presented an adaptive pre-processing method to invert the appearance of the C3DE image. This inverted appearance yielded low noise appearance, strong LV endocardium boundary and facilitated feature extraction for segmentation. The image inversion mapping was carried out by using intensity threshold value for which an automatic estimation method by histogram analysis was proposed. This technique was validated through qualitative and quantitative means and favourable results were found. We highlight that the proposed method is the first attempt of its kind towards enabling automatic or semi-automatic LV segmentation from C3DE images. In this work, the data analysis, training and validation was conducted on limited number of C3DE images. This work can be extended in future by applying and validating the proposed inversion technique on a larger size dataset. The proposed image inversion approach is primarily reliant on image histogram and thus the application seems specific to C3DE images. However, we consider that the approach may be suitable for application on images in ultrasound imaging with similar intensity characteristics.

None declared.

@&#ACKNOWLEDGEMENT@&#

We are grateful to Professor Harald Becher from Alberta University Hospital, Edmonton, Canada for the provision of C3DE data.

@&#REFERENCES@&#

