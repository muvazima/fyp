@&#MAIN-TITLE@&#A statistical method for line segment detection

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Voting in each column around an initial peak is considered to be a random variable.


                        
                        
                           
                           The optimal θ is determined by fitting and minimizing a 2nd-order curve.


                        
                        
                           
                           The optimal ρ is determined by fitting and interpolating a sine curve.


                        
                        
                           
                           We calculate voting boundaries instead of searching for non-zero voting cells.


                        
                        
                           
                           The endpoint coordinates are determined by fitting instead of by solving equations.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hough transform

Statistical analysis

Endpoint specification

Fitting and interpolation

@&#ABSTRACT@&#


               
               
                  Line segment detection is a fundamental procedure in computer vision, pattern recognition, or image analysis applications. This paper proposes a statistical method based on the Hough transform for line segment detection by considering quantization error, image noise, pixel disturbance, and peak spreading, also taking the choice of the coordinate origin into account.
                  A random variable is defined in each column in a peak region. Statistical means and statistical variances are calculated; the statistical non-zero cells are analyzed and computed. The normal angle is determined by minimizing the function which fits the statistical variances; the normal distance is calculated by interpolating the function which fits the statistical means. Endpoint coordinates of a detected line segment are determined by fitting a sine curve (rather than searching for the first and last non-zero voting cells, and solving equations containing coordinates of such cells).
                  Experimental results on simulated data and real world images validate the performance of the proposed method for line segment detection.
               
            

@&#INTRODUCTION@&#

The Hough transform (HT) [1–3] is widely used for extracting geometric features in images. The standard HT is inefficient with respect to run time and storage requirements; it also suffers from the peak-spreading problem in the Hough space [4,5].

In order to improve the computation and storage efficiency, many methods have been proposed, such as the fast HT 
                     [6], adaptive HT 
                     [7], special architectures HT 
                     [8], probabilistic HT 
                     [9], randomized HT 
                     [10], or generalized HT 
                     [11].

In order to locate accurately the peak, and to derive accurate normal parameters, various extensions to the standard HT have been proposed. Numerous methods put the emphasis on generating more distinct peaks by modifying the voting scheme of a Hough transform. Edge information [12–14] or image preprocessing techniques [15–17] are used to enhance the peak in the accumulator array. In addition, a continuous statistical kernel [18] is proposed for modeling the Hough votes instead of using a discrete accumulator array. This approach is computationally more expensive because it considers and models all pixels in the given image.

After finding a peak, there are three different ways for supporting the computation of accurate peak parameters:

                        
                           (1)
                           A peak cell (θ, ρ) is simply selected for specifying the normal parameters of the detected line.

A weighted averaging [19,20] is used by considering neighboring cells (θi, ρi
                              ) around a peak cell.

A specially designed peak localization technique is employed. For example, two accurate peak localization methods are presented in [21,22] using smoothing windows and weighted averaging, a two-stage method [23] is described by finding a median position in narrow strips passing through an initial peak, a high-accuracy HT, proposed in [24], is based on the theoretical symmetry of the butterfly pattern around a peak, and a subcell-accuracy method [25] locates the peak by using fitting and interpolation techniques while analyzing the butterflies.

The HT can also be used for extracting the endpoints of a detected line segment [26] although the standard HT only provides normal angle θ and normal distance ρ.

We classify HT-based methods for detecting line segments into two categories. One class of methods is based on projection [27–29]. After applying the standard HT, the detected line is cut into pairwise disjoint segments; the endpoints of one of those line segments are determined by analyzing the projection of the feature points on either the x- or y-axis in image space. Two thresholds are needed to control the length of a line segment and the width of a gap between line segments. But, how to determine these two thresholds defines then a new problem.

The second class of methods is motivated by the butterfly shape [30,31] of a peak region in Hough space [32–34]. Butterfly features are used to extract parameters of a line segment. The first and last cell with non-zero voting values are identified and used to compute the endpoints of the line segment by solving two sets of simultaneous equations [35–38]. However, how to obtain the first and the last cell containing a non-zero voting value is a difficult problem in the presence of image noise, pixel disturbance, and a wide line-segment.

In a recent publication [39], we described a method for detecting line segments based on minimum-entropy analysis. Direction and length of a line segment are simultaneously determined by analyzing the voting entropies. The midpoint is detected by fitting voting means. The endpoint coordinates are finally calculated based on the detected direction, length and midpoint.

This paper proposes a novel statistical method based on HT for extracting line segments. The vote in each column (around a peak) is considered to be a random variable. The normal angle and distance of a line segment are computed by fitting and interpolating statistical variances and means. Endpoint coordinates of a line segment are computed by fitting a sine curve to the statistical non-zero voting cells, computed from statistical means and variances. Thus, there is no need for searching non-zero cells and solving two equations generated from just two cells.

In distinction to [39], this paper does not apply any minimum-entropy analysis. It extracts the normal angle, the normal distance, and endpoint coordinates using statistical characteristics. This paper also proposes a solution to calculate the statistical non-zero cells instead of searching for the first and the last non-zero voting cells in each column of a butterfly.

The rest of the paper is organized as follows. Section 2 introduces a way for peak distribution analysis in Hough space. Section 3 defines the random variable and statistical characteristics. Section 4 describes our normal angle and distance detection method based on statistical characteristics. Section 5 outlines endpoint detection by fitting sine curves. Section 6 compares experimental results with simulate data and real images. Section 7 concludes.

Our method for line segment detection focuses on the voting cells around a peak. After voting, we start with analyzing the voting value distribution in each column around a peak in the Hough space.

A pixel (x, y) in the image space votes for a set of cells (θ, ρ) in the Hough space according to Eq. (1), defined in [2] (see comments on historic origins in [40]):

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             =
                                             x
                                             ·
                                             cos
                                             θ
                                             +
                                             y
                                             ·
                                             sin
                                             θ
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Votes of a set of collinear pixels in an image would create a peak in Hough space. When mapping a line segment from a noise-free image into the Hough space, assumed to be given at the finest quantization resolution, the peak is distinct in Hough space, and is easy to locate. However, due to various uncertainties, like image background noise, pixel disturbance, space quantization error, or line thickness, there is the phenomenon of peak spreading. See Fig. 1
                        . The peak is not distinct anymore in Hough space. An extraction step is needed to find and locate the accurate peak parameters.

Let Hij
                         be the voting value at cell (θi, ρi
                        ) in Hough space. An initial peak is found by using a sliding 3 × 3 window over all cells of the Hough space. At each position in the whole Hough space we consider the sum of all nine voting values in this placed window. If this sum is the maximum then we take the central cell of this placed window as the initial peak λ.

A larger window, centered at the initial peak, defines the peak region. The size of this larger window depends upon the quantization resolution of the Hough space. For example, we used a window of size 17 × 21 for Δθ equals 1°, and Δρ equals 1p (i.e. the edge length of one pixel), and a window of size 11 × 17 for (Δθ, Δρ) equals (2°, 2p).

Let w and h be width and height of the image space, respectively. In the standard Hough transform, the origin in image space is selected to be at a corner of the image, identified with the origin of the coordinate system as used for representing image data. In this case, the range of θ is [0, π), and the range of ρ in the Hough space is from 
                           
                              −
                              
                                 
                                    
                                       w
                                       2
                                    
                                    +
                                    
                                       h
                                       2
                                    
                                 
                              
                           
                         to 
                           
                              
                                 
                                    w
                                    2
                                 
                                 +
                                 
                                    h
                                    2
                                 
                              
                           
                        .

If the image center is selected to be the origin, the range of ρ changes to the interval

                           
                              
                                 
                                    [
                                    −
                                    
                                       
                                          
                                             w
                                             2
                                          
                                          +
                                          
                                             h
                                             2
                                          
                                       
                                    
                                    /
                                    2
                                    ,
                                    
                                    
                                       
                                          
                                             w
                                             2
                                          
                                          +
                                          
                                             h
                                             2
                                          
                                       
                                    
                                    /
                                    2
                                    ]
                                 
                              
                           
                        Thus, it is reduced to half of its previous size.

The Hough transform equation is then as follows:

                           
                              (2)
                              
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          =
                                       
                                       
                                          
                                             (
                                             u
                                             −
                                             w
                                             /
                                             2
                                             )
                                             cos
                                             θ
                                             +
                                             (
                                             v
                                             −
                                             h
                                             /
                                             2
                                             )
                                             sin
                                             θ
                                          
                                       
                                    
                                 
                              
                           
                        where (u, v) is the pixel location in image space.

The location of the origin in the image also influences the shape of the voting distribution of a peak region. This translation of the origin leads to a butterfly-like distribution around a peak, especially for a line segment that is far away from its perpendicular point.


                        Fig. 2
                         shows voting distributions around a peak for both placement options for the origin. There is a line segment that is far away from its perpendicular point. In case of selecting O as the origin of the image, there is only a very small number (e.g. one or two) of voting cells in many columns, and the peak is not distinct in Hough space. It is difficult to detect and to locate the peak. The likelihood of such a case is reduced by selecting the center O′ as the coordinate origin, and voting values converge now “more” in the peak region. Therefore, a relatively distinct peak is generated.

Around a peak, the voting in each column is considered to be a random variable. We analyze the statistical characteristics of this variable.


                        Fig. 3
                         illustrates the Hough voting correspondence between image space and Hough space.

For voting angle θi
                         in image space, there are several parallel rays that intersect with the considered line segment. Therefore, this line segment contributes to the voting in several cells in the θi
                         column in the Hough space. In general, in different columns we have different numbers of related voting cells. The closer to the peak a column is, the smaller is the number of voting cells.

The voting ρ in θi
                         column is considered to be a random variable Ri
                        . The voting values of cells define the probabilistic distribution of Ri
                        . Because the length of the line-segments defined by crossing each strip is about constant, the voting values of cells are approximately equal in each column, and the voting distribution in each column is approximately uniform. That is:

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             
                                                R
                                                i
                                             
                                             
                                             
                                             ∼
                                             
                                             
                                             U
                                             
                                                [
                                                
                                                   ρ
                                                   i
                                                   
                                                      m
                                                      i
                                                      n
                                                   
                                                
                                                ,
                                                
                                                   ρ
                                                   i
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

For a random variable Ri
                         that corresponds to voting angle θi
                         in image space, we analyze its statistical mean mi
                         and variance 
                           
                              σ
                              i
                              2
                           
                        .

The mean mi
                         is that ρ-value for which the line-segment’s midpoint (xc, yc
                        ) votes for with respect to θi
                        . That is:

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             m
                                             i
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                x
                                                c
                                             
                                             
                                             cos
                                             
                                                θ
                                                i
                                             
                                             
                                             +
                                             
                                             
                                                y
                                                c
                                             
                                             
                                             sin
                                             
                                                θ
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Due to the above equation, the functional relation between statistical mean mi
                         and θi
                         is a sine curve.

Since Ri
                         is a random variable that is uniformly distributed between 
                           
                              ρ
                              i
                              
                                 m
                                 i
                                 n
                              
                           
                         to 
                           
                              
                                 ρ
                                 i
                                 
                                    m
                                    a
                                    x
                                 
                              
                              ,
                           
                         the statistical variance equals

                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             σ
                                             i
                                             2
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      ρ
                                                      i
                                                      
                                                         m
                                                         a
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      ρ
                                                      i
                                                      
                                                         m
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             /
                                             12
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                (
                                                L
                                                ·
                                                sin
                                                |
                                             
                                             
                                                θ
                                                i
                                             
                                             −
                                             
                                                θ
                                                0
                                             
                                             
                                                
                                                   |
                                                   )
                                                
                                                2
                                             
                                             /
                                             12
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                L
                                                2
                                             
                                             ·
                                             
                                                sin
                                                2
                                             
                                             
                                                (
                                                
                                                   θ
                                                   i
                                                
                                                −
                                                
                                                   θ
                                                   0
                                                
                                                )
                                             
                                             /
                                             12
                                          
                                       
                                    
                                 
                              
                           
                        where L is the length of the line segment, and θ
                        0 is the actual angle of the line segment.

Because only columns around θ
                        0 are considered, 
                           
                              
                                 θ
                                 i
                              
                              −
                              
                                 θ
                                 0
                              
                           
                         is small, therefore 
                           
                              sin
                              
                                 (
                                 
                                    θ
                                    i
                                 
                                 −
                                 
                                    θ
                                    0
                                 
                                 )
                              
                              ≈
                              
                                 (
                                 
                                    θ
                                    i
                                 
                                 −
                                 
                                    θ
                                    0
                                 
                                 )
                              
                           
                        . Thus,

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             σ
                                             i
                                             2
                                          
                                       
                                       
                                          ≈
                                       
                                       
                                          
                                             
                                                L
                                                2
                                             
                                             ·
                                             
                                                
                                                   (
                                                   
                                                      θ
                                                      i
                                                   
                                                   −
                                                   
                                                      θ
                                                      0
                                                   
                                                   )
                                                
                                                2
                                             
                                             /
                                             12
                                          
                                       
                                    
                                 
                              
                           
                        Based on the above equation, the functional relation between statistical variance 
                           
                              σ
                              i
                              2
                           
                         and θi
                         is a second-order curve function.

In the θi
                         column in Hough space, the voting mean mi
                         and variance 
                           
                              σ
                              i
                              2
                           
                         are calculated as follows:

                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             m
                                             i
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                j
                                             
                                             
                                                [
                                                
                                                   H
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ·
                                                
                                                   ρ
                                                   j
                                                
                                                ]
                                             
                                             /
                                             
                                                ∑
                                                j
                                             
                                             
                                                H
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             σ
                                             i
                                             2
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                j
                                             
                                             
                                                [
                                                
                                                   H
                                                   
                                                      i
                                                      j
                                                   
                                                
                                                ·
                                                
                                                   
                                                      (
                                                      
                                                         ρ
                                                         j
                                                      
                                                      −
                                                      
                                                         m
                                                         i
                                                      
                                                      )
                                                   
                                                   2
                                                
                                                ]
                                             
                                             /
                                             
                                                ∑
                                                j
                                             
                                             
                                                H
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Sums are taken over the range of j-values in the peak region.

We aim at detecting a final peak accurately and robustly by considering various uncertainty. We compute θpeak
                      and ρpeak
                      of the peak by using fitting and interpolation techniques. Regarding fitting, we fit a second-order curve with the variances of the columns in the chosen peak region; the θpeak
                     -value is defined by minimizing the fitted function. We also fit a sine-curve with the means of those columns in the peak region; the ρpeak
                      value is computed by interpolating the sine-curve at the obtained θpeak
                     -value.

In a peak region, the θpeak
                        -value is located at a coordinate where voting is “most clustered”. The variance σ
                        2 is selected for measuring the degree of voting scatter of a column. The closer to the peak the column is, the more clustered the voting is, and the smaller the variance is. The θpeak
                        -value would be located where σ
                        2 takes its minimum.

The θpeak
                        -value with subcell accuracy is computed by fitting a second-order curve to these variances, and by minimizing the fitted function.

We calculate the variances 
                           
                              σ
                              i
                              2
                           
                         for each θi
                         column in the peak region. Fit a second-order function f, depending on θi
                        , with the estimated 
                           
                              σ
                              i
                              2
                           
                         values as follows:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             f
                                             :
                                             
                                                σ
                                                2
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             f
                                             (
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ≜
                                       
                                       
                                          
                                             
                                                a
                                                2
                                             
                                             ·
                                             
                                                θ
                                                2
                                             
                                             +
                                             
                                                a
                                                1
                                             
                                             ·
                                             θ
                                             +
                                             
                                                a
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Compute θpeak
                         where f has its minimum:

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             θ
                                             
                                                p
                                                e
                                                a
                                                k
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                θ
                                                |
                                             
                                             
                                                f
                                                ′
                                             
                                             
                                                (
                                                θ
                                                )
                                             
                                             =
                                             0
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             −
                                             
                                                a
                                                1
                                             
                                             /
                                             
                                                (
                                                2
                                                ·
                                                
                                                   a
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

A result is illustrated in Fig. 4. The quantization resolution of the Hough space is set to 
                           
                              
                                 (
                                 Δ
                                 θ
                                 ,
                                 Δ
                                 ρ
                                 )
                              
                              
                              =
                              
                              
                                 (
                                 
                                    2
                                    ∘
                                 
                                 ,
                                 2
                                 p
                                 )
                              
                           
                        . First, an initial peak λ is detected at 
                           
                              (
                              θ
                              ,
                              ρ
                              )
                              =
                              (
                              16
                              ,
                              −
                              22
                              )
                           
                         following the described peak-finding method. Then, 
                           
                              σ
                              i
                              2
                           
                        -values of columns in the peak region are computed, and a second-order curve is fitted to those values; the minimum of the curve is at 
                           
                              
                                 θ
                                 
                                    p
                                    e
                                    a
                                    k
                                 
                              
                              =
                              17.15
                           
                         of subcell accuracy.

The functional relation between the mean m and θ is a sine curve. We calculate the means for each θi
                         column in the peak region and fit a sine curve. A final ρpeak
                         is computed by interpolating this curve at θpeak
                        .

First, compute means mi
                         according to Eq. (7), for each column in the peak region. Fitting a sine curve g with the computed statistical means mi
                         may be performed as follows: The sine curve is a nonlinear function. Fitting directly a sine curve is difficult; thus we fit it by using the following transform
                           1
                        
                        
                           1
                           If π/4 < θ < 3π/4, then apply an alternative transform as follows: 
                                 
                                    m
                                    =
                                    
                                       x
                                       c
                                    
                                    ·
                                    cos
                                    θ
                                    +
                                    
                                       y
                                       c
                                    
                                    ·
                                    sin
                                    θ
                                 
                               and 
                                 
                                    m
                                    /
                                    
                                       sin
                                       θ
                                    
                                    =
                                    
                                       x
                                       c
                                    
                                    ·
                                    cot
                                    θ
                                    +
                                    
                                       y
                                       c
                                    
                                 
                              .
                        :

                           
                              (11)
                              
                                 
                                    
                                       
                                          m
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                x
                                                c
                                             
                                             ·
                                             cos
                                             θ
                                             +
                                             
                                                y
                                                c
                                             
                                             ·
                                             sin
                                             θ
                                          
                                       
                                    
                                    
                                       
                                          
                                             m
                                             /
                                             
                                                cos
                                                θ
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                y
                                                c
                                             
                                             ·
                                             tan
                                             θ
                                             +
                                             
                                                x
                                                c
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We see that m/cos θ and tan θ are in a linear relation. Now, for these pairs (mi
                        /cos θi
                        , tan θi
                        ), we fit a linear function

                           
                              (12)
                              
                                 
                                    
                                       
                                          
                                             g
                                             :
                                             m
                                             /
                                             
                                                cos
                                                θ
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             g
                                             (
                                             tan
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ≜
                                       
                                       
                                          
                                             
                                                b
                                                1
                                             
                                             ·
                                             tan
                                             θ
                                             +
                                             
                                                b
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Altogether, we compute ρpeak
                         by interpolating the fitted sine function corresponding to θpeak
                         as follows:

                           
                              (13)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             
                                                p
                                                e
                                                a
                                                k
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             g
                                             
                                                (
                                                tan
                                                
                                                   θ
                                                   
                                                      p
                                                      e
                                                      a
                                                      k
                                                   
                                                
                                                )
                                             
                                             ·
                                             cos
                                             
                                                θ
                                                
                                                   p
                                                   e
                                                   a
                                                   k
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                b
                                                1
                                             
                                             ·
                                             sin
                                             
                                                θ
                                                
                                                   p
                                                   e
                                                   a
                                                   k
                                                
                                             
                                             +
                                             
                                                b
                                                0
                                             
                                             ·
                                             cos
                                             
                                                θ
                                                
                                                   p
                                                   e
                                                   a
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        A result is illustrated in Fig. 5
                        . First, the computed mi
                        -values are used for fitting a sine curve. Then, the ρpeak
                        -value is computed by interpolating this sine curve. In the shown example, the interpolated ρpeak
                        -value equals 
                           
                              −
                              21.72
                              ,
                           
                         and this is again at subcell accuracy. The final normal parameter (θpeak, ρpeak
                        ) of the line segment is calculated as being 
                           
                              (
                              17.15
                              ,
                              −
                              21.72
                              )
                           
                        .

We calculate the endpoint coordinates of a line segment, called left endpoint
                     
                        
                           
                              p
                              l
                           
                           =
                           
                              (
                              
                                 x
                                 l
                              
                              ,
                              
                                 y
                                 l
                              
                              )
                           
                        
                      and right endpoint
                     
                        
                           
                              p
                              r
                           
                           =
                           
                              (
                              
                                 x
                                 r
                              
                              ,
                              
                                 y
                                 r
                              
                              )
                           
                        
                     . Left and right can be defined by viewing toward the origin at the perpendicular point; see Fig. 6
                     .

According to the equation of the HT, if the left endpoint votes for two different cells (θ
                     1, ρ
                     1) and (θ
                     2, ρ
                     2), the coordinates of the left endpoint can be computed directly by solving the equational system

                        
                           (14)
                           
                              
                                 
                                    
                                       
                                          ρ
                                          1
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          x
                                          ·
                                          cos
                                          
                                             θ
                                             1
                                          
                                          +
                                          y
                                          ·
                                          sin
                                          
                                             θ
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (15)
                           
                              
                                 
                                    
                                       
                                          ρ
                                          2
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          x
                                          ·
                                          cos
                                          
                                             θ
                                             2
                                          
                                          +
                                          y
                                          ·
                                          sin
                                          
                                             θ
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     Taking the appearance of image noise, pixel disturbance, parameter quantization, and peak spreading into account, we compute the coordinates of endpoints by fitting more cells rather than using two equations only; we calculate 
                        
                           ρ
                           i
                           
                              m
                              i
                              n
                           
                        
                      and 
                        
                           ρ
                           i
                           
                              m
                              a
                              x
                           
                        
                      using statistical properties instead of searching for the first and last non-zero voting cells.

In each column, the first and the last non-zero voting cell contain votes of the line’s endpoints. These cells also corresponds to the maximum voting ρ-value ρmax
                         and the minimum voting ρ-value ρmin
                         in each column.

Due to various uncertainties, a direct search for the first and the last non-zero cell is difficult and inaccurate. We calculate those cells by using statistical mean mi
                         and statistical variance σi
                        .

In the θi
                         column, because Ri
                         is a random variable with uniform distribution from 
                           
                              ρ
                              i
                              
                                 m
                                 i
                                 n
                              
                           
                         to 
                           
                              
                                 ρ
                                 i
                                 
                                    m
                                    a
                                    x
                                 
                              
                              ,
                           
                         the statistical mean and variance are equal to the following:

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             m
                                             i
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             (
                                             
                                                ρ
                                                i
                                                
                                                   m
                                                   a
                                                   x
                                                
                                             
                                             +
                                             
                                                ρ
                                                i
                                                
                                                   m
                                                   i
                                                   n
                                                
                                             
                                             )
                                             /
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             σ
                                             i
                                             2
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      ρ
                                                      i
                                                      
                                                         m
                                                         a
                                                         x
                                                      
                                                   
                                                   −
                                                   
                                                      ρ
                                                      i
                                                      
                                                         m
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                2
                                             
                                             /
                                             12
                                          
                                       
                                    
                                 
                              
                           
                        Given values mi
                         and 
                           
                              
                                 σ
                                 i
                                 2
                              
                              ,
                           
                         the voting range boundaries 
                           
                              ρ
                              i
                              
                                 m
                                 a
                                 x
                              
                           
                         and 
                           
                              ρ
                              i
                              
                                 m
                                 i
                                 n
                              
                           
                         can be computed as follows:

                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             i
                                             
                                                m
                                                a
                                                x
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                m
                                                i
                                             
                                             
                                             +
                                             
                                             
                                                3
                                             
                                             
                                                σ
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             ρ
                                             i
                                             
                                                m
                                                i
                                                n
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                m
                                                i
                                             
                                             
                                             −
                                             
                                             
                                                3
                                             
                                             
                                                σ
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        This avoids a search for the first and the last non-zero voting cells in each column.

Considering the columns left of a peak, 
                           
                              ρ
                              i
                              
                                 m
                                 a
                                 x
                              
                           
                         or 
                           
                              ρ
                              i
                              
                                 m
                                 i
                                 n
                              
                           
                         are selected to compute the left or right endpoint, respectively. Contrary, in columns right of a peak, 
                           
                              ρ
                              i
                              
                                 m
                                 a
                                 x
                              
                           
                         or 
                           
                              ρ
                              i
                              
                                 m
                                 i
                                 n
                              
                           
                         are used to compute the right and left endpoint, respectively.

For the left endpoint computation, in every θi
                         column,

                           
                              (20)
                              
                                 
                                    
                                       ρ
                                       i
                                       l
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   ρ
                                                   i
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                   
                                                      θ
                                                      i
                                                   
                                                   <
                                                   
                                                      θ
                                                      
                                                         p
                                                         e
                                                         a
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ρ
                                                   i
                                                   
                                                      m
                                                      i
                                                      n
                                                   
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        For the right endpoint computation, in every θi
                         column,

                           
                              (21)
                              
                                 
                                    
                                       ρ
                                       i
                                       r
                                    
                                    :
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   ρ
                                                   i
                                                   
                                                      m
                                                      i
                                                      n
                                                   
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   
                                                   
                                                      θ
                                                      i
                                                   
                                                   <
                                                   
                                                      θ
                                                      
                                                         p
                                                         e
                                                         a
                                                         k
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ρ
                                                   i
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        We select the set of all pairs 
                           
                              (
                              
                                 θ
                                 i
                              
                              ,
                              
                                 ρ
                                 i
                                 l
                              
                              )
                           
                         in the peak region to fit a sine curve

                           
                              (22)
                              
                                 
                                    ρ
                                    =
                                    
                                       x
                                       l
                                    
                                    ·
                                    cos
                                    θ
                                    +
                                    
                                       y
                                       l
                                    
                                    ·
                                    sin
                                    θ
                                 
                              
                           
                        As discussed above, ρ/cos θ and tan θ are in a linear relationship. Again, we fit to those pairs 
                           
                              (
                              
                                 ρ
                                 i
                                 l
                              
                              /
                              cos
                              
                                 θ
                                 i
                              
                              ,
                              tan
                              
                                 θ
                                 i
                              
                              )
                           
                         a linear function

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             h
                                             :
                                             ρ
                                             /
                                             
                                                cos
                                                θ
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             h
                                             (
                                             tan
                                             θ
                                             )
                                          
                                       
                                    
                                    
                                       
                                          
                                       
                                       
                                          ≜
                                       
                                       
                                          
                                             
                                                c
                                                1
                                             
                                             ·
                                             tan
                                             θ
                                             +
                                             
                                                c
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Based on Eqs. (22) and (23), the endpoint coordinates are then given by 
                           
                              
                                 x
                                 l
                              
                              =
                              
                                 c
                                 0
                              
                           
                         and 
                           
                              
                                 y
                                 l
                              
                              =
                              
                                 c
                                 1
                              
                           
                        . Similarly, the right endpoint can be computed by fitting all 
                           
                              ρ
                              i
                              r
                           
                         and θi
                         values.

Due to various uncertainty, the endpoints computed above are not expected to be exactly on the line. They need to be projected onto the line defined by normal (θpeak, ρpeak
                        ). This is illustrated in Fig. 7
                        . We do as follows:

                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                l
                                                ′
                                             
                                             =
                                             
                                                x
                                                l
                                             
                                             −
                                             
                                                (
                                                
                                                   y
                                                   l
                                                
                                                ·
                                                sin
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                +
                                                
                                                   x
                                                   l
                                                
                                                ·
                                                cos
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                −
                                                ρ
                                                )
                                             
                                             ·
                                             cos
                                             θ
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                l
                                                ′
                                             
                                             =
                                             
                                                y
                                                l
                                             
                                             −
                                             
                                                (
                                                
                                                   y
                                                   l
                                                
                                                ·
                                                sin
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                +
                                                
                                                   x
                                                   l
                                                
                                                ·
                                                cos
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                −
                                                ρ
                                                )
                                             
                                             ·
                                             sin
                                             θ
                                          
                                       
                                    
                                 
                              
                           
                        and

                           
                              (26)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                r
                                                ′
                                             
                                             =
                                             
                                                x
                                                r
                                             
                                             −
                                             
                                                (
                                                
                                                   y
                                                   r
                                                
                                                ·
                                                sin
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                +
                                                
                                                   x
                                                   r
                                                
                                                ·
                                                cos
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                −
                                                ρ
                                                )
                                             
                                             ·
                                             cos
                                             θ
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (27)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                r
                                                ′
                                             
                                             =
                                             
                                                y
                                                r
                                             
                                             −
                                             
                                                (
                                                
                                                   y
                                                   r
                                                
                                                ·
                                                sin
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                +
                                                
                                                   x
                                                   r
                                                
                                                ·
                                                cos
                                                
                                                   (
                                                   θ
                                                   )
                                                
                                                −
                                                ρ
                                                )
                                             
                                             ·
                                             sin
                                             θ
                                          
                                       
                                    
                                 
                              
                           
                        where θ and ρ are the calculated normal angle and distance of the line segment, respectively, as computed in Section 4.

@&#EXPERIMENTAL RESULTS@&#

We test the proposed line-segment detection method on a set of simulated data for evaluating the accuracy of line-segment detection, and on real-world images to verify the performance of line-segment detection.

We generate a set of 200 × 200 binary images that contain line segments and noisy pixels, both generated randomly. Line parameters (θ, ρ) are recorded as the ground truth. Pixels on the generated line segment are moved randomly perpendicularly to the segment in order to simulate pixel disturbance. For the discrete Hough space we use different quantization resolutions. We select the image center as the coordinate origin. Two examples for line-segment detection are shown in Fig. 8
                        .

Each pixel votes for all possible cells in the Hough space. After voting, the normal parameters of the line segment are detected using the proposed method, as well as using a few other line-detection methods based on the Hough transform.

In order to test the detection accuracy, we compare the detection results obtained with the proposed statistical method for line segment detection (SLS), with results obtained by applying a standard HT (SHT) which just considers the initial peak as the line parameters, a method using smoothing and interpolation (SI) as discussed in [22], and least-squares fitting (LSF) which fits pixels that are close to the line defined by parameters provided by the standard HT.

We test the methods in terms of different counts of noisy pixels, different quantization resolution, different pixel disturbance extent, and different peak spreading. Five hundred line segments have been generated randomly in 500 images. Error mean and error standard variance in detection results are reported in Table 1
                        , with an accuracy of two digits only. Symbols n, q, t, and d denote the count of random image pixels, the quantization resolution (Δθ, Δρ) of the Hough space, the line thickness, and the scale for pixel disturbance along the normal, respectively.

In order to illustrate experienced effects more clearly, we show individual detection results for the same 50 line segments each in separate figures. Fig. 9
                         shows the detection error under “common” conditions. Fig. 10
                         illustrates the detection error for an increase in noisy pixels. Fig. 11
                         shows the detection error under coarse parameter quantization. Fig. 12
                         illustrates the detection error for heavy peak spreading, and Fig. 13
                         the detection error for pixel disturbance.

The detection errors of the standard HT are the largest, and the results using LSF are the best when comparing the four methods mentioned above. The standard HT is sensitive to quantization error and image noise. The smoothing and interpolation method considers only a small amount of cells; the detection errors are large under coarse quantization and heavy image noise.

By using statistical characteristics of voting distribution for parameter fitting and interpolation, the proposed method for normal parameter detection can handle image noise, peak spreading, pixel disturbance as well as quantization noise. Detection results with the proposed method are actually close to results obtained by the least-square fitting technique under coarse quantization and in the presence of heavy image noise and pixel disturbance.

We use 300 simulated images of size 
                           
                              w
                              ×
                              h
                              =
                              200
                              ×
                              200
                              ,
                           
                         which contain one line-segment, under different conditions, like image noise, coarse quantization, pixel disturbance, or line thickness. Six methods for line-segment detection, the first two belonging to fast methods and the others belonging to the HT-based methods, are tested on the simulated images.

The detection errors are measured by the Euclidean distance between the detected endpoint coordinates and the ground truth. Table 2
                         lists the averaged detected errors of two endpoints under different conditions.

We also test six methods on simulated images containing multiple line segments. Fig. 14
                         shows the obtained results of six methods for the case of wide line segments. All the line segments are detected with the different methods. Fig. 15
                        
                        
                         shows the obtained results of six methods for the case of pixel disturbance, where collinear pixels on a line-segment are moved by a random distance into normal direction, with a random distance to the line segment up to 2. All the line segments are detected with the proposed method. The two fast methods do not work well, and are not robust with respect to pixel disturbance.

In terms of detection results of endpoints, the proposed method is accurate compared with the other five methods, for all the considered cases. LSD and EDlines are fast for line-segment detection, but detection results have a tendency to failure for the cases of image noise or pixel disturbance. They even cannot detect some line segments in the case of pixel disturbance. By fitting the endpoint coordinates with the statistical characteristics of voting in a column, the method is accurate and robust compared to the other methods for endpoint detection.

We discuss three applications which apply line detection. Lane detection is demonstrated at first using image sequence data. This is followed by horizon detection and vanishing point detection. We tested the proposed method for these three applications.

For illustrating results for lane detection (an important subject in autonomous driving or vision-based driver assistance), we use image sequences for testing, published in Set 3 of EISATS [43] and recorded in a driving car. One sequence contains 800 frames. When processing these images for line detection, images are first resized to 
                           
                              w
                              ×
                              h
                              =
                              320
                              ×
                              256
                           
                         (because this resolution proved to be sufficient), then the image center is selected as the coordinate origin. The quantization resolution is set to (Δθ, Δρ) = (2°, 2p).

We also show obtained results when using OpenCV functions (cvCanny and cvHoughLines2). The quantization resolution is set to (Δθ, Δρ) = (1°, 1p). The threshold for the shortest line-segment length is set to 100.

Lane detection results for four images of this data set are shown in Fig. 16. For the proposed method and the OpenCV line finder, the mean computation time per input image is 20.8 ms and 26.1 ms, respectively, on an Intel CPU with 1.4 GHz. The results obtained with the proposed method are similar to results with the popular OpenCV line finder.

With the proposed statistical method for line segment detection, not only the directions of lane markings but also the endpoints of the lane markings are detected. The detected endpoint coordinates are accurate even under a coarse quantization resolution.

For horizon detection (a problem often occurring when dealing with maritime video data), an image is processed with the Canny edge detector, and only the longest line is extracted with the proposed method. See Fig. 17 for three examples. The method detects the horizon robustly (e.g. also in spite of sea surface waves) as long as it is specified by the longest line segment (otherwise a more detailed analysis is required).

For vanishing point detection, we tested on the images in the York Urban DataBase [44]. For example, Fig. 18
                        
                         shows the common crossing point which results from the projection of 8 parallel lines on the facade. There exist many disturbances in images of the data base, but our method still identifies the vanishing point. See the next section for more experiments with this database.

In order to validate the proposed method for line segment detection, we use images of real scenes published in the York Urban Line Segment Database [44]. The database contains images of indoor or outdoor scenes. Line segments being consistent with the Manhattan model (i.e. horizontal or vertical lines only, assuming some kind of cuboidal scene, as often the case for images showing buildings) are manually labelled in each image, and line segment coordinates are provided. Note that manual labelling comes with some uncertainty, and that some line segments (e.g. diagonal in the scene) are not labelled at all because not matching the Manhattan model.

We detect line segments in images of the database and compare them with the provided ground truth. We apply at first the Canny edge detector and then the proposed method for line-segment detection.

For an image of an indoor scene, see Fig. 19. Here, 30 line segments are extracted with the proposed method. The normal parameters and endpoint coordinates of line segments are recorded for comparison. For the shown example, the database provides 41 manually labelled line segments; the given ground truth are the labelled endpoints. The proposed method does not extract all the line segments manually labelled in the database, and extracts also line segments which do not follow the Manhattan model.

From all the detected and labelled line segments shown in the example in Fig. 19, there are 21 line segments that are both extracted and also labelled. Table 3
                         contains the detected line-segment parameters, the labelled line-segment parameters, and differences between those. Normal parameters of labelled line segments are computed based on labelled endpoints. When angle θ is close to 0° or 180° then there is a numerical instability in value θ and potentially a numerical inversion in value ρ. The last four columns contain differences in terms of the first endpoint, the second endpoint, normal parameter θ, and normal parameter ρ. The difference in endpoint coordinates is measured as the Euclidean distance between the detected and labelled endpoint. Differences of normal parameters θ and ρ are computed by considering values modulo 180°, and by considering numerical signs in value ρ.

For those line segments which are both detected and also labelled, Table 3 verifies the typical outcome that detected normal parameters (θ, ρ) differ very little from normal parameters that are calculated based on the provided ground truth for endpoints. Half of detected endpoints are very close to the corresponding labelled endpoints (i.e. with an expected Euclidean distance of less than 5).

For an example of an outdoor image, see Fig. 20
                        , top. Here, 13 line segments are extracted with the proposed method, and there are 28 hand-labelled line segments in the database for this scene. Detected and labelled line segments are shown in Fig. 20. There are 8 line segments that are both extracted and labelled; see Table 4 for parameter differences for those 8 line segments. Also for outdoor scenes, we have an expected Euclidean distance of less than 5 for about half of the compared endpoints, and differences in normal parameters are small (see table for typical values) for all compared segments.

This paper proposes a novel method for line segment detection in Hough space. The image center is selected as the origin of image coordinates. By analyzing the voting distribution around a peak in Hough space, a line-segment detection method is proposed by fitting and interpolating statistical characteristics of voting distributions in Hough space.

The voting in each column is considered to be a random variable, and voting values are considered as forming a probabilistic distribution. The normal angle and distance of a line segment are computed by fitting and interpolating the statistical means and statistical variances of a voting distribution. Endpoint coordinates of a line segment are computed by fitting a sine curve with maximum and minimum voting ρ-values in each column, rather than searching non-zero voting cells and solving two equations generated from just two cells. The proposed detection method for line segments is accurate and robust to image noise, pixel disturbance, and coarse quantization resolution.

@&#ACKNOWLEDGMENT@&#

The first author thanks Jiangsu Overseas Research & Training Program for University Prominent Young & Middle-aged Teachers and Presidents for granting a scholarship to visit and undertake research at The University of Auckland.

@&#REFERENCES@&#

