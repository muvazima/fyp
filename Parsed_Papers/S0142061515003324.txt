@&#MAIN-TITLE@&#Hybrid wind power balance control strategy using thermal power, hydro power and flow batteries

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We modelled hybrid power system with flow battery, hydro and thermal power plants.


                        
                        
                           
                           The forecasted and actual wind power data were used from Lithuanian power system.


                        
                        
                           
                           An optimal low-pass filter time constants are determined using objective function.


                        
                        
                           
                           Results depict the required power and capacity ratings of flow battery.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Flow battery

Power system balance

Wind farms

Wind power generation

@&#ABSTRACT@&#


               
               
                  The increased number of renewable power plants pose threat to power system balance. Their intermittent nature makes it very difficult to predict power output, thus either additional reserve power plants or new storage and control technologies are required. Traditional spinning reserve cannot fully compensate sudden changes in renewable energy power generation. Using new storage technologies such as flow batteries, it is feasible to balance the variations in power and voltage within very short period of time. This paper summarises the controlled use of hybrid flow battery, thermal and hydro power plant system, to support wind power plants to reach near perfect balance, i.e. make the total power output as close as possible to the predicted value. It also investigates the possibility of such technology to take part in the balance of the Lithuanian power system. A dynamic model of flow battery is demonstrated where it evaluates the main parameters such as power, energy, reaction time and efficiency. The required battery size is tested based on range of thermal and hydro power plant reaction times. This work suggests that power and energy of a reasonable size flow battery is sufficient to correct the load and wind power imbalance.
               
            

@&#INTRODUCTION@&#

During the past decade, the number of renewable energy sources has increased dramatically. It is forecasted that the growth of green energy generation will increase even further. Policy makers in developed countries create many incentives in favour of the development of low-carbon technologies and subsidise green energy generation. This should help to reduce carbon footprint and climate change. On the other hand, most of renewable energy comes from generators that are inherently very hard to control [1], thus it introduces further complexity in system balancing task.

Up to now in many cases wind turbines or solar panels are being connected to the grid with minimal control. Due to hardly predictable natural resources, like wind or solar irradiation, the errors between actual energy output and forecasted generation are relatively large. This increases the difficulty of the energy balance problem: corresponding operators need either more tools or new technologies to come in hand [2]. Increasing advanced spinning reserve to back up intermittent generation would require inadequate level of investment considering exponential growth of power generation using green technologies. Also, this type of reserve has limited power variation capabilities (in the order of minutes) whereas solar power output can drop nearly instantly. The alternative is to use new highly responsive storage technologies [3,4] that could be incorporated into the system and shave over-generation as well as generate energy when demand overtakes supply.

Lithuanian Power System (PS) and other Baltic States currently operate synchronously with IPS/UPS synchronous zone and are connected to BRELL power ring, which consists of Belarus, Russian, Estonian, Latvian, and Lithuanian power systems. According to BRELL regulations Baltic States are not required to have automatic secondary power control, however Baltic States are planning to synchronically connect to the power grid of Continental Europe in 2020. This means decentralisation of power system control and responsibility to maintain power and energy balance within strict boundaries [5]. Therefore, it is important to investigate the feasibility of Lithuanian PS to automatically maintain power balance.

National Renewable Energy Laboratory in USA focuses on researching economic feasibility of energy storage and clearly states that high penetration of variable generation increases the need for all flexibility options including storage [6]. They also note that the economic value of energy storage devices is at its best when selling to the entire grid, instead of any single source. However the role of storage for wind generation requires continuous analysis and additional studies including new techniques to evaluate more dynamic grid operation.

Droste-Franke et al. analysed German power system balancing options and concluded that technological progress is needed in the following areas. Firstly, grid expansion and inter-regional connectivity compensating regional shortages of supply from renewable sources in Europe. Secondly, load management could become feasible through technologies such as smart metering, and finally, storage capacities need to be extended [7]. They also conclude that interrupted renewable power smoothing using battery storage system [4,8] is the cheapest option at present.

Söder and Hamon investigate wind power capabilities to participate in balancing services. They conclude that wind power plants do not usually participate in balancing services because they must be set to produce less than they are capable in order to be used for up regulation [9]. Margins are kept by spilling the wind, which cannot be stored. A method is proposed to select a certain tertiary reserve control in order to minimise the total cost of the system and maintain stability of the power system with larger portions of wind power. This means that they deal with emergency power system operation modes while our proposed method covers secondary control reserve and optimal share of reserve power between different kinds of generation sources.

Lubosny and Bialek proposed wind farm supervisory control scheme which is suitable to control individual wind mill or separate wind farm in two different ways – using additional storage device or power reserve achieved through part-loading one or more turbines in a wind farm. Authors suggest using wind power filter in order to separate the variability of wind power. They also concluded that elimination of larger power variations can be done more effectively using a central or single energy storage [10]. Therefore our proposed control strategy differs due to the fact that it deals with central control of all wind farms instead of individual ones.

Jiang and Wang similarly to [10] suggest to control wind power plant using power filter. Additionally, they proposed the optimisation model of corresponding filter parameters. However, due to the uncertainty inherent in wind power generation, optimal control during long time periods has difficulties predicting wind power and is unpractical in actual real-time operation [11]. Besides it requires additional computational resources and time. Active power losses and state of charge of storage devices depend on wind power generation, therefore it is hard to maintain the proper charge level and mitigate wind power fluctuation. Authors conclude that two-time-scale coordination control method gives controversial results because the required battery power reaches 33% of installed wind power (in our case it reaches 5–25% depending on power system operation mode, discussed later in the paper) while the power fluctuation allowance is up to 10%. Finally, the capacity component of the battery dominates (comparing to power) which means that storage devices are controlled according to wind power trends. The control strategy proposed in this paper controls storage devices according to high frequency component of wind power imbalance and it allows reaching 100% power balance with reasonably lower ratings of storage device.

Abbey et al. suggests using filters and neural networks to control two different types or multiple storage devises [12]. It is novel and interesting method but too complex for wind power balancing purposes on real-time operation. In principle, multiple levels of storage is needed only in new areas such as island household networks with renewable sources or micro-grids while wind power integration to conventional power systems usually require only short-term storage because the trends of wind power imbalance could be compensated by thermal or hydro power plants in more economical way. Our proposed hybrid wind power balance control strategy composes of conventional generation and energy storage control from power system operator point of view, which means central control in more efficient manner.

Wang et al. studied operational reliability of power system with high wind power penetration [13]. They have concluded that energy storage systems dramatically increase reliability of systems with wind farms. Authors also analyse and show the required battery sizing for certain reliability index.

Khalid and Savkin proposed new semi-distributed storage configuration [14] and using model predictive control [15] identified the optimal capacity of battery energy storage system. However the purpose was to identify the optimal capacity only taking into account the system ramp rates while our paper also deals with installed power of energy storage, conventional power plants optimal control and active power reserve optimisation. In addition we have used actual wind data of 10days with a time step of one second instead of 1day and 10min time step. Yuan et al. proposed dual-battery energy storage system [16] which consist of two separate battery storage systems. One of them is suitable for positive error compensation where the other one is suitable for negative ones. They also proposed three indices for the assessment of the performance on wind power dispatchability which could be identified by using sequential Monte Carlo simulation. However the time step is one hour which means that little dynamic behaviour could be represented. The authors also do not introduce any optimisation task.

Ansari and Velusami have been investigating the dynamic stability of hybrid autonomous wind – diesel with battery energy storage system. They proposed dual mode linguistic hedge fuzzy logic controller [17] and have shown its advantages comparing to traditional fuzzy logic and PI controllers. Kalantar and Mousavi G. replaces less effective and high pollution diesel generator to more flexible and reliable microturbine with the addition of solar array system to earlier investigated one. In order to maximise power outputs of wind and solar power plants they proposed a model reference adaptive Lyapunov controller [18] and improve the system behaviour comparing to fuzzy logic and PID controllers. Latter Mousavi G. have adapted the proposed method to offshore wind and tidal hybrid system with microturbine and BESS [19]. The authors provide an in depth investigation/review of the autonomous rural hybrid system in literature [17–19], however the proposed methods are not suitable for wind integration to large power systems with conventional generation, therefore our paper deals with this issue. In addition, our paper represents the optimal wind balancing power allocation between conventional power plants and energy storage devices.

A feasibility study of hybrid solar-wind-battery system for remote location can be found in [20]. Although it shows that it is possible to replace diesel generators by 100% renewable energy, about 48.6% of energy is dumped due to lack of storage and energy management.

Traditional Automatic Generation Control (AGC) system calculates error of the control area and allocates the required regulating power plants. Then they participate in the system balance according to participation factors [21] in order to keep power system in balance. The participation factors are usually determined according to power plant’s parameters such as rate limits [22,23], available spinning reserve [24] or economic (cost) characteristics. There are many methods to determine them: major part of power is allocated to the cheapest power plant, the fastest response power plant [25] or combined [21] method. This paper describes energy management method for increasing the quality of wind energy output using conventional Thermal Power Plant (TPP), Hydro Power Plant (HPP) and Flow Batteries (FB).

More proposed ideas of balancing wind power intermittency using energy storage systems can be found in other publications [26–28]. In [3] authors show through simulation how flywheel ESS can be used for wind power smoothening.

In general the limits of power changing rate of TPP and HPP are quite different. The maximum load rate of TPP is about 2% of the installed unit capacity (per minute) while for HPP the maximum load rate could reach 100% of unit size (per minute). However it is impossible to perfectly match the area control error continuously in relation to variations in plants characteristics such as the system frequency, load or wind power plant output. The energy storage devices, such as flow batteries, could significantly improve the flexibility of the system control and reduce the power systems imbalances.

The following traditional transfer function of a classical hydraulic turbine could be expressed:
                        
                           (1)
                           
                              
                                 
                                    W
                                 
                                 
                                    H
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    Δ
                                    
                                       
                                          
                                             
                                                P
                                             
                                             
                                                m
                                             
                                          
                                       
                                       
                                          ‾
                                       
                                    
                                 
                                 
                                    Δ
                                    G
                                 
                              
                              =
                              
                                 
                                    1
                                    -
                                    
                                       
                                          T
                                       
                                       
                                          w
                                       
                                    
                                    s
                                 
                                 
                                    1
                                    +
                                    0.5
                                    
                                       
                                          T
                                       
                                       
                                          w
                                       
                                    
                                    s
                                 
                              
                           
                        
                     where 
                        
                           Δ
                           
                              
                                 
                                    
                                       P
                                    
                                    
                                       m
                                    
                                 
                              
                              
                                 ‾
                              
                           
                        
                      is the change in turbine mechanical power, 
                        
                           Δ
                           G
                        
                      is the change in gate position, and 
                        
                           
                              
                                 T
                              
                              
                                 w
                              
                           
                        
                      is the water time constant.

Equation shows how the turbine output power reacts to a change in position of gate. Fig. 1
                      clearly shows that the initial power output of hydraulic turbine is two times opposite the value when the gate is opened immediately. This is due to water inertia which is represented by 
                        
                           
                              
                                 T
                              
                              
                                 w
                              
                           
                        
                     . The complete response of hydraulic turbine in respect to gate step change can be seen in Fig. 1.


                     Fig. 2
                      is included in order to demonstrate the behaviour of main variables of HPP, when the gate position change is a ramp function during one second. It represents the main HPP parameters – head, power output and water velocity.

In order to get stable operation of HPP it is necessary to have permanent and temporary droop compensation when implementing the governors of the hydraulic turbine. The result is a governor with a high droop for fast speed deviations and a low droop for steady state [30].

The simplified transfer function of the steam turbine with only high pressure section and disclaimer of crossover piping in comparison to reheater could be expressed:
                        
                           (2)
                           
                              
                                 
                                    W
                                 
                                 
                                    Ts
                                 
                              
                              (
                              s
                              )
                              =
                              
                                 
                                    Δ
                                    
                                       
                                          T
                                       
                                       
                                          m
                                       
                                    
                                 
                                 
                                    Δ
                                    
                                       
                                          V
                                       
                                       
                                          CV
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    1
                                    +
                                    
                                       
                                          T
                                       
                                       
                                          RH
                                       
                                    
                                    
                                       
                                          F
                                       
                                       
                                          HP
                                       
                                    
                                    s
                                 
                                 
                                    (
                                    1
                                    +
                                    
                                       
                                          T
                                       
                                       
                                          CH
                                       
                                    
                                    s
                                    )
                                    (
                                    1
                                    +
                                    
                                       
                                          T
                                       
                                       
                                          RH
                                       
                                    
                                    s
                                    )
                                 
                              
                           
                        
                     
                  

It shows how turbine mechanical torque reacts to change of control valve position. 
                        
                           
                              
                                 T
                              
                              
                                 RH
                              
                           
                        
                      and 
                        
                           
                              
                                 T
                              
                              
                                 CH
                              
                           
                        
                      represent inertia time constant of the reheater and inlet steam chest while 
                        
                           
                              
                                 F
                              
                              
                                 HP
                              
                           
                        
                      shows the fraction of high steam pressure section. Also, 
                        
                           
                              
                                 T
                              
                              
                                 m
                              
                           
                        
                      is turbine mechanical torque and 
                        
                           
                              
                                 V
                              
                              
                                 CV
                              
                           
                        
                      is control valve position.

The turbine control function is similar to hydraulic turbine. However in order to get stable operation of thermal power plant, it is enough to implement governor with a 4–5% speed droop. So there is no need of two types of droop compensation compare to hydro power plant. On the other hand thermal power plant output highly depends on primary fuel system and boiler operation and control. Fig. 3
                      illustrates the power output change of TPP in respect to control mode.

In the boiler following mode the turbine control valves initiates the changes in generation, while in turbine following mode the changes in generation are implemented by combustion controller [31].

The typical power outputs of steam and hydraulic turbines are shown in Fig. 4
                     . Depending on the boiler type, the control mode and the size of the load change, the power output of thermal power plant night change significantly slower than illustrated. However hydraulic power plant output with a low head could be significantly faster than considered here.

Flow batteries, sometimes called redox batteries (i.e. oxidation and reduction reactions), are electrochemical systems, which are an alternative between the usual batteries and fuel cells [32]. Flow batteries could be charged as ordinary batteries and provide energy as long as charged electrolyte is supplied. The charging and discharging cycles are possible due to reversible electrochemical reaction between two electrolytes [33]. Conversely charged electrolyte is pumped through separate contours and reaction takes place in special ionic membrane as shown in Fig. 5
                      
                     [34].

The power of flow batteries depends on the surface area of the electrodes. It also depends on the quantity of the bi-pole electrodes. The capacity of flow battery could be increased by expanding the volume of the electrolyte reservoirs, thus increasing the amount of the electrolyte [35,36]. The modules of flow batteries are connected into groups in series to ensure the required voltage, but hydraulic circuits are connected in parallel in order to share electrolyte between groups, therefore the same charging level is ensured [37].

Some advantages of flow batteries are that they can operate in low temperature and pressure conditions. Also, the electrolyte could be discharged completely [38]. The electrochemical processes are very fast so the reaction time of the batteries is rather small (0.04–0.06s) and mostly depends on the operation of power electronics. Thus, flow batteries with power ratings in megawatt range could be very useful for power system balance. As it will be seen from the results of investigations the necessary power ratings of FB reaches tens of MW.

MATLAB Simulink software environment was chosen to model and simulate the system. The goal of this research is to investigate the potential of flow battery technology to serve as energy balancing tool. TPP and HPP are used to cover low and mid-frequency imbalances respectively, whereas FB acts on high frequencies thus a trade-off between conventional power plant equipment wear and required battery size can be observed. It is important to determine the required flow battery parameters (power and capacity ratings) in order to maintain balance in the power system. During this research a model of TPP, HPP and FB was proposed with a control strategy.

The proposed energy balancing method aims to reduce the imbalance of a virtually isolated electric power system. It consists of thermal power plant, hydro power plant, flow battery and a PI controller that mainly deals with the compensation of energy losses related to the flow battery charge/discharge cycle (Fig. 6
                        ). The model is designed to offer a tradeoff between equipment wear and the required size of the battery. As discussed later in the paper, bigger time constant in the low-pass filter (LPF) requires larger battery size and higher power ratings. The initial error is the difference between the actual power and the forecasted power:
                           
                              (3)
                              
                                 
                                    
                                       P
                                    
                                    
                                       error
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       act
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       f
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    error
                                 
                              
                           
                         is the initial error, 
                           
                              
                                 
                                    P
                                 
                                 
                                    act
                                 
                              
                           
                         is actual power and 
                           
                              
                                 
                                    P
                                 
                                 
                                    f
                                 
                              
                           
                         is forecasted power.

The error between the actual and forecasted generation is first fed through rate limiting low-pass filter. It cuts off mid and high frequencies and reduces TPP depreciation costs. Next, the error left after TPP, is fed through another low-pass filter with a slightly lower time constant. This separates the mid-frequency band, which then goes to the HPP as a control input. It is clear that HPP changed its power output according to mid-frequency variations. This technique extends the lifetime of the HPP servo equipment. Generally HPP cannot change its power output very fast due to physical limitations, such as slew rate of the servomechanism and water inertia, which might cause water hammer. Thus, HPP responds by adjusting its power output to compensate only mid-frequency component.

On the other hand, the error that is left (mainly consisting of high frequencies) is then fed to a storage device – a flow battery. The small time constant and high charge/discharge power handles high frequency power fluctuations and smoothens the total power output from the system. Due to the fact that flow battery has a cycle efficiency of about 85% [39], additional energy to compensate energy losses is required. This is done by the feedback loop that signals TPP and HPP to overcome the losses. The signal adds nearly constant power compensation.

The proposed model is designed so that the average charge in the battery stays around half of its capacity. This deviation in battery charge from half of the capacity is fed to the PI controller as the error i.e. the desired battery charge set point is half the battery size. The controller responds by signalling TPP and HPP to adjust its generation to maintain the charge of FB at the desired level. Again, the charge in FB fluctuates but on average battery charge is kept constant. This level is proposed to be half the total capacity of the battery to be able to equally compensate both energy shortage and surplus. Also, a switch is added to compensate battery losses only when the battery’s state of charge is below 50%. The operation of the battery is discussed in greater detail in Section ‘The results of proposed balancing technique’.

To sum up, the frequency spectrum of the initial imbalance is divided into three bands – low, mid and high. The lowest frequencies are handled by TPP, mid-frequencies are cancelled by HPP and what is left – high frequencies – using a flow battery storage device.

The main characteristics of flow batteries were estimated during the process of modelling the flow battery. The model does not take into account any electrochemical processes inside the cell nor the kinetic energy of the electrolyte itself. The main parameters considered were the limits of the power and energy 
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    min
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    max
                                 
                              
                              ,
                              
                                 
                                    E
                                 
                                 
                                    min
                                 
                              
                              ,
                              
                                 
                                    E
                                 
                                 
                                    max
                                 
                              
                              )
                           
                        , losses (efficiency) and reaction time. The main objective of the flow battery model was to simulate the response to power imbalance. When balancing wind power, the power to be balanced by the FB is determined as the difference between the initial error and power generated by TPP and HPP:
                           
                              (4)
                              
                                 
                                    
                                       P
                                    
                                    
                                       FBin
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       error
                                    
                                 
                                 -
                                 
                                    
                                       P
                                    
                                    
                                       TPP
                                    
                                 
                                 -
                                 P
                                 
                                    
                                       -
                                    
                                    
                                       HPP
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    FBin
                                 
                              
                           
                         is the power to be balanced by the flow battery, 
                           
                              
                                 
                                    P
                                 
                                 
                                    error
                                 
                              
                           
                         is the initial power imbalance, 
                           
                              
                                 
                                    P
                                 
                                 
                                    TPP
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    HPP
                                 
                              
                           
                         is power generated by thermal and hydro power plants correspondingly.

The main principle is to charge the battery when there is a surplus of energy and to discharge when the energy is scarce. This is depicted in Fig. 7
                        . As it can be seen from the model in Fig. 8
                        , power of flow battery should be kept within the interval 
                           
                              [
                              
                                 
                                    P
                                 
                                 
                                    min
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    max
                                 
                              
                              ]
                           
                        , and energy stored in the flow battery 
                           
                              
                                 
                                    E
                                 
                                 
                                    FB
                                 
                              
                           
                         should stay within the limits of 
                           
                              [
                              
                                 
                                    E
                                 
                                 
                                    min
                                 
                              
                              ,
                              
                                 
                                    E
                                 
                                 
                                    max
                                 
                              
                              ]
                           
                        . Controlling the flow battery’s charge and discharge rate should compensate the high frequency part of the wind power variation from forecasted profile.

Also, the relative cycle losses are equally divided into charging and discharging losses using the following formula:
                           
                              (5)
                              
                                 
                                    
                                       η
                                    
                                    
                                       one
                                       -
                                       way
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             cycle
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       L
                                    
                                    
                                       one
                                       -
                                       way
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       η
                                    
                                    
                                       one
                                       -
                                       way
                                    
                                 
                                 ,
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       L
                                    
                                    
                                       one
                                       -
                                       way
                                    
                                 
                                 =
                                 1
                                 -
                                 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             cycle
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    η
                                 
                                 
                                    one
                                    -
                                    way
                                 
                              
                           
                         is the efficiency of charging or discharging of the battery, 
                           
                              
                                 
                                    η
                                 
                                 
                                    cycle
                                 
                              
                           
                         is the total cycle efficiency and 
                           
                              
                                 
                                    L
                                 
                                 
                                    one
                                    -
                                    way
                                 
                              
                           
                         are the losses associated with either charging or discharging of the battery.

Some assumption were made while designing dynamic model of the flow battery:
                           
                              •
                              The total efficiency of the flow battery cycle is 
                                    
                                       
                                          
                                             η
                                          
                                          
                                             cycle
                                          
                                       
                                       =
                                       85
                                       %
                                    
                                  
                                 [39],

The inertia time constant is 0.06s (considering inertia of power electronics) [40],

The total discharge of the flow battery is allowed (
                                    
                                       
                                          
                                             E
                                          
                                          
                                             min
                                          
                                       
                                       =
                                       0
                                    
                                 ) [38].

A hydro turbine was used to compensate the imbalance in the system that is left after TPP. The turbine output power follows the load variation trend and aims to reduce the error. It also helps to compensate losses associated with the FB (see Section ‘Control strategy of hybrid power system’). The HPP was modelled in matlab using traditional governor controller/regulator popularly found in the literature and transfer functions [29]. In particular, a transfer function of hydro turbine is shown in Eq. (1) and the block diagram can be found in [30, p. 33]. The rest of the hydraulic turbine and speed regulator model parameters are given in Table 1
                        . These parameters are chosen to match Kruonis hydro pumped storage power plant in Lithuania.

The power to be balanced by the HPP is calculated using the following equation:
                           
                              (8)
                              
                                 
                                    
                                       P
                                    
                                    
                                       HPPin
                                    
                                 
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       TPPerror
                                    
                                 
                                 ×
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             hLPF
                                          
                                       
                                       s
                                       +
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    HPPin
                                 
                              
                           
                         is the power to be balanced by the HPP, 
                           
                              
                                 
                                    P
                                 
                                 
                                    TPPerror
                                 
                              
                           
                         is the power imbalance after TPP and the 
                           
                              
                                 
                                    T
                                 
                                 
                                    hLPF
                                 
                              
                           
                         is the time constant of the LPF related to hydro power plant.

Thermal transient process constrains and specific construction of thermal power plant could cause power to vary significantly slower than that of hydro power plant. It only follows the trend and does not reduce the error noticeably. Fig. 6 represents the whole system and contains TPP block. This block represents a general TPP model and has been created in Matlab according to model found in [29, p. 436].

The model of turbine consists of three cylinders: high pressure, intermediate and low pressure cylinders. Turbine is described with linear model and the transfer function of the turbine is:
                           
                              (9)
                              
                                 
                                    
                                       W
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             K
                                          
                                          
                                             H
                                          
                                       
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             CO
                                          
                                       
                                       )
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             R
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             K
                                          
                                          
                                             I
                                          
                                       
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             CO
                                          
                                       
                                       +
                                       
                                          
                                             K
                                          
                                          
                                             L
                                          
                                       
                                       )
                                    
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             SC
                                          
                                       
                                       )
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             R
                                          
                                       
                                       )
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             CO
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    K
                                 
                                 
                                    H
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    I
                                 
                              
                              ,
                              
                                 
                                    K
                                 
                                 
                                    L
                                 
                              
                           
                         – the power of high, intermediate and low pressure cylinders per units; 
                           
                              
                                 
                                    T
                                 
                                 
                                    SC
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    R
                                 
                              
                              ,
                              
                                 
                                    T
                                 
                                 
                                    CO
                                 
                              
                           
                         – time constants of steam chest, reheater and the crossover between intermediate and low pressure cylinders. Speed governor is modelled as a periodic link of servomotor and power change speed rate limiter which holds the speed within 
                           
                              
                                 
                                    V
                                 
                                 
                                    max
                                 
                              
                              ,
                              
                                 
                                    V
                                 
                                 
                                    min
                                 
                              
                           
                         values.

The linear mathematical model of the regulating processes of steam turbine speed governor, could be described as second order transfer function 
                           
                              
                                 
                                    W
                                 
                                 
                                    SG
                                 
                              
                           
                        : 
                           
                              (10)
                              
                                 
                                    
                                       W
                                    
                                    
                                       SG
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             RM
                                          
                                       
                                       )
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             SM
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    T
                                 
                                 
                                    RM
                                 
                              
                           
                         – time constant of speed relay, 
                           
                              
                                 
                                    T
                                 
                                 
                                    SM
                                 
                              
                           
                         – time constant of servomotor.

A block diagram of steam turbine can be found in [29, p. 426] and [31, p. 2]. The parameters of the turbine that was used for the investigation are presented in Table 2
                        .

Overall boiler model’s transfer function 
                           
                              
                                 
                                    W
                                 
                                 
                                    B
                                 
                              
                           
                        , as boiler’s pressure 
                           
                              
                                 
                                    p
                                 
                                 
                                    B
                                 
                              
                           
                         and fuel flow 
                           
                              
                                 
                                    m
                                 
                                 
                                    FL
                                 
                              
                           
                         ratio, when considering the constant steam mass flow from boiler:
                           
                              (11)
                              
                                 
                                    
                                       W
                                    
                                    
                                       B
                                    
                                 
                                 (
                                 s
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             e
                                          
                                          
                                             -
                                             
                                                
                                                   sT
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             B
                                          
                                       
                                       s
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             FL
                                          
                                       
                                       )
                                       (
                                       1
                                       +
                                       
                                          
                                             sT
                                          
                                          
                                             W
                                          
                                       
                                       )
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    T
                                 
                                 
                                    D
                                 
                              
                           
                         – fuel feed delay time constant, 
                           
                              
                                 
                                    T
                                 
                                 
                                    FL
                                 
                              
                           
                         – heat transfer inertia time constant to pipes during fuel burning and 
                           
                              
                                 
                                    T
                                 
                                 
                                    W
                                 
                              
                           
                         – inertia time constant of pipes for heat transfer to water and steam.

A block diagram from [31, p. 2] was used to create Matlab model. Boiler parameters used for the investigation are presented in Table 3
                        .

The power to be balanced by the TPP is calculated using the following equation:
                           
                              (12)
                              
                                 
                                    
                                       P
                                    
                                    
                                       TPPin
                                    
                                 
                                 =
                                 (
                                 
                                    
                                       P
                                    
                                    
                                       error
                                    
                                 
                                 +
                                 
                                    
                                       PI
                                    
                                    
                                       out
                                    
                                 
                                 )
                                 ×
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             tLPF
                                          
                                       
                                       s
                                       +
                                       1
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    TPPin
                                 
                              
                           
                         is the power to be balanced by the TPP, 
                           
                              
                                 
                                    P
                                 
                                 
                                    error
                                 
                              
                           
                         is the initial power imbalance, 
                           
                              
                                 
                                    PI
                                 
                                 
                                    out
                                 
                              
                           
                         is the output from the PI controller and the 
                           
                              
                                 
                                    T
                                 
                                 
                                    tLPF
                                 
                              
                           
                         is the time constant of the LPF related to TPP.

The actual data of wind farms installed in Lithuania was used in this research (Fig. 9
                     ). In this particular case, it is the forecasted data and the actual wind power data for the period of 1st to 10th of February 2014. The total installed capacity at that date was 222MW. The mean absolute percentage error (MAPE) of the forecasted wind power during the investigated period was 32% with a standard deviation (SD) of 61MW. A histogram of the initial errors can be seen in the results section. It should be noted that this period was chosen due to high variation in wind generation as well as high prediction mismatch in order to investigate wind balancing technique in extreme case.

In order to investigate the influence of the low-pass filters cut-off frequencies to the proposed balancing system, a sensitivity analysis of the low-pass filters time constants have been prepared. Thermal power plant low-pass filter time constant ranging from 0 to 10,000s (step of 500s) and hydro power plant low-pass filter time constant of 0–500s (step of 25s) have been tested. The main parameters of the proposed system, such as the required active power reserve and mean power rates of thermal and hydro power plants, also the required capacity and power ratings of flow battery have then been analysed.

The dependence of required TPP active power reserve, for different low-pass filter cut-off frequencies could be seen in Fig. 10
                        , while mean power is shown in Fig. 11
                        . The mean power of TPP could represent the total energy generated by the power plant as a regulating energy. It can be clearly seen from the figures that higher cut-off frequencies (lower low-pass filters time constants) increase active power reserve as well as regulating energy of the thermal power plant. It could also be noted that low-pass filter time constant of hydro power plant has minor influence on the thermal power plant specific parameters.

Different situation could be identified in respect to HPP specific parameters. Both the HPP low-pass filter time constant and TPP low-pass filter time constants have appreciable influence. The required active power reserve of HPP is shown in Fig. 12
                        , whereas Fig. 13
                         represents mean power of this type of plant.

Active power reserve of HPP increases when TPP low pas-filter parameter increases and HPP low pass-filter parameter decreases. It could be seen in Fig. 12.

A series of simulations of different low-pass filters time constants have also been run in order to get the flow battery specific parameters, in relationship with different cut-off frequencies. The required flow battery capacity and power range are represented in Figs. 14 and 15
                        
                         respectively. Flow battery required parameters, as shown in the figures, depend on both low-pass filters’ time constants. But the main influence is done by the one associated with HPP. As the parameter of HPP low-pass filter time constant increases, the flow battery specifications also increase. It can be noticed that the flow battery mean absolute power relationship to low-pass filters cut-off frequencies is also similar, and taken into account for the analysis.

One of the most important things in this sensitivity analysis is to identify the relationships of thermal and hydro power plants’ active power rates, which represent the intensity of power output variation of these power plants as well as the asset depreciation. Thermal power plant mean absolute power rate is represented in Fig. 16
                        .

The significant mean absolute power rate downfall was identified when thermal low-pass filter time constant increase. In order to show the better visibility the low-pass filer time constant of HPP was kept constant at 75s. However the full relationship on both filter parameters was assessed in the investigation.

Mean absolute power rate of HPP is shown in Fig. 17
                        . Similar results to TPP mean power rate relationship can be observed. A significant drop was identified when hydro power plant’s low-pass filter parameter increases. The TPP low-pass filter time constant was also kept constant at 5000s due to better visualisation of the dependency, while the relationship on both filter parameters was taken into account in this analysis.

Sensitivity analysis presented in the previous section has shown various dependencies of model parameters and relationships. It was identified that required active power reserve in conventional power plant increases as low-pass filter time constant decreases. However specific parameters of the flow battery have opposite relationship as well as active power rates and intensity of traditional power plants regulation. Optimal low-pass filters time constants and cut-off frequencies are investigated in this section.

Objective function was prepared in order to investigate the optimal parameters and the best operation of proposed balancing system:
                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                          
                                             min
                                             
                                             C
                                             =
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ×
                                             
                                                
                                                   P
                                                
                                                
                                                   TPPmax
                                                
                                             
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                             ×
                                             
                                                
                                                   P
                                                
                                                
                                                   HPPmax
                                                
                                             
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   3
                                                
                                             
                                             ×
                                             
                                                
                                                   P
                                                
                                                
                                                   TPPmean
                                                
                                             
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   4
                                                
                                             
                                             ×
                                             
                                                
                                                   P
                                                
                                                
                                                   HPPmean
                                                
                                             
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   5
                                                
                                             
                                             ×
                                             
                                                
                                                   R
                                                
                                                
                                                   TPP
                                                
                                             
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   6
                                                
                                             
                                             ×
                                             
                                                
                                                   R
                                                
                                                
                                                   HPP
                                                
                                             
                                             +
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   7
                                                
                                             
                                             ×
                                             
                                                
                                                   P
                                                
                                                
                                                   FBmean
                                                
                                             
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   8
                                                
                                             
                                             ×
                                             
                                                
                                                   P
                                                
                                                
                                                   FBmax
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   C
                                                
                                                
                                                   9
                                                
                                             
                                             ×
                                             
                                                
                                                   E
                                                
                                                
                                                   FB
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    P
                                 
                                 
                                    TPPmax
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    HPPmax
                                 
                              
                           
                         are required active power reserve of conventional power plants, 
                           
                              
                                 
                                    P
                                 
                                 
                                    TPPmean
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    HPPmean
                                 
                              
                           
                         represents mean absolute power generated by thermal and hydro power plants, 
                           
                              
                                 
                                    R
                                 
                                 
                                    TPP
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    HPP
                                 
                              
                           
                         are active power rates, 
                           
                              
                                 
                                    P
                                 
                                 
                                    FBmean
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    FBmax
                                 
                              
                           
                         and 
                           
                              
                                 
                                    E
                                 
                                 
                                    FB
                                 
                              
                           
                         are specific parameters of flow battery – active mean power, active power range and required capacity respectively. Finally 
                           
                              
                                 
                                    c
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    c
                                 
                                 
                                    3
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    c
                                 
                                 
                                    9
                                 
                              
                           
                         are relative price corresponding to each of previously mentioned parameters. Different price ratios were used in order to obtain optimal parameters and to avoid conflicts as the price is always controversial. Table 4
                         shows specific relative prices which were used in this investigation. The minimisation of objective function leads to identification of the optimal low-pass filter parameters and overall operation of proposed balancing system.

Results of low-pass filters time constants objective function are represented in Fig. 18
                        . The region of the minimum objective function could be seen with the parameters – TPP low-pass filter time constant 5000s and HPP low-pass filter time constant 75s. These values will be used in time domain simulations of wind power balancing.

The relationship of the low-pass filter parameters could be expressed:
                           
                              (14)
                              
                                 
                                    
                                       f
                                    
                                    
                                       c
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                       π
                                       τ
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    f
                                 
                                 
                                    c
                                 
                              
                           
                         is the filter cut-off frequency and 
                           
                              τ
                           
                         is the filter time constant.


                        Fig. 19
                         shows the initial imbalance of wind power and conventional power plants output generation as well as flow battery output in respect to signal frequency decomposition using identified optimal low-pass filter parameters. It can be clearly seen that low frequencies of initial wind power imbalance are covered by thermal power plant, while hydro power plant deals with mid-frequencies and the flow battery eliminates high frequencies.

The simulations were run using the chosen optimal time constants of 5000s and 75s for TPP and HPP correspondingly and the data from Fig. 9. The results are shown in Fig. 20
                        . It includes the initial power system imbalance, difference after both TPP and HPP and final imbalance as well as the operating power of TPP, HPP and FB. After the addition of TPP, the initial imbalance SD dropped from 19.5MW to 9.2MW. Similarly after the addition of HPP, system imbalance improved to SD of 1.65MW. Finally, after FB the SD of imbalances were 0.1MW. Fig. 21
                         shows the histogram of initial imbalances in green, imbalances after the TPP in red and imbalances after HPP in blue. From the same graph it can be observed how the spread of imbalances decrease while propagating through the system. It should be noted that addition of TPP and HPP gave positive results and, the mean over-generation of TPP and HPP is equal to mean losses in FB (about 80kW). This justifies the validity of the model.

The top part of Fig. 20 shows a three day simulation period. This period is enough to demonstrate the performance of the system and the nature of TPP and HPP output. The middle part of the diagram also shows a magnified portion of errors (between the time of 12:00 and 13:00h of the first day) and, it can be seen how the HPP power tracks the trend of the imbalance after TPP. On the other hand, the bottom part of the graph shows how FB follows the imbalance after HPP and the graph in red is the final imbalance (time from 12:00 to 12:30 of the first day). The MAPE has now dropped to 0.068%.

During the investigation, the required power and energy of the flow battery was determined to be 55MW and 1.90MWh respectively. This is about 66.4% of the mean wind power during the investigated period and about 24.9% of the total installed wind power capacity in the Lithuanian power system (the total wind power is about 222MW). A more detailed discussion on why the required FB ratings might be chosen lower can be found in Section ‘Limiting the maximum required FB power’. Overall, these results can be considered as feasible for implementation.


                        Fig. 22
                         shows the charge level and accumulative losses in the FB during the simulated period. The required battery size is recorded to be 1.90MWh. This is the total required capacity in a perfect balance situation. If some power and energy spikes were ignored, the required battery power and size would be considerably lower. To cover the spikes, a super capacitor could potentially be used to serve the required ultra short term power.

Considering the SD of power to be balanced by the FB and the three-sigma rule it is reasonable to limit the installed FB power because high power is required during a negligible amount of time. This section discusses the trade-off between FB power rating and the final balance of power.

The data from simulations was extracted to calculate the balanced portion of energy depending on battery power and low-pass filter time constants (Fig. 23
                        ). The graph shows the FB power and capacity ratings needed to balance different portions of initial energy.

As it can be seen from Fig. 23, when 99.7% of energy is balanced, the required FB maximum power is about 14.1MW. That is a significant drop in the required FB power rating. The required capacity of the FB would also become 1.47MWh. On the other hand, this limits the power needed for balancing, which results in the increased final imbalance MAPE to 0.073% and a SD to 0.2MW, but is still quite small compare to initial values (32% and 19.5MW).

A further decrease in energy capture could be considered. The 95% would correspond to 4.1MW FB power limit and 0.88MWh required FB energy and would increase MAPE of final imbalance to 0.14% and SD to 0.58MW, but is still 43% amount of imbalance improvement compared to the value without hybrid system operation.

@&#CONCLUSIONS@&#

The proposed hybrid wind power balancing technique, using TPP, HPP and FB control strategy, presented positive results in balancing the wind power. It also generalises a technique to find the optimal ratings for a flow battery in the Lithuanian power system. However this method could be applied to other electric power systems as well. It might be particularly important to power systems, which operate in island mode.

In this paper, a series of simulations were carried out to identify the cut-off frequencies for the low-pass filters, which optimally controls the power output of thermal and hydro power plants. The optimal cut-off frequency identification enabled the estimation of the required flow battery power and capacity ratings. Also, the paper mainly focuses on the technical side of the method instead of looking at the economical value in detail.

After implementing the proposed control strategy for the TPP, the initial imbalance decreased by about 24% (from 32% MAPE to 24.36%). A further imbalance decrease was reached after the HPP was added – from 24.36% MAPE to 1.44%. After introducing flow batteries, the system became fully balanced. However, it required FB size of 1.9MWh and power of 55MW. This constitute to about 25% of the total installed wind power in the Lithuanian power system. Most of the FB’s power and capacity is required when the power system is in emergency state. It should be mentioned that such ratings were required when covering every moment in time.

On the other hand, these events are relatively rare, besides some types of flow batteries tolerate overloads for short periods without negative side effects. Making such assumptions the results of additional investigation showed that more reasonable flow battery ratings could be chosen. By covering 99.7–95% of the power imbalance, it is possible to reduce FB power rating by about 4–13 times and FB required capacity from about 23–54% (Tables 5 and 6
                     
                     ).

Many other storage technologies could be similarly modelled and investigated. In particular, high power and low capacity storage devices, such as super capacitors, could be added to compensate highest frequency imbalances thus highly improving results and reducing power requirements for the FB. Having many different power plants in the model it is then potentially useful to research control strategies in order to reach for the highest economical or environmental benefit.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to acknowledge the funding support from EPSRC via Faculty of Science and Technology, Lancaster University, UK. The authors would also like to thank the Department of Power Systems, Kaunas University of Technology, Lithuania and National Transmission System Operator in Lithuania for providing the necessary data. The data generated in this work are available from the Lancaster University data archive [41].

@&#REFERENCES@&#

