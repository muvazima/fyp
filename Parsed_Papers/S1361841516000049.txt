@&#MAIN-TITLE@&#Groupwise connectivity-based parcellation of the whole human cortical surface using watershed-driven dimension reduction

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Group-wise parcellation of the cortical surface.


                        
                        
                           
                           Clusters defined by homogeneous dMRI-based connectivity profiles.


                        
                        
                           
                           Parcellation of the whole cortex with an iterative patch by patch strategy.


                        
                        
                           
                           Clustering without any anatomical prior constraints.


                        
                        
                           
                           Complete validation on a new dataset of 79 healthy subjects.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Connectome

Clustering

Structural connectivity

Diffusion tensor imaging

@&#ABSTRACT@&#


               
               
                  Segregating the human cortex into distinct areas based on structural connectivity criteria is of widespread interest in neuroscience. This paper presents a groupwise connectivity-based parcellation framework for the whole cortical surface using a new high quality diffusion dataset of 79 healthy subjects. Our approach performs gyrus by gyrus to parcellate the whole human cortex. The main originality of the method is to compress for each gyrus the connectivity profiles used for the clustering without any anatomical prior information. This step takes into account the interindividual cortical and connectivity variability. To this end, we consider intersubject high density connectivity areas extracted using a surface-based watershed algorithm. A wide validation study has led to a fully automatic pipeline which is robust to variations in data preprocessing (tracking type, cortical mesh characteristics and boundaries of initial gyri), data characteristics (including number of subjects), and the main algorithmic parameters. A remarkable reproducibility is achieved in parcellation results for the whole cortex, leading to clear and stable cortical patterns. This reproducibility has been tested across non-overlapping subgroups and the validation is presented mainly on the pre- and postcentral gyri.
               
            

@&#INTRODUCTION@&#

Diffusion-weighted magnetic resonance imaging (DW-MRI) is a non-invasive technique providing in vivo information about human brain white matter fiber organization. Tractography algorithms allow the modeling of the white matter fiber organization exploring local orientation information. Cortical neurons are connected via such fibers, so that knowledge of the fiber tracts allows, in turn, the apprehension of the cortical areas according to their connectivity. The exploration of a large connectivity database, performed on macaque brains, showed that each cortical functional area has its own connectional fingerprint (Passingham et al., 2002). A connectivity-based structural parcellation seems therefore appropriate to extend the knowledge of the brain’s functional organization (Behrens and Johansen-Berg, 2005; Knösche et al., 2011). It should be noted that the expected results will probably be different from a parcellation from cytoarchitectonic information. Indeed, Brodmann areas are not necessarily homogeneous in terms of connectivity profiles.

Connectivity-based parcellation techniques rely on clustering methods, dividing an input cortical region into a set of areas according to the connectivity homogeneity (Cloutman and Ralph, 2012; de Reus and Van den Heuvel, 2013). Each anatomical element of the input region is associated to a connectivity profile, representing the weights of its connections with a set of target regions. In this context, there are different approaches regarding the nature and the number of input anatomical elements and target brain regions. Global blind methods compute the connectivity with each voxel of the whole brain (Johansen-Berg et al., 2004; Anwander et al., 2007; Tomassini et al., 2007; Beckmann et al., 2009; Mars et al., 2012). In these methods the targets used to characterize the connectivity profile of one anatomical element are voxels, and we will speak about voxel-based connectivity profile or voxel-based connectivity. Such methods have the advantage of avoiding prior information on the anatomical organization. However, they are difficult to extend to groupwise parcellation, because of the huge dimension of the connectivity profiles. Moreover, at the voxel level the interindividual anatomical variability is difficult to estimate. Indeed, there are multiple sources of variability of the connectivity data across subjects, including: the artifactual variability created by weaknesses of the tractography, imperfect spatial registration, and the actual anatomical variability of the functional regions and distribution of fibers inside each region. The second class of methods use predetermined target regions, based on anatomical or functional atlases facilitating groupwise parcellation (Jbabdi et al., 2009; Broser et al., 2011). In these methods, the targets used to construct the connectivity profile of one anatomical element are regions defined a priori, and we will speak about a priori region-based connectivity profile or a priori regional connectivity. However, this approach depends on the prior information used to define the target regions and has been applied to only limited brain regions such as the supplementary motor area and thalamus (Jbabdi et al., 2009). Nevertheless, it makes it easier to establish structure-function relationships.

The main contribution of this study is to propose and apply on a group of 79 subjects an alternative approach of group-wise connectivity-based human cortex parcellation, using an adaptive way to define the connectivity profiles. In terms of spatial resolution, our method is a trade-off between a priori regional connectivity and blind voxel-based connectivity approaches. Its originality is to define the target regions directly from the connectivity data, at the level of the group of subjects (Roca et al., 2010). For a given input region, these target regions are identified as being strongly connected to this input region in a reproducible way across subjects. In this context, we cannot directly parcellate the whole cortical surface in one step but we divide this surface into several patches of interest. We chose gyri as the base units for the parcellation in this study. The parcellation procedure thus proceeds with one gyrus at a time, and performs a whole brain parcellation by concatenating the per-gyrus results, but it could be applied to any other cortical segmentation defining regions on the cortical surface. Whereas the majority of methods are performed in the volume, our approach is based on a surface-based representation of the cortex, more adapted to its spherical topology. A surface-based registration of individual cortical surfaces, followed by a geodesic smoothing of connectivity data, is a first way to overcome cortical and connectional interindividual variabilities. A second complementary way consists in performing a group analysis defining the cortical target regions with reproducible connectivity to the input region.

Another aspect of this study was to validate the results on a new set of high quality data, the ARCHI database (Duclap et al., 2013; Assaf et al., 2013), composed of 79 healthy subjects. For this purpose, the method has been fully automated, parallelized and implemented in the BrainVisa framework (Geffroy et al., 2011), including a generic way to tune the parameters according to any starting region and type of tracking (deterministic or probabilistic). The reproducibility of the proposed method has been tested on several partitions of subjects with similarity metrics calculated on all gyri or on a subregion, in order to prove the high reproducibility and stability of the method.

The proposed method provides, at the level of the group of subjects, one connectivity-based parcellation of the whole cortical surface by concatenating results obtained from input patches. A flowchart of the groupwise parcellation method is shown in Fig. 1
                      and will be detailed step by step in the following sections.

The analyses were applied to the ARCHI database (Duclap et al., 2013; Assaf et al., 2013) composed of 79 subjects (32 females, mean age 23.65 years, SD = 5.16) with high quality T1-weighted images and diffusion data, acquired on a Magnetom TimTrio 3T MRI System (Siemens Healthcare, Erlangen, Germany). The MRI protocol used in this study included anatomical T1-weighted images at one millimeter isotropic spatial resolution, a B0 fieldmap to correct for susceptibility artifacts, and a high angular resolution diffusion imaging (HARDI) dataset along 60 optimized directions at a b value of 1500 s/mm2 with an isotropic spatial resolution of 1.7 × 1.7 × 1.7 mm3. The imaging parameters were as follows: T1-weighted data: 160 slices, FOV 256 mm, Phase FOV 93.8%, slice thickness, 1.1 mm, TE/TR
                           
                              
                              =
                              2.98
                           
                        /2300 ms, TI
                           
                              
                              =
                              900
                           
                         ms, FA = 9°, matrix 256 × 240, RBW = 240 Hz/pixel; diffusion data: 70 slices, field of view 220 mm, phase FOV 100%, slice thickness 1.7 mm, TE = 93 ms, TR = 14 s, flip angle FA = 90°, matrix 128 × 128, read bandwidth RBW = 1502 Hz/pixel, echo spacing ES = 0.75 ms, 1 excitation, partial Fourier factor PF = 6/8, parallel acceleration factor GRAPPA
                           
                              
                              =
                              2
                              ,
                           
                         total scan time 16 min 46 s.

In order to take into account the interindividual cortical variability, a surface-based registration was done to align the main cortical folds across subjects. From T1-weighted images, cortical surfaces have been extracted using FreeSurfer 5 (Dale et al., 1999; Fischl et al., 1999b). For each subject, the cortical surface of each hemisphere was defined as the gray/white matter interface. The main advantage of using FreeSurfer here is that it provides a point-to-point correspondence on the cortical surface across subjects, allowing direct group studies (Fig. 2
                              ). In addition, a first parcellation into gyri allows overcoming the computational complexity of a parcellation of the whole cortex (Desikan et al., 2006). For each subject, the resulting cortical surfaces of the right and left hemispheres were then merged to form what we will call the individual cortical surface. In practice, this surface is composed of a set of about 
                                 
                                    n
                                    =
                                    80
                                    ,
                                    000
                                 
                               nodes or vertices. In addition, for visualization purpose, a slightly inflated inter-subject average cortical surface was also created (Fischl et al., 1999a).

The HARDI dataset was processed using BrainVISA and Connectomist 2.0 (Duclap et al., 2012). It was first corrected for artefacts using a threefold strategy: a detection and correction of spikes and signal dropouts, a correction of the geometrical distortions induced by susceptibility effects using a further fieldmap calibration providing a non linear deformation to be applied along the phase axis, and a joint correction for eddy currents and motion for each diffusion-weighted volume (each diffusion direction was corrected using the rotation stemming from the rigid motion of each DW volume) (Dubois et al., 2014). Then the analytical Q-ball model (Descoteaux et al., 2007) was computed to obtain Orientation Diffusion Functions fields for all the subjects. A robust brain mask defining the main domain of propagation of fibers was computed using the approach of (Guevara et al., 2011) relying on a T1-weighted segmentation that does not involve the use of empirically thresholded fractional anisotropy maps. Finally a streamline probabilistic tractography was performed on the entire brain mask using a propagation step size of 0.4 mm and a dense sampling (27 seeds per voxel at the T1 image resolution) leading to, on average, 30 million fiber tracts per subject. To evaluate the robustness of the proposed method with regards to the input tractography algorithm, a deterministic streamline tractography was also performed with 27 seeds per voxel. Next, each tractography dataset was filtered in order to remove tracts shorter than 30 mm, representing approximately 20 percent of the overall fiber tracts. Below that threshold, the short fibers may be less dense and more diffuse than large association fibers. Thus we chose to only deal with major fibers, to avoid a possible source of bias. Finally, each subject has a set of about 25 million tracts.

The definition of the patches was based on the gyri segmentation computed using Freesurfer. This set of 70 gyri forms a partition of the whole cortical surface. In addition, we illustrated our method with two main patches corresponding to the pre- and postcentral gyri defined by Freesurfer (see Fig. 2). One additional study area was defined as the union of pre- and postcentral gyri, and called brain central region (BCR). In practice, pre- and postcentral patches are both composed of about 
                              
                                 m
                                 =
                                 2000
                              
                            vertices.

For each subject, the cortical connectivity matrix of each patch was computed using tractography results and its individual cortical surface by counting the fibers connecting vertices of the patch to all the other vertices of the cortical surface (Cathier and Mangin, 2006; Roca et al., 2010). In this process a k-d tree is used in order to quickly find for a given fiber point its nearest vertex on the cortical surface.

This matrix was then smoothed over the surface by solving the heat equation (equivalent to a Gaussian kernel of 3 mm). This smoothing, while preserving the total number of connections, accounts for a reasonable uncertainty on the tracking result, and ensures a better behavior with a small number of vertices in the input cortical surface. Moreover, it could help to stabilize the results for a smaller number of subjects in the group, by reducing the interindividual variability of the connectivity profiles. Thus a patch cortical connectivity matrix C
                           
                              g, s
                           , g ∈ [1, G], s ∈ [1, S] of shape (m × n) was obtained for each subject (see Fig. 1-Step 1). G denotes the number of patches and S is the number of subjects. m is the number of vertices in the processed patch, and n is the number of vertices in the cortical surface. In practice, the size of the patch connectivity matrix was approximately (
                              
                                 2000
                                 ×
                                 80
                                 ,
                                 000
                              
                           ) for the pre- or postcentral gyrus. The 
                              
                                 i
                                 th
                              
                            line of the patch connectivity matrix corresponds to the connectivity profile of the 
                              
                                 i
                                 th
                              
                            vertex of the patch, representing its connections with each vertex of the cortical surface (Fig. 3
                           ).

The objective of this part was to compress the cortical connectivity profiles in a way that maximizes the similarities across subjects. We projected the patch connectivity data of each subject onto a common sub-space, overcoming part of the inter-subject variability. In this context, the cortical connectivity profile of each vertex of the patch was reduced in four steps (Fig. 1. Step 1–4):

For each subject, the cortical connectivity profile of the patch P
                              
                                 g, s
                               was computed independently, e.g., by summing the cortical connectivity profiles over all patch vertices (or lines of the patch cortical connectivity matrix). This projection can be summarized as follows: 
                                 
                                    
                                       P
                                       
                                          g
                                          ,
                                          s
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          i
                                          =
                                          1
                                       
                                       m
                                    
                                    
                                       C
                                       i
                                       
                                          g
                                          ,
                                          s
                                       
                                    
                                    ,
                                 
                               where P
                              
                                 g,s
                               is a vector of size n and 
                                 
                                    C
                                    i
                                    
                                       g
                                       ,
                                       s
                                    
                                 
                               is the line i of C
                              
                                 g, s
                              . Each individual profile was thresholded to keep only vertices with at least 1% of the maximum connections value of the profile.

An intersubject mask is built by keeping vertices where at least one-half of the subjects possess a non-null value in the thresholded individual profile. The patch vertices are dropped from this mask in order to remove the internal connections. This mask is applied to these patch thresholded individual profiles. A joint patch cortical connectivity profile
                              
                                 
                                    P
                                    
                                       g
                                       r
                                       o
                                       u
                                       p
                                    
                                    g
                                 
                               was computed by summing these masked profiles over the subjects (Fig. 1. Step 2). This joint profile was then normalized by its total number of connections. For each patch, the resulting joint connectivity profile was mapped onto the average cortical surface (Fig. 4
                              ). A watershed was then computed on this profile in order to split the cortical surface into catchment basins (Roca et al., 2009). Small basins are agglomerated to larger ones based on their depth and area. In practice, we obtained around 10–20 basins or target regions. Each region catches a set of tracts supposed to connect the patch to a specific cortical area. This idea justifies the use of this set of regions to collapse the profiles in an optimal way regarding the connectivity variability. Indeed, as seen in Fig. 4, the regions with a strong connection to the input patch (appearing in the connectivity profile of each subject) do not match perfectly across subjects when they are mapped onto the average cortical surface: the vertex V
                              1 corresponds to a maximum of connection for subject 1, but not for the other subjects, where the maximum is spatially shifted. When these profiles are summed over the subjects, the previous regions are grouped together to form a unique region (see the average connectivity profile in Fig. 4). The watershed algorithm can then isolate this region as a single region (target region R
                              1 in Fig. 4 for example).

The previous joint target regions (basins) were used to reduce the dimension of the connectivity profiles (see Fig. 4). Indeed, for each subject independently, the columns of the cortical connectivity profile of each point (of size n) were collapsed using the watershed basins. Back projecting this information on the individual connectivity matrices reduces the dimensionality of the problem. Moreover, one part of the interindividual variability was then integrated inside these joint target regions. As illustrated in Fig. 4, the connectivity information resulting from each brain area represented by a catchment basin was summarized by one single weight. Local connectivity maxima with a reproducible location across the group of subjects (the 40 subjects of subgroup B1 here (as defined in Section 2.4.1)) are then merged in a single local maximum in the joint patch connectivity profile (third line, column 5). It is the case for the maxima belonging to the first nine cells of the grid, corresponding to the target region R
                              1 (1 local maximum for subject1, 2 maxima for the other subjects). On the contrary, local connectivity maxima not reproducible across subjects are ignored: the local maxima of subject2 on point V
                              2 (11th cell of the grid) is not comprised in a target region and will be ignored in the reduced connectivity profile (crossed area in the reduced connectivity profiles CR
                              ).

Therefore, the spatial shifts between connections across subjects inside each of these basins, resulting from the interindividual variability, are then integrated by the dimension reduction. For each subject, a reduced connectivity matrix 
                                 
                                    C
                                    
                                       reduced
                                    
                                    
                                       g
                                       ,
                                       s
                                    
                                 
                               with shape (m, n′), n′ < <n was obtained. n′ denotes the number of basins or target regions, the outcome of the watershed algorithm. In order to have comparable connectivity profiles between subjects, for each subject the individual connectivity profile of each vertex of the patch was normalized (L
                              1 norm). With this normalization, each individual connectivity profile represents the distribution of the connections between each target region, and does not depend on the number of tracts of the vertex: only the proportion of each connection in the total number of connections of the vertex is kept for each target region.

Using the point-to-point correspondence of the individual cortical surfaces, the individual reduced connectivity matrices were then averaged over the subjects, in order to obtain a joint patch connectivity matrix 
                                 
                                    
                                       C
                                       
                                          group,reduced
                                       
                                       g
                                    
                                    ,
                                 
                               reflecting the connectivity data at the level of the group of subjects. This step can be summarized as follows: 
                                 
                                    
                                       C
                                       
                                          group,reduced
                                       
                                       g
                                    
                                    =
                                    
                                       (
                                       1
                                       /
                                       S
                                       
                                          ∑
                                          
                                             s
                                             =
                                             1
                                          
                                          S
                                       
                                       
                                          C
                                          
                                             reduced
                                          
                                          
                                             g
                                             ,
                                             s
                                          
                                       
                                       )
                                    
                                 
                               of size (m, n′).

In order to parcellate the whole cortical surface, we performed the previous steps with the 70 gyri of Freesurfer segmentation as the input patches. The joint connectivity matrix of each gyrus was computed as described above. Each gyrus was then clustered using the classical k-medoids algorithm (PAM for Partition Around Medoids (Kaufmann and Rousseeuw, 1990)) applied to the Euclidean distance matrix between the joint connectivity profiles (Fig. 1-Step 5). For the whole cortex parcellation presented in this paper, we clustered each gyrus for different numbers of clusters: 2 to 
                              
                                 K
                                 max
                              
                           . 
                              
                                 K
                                 max
                              
                            was set equal to the surface area of the gyrus divided by 2 cm2. According to Van Essen and Dierker (2007), we expect clusters of 6 cm2 on average, so we chose a 
                              
                                 K
                                 max
                              
                            beyond this value. Finally, the number of clusters maximizing the average silhouette width (defined more precisely in Section 2.4.2) was chosen as the optimal one.

In order to validate the method, we evaluated the reproducibility of the results in two ways. First, we performed the group-wise connectivity-based parcellation on the whole cortex independently for two non-overlapping subgroups of subjects randomly chosen (40 subjects for A1 subgroup, and 39 subjects for A2 subgroup), forming a partition of our database.

Then, on a restricted subregion of the cortex (pre- and postcentral gyri), we proceeded further: we defined several partitions of the database into two subgroups (partition A with subgroups A1 and A2, partition B with subgroups B1 and B2, partition C with subgroups C1 and C2). In each partition, the first subgroup was built by randomly drawing without replacement 40 subjects out of 79 and the second subgroup, with the 39 remaining subjects. A comparison of the obtained parcellations across partitions can then be performed in order to evaluate the degree of stability of the cluster patterns.

In addition, we studied the influence of different parameters on the parcellation results (smoothing, number of clusters, tractography algorithm, and minimum fibertract length). The reproducibility was also tested in smaller groups of 10 subjects.

The optimal number of clusters was evaluated by computing the average silhouette width measure (Kaufmann and Rousseeuw, 1990). This criterion gives an idea of how the samples (here the connectivity profiles) in the same cluster are homogeneous, and well-separated from other clusters. For each sample, the silhouette width is calculated using the mean intra-cluster distance a from the given sample and the mean nearest-cluster distance b, and is defined as follows:

                              
                                 (1)
                                 
                                    
                                       s
                                       =
                                       
                                          
                                             b
                                             −
                                             a
                                          
                                          
                                             max
                                             (
                                             a
                                             ,
                                             b
                                             )
                                          
                                       
                                    
                                 
                              
                           where b is the average distance between a sample and the samples from the nearest cluster that the sample is not a part of.

The average silhouette width is the average of silhouette widths over all samples (here the connectivity profiles of all the vertices of a patch). The best value is 1 and the worst value is 
                              −
                           1. Values near 0 indicate overlapping clusters. Negative values generally indicate that a sample has been assigned to the wrong cluster.

We used different quantitative criteria to compare two parcellation results: the Dice coefficient and the Rand index. Unlike the average silhouette width, these measures reflect only the spatial consistency between the parcellations and do not compare the connectivity profiles.

The Dice coefficient between two clusters c
                              1 and c
                              2 is defined as the size of their intersection divided by the average of their sizes and compares the similarity of two clusters:

                                 
                                    (2)
                                    
                                       
                                          D
                                          =
                                          
                                             
                                                
                                                   2
                                                   |
                                                
                                                
                                                   c
                                                   1
                                                
                                                ∩
                                                
                                                   c
                                                   2
                                                
                                                
                                                   |
                                                
                                             
                                             
                                                
                                                   |
                                                
                                                
                                                   c
                                                   1
                                                
                                                
                                                   |
                                                   +
                                                   |
                                                
                                                
                                                   c
                                                   2
                                                
                                                
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

On our parcellations, the Dice coefficient was measured to compare the cluster c
                              1 of a subgroup and the similar cluster c
                              2 in the complementary subgroup.

The Rand index (RI) (Hubert and Arabie, 1985) computes a similarity measure between two clusterings by considering all pairs of samples and counting pairs that are assigned in the same or different clusters in the two clusterings. The raw Rand index score is then “adjusted for chance” using the following scheme:

                                 
                                    (3)
                                    
                                       
                                          A
                                          R
                                          I
                                          =
                                          
                                             
                                                (
                                                R
                                                I
                                                −
                                                e
                                                x
                                                p
                                                e
                                                c
                                                t
                                                e
                                                d
                                                R
                                                I
                                                )
                                             
                                             
                                                (
                                                m
                                                a
                                                x
                                                (
                                                R
                                                I
                                                )
                                                −
                                                e
                                                x
                                                p
                                                e
                                                c
                                                t
                                                e
                                                d
                                                R
                                                I
                                                )
                                             
                                          
                                       
                                    
                                 
                              The adjusted Rand index (ARI) is thus ensured to have a value close to 0 for random labeling independently of the number of clusters and samples and exactly 1 when the clusterings are identical.

@&#RESULTS@&#

First the results of the clustering pipeline will be presented on the entire cortical surface, followed by a validation procedure on the pre- and postcentral gyri as mentioned in Section 2.4.1.

We applied the parcellation method for all gyri to the two subgroups of partition A. The result is a unique connectivity-based parcellation for each subgroup. As shown in Fig. 5
                        -a, the clusters of subgroup A1 or A2 are well defined and spatially consistent: each cluster is made of a limited number of connected components (usually only one), and the boundaries are smooth. This whole brain result was obtained by clustering each input patch (FreeSurfer gyrus) independently. The optimal number of clusters was determined independently in each subgroup according to the average silhouette width (see Section 2.4.2). The number of clusters is the same in both subgroups for most gyri and for the entire cortex, we found 238 and 235 clusters for the subgroups A1 and A2 respectively. Fig. 5-(b–d) shows three regions where the parcellations of the subgroups A1 and A2 are particularly similar: there are the same number of clusters and they have the same arrangement. Indeed, average Rand index values of 0.62 and 0.65 were measured between the two subgroups of partition A across all gyri of the left hemisphere and of the right hemisphere respectively (Fig. 5).


                        Fig. 6
                         illustrates more precisely the case of the left postcentral gyrus on the subgroup A1. On this postcentral gyrus, the optimal number of clusters is 5 and each cluster is made of a unique connected component, is compact, and has smooth boundaries. The joint patch connectivity matrix (Fig. 6-c), reordered by cluster, shows that each cluster has an homogeneous connectivity profile, distinct from the others. The display of the Euclidean matrix between the reordered connectivity profiles ( Fig. 6-d) confirms this result: in this reordered matrix, the clusters form relatively well separated blocks. The differences in the connectivity profiles between the clusters are highlighted when displaying the reduced connectivity profiles of each cluster toward each of the 
                           
                              
                                 n
                                 ′
                              
                              =
                              17
                           
                         target regions (Fig. 6-a). The most connected target regions differ from one cluster to another and these differences can also be visualized at the level of the fiber tracts (Fig. 6-e).


                        Fig. 7
                         shows the results achieved on the pre- and postcentral gyri for three partitions of the database, for both hemispheres. On visual inspection, we can observe a striking stability between subgroups 1 and 2 of each partition A, B and C: the cluster borders and shapes are highly similar. The same observation was made in other parts of the brain as seen in Fig. 5 for the caudal middle frontal gyrus (b), the pars opercularis, pars triangularis and pars orbitalis (c) and the supra-marginal gyrus (d).

Moreover some consistent continuities in clusters boundaries could be seen between adjacent patches (Fig. 8
                        ) in each subgroup. Continuities are found at the same location across subgroups and partitions (red circles in Fig. 8). The same observation has also been found in other cortical regions, as illustrated across the pars opercularis, pars triangularis and pars orbitalis ( Fig. 5-c).

The Dice similarity coefficient (Section 2.4.3) was used to evaluate the spatial reproducibility of the parcellation on the left postcentral gyrus (Fig. 9
                        ). For each partition, the Dice coefficient was measured between paired clusters of both subgroups. Dice measurements were averaged across clusters, and across partitions leading to an average Dice coefficient of 88% for 
                           
                              K
                              =
                              5
                           
                         clusters. The Dice coefficient decreases when the number of clusters is increased from 
                           
                              K
                              =
                              5
                           
                         to 6. Similarly, for 
                           
                              K
                              =
                              5
                              ,
                           
                         the Rand index between subgroup clusterings averaged across partitions takes relatively high values (between 0.7 and 0.9), reflecting the good reproducibility of the parcellations (Fig. 10
                        ). In addition, the global Dice coefficient was calculated from the basins of the watershed between the subgroups for each partition, for the postcentral gyrus. Mean Dice coefficient of 0.88 were measured over all partitions.

In a supplemental validation experiment, the pre- and postcentral patches were merged before building the connectivity matrix, to form the brain central region (BCR, Fig. 11
                        -central column). In this way, the knowledge related to the frontier between the pre- and postcentral gyri was dropped. We performed the clustering on this new patch, and obtained an optimal number of clusters of 7 for this region according to the average silhouette width. When the results on the BCR are compared with those of the two juxtaposed gyri clustered independently (Fig. 11-left), the general pattern is found in both cases: the continuities in clusters boundaries and the consistent estimation of some clusters are reproduced and are highlighted in white on the BCR patch, and illustrated on (Fig. 11-right).

A few boundaries differences remained on the area overlapping both gyri. These differences in results may be explained by the loss of information on local connectivity, due to the removal of intra-patch fibers. For the clustering of the brain central region patch, this loss of data should especially affect connections between sensory and motor areas which have a significative influence on the clustering pattern. Indeed, when only the postcentral gyrus was parcellated, these connections between pre and post central gyri played a key role in the clustering, as several basins used to reduce the connectivity data are localized in the precentral gyrus (Fig. 6-a).

To validate the over-segmentation of this region compared to those obtained separately for the two gyri, a Euclidean distance between different clusters from the segmentation is calculated. To do this, the individual connectivity matrices of size m × n (see Section 2.3.2) are averaged across subjects in the same subgroup (1 or 2), using the same normalization procedure as in Section 2.3.3, step 3. The averaged profiles associated with K clusters from the parcellation of the group are added to form an average clusters connectivity matrix of size K × n. The three matrices thus calculated (one for the central region, one for the post central gyrus and for the precentral gyrus) are concatenated to obtain a single matrix of size 
                           
                              (
                              (
                              K
                              1
                              +
                              K
                              2
                              +
                              K
                              3
                              )
                              ×
                              n
                              )
                           
                         (K differs depending on the region). Finally, a matrix of size 
                           
                              (
                              (
                              K
                              1
                              +
                              K
                              2
                              +
                              K
                              3
                              )
                              ×
                              (
                              K
                              1
                              +
                              K
                              2
                              +
                              K
                              3
                              )
                              )
                           
                         containing the Euclidean distances between clusters profiles is calculated. Fig. 12
                         shows the distance matrices for subgroups 1 and 2 of the three partitions A, B and C. The distances between the clusters profiles are represented by a color palette truncated over 0.46 (this threshold is determined to keep the distances between clusters not belonging to the same starting area) from blue (short distance) to red (long distance): black cells represent distances too important for a match between clusters.

This matrix shows that clusters in the pre- or post-central gyrus which have a direct corresponding cluster in the central region have low distances with them. But clusters from the pre- and post-central gyri which get merged into one cluster in the central region also show low distances between them, and with the BCR corresponding cluster. This tends to demonstrate that the BCR clustering have merged regions with similar connectivity profiles. We can notice that there are very few outliers and that different clusters are reproducible between groups for each partition. The differences observed are often borderline cases (partial overlap). Finally, we may consider using these matrices of cluster profiles to connect the clusters between adjacent regions in the parcellation of all the cortical surface.

In order to evaluate the optimal number of clusters, we performed the k-medoids clustering for 
                           
                              K
                              =
                              2
                           
                         to 12. For each value of K, we assessed the validity of the cluster solutions generated for each subgroup using the silhouette average width as defined in Section 2.4.2 (Fig. 9). For the pre- and postcentral gyri of both hemispheres, the silhouette criterion identified consistently the five-cluster solution as the best one among the 11 assessed levels. For a minority of subgroups, the optimal number of clusters is 
                           
                              K
                              =
                              6
                           
                        . Averaged silhouette width values across all subgroups confirmed this result (see Fig. 10).

The spatial pattern of clusters for 
                           
                              K
                              =
                              2
                           
                         to 7 reveals hierarchical subdivisions, as illustrated in Fig. 13
                         on the left postcentral gyrus. Different subgroups sometimes subdivide differently for small values of K but they converge for 
                           
                              K
                              =
                              5
                           
                         on a common spatial subdivision pattern. After 
                           
                              K
                              =
                              5
                              ,
                           
                         the consistency of the new clusters decreases. In addition, the inter-cluster similarity between the two subgroups of each partition was measured using the adjusted Rand index. It does not allow to choose the optimal number of clusters but it confirms that around the value of 
                           
                              K
                              =
                              5
                           
                         the reproducibility of the clusterings is high enough (Fig. 10).

To study the influence of the parameters on the clustering results, a reference condition was systematically compared with different parameter settings. As shown in Fig. 14
                        , we tested one parameter at a time. The reference condition is highlighted in the green box. Two series of tests were made. First, for each tested condition, we evaluated the reproducibility of the clustering results by comparing subgroups A
                        1 and A
                        2 of partition A using the adjusted Rand index (Fig. 14-red box). Second, for one subgroup (A
                        1), we compared the clustering of the reference and the tested condition (Fig. 14-blue box).

For the same subjects, the ARCHI database has been processed with two fiber tracking algorithms: deterministic and probabilistic. The probabilistic tracking produces better results in terms of stability across subgroups and partitions. The Rand index lies within the range 
                                 
                                    [
                                    0.6
                                    −
                                    0.8
                                    ]
                                 
                               and below 0.6 for the probabilistic and deterministic tracking respectively (Fig. 14-red box). The parcellation results for the same subgroup A1 are compared between the reference condition and tested condition. Besides 
                                 
                                    K
                                    =
                                    3
                                    ,
                                 
                               the Rand index values are over 0.5 (Fig. 14-blue box). In both cases, we find the same general pattern.

The reference condition was applied to a partition of two subgroups of 40 and 39 subjects. To test if the parcellation stability is maintained for smaller groups, two subgroups of 10 subjects, taken within subgroup A1, were used for this condition. In this case, most clusters have almost the same boundaries, demonstrating the robustness of the method on smaller subgroups (Fig. 14). However, the Rand index values are higher for the reference condition: between 0.6 and 0.8 (Fig. 14-red box). The parcellation results for one subgroup of 10 subjects compared to the reference condition return Rand index values over 0.5 (besides 
                                 
                                    K
                                    =
                                    3
                                 
                              ), proving the relative stability of the clustering (Fig. 14-blue box) for a smaller number of subjects.

In the preprocessing, the fiber tracts were filtered in order to remove tracts shorter than a minimum length. Three minimum lengths of fibers were tested: 20, 30 and 60 mm. The reference condition (30 mm) proves to be valid since the Rand index values are higher than for the tested conditions (Fig. 14-red box). For a length of 60 mm, some of the clusters are different, confirmed by small Rand index values (Fig. 14-blue box). This difference in results may be explained by the removal of connections between sensory and motor areas, as in the BCR study.

We assessed the impact of smoothing on the parcellation by computing the connectivity matrix with different degrees of smoothing, equivalent to Gaussians of 0, 3 and 5 mm. As shown in Fig. 15
                              , the spatial patterns of the clustering solution for K = 5 are highly similar, and just slightly noisier without smoothing. Furthermore, the reordered dissimilarity matrix according to cluster labels confirms clearly separated clusters. Smoothings of 5 and 3 mm show remarkable similarities in terms of patterns, as confirmed by high Rand index values (Fig. 14-blue box). A smoothing of 3 mm seems to be a good compromise in the light of the curve in Fig. 14-red box, with a Rand index value of 0.8 for 
                                 
                                    K
                                    =
                                    5
                                 
                              .

For the reference condition and all tested parameters, Table 1
                               shows the optimal number of clusters K according to the average silhouette width, illustrated on the left postcentral gyrus of subgroup A1.

To complement the validation study for the central region, we show the same study for the anterior cingulate gyrus, in order to exhibit the behavior of the method in another region of the brain. We chose the anterior cingulate gyrus because some works have focused on this region, its connectivity has been investigated (Devinsky et al., 1995), and this region is involved in pathologies linked with emotion such as bipolar disorder (Drevets et al., 1997; Hirayasu et al., 1999). The results are found in Figs. 16
                               and 17
                              . As the region is small, the optimal number of clusters is lower than in the central region (2 or 3). The tendencies are similar to those of the pre and postcentral gyri, with slightly less contrasted results, which is expected since the central region is among the less variable part of the cortex. The optimal parameters used for the central region are still relevant.

To evaluate the validity of the silhouette and rand index measurements, a test has been performed to assess their scores on random data. To do so, permutations have been done in individual cortical connectivity matrices of the subgroup A1 for the postcentral gyrus (matrices C
                              
                                 g,s
                               in Fig. 1). More precisely, the columns of each individual connectivity matrix C
                              
                                 g, s
                               corresponding to basins of the group A were permuted, as other columns are discarded in the clustering. Then matrices were averaged for the group clustering. The clustering result was evaluated for different clusters numbers. We obtained values consistently lower than those previously obtained, the average rand index and the silhouette coefficient are 0.39 (SD = 0.07) and 0.25 (SD = 0.04) respectively, for 200 random tests. The optimal number of clusters varied between 
                                 
                                    K
                                    =
                                    2
                                 
                               and 
                                 
                                    K
                                    =
                                    4
                                 
                               with low values of the silhouette coefficient and was therefore considered to be much more unstable.

A complete pipeline has been integrated in the BrainVisa environment
                           2
                        
                        
                           2
                           
                              http://brainvisa.info.
                         in a new toolbox called Constellation: CONnectivity-based STructural parcELLATION. The Constellation toolbox will be made available on the BrainVISA web site, and may be obtained on request during the current “beta-testing” phase.

The preprocessings are done using FreeSurfer
                           3
                        
                        
                           3
                           
                              http://freesurfer.net/.
                         for the anatomical data, and Connectomist-2 (Duclap et al., 2012) for the diffusion data. The Constellation toolbox can optionally run the FreeSurfer preprocessings in an automatic way. It provides two processing chains: an intra-subject chain which builds the individual connectivity matrices, followed by an inter-subject chain which performs the groupwise clustering. Both chains work on a per-patch basis, and offer different levels of parallelization: on subjects, patches, or groups of subjects. Distributed computing may be performed either on a single multi-processor machine, or on a computing cluster, using Soma-Workflow (Laguitton et al., 2011).

In this paper, the computation time to obtain one full parcellation of the postcentral gyrus, for a group of 40 subjects, amounted to one hour using up to 40 processors in a computing cluster, in the reference conditions (Fig. 14). More specifically, we could compare our results over two or more groups in two hours.

In order to facilitate the quality control, visualization tools have been developed at different levels of the pipeline, based on Anatomist, a 3D visualization software dedicated to neuroimaging data (Rivière et al., 2003; 2011). For each processing step, specific visualizations can be automatically displayed. For example, after the clustering step, the connectivity matrix can be visualized, reordered according to clusters (Fig. 6).

Different original interactive representations of the connectivity profiles at the cluster or vertex level have been proposed. A global visualization presents spatial repartition of the connections of all the clusters (Roca et al., 2009) (cluster connectivity profile mosaic visualization in Fig. 18
                        ). For each cluster, a small brain represents the connections either on a textured mesh of the cortex, or using fiber tracts. Complementarily, another interactive visualization allows exploring the fibers tracts connecting different regions selected on the cortical surface mesh: patches, clusters, target regions, or any cortical areas. In addition, the connectivity profiles of a specific cortical element (vertex or region) can be visualized on a textured mesh of the cortical surface in an interactive way, by selecting either a vertex or a cortical region. Some videos can be found at the following location: http://brainvisa.info/doc/constellation/video/.

@&#DISCUSSION@&#

This study proposes for the first time a complete framework to deal with groupwise connectivity-based parcellation of the whole human cortical surface, tested in a group of 79 subjects: from preprocessings to an advanced visualization of the final clustering results. This framework has been implemented in a fully automatic and parallelized pipeline, including intra- and intersubject, visualization and validation procedures.

A surface-based registration allows easily combining the connectivity data of different subjects and reducing the connectivity profiles used for the clustering without any anatomical prior information, by taking into account the interindividual cortical and connectivity variability as well as uncertainty embedded into the tractography methodology. Indeed, tracking has tangential accuracy uncertainties near the cortex (Jbabdi et al., 2011), thus limiting the actual resolution of the surface-based connectivity data. Our dimension reduction identifies target regions which are adapted to this actual resolution and which integrates one part of the interindividual variability of the connectivity data.

The spatial clustering patterns obtained are highly reproducible between non-overlapping subgroups of nearly 40 subjects each. As far as we know, the present study is the first to investigate the inter-group reproducibility of a connectivity-based parcellation. In addition, this reproducibility is strengthened by the fact that our method does not use a priori target regions to compress the connectivity profiles, which could constrain and bias the results. Moreover, this method seems to be robust even for smaller groups, as demonstrated by our tests on groups of 10 subjects on the left postcentral gyrus.

On the pre- and postcentral gyri, the parcellation results reveal a common pattern across the different subgroups, with an optimal number of clusters 
                           
                              K
                              =
                              5
                           
                         observed robustly in the three partitions of subjects used for the validation. This number of clusters is comparable to that (4) found in (Schubotz et al., 2010) for the precentral gyrus, although the spatial patterns are difficult to compare between the studies. This could be explained by the fact that this other study presents individual clustering results. In our group parcellation, each cluster is usually composed of a unique connected component with smooth boundaries. The smoothing of the connectivity data only makes the boundaries less noisy, as shown by the test when no smoothing was applied (Fig. 14). In neuroimaging, the smoothing is often used in group studies in order to reduce the interindividual variability. In our study, the relative low influence of the smoothing on our results is thus not surprising as our dimension reduction method is designed to overcome one part of the interindividual variability of the connectivity data. In addition, consistent continuities between cluster boundaries across adjacent patches and across groups are found. Interestingly, the spatial clustering pattern presents hierarchical subdivisions when increasing the number of clusters, whereas the clustering algorithm used in this study was not a hierarchical one. Thus this hierarchy in clusters is not induced by the algorithm, but might be intrinsically present in the anatomical data. The parcellation did not correspond to cytoarchitectonic areas (Brodmann, 1909). This discrepancy is not surprising given the different nature of the information about cytoarchitectony from that of diffusion-weighted connectivity. To illustrate, Brodmann area 4 (precentral gyrus), corresponding to the primary motor cortex, is also subdivided into several regions according to the somatotopic organization, and these regions are connected to different areas. On the other hand, the sensory areas (Brodmann areas 1, 2, 3) are organized along a similar pattern, which regions can share similar connectivity with corresponding motor areas.

Although we do not pretend to have extensively studied all the parameters present in our methodology, the analysis of the influence of the main parameters on the pre- and postcentral gyri allows one to relatively easily choose an optimal set of parameters: a probabilistic tractography, a filtering of the fiber tracts below 30 mm, and a spatial smoothing of the connectivity data of 3 mm. In addition, the clustering result is relatively robust to changes in these parameters. All gyri were successfully parcellated using this optimal set of parameters: reproducible results were obtained on different subgroups. Given the large number of runs performed with a random k-medoids initialization, the clustering results seem to be relatively insensitive to k-medoids initialization.

Our method filters out the intra-patch fiber tracts and thus removes a non-negligible part of the connectivity data. We could potentially miss clusters having strong internal connections to the patch. We chose to remove them, primarily because watershed basins inside the patch could bias the clustering result by expressing basins of the intra-patch watershed, and secondarily because intra-patch connections are mostly short fibers, which are less reliable due to fiber tracking limitations. As this second drawback is already countered by the elimination of short fibers under 30 mm (see Section 2.2), and as the first one is a precaution against an hypothetical bias, it would be interesting to validate the clustering without removal of intra-patch connections.

For this reason, the clustering cannot be applied directly to the whole cortex surface, because we would remove all the connectivity information. Consequently we have to work on smaller patches and then to concatenate the independent clustering results. In the current work we used gyri of FreeSurfer as the starting regions. This introduces artificial boundaries depending on the gyri as seen when pre- and postcentral gyri are merged (Section 3.3). Patches boundaries may also suffer inter-individual uncertainties due to inter-subject variability and alignment imperfections, and thus include connections of different nature, not providing the same connectivity profile. We expect our algorithm to take the maximum common information between individual profiles, and drop the residual, non-reproducible information, using the group watershed. With respect to this, the clustering of the inner part of the region has a strong basis. This is not necessarily true for the border parts, where mis-alignment between subjects may lead to include different parts of different anatomical structures for different subjects.

To overcome this limitation, we could define larger input patches to minimize the relative part of the surface where this border effects can happen. Then we could either regroup adjacent clusters from neighboring patches with similar connectivity patterns, identified by low inter-cluster distances as mentioned at the end of Section 3.3, or use an iterative strategy for clustering: a first pass could identify inner clusters, which do not touch the seed region boundaries, then the next step could perform a re-clustering of the complementary regions, erasing the initial seed regions boundaries. This approach has been proposed in Roca et al. (2009).

We internally validated the results with our own database, algorithms, and parameter settings, but a comparison with previous research is difficult. Prior publications have worked with different datasets and trackings, and, generally, each one is based on an individual analysis, and therefore the variability of the clustering results could be explained by these differences.

Our results depend on the accuracy of the tractography, which is known to have uncertainty problems, especially with crossing fibers and near the cortex. Typically fibers ascend along a gyrus wall, and then turn quite abruptly about ninety degrees to enter the cortex in a specific cortical area. Tractography has difficulties following the exact location of such severe changes in direction, and the tracts tend to go straight to the gyrus crest (Jbabdi et al., 2011). Thus, connectivity information gets mixed in these regions and the parcellation results may depend on such an information mixture. Fortunately, even if tractography has known biases which could influence our results, these biases partly compensate in the group study: clustering uses the common part of connectivity information across subjects even if some profiles may be inaccurate, and this additional, non-reproducible bias does not have a high weight in the results. Thus, the results proved to be very reproducible between groups.

In the future, a direct extension of this groupwise parcellation method would be to try a concatenated approach (Roca et al., 2010; Roca, 2011): after the dimension reduction, the clustering could be applied to the concatenation of the patch connectivity data across all subjects. This kind of method has the benefit to provide one specific parcellation per subject with a direct correspondence between clusters across subjects. However, this approach requires additional developments regarding the problems encountered with large datasets.

The group clustering relies on a point-by-point averaging of connectivity data for all subjects. This assumes that seed points are aligned across subjects, which proves imperfect. The approximation here relies on the FreeSurfer alignment, and on the connectivity matrix smoothing. In most cases this alignment proves sufficient to obtain reasonable results, but things may be improved on this topic in the future. Future works will include comparing to other surface-based alignments and seed regions definitions, like those provided by Hip Hop (Auzias et al., 2013) or the registration from (Yeo et al., 2010).

Our work has focused on uphill processing so as to provide a compact, good quality representation of the data to be clustered. In this regard, any standard clustering method such as k-medoids should behave correctly, thanks to this preprocessing. We have ensured that reproducible results are obtained when random initialization changes. In another direction, given the observed hierarchical nature of the data, it would be interesting to perform a hierarchical clustering algorithm, such as Ward aggregative clustering, in order to model the underlying cluster hierarchy as previously done at the individual level (Gorbach et al., 2011; Moreno-Dominguez et al., 2014). This could also bring alternative criteria to handle the problem of selecting the optimal number of clusters.

The cortico-subcortical connections could also be added to the current cortico-cortical connections, as was done in a recent connectome study (Glasser et al., 2013). For instance, a simple way to include, in our work, subcortical information would be to mesh the voxel-based segmentation of the structures (which are provided by FreeSurfer), and use them to intersect the tracts and build the connectivity matrices. As there is no point-to-point inter-subject matching on these structures, we could simply use each subcortical structure as a “single node”, summing (reducing) all the connectivity data going from one point of the cortex to the selected structure. We would possibly have to tune the relative weight of the subcortical features compared to cortical ones, however, so we chose not to focus on this aspect at first.

In addition, it would be interesting to compare our results to groupwise cortical parcellations based on other imaging modalities, such as resting-state functional MRI (Shen et al., 2013). Multimodal approaches directly combining connectivity information from diffusion-weighted MRI with functional information may be investigated.

@&#CONCLUSIONS@&#

In this study, we showed that our group-wise connectivity-based parcellation method can be applied to the whole cortex and on a large number of subjects, with a remarkable reproducibility of the results, even without using prior knowledge for the dimension reduction. Moreover, this reduction has the advantage of taking into account the interindividual variability. The method has been implemented in a complete pipeline which proves to be robust to various parameters. These first results are very encouraging even if additional improvements may be made. Applications of this groupwise connectivity-based cortex parcellation could include graph-based analyses of the connectome, where the graph nodes will be the clusters resulting from our method (Zalesky et al., 2010). Finally, the method could be applied in clinical or neuroscientific research, in order to compare the parcellations of two populations of subjects.

@&#ACKNOWLEDGMENTS@&#

The “CONNECT/Archi Database” is the property of the CEA I2BM NeuroSpin centre and was designed under the supervision of Dr. Cyril Poupon and Dr. Jean-François Mangin, and was funded by the Federative Research Institute 49, by the HIPPIP European grant, and the European CONNECT project (http://www.brain-connect.eu). Acquisitions were performed by the scientists involved in the Multi-scale Brain Architecture research program of NeuroSpin and by the staff of the UNIACT Laboratory of NeuroSpin (headed by Dr. Lucie Hertz-Pannier), under the ethical approval CPP100002/CPP100022 (principal investigator Dr. Denis Le Bihan). Access to the database can be requested from cyril.poupon@cea.fr.

This work has been partly supported by HBP 
                  FP7-ICT-2013-FET-F/604102.

Supplementary material associated with this article can be found, in the online version, at 10.1016/j.media.2016.01.003.


                     
                        
                           Supplementary Data S1
                           
                              Supplementary Raw Research Data. This is open data under the CC BY license http://creativecommons.org/licenses/by/4.0/
                              
                           
                           
                        
                     
                  


                     
                        
                           Supplementary Data S2
                           
                              Supplementary Raw Research Data. This is open data under the CC BY license http://creativecommons.org/licenses/by/4.0/
                              
                           
                           
                        
                     
                  


                     
                        
                           Supplementary Data S3
                           
                              Supplementary Raw Research Data. This is open data under the CC BY license http://creativecommons.org/licenses/by/4.0/
                              
                           
                           
                        
                     
                  


                     
                        
                           Supplementary Data S4
                           
                              Supplementary Raw Research Data. This is open data under the CC BY license http://creativecommons.org/licenses/by/4.0/
                              
                           
                           
                        
                     
                  

@&#REFERENCES@&#

