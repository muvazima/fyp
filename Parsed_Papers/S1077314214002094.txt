@&#MAIN-TITLE@&#Efficient tracking of human poses using a manifold hierarchy

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A markerless multi-camera human pose tracking method is proposed.


                        
                        
                           
                           Activities are modelled by a novel hierarchical dimensionality reduction method, Hierarchical Temporal Laplacian Eigenmaps.


                        
                        
                           
                           Poses are estimated by the proposed Hierarchical Manifold Search.


                        
                        
                           
                           Comparisons with state-of-the-art methods demonstrate the accuracy and efficiency of our approach.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Human body pose estimation

Pose tracking

Dimensionality reduction

@&#ABSTRACT@&#


               
               
                  In this paper a 3D human pose tracking framework is presented. A new dimensionality reduction method (Hierarchical Temporal Laplacian Eigenmaps) is introduced to represent activities in hierarchies of low dimensional spaces. Such a hierarchy provides increasing independence between limbs, allowing higher flexibility and adaptability that result in improved accuracy. Moreover, a novel deterministic optimisation method (Hierarchical Manifold Search) is applied to estimate efficiently the position of the corresponding body parts. Finally, evaluation on public datasets such as HumanEva demonstrates that our approach achieves a 62.5–65mm average joint error for the walking activity and outperforms state-of-the-art methods in terms of accuracy and computational cost.
               
            

@&#INTRODUCTION@&#

In computer vision, human motion analysis is a rapidly growing area, because of not only the methodological challenge that motion analysis implies but also its many applications such as surveillance, human computer interaction, sports analysis and computer graphics. Human motion analysis approaches have been relying on activity recognition, pose estimation and pose tracking methodologies. Whereas activity recognition aims at classifying the type of the activity performed by a human being, pose estimation deals with estimating the skeletal position of a person for one or more frames. Although this makes the solution independent of the previous poses, this is also more sensitive to errors. Consequently, pose estimation is often integrated within a pose tracking framework where past information is exploited to estimate the current pose in a more efficient way. Human pose tracking methods that rely on markerless approaches are generally desirable because of their non-invasive nature that widens significantly their potential application. Multi-camera systems are able to mitigate the complexity of markerless approaches and to deal with the inevitable limb occlusions. Still, the variety of human postures and activity styles, and the high complexity of modelling the human body make this problem a technically demanding and computationally expensive task.

In this paper, we introduce a hierarchical dimensionality reduction method, namely Hierarchical Temporal Laplacian Eigenmaps (HTLE). It goes beyond the hierarchical structure of human body parts, represented as pairwise relationships as in Yang and Lee [38], Urtasun and Darrell [33], Amin et al. [1] by considering divisions at different hierarchical levels, similarly to Han et al. [14], Darby et al. [10], Raskin and Rudzsky [25], Wang et al. [37], Tian et al. [32]. The HTLE approach allows searching each level of a posture hierarchy separately, thus modelling new, unseen poses. Furthermore, we propose a markerless, hierarchical pose tracking method, namely Hierarchical Manifold Searching (HMS), designed for multi-camera scenarios. Our framework operates in a two-phase approach; first, a training set is used in order to generate a hierarchy of low dimensional manifolds using HTLE and second, pose tracking is performed in a hierarchical manner using HMS. Therefore, unlike conventional dimensionality reduction methods which are restricted to the set of poses present in a training set, our framework is capable of moving beyond the training set and generating new poses that have never been seen before. In addition, instead of searching the whole hierarchy as performed in previous studies using computationally expensive particle filtering [10,25], the computational cost of the proposed method is reduced by using deterministic optimisation applied to a subset of manifolds in the hierarchy. Our approach also deals with style variability, i.e. pose differences for a given activity resulting from either individual’s personality or distinct conditions, by allowing an extra final level of hierarchy where each body part is individually adjusted in an unconstrained manner [24]. We show that our methodology improves computational efficiency and accuracy.

@&#RELATED WORK@&#

First, different 3D human pose tracking techniques are discussed. Then, methodologies based on dimensionality reduction methods are presented. Finally, hierarchical approaches are described.

Early human pose tracking methods were based on gradient descent [16]. However, they suffer from finding local optima thus giving poor tracking results. In order to search the complex space of human postures, the particle filter (PF) method [2] has been used. However, the high dimensionality of this space makes it difficult to sample the solution space efficiently [28] and prevents divergence. Deutscher and Reid [11] proposed an Annealed Particle Filter (APF) that improves the efficiency of the particle filter search; however it is still computational expensive due to the high dimensionality. Moreover, in an unconstrained searching environment, when a particle filter-based tracker diverges, convergence in the following frames becomes problematic [26]. Gall et al. [13] introduce a multi-layer framework based on simulated annealing that combines stochastic optimisation, filtering, and local optimisation which led to results slightly more accurate than APF. However, as all particle based estimation methods, a large number of particles is required which increases complexity and computational cost [28,4].

In order to deal with the high complexity of modelling articulated human motion, nonlinear dimensionality reduction methods have been used in tracking pipelines, exploiting available training sequences for known actions. They are grouped into two categories: mapping-based and embedded-based approaches. Mapping approaches, such as Gaussian Process Latent Variable Model (GP-LVM) [18,15], employ probabilistic nonlinear functions in order to map the embedded space to the data space. Consequently, their training is time-consuming and convergence is not guaranteed [35], especially for applications which are based on large training sets. Embedded approaches provide an estimate of the structure of the underlying manifold by means of approximating each data point according to their local neighbours on the manifold. The main drawback of these methods is the lack of mapping functions between high and low dimensional spaces, although Radial Basis Function Networks are usually used to resolve this issue [20]. This category of techniques includes Local, Linear Embedding [27] (LLE), Isometric Feature Mapping (Isomap) [31], Laplacian Eigenmaps (LE) [5] and Local tangent space alignment (LTSA) [39].

Since human motion may be described by time series, the temporal dependencies between consecutive poses can be used to improve human tracking applications. These temporal constrains ensure that points that are close in time will be close in the low dimensional space. Spatio-Temporal Isomap (ST-Isomap), [17] an extension of Isomap, changes the original weights in the graph of local neighbours in order to emphasise the similarity between temporally related points. Gaussian Process Dynamical Models (GPDM) [36] integrates time information using Gaussian Process priors to create dynamics in the low dimensional space. Urtasun et al. [34] use GPDM for learning human poses and motion priors for 3D people tracking. However, most of these methods suffer from the fact they are person dependent: they are not able to efficient track people with their corresponding style who do not belong to the training set, which reduces their application. Alternatively, Temporal Laplacian Eigenmaps (TLE) [22] was specifically designed to address the issue of modelling activities of different people by suppressing their stylistic differences and producing a coherent manifold. The resulting manifold has a 1D dimensionality, which is suitable for fast exploration. Nonetheless, none of the above approaches allows the recovery of unseen poses. This is because dimensionality reduction methods are activity dependent, that is, they can only represent those activities that they have learned during training, usually a single activity.

Hierarchical methodologies that consider divisions of human body parts at different hierarchical levels have been proposed to extend the pose space by decoupling the motion of individual limbs which allows dealing with unseen activities. Such methodologies were proposed for 2D pose estimation in Wang et al. [37], Tian et al. [32]. The Hierarchical Gaussian Process Latent Variable Model (H-GPLVM) [19] has been applied to activity recognition [14] and pose estimation [25,10], based on a hierarchy of manifolds trained using different activities. Han et al. [14] and Darby et al. [10] used H-GPLVM for training two different activities and the APF method to search for poses that result from combinations of these activities. Using this learnt hierarchical model for multiple activities they can recover novel poses which are not present in the training dataset. For example, training data for a person walking and a person standing and waving allow detecting a person who is walking whilst waving. The hierarchy is able to recognise the posture of the upper body from the first training activity and that of the lower body from the other one. Similarly, Raskin and Rudzsky [25] presented an extension of the Gaussian Process Annealed Particle Filter (GPAPF) method [26] called Hierarchical Annealing Particle Filter (H-APF). This method also uses H-GPLVM to generate a hierarchy of manifolds in the low-dimensional space, and the APF method to generate particles in the latent space. H-APF is tested in a multi-activity scenario combining walking and jogging activities, where the activity of every frame is estimated before pose estimation. Although all these hierarchical approaches allow the generation of unseen poses where individual body part postures originally belonged to different activities, their main drawback is their high computational cost, since APF is used to search through the whole hierarchy.

@&#OVERVIEW@&#

The pipeline of our approach is presented in Fig. 1
                        . More specifically, the training set comes from MoCap data describing the activity of interest as a sequence of human poses. Activity Manifolds are learned by the proposed Hierarchical Temporal Laplacian Eigenmaps (HTLE) (Fig. 1a), as described in Section 2. The pose tracking process is constrained by the hierarchy of Activity Manifolds (Fig. 1b) which is presented in Section 3. Our system (Fig. 1b) assumes multiple calibrated and synchronised cameras. At every cycle, an observation is estimated from the set of images captured by the vision system. The observation and the previously learnt Activity Manifolds are fed to our novel search method, i.e. Hierarchical Manifold Search (HMS), which explores efficiently the pose space described by HTLE. An observation is proposed based on volume overlap between the observation and a 3D geometric human model, and on colour information of the input data. The final output is the 3D coordinates of the joints of the estimated pose for each set of synchronised frames.

In this section, we present the formation of Hierarchical Temporal Laplacian Eigenmaps (HTLE). Since TLE generates a coherent low dimensional manifold that takes into account the temporal dependencies of the data, it can only model poses seen in the training dataset. In order to deal with this restriction we propose to expand the available pose space using HTLE, a hierarchy extension of TLE. The advantages of such structure are twofold: firstly, fast searching is facilitated by a set of 1D TLE manifolds; secondly, the hierarchy of manifolds models unseen poses to address the problem of variations between the subjects of the training and the testing datasets. After a presentation of the TLE dimensionality reduction method, HTLE is described in details.

The Temporal Laplacian Eigenmaps dimensionality reduction method has been applied to represent sequences of human poses for a given activity [22,21]. TLE generates a temporal representation of human postures, where inter-person variability (style) has been suppressed, expressed as a one-dimension manifold. Here, we have selected TLE as the dimensionality reduction method for two reasons. Firstly, TLE explicitly preserves the temporal coherence of an activity, which is important for a tracking application. Secondly, searching one-dimensional manifolds, such as those produced by TLE, is very efficient.

In order to generate the low dimensional manifold, a training dataset P is used
                           
                              (1)
                              
                                 P
                                 =
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                           
                        corresponds to N poses, where 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         is the ith pose of the model. TLE produces a manifold Q, which is an equivalent representation of P in a low dimensional space of d dimensions,
                           
                              (2)
                              
                                 Q
                                 =
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                              
                           
                        where 
                           
                              D
                              ,
                              
                              d
                              ∈
                              N
                              ,
                              
                              d
                              ≪
                              D
                           
                         and 
                           
                              
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                           
                         is the representation of pose 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         on the manifold.

The manifold Q is calculated by defining firstly a neighbourhood graph and, then, solving the eigenvalue problem. Since TLE aims to preserve temporality, two types of temporal neighbourhoods are defined for each data point 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                        . Adjacent temporal neighbours A: the 
                           
                              2
                              m
                           
                         closest points in the sequential order of input (Fig. 2
                        a)
                           
                              (3)
                              
                                 
                                    
                                       A
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                -
                                                m
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                -
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                +
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                +
                                                m
                                             
                                          
                                       
                                    
                                 
                              
                           
                        and repetition temporal neighbours R: the s points similar to 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                        , extracted from repetitions of time series fragment 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         (Fig. 2b)
                           
                              (4)
                              
                                 
                                    
                                       R
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                                ,
                                                s
                                             
                                          
                                          
                                             
                                                
                                                   C
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              
                                 
                                    
                                       C
                                    
                                 
                              
                           
                         returns the centre point of an activity fragment similar to 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         for each iteration j. 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         is a fragment of the activity sequence defined by the central point 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         and a fixed number of surrounding adjacent temporal neighbours. Once the fragment 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                 
                              
                           
                         is defined, the repetitions of this fragment, that is, 
                           
                              
                                 
                                    F
                                 
                                 
                                    i
                                    ,
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    F
                                 
                                 
                                    i
                                    ,
                                    s
                                 
                              
                           
                        , are extracted by applying Dynamic Time Warping over the full dataset. More details about this process and its parameters can be found in Lewandowski et al. [22,21].

Once the neighbourhoods for each data point are defined, the neighbourhood graph is estimated. First, using the standard LE formulation the weights W
                        
                           
                              (5)
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       G
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         e
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  -
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                     
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                   
                                                   connected
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        are assigned to the edges of each graph 
                           
                              G
                              ∈
                              
                                 
                                    
                                       A
                                       ,
                                       R
                                    
                                 
                              
                           
                        .

Then, following the standard LE formulation, an extended cost function is introduced to combine information from both graphs
                           
                              (6)
                              
                                 arg
                                 
                                    
                                       
                                          min
                                       
                                       
                                          Q
                                       
                                    
                                 
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       T
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                A
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 Q
                              
                           
                        
                        
                           
                              (7)
                              
                                 subject to
                                 :
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       T
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                A
                                             
                                          
                                          +
                                          
                                             
                                                D
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 Q
                                 =
                                 I
                              
                           
                        where 
                           
                              
                                 
                                    D
                                 
                                 
                                    G
                                 
                              
                              =
                              diag
                              
                                 
                                    
                                       
                                          
                                             D
                                          
                                          
                                             11
                                          
                                          
                                             G
                                          
                                       
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             22
                                          
                                          
                                             G
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             D
                                          
                                          
                                             nn
                                          
                                          
                                             G
                                          
                                       
                                    
                                 
                              
                           
                         is a diagonal matrix with 
                           
                              
                                 
                                    D
                                 
                                 
                                    ii
                                 
                                 
                                    G
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    W
                                 
                                 
                                    ij
                                 
                                 
                                    G
                                 
                              
                           
                        , and 
                           
                              
                                 
                                    L
                                 
                                 
                                    G
                                 
                              
                              =
                              
                                 
                                    D
                                 
                                 
                                    G
                                 
                              
                              -
                              
                                 
                                    W
                                 
                                 
                                    G
                                 
                              
                           
                         is the Laplacian matrix corresponding to the graph. The minimum of the objective function can be found by solving the eigenvalue problem from the equations
                           
                              (8)
                              
                                 ∧
                                 
                                    
                                       
                                          Q
                                          ,
                                          λ
                                       
                                    
                                 
                                 =
                                 
                                    
                                       Q
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                A
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                 
                                 Q
                                 -
                                 λ
                                 
                                    
                                       
                                          I
                                          -
                                          
                                             
                                                Q
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         A
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         R
                                                      
                                                   
                                                
                                             
                                          
                                          Q
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                L
                                             
                                             
                                                A
                                             
                                          
                                          +
                                          
                                             
                                                L
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                 
                                 Q
                                 =
                                 λ
                                 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                A
                                             
                                          
                                          +
                                          
                                             
                                                D
                                             
                                             
                                                R
                                             
                                          
                                       
                                    
                                 
                                 Q
                              
                           
                        
                     

The generalised eigenvalue problem is solved to span the embedded space Q by the eigenvectors given by the d smallest nonzero eigenvalues λ.

Unlike the standard Laplacian Eigenmap dimensionality reduction method (LE) that only preserves the manifold’s local geometry [6], the temporal structure of the data manifold is preserved thanks to the inclusion of the graphs A and R. Consequently, TLE is able to preserve implicitly the local and global temporal topology of the data. This implies that TLE maintains the temporal continuity of time series during dimensionality reduction process and suppresses stylistic variations displayed by different sources of time series by aligning them in the low dimensional space [22].

Although the manifold lies in the low dimensional space, the observation function needs to be evaluated in the high dimensional space. Consequently, a mapping function is required to find correspondences between the two spaces. Since spectral methods lack mapping functions to project data from one space to another, Radial Basis Function Network (RBFN) as suggested by Lewandowski et al. [20] are trained to obtain these transformations φ and 
                           
                              
                                 
                                    φ
                                 
                                 
                                    ′
                                 
                              
                           
                        :
                           
                              (10)
                              
                                 φ
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 
                                 and
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       ′
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       d
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       D
                                    
                                 
                              
                           
                        
                     

TLE have been used for modelling a wide variety of activities, both periodic and non-periodic [22,21].

The hierarchical structure of HTLE dimensionality reduction method has been designed to allow searching each level of the hierarchy extending the training dataset. This is achieved by exploring each level separately and then combining all of them, generating a new, unseen configuration. In this study, we use HTLE for pose tracking purposes as the human body can be regarded as a hierarchical structure.

HTLE uses the training dataset P to generate a hierarchy of manifolds in low dimensional spaces. Let 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         be the set of N poses of the training dataset that corresponds to the l-th pose subspace at the hierarchy level h
                        
                           
                              (11)
                              
                                 
                                    
                                       P
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                         is the pose of the model at the time i. As discussed in Section 2.1 TLE produces a manifold 
                           
                              
                                 
                                    Q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         representing 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         in a low dimensional space 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                    
                                       Q
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          N
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    d
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                              ≪
                              
                                 
                                    D
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                        .

At a given level h (Fig. 3
                        ), mapping between the high and low dimensional spaces [22] is performed by the functions:
                           
                              (13)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             h
                                             ,
                                             l
                                          
                                       
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             h
                                             ,
                                             l
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       φ
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 :
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             d
                                          
                                          
                                             h
                                             ,
                                             l
                                          
                                       
                                    
                                 
                                 →
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             D
                                          
                                          
                                             h
                                             ,
                                             l
                                          
                                       
                                    
                                 
                              
                           
                        where
                           
                              (14)
                              
                                 
                                    
                                       φ
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       q
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       φ
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

We also define mapping functions (Fig. 3) between the hierarchy levels points 
                           
                              
                                 
                                    p
                                 
                                 
                                    h
                                    -
                                    1
                                    ,
                                    l
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    h
                                    -
                                    1
                                    ,
                                    l
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ∈
                              
                                 
                                    P
                                 
                                 
                                    h
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       ω
                                    
                                    
                                       h
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 :
                                 
                                    
                                       P
                                    
                                    
                                       h
                                       -
                                       1
                                       ,
                                       l
                                    
                                 
                                 →
                                 
                                    
                                       P
                                    
                                    
                                       h
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 where
                                 
                                 
                                    
                                       ω
                                    
                                    
                                       h
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                -
                                                1
                                                ,
                                                l
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       h
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                           
                        
                     

These mapping functions permit evaluating hypotheses by projection to the high dimensional space as well as propagating hypotheses through the hierarchy.

In this section we introduce the Hierarchical Manifold Search (HMS) method. HMS explores a hierarchy representing the human body as created by HTLE to estimate a human pose. For each frame, at the first level of the hierarchy, the optimal pose is estimated by searching in a low dimensional manifold representing the full body motion of the activity of interest. Then, the subspaces associated to body parts are searched hierarchically looking for the optimal pose at a given level. To achieve this, we create the observation from the input images of the dataset. Then, the observation function compares in an intuitive manner the observation H, and pose hypotheses generated by the human model M. Finally, the estimated human pose is fed back as input for the next frame.

From the input data an observation is generated for every frame. Since our input may be acquired by multiple synchronised sensors, the term frame may also mean a set of synchronised frames in this work. The observation includes the information that will be used in the pose tracking methodologies.

A 
                           
                              3
                              D
                           
                         volumetric representation (observation) of the observed human is generated to allow evaluation of human model hypotheses. Specifically, we assume that the testing set comprises synchronised views of a human from multiple cameras. A background subtraction method is needed to extract the human body silhouette from every view; i.e. the constant background is removed from every image and the result is the body silhouette including the colour information. In this work, the standard background subtraction method suggested by HumanEva [30] is used to ensure fair comparison with other methods.

Then, the silhouette images are used to generate the observation. When the foreground is projected into the 
                           
                              3
                              D
                           
                         space, using the calibration information of the camera, a 
                           
                              3
                              D
                           
                         geometric shape is defined that contains the target object. The observation is generated from the intersection of all silhouette geometric shapes, and represented as a set of 
                           
                              3
                              D
                           
                         voxels. In this study the Bounding Edge technique [9] is used to generate the Visual Hull. This procedure has been refined since our previous work [23]: the colour from the input images is also back-projected on the visual hull [12] (Fig. 4
                        ) in order to discriminate between body parts and improve accuracy.

For the purpose of our method we use a 
                           
                              3
                              D
                           
                         articulated human model M that consists of L cylindrical parts. The cylindrical definition of the model allows us to compare pose estimates against the observation using simple mathematical models. This is for faster evaluation of the observation function without losing the basic structure of the 3D human shape.

The human model M is defined as a set of three independent parameters
                           
                              (16)
                              
                                 M
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   g
                                                   ,
                                                   p
                                                   ,
                                                   m
                                                
                                             
                                          
                                          ,
                                          g
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                6
                                             
                                          
                                          ,
                                          p
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                D
                                             
                                          
                                          ,
                                          m
                                          ∈
                                          
                                             
                                                R
                                             
                                             
                                                2
                                                L
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              g
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    6
                                 
                              
                           
                         describes the global rotation and translation of the body into the 
                           
                              3
                              D
                           
                         Euclidean space, 
                           
                              p
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    D
                                 
                              
                           
                         the pose of the model that is expressed by joint angles between body parts and 
                           
                              m
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                    L
                                 
                              
                           
                         represents the human volumetric model expressed by the length and the radius of the cylinders of the L body parts. Joint angles are represented by quaternions, as a consequence of which every body part requires four parameters, i.e. 
                           
                              D
                              =
                              4
                              ·
                              L
                           
                        .

In tracking experiments, the human model M is initialised manually in the first frame. While m is considered fixed for every human subject, tracking involves recovering the global position/orientation g and the joint angles p at every frame. The Skeleton Representation is a model that is extracted from specific points of the Volumetric Representation. Every part of the human body is represented by a straight line that connects two points as seen in Fig. 5
                        .

In order to compare the observation with the pose hypotheses, an observation function is used,It based on the coloured visual hull H 
                        [8] and consists of two parts. The first part 
                           
                              
                                 
                                    s
                                 
                                 
                                    1
                                 
                              
                           
                         compares the 
                           
                              3
                              D
                           
                         volume of the observation H with the pose hypothesis M by using the relative overlap between them:
                           
                              (17)
                              
                                 
                                    
                                       s
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       
                                          M
                                          ,
                                          H
                                       
                                    
                                 
                                 =
                                 
                                    
                                       |
                                       M
                                       ∩
                                       H
                                       |
                                    
                                    
                                       |
                                       M
                                       |
                                    
                                 
                              
                           
                        
                     

The second part 
                           
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                           
                         is based on the colour similarity. This is important since it complements the first part of the observation function especially for poses where the limbs are close to the torso as the colour of the torso is often different from the limbs’. At the initial pose the colour of the limbs 
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                         is estimated, using the voxels of the initial observation 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                        , matched by the limb j. Then, this colour information is used for comparing corresponding areas of this frame with the initial one. Specifically, 
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                         is estimated as the average of the hue values of all the matched voxels, assuming an HSV colour space. The hue value is used for comparing the colour without affecting the saturation and the brightness at every frame due to shadows and light. Then, at the frame i the colour information of the observation 
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                           
                         of every voxel v, 
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                                 
                                    i
                                    ,
                                    v
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              …
                              ,
                              L
                           
                        , matched by the limb j, is compared to the initial limb colour 
                           
                              
                                 
                                    c
                                 
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                           
                        . A binary colour similarity variable, 
                           
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                                 
                                    i
                                    ,
                                    v
                                 
                              
                           
                        , is introduced to emphasise significant differences and at the same time suppress noise in the hue channel
                           
                              (18)
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       i
                                       ,
                                       v
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ⩽
                                                   a
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  v
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  c
                                                               
                                                               
                                                                  j
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   >
                                                   a
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              a
                              ∈
                              [
                              0
                              ,
                              1
                              ]
                           
                         is an appropriate threshold. Then the observation function 
                           
                              
                                 
                                    s
                                 
                                 
                                    2
                                 
                              
                           
                         is defined by:
                           
                              (19)
                              
                                 
                                    
                                       s
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          M
                                          ,
                                          H
                                       
                                    
                                 
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          L
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             =
                                             1
                                          
                                          
                                             
                                                
                                                   V
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             C
                                          
                                          
                                             j
                                          
                                          
                                             i
                                             ,
                                             v
                                          
                                       
                                    
                                    
                                       
                                          
                                             V
                                          
                                          
                                             j
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    V
                                 
                                 
                                    j
                                 
                              
                           
                         is the total size in voxels of limb 
                           
                              j
                              ,
                              
                              
                                 
                                    C
                                 
                                 
                                    j
                                 
                                 
                                    i
                                    ,
                                    v
                                 
                              
                           
                         is a binary variable, that emphasises significant colour similarities and L is number of the body parts.

The observation function f is given by the weighted mean
                           
                              (20)
                              
                                 f
                                 
                                    
                                       
                                          M
                                          ,
                                          H
                                       
                                    
                                 
                                 =
                                 
                                    ∑
                                 
                                 
                                    
                                       w
                                    
                                    
                                       n
                                    
                                 
                                 
                                    
                                       s
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 M
                                 ,
                                 H
                                 )
                              
                           
                        where 
                           
                              
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                           
                         is the weight that allows changing the balance between observation functions, where 
                           
                              ∑
                              
                                 
                                    w
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        .

An advantage of the proposed observation function is that it allows comparisons of individual body parts of the human model to the observation as seen in Fig. 6
                        . This property is important when moving down through our hierarchy in Section 2.2. Also, because of the 
                           
                              3
                              D
                           
                         representation, individual body parts, like torso or arms, may be removed from the observation without affecting the observation of other body parts, making the search strategy more efficient, as explained later in Section 3.5. This contrasts with 2D image-based observation functions, such as the silhouette and edge likelihood and the bi-directional silhouette likelihood that are tested in Sigal et al. [28] that do now allow comparison of individual body parts because of potential occlusions in image views.

HTLE is selected to model the pose search space for two reasons. Firstly, the one-dimensionality of each manifold facilitates fast searching. Secondly, its hierarchical structure provides flexibility to the search space to allow detection of unseen poses. We define a hierarchy based on the division of the individual body parts as shown in Fig. 7
                        . At the first level 
                           
                              
                                 
                                    h
                                 
                                 
                                    1
                                 
                              
                           
                        , the whole body is represented. At the next level 
                           
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                           
                        , the variability of the previous level is expressed by two subspaces containing either the upper or the lower body. The division process is repeated for the next two levels 
                           
                              
                                 
                                    h
                                 
                                 
                                    3
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    4
                                 
                              
                           
                        : firstly, four subspaces are created to model the four individual limbs, i.e. left and right arms and legs; secondly, each limb is divided into two segments, i.e. upper and lower arm and leg, to produce eight submanifolds. At the last level 
                           
                              
                                 
                                    h
                                 
                                 
                                    5
                                 
                              
                           
                        , each limb segment is allowed to move in an unconstrained manner similarly to Moutzouris et al. [24]. Although levels 
                           
                              
                                 
                                    h
                                 
                                 
                                    4
                                 
                              
                           
                         and 
                           
                              
                                 
                                    h
                                 
                                 
                                    5
                                 
                              
                           
                         correspond to the same leaf nodes, their search spaces are different since only 
                           
                              
                                 
                                    h
                                 
                                 
                                    4
                                 
                              
                           
                         is constrained by the training dataset. Nonetheless, we include both in the hierarchy for simpler representation of the pose tracking method. By introducing different levels with an increasing level of specificity, we incrementally vary the ability of generating new pose hypotheses while maintaining a certain level of constraints.

In this section, we introduce the Hierarchical Manifold Search (HMS) method, which is used to estimate the human pose through the hierarchy proposed in Section 2. Initially, we search the top level of the hierarchy, which represents the full body pose. Then, if the result of the observation function is not satisfactory, we search incrementally the remaining levels of the hierarchy, each of them representing a different division of the human body. This procedure allows taking full advantage of the hierarchy of manifolds which mitigates discrepancies between the testing and training datasets by permitting the estimation of unseen poses.

For every frame i, we optimise the observation function 
                           
                              f
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ,
                                                m
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             H
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         in two steps. Firstly, we initialise the global position and orientation 
                           
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                           
                         of the human model with the previous frame 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                    -
                                    1
                                 
                              
                           
                        . The observation 
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                           
                         generated for every frame i is compared with a human model hypothesis 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             p
                                          
                                          
                                             i
                                             -
                                             1
                                          
                                       
                                       ,
                                       m
                                    
                                 
                              
                           
                        by maximising the observation function 
                           
                              f
                              
                                 
                                    
                                       
                                          
                                             M
                                          
                                          
                                             i
                                          
                                       
                                       ,
                                       
                                          
                                             H
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                        , varying the global parameters 
                           
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                g
                                             
                                             
                                                i
                                             
                                          
                                          :
                                          
                                             max
                                          
                                          f
                                          
                                             
                                                
                                                   
                                                      
                                                         M
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         H
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The voxels that are spatially matched to the torso of 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                           
                         are removed from the observation 
                           
                              
                                 
                                    H
                                 
                                 
                                    i
                                 
                              
                           
                        . This allows faster evaluation of the observation function and also setting body constraints such as the arm not going through the body to avoid errors in the estimation of the limbs that are near the torso. Since the goal is to evaluate the hypotheses 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                           
                        , failure in torso estimation is penalised giving a lower score compared to a hypothesis with a well-located torso. If the position of the torso is accurate then by removing the torso voxels, errors are avoided in the estimation of the limbs that are near the torso. If the position of the torso is not accurate, then it also introduces a similar error in the cost function even if the torso is not removed.

Secondly, the pose 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         of the current frame i is estimated. Specifically, a process is applied through the hierarchy, as illustrated in Fig. 8
                        . We apply the following algorithm to each TLE manifold l, for each TLE-constrained level h.

Initially, a new hypothesis 
                           
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         for frame i is generated (Fig. 8, S1). If 
                           
                              h
                              =
                              1
                           
                        , the pose from the previous frame is projected to the pose subspace 
                           
                              
                                 
                                    P
                                 
                                 
                                    1
                                    ,
                                    1
                                 
                              
                           
                        , i.e.
                           
                              (22)
                              
                                 
                                    
                                       p
                                    
                                    
                                       1
                                       ,
                                       1
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       p
                                    
                                    
                                       i
                                       -
                                       1
                                    
                                 
                              
                           
                        otherwise if 
                           
                              h
                              >
                              1
                           
                         the point from the pose subspace 
                           
                              
                                 
                                    l
                                 
                                 
                                    ′
                                 
                              
                           
                         , from the previous hierarchical level 
                           
                              h
                              -
                              1
                           
                         is projected to the child pose subspace 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         using the projection function 
                           
                              
                                 
                                    ω
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         (Eq. (15)) to restrict the part of the human model that is searched:
                           
                              (23)
                              
                                 
                                    
                                       p
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ω
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                -
                                                1
                                                ,
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then, the model hypothesis is compared to the observation using the observation function (Fig. 8, S2) (Eq. (20)).

If the match is sufficiently large (Fig. 8, S3a), i.e.
                           
                              (24)
                              
                                 f
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 >
                                 T
                              
                           
                        where T is linked to the required accuracy, searching the current subspace 
                           
                              (
                              h
                              ,
                              l
                              )
                           
                         and its child subspaces in the hierarchy 
                           
                              (
                              h
                              +
                              1
                              ,
                              l
                              )
                              ,
                              (
                              h
                              +
                              2
                              ,
                              l
                              )
                              ,
                              …
                           
                         is omitted. Therefore, the final estimation for this subspace is given as: 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         and HMS proceeds with the manifolds of the next body parts 
                           
                              l
                              +
                              1
                           
                         and levels 
                           
                              h
                              +
                              1
                           
                         (S1).

Otherwise, the hypothesis is assumed unsatisfactory and the high dimensional point 
                           
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         is projected to the low dimension space 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          d
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                         to find a better estimate (Fig. 8, S3b):
                           
                              (25)
                              
                                 
                                    
                                       q
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then, the solution is constrained using the Activity Manifold that represents the articulate poses of the training dataset. Specifically, HMS initialises the manifold search with the closest point 
                           
                              
                                 
                                    
                                       
                                          q
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         on the manifold to the point 
                           
                              
                                 
                                    q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         in 
                           
                              
                                 
                                    Q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         (Fig. 8, S4).

Afterwards, the local maximum is searched by optimising the observation function on the manifold surface. A gradient descent optimisation algorithm is used in order to find a local maximum where putative solutions are evaluated and scored in the high-dimensional space using the observation function. More specifically, this is achieved by following the four following sub-steps (Fig. 8, S5).

A point 
                           
                              
                                 
                                    q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    r
                                 
                              
                              ∈
                              
                                 
                                    Q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                           
                         is selected using a gradient-based optimisation algorithm (Fig. 8, S5a). The point 
                           
                              
                                 
                                    q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    r
                                 
                              
                           
                         is back-projected to the high dimensional space 
                           
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          D
                                       
                                       
                                          h
                                          ,
                                          l
                                       
                                    
                                 
                              
                           
                         of human pose (Fig. 8, S5b). Let 
                           
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    r
                                 
                              
                           
                         be the point after the projection
                           
                              (26)
                              
                                 
                                    
                                       p
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       r
                                    
                                 
                                 =
                                 
                                    
                                       φ
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       ′
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                q
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                r
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The observation function of the point 
                           
                              
                                 
                                    p
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    r
                                 
                              
                           
                         is estimated (Fig. 8, S5c):
                           
                              (27)
                              
                                 
                                    
                                       f
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       r
                                       ,
                                       i
                                    
                                 
                                 =
                                 f
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                r
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The search continues (Fig. 8, S5d) until the observation function converges to a solution. Finally, the output of the algorithm is the optimal point 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         that maximises the observation function 
                           
                              
                                 
                                    f
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                                 
                                    r
                                    ,
                                    i
                                 
                              
                           
                         (Fig. 8, S6)
                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       h
                                       ,
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                p
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                r
                                             
                                          
                                          :
                                          
                                             
                                                
                                                   max
                                                
                                                
                                                   r
                                                
                                             
                                          
                                          
                                          
                                             
                                                f
                                             
                                             
                                                h
                                                ,
                                                l
                                             
                                             
                                                r
                                                ,
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

At the last level 
                           
                              
                                 
                                    h
                                 
                                 
                                    ′
                                 
                              
                           
                         of the hierarchy, Limb Correction may be applied to refine the solution in an unconstrained space only if no satisfactory solution is found through searching all the previous levels of the hierarchy, according to the threshold T [24]. This process is decomposed in five steps and depicted in Fig. 9
                        .

(Fig. 9, Step 1) The hypothesis of the limb 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         is compared to the observation using the observation function. If the pose 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         derived through searching in 
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    l
                                 
                              
                           
                        , is not satisfactory according to the threshold T, i.e.:
                           
                              (29)
                              
                                 f
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                -
                                                1
                                                ,
                                                l
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 <
                                 T
                              
                           
                        then we further search for the optimal solution in the high-dimensional limb pose space and proceed to Step 2. Otherwise, the current limb estimate is considered to be sufficiently accurate.

(Fig. 9, Step 2) Then a deterministic optimisation method is applied to detect the optimal position of the limb. We search for the rotation angle θ of the limb that optimises the observation function for the limb 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                        . Since the solution space may be represented by the surface of a sphere that comprises all the possible position of the limb rotating around the articulation joint, searching is performed on that surface: the point 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         is selected using a gradient-based optimisation algorithm.

(Fig. 9, Step 3) The observation function of the limb pose 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    1
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         is estimated:
                           
                              (30)
                              
                                 
                                    
                                       f
                                    
                                    
                                       θ
                                       ,
                                       i
                                    
                                 
                                 =
                                 f
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                -
                                                1
                                                ,
                                                l
                                             
                                             
                                                θ
                                             
                                          
                                          ,
                                          
                                             
                                                H
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

(Fig. 9, Step 4) The estimated pose is fed back to Step 3 until the observation function converges to a solution.

(Fig. 9, Step 5) After maximising the function 
                           
                              
                                 
                                    f
                                 
                                 
                                    θ
                                    ,
                                    i
                                 
                              
                           
                         in steps 3 and 4, the final pose estimate 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                       
                                          ̇
                                       
                                    
                                 
                                 
                                    
                                       
                                          h
                                       
                                       
                                          ′
                                       
                                    
                                    ,
                                    l
                                 
                                 
                                    i
                                 
                              
                           
                         is the output for limb j.
                           
                              (31)
                              
                                 
                                    
                                       
                                          
                                             p
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       
                                          
                                             h
                                          
                                          
                                             ′
                                          
                                       
                                       ,
                                       l
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 arg
                                 
                                    
                                       
                                          max
                                       
                                       
                                          θ
                                       
                                    
                                 
                                 
                                    
                                       f
                                    
                                    
                                       θ
                                       ,
                                       i
                                    
                                 
                              
                           
                        
                     

At the end, the pose of the model 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         is estimated by concatenating the body parts estimated at the last level of the hierarchy.
                           
                              (32)
                              
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                2
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ,
                                                n
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Thus, the estimated human model 
                           
                              
                                 
                                    M
                                 
                                 
                                    i
                                 
                              
                           
                         is
                           
                              (33)
                              
                                 
                                    
                                       M
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          m
                                          ,
                                          
                                             
                                                g
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    g
                                 
                                 
                                    i
                                 
                              
                           
                         is the global position and m is a known matrix from the initial frame. Level of freedom between body parts is gradually increased (and at the same time the level of coordination decreases) through the hierarchy since “range of motion from one limb is directly influenced by the pose of the connecting structure” and decided dynamically for every pose when there is an indication that keeping the coordination of the limbs leads to unsatisfactory fitting to the observation.

HMS allows a data-driven efficient search of the hierarchy of manifolds, compared to previous hierarchical approaches, [25,10]. The threshold T controls this search, i.e. the lower the threshold, the lower accuracy is needed, the faster the search is performed and the least the solution deviates from the training dataset, as shown in Section 4. Although our approach is based on gradient-descent optimisation, the hierarchy structure minimises the problem of being trapped into a local optimum, by searching again limb configurations at different levels, as shown in the results presented later.

@&#EXPERIMENTAL RESULTS@&#

In this section, HMS method is validated using publicly available datasets and compared with state-of-the-art human pose tracking methods. The sensitivity of the method to the different parameters, such as the number of hierarchy levels or accuracy thresholds is also analysed in order to calculate the trade-off between computational cost and accuracy.

We evaluate HMS on publicly available dataset. Specifically, we use the multiple activity sequences of the HumanEva (HE) II dataset [7], i.e. HEII-S2 frames 1–710 (1–390 walking, 391–710 jogging), HEII-S4, frames 4–710 (4–370 walking, 371–710 jogging) and Image & MOCAP Synchronized Dataset (IMS) [29]. For all sequences we used human activities captured by 4 cameras and calibration information for each of them. In all experiments, the ground truth pose of the first frame of the sequence of interest is used to both generate the human model 3.2 and initialise the tracker. The standard metric proposed by Sigal et al. [28] is used to quantitatively evaluate the results. Error is calculated for each of the 15 points of the skeleton representation as the Euclidean distance between the point of the estimated skeleton and the corresponding point of the ground truth.

A training dataset is used to generate the HTLE models as discussed in 2.2. Training and testing datasets are always different. For the HumanEva dataset, walking and jogging HTLE models are estimated using 1443 skeleton poses from the HEI-S2 walking, trial-3 and 795 skeleton poses from the HEI-S2 jogging, trial-3 sequences respectively. The same training dataset is used for all experiments for each activity to demonstrate the generalisation properties of the HMS method. In Fig. 10
                         the human poses that correspond to the training data set 
                           
                              
                                 
                                    P
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    D
                                 
                              
                           
                         and the corresponding manifolds in 2D, 
                           
                              
                                 
                                    Q
                                 
                                 
                                    h
                                    ,
                                    l
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         are shown for different levels of the hierarchy h and pose subspace l.

In this section, we investigate different configurations of the HMS method by evaluating different sets of levels in the hierarchy and different values of the threshold T.


                        Fig. 11
                         shows the average error and the computational time per frame for 150 frames of the IMS dataset for different HMS configurations. As shown in Fig. 11(a) by increasing the levels of the hierarchy, the estimated error decreases for every threshold. Furthermore, for increasing threshold the error decreases in all configurations. Likewise, as shown in Fig. 11(b), computational cost (mean number of observations per frame for all frames) grows with increasing levels of hierarchy since it leads to a higher number of subspaces that are searched in every level as seen in Fig. 7. Finally, computational cost increases for increasing thresholds. Fig. 11(c) shows the mean number of observation evaluations per frame for different thresholds and levels of the hierarchy in the HMS(1–5) configuration. The mean number of observations per frame for every level increases for increasing threshold. Therefore, different configurations of HMS provide flexibility on compromising between computational cost and accuracy, demonstrating the value of the hierarchy.

Once the threshold reaches 0.8, error and computational cost are almost constant since the maximum value of the observation function is near 0.8. Finally, computational cost depends on many parameters. For these experiments we used an IntelCore 2 laptop with unoptimised code written in Matlab. Computational costs vary from 4s to 55s per frame.

In order to compare the HMS method with state-of-the-art methodologies we apply HMS to the Walking activity of HEII-S2 (frames 1–390), HEII-S4 (frames 4–297) and HEI-S1walking1 (frames 1–590) and to the Jogging activity of HEII-S2 (frames 391–710) and HEII-S4 (frames 371–790). For every activity we use the corresponding training dataset as discussed in Section 4.2. For all sequences, 4 cameras are used and the ground truth for the first frame initialises the tracker. Since ground truth is not known for the full length of the sequences, the results of the HMS method were evaluated using the online evaluation system of the HumanEva website [7]. Our method is quantitatively evaluated against MP (Manifold Projection) method, MPLC (Manifold Projection Limb Correction) method [24], APF that demonstrates state-of-the-art performance according to [28,3] and applications of APF in low-dimensional spaces, i.e. GPAPF [26], H-APF [25].

In Table 1
                         we present the average absolute 3D error, [28], for GPAPF and MP, and the corresponding hierarchical methods, i.e. H-APF and HMS. We also present the complexity (mean number of observations per frame) for every method. In this experiment, a threshold 
                           
                              T
                              =
                              1
                           
                         (Eq. (24)) is set for HMS to achieve optimal results. These results demonstrate the value of introducing hierarchy in dimensionality reduction based approaches, as hierarchical methods performed better than the original ones, and improved computational efficiency and accuracy compared with GPAFP and H-APF. Our decision to base our dimensionality reduction framework on TLE is confirmed by the comparison between TLE-based and GPLVM-based representations. Specifically, MP and HMS outperforms in most of the cases GPAPF and H-APF, respectively. In Table 1 we also compare the MPLC method with HMS. HMS outperforms the MPLC method in all cases.

In Fig. 12
                         we show the average error per frame for HE-II S2 walking and HE-II S4 walking datasets for MP (blue line) and HMS(1–5) (red line) methods using threshold 
                           
                              T
                              =
                              1
                           
                        . HMS(1–5) clearly improves over MP in all datasets (see Table 1). This confirms the value of using the hierarchy.


                        Fig. 13
                         displays the average absolute 3D error for APF and HMS using different particle numbers and thresholds respectively and their computational costs as measured on the same machine using Matlab implementations for both methodologies. HMS using 
                           
                              T
                              =
                              1
                           
                         generally outperforms APF both in terms of error and complexity. Moreover, the figure suggests that HMS is able to deliver similar accuracy to any APF configuration using only 5–25% of processing time. The low complexity of our method comes from the hierarchical searching strategy that is driven by the observation function. Furthermore, the combination of a hierarchical approach with a search that occurs beyond the training dataset results in improved accuracy. In summary, HMS methodology achieves the best overall accuracy with the lowest computational complexity.

In Fig. 14
                         we show the average error per frame for HE-II S2 walking and jogging dataset using HMS(1–5) for lower body (red line), upper body (blue line) and full body (black line). The training dataset is the walking activity as described in Section 4.2. The average error for the lower body is 63.7mm (57mm for walking and 70.4mm for jogging), for the upper body is 96.2mm (69.2mm for walking and 123.2mm for jogging) and for the full body is 79.6mm (63.1mm for walking and 96.7mm for jogging). As expected, error in the walking sequence (frames 1–390) is lower than that of the jogging activity (frames 390–710), since training was based on walking data. More specifically, error in the jogging activity is higher mainly because of upper body error: in the tested jogging activity, arm positions are significantly dissimilar from those found in the walking dataset, especially when arms are near to the torso. Since the latter configuration is periodical over the jogging activity, a cyclic pattern of error is observed in Fig. 14. On the other hand, although a walking activity was used for training, leg positions were estimated accurately for both walking and jogging activities. These results suggest that our methodology is able to track different styles efficiently to the extend that these are not significantly dissimilar to the training set, so they can still be considered as a variation of the same given activity.

In Figs. 15–17
                        
                        
                         we display tracking results of HMS(1–5) with threshold 1 for the datasets used in the study.

@&#CONCLUSIONS@&#

This paper presents a human pose tracking methodology relying on two novel techniques. Firstly, a hierarchical method based on dimensionality reduction for human pose tracking is proposed. The hierarchical dimensionality reduction method, HTLE, based on TLE dimensionality reduction method, has been designed for human pose tracking as it takes into account the hierarchical representation of the human body. This allows the decoupling from the structure of the training dataset and the exploration of unseen poses.

Secondly, we introduce a method, HMS, which deterministically searches through the hierarchy of low dimensional manifolds and is driven by an observation function. HMS allows searching in a constrained space for every level of the hierarchy, so it requires a low number of evaluations of the observation functions and therefore low computational resources. In addition, searching through the hierarchy is able to estimate unseen poses.

Results were presented using publicly available benchmarks, such as the multi-camera HumanEva. Comparisons with state-of-the-art methods demonstrate the accuracy and efficiency of our approach.

@&#REFERENCES@&#

