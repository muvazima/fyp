@&#MAIN-TITLE@&#Spatial histograms of soft pairwise similar patches to improve the bag-of-visual-words model

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A new approach to improve image representation for category level classification.


                        
                        
                           
                           We encode pairwise relative spatial information of patches in the bag of word model.


                        
                        
                           
                           A simple approach complementary to the Spatial Pyramid Representation (SPR).


                        
                        
                           
                           Can be combined with SPR and outperforms other existing spatial methods.


                        
                        
                           
                           Experimental validation of the approach is shown on 5 challenging datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spatial information

Object classification

Angle and distance histograms

Bag-of-words

@&#ABSTRACT@&#


               
               
                  In the context of category level scene classification, the bag-of-visual-words model (BoVW) is widely used for image representation. This model is appearance based and does not contain any information regarding the arrangement of the visual words in the 2D image space. To overcome this problem, recent approaches try to capture information about either the absolute or the relative spatial location of visual words. In the first category, the so-called Spatial Pyramid Representation (SPR) is very popular thanks to its simplicity and good results. Alternatively, adding information about occurrences of relative spatial configurations of visual words was proven to be effective but at the cost of higher computational complexity, specifically when relative distance and angles are taken into account. In this paper, we introduce a novel way to incorporate both distance and angle information in the BoVW representation. The novelty is first to provide a computationally efficient representation adding relative spatial information between visual words and second to use a soft pairwise voting scheme based on the distance in the descriptor space. Experiments on challenging data sets MSRC-2, 15Scene, Caltech101, Caltech256 and Pascal VOC 2007 demonstrate that our method outperforms or is competitive with concurrent ones. We also show that it provides important complementary information to the spatial pyramid matching and can improve the overall performance.
               
            

@&#INTRODUCTION@&#

In category level and scene classification, the bag-of-visual-words (BoVW) method, first introduced by [1,2], has shown excellent results in recent years [3,4]. In this method, an image is represented as a histogram of quantized local features called visual words. However, being orderless, histogram representations do not provide any spatial information. This is considered to be one of the major drawbacks of this very successful method.

Different methods have been proposed to incorporate spatial information into the BoVW representation [3,5–8]. Some of these approaches use spatial context before the vocabulary construction step to incorporate spatial information [9–11]. The spatial context is defined at the local feature level as a set of descriptors extracted form neighboring regions so as to enrich the description around a feature point. For example in [11], the authors create pairs of local neighbor SIFT descriptors, concatenate them and construct the vocabulary from these 256-D combined features instead of from the classical individual 128-D SIFT. Alternatively, most of the approaches work at the visual word level. They model the spatial arrangements of visual words on the 2D image space as an additional step [3,5,8,12–17]. These later methods are more popular as they obtain superior classification accuracies. It is due to the fact that they are able to capture both local and global relationships among the visual words.

In this context, the Spatial Pyramid Representation (SPR) [3] is probably the most notable work. Its principle relies on the division of an image into sub-windows and the computation of a local BoVW histogram in each. Two images are then compared by using an intersection kernel computed between the two corresponding sets of histograms.

Although SPR performs very well, it only captures the information about approximate absolute locations of the visual words in images. An alternative consists in extracting relative spatial interactions between the visual words [7,17,14,18–20]. In these representations, the absolute location of each visual word is lost but, for example, information about visual words that are frequently co-occurring together at a certain distance is taken into account. However, the abundance of visual words in an image makes it computationally expensive to explicitly model relative spatial relationships among visual words. Thus, methods like [6,7] employ vocabulary compression or feature selection and model only local or semi-local spatial information to speed up the computation. Nevertheless, Elfiky et al. [21] have shown that vocabulary compression before spatial information extraction results into declined classification performance. In another work, Parikh [22] examines the human vs machine performance on jumbled images and concludes that existing machine vision techniques are already effective in modeling local information from images, thus future research efforts should be focused on more advanced modeling of global information.

Based on these observations, in this work, we propose a way to model the global and local relative spatial distribution of visual words over an image. To do so, we introduce the concept of soft pairwise spatial angle-distance histograms to capture the distribution of similar descriptors. The term “soft” means that we apply a soft weighting strategy in a similar way as soft assignment techniques [23,24].

The novelty compared with previous approaches is threefold: (i) enabling infusion of pairwise relative spatial information (modeling both distances and angles between visual words while most of the approaches consider only distances), (ii) adopting a simple word selection scheme that avoid combinatorial explosion, and (iii) combining hard assignment for visual word selection and soft assignment to weight the contribution of descriptor pairs in spatial histograms.

We experimentally evaluate our new representation on classification tasks with various challenging data sets. The aim is both to study the influence of various parameters of the method and to compare the performances over state of the art concurrent approaches.

The rest of the paper is organized in the following way: the next section describes a review of the related works. Section 3 presents our approach to incorporate spatial information into the BoVW representation. Section 4 describes the implementation details and Section 5 presents the results on different benchmarks and comparisons with several other methods. Section 6 concludes the article pointing towards our future works.

@&#RELATED WORKS@&#

There exist two main approaches to incorporate spatial information in the BoVW representation, the difference being the information added over the classical BoVW, i.e. either the approximate absolute positions of the visual words or the relative positions between these visual words.

The SPR [3] is the most widely used method among the ones representing absolute spatial coordinates. Its principle relies on the division of an image into a sequence of increasingly coarser grids (eg. 4 by 4, 2 by 2 and 1 by 1) and on the computation of a local BoVW in each cell. Two images are then compared using an intersection kernel computed between the two corresponding sets of histograms. Bosch et al. [25] have generalized the intersection kernel with other quasi-linear kernels like chi-square and learned weights for each pyramid level rather than using fixed weights. Another weight learning method was proposed for SPR in [26]. More recently, in [27] Cao et al. proposed to extract local BoVW from more sub-windows than in SPR with different shapes (not only rectangular) and to select the best ones with a supervised approach. Finally, in [12], Krapac et al. encode the absolute region locations of each visual word using the Fisher kernel.

Among the methods that add spatial relative interactions between the visual words, the most straightforward approaches are those based on correlograms [7,17]. The color correlograms have been introduced by Huang et al. in [28]. The idea was to represent the distribution of color pairs as a function of the spatial distance between these colors in the image. Savarese et al. extend this representation to the distribution of pairs of visual words in the image plane. Thus, given K visual words and T distances, the dimension of one correlogram is 
                        
                           K
                           ×
                           K
                           ×
                           T
                        
                     . Then, the authors propose to cluster the T-dimensional vectors representing the evolution of the distribution of each pair across the T distances. The cluster representatives are called correlatons and the descriptor for one image is the histogram of correlatons. Consequently, in this final representation, only the spatial interactions between the visual words are accounted, regardless of the actual identities of these words.

Another way to incorporate relative interactions between visual words is to use visual phrases [14,18–20] in the final image representation. A visual phrase is a set of frequently locally co-occurring visual words. Most of the times, specific Frequent Itemset Mining (FIM) algorithms are applied in order to discover the most meaningful visual phrases since this selection is the key to these approaches. In [20], they consider only pairs of visual words located in a local neighborhood whose radius is related to the scale of the associated SIFT keypoint and use the supervised TF–IDF (Term Frequency–Inverse Document Frequency) information for the selection of the best visual phrases. In [19], they first select the 100 most frequent visual words and each visual word is paired with its 5 nearest neighbor in the image space. Unlike the previous approaches, in [14,18,29], the visual phrases can contain more than two visual words. Thus, specific FIM algorithms are required to select the best visual phrases among all the local visual word sets. Also, while the visual phrases from [14,18] consists of visual words co-occurring in a local neighborhood, the ones from [29] are not constrained by any locality properties. Indeed, in this last paper, the authors consider each image pair (
                        
                           I
                           ,
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                        
                     ) and for each pair of the same word in these images, they calculate their offset (
                        
                           Δ
                           x
                           ,
                           Δ
                           y
                        
                     ) which is the location of the word in the image 
                        
                           
                              
                                 I
                              
                              
                                 ′
                              
                           
                        
                      subtracted from its location in the image 
                        
                           I
                        
                     . Then a vote is applied in the offset space in order to detect geometry-preserving visual phrases. In one cell of this offset space are falling all the words whose offset is similar between the two images, but the information about the spatial distribution in the image spaces of the visual words belonging to the same visual phrase is lost. In order to cope with this problem, the authors propose to store in memory the locations of each visual word occurrence within each image. This information is used during the image comparison step. Using a similar storage approach, Wu et al. [30] bundle visual words falling in the same local neighborhood, i.e. the same MSER regions [31]. Then, the orders of the visual words along the x and y axis within each local group is saved in memory and this information is used during the comparison step in order to check the approximate relative positions of the words within each detected MSER region. These two last approaches save more information in memory than the single histogram-like structure and this requires a particular comparison step during the test phase. Even if the approach of [32] is a bit different from the previous papers, the ideas are similar in the sense that, in this paper, the authors also exploit frequently locally co-occurring visual words to describe images. Indeed, they propose to extract several local BoVW on a grid (as done in the SPR approach) from the images of the dataset and to apply vector quantization on these local BoVW. The cluster representatives are “second order” visual words from which second order BoVW can be computed. And iteratively, the authors extend the classical “first order BoVW” to “nth order BoVW”. Obviously, these BoVW contain information about the local spatial interactions between the original visual words.

All the previous papers dealing with relative visual words locations, only consider the distances between the visual words as supplementary information over the classical BoVW. In [33], we have rather proposed to incorporate angle information in the final representation. Hence, we have shown that global spatial orientations of patch pairs whose corresponding visual words are the same (called intra-type visual word pairs) are discriminative and significantly improve the classification accuracy. The approach proposed by Liu et al. in [6] has the advantage that it considers both distances and angles between the visual words and by this way represents more accurately the relative positions of the visual words in the image space. Nevertheless, this whole information requires much more memory space and computational time during both training and testing steps. Thus, the authors introduce an integrated feature selection and spatial information extraction technique to reduce the number of features and also to speed up the process. The process of feature selection and second order feature (e.g. spatial information) extraction are run alternatively at each iteration of the algorithm. At each round, feature selection selects one feature, and feature extraction pairs this feature with each of the previously selected features. The final image representation is constructed by the concatenation of the first and second order features.

Finally, these works show that both absolute and relative spatial information improve the classification accuracy over the classical BoVW. Consequently, the current trend consists in combining these two information into the final representation [16,34,35] in order to boost the results. For example, in [34], spatial predicates are introduced and, given a spatial predicate, a co-occurrence matrix is computed over all the visual word pairs. In their approach, an image is represented as a set of co-occurrence matrices of size 
                        
                           K
                           ×
                           K
                        
                      (if K is the number of visual words) and thus they must limit the size of the vocabulary and the number of considered spatial configurations. Moreover, spatial distances are defined in an absolute way inside a region of a pyramid. In [35], Harada et al. incorporate local spatial information by evaluating local auto-correlations between the extracted descriptors and global information by weighting differently the contribution of each cell of a regular grid superimposed to the image (as done by SPR). These weights are learned so that they are related to the discriminative power of the considered cells, given a classification task. Thus, in most of the works combining absolute and relative spatial information, the relative spatial information is combined with the reference SPR approach. Consequently, in this paper, we propose to design a new descriptor that represents the relative spatial information and that is complementary to the SPR descriptor. Our original idea is to account both the distances and the angles between the visual words by using the notion a soft-similarity, which allows us to avoid a complex selection step as required in [6].

The principle of our method is to use pairwise spatial histograms to encode spatial co-occurrence of similar word pairs. In this section we first present original pairwise spatial histograms introduced by Liu et al. [6], then we introduce pairwise spatial histograms of similar patches and finally our image representation.

In the standard BoVW model, an image is represented as a histogram of occurrences of its visual words [1]. More formally, a set of local descriptors 
                           
                              {
                              
                                 
                                    d
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    4
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    d
                                 
                                 
                                    N
                                 
                              
                              }
                           
                         is first extracted from a sampled set of image patches [36]. Each descriptor 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         is a vector giving the description of the image patch i and N is the total number of patches in the image. The visual vocabulary 
                           
                              W
                              =
                              {
                              
                                 
                                    w
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    4
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    w
                                 
                                 
                                    K
                                 
                              
                              }
                           
                         is obtained by typically applying an unsupervised K-means clustering on a large set of descriptors from training images. Each visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                         represents a cluster center, K being the vocabulary size, i.e. the number of predefined clusters. Each patch i of the image is assigned to a visual word which corresponds to the nearest center in the descriptor space. If soft assignment or sparse coding is used [23,24,37], the patch is assigned to a weighted set of visual words. The final histogram is obtained by pooling the contribution of each visual word over the whole image or over spatial regions.

In Liu et al. [6], a pairwise spatial histogram is defined according to a discretization of the spatial neighborhood into several bins encoding the relative spatial position (distance and angle) of two visual words (Fig. 1
                        ). Given a pair of visual words 
                           
                              (
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    l
                                 
                              
                              )
                           
                        , all the pairs of patches 
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         such that 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         is of type 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                           
                         is of type 
                           
                              
                                 
                                    w
                                 
                                 
                                    l
                                 
                              
                           
                         are considered. Then, a pairwise spatial histogram associated to 
                           
                              (
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    l
                                 
                              
                              )
                           
                         is defined as the count of all occurrences of 
                           
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                           
                         falling into a specific spatial bin relatively to 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                        , the count being averaged for all instances of 
                           
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                           
                         (Fig. 1).

The number of possible pairs of visual words is potentially very large and thus, Liu et al. proposed to select only discriminative pairs with a feature selection method based on Discrete AdaBoost with decision stumps as in [38]. In [33], we have proposed another alternative which is to consider only pairs of identical visual words. The motivation came from the previous works [39,40] where the authors have argued that modeling the distribution of similar cues across an image can give discriminative information about the content of that image. Fig. 2
                         shows an example which gives an intuition to better understand the idea. In this illustration, we consider patches associated with the same visual word as similar cues.

The notions of similar cues and similar words are not equivalent. If we consider clusters delimiting visual words in the descriptor space, two cues at the cluster borders could be very similar being in different clusters. Similar cues in this context are more related to a small inter-patch distance in the descriptor space.

This problem is similar to the visual word ambiguity problem which has been discussed in many works on the BoVW model. Indeed, the vector quantization applied at the visual word assignment step introduces ambiguity if the considered descriptor is at an intermediate position between several cluster centers [41]. To address this issue, soft assignment approaches have been introduced. Their principle is to use the distance in the descriptor space to compute a weight or a probability estimate associated to a given visual word [23,24,42].

Hence, we propose to analyze the spatial positions of the patches which are situated in proximity in the descriptor space. To avoid the use of a threshold to identify similar patches (hard similarity), we consider all the pairs of patches and we weight the contribution of each pair as a decreasing function 
                           
                              g
                              (
                              x
                              )
                           
                         of their distance x in the descriptor space (soft similarity). We propose to use a Gaussian function of standard deviation 
                           
                              α
                           
                         defined as:
                           
                              (1)
                              
                                 g
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       α
                                       
                                          
                                             2
                                             π
                                          
                                       
                                    
                                 
                                 
                                    
                                       e
                                    
                                    
                                       -
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                          
                                          
                                             2
                                             
                                                
                                                   α
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        This parameter gives us the control to highly weight patches that are in close proximity in the descriptor space and to ignore the ones which are far. More information about the choice of this parameter can be found in Section 4.2. More formally, we consider the set 
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                           
                         of all the pairs of patches where at least one patch in the pair belongs to the visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                        . A given pair 
                           
                              (
                              
                                 
                                    P
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    P
                                 
                                 
                                    j
                                 
                              
                              )
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                           
                         is characterized both by a pair of descriptors 
                           
                              (
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         and a pair of positions in the image space denoted 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         (Fig. 3
                        ). Note that both 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                           
                         and 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         are vectors with 
                           
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    D
                                 
                              
                           
                         (descriptor space) and 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                           
                         (image space). A pairwise spatial histogram of similar patches is then defined considering a discretization of the image space into M bins denoted 
                           
                              {
                              
                                 
                                    b
                                 
                                 
                                    m
                                 
                              
                              ,
                              m
                              =
                              1
                              ,
                              …
                              ,
                              M
                              }
                           
                         with an angle 
                           
                              θ
                              ∈
                              [
                              0
                              ,
                              π
                              [
                           
                         split into 
                           
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                           
                         equal angle bins and the radius 
                           
                              r
                              ∈
                              [
                              0
                              ,
                              R
                              ]
                           
                         split into 
                           
                              
                                 
                                    M
                                 
                                 
                                    r
                                 
                              
                           
                         radial bins so that 
                           
                              M
                              =
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    r
                                 
                              
                           
                        . For example, in the illustration at the bottom of Fig. 3, the total number of bins M is equal to 15 (
                           
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                           
                        
                        =5 and 
                           
                              
                                 
                                    M
                                 
                                 
                                    r
                                 
                              
                           
                        
                        =3). The values of 
                           
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    M
                                 
                                 
                                    r
                                 
                              
                           
                         will be determined in the experimental section and the maximum radius R is chosen to be the diagonal of the image, in order to reduce scale sensitivity. Note that by using such maximum value for the radius, the representation may indirectly capture the absolute spatial location since patches located close from the image borders have a more limited number of possible angles and distances for pairing. In all spatial methods, such border effects exist and are difficult to quantify.

The count 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Soft
                                    -
                                    Inter
                                 
                              
                              (
                              m
                              )
                           
                         of bin 
                           
                              
                                 
                                    b
                                 
                                 
                                    m
                                 
                              
                           
                         of the spatial histogram of similar pairs 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Soft
                                    -
                                    Inter
                                 
                              
                           
                         corresponding to the visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                         is then given by:
                           
                              (2)
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                    
                                       Soft
                                       -
                                       Inter
                                    
                                 
                                 (
                                 m
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 g
                                 
                                    
                                       
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        where 
                           
                              |
                              
                                 
                                    d
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    d
                                 
                                 
                                    j
                                 
                              
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                           
                         is the 
                           
                              
                                 
                                    ℓ
                                 
                                 
                                    2
                                 
                              
                           
                         distance in the descriptor space and 
                           
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                           
                         is the indicator function of bin 
                           
                              
                                 
                                    b
                                 
                                 
                                    m
                                 
                              
                           
                         such that:
                           
                              (3)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                             :
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   2
                                                
                                             
                                             →
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             v
                                             →
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                            
                                                               if
                                                               
                                                               v
                                                               ∈
                                                               
                                                                  
                                                                     b
                                                                  
                                                                  
                                                                     m
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                            
                                                            
                                                               otherwise
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that, due to symmetric considerations, angle bins are discretized in the 
                           
                              [
                              0
                              ,
                              π
                              [
                           
                         interval. Indeed, as the two members of a pair are related to the same visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                         (i.e. inside the corresponding cluster or not far from its border), only the absolute orientation modulo 
                           
                              π
                           
                         is registered. Thus, given a pair of positions 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         the corresponding histogram bin is determined by taking either 
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                           
                         or 
                           
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                           
                         as reference point which is equivalent to consider either 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         or 
                           
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         vectors (see Fig. 3).

To independently evaluate the benefits of using either the soft-weighting (over hard) or the inter-word pairs (over intra), we also introduce two other spatial histograms. The first one, called 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Inter
                                 
                              
                           
                        , is using only binary weights t defined as:
                           
                              (4)
                              
                                 t
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   x
                                                   <
                                                   3
                                                   α
                                                
                                             
                                             
                                                
                                                   0
                                                
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              α
                           
                         is still the standard deviation used in Eq. (1).

Then, the count 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Inter
                                 
                              
                              (
                              m
                              )
                           
                         of the bin 
                           
                              
                                 
                                    b
                                 
                                 
                                    m
                                 
                              
                           
                         is given by:
                           
                              (5)
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                    
                                       Hard
                                       -
                                       Inter
                                    
                                 
                                 (
                                 m
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                 
                                 t
                                 
                                    
                                       
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

The second one, called 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Intra
                                 
                              
                           
                        , is also using the same binary weight t but does not consider inter-words pairs (only intra). Formally, if 
                           
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                                 
                                    ∗
                                 
                              
                           
                         denotes the set of all the pairs of patches for which both patches belong to visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                        , the hard pairwise histogram 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Intra
                                 
                              
                           
                         is defined as:
                           
                              (6)
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                    
                                       Hard
                                       -
                                       Intra
                                    
                                 
                                 (
                                 m
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          (
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          )
                                          ∈
                                          
                                             
                                                S
                                             
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                                 t
                                 
                                    
                                       
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                d
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                |
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             m
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       p
                                    
                                    
                                       j
                                    
                                 
                                 -
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     

For a visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                        , Eqs. (2), (5) and (6) can be used to compute the entire histograms 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Soft
                                    -
                                    Inter
                                 
                              
                              ,
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Inter
                                 
                              
                           
                         and 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Intra
                                 
                              
                           
                         respectively. In the next section we introduce a way to combine a given set of spatial histograms 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                              
                           
                         into one image histogram.

As explained in the previous section, for each visual word 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                        , we obtain one spatial histogram. This histogram encodes spatial information (distance and orientation) of pairwise similar patches, where at least one of the patches belongs to 
                           
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                           
                        . This modularity facilitates simple way to assemble the spatial histograms and to obtain the final representation. Starting from the proposed word specific histogram 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Soft
                                    -
                                    Inter
                                 
                              
                           
                        , we define three different representations: the Soft Pairwise Similarity angle-distance histogram 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                 
                              
                           
                         derived from the classical BoVW histogram, 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                 
                              
                              +
                           
                         its combination with the SPR and 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                 
                                 
                                    1800
                                 
                              
                              +
                           
                         a compact version of 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                 
                              
                              +
                           
                        . On the other hand, word specific histograms 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Inter
                                 
                              
                           
                         and 
                           
                              
                                 
                                    H
                                 
                                 
                                    k
                                 
                                 
                                    Hard
                                    -
                                    Intra
                                 
                              
                           
                         are used to create hard pairwise similarity angle histograms 
                           
                              
                                 
                                    HPS
                                 
                                 
                                    ad
                                 
                                 
                                    Inter
                                 
                              
                           
                         and 
                           
                              
                                 
                                    HPS
                                 
                                 
                                    ad
                                 
                                 
                                    Intra
                                 
                              
                           
                         respectively.

To obtain the 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            representation from the classical BoVW histogram, we use a ‘bin replacement’ technique. Bin replacement literally means to replace each bin of the BoVW frequency histogram with the spatial histogram 
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                    
                                       Soft
                                       -
                                       Inter
                                    
                                 
                              
                            associated to 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                           . The sum of all the bins of the spatial histogram obtained from one visual word 
                              
                                 
                                    
                                       w
                                    
                                    
                                       k
                                    
                                 
                              
                            is normalized to the number of occurrences of this word in the whole image. The final whole histogram is subsequently 
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       1
                                    
                                 
                              
                            normalized as in the BoVW method. By this way, we keep the frequency information intact and add the spatial information. The dimensionality of our representation 
                              
                                 S
                                 =
                                 K
                                 ×
                                 M
                              
                            depends on the vocabulary size (K) and the number of angle-distance bins of the spatial histogram (M).

On the other hand, if we only use hard weighting t (Eq. (4)) instead of soft weighting g (Eq. (1)) as done in 
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                    
                                       Hard
                                       -
                                       Inter
                                    
                                 
                              
                            (Eq. (5)), we obtain a hard pairwise similarity histogram, denoted as 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Inter
                                    
                                 
                              
                           . And finally, if we just consider intra-type visual words pairs and hard weighting as done in 
                              
                                 
                                    
                                       H
                                    
                                    
                                       k
                                    
                                    
                                       Hard
                                       -
                                       Intra
                                    
                                 
                              
                            (Eq. (6)), the final representation is denoted 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Intra
                                    
                                 
                              
                           .

Since 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            represents the relative spatial interactions between the visual words in an image, it is complementary to descriptors that represent absolute locations of the visual words such as SPR. Thus, we propose to combine 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            with SPR. This concatenation (without any weights) is called 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                           . For a vocabulary size of K the dimensionality of 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            is 
                              
                                 K
                                 ×
                                 (
                                 1
                                 +
                                 4
                                 +
                                 16
                                 +
                                 M
                                 )
                              
                            because the number of local histograms are respectively 1, 4 and 16 in the 0th, 1st and 2nd levels.

One of the drawbacks of the 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            compared to SPR is the high dimensionality of the feature vectors. Typically, for a 
                              
                                 K
                                 =
                                 200
                              
                            words vocabulary and 
                              
                                 M
                                 =
                                 45
                              
                            angle-distance bins, the dimensionality of the feature vectors is 13,200. To get a more compact representation, dimension reduction techniques as feature selection or feature clustering can be applied. We propose to use a divisive information theoretic clustering (DITC) approach introduced by Dhillon et al. [43]. The DITC algorithm minimizes the within-cluster Jensen–Shannon divergence while simultaneously maximizing the between-cluster Jensen–Shannon divergence in a clustering like algorithm based on the estimation of the joint probability of a visual word in a class. This method was used by Elfiky et al. [21] to compress the SPR representation. They found that it provides the size reduction of a high dimensional pyramid representation up to an order of magnitude with little or no loss in accuracy. Alternative methods as the AdaBoost feature selection method integrated in Liu et al. approach [6] could also be used. Compared to this latter method which is based on a local optimization of the classification accuracy, DITC algorithm performs a global minimization of the loss of information due to feature clustering.

Starting from 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            with 
                              
                                 K
                                 =
                                 200
                              
                            and 
                              
                                 M
                                 =
                                 45
                              
                            (13,200 dimensions), we compress our feature vectors by DITC algorithm down to 1800 dimensions. We denote this representation as 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                    
                                       1800
                                    
                                 
                                 +
                              
                           .

Our representation differs on many points compared to original spatial histograms introduced by Savarese et al. [7] and refined by Liu et al. [6]. We present here the differences in the methodology and in the computational point of view.

On the methodological point of view all the three versions are based on pairwise spatial histograms (called correlogram elements in [7]). Each spatial histogram is associated to a specific pair of visual words 
                           
                              (
                              
                                 
                                    w
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    w
                                 
                                 
                                    l
                                 
                              
                              )
                           
                        . In the original versions, all the combinations of visual words are considered leading to 
                           
                              K
                              (
                              K
                              +
                              1
                              )
                              /
                              2
                           
                         possible histograms (K still denotes the number of visual words). In our version, only pairs of identical (or similar) visual words are considered leading to only K possible histograms. Another difference lies in the discretization of the spatial neighborhood. In [7], only distance divisions are considered whereas in [6] both distances and angle divisions are considered but in both cases, the neighborhood size is limited to a certain distance in pixels or in function of the patch size. In our case, the neighborhood size is relative to the image size and thus covers the whole image. Moreover, compared to [6], our distance divisions are linear and our angles covers only the 
                           
                              [
                              0
                              ,
                              π
                              [
                           
                         due to symmetric considerations. Also note that angles are measured absolutely which does not provide invariance of the representation to image rotations but prevent the decrease of discriminative power in object categorization [44].

Concerning computation, the main point is that we avoid the combinatorial explosion by considering only similar word pairs. First, it limits the size of the final histograms (which becomes linear on K) and second it makes unnecessary to apply any additional clustering technique (as in [7]) or additional feature selection step (as in [6]). Note that we still need to consider all the patch pairs of an image (complexity 
                           
                              O
                              (
                              
                                 
                                    N
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        ), but in practice, we can fix an upper limit on the number of pairs and choose them randomly to cut down the complexity.

In this section, we present the data sets used and the implementation details. Then, we evaluate different aspects of the 
                        
                           
                              
                                 SPS
                              
                              
                                 ad
                              
                           
                        
                      representation for image classification.

For this work, we use MSRC-v2, 15Scene, Caltech101, Caltech256 and Pascal VOC 2007 data sets for experiments.

This subsection provides short descriptions of these image data sets.


                        MSRC-v2: In this data set, there are 591 images that accommodate 23 different categories. All the categories in the images are manually segmented. Different subsets of these categories have been used by several authors to derive a classification problem in which each region or image is assigned to a class label [7,45].


                        15Scene: This data set [3,4,46] comprises indoor (i.e. office, kitchen, bedroom, etc.) and outdoor (i.e. beach, mountain, tall building, etc.) scenes. Images were collected from different sources, predominantly from Internet, COREL collection and personal photographs. Each category has 200–400 images.


                        Caltech101: The Caltech101 data set [47] has 102 object classes. It has been widely used for evaluation purpose but has some limitations. Namely, most images feature relatively little clutter and possess homogeneous backgrounds. In addition, there are very less variations among the objects of the same category. Despite the limitations, this data set is quite a good resource containing a lot of interclass variability.


                        Caltech256: This is a challenging set of 257 object categories containing a total of 30,607 images [48]. The minimum number of images in any category is 80. This dataset is collected the same way as Caltech101 while coping with its limitations.


                        Pascal VOC 2007: The challenging Pascal VOC 2007 database
                           1
                           
                              http://pascallin.ecs.soton.ac.uk/challenges/VOC/voc2007/index.html.
                        
                        
                           1
                         is constituted of images downloaded from internet, containing 9,963 images split into train, val and test sets. Each of the images contains at least one occurrence of the 20 object classes. In many images there are objects of several classes present. Altogether the images contain 24,640 objects. The most common object class (“person”) is present in 
                           
                              40
                              %
                           
                         of the images, the rarest (“sheep”) in 
                           
                              1.9
                              %
                           
                        .

@&#IMPLEMENTATION DETAILS@&#

For MSRC-v2 data set we selected the 15 classes: building, grass, tree, cow, sheep, sky, aeroplane, face, car, bike, flower, sign, bird, book, and chair as in [6,7]. We used filter-bank responses for feature extraction as in [6,7]. The training and testing sets are also chosen in accordance with those works for the sake of comparison. For Caltech101 and 15Scene, we follow the experimental setup consistent with [3]. Thus, we use single scale dense detector (8 pixels period) and SIFT descriptor (16 pixels size) for feature extraction. To be able to compare our results with other spatial representations, we use the standard BoVW representation (hard assignment). Finally, for Caltech256 and Pascal VOC 2007, we use the experimental setup of [49] i.e. a dense SIFT detector sampled every three pixels at four scales (16, 24, 32 and 40 pixels respectively). For all data sets, we apply K-means on the descriptors to construct the vocabularies. Each descriptor is then mapped to the nearest visual word based on euclidean distance. One vs all multi-class Support Vector Machine (SVM) is used to perform the classification tasks. We use the intersection kernel [50] for the first three data sets and the 
                           
                              
                                 
                                    χ
                                 
                                 
                                    2
                                 
                              
                           
                         kernel for Pascal VOC 2007 and Caltech256. The cost parameter C was optimized for all the experiments using a 10-fold method on the training set or using the validation set (Pascal VOC 2007). Note that, the new representation does not require any quantization for 2nd order descriptors as opposed to [7]. So, the output of our algorithm is directly fed into the classification algorithm.

In our approach, three parameters (
                           
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                              ,
                              
                              
                                 
                                    M
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              α
                           
                        ) have to be set to compute classification results. We study their influence in this section. In Fig. 4
                        , on the left, we plot the effect of the number of angle bins (
                           
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                           
                        ) and distance bins (
                           
                              
                                 
                                    M
                                 
                                 
                                    R
                                 
                              
                           
                        ) on classification accuracy on 15-scene and Caltech101 data sets for a vocabulary size of 200. The evaluation was done using 10-fold cross-validation on the training set. A 45 bins (9×5) spatial histogram appears to be a good compromise for both datasets. Considering finer quantization does not improve the accuracy significantly, but highly increases feature dimension. On the bottom of Fig. 4, we show the effect of the weighting parameter 
                           
                              α
                           
                         on accuracy. For a very low 
                           
                              α
                           
                        , not all similar patches are taken into account and for a higher 
                           
                              α
                           
                        , there are patches which may not be similar and could be regarded as noise. For both data sets, the value 
                           
                              α
                           
                        
                        =0.3 gives the best results. This value seems related to the descriptor in use (SIFT in this case). We have also experimented that the previous values for the three parameters (
                           
                              
                                 
                                    M
                                 
                                 
                                    θ
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    R
                                 
                              
                           
                         and 
                           
                              α
                           
                        ) are also relevant for the filter bank descriptor used with MSRC-v2 dataset. They thus will be used in the following sections.

@&#EXPERIMENTAL RESULTS@&#

In this section, we present our results organized into two main parts. In the first part, we propose to analyze the performance improvements obtained with our concept of soft pairwise spatial angle-distance histograms representation, i.e. the 
                        
                           
                              
                                 SPS
                              
                              
                                 ad
                              
                           
                        
                      representation. We first evaluate the performance increase brought by each of the three following contributions, namely (i) infusing spatial information in the BoVW (ii) considering inter type visual word pairs and (iii) adding a soft weighting when inserting a new pair in the final representation. Then, we compare the 
                        
                           
                              
                                 SPS
                              
                              
                                 ad
                              
                           
                        
                      representation to previous works that also deal with relative visual words positions encoding. In the second part, we focus on our key 
                        
                           
                              
                                 SPS
                              
                              
                                 ad
                              
                           
                           +
                        
                      representation that exploits 
                        
                           
                              
                                 SPS
                              
                              
                                 ad
                              
                           
                        
                      advantages and also models local and global information. We first compare it with SPR to highlight the two methods complementarity and with similar systems that also enrich the SPR representation either by introducing relative spatial information or by using advanced coding and spatial pooling methods based on soft assignment. Second, for a complete overview of the performance of 
                        
                           
                              
                                 SPS
                              
                              
                                 ad
                              
                           
                           +
                        
                     , we compare it with state-of-the-art methods for image classification, that are built upon the bag-of-words pipeline or not.

The purpose of this section is to assess the improvements provided by the proposed concept of soft pairwise spatial angle-distance histograms representation, studying first the impact of the different factors combined in this concept, and second some computational advantages over close methods.

Three types of information are combined into the 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            representation: spatial information, soft weighting and inter-type visual words pairs consideration. The aim, here, is to evaluate the contribution of each of these factors using the three versions introduced in Section 3.4.1: pairwise spatial information with 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Intra
                                    
                                 
                              
                           , inter type visual word pairs with 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Inter
                                    
                                 
                              
                            and pairwise similarity weighting with 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                           . For this study, we chose to report some results obtained on two types of datasets, Caltech101 and 15 Scenes, that enable a good understanding of the analyzed factors on both object and scene classification tasks.


                           Table 1
                            shows the results for four different vocabulary sizes. From these results, it is clear that for each data set the 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Intra
                                    
                                 
                              
                            representation improves the results over BoVW. This means that the spatial information is very useful for image classification. For larger dictionaries, spatial information does not seem to be as effective as in the smaller ones. This was also observed in some of the previous works [3,17,51].

Second, by comparing 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Intra
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Inter
                                    
                                 
                              
                           , we understand how it is important to account both intra type visual word pairs and inter type visual word pairs, since the second one outperforms the first one in most of the cases. This is explained by the new spatial information brought by pairs located near the inter visual word boundary as discussed in Section 3.3. Finally, since the contribution of each pair should be different depending on the distance between the two considered descriptors, we have introduced a weighting scheme when inserting a pair in the final representation. This soft insertion is the difference between 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Inter
                                    
                                 
                              
                            and our proposed representation 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                           . We notice that this final representation outperforms 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Inter
                                    
                                 
                              
                            overall, specially when the number of visual words is increasing. Indeed, it is interesting to note that with the increase of vocabulary size BoVW, 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Inter
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            representation improve their results whereas 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Intra
                                    
                                 
                              
                            reaches an optimal and decreases with the increasing vocabulary size. The reason is that for larger dictionaries intra type words pairs become scarce (one cluster is divided into multiple clusters) and thus 
                              
                                 
                                    
                                       HPS
                                    
                                    
                                       ad
                                    
                                    
                                       Intra
                                    
                                 
                              
                            cannot provide important spatial information. On the other hand, 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            should always be able to add spatial information into the BoVW representation regardless of the state of the vocabulary since the soft weighting contribution is not varying with the number of visual words.

Here, we compare our method with Savarese et al. [7] and Liu et al. [6]. These two works are the most notable among those which concern modeling spatial relationships among the visual words. They rely on the use of new features composed of pairs (or higher number) of words having a specific relative position in order to build spatial histograms. Note that, contrary to our method, the previous approaches do not directly incorporate the spatial information of pair of similar words. We focus on several criteria to compare our work with the mentioned ones. Table 2
                            shows the details of the comparisons on MSRC-v2 dataset for 400 visual words. For this dataset, 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            representation provides the best classification results. Our method also holds different other advantages over the existing methods. For example, Liu et al. [6] integrates feature selection and spatial information extraction to boost recognition rate. However, as the spatial feature extraction becomes a part of the learning step, the modification in the training set would lead to recomputation of features and thus making it difficult to generalize. Let’s also note that, 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            models only global association and unlike Savarese et al. [7], does not require a 2nd-order feature quantization. On the other hand, our method has the highest feature dimensionality (the representation size of Savarese et al. method is not available in their article but it seems to be lower than ours) because, unlike the two other methods, it does not include any feature selection nor additional quantization step. Note that this dimension is still compatible with a fast SVM based classification.

As discussed previously, 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                    +
                                 
                              
                           
                         is our novel representation, based on 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                 
                              
                           
                        , that enriches the SPR model by encoding both the global and local relative distribution of visual words over an image. In this section, we first propose to study the gain of 
                           
                              
                                 
                                    SPS
                                 
                                 
                                    ad
                                    +
                                 
                              
                           
                         over SPR-based methods. Then, we enlarge our comparison to a large panel of state-of-the-art methods for image classification, from BoVW-based ones to completely different ones to discuss the interest of our approach.

The current trend in BoVW-based method is over the use of SPR combined with other spatial methods or advanced coding methods. The goal of this section is twofold. First, we study the complementarity of the relative spatial information introduced by 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                              
                            over the absolute one provided by original SPR. For that purpose, we compare 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            over SPR and over concurrent methods that also combine relative spatial information with SPR. Second, we study the performance of our combined transform over recent advanced coding methods. As previously mentioned, the word ambiguity due to hard assignment coding in the BoVW model prevents the use of large visual vocabularies and thus limits the performance of methods. Two main improvements have been proposed to overcome this problem: (1) to use a soft assignment to account for the proximity of several visual words through Kernel CodeBooks (KCB) [23] or Sparse Coding (SC) [37] methods, (2) to use a locality constraint to enable stability in the set of visual words used to represent similar descriptors through Locality-constrained Linear enCoding (LLC) [52] or Localized Soft-assignment Coding (LSC) [42]. These advanced coding methods also use several spatial pooling strategies to integrate SPR model.

Experiments reported in Table 3
                            were made using two different pipelines to focus on a fair comparison that enhance the benefits of our approach rather than fine-tuning and searching maximal performance for each dataset. The first pipeline, used for Caltech101 and 15 Scenes datasets, is consistent with [3] with a single scale SIFT sampled every 8 pixels and a small vocabulary of 200 visual words. The second one, used for Pascal VOC2007 and Caltech256, is consistent with [49] with a multiscale SIFT sampled every 3 pixels and a large vocabulary of 4000 words. Even the VLFeat open library [53] proposed by the authors is used to compute our results. The motivation is to use a relatively basic pipeline for the relatively simple datasets Caltech101 and 15 Scene and a more refined one for the more challenging Pascal VOC2007 and Caltech256. However, for advanced coding methods (rows 5–8) the results were not always available with the right parameters in related publications (particularly for Caltech101 and 15 Scenes, they are only available for 1000 visual words). In these cases, we chose publications related to the closest parameters.

We can first see that for the four datasets, 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            outperforms the SPR baseline (row 1). It clearly demonstrates the complementarity of the additional relative spatial information provided by our approach. Moreover, compared to other concurrent methods which combine relative and absolute spatial information (rows 2–4), the new method is also the best performing one. It is worth mentioning that the improvement from 
                              
                                 PIWAH
                                 +
                              
                            to 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            on 15 Scenes is representative since the standard deviations are 
                              
                                 0.55
                              
                            and 
                              
                                 0.73
                              
                            respectively.

Concerning the comparison over advanced coding methods, except for Caltech101, 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            also outperforms other coding methods for all datasets. The worse results for Caltech101 are due to the small vocabulary used (200 words) compared to other coding methods which use a 1000 words vocabulary and thus have a higher dimensionality (21,000 vs 13,200). For the 15 Scenes dataset, 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            is still the best performing even with the same low vocabulary dimensionality. The trade-off between accuracy and dimensionality is even better when using our reduced-dimension feature vector 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                    
                                       1800
                                    
                                 
                                 +
                              
                            (introduced in Section 3.4.3) whose dimension is 1800 and which is providing 
                              
                                 67.5
                                 %
                              
                            and 
                              
                                 83.0
                                 %
                              
                            for Caltech101 and 15 Scenes respectively. These results are still very competitive with the other methods from Table 3, despite the low feature dimensionality.

On the other hand, if high accuracy is desired, the use of a refined pipeline (4000 words and denser descriptor) outperforms all improved coding methods on the two challenging datasets Pascal VOC2007 and Caltech256. Let us also note that all results reported for Pascal VOC2007 are taken from [49] to be strictly comparable to 
                              
                                 
                                    
                                       SPS
                                    
                                    
                                       ad
                                    
                                 
                                 +
                              
                            computed with the same VLFeat library.

In Table 4
                           , for completeness, we give some top results for the four different datasets used so far. The aim of this table is to show where the state-of-the-art methods are today, compared with our results.

From Table 4, we can see that the most performing approaches are mainly the ones based on Convolutional Neural Networks (CNN) and on Fisher Vectors (FV). Indeed, recently, the CNN have shown to provide outstanding results on most of the datasets. However, it is worth mentioning that the CNN require huge amounts of data and time to learn the features. Nowadays, most of the CNN-based approaches are learning their features from the big ImageNet dataset because it provides sufficient data to learn and then try to adapt these pre-learned features to other smallest datasets. Consequently, the CNN provide very good results on datasets that contain classes which are not far (semantically) from the ImageNet classes (chairs, dogs, faces, …). For specific problems with relative small datasets, such as flower or bird classification, they still not compete with handcraft features. In this case, our approach can help, since it does not require any supervised learning step.

BossaNova and FV enrich BoW representation with extra knowledge from the set of local descriptors but FV use parametric models that lead to very high dimensional image representation. For example, in Table 4, FV require more than 1,376,000-D in order to get that results while the other approaches such as BossaNova, SLC or our solution require less than 300,000-D. Furthermore, there is no guarantee that the local descriptors follow a gaussian distribution around each visual words for all the datasets. If this gaussian assumption does not hold, the representation may be unrepresentative of the local descriptor statistics.

The solutions based on FV such as [55] or [12] are adding information to the classical FV, increasing this way the huge dimension of this descriptor. And sometimes, this dimension increase does not lead to representative improvements. For example, it appears that simple FV have a mean average precision of 
                              
                                 59.5
                                 %
                              
                            for Pascal VOC20007, while the spatial-FV from [12] have 
                              
                                 56.7
                                 %
                              
                           . Likewise, on 15-scenes the spatial-FV reaches 
                              
                                 88.2
                                 %
                              
                            while the classical FV are at 
                              
                                 88.1
                                 %
                              
                           .

BossaNova is a concatenation of a classical BoW and a histogram of distances (in the local feature space) between each cluster center (visual word) and all the descriptors. The first problem of this approach is that the range of distances (related to the number of bins in the distance histograms) has to be adapted to the dataset and the used local features. In practice, they set up differently the range bounds for each visual words. Second, the 2 histograms (BoW and distance histograms) are weighted before concatenation and the weights are learned via cross validation on a training/validation subset. Finally, the results provided in Table 4 are the ones obtained by the concatenation between BossaNova and FV. Without concatenation, BossaNova get 
                              
                                 85.3
                                 %
                              
                            on the 15 Scene dataset while we get 
                              
                                 83.7
                                 %
                              
                           , without supervised learning step.

Finally, the spatially local coding [54] is inserting the spatial 2D positions (in the image) of the pixels in the local feature vector before creating the dictionary. Consequently, the visual words contain information about their positions in the image space. This kind of representation is helpful only for datasets where the objects have stable positions in the images such as Caltech101 and Caltech256 ones.

@&#CONCLUSION@&#

In this paper, we proposed a new computationally efficient method to model global spatial distribution of visual words and improved the standard BoVW representation. This method exploits spatial orientations and distances of all pairs of similar descriptors in the image. The evaluation was made on an image classification task, using an extensive set of standard data sets.

Experiments demonstrate that: (i) our approach succeeds in adding relative spatial information into the BoVW model, (ii) it outperforms all other concurrent local histogram based methods, and (iii) it provides competitive results compared with recent systems that enrich SPR representation by using advanced coding and spatial pooling methods based on soft assignment. Moreover, it also has significant advantages over very recent state of the art approaches.

A direct extension of this work could be to try to combine advanced BoVW encoding techniques as Fisher kernel [58] to our pairwise spatial histograms. Another interesting future direction could be to include some new encoding techniques directly into our pairwise spatial histograms. For example, local soft assignment [42] could be combined with soft similarity weighting. Finally, spatial information provided by multiple cues e.g. color and shape, is also promising as a future direction.

@&#REFERENCES@&#

