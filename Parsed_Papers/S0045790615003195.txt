@&#MAIN-TITLE@&#Enhancing the throughput of cognitive radio networks through malevolent presence

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The detection performance of the cognitive radio (CR) network is improved, when malicious cognitive radio user coexists in the network.


                        
                        
                           
                           Channel between malicious CR user and CR receiver is estimated.


                        
                        
                           
                           Throughput of the network is enhanced, amidst the presence of malicious CR user.


                        
                        
                           
                           We have shown that detection performance and throughput are not compromised by the presence of malicious user.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cognitive radio

Throughput

Spectrum sensing

Sensing phase

Secondary user transmission phase

Malicious cognitive radio user

@&#ABSTRACT@&#


               
               
                  Enhancing the throughput of cognitive radio network in the presence of malicious cognitive radio user (MCRU) is addressed in this paper. We have considered the impact of MCRU on the sensing performance and achievable throughput of secondary network during two phases, namely, sensing phase (SP) and secondary user transmission phase (SUTP), respectively. This impact is mitigated by employing cognitive radio (CR) users equipped with multiple receiving antennas. We have performed diversity combining and have formulated the optimization problems with solutions during SP and SUTP. Moreover, the method of estimating the channel between MCRU and CR receiver is integrated into the solution. Simulation results show that this method achieves 89% detection and 3.5 bits/s/Hz of achievable throughput, while maximal ratio combining technique offers only 22% and 0.4 bits/s/Hz, respectively, when MCRU is active with ten times stronger power than the primary user.
               
            

@&#INTRODUCTION@&#

Cognitive Radio (CR) resolves spectrum under-utilization problem in today’s wireless communication systems [1]. One of the intelligent modules of CR is spectrum sensing. Among many sensing algorithms reported so far, energy detection is the simplest, and relies not on the prior knowledge of primary users’s (PU’s) signal [2–4], and is employed in most of the reported works. Apart from energy detection, spectrum sensing is implemented through many other techniques namely, matched filter [5], cyclo-stationary based detection etc. [1,6,7].

However, performance of spectrum sensing is degraded, if MCRU exists in a cognitive radio network (CRN). These MCRUs exist, for two reasons. Firstly, there could be a detection deficiency due to failure in the hardware part and/or malfunctioning of software algorithmic part of CR. Secondly, one or more CR users intentionally do malpractice by transmitting a signal similar to that of PU’s. In case of cooperative spectrum sensing, malicious activity is identified as reporting the combining center using bogus sensing data or sensing decision [8]. These MCRUs’ intention is to take advantage of available spectrum - whenever the primary user (PU) is absent - by confusing or defeating other CR users’ sensing algorithm [8,9].

So far, many contributions have been made towards spectrum sensing, when MCRU exists in a CRN. The first work on PU emulation attack is found in [10], where the MCRU occupies the vacant channels of the licensed user by transmitting the signal similar to that of the PU’s so that access to the vacant channels by any other CR is denied.

In the work reported by authors in [11], MCRU is modeled as an unreliable user, which transmits signal of similar nature to that of PU’s signal and defeats other CR users’ sensing algorithm. To avoid that, authors have proposed a localization-based defense scheme, which estimates location of the transmitter by observing its signal characteristics. Using those estimates, it verifies whether a received signal is that of a PU’s signal. An anti-primary-user-emulation attack is addressed in [12], where the secondary users (SUs) randomly choose channels to sense and avoid the attack of MCRU. The statistical nature of the signal of the attacker and his environment is assumed to be unknown to the SU. Further, to eliminate the problem of unknown environment, the technique of adversarial bandit problem is applied in the same work [12].

In as much as spectrum sensing is vital to a CRN, achievable throughput of a secondary network is also equally important [13]. A trade-off between sensing and throughput has been reported in [13], where sensing is performed periodically in each frame followed by SU’s transmission. Authors in [14] have considered a number of MCRUs in a CRN, who report bogus sensing data to the combining center. Moreover, they have developed a scheme to detect them and minimize their interference during the data combining stage. But this work requires a priori knowledge of number of MCRUs that exist in a CRN. Hence the algorithm is not so successful in a situation, where MCRUs change their intention dynamically.

Authors in [15] have reported a sensing methodology for PU detection in the presence of MCRU by exploiting cooperation between CR users. But that work suffers from two severe drawbacks. First, it demands a dedicated reporting channel to exist between every CR user and combining center, notwithstanding the fact that demanding such a channel is irrational when addressing the problem of spectrum under-utilization. Secondly, fusion center’s decision is based on the data sent from every CR user, which will include a few MCRUs, in a network. So, the received data itself is suspect. Finally, authors in [15], have dealt with sensing method, but they have not dealt with throughput of a secondary network which is paramount [13] and without it, the effort is inadequate. Notwithstanding these efforts, to improve the throughput of a CRN in a situation where MCRU is active, not much has been reported.

In this paper, we take cognizance of the existence of MCRU during both sensing phase (SP) and secondary user’s transmission phase (SUTP), and present a method to alleviate its effect during both the phases. We employ CR user equipped with multiple receiving antennas [16] for diversity combining, so that we do not depend on cooperation between CR users, which demands a dedicated reporting channel. We have formulated the optimization problems with solution during SP and SUTP. Using this method, we have improved the sensing performance and achievable throughput of a secondary network, when MCRU coexists in a CRN. Moreover, by assuming the known channel-coefficients between PU and cognitive radio receiver (CRR), we have presented a scheme to estimate the channel between MCRU and CRR.

Rest of the paper is organized as follows. Section 2 presents the system model of the proposed work, followed by optimization problem during SP and channel estimation. Section 4 deals with achievable throughput and finding the optimal weights to increase the throughput. Simulation results are presented in Section 5 with discussions. Section 6 concludes the work.

System model during SP and SUTP is shown in Figs. 1
                      and 2
                     , respectively. We consider the existence of one PU, and one MCRU in a CRN. We assume that PU transmits its signal of power Zp
                     , and MCRU transmits a similar signal of power Mp
                     . We consider that each CR transceiver is equipped with L receiving antennas [16]. Rayleigh fading, in particular, slow fading is assumed to exist between PU and each of the l receiving antennas of CRR, and between CR transmitter (CRT) and each of the l antennas of CRR, where l varies from 0 to 
                        
                           L
                           −
                           1
                        
                     . Noise component in each antenna is assumed to be independent and identically distributed (i.i.d) complex gaussian random variable of mean zero and variance 
                        
                           σ
                           n
                           2
                        
                     . In addition, PU’s signal, MCRU’s and noise are assumed to be mutually independent of each other. The combined-signal model of the received signal during both SP and SUTP, at CRR is given by,

                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          
                                             r
                                             l
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          α
                                          
                                             
                                                Z
                                                p
                                             
                                          
                                          
                                             h
                                             
                                                z
                                                l
                                             
                                          
                                          z
                                          
                                             (
                                             i
                                             )
                                          
                                          +
                                          δ
                                          
                                             
                                                M
                                                p
                                             
                                          
                                          
                                             h
                                             
                                                m
                                                l
                                             
                                          
                                          m
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          +
                                          
                                          β
                                          
                                             {
                                             
                                                
                                                   S
                                                   p
                                                
                                             
                                             
                                                h
                                                
                                                   s
                                                   l
                                                
                                             
                                             s
                                             
                                                (
                                                i
                                                )
                                             
                                             +
                                             
                                                
                                                   M
                                                   p
                                                
                                             
                                             
                                                h
                                                
                                                   n
                                                   l
                                                
                                             
                                             m
                                             
                                                (
                                                i
                                                )
                                             
                                             }
                                          
                                          +
                                          
                                             n
                                             l
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where i indicates time index varying from 0 to 
                        
                           N
                           −
                           1
                           ,
                        
                     
                     
                        
                           β
                           =
                           0
                        
                      indicates the signal received during SP, 
                        
                           β
                           =
                           1
                           ,
                           α
                           =
                           0
                        
                      and 
                        
                           δ
                           =
                           0
                        
                      indicate the signal received during SUTP, hzl
                      denotes channel between PU and 
                        
                           l
                           
                        
                     th antenna of CRR, hsl
                      denotes channel between CRT and 
                        
                           l
                           
                        
                     th antenna of CRR, hml
                      denotes channel between MCRU and 
                        
                           l
                           
                        
                     th antenna of CRR during SP, and hnl
                      denotes channel between MCRU and 
                        
                           l
                           
                        
                     th antenna of CRR during SUTP, nl
                     (i) is spatio-temporal-uncorrelated noise of variance 
                        
                           σ
                           n
                           2
                        
                     . The PU’s signal, z(i) in (1) is modelled as i.i.d complex gaussian random variable of zero mean and unit variance, and so is MCRU’s signal m(i), as it mimics PU’s. So 
                        
                           
                              
                                 Z
                                 p
                              
                           
                           
                           z
                           
                              (
                              i
                              )
                           
                        
                      and 
                        
                           
                              
                                 M
                                 p
                              
                           
                           
                           m
                           
                              (
                              i
                              )
                           
                        
                      will have the variance (power) of Zp
                      and Mp
                      respectively. Similarly, s(i) is modelled as complex gaussian random variable of zero mean and unit variance.

During SP, that is, when 
                        
                           β
                           =
                           0
                           ,
                        
                      given a weight vector 
                        
                           w
                           =
                           
                              
                                 [
                                 
                                    w
                                    0
                                    *
                                 
                                 
                                 
                                    w
                                    1
                                    *
                                 
                                 
                                 
                                    w
                                    2
                                    *
                                 
                                 ⋯
                                 
                                    w
                                    
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                           ,
                        
                      we let CRR perform linear combination of received signal vector 
                        
                           r
                           =
                           
                              
                                 [
                                 
                                    r
                                    0
                                    *
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 
                                 
                                    r
                                    1
                                    *
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 
                                 
                                    r
                                    2
                                    *
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 ⋯
                                 
                                    r
                                    
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 
                                    (
                                    i
                                    )
                                 
                                 ]
                              
                              H
                           
                        
                      as

                        
                           (2)
                           
                              
                                 y
                                 
                                    (
                                    i
                                    )
                                 
                                 =
                                 
                                    w
                                    H
                                 
                                 r
                              
                           
                        
                     where the superscript H indicates hermitian transpose, and * indicates complex conjugation. It is to be noted that during SP, mean of y(i), i.e.
                     
                        
                           E
                           
                              [
                              y
                              
                                 (
                                 i
                                 )
                              
                              /
                              α
                              =
                              0
                              ,
                              β
                              =
                              0
                              ,
                              δ
                              =
                              1
                              ]
                           
                           =
                           0
                           ,
                        
                      because, 
                        
                           E
                           
                              [
                              m
                              
                                 (
                                 i
                                 )
                              
                              ]
                           
                           =
                           0
                        
                      and mean of nl
                     (i) is also zero, where E(·) is an expectation operator. Similarly, 
                        
                           E
                           
                              [
                              y
                              
                                 (
                                 i
                                 )
                              
                              /
                              α
                              =
                              1
                              ,
                              β
                              =
                              0
                              ,
                              δ
                              =
                              1
                              ]
                           
                        
                      is also 0, because mean of z(i) is zero. This implies that the mean of 
                        
                           y
                           
                              (
                              i
                              )
                           
                           =
                           0
                           ,
                        
                      whether PU is present or not.

We let 
                        
                           Σ
                           0
                           2
                        
                      to denote the variance of y(i), when 
                        
                           α
                           =
                           0
                           ,
                           β
                           =
                           0
                        
                      and 
                        
                           δ
                           =
                           1
                        
                      and the same is found as

                        
                           (3)
                           
                              
                                 
                                    
                                       
                                          Σ
                                          0
                                          2
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                E
                                                [
                                                |
                                                y
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                |
                                             
                                             2
                                          
                                          
                                             /
                                             α
                                             =
                                             0
                                             ,
                                             β
                                             =
                                             0
                                             ,
                                             δ
                                             =
                                             1
                                             ]
                                             =
                                             E
                                          
                                          
                                             [
                                             
                                                (
                                                
                                                   w
                                                   H
                                                
                                                r
                                                )
                                             
                                             
                                                
                                                   (
                                                   
                                                      w
                                                      H
                                                   
                                                   r
                                                   )
                                                
                                                H
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          [
                                          
                                             w
                                             H
                                          
                                          r
                                          
                                             r
                                             H
                                          
                                          w
                                          ]
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             {
                                             
                                                w
                                                H
                                             
                                             
                                                [
                                                
                                                   
                                                      M
                                                      p
                                                   
                                                
                                                
                                                   h
                                                   m
                                                
                                                m
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                +
                                                
                                                   n
                                                   l
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                ]
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         M
                                                         p
                                                      
                                                   
                                                   
                                                      h
                                                      m
                                                   
                                                   m
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   +
                                                   
                                                      n
                                                      l
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   ]
                                                
                                                H
                                             
                                             w
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             M
                                             p
                                          
                                          
                                             
                                                |
                                                
                                                   
                                                      w
                                                   
                                                   H
                                                
                                                
                                                   h
                                                   m
                                                
                                                |
                                             
                                             2
                                          
                                          +
                                          
                                             w
                                             H
                                          
                                          
                                             σ
                                             n
                                             2
                                          
                                          w
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              h
                              m
                           
                           =
                           
                              
                                 [
                                 
                                    h
                                    
                                       m
                                       0
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       m
                                       1
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       m
                                       2
                                    
                                    *
                                 
                                 ⋯
                                 
                                    h
                                    
                                       m
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                        
                      is the stacked channel coefficients of hml
                      in vector form. In the above equation, since m(i) and nl
                     (i) are independent of each other, we have substituted 
                        
                           E
                           
                              [
                              m
                              
                                 (
                                 i
                                 )
                              
                              
                                 n
                                 l
                                 *
                              
                              
                                 (
                                 i
                                 )
                              
                              ]
                           
                           =
                           E
                           
                              [
                              
                                 n
                                 l
                              
                              
                                 (
                                 i
                                 )
                              
                              
                                 m
                                 *
                              
                              
                                 (
                                 i
                                 )
                              
                              ]
                           
                           =
                           0
                        
                     .

Similarly, when 
                        
                           α
                           =
                           1
                           ,
                           β
                           =
                           0
                        
                      and 
                        
                           δ
                           =
                           1
                           ,
                        
                      the variance becomes 
                        
                           
                              Σ
                              1
                              2
                           
                           =
                           
                              M
                              p
                           
                           
                              |
                           
                           
                              w
                              H
                           
                           
                              h
                              m
                           
                           
                              
                                 |
                              
                              2
                           
                           +
                           
                           
                              Z
                              p
                           
                           
                              
                                 |
                                 
                                    w
                                    H
                                 
                                 
                                    h
                                    z
                                 
                                 |
                              
                              2
                           
                           +
                           
                              w
                              H
                           
                           
                              σ
                              n
                              2
                           
                           w
                           ,
                        
                      where 
                        
                           
                              h
                              m
                           
                           =
                           
                              
                                 [
                                 
                                    h
                                    
                                       m
                                       0
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       m
                                       1
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       m
                                       2
                                    
                                    *
                                 
                                 ⋯
                                 
                                    h
                                    
                                       m
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                        
                      and 
                        
                           
                              h
                              z
                           
                           =
                           
                              
                                 [
                                 
                                    h
                                    
                                       z
                                       0
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       z
                                       1
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       z
                                       2
                                    
                                    *
                                 
                                 ⋯
                                 
                                    h
                                    
                                       z
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                        
                      are the stacked channel coefficients of hml
                      and hzl
                      in vector form respectively.

We adopt energy detection at CRR. The energy of the linearly combined signal y(i) is given by 
                        
                           E
                           =
                           
                              ∑
                              
                                 i
                                 =
                                 0
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           
                              
                                 |
                                 y
                                 
                                    (
                                    i
                                    )
                                 
                                 |
                              
                              2
                           
                           ,
                        
                      where 
                        
                           N
                           =
                           τ
                           
                              f
                              s
                           
                        
                      is the number of samples, with the sampling frequency fs
                     , over the sensing time τ. The probability distribution of E can be found using (2) and (3). To do so, we need to find mean and variance of E. Now, the mean of E is obtained as 
                        
                           E
                           
                              (
                              E
                              |
                              α
                              =
                              0
                              ,
                              β
                              =
                              0
                              ,
                              δ
                              =
                              1
                              )
                           
                           =
                           E
                           (
                           
                              ∑
                              
                                 i
                                 =
                                 0
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           |
                           y
                           
                              (
                              i
                              )
                           
                           
                              |
                              2
                           
                           |
                           α
                           =
                           0
                           ,
                           β
                           =
                           0
                           ,
                           δ
                           =
                           1
                           )
                        
                      where E(· | ·) is the conditional expectation operator. Further,

                        
                           (4)
                           
                              
                                 E
                                 
                                    (
                                    E
                                    |
                                    α
                                    =
                                    0
                                    ,
                                    β
                                    =
                                    0
                                    ,
                                    δ
                                    =
                                    1
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 E
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       |
                                       α
                                       =
                                       0
                                       ,
                                       β
                                       =
                                       0
                                       ,
                                       δ
                                       =
                                       1
                                    
                                    )
                                 
                                 =
                                 N
                                 
                                    Σ
                                    0
                                    2
                                 
                              
                           
                        
                     Similarly,

                        
                           (5)
                           
                              
                                 E
                                 
                                    (
                                    E
                                    |
                                    α
                                    =
                                    1
                                    ,
                                    β
                                    =
                                    0
                                    ,
                                    δ
                                    =
                                    1
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 E
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       |
                                       α
                                       =
                                       1
                                       ,
                                       β
                                       =
                                       0
                                       ,
                                       δ
                                       =
                                       1
                                    
                                    )
                                 
                                 =
                                 N
                                 
                                    Σ
                                    1
                                    2
                                 
                              
                           
                        
                     It is known that |y(i)|’s are independent of each other. Therefore, variance of E is obtained as follows [17]
                     
                        
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    E
                                    |
                                    α
                                    =
                                    0
                                    ,
                                    β
                                    =
                                    0
                                    ,
                                    δ
                                    =
                                    1
                                    )
                                 
                                 =
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       ∑
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       |
                                       α
                                       =
                                       0
                                       ,
                                       β
                                       =
                                       0
                                       ,
                                       δ
                                       =
                                       1
                                    
                                    )
                                 
                              
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    E
                                    |
                                    α
                                    =
                                    0
                                    ,
                                    β
                                    =
                                    0
                                    ,
                                    δ
                                    =
                                    1
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       |
                                       α
                                       =
                                       0
                                       ,
                                       β
                                       =
                                       0
                                       ,
                                       δ
                                       =
                                       1
                                    
                                    )
                                 
                              
                           
                        
                     where var(a|b) is the conditional variance operator. In (6), first, we would like to find the 
                        
                           r
                           a
                           var
                           (
                           |
                           y
                           
                              (
                              i
                              )
                           
                           
                              |
                              2
                           
                           |
                           α
                           =
                           0
                           ,
                           β
                           =
                           0
                           ,
                           δ
                           =
                           1
                           )
                        
                      inside the summation. For convenience, we omit the conditional parameters in (6). Therefore, we call the term 
                        
                           r
                           a
                           var
                           (
                           |
                           y
                           
                              (
                              i
                              )
                           
                           
                              |
                              2
                           
                           |
                           α
                           =
                           0
                           ,
                           β
                           =
                           0
                           ,
                           δ
                           =
                           1
                           )
                        
                      simply as var(|y(i)|2), which gives

                        
                           
                              
                                 
                                    
                                       
                                          r
                                          a
                                          var
                                          
                                             (
                                             
                                                
                                                   |
                                                   y
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   |
                                                
                                                2
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   |
                                                   y
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   |
                                                
                                                4
                                             
                                             )
                                          
                                          −
                                          
                                             
                                                |
                                                E
                                                
                                                   (
                                                   
                                                      
                                                         |
                                                         y
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         |
                                                      
                                                      2
                                                   
                                                   )
                                                
                                                |
                                             
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             (
                                             
                                                
                                                   |
                                                   y
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   |
                                                
                                                4
                                             
                                             )
                                          
                                          −
                                          
                                             Σ
                                             0
                                             4
                                          
                                       
                                    
                                 
                              
                           
                        
                     Since y(i) is complex gaussian number, its real and imaginary parts are independent gaussian numbers of zero mean and each of variance 
                        
                           
                              Σ
                              0
                              2
                           
                           2
                        
                     . Let 
                        
                           y
                           
                              (
                              i
                              )
                           
                           =
                           
                              y
                              r
                           
                           
                              (
                              i
                              )
                           
                           +
                           j
                           
                              y
                              im
                           
                           
                              (
                              i
                              )
                           
                           ,
                        
                      then 
                        
                           
                              y
                              r
                           
                           
                              (
                              i
                              )
                           
                           ∼
                           N
                           
                              (
                              0
                              ,
                              
                                 Σ
                                 0
                                 2
                              
                              /
                              2
                              )
                           
                        
                      and 
                        
                           
                              y
                              im
                           
                           
                              (
                              i
                              )
                           
                           ∼
                           N
                           
                              (
                              0
                              ,
                              
                                 Σ
                                 0
                                 2
                              
                              /
                              2
                              )
                           
                        
                      are the distributions of real and imaginary parts of y(i). We can reduce further as,

                        
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    )
                                 
                                 =
                                 E
                                 
                                    (
                                    
                                       ∥
                                    
                                    
                                       y
                                       r
                                    
                                    
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       +
                                       |
                                    
                                    
                                       y
                                       im
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    
                                       
                                          
                                             |
                                             2
                                          
                                          |
                                       
                                       2
                                    
                                    )
                                 
                                 −
                                 
                                    Σ
                                    o
                                    4
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    )
                                 
                                 =
                                 E
                                 
                                    (
                                    
                                       |
                                    
                                    
                                       y
                                       r
                                    
                                    
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       4
                                    
                                    )
                                 
                                 +
                                 E
                                 
                                    (
                                    
                                       |
                                    
                                    
                                       y
                                       im
                                    
                                    
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       4
                                    
                                    )
                                 
                                 +
                                 2
                                 E
                                 
                                    (
                                    
                                       |
                                    
                                    
                                       y
                                       r
                                    
                                    
                                       
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       
                                          |
                                          
                                             y
                                             im
                                          
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    )
                                 
                                 −
                                 
                                    Σ
                                    0
                                    4
                                 
                              
                           
                        
                     
                     
                        
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          3
                                          
                                             Σ
                                             0
                                             4
                                          
                                       
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       
                                          3
                                          
                                             Σ
                                             0
                                             4
                                          
                                       
                                       4
                                    
                                 
                                 +
                                 
                                    
                                       
                                          2
                                          
                                             Σ
                                             0
                                             4
                                          
                                       
                                       4
                                    
                                 
                                 −
                                 
                                    Σ
                                    0
                                    4
                                 
                                 =
                                 
                                    Σ
                                    0
                                    4
                                 
                              
                           
                        
                     Substituting the above result into (6), we get

                        
                           (7)
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       |
                                       α
                                       =
                                       0
                                       ,
                                       β
                                       =
                                       0
                                       ,
                                       δ
                                       =
                                       1
                                    
                                    )
                                 
                                 
                                 =
                                 N
                                 
                                    Σ
                                    0
                                    4
                                 
                              
                           
                        
                     In similar way, we obtain

                        
                           (8)
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       
                                          |
                                          y
                                          
                                             (
                                             i
                                             )
                                          
                                          |
                                       
                                       2
                                    
                                    
                                       |
                                       α
                                       =
                                       1
                                       ,
                                       β
                                       =
                                       0
                                       ,
                                       δ
                                       =
                                       1
                                    
                                    )
                                 
                                 
                                 =
                                 N
                                 
                                    Σ
                                    1
                                    4
                                 
                              
                           
                        
                     
                  

According to central limit theorem (CLT), when large number of samples is considered, the distribution of E is assumed to be gaussian [9,13,17]. Incorporating CLT and (4), (5), (7) and (8), the distribution of E is given by,

                        
                           (9)
                           
                              
                                 E
                                 ∼
                                 
                                    {
                                    
                                       
                                          
                                             
                                                N
                                                
                                                   (
                                                   N
                                                   
                                                      Σ
                                                      0
                                                      2
                                                   
                                                   ,
                                                   N
                                                   
                                                      Σ
                                                      0
                                                      4
                                                   
                                                   )
                                                
                                                ;
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                0
                                                ,
                                                β
                                                =
                                                0
                                                
                                                and
                                                
                                                δ
                                                =
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                N
                                                
                                                   (
                                                   N
                                                   
                                                      Σ
                                                      1
                                                      2
                                                   
                                                   ,
                                                   N
                                                   
                                                      Σ
                                                      1
                                                      4
                                                   
                                                   )
                                                
                                                ;
                                             
                                          
                                          
                                             
                                                α
                                                =
                                                1
                                                ,
                                                β
                                                =
                                                0
                                                
                                                and
                                                
                                                δ
                                                =
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           N
                           (
                           μ
                           ,
                           
                              σ
                              2
                           
                           )
                        
                      is gaussian distributed random variable of mean μ and variance σ
                     2. Assume that the channel is slow fading and therefore constant over a frame. By letting λ as the threshold of detection, instantaneous probability of detection can be derived as,

                        
                           (10)
                           
                              
                                 
                                    
                                       
                                          P
                                          d
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          Pr
                                          
                                             {
                                             E
                                             >
                                             λ
                                             |
                                             α
                                             =
                                             1
                                             ,
                                             β
                                             =
                                             0
                                             ,
                                             δ
                                             =
                                             1
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∫
                                             
                                                λ
                                             
                                             ∞
                                          
                                          
                                             f
                                             E
                                          
                                          
                                             (
                                             ϵ
                                             ∣
                                             α
                                             =
                                             1
                                             ,
                                             β
                                             =
                                             0
                                             ,
                                             δ
                                             =
                                             1
                                             )
                                          
                                          d
                                          ϵ
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              f
                              E
                           
                           
                              (
                              ϵ
                              ∣
                              α
                              =
                              1
                              ,
                              β
                              =
                              0
                              ,
                              δ
                              =
                              1
                              )
                           
                        
                      denotes conditional probability density function of E, when 
                        
                           α
                           =
                           1
                           ,
                           β
                           =
                           0
                           ,
                           δ
                           =
                           1
                        
                     . From (9), this density is obtained as 
                        
                           
                              f
                              E
                           
                           
                              (
                              ϵ
                              ∣
                              α
                              =
                              1
                              ,
                              β
                              =
                              0
                              ,
                              δ
                              =
                              1
                              )
                           
                           =
                           
                              1
                              
                                 
                                    2
                                    π
                                    N
                                    
                                       Σ
                                       1
                                       4
                                    
                                 
                              
                           
                           
                              e
                              
                                 
                                    −
                                    
                                       
                                          (
                                          ϵ
                                          −
                                          N
                                          
                                             Σ
                                             1
                                             2
                                          
                                          )
                                       
                                       2
                                    
                                 
                                 
                                    2
                                    N
                                    
                                       Σ
                                       1
                                       4
                                    
                                 
                              
                           
                        
                     . Therefore

                        
                           (11)
                           
                              
                                 
                                    P
                                    d
                                 
                                 =
                                 
                                    ∫
                                    
                                       λ
                                    
                                    ∞
                                 
                                 
                                    1
                                    
                                       
                                          2
                                          π
                                          N
                                          
                                             Σ
                                             1
                                             4
                                          
                                       
                                    
                                 
                                 
                                    e
                                    
                                       
                                          −
                                          
                                             
                                                (
                                                ϵ
                                                −
                                                N
                                                
                                                   Σ
                                                   1
                                                   2
                                                
                                                )
                                             
                                             2
                                          
                                       
                                       
                                          2
                                          N
                                          
                                             Σ
                                             1
                                             4
                                          
                                       
                                    
                                 
                                 d
                                 ϵ
                              
                           
                        
                     
                  

If we let 
                        
                           x
                           =
                           
                              
                                 ϵ
                                 −
                                 N
                                 
                                    Σ
                                    1
                                    2
                                 
                              
                              
                                 
                                    N
                                    
                                       Σ
                                       1
                                       4
                                    
                                 
                              
                           
                        
                      in the above Eq. (11), we get

                        
                           (12)
                           
                              
                                 
                                    
                                       
                                          P
                                          d
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∫
                                             
                                                
                                                   
                                                      λ
                                                      −
                                                      N
                                                      
                                                         Σ
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                         
                                                            Σ
                                                            1
                                                            4
                                                         
                                                      
                                                   
                                                
                                             
                                             ∞
                                          
                                          
                                             1
                                             
                                                
                                                   2
                                                   π
                                                
                                             
                                          
                                          
                                             e
                                             
                                                −
                                                
                                                   
                                                      
                                                         x
                                                         2
                                                      
                                                      2
                                                   
                                                
                                             
                                          
                                          d
                                          x
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          Q
                                          
                                             (
                                             
                                                
                                                   
                                                      λ
                                                      −
                                                      N
                                                      
                                                         Σ
                                                         1
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         Σ
                                                         1
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           Q
                           
                              (
                              x
                              )
                           
                           =
                           
                              ∫
                              
                                 x
                              
                              ∞
                           
                           
                              e
                              
                                 
                                    −
                                    
                                       t
                                       2
                                    
                                 
                                 2
                              
                           
                           d
                           t
                        
                      is a 
                        
                           Q
                           
                              (
                              ·
                              )
                           
                        
                      function. Similarly, probability of false alarm can be found using (9) as,

                        
                           (13)
                           
                              
                                 
                                    
                                       
                                          P
                                          f
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          Pr
                                          
                                             {
                                             E
                                             >
                                             λ
                                             |
                                             α
                                             =
                                             0
                                             ,
                                             β
                                             =
                                             0
                                             ,
                                             δ
                                             =
                                             1
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∫
                                             
                                                λ
                                             
                                             ∞
                                          
                                          
                                             f
                                             E
                                          
                                          
                                             (
                                             ϵ
                                             ∣
                                             α
                                             =
                                             0
                                             ,
                                             β
                                             =
                                             0
                                             ,
                                             δ
                                             =
                                             1
                                             )
                                          
                                          d
                                          ϵ
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          Q
                                          
                                             (
                                             
                                                
                                                   
                                                      λ
                                                      −
                                                      N
                                                      
                                                         Σ
                                                         0
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         N
                                                      
                                                      
                                                         Σ
                                                         0
                                                         2
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              f
                              E
                           
                           
                              (
                              ϵ
                              ∣
                              α
                              =
                              0
                              ,
                              β
                              =
                              0
                              ,
                              δ
                              =
                              1
                              )
                           
                        
                      denotes conditional probability density function of E, when 
                        
                           α
                           =
                           0
                           ,
                           β
                           =
                           0
                           ,
                           δ
                           =
                           1
                        
                     . Since the channel varies frame by frame, probabilities in (12) and (13) must be averaged with respect to the density functions 
                        
                           
                              f
                              
                                 h
                                 z
                              
                           
                           
                              (
                              
                                 h
                                 z
                              
                              )
                           
                        
                      and 
                        
                           
                              f
                              
                                 h
                                 m
                              
                           
                           
                              (
                              
                                 h
                                 m
                              
                              )
                           
                        
                     . The average false alarm probability over all the frames is found as, 
                        
                           
                              
                                 P
                                 f
                              
                              ¯
                           
                           =
                           
                              ∫
                              
                                 −
                                 ∞
                              
                              ∞
                           
                           
                              P
                              f
                           
                           
                              f
                              
                                 h
                                 m
                              
                           
                           
                              (
                              
                                 h
                                 m
                              
                              )
                           
                           d
                           
                              h
                              m
                           
                        
                     . Similarly, average detection probability is obtained as 
                        
                           
                              
                                 P
                                 d
                              
                              ¯
                           
                           =
                           
                              ∫
                              
                                 −
                                 ∞
                              
                              ∞
                           
                           
                              ∫
                              
                                 −
                                 ∞
                              
                              ∞
                           
                           
                              P
                              d
                           
                           
                              f
                              
                                 h
                                 m
                              
                           
                           
                              (
                              
                                 h
                                 m
                              
                              )
                           
                           
                              f
                              
                                 h
                                 z
                              
                           
                           
                              (
                              
                                 h
                                 z
                              
                              )
                           
                           d
                           
                              h
                              m
                           
                           d
                           
                              h
                              z
                           
                        
                     . Finding closed form expressions of 
                        
                           
                              P
                              f
                           
                           ¯
                        
                      and 
                        
                           
                              P
                              d
                           
                           ¯
                        
                      becomes complex and non-tractable. However, we have found the average of Pf
                      and Pd
                      empirically in the simulations.

The existence of MCRU does increase false alarm. Our objective, in this section, is to obtain an optimal weight vector for linear combination during SP, to minimize Pf
                        , when MCRU exists, without compromising the detection performance. Therefore, we formulate an optimization problem to get w
                        
                           opt
                        , which minimizes 
                           
                              
                                 
                                    P
                                    f
                                 
                                 ¯
                              
                              ,
                           
                         for a fixed average 
                           
                              
                                 P
                                 d
                              
                              ¯
                           
                        . Substituting (12) into (13), we cast the optimization problem as,

                           
                              (14)
                              
                                 
                                    
                                       
                                          Minimize
                                       
                                       
                                       
                                          
                                             Q
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            Σ
                                                            1
                                                            2
                                                         
                                                         
                                                            Q
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  P
                                                                  d
                                                               
                                                               ¯
                                                            
                                                            )
                                                         
                                                         +
                                                         N
                                                         
                                                            Σ
                                                            1
                                                            2
                                                         
                                                         −
                                                         N
                                                         
                                                            Σ
                                                            0
                                                            2
                                                         
                                                      
                                                      
                                                         
                                                            N
                                                         
                                                         
                                                            Σ
                                                            0
                                                            2
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              Q
                              
                                 (
                                 ·
                                 )
                              
                           
                         in (14) can be written as, 
                           
                              Q
                              (
                              
                                 Q
                                 
                                    −
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       P
                                       d
                                    
                                    ¯
                                 
                                 )
                              
                              
                                 
                                    Σ
                                    1
                                    2
                                 
                                 
                                    Σ
                                    0
                                    2
                                 
                              
                              +
                              
                                 N
                              
                              
                                 
                                    Σ
                                    1
                                    2
                                 
                                 
                                    Σ
                                    0
                                    2
                                 
                              
                              −
                              
                                 N
                              
                              )
                              ,
                           
                         of which N, and 
                           
                              
                                 P
                                 d
                              
                              ¯
                           
                         are fixed. Hence, minimizing the objective function in (14) is equivalent to maximizing 
                           
                              
                                 Σ
                                 1
                                 2
                              
                              
                                 Σ
                                 0
                                 2
                              
                           
                        . Hence, we recast (14) as follows,

                           
                              (15)
                              
                                 
                                    
                                       
                                          maximize
                                       
                                       
                                       
                                          
                                             {
                                             1
                                             +
                                             
                                                
                                                   
                                                      
                                                         Z
                                                         p
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               w
                                                               H
                                                            
                                                            
                                                               h
                                                               z
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         M
                                                         p
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               w
                                                               H
                                                            
                                                            
                                                               h
                                                               m
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         w
                                                         H
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                      w
                                                   
                                                
                                             
                                             }
                                          
                                       
                                    
                                    
                                       
                                    
                                    
                                       
                                          s.t
                                       
                                       
                                       
                                          
                                             
                                                w
                                                H
                                             
                                             
                                                h
                                                z
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        The constraint in (15) ensures that the power received at CRR is unaltered at Zp
                        . Further, Eq. (15) can be written as 
                           
                              {
                              1
                              +
                              
                                 
                                    
                                       Z
                                       p
                                    
                                    
                                       
                                          |
                                          
                                             w
                                             H
                                          
                                          
                                             h
                                             z
                                          
                                          |
                                       
                                       2
                                    
                                 
                                 
                                    
                                       M
                                       p
                                    
                                    
                                       w
                                       H
                                    
                                    
                                       h
                                       m
                                    
                                    
                                       h
                                       m
                                       H
                                    
                                    w
                                    +
                                    
                                       w
                                       H
                                    
                                    
                                       σ
                                       n
                                       2
                                    
                                    w
                                 
                              
                              }
                              ,
                           
                         in which the denominator term of the ratio is interference power plus noise power, which in turn needs to be minimized with the constraint as follows,

                           
                              (16)
                              
                                 
                                    
                                       
                                          minimize
                                       
                                       
                                       
                                          
                                             
                                                w
                                                H
                                             
                                             
                                                (
                                                
                                                   M
                                                   p
                                                
                                                
                                                   H
                                                   m
                                                
                                                +
                                                
                                                   σ
                                                   n
                                                   2
                                                
                                                I
                                                )
                                             
                                             w
                                          
                                       
                                    
                                    
                                       
                                    
                                    
                                       
                                          s.t
                                       
                                       
                                       
                                          
                                             
                                                w
                                                H
                                             
                                             
                                                h
                                                z
                                             
                                             =
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 H
                                 m
                              
                              =
                              
                                 h
                                 m
                              
                              
                                 h
                                 m
                                 H
                              
                           
                        . To find the optimal weight w
                        
                           opt
                        , lagrangian function of (16) is first found, then differentiated with respect to w and the resultant is equated to zero [18].

The lagrangian function of (16) is given by 
                           
                              L
                              =
                              
                                 w
                                 H
                              
                              C
                              w
                              +
                              Ψ
                              
                                 (
                                 
                                    w
                                    H
                                 
                                 
                                    h
                                    z
                                 
                                 −
                                 1
                                 )
                              
                              ,
                           
                         where 
                           
                              C
                              =
                              
                                 M
                                 p
                              
                              
                                 H
                                 m
                              
                              +
                              
                                 σ
                                 n
                                 2
                              
                              I
                              ,
                           
                         and Ψ is the lagrangian multiplier.

Gradient of 
                           L
                         with respect to w is found as,

                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                ∇
                                                w
                                             
                                             L
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   ∂
                                                   
                                                      ∂
                                                      w
                                                   
                                                
                                             
                                             
                                                w
                                                H
                                             
                                             C
                                             w
                                             +
                                             Ψ
                                             
                                                (
                                                
                                                   w
                                                   H
                                                
                                                
                                                   h
                                                   z
                                                
                                                −
                                                1
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                w
                                                H
                                             
                                             C
                                             +
                                             Ψ
                                             
                                                h
                                                z
                                                H
                                             
                                          
                                       
                                    
                                 
                              
                           
                        By equating the gradient in (17) to 0, we get 
                           
                              Ψ
                              
                                 h
                                 z
                                 H
                              
                              =
                              −
                              
                                 w
                                 H
                              
                              C
                              ,
                           
                         which implies 
                           
                              
                                 w
                                 H
                              
                              =
                              −
                              Ψ
                              
                                 h
                                 z
                                 H
                              
                              
                                 C
                                 
                                    −
                                    1
                                 
                              
                           
                        . By substituting this into the constraint of (16), the lagrangian multiplier is obtained as 
                           
                              Ψ
                              =
                              
                                 
                                    −
                                    1
                                 
                                 
                                    
                                       h
                                       z
                                       H
                                    
                                    
                                       C
                                       
                                          −
                                          1
                                       
                                    
                                    
                                       h
                                       z
                                    
                                 
                              
                           
                        .

We get the optimal weight vector w
                        
                           opt
                         by substituting Ψ into 
                           
                              
                                 w
                                 H
                              
                              C
                              +
                              Ψ
                              
                                 h
                                 z
                                 H
                              
                              =
                              0
                           
                        . The w
                        
                           opt
                         is found as,

                           
                              (18)
                              
                                 
                                    
                                       w
                                       t
                                    
                                    a
                                    opt
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      M
                                                      p
                                                   
                                                   
                                                      H
                                                      m
                                                   
                                                   +
                                                   
                                                      σ
                                                      n
                                                      2
                                                   
                                                   I
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                h
                                                z
                                             
                                          
                                          
                                             
                                                h
                                                z
                                                H
                                             
                                             
                                                
                                                   (
                                                   
                                                      M
                                                      p
                                                   
                                                   
                                                      H
                                                      m
                                                   
                                                   +
                                                   
                                                      σ
                                                      n
                                                      2
                                                   
                                                   I
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                h
                                                z
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Eq. (18) requires channel coefficients h
                        
                           m
                         and h
                        
                           z
                         be known. Channel h
                        
                           z
                         in (18) can be estimated through blind-estimation or by using pilot symbols transmitted by PU during training period. We present the technique to estimate h
                        
                           m
                         in the following section.

Estimation of h
                        
                           z
                         can be assisted by pilot symbols transmitted by PU. However, since MCRU intentionally degrades the system’s detection performance, estimation of h
                        
                           m
                         would be a challenge. Here, we present a maximum likelihood estimation (MLE) technique adopted in [19] to estimate h
                        
                           m
                        , by assuming that h
                        
                           z
                         is known. We also assume that PU’s power Zp
                         and pilot symbols are known at CRR. Further, we assume that the channel is a slow-varying one. Therefore in (1), during SP, the term 
                           
                              
                                 
                                    Z
                                    p
                                 
                              
                              
                                 h
                                 
                                    z
                                    l
                                 
                              
                              z
                              
                                 (
                                 i
                                 )
                              
                           
                         is known at CRR, and the same can be subtracted on both sides of (1). This operation is equivalent to treating (1) for the case 
                           
                              α
                              =
                              0
                              ,
                           
                        
                        
                           
                              δ
                              =
                              1
                           
                         and 
                           
                              β
                              =
                              0
                           
                        .

Assuming that h
                        
                           m
                         is slow-varying, its estimate is done once every W frames, before sensing starts. Let 
                           
                              R
                              =
                              
                                 [
                                 
                                    r
                                    0
                                 
                                 
                                 
                                    r
                                    1
                                 
                                 
                                 
                                    r
                                    2
                                 
                                 
                                 ⋯
                                 
                                    r
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 ]
                              
                              ∈
                              
                                 C
                                 
                                    L
                                    ×
                                    N
                                 
                              
                           
                         be the stacking of rl
                        (i), after subtracting 
                           
                              
                                 
                                    Z
                                    p
                                 
                              
                              
                                 h
                                 
                                    z
                                    l
                                 
                              
                              z
                              
                                 (
                                 i
                                 )
                              
                           
                         from (1). Since, rl
                        (i) is independent of one another, the density function of R can be obtained as,

                           
                              (19)
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                                R
                                             
                                             
                                                (
                                                r
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∏
                                                
                                                   n
                                                   =
                                                   0
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      e
                                                      
                                                         −
                                                         
                                                            (
                                                            
                                                               r
                                                               n
                                                               H
                                                            
                                                            
                                                               P
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               r
                                                               n
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         π
                                                         L
                                                      
                                                      det
                                                      
                                                         (
                                                         P
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   e
                                                   
                                                      −
                                                      tr
                                                      
                                                         (
                                                         
                                                            P
                                                            
                                                               −
                                                               1
                                                            
                                                         
                                                         a
                                                         
                                                            RR
                                                            H
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      π
                                                      
                                                         L
                                                         N
                                                      
                                                   
                                                   det
                                                   
                                                      
                                                         (
                                                         P
                                                         )
                                                      
                                                      N
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              P
                              =
                              E
                              
                                 [
                                 a
                                 
                                    RR
                                    H
                                 
                                 /
                                 α
                                 =
                                 0
                                 ,
                                 δ
                                 =
                                 1
                                 ,
                                 β
                                 =
                                 0
                                 ]
                              
                              =
                              
                                 M
                                 p
                              
                              
                                 h
                                 m
                              
                              
                                 h
                                 m
                                 H
                              
                              +
                              
                                 σ
                                 n
                                 2
                              
                              
                                 I
                                 N
                              
                           
                         is the covariance matrix, tr(·) denotes trace and det(·) the determinant of a matrix. Moreover, 
                           
                              det
                              (
                              P
                              )
                           
                         is equal to 
                           
                              
                                 (
                              
                              
                                 M
                                 p
                              
                              
                                 ∥
                              
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              
                                 
                                    ∥
                                    2
                                 
                                 +
                                 
                                    σ
                                    n
                                    2
                                 
                                 )
                              
                              
                                 
                                    (
                                    
                                       σ
                                       n
                                       2
                                    
                                    )
                                 
                                 
                                    (
                                    L
                                    −
                                    1
                                    )
                                 
                              
                           
                        . Then, the likelihood function of R is found by taking the natural logarithm of f
                        
                           R
                        (r) and replacing h
                        
                           m
                         by 
                           
                              
                                 h
                                 ^
                              
                              m
                           
                         which is given by, 
                           
                              F
                              
                                 (
                                 R
                                 )
                              
                              =
                              −
                              tr
                              
                                 (
                                 
                                    P
                                    
                                       −
                                       1
                                    
                                 
                                 a
                                 
                                    RR
                                    H
                                 
                                 )
                              
                              −
                              L
                              N
                              
                                 (
                                 ln
                                 π
                                 )
                              
                              
                                 −
                                 N
                                 ln
                                 (
                              
                              
                                 M
                                 p
                              
                              
                                 ∥
                              
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              
                                 
                                    ∥
                                    2
                                 
                                 +
                                 
                                    σ
                                    n
                                    2
                                 
                                 )
                              
                              −
                              N
                              
                                 (
                                 L
                                 −
                                 1
                                 )
                              
                              ln
                              
                                 σ
                                 n
                                 2
                              
                           
                        .

Using matrix inversion lemma, 
                           
                              
                                 P
                                 
                                    −
                                    1
                                 
                              
                              =
                              
                                 σ
                                 n
                                 
                                    −
                                    2
                                 
                              
                              
                                 I
                                 N
                              
                              −
                              
                                 σ
                                 n
                                 
                                    −
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                       H
                                    
                                 
                                 
                                    
                                       
                                          σ
                                          n
                                          2
                                       
                                       
                                          M
                                          p
                                       
                                    
                                    +
                                    
                                       
                                          ∥
                                          
                                             
                                                h
                                                ^
                                             
                                             m
                                          
                                          ∥
                                       
                                       2
                                    
                                 
                              
                           
                        . Substituting 
                           
                              P
                              
                                 −
                                 1
                              
                           
                         into 
                           
                              F
                              
                                 (
                                 R
                                 )
                              
                              ,
                           
                         we get the likelihood function as,

                           
                              (20)
                              
                                 
                                    
                                       
                                          
                                             F
                                             
                                                (
                                                R
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             −
                                             tr
                                             
                                                {
                                                
                                                   (
                                                   
                                                      σ
                                                      n
                                                      
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      I
                                                      N
                                                   
                                                   −
                                                   
                                                      σ
                                                      n
                                                      
                                                         −
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  h
                                                                  ^
                                                               
                                                               m
                                                            
                                                            
                                                               
                                                                  h
                                                                  ^
                                                               
                                                               m
                                                               H
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  σ
                                                                  n
                                                                  2
                                                               
                                                               
                                                                  M
                                                                  p
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  ∥
                                                                  
                                                                     
                                                                        h
                                                                        ^
                                                                     
                                                                     m
                                                                  
                                                                  ∥
                                                               
                                                               2
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                a
                                                
                                                   RR
                                                   H
                                                
                                                }
                                             
                                             −
                                             N
                                             L
                                             ln
                                             π
                                             −
                                             N
                                             ln
                                             
                                                (
                                                
                                                   σ
                                                   n
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               M
                                                               p
                                                            
                                                            
                                                               
                                                                  ∥
                                                                  
                                                                     
                                                                        h
                                                                        ^
                                                                     
                                                                     m
                                                                  
                                                                  ∥
                                                               
                                                               2
                                                            
                                                         
                                                         
                                                            σ
                                                            n
                                                            2
                                                         
                                                      
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                )
                                             
                                             −
                                             N
                                             
                                                (
                                                L
                                                −
                                                1
                                                )
                                             
                                             ln
                                             
                                                σ
                                                n
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      −
                                                      tr
                                                      
                                                         (
                                                         a
                                                         
                                                            RR
                                                            H
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      σ
                                                      n
                                                      2
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      tr
                                                      
                                                         (
                                                         
                                                            
                                                               h
                                                               ^
                                                            
                                                            m
                                                         
                                                         
                                                            
                                                               h
                                                               ^
                                                            
                                                            m
                                                            H
                                                         
                                                         a
                                                         
                                                            RR
                                                            H
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               σ
                                                               n
                                                               2
                                                            
                                                            
                                                               M
                                                               p
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               ∥
                                                               
                                                                  
                                                                     h
                                                                     ^
                                                                  
                                                                  m
                                                               
                                                               ∥
                                                            
                                                            2
                                                         
                                                         )
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             N
                                             L
                                             ln
                                             π
                                             −
                                             N
                                             ln
                                             
                                                σ
                                                n
                                                2
                                             
                                             −
                                             N
                                             ln
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            M
                                                            p
                                                         
                                                         
                                                            
                                                               ∥
                                                               
                                                                  
                                                                     h
                                                                     ^
                                                                  
                                                                  m
                                                               
                                                               ∥
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                   
                                                
                                                +
                                                1
                                                )
                                             
                                             −
                                             N
                                             L
                                             ln
                                             
                                                σ
                                                n
                                                2
                                             
                                             +
                                             N
                                             ln
                                             
                                                σ
                                                n
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      −
                                                      tr
                                                      
                                                         (
                                                         a
                                                         
                                                            RR
                                                            H
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      σ
                                                      n
                                                      2
                                                   
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         ∥
                                                      
                                                      
                                                         
                                                            h
                                                            ^
                                                         
                                                         m
                                                         H
                                                      
                                                      
                                                         
                                                            R
                                                            ∥
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               σ
                                                               n
                                                               2
                                                            
                                                            
                                                               M
                                                               p
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               ∥
                                                               
                                                                  
                                                                     h
                                                                     ^
                                                                  
                                                                  m
                                                               
                                                               ∥
                                                            
                                                            2
                                                         
                                                         )
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                   
                                                
                                             
                                             −
                                             N
                                             L
                                             ln
                                             π
                                             −
                                             N
                                             ln
                                             
                                                (
                                                
                                                   
                                                      
                                                         
                                                            M
                                                            p
                                                         
                                                         
                                                            
                                                               ∥
                                                               
                                                                  
                                                                     h
                                                                     ^
                                                                  
                                                                  m
                                                               
                                                               ∥
                                                            
                                                            2
                                                         
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                   
                                                
                                                +
                                                1
                                                )
                                             
                                             −
                                             N
                                             L
                                             ln
                                             
                                                σ
                                                n
                                                2
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Differentiating the likelihood function in (20) with respect to 
                           
                              
                                 h
                                 ^
                              
                              m
                           
                         and equating to zero gives the required solution. By setting 
                           
                              
                                 ∂
                                 
                                    ∂
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                 
                              
                              F
                              
                                 (
                                 R
                                 )
                              
                              =
                              0
                           
                         and reducing, we get 
                           
                              
                                 1
                                 N
                              
                              a
                              
                                 RR
                                 H
                              
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              =
                              ν
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              ,
                           
                         which can be written as 
                           
                              
                                 P
                                 ^
                              
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              =
                              ν
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              ,
                           
                         where 
                           
                              
                                 P
                                 ^
                              
                              =
                              
                                 1
                                 N
                              
                              a
                              
                                 RR
                                 H
                              
                           
                         is the sample covariance matrix of R and 
                           
                              ν
                              =
                              
                                 
                                    −
                                    1
                                 
                                 
                                    
                                       (
                                    
                                    
                                       
                                          σ
                                          n
                                          2
                                       
                                       
                                          M
                                          p
                                       
                                    
                                    
                                       +
                                       ∥
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                    
                                       
                                          ∥
                                       
                                       2
                                    
                                    
                                       )
                                       (
                                       ζ
                                       ∥
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                    
                                       
                                          ∥
                                          2
                                       
                                       −
                                       κ
                                       )
                                    
                                 
                              
                              ,
                           
                        
                        
                           
                              ζ
                              =
                              
                                 1
                                 
                                    
                                       (
                                    
                                    
                                       
                                          σ
                                          n
                                          2
                                       
                                       
                                          M
                                          p
                                       
                                    
                                    
                                       +
                                       ∥
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                    
                                       
                                          
                                             ∥
                                             2
                                          
                                          )
                                       
                                       2
                                    
                                    
                                       σ
                                       n
                                       2
                                    
                                 
                              
                              ,
                           
                        
                        
                           
                              κ
                              =
                              
                                 1
                                 
                                    
                                       (
                                    
                                    
                                       
                                          σ
                                          n
                                          2
                                       
                                       
                                          M
                                          p
                                       
                                    
                                    
                                       +
                                       ∥
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                    
                                       
                                          ∥
                                          2
                                       
                                       )
                                    
                                    
                                       σ
                                       n
                                       2
                                    
                                 
                              
                           
                        . The equation 
                           
                              
                                 P
                                 ^
                              
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                              =
                              ν
                              
                                 
                                    h
                                    ^
                                 
                                 m
                              
                           
                         indicates that the estimated channel 
                           
                              
                                 h
                                 ^
                              
                              m
                           
                         should be one of the eigen vectors of 
                           
                              
                                 P
                                 ^
                              
                              ,
                           
                         which maximizes the likelihood function in (20). Hence 
                           
                              
                                 h
                                 ^
                              
                              m
                           
                         is identified as the eigen vector that corresponds to the maximum eigen value, which can be recast as,

                           
                              (21)
                              
                                 
                                    
                                       P
                                       ^
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                    =
                                    
                                       ν
                                       max
                                    
                                    
                                       
                                          h
                                          ^
                                       
                                       m
                                    
                                 
                              
                           
                        Eq. (21) demands that just by finding the eigen vector of 
                           
                              
                                 P
                                 ^
                              
                              ,
                           
                        
                        
                           
                              
                                 h
                                 ^
                              
                              m
                           
                         is obtained. Thus, the process requires the receiver to subtract 
                           
                              
                                 
                                    Z
                                    p
                                 
                              
                              
                                 h
                                 
                                    z
                                    l
                                 
                              
                              z
                              
                                 (
                                 i
                                 )
                              
                           
                         from rl
                        (i). Then the resultant is formed as a matrix R, followed by computing the sample covariance matrix of R. Then the eigen vector corresponding to the maximum eigen value of sample covariance matrix is found.

After SP, if availability of spectrum is sensed, CRT transmits using single antenna for the remaining 
                        
                           T
                           −
                           τ
                        
                      seconds, where T is total frame duration in seconds. SUTP is described in (1) with 
                        
                           α
                           =
                           0
                           ,
                           δ
                           =
                           0
                        
                      and 
                        
                           β
                           =
                           1
                        
                      and the same is shown in Fig. 2. During SUTP, given a weight vector 
                        
                           q
                           =
                           
                              
                                 [
                                 
                                    q
                                    0
                                    *
                                 
                                 
                                 
                                    q
                                    1
                                    *
                                 
                                 
                                 
                                    q
                                    2
                                    *
                                 
                                 ⋯
                                 
                                    q
                                    
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                           ,
                        
                      the linear combination of the received signal vector is obtained using (2) as q
                     H
                     r. We now would like to find power contained in the signal received from CRT alone and also the power contained in the sum of MCRU’s interfering signal and noise. The power contained in the linear combination, when CRT alone transmits is equal to the variance of q
                     H
                     r, which is,

                        
                           (22)
                           
                              
                                 
                                    
                                       
                                          r
                                          a
                                          var
                                          
                                             (
                                             
                                                q
                                                H
                                             
                                             
                                                r
                                                |
                                             
                                             
                                                r
                                                l
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             =
                                             
                                                
                                                   S
                                                   p
                                                
                                             
                                             
                                                h
                                                
                                                   s
                                                   l
                                                
                                             
                                             s
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             [
                                             
                                                
                                                   |
                                                   y
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   |
                                                
                                                2
                                             
                                             ]
                                          
                                          =
                                          E
                                          
                                             [
                                             y
                                             
                                                (
                                                i
                                                )
                                             
                                             
                                                y
                                                H
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             {
                                             
                                                [
                                                
                                                   q
                                                   H
                                                
                                                
                                                   
                                                      S
                                                      p
                                                   
                                                
                                                s
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                   h
                                                   s
                                                
                                                ]
                                             
                                             
                                                
                                                   [
                                                   
                                                      q
                                                      H
                                                   
                                                   
                                                      
                                                         S
                                                         p
                                                      
                                                   
                                                   s
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   
                                                      h
                                                      s
                                                   
                                                   ]
                                                
                                                H
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             {
                                             
                                                S
                                                p
                                             
                                             
                                                [
                                                
                                                   q
                                                   H
                                                
                                                s
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                   h
                                                   s
                                                
                                                ]
                                             
                                             
                                                [
                                                
                                                   h
                                                   s
                                                   H
                                                
                                                
                                                   s
                                                   *
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                q
                                                ]
                                             
                                             }
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             S
                                             p
                                          
                                          
                                             
                                                |
                                                
                                                   q
                                                   H
                                                
                                                
                                                   h
                                                   s
                                                
                                                |
                                             
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        
                     where var(a|b) is the conditional variance operator and 
                        
                           
                              h
                              s
                           
                           =
                           
                              
                                 [
                                 
                                    h
                                    
                                       s
                                       0
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       s
                                       1
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       s
                                       3
                                    
                                    *
                                 
                                 ⋯
                                 
                                    h
                                    
                                       s
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                        
                      is the stacked channel coefficient of hsl
                      and the same is unchanging over one frame. While deriving (22), 
                        
                           E
                           
                              [
                              s
                              
                                 (
                                 i
                                 )
                              
                              
                                 s
                                 *
                              
                              
                                 (
                                 i
                                 )
                              
                              ]
                           
                           =
                           
                              
                                 E
                                 [
                                 |
                                 s
                                 
                                    (
                                    i
                                    )
                                 
                                 |
                              
                              2
                           
                           
                              ]
                              =
                              1
                           
                        
                      is applied.

Likewise, interference plus noise power due to MCRU’s signal and noise is derived from (2) as,

                        
                           (23)
                           
                              
                                 
                                    
                                       
                                          r
                                          a
                                          var
                                          
                                             (
                                             
                                                q
                                                H
                                             
                                             
                                                r
                                                |
                                             
                                             
                                                r
                                                l
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             =
                                             
                                                
                                                   M
                                                   p
                                                
                                             
                                             
                                                h
                                                
                                                   n
                                                   l
                                                
                                             
                                             m
                                             
                                                (
                                                i
                                                )
                                             
                                             +
                                             
                                                n
                                                l
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             [
                                             
                                                q
                                                H
                                             
                                             
                                                [
                                                
                                                   
                                                      M
                                                      p
                                                   
                                                
                                                m
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                   h
                                                   n
                                                
                                                +
                                                
                                                   n
                                                   l
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                ]
                                             
                                             
                                                
                                                   [
                                                   
                                                      
                                                         M
                                                         p
                                                      
                                                   
                                                   m
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   
                                                      h
                                                      n
                                                   
                                                   +
                                                   
                                                      n
                                                      l
                                                   
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                   ]
                                                
                                                H
                                             
                                             q
                                             ]
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                       =
                                    
                                    
                                       
                                          E
                                          
                                             [
                                             
                                                q
                                                H
                                             
                                             
                                                [
                                                
                                                   
                                                      M
                                                      p
                                                   
                                                
                                                m
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                   h
                                                   n
                                                
                                                +
                                                
                                                   n
                                                   l
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                ]
                                             
                                             
                                                [
                                                
                                                   h
                                                   n
                                                   H
                                                
                                                
                                                   m
                                                   *
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                
                                                   
                                                      M
                                                      P
                                                   
                                                
                                                +
                                                
                                                   n
                                                   l
                                                   *
                                                
                                                
                                                   (
                                                   i
                                                   )
                                                
                                                ]
                                             
                                             q
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     We know that m(i) and nl
                     (i) are independent of one another, therefore 
                        
                           E
                           [
                           m
                           
                              (
                              i
                              )
                           
                           
                              n
                              l
                              *
                           
                           
                              (
                              i
                              )
                           
                           ]
                        
                      and E[nl
                     (i)m
                     *(i)] in (23) are zero.

                        
                           (24)
                           
                              
                                 r
                                 a
                                 var
                                 
                                    (
                                    
                                       q
                                       H
                                    
                                    
                                       r
                                       |
                                    
                                    
                                       r
                                       l
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    =
                                    
                                       
                                          M
                                          p
                                       
                                    
                                    
                                       h
                                       
                                          n
                                          l
                                       
                                    
                                    m
                                    
                                       (
                                       i
                                       )
                                    
                                    +
                                    
                                       n
                                       l
                                    
                                    
                                       (
                                       i
                                       )
                                    
                                    )
                                 
                                 =
                                 
                                    M
                                    p
                                 
                                 
                                    
                                       |
                                       
                                          q
                                          H
                                       
                                       
                                          h
                                          n
                                       
                                       |
                                    
                                    2
                                 
                                 +
                                 
                                    q
                                    H
                                 
                                 
                                    σ
                                    n
                                    2
                                 
                                 q
                              
                           
                        
                     where 
                        
                           
                              h
                              n
                           
                           =
                           
                              
                                 [
                                 
                                    h
                                    
                                       n
                                       0
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       n
                                       1
                                    
                                    *
                                 
                                 
                                 
                                    h
                                    
                                       n
                                       3
                                    
                                    *
                                 
                                 ⋯
                                 
                                    h
                                    
                                       n
                                       L
                                       −
                                       1
                                    
                                    *
                                 
                                 ]
                              
                              H
                           
                        
                      is the stacked channel coefficient of hnl
                     .

Throughput is obtained by substituting the result of (22) and (24) into the equation 
                        
                           
                              log
                              2
                           
                           
                              (
                              1
                              +
                              
                                 
                                    Signal
                                    
                                    power
                                 
                                 
                                    Interference
                                    
                                    plus
                                    
                                    noise
                                    
                                    power
                                 
                              
                              )
                           
                           ,
                        
                      which in our case is given by

                        
                           (25)
                           
                              
                                 
                                    
                                       
                                          C
                                          =
                                          
                                             log
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   
                                                      r
                                                      a
                                                      var
                                                      
                                                         (
                                                         
                                                            q
                                                            H
                                                         
                                                         
                                                            r
                                                            |
                                                         
                                                         
                                                            r
                                                            l
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         =
                                                         
                                                            
                                                               S
                                                               p
                                                            
                                                         
                                                         
                                                            h
                                                            
                                                               s
                                                               l
                                                            
                                                         
                                                         s
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      r
                                                      a
                                                      var
                                                      
                                                         (
                                                         
                                                            q
                                                            H
                                                         
                                                         
                                                            r
                                                            |
                                                         
                                                         
                                                            r
                                                            l
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         =
                                                         
                                                            
                                                               M
                                                               p
                                                            
                                                         
                                                         
                                                            h
                                                            
                                                               n
                                                               l
                                                            
                                                         
                                                         m
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         +
                                                         
                                                            n
                                                            l
                                                         
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                         )
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

However, throughput mentioned in (25) is not fully achieved, because, secondary user does not transmit always, rather it may do so during one of the two events, namely wrong identification of occupied spectrum, and correct identification of unused spectrum [13]. The former corresponds to miss-detection event and the latter corresponds to the event of no false alarm respectively. Transmission during miss-detection is unfair. So in our analysis, we only consider throughput which corresponds to the correct identification of unused spectrum. Hence, the average achievable-throughput over all the frames is derived as [13],

                        
                           (26)
                           
                              
                                 
                                    
                                       T
                                    
                                    
                                       =
                                    
                                    
                                       
                                          C
                                          ×
                                          Pr
                                          (
                                          
                                             {
                                             PU
                                             
                                             is
                                             
                                             identified
                                             
                                             to
                                             
                                             be
                                             
                                             idle
                                             }
                                          
                                          ,
                                          
                                             {
                                             PU
                                             
                                             is
                                             
                                             idle
                                             }
                                          
                                          )
                                       
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             log
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   
                                                      
                                                         S
                                                         p
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               q
                                                               H
                                                            
                                                            
                                                               h
                                                               s
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         M
                                                         p
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               q
                                                               H
                                                            
                                                            
                                                               h
                                                               n
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         q
                                                         H
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                      q
                                                   
                                                
                                             
                                             )
                                          
                                          Pr
                                          
                                             (
                                             PU
                                             
                                             is
                                             
                                             identified
                                             
                                             to
                                             
                                             be
                                             
                                             idle
                                             |
                                             PU
                                             
                                             is
                                             
                                             idle
                                             )
                                          
                                          Pr
                                          
                                             (
                                             PU
                                             
                                             is
                                             
                                             idle
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                       T
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             log
                                             2
                                          
                                          
                                             (
                                             1
                                             +
                                             
                                                
                                                   
                                                      
                                                         S
                                                         p
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               q
                                                               H
                                                            
                                                            
                                                               h
                                                               s
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         M
                                                         p
                                                      
                                                      
                                                         
                                                            |
                                                            
                                                               q
                                                               H
                                                            
                                                            
                                                               h
                                                               n
                                                            
                                                            |
                                                         
                                                         2
                                                      
                                                      +
                                                      
                                                         q
                                                         H
                                                      
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                      q
                                                   
                                                
                                             
                                             )
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                
                                                   P
                                                   f
                                                
                                                ¯
                                             
                                             )
                                          
                                          
                                             P
                                             
                                                H
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              P
                              
                                 H
                                 0
                              
                           
                           =
                           1
                           −
                           
                              P
                              
                                 H
                                 1
                              
                           
                        
                      indicates probability that PU is idle, 
                        
                           
                              q
                              H
                           
                           
                              σ
                              n
                              2
                           
                           q
                        
                      is the power due to linear combination of noise samples with weight vector q and 
                        
                           
                              H
                              n
                           
                           =
                           
                              h
                              n
                           
                           
                              h
                              
                                 n
                              
                              H
                           
                        
                     .

From (26), it is clear that throughput can be maximized by minimizing MCRU’s power plus noise power, ensuring that maximum power from secondary transmitter is received. Therefore, the optimization problem can be formulated as follows.

                        
                           (27)
                           
                              
                                 
                                    
                                       minimize
                                    
                                    
                                    
                                       
                                          
                                             q
                                             H
                                          
                                          
                                             (
                                             
                                                M
                                                p
                                             
                                             
                                                H
                                                n
                                             
                                             +
                                             
                                                σ
                                                n
                                                2
                                             
                                             I
                                             )
                                          
                                          q
                                       
                                    
                                 
                                 
                                    
                                       s.t.
                                    
                                    
                                    
                                       
                                          
                                             q
                                             H
                                          
                                          
                                             h
                                             s
                                          
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                     The optimization problem in (27) is similar in form to the one in (16). The lagrangian function of (27) is given by 
                        
                           J
                           =
                           
                              q
                              H
                           
                           D
                           q
                           +
                           Φ
                           
                              (
                              
                                 q
                                 H
                              
                              
                                 h
                                 s
                              
                              −
                              1
                              )
                           
                           ,
                        
                      where 
                        
                           D
                           =
                           
                              M
                              p
                           
                           
                              H
                              n
                           
                           +
                           
                              σ
                              n
                              2
                           
                           I
                           ,
                        
                      and Φ is the lagrangian multiplier.

Gradient of 
                        J
                      with respect to q is found as, 
                        
                           
                              ∇
                              q
                           
                           J
                           =
                           
                              q
                              H
                           
                           D
                           +
                           Φ
                           
                              h
                              s
                              H
                           
                           =
                           0
                        
                      which gives 
                        
                           Φ
                           
                              h
                              s
                              H
                           
                           =
                           −
                           
                              q
                              H
                           
                           D
                        
                      ⇒ 
                        
                           
                              q
                              H
                           
                           =
                           −
                           Φ
                           
                              h
                              s
                              H
                           
                           
                              D
                              
                                 −
                                 1
                              
                           
                        
                     .

By substituting q
                     H into the constraint of (27), we get

                        
                           (28)
                           
                              
                                 
                                    
                                       
                                          −
                                          Φ
                                          
                                             h
                                             s
                                             H
                                          
                                          
                                             D
                                             
                                                −
                                                1
                                             
                                          
                                          
                                             h
                                             s
                                          
                                          =
                                          1
                                       
                                    
                                 
                              
                           
                        
                     which gives 
                        
                           Φ
                           =
                           
                              
                                 −
                                 1
                              
                              
                                 
                                    h
                                    s
                                    H
                                 
                                 
                                    D
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    h
                                    s
                                 
                              
                           
                        
                     . We get optimal weight vector q
                     
                        opt
                      by back substituting Φ into 
                        
                           
                              q
                              H
                           
                           D
                           +
                           Φ
                           
                              h
                              s
                              H
                           
                           =
                           0
                        
                      as follows,

                        
                           (29)
                           
                              
                                 
                                    
                                       
                                          
                                             q
                                             t
                                             H
                                          
                                          a
                                          opt
                                          
                                             (
                                             
                                                M
                                                p
                                             
                                             
                                                H
                                                n
                                             
                                             +
                                             
                                                σ
                                                n
                                                2
                                             
                                             I
                                             )
                                          
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                h
                                                s
                                                H
                                             
                                             
                                                
                                                   h
                                                   s
                                                   H
                                                
                                                
                                                   
                                                      (
                                                      
                                                         M
                                                         p
                                                      
                                                      
                                                         H
                                                         n
                                                      
                                                      +
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                      I
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   h
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             q
                                             t
                                          
                                          a
                                          opt
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         M
                                                         p
                                                      
                                                      
                                                         H
                                                         n
                                                      
                                                      +
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                      I
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   h
                                                   s
                                                
                                             
                                             
                                                
                                                   h
                                                   s
                                                   H
                                                
                                                
                                                   
                                                      (
                                                      
                                                         M
                                                         p
                                                      
                                                      
                                                         H
                                                         n
                                                      
                                                      +
                                                      
                                                         σ
                                                         n
                                                         2
                                                      
                                                      I
                                                      )
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   h
                                                   s
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where we have used the fact that 
                        
                           
                              
                                 (
                                 
                                    D
                                    
                                       −
                                       1
                                    
                                 
                                 )
                              
                              H
                           
                           =
                           
                              D
                              
                                 −
                                 1
                              
                           
                        
                     . While evaluating (29), we assume that h
                     
                        s
                      is known at CRR. (h
                     
                        s
                      can be determined through blind-estimation or by using pilot symbols from secondary transmitter.) However, h
                     
                        n
                      is unknown, and it needs to be estimated. Further, since the secondary transmitter’s power and pilot symbols are known, 
                        
                           
                              
                                 S
                                 p
                              
                           
                           
                              h
                              
                                 s
                                 l
                              
                           
                           s
                           
                              (
                              i
                              )
                           
                        
                      is subtracted from rl
                     (i) of (1) and the resultant is stacked into a matrix 
                        
                           Z
                           ∈
                           
                              C
                              
                                 L
                                 ×
                                 N
                              
                           
                        
                      whose sample covariance is found as 
                        
                           
                              P
                              ^
                           
                           =
                           
                              1
                              N
                           
                           a
                           
                              ZZ
                              H
                           
                        
                     . Then the estimate 
                        
                           
                              h
                              ^
                           
                           n
                        
                      is obtained through the eigen vector that corresponds to the maximum eigen value
                     
                      of 
                        
                           P
                           ^
                        
                     
                  

We have used MATLAB (R2013a) to simulate the scenario. We have performed 1,00,000 Monte-Carlo runs to do the simulation. The signal of PU, i.e., z(i) is taken as complex gaussian random numbers of zero mean and unit variance so that 
                        
                           
                              
                                 Z
                                 p
                              
                           
                           z
                           
                              (
                              i
                              )
                           
                        
                      will have the variance of Zp
                     . Since MCRU mimics PU’s signal, its signal m(i) is also modelled as complex gaussian random numbers of zero mean and unit variance.

Channel between PU and CRR is a slow rayleigh fading channel, therefore hzl
                      is unchanging over a frame and so is hml
                     . The signal-to-noise ratio (SNR) between PU and lth antenna of CRR is defined as 
                        
                           
                              γ
                              l
                           
                           =
                           
                              
                                 
                                    Z
                                    p
                                 
                                 
                                    
                                       |
                                       
                                          h
                                          
                                             z
                                             l
                                          
                                       
                                       |
                                    
                                    2
                                 
                              
                              
                                 σ
                                 n
                                 2
                              
                           
                           ,
                        
                      while γ is the average SNR. It is to be noted that γl
                      is exponentially distributed, when hzl
                      is a complex gaussian random number of zero mean. In addition, it is assumed that γl
                      is same as average SNR γ over the Monte-Carlo runs. Therefore, the variance of hzl
                      is set as 
                        
                           
                              γ
                              
                                 σ
                                 n
                                 2
                              
                           
                           
                              Z
                              p
                           
                        
                     . We have set 
                        
                           T
                           =
                           100
                        
                      ms, 
                        
                           
                              f
                              s
                           
                           =
                           100
                        
                      kHz, 
                        
                           
                              
                                 P
                                 f
                              
                              ¯
                           
                           =
                           0.1
                           ,
                        
                     
                     
                        
                           
                              
                                 P
                                 d
                              
                              ¯
                           
                           =
                           0.9
                           ,
                        
                     
                     
                        
                           
                              σ
                              n
                              2
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              Z
                              p
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           L
                           =
                           2
                        
                      and 4. Emitting power of MCRU is found using 
                        
                           
                              M
                              p
                           
                           =
                           ρ
                           
                              Z
                              p
                           
                        
                     . Noise samples are modelled as circularly symmetric complex gaussian random numbers of zero mean and variance 
                        
                           
                              σ
                              n
                              2
                           
                           =
                           1
                        
                     .

Detection performance of this algorithm is shown in Fig. 3. In this simulation, we have taken the sensing time as 
                        
                           τ
                           =
                           2
                        
                      ms and 5 ms, which gives 
                        
                           N
                           =
                           200
                        
                      and 500, respectively. From Fig. 3, we make the following observations. First, we are able to achieve about 15% of detection even when 
                        
                           γ
                           =
                           −
                           20
                        
                      dB, 
                        
                           τ
                           =
                           2
                        
                      ms, and 
                        
                           L
                           =
                           2
                        
                     . Second, detection performance increases if τ and/or L increase, because, Pd
                      is a function of N and Σ
                     1. The theoretical computations are also plotted in Fig. 3, and verified that they conform to simulation results. Therefore, we present only the simulation results in the discussions to follow.

In Fig. 4, we have shown the detection performance of our method and MRC scheme for various power levels of MCRU. The detection performance of MRC - when there is no MCRU - is juxtaposed in the same Fig. 4. We define 
                        
                           ρ
                           =
                           
                              
                                 M
                                 p
                              
                              
                                 Z
                                 p
                              
                           
                        
                      to describe the MCRU’s attack during SP, meaning larger value of ρ denotes stronger attack. Number of antennas is chosen as 
                        
                           L
                           =
                           4
                        
                     . Other parameters are 
                        
                           
                              f
                              s
                           
                           =
                           100
                        
                      kHz, 
                        
                           τ
                           =
                           2
                        
                      ms, 
                        
                           
                              
                                 P
                                 f
                              
                              ¯
                           
                           =
                           0.1
                           ,
                        
                     
                     
                        
                           
                              σ
                              n
                              2
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              Z
                              p
                           
                           =
                           1
                        
                     . The values of ρ are taken as 0.1, 10, and 50. Value of 
                        
                           ρ
                           =
                           0.1
                        
                      indicates minimum power of MCRU and therefore weaker attack, whereas 
                        
                           ρ
                           =
                           50
                        
                      indicates the stronger one. Transmitting power of MCRU is found using 
                        
                           
                              M
                              p
                           
                           =
                           ρ
                           
                              Z
                              p
                           
                        
                     . The SNR γ is set to vary from 
                        −
                     20 dB to 0 dB. MRC finds the optimal weight vector using conj(h
                     
                        z
                     ), where conj(·) is the complex conjugation operator. In Fig. 4, MRC records the best detection performance, when there is no MCRU in the network. It is observed that the detection performance of our scheme when 
                        
                           ρ
                           =
                           0.1
                        
                      is quite close to that of MRC’s. But when ρ increases, performance of MRC starts degrading, whereas our scheme does not compromise its detection. This fact can be verified from Fig. 4 that Pd
                      is not compromised even when 
                        
                           ρ
                           =
                           10
                        
                      for which MRC compromises and the degradation is severe when 
                        
                           ρ
                           =
                           50
                        
                     . For instance, at an SNR of 
                        −
                     10 dB, when 
                        
                           ρ
                           =
                           10
                           ,
                        
                      MRC offers only 22% detection, whereas our method achieves 89%. Similarly, superiority of our method can be observed when 
                        
                           ρ
                           =
                           50
                        
                     . In this case, at an SNR of 
                        −
                     10 dB, our method achieves same 89% detection, but, MRC achieves only 14%. It is also to be noted that detection performance of proposed method is identical when 
                        
                           ρ
                           =
                           10
                        
                      or 
                        
                           ρ
                           =
                           50
                           ,
                        
                      and is superior to MRC’s, which means increase in ρ does not diminish the detection performance of our scheme.

Detection performance of our scheme for various L and Zp
                      is plotted in Fig. 5. In this simulation, we have chosen the set of L values as 2, 4 and 8. The values of Zp
                      are chosen as 1, 2 and 4. The curve of detection performance of MRC, when 
                        
                           L
                           =
                           8
                        
                      and 
                        
                           
                              Z
                              p
                           
                           =
                           4
                        
                      is plotted as a reference, which sets an upper bound. The value of ρ is set as 10. Other parameters are 
                        
                           
                              f
                              s
                           
                           =
                           100
                        
                      kHz, 
                        
                           τ
                           =
                           2
                        
                      ms, 
                        
                           
                              
                                 P
                                 f
                              
                              ¯
                           
                           =
                           0.1
                           ,
                        
                      and 
                        
                           
                              σ
                              n
                              2
                           
                           =
                           1
                        
                     . We observe from this Fig. 5 that increase in L value, increases the detection probability, because Pd
                      is a function of Σ
                     1, which depend on L. But increase in Zp
                      will not make any improvement in detection performance, because SNR is fixed at a particular value, which is unaltered, even when Zp
                      changes. This is clearly seen if we observe the curves “Proposed 
                        
                           L
                           =
                           2
                           ,
                        
                     
                     
                        
                           
                              Z
                              p
                           
                           =
                           1
                        
                     ” and “Proposed 
                        
                           L
                           =
                           2
                           ,
                        
                     
                     
                        
                           
                              Z
                              p
                           
                           =
                           2
                        
                     ”, which are one and the same and there is no improvement due to increase in Zp
                     . The Pd
                      curve of MRC assuming no MCRU when 
                        
                           L
                           =
                           8
                        
                      and 
                        
                           
                              Z
                              p
                           
                           =
                           4
                        
                      is also sketched in Fig. 5 as a reference. This curve sets an upper bound to all other curves.

The plot of mean-squared-error (MSE) between h
                     
                        m
                      and 
                        
                           
                              h
                              ^
                           
                           m
                        
                      is shown in Fig. 6
                      with respect to N. We have set N varying from 10 to 500 in steps of 10. The parameters used in this simulation are 
                        
                           
                              Z
                              p
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           
                              σ
                              n
                              2
                           
                           =
                           1
                           ,
                        
                     
                     
                        
                           ρ
                           =
                           10
                        
                      and 
                        
                           L
                           =
                           4
                        
                     . For convenience sake, we have found MSE of the channel, which exist between MCRU and any one of the L antennas of CRR. For instance, in this plot, we have found MSE between h
                     
                        m1 and its estimate 
                        
                           
                              h
                              ^
                           
                           
                              m
                              1
                           
                        
                     . In fact, the plot of MSE between any hml
                      and its estimate 
                        
                           
                              h
                              ^
                           
                           
                              m
                              l
                           
                        
                      will be identical to the one shown in Fig. 6. Further, this plot includes the curves that correspond to unique values of signal-to-interference-plus-noise-ratio (SINR), which is defined as the ratio 
                        
                           
                              
                                 Z
                                 p
                              
                              
                                 
                                    |
                                    
                                       h
                                       
                                          z
                                          l
                                       
                                    
                                    |
                                 
                                 2
                              
                           
                           
                              
                                 M
                                 p
                              
                              
                                 
                                    |
                                    
                                       h
                                       
                                          m
                                          l
                                       
                                    
                                    |
                                 
                                 2
                              
                              +
                              
                                 σ
                                 n
                                 2
                              
                           
                        
                     . One of the observations we make from Fig. 6 is this: when N increases, MSE decreases, because, increasing the sample size brings the sample-covariance-matrix 
                        
                           
                              P
                              ^
                           
                           ,
                        
                      close to P. Therefore, its eigen vector is too close to h
                     
                        m
                     .

We name the curves in Fig. 6 as “SINR = 5 dB”, “SINR = 0 dB” and “SINR = 
                        −
                     2 dB” corresponding to the SINR values of 5 dB, 0 dB and 
                        −
                     2 dB, respectively. It is evident from Fig. 6 that the deviation between the curves “SINR = 5 dB”, “SINR = 0 dB” and “SINR = 
                        −
                     2 dB” is very small. This shows that estimation is not affected by the transmitted power level of MCRU. For instance, the value of SINR = 
                        −
                     2 dB indicates stronger power level of MCRU than that of SINR = 5 dB. But the corresponding deviation between the curves “SINR = 
                        −
                     2 dB” and “SINR = 5 dB” is very small. Therefore, we conclude that the estimation is robust against the power level of MCRUs transmitter. We have not included the separate results of channel estimation during SUTP, as the discussions will be similar to the one we have presented here.

Throughput achieved by this method is compared with that of MRC in Fig. 7
                     . We define SNR between CRT and CRR as 
                        
                           
                              γ
                              s
                           
                           =
                           
                              
                                 
                                    S
                                    p
                                 
                                 
                                    
                                       |
                                       
                                          h
                                          
                                             s
                                             l
                                          
                                       
                                       |
                                    
                                    2
                                 
                              
                              
                                 σ
                                 n
                                 2
                              
                           
                        
                     . In simulating the scenario of Fig. 7, we have kept 
                        
                           γ
                           =
                           −
                           10
                        
                      dB, 
                        
                           
                              γ
                              s
                           
                           =
                           10
                        
                      dB, 
                        
                           L
                           =
                           4
                           ,
                        
                     
                     
                        
                           T
                           =
                           100
                        
                      ms, 
                        
                           
                              f
                              s
                           
                           =
                           100
                        
                      kHz, 
                        
                           
                              σ
                              n
                              2
                           
                           =
                           1
                        
                      and 
                        
                           
                              
                                 P
                                 d
                              
                              ¯
                           
                           =
                           0.9
                        
                     . Moreover, we have assumed that the channel coefficients are known at the CRR. The probability that PU is present is assumed as 0.2. Weight vector corresponding to MRC, during SUTP is found as 
                        
                           
                              q
                              
                                 t
                                 −
                                 M
                                 R
                                 C
                                 a
                                 opt
                                 −
                                 MRC
                              
                           
                           =
                           conj
                           
                              (
                              
                                 h
                                 s
                              
                              )
                           
                        
                     . In this case, we have let 
                        
                           ρ
                           =
                           0.01
                           ,
                           1
                           ,
                           10
                           ,
                        
                      and 
                        
                           η
                           =
                           0.01
                           ,
                           10
                           ,
                           100
                        
                      to illustrate the impact of MCRU during SP and SUTP respectively. The larger value of ρ and η indicate stronger power of MCRU than PU and secondary transmitter respectively. The throughput curves of our scheme and MRC in Fig. 7 are sketched for various combinations of ρ and η namely, 
                        
                           ρ
                           =
                           0.1
                           ,
                           η
                           =
                           0.01
                           ,
                        
                     
                     
                        
                           ρ
                           =
                           10
                           ,
                           η
                           =
                           10
                           ,
                        
                      and 
                        
                           ρ
                           =
                           50
                           ,
                           η
                           =
                           100
                        
                     . These combinations are denoted in the legend of Fig. 7 as *, # and $, respectively. We observe from this Fig. 7 that achievable throughput of our method is superior to MRC for each value of ρ and η. For instance, the maximum throughput achieved by our method when 
                        
                           ρ
                           =
                           10
                        
                      and 
                        
                           η
                           =
                           10
                        
                      is 3.5 bits/s/Hz, whereas the MRC scheme achieves only 0.4 bits/s/Hz when ρ and η are 10.


                     Fig. 8
                      depicts the impact of channel estimation technique discussed in Sections 3.2 and 4 on the achievable throughput. In this simulation, we have assumed that h
                     
                        z
                      and h
                     
                        s
                      were known at CRR as if they were estimated through some pilot-assisted or blind estimation techniques. We have then estimated the channels h
                     
                        m
                      and h
                     
                        n
                      and have plotted the achievable throughput in Fig. 8. Further, we assume that channels are slow-varying and therefore, remain unchanged for W frames, the value of W being taken as 10 here. Hence, the estimation is done once in every 10 frames periodically. Other parameters remain the same as required to simulate the curves in Fig. 7. We observe from Fig. 8 that achievable throughput using estimated channel coefficients is overlapping with that obtained using known channel coefficients. It is also evident from Fig. 8 that achievable throughput after channel estimation is not affected by the transmitted power level of MCRU. In other words, achievable throughput after estimation of channels h
                     
                        m
                      and h
                     
                        n
                      are not affected, when 
                        
                           ρ
                           =
                           50
                        
                      and 
                        
                           η
                           =
                           50
                        
                      (which means MCRU transmits a signal having 50 times stronger power than PU as well as CRT). This fact is verified in Fig. 8 from the consonance between the throughput curves, which are obtained using known channel coefficients and estimated channel coefficients.

We would like to show the complexity analysis for the proposed method. Computation complexity includes the process of multiplication, addition, memory read and write. The process of multiplication and addition are put together as floating point operations (FLOPS), whereas memory read/write operations are put together as memory operations (MEMOPS). Complexity analysis during SP, for each operation of the algorithm is shown in Table 1
                     .

Of the 5 steps shown in Table 1, only first 2 steps are to be done every frame. Steps from 3 to 5 are to be executed once in W frames. Number of MEMOPS required in first two steps are 
                        
                           ≈
                           2
                           (
                           L
                           +
                           N
                           )
                        
                     . Number of FLOPS required in first two steps are 
                        
                           ≈
                           2
                           
                              (
                              L
                              +
                              N
                              )
                           
                        
                     . Number of MEMOPS required in steps 3, 4 and 5 are 
                        
                           ≈
                           7
                           
                              L
                              2
                           
                           +
                           5
                           L
                           +
                           2
                           N
                           L
                        
                     . Number of FLOPS required in steps 3, 4 and 5 are 
                        
                           ≈
                           2
                           
                              L
                              3
                           
                           +
                           O
                           
                              (
                              
                                 L
                                 3
                              
                              )
                           
                           +
                           9
                           
                              L
                              2
                           
                           +
                           2
                           
                              L
                              2
                           
                           N
                           +
                           3
                           L
                        
                     .

Considering the simulation parameters 
                        
                           τ
                           =
                           5
                        
                      ms, 
                        
                           
                              f
                              s
                           
                           =
                           100
                        
                      kHz → 
                        
                           N
                           =
                           τ
                           ×
                           
                              f
                              s
                           
                           =
                           500
                        
                      samples, 1000 frames, 
                        
                           L
                           =
                           4
                        
                      and 
                        
                           W
                           =
                           10
                           ,
                        
                      number of MEMOPS required is 
                        
                           2
                           ×
                           1000
                           
                              (
                              L
                              +
                              N
                              )
                           
                           +
                           100
                           
                              (
                              7
                              
                                 L
                                 2
                              
                              +
                              5
                              L
                              +
                              2
                              N
                              L
                              )
                           
                           ≈
                           1421200
                        
                      MEMOPS. Number of FLOPS required is 
                        
                           2
                           ×
                           1000
                           
                              (
                              L
                              +
                              N
                              )
                           
                           +
                           100
                           
                              (
                              2
                              
                                 L
                                 3
                              
                              +
                              O
                              
                                 (
                                 
                                    L
                                    3
                                 
                                 )
                              
                              +
                              9
                              
                                 L
                                 2
                              
                              +
                              2
                              
                                 L
                                 2
                              
                              N
                              +
                              3
                              L
                              )
                           
                           ≈
                           2636400
                        
                      + 
                        
                           O
                           (
                           
                              L
                              3
                           
                           )
                        
                      FLOPS.

There are processors which are capable of performing operations of the order of Giga FLOPS per second. So 2636400 + 
                        
                           O
                           
                              (
                              
                                 L
                                 3
                              
                              )
                           
                        
                      FLOPS may consume approximately 2.6 ms + 
                        
                           O
                           
                              (
                              
                                 L
                                 3
                              
                              )
                           
                           ×
                           1
                           ×
                           
                              10
                              
                                 −
                                 9
                              
                           
                           s
                        
                     . Including MEMOPS, processor time consumption might be a few milliseconds. When complexity analysis during SUTP is considered, step 2 of the Table 1 can be ignored.

@&#CONCLUSION@&#

In this paper, we have proposed a diversity combining method to improve the sensing performance and throughput of secondary network, when MCRU coexists in a CRN. We have obtained a closed form expression for achievable throughput and formulated the optimization problem with solutions. Moreover, we have presented a MLE technique to estimate the channel between MCRU and CRR. In addition, we have verified that simulation results of throughput and detection performance are in consonance with theoretical computations. Further, the simulation results show that proposed method improves the sensing performance and throughput of secondary network, when conventional MRC fails, in the presence of MCRU in a CRN.

@&#REFERENCES@&#

