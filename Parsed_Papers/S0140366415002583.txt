@&#MAIN-TITLE@&#Localization in vehicular ad hoc networks using data fusion and V2V communication

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The paper deals with challenging localization problem in vehicular ad-hoc networks.


                        
                        
                           
                           A novel approach is proposed based on the idea of cooperative localization.


                        
                        
                           
                           Our scheme integrates available data and cooperatively improves location accuracy.


                        
                        
                           
                           Localization is more accurate and robust to sensor inaccuracies or even to failures.


                        
                        
                           
                           The estimation of vehicle prior and sequential decentralized EKF improve further.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Vehicular ad-hoc networks

Data fusion

Extended Kalman filtering

Cooperative vehicle localization

Sequential extended Kalman filtering

@&#ABSTRACT@&#


               
               
                  In Vehicular ad-hoc networks (VANETs), one of the challenging tasks is to find an accurate localization information. In this paper, we have addressed this problem by introducing a novel approach based on the idea of cooperative localization. Our proposed scheme incorporates different techniques of localization along with data fusion as well as vehicle-to-vehicle communication, to integrate the available data and cooperatively improve the accuracy of the localization information of the vehicles. The simulation results show that sharing the localization information and deploying that of the neighboring vehicles, not only assures the vehicles in a vicinity to obtain more accurate localization information, but also find the results robust to sensor inaccuracies or even to failures. Moreover, further improvement has been achieved by estimating the vehicle prior (prior mean and covariance) using unscented transform (UT) together with sequential decentralized extended Kalman filtering.
               
            

@&#INTRODUCTION@&#

Vehicular ad-hoc networks (VANETs) are a specific type of ad-hoc networks, which are infrastructure-free as well as they have fixed and mobile nodes. In VANETs, the nodes are deemed vehicles with high dynamicity causing rapid changes in the network topology. VANET can be viewed as an intelligent component of Intelligent Transportation Systems (ITS) as the vehicles communicate with each other as well as with the roadside base stations/roadside units (RSUs) located at critical points of the road, such as intersections or construction sites. VANETs differ notably from other types of ad-hoc networks, such as wireless sensor networks (WSNs) or mobile ad-hoc networks (MANETs) in terms of node dynamics and heterogeneity. The comprehensive well-organized VANETs are responsible for extracting, managing and interpreting the information to achieve knowledge, and making it available for travelers. A comprehensive overview of the properties, features and applications of VANETs are presented in [1].

VANETs have various applications including safe and convenient driving, emergency and entertainment applications, intelligent navigation, etc [2]. The key features of the VANETs over the conventional ITS are their network-based structure and the capability of communication between vehicles, i.e. vehicle-to-vehicle (V2V), and vehicles to roadside units (V2R) or other available infrastructures (V2I), by utilizing the underlying communication platforms and standardized protocols [2,3]. In V2V, the vehicles communicate with each other to share the information needed by an application or so called “service”. For example, vehicles can share velocity information while they are moving on the same lane, to provide information on safe speed under safety service. Vehicles can even communicate with the nearby roadside units (V2R) for further assistance, for instance a vehicle could inform about the surrounding traffic situation to an approaching distant vehicle by sharing the traffic information with its nearest roadside unit. Moreover, the vehicles have privilege to communicate with the already existing infrastructures and the ITS service providers, such as traffic agencies to get relevant information (e.g. traffic information for convenient driving). The information exchange over a wireless network between the vehicles, roadside units, and infrastructure usually consists of various context based attributes, such as vehicle’s speed, location, and direction of travel [4,5]. With these information, an advanced driving system can decide whether a crash is likely to alert the driver to brake, or even a more advanced autonomous driving system can brake the vehicle if a driver is slow to respond. Besides V2V, the V2I communications are further deployed to develop assisted driving systems. Other services of V2V include transferring the emergency messages, enhancing GPS accuracy, etc. V2I, on the other hand, is applied in toll collection, transferring important localized message related to road-traffic situation as well as providing access for some ITS related services.

One of the crucial information attributes in VANETs is location and its accurate calculation is a challenging issue [6]. The commonly used sensors such as odometer and Global Positioning System (GPS) are often employed to calculate the location of a vehicle. The use of GPS is fairly simply and the cost is low. However, it sometimes gives inaccurate results because of satellite blockage particularly in the urban areas. Therefore, the localization problem in VANETs is still an open issue.

In this paper, we propose a new localization approach for localization of a vehicle using vehicle motion model (for modeling the dynamic motion model of a vehicle) along with V2V communication and a data fusion method. We measure the belief of each vehicle about its current location using Extended Kalman Filter (EKF) [7], and then improve it by communicating with the neighboring vehicles and incorporating their beliefs about that vehicle’s location. This approach allows us the simultaneous and efficient use of all the available sources of information unlike inability of the existing systems. This would lead us to achieve a real-time autonomous framework in VANETs due to their recursive online location estimation and ability to recover from failure.

The remaining of the paper is organized as follows. The related works are reviewed in Section 2, while a brief background is given in Section 3. Section 4 describes our new localization approach. Section 5 presents the simulation results. Section 6 addresses some important issues associated with the proposed method. The conclusion is drawn in Section 7.

@&#RELATED WORKS@&#

Different localization approaches in VANETs are categorized in [6] according to Global Positioning Systems, Map Matching, Dead Reckoning, Cellular Localization, Image/Video Processing, Localization Services, and Relative Distributed Ad-Hoc Localization. Although most of the methods have their own advantages over the basic methods, only few of them are combined approaches with new ideas. We introduce here some interesting relevant contributions as those are either under one of the categories mentioned above, or an integration of them.

In [8], the vehicle localization is based on directional information by measuring the inter-radio distances between each node to other nodes within their proximity. This directional/dual wireless radio localization (DWRL) algorithm consists of semi-localization and rigid-localization without requiring the GPS. The localization process initiates by one of the node designated/located as sink node, which selects a node within its wireless range under the semi-localization. Then other unknown nodes are located with respect to the known locations of the sink node and semi-localized node in the rigid localization (Algorithm 1
                     ).

The authors of [9] present the idea of using radio-range techniques by measuring the distance (radiolocation) between a sender and a receiver and discuss about various radio-ranging distance measurement methods based on the ways to estimate the distance. In [9], the distance between the sender and the receiver is estimated based on theoretic modeling of path loss attenuation of the radiolocation signal. The distance can also be estimated from Angle of Arrival (AOA) and Time of Arrival (TOA) information, where the angle of the incoming signal at the receiver and one-way propagation time between transmitter and receiver are measured, respectively. The distance can be further estimated by measuring the Time Difference Of Arrival (TDOA) between a pair of receivers.

In [10], Yao et al. propose a cooperative positioning (CP) method which fuses kinematics information obtained from GPS or other kinematic sensors, with the distance measurements calculated based on radio-ranging techniques such as TOA and TDOA. The vehicles positions accuracy within each vehicle cluster have been further improved by using a routing algorithm in [11]. The effect of exchanging large amount of information between vehicles on positioning accuracy is further studied. The efficiency of the CP system has been evaluated over the unassisted GPS positioning in terms of a proposed performance metric called as positioning accuracy gain (PAG). The accuracy bounds of CP in VANETs are found as the inverse of Fisher Information Matrix (FIM) [12]. As shown in [10], the positioning accuracy of the whole cluster can be increased to more than 40%, even in low traffic density, while the accuracy gain PAG exceeds 70% under heavy traffic density. However, the performance is significantly affected by the packet collisions under real-world communication constraints. Another CP based method is proposed recently in [13], where low-level GPS information (psuedoranges) is used to be shared among the participating vehicles. The relative position of each vehicle to its neighbors is then estimated by fusing the local GPS observations and those of the neighbors, which can be received through vehicular communication.

A grid-based vehicle localization scheme is proposed in [14], which controls the propagation of the location error and exploits different typical geometrical patterns between the vehicle and its neighbors. It is found in [14] that error propagates slowly and linearly in grid-based schemes which makes the proposed scheme efficient in calculating the vehicle location than the nongrid-based scheme, where the error rapidly increases with large variance.

The proposed localization scheme in [15] relies on Road-Side Units (RSUs) assuming that a pair of RSUs are deployed on either side of the road while communicating with the passing vehicles continuously. In this scheme, each vehicle communicates with each of RSUs through broadcasting beacon messages, and estimates its position by measuring the distance to each RSU using radio-ranging techniques such as TOA or TDOA. Then, two intersecting circles are found, and their intersections are calculated. Assuming that a vehicle knows in which direction it is traveling, the correct position of the vehicle is assessed after the second round of message broadcasting. The performance is evaluated in terms of root mean squared error (RMSE) of the corresponding localization results and found robust against traffic density as well as vehicle speed for both faulty and fault-free RSU conditions. It is shown that this RSU-based V2I method in the fault-free environment outperforms the common V2V-based localization methods [16–18].

In [19] and [20], cooperative vehicle localization (CoVel) is addressed for which the authors propose a comprehensive framework incorporating different types of localization methods as discussed in [6] to utilize different levels of available information. In their framework, final position is estimated by combining the outputs of Absolute Positioning, Relative Positioning, and Group Map Matching components. Various sources of data/information are used by these components obtained from a data access system EDAS (EGNOS Data Access System), odometer, GNSS (Global Navigation Satellite System) receiver, car-to-car communication, and a digital map. For the relative positioning component, each vehicle determines the relative vector to other vehicles, using location information provided by absolute positioning component, and uses this information to do the group map matching in digital map in order to refine the estimated location. However, the results of positioning highly depend on the vehicle constellation (i.e. the number and geographical arrangements of the vehicles) and the road topology networks (e.g. the number of lanes and intersections). It is reported that for good vehicle constellations the position error can even be lowered by 85% compared to the standard GPS solution. The time synchronization is also crucial as it gives an error during the relative positioning.

A survey on various localization methods in VANETs is presented in [21] emphasizing the GPS error and its unavailability in several situations. The authors in [21] also introduces the usefulness of the data fusion techniques for position information of the vehicles in safety applications.

In [22], a localization method for VANETs is proposed based on the weighted localization using the SINR (signal to interference-noise ratio) obtained from the becons and the distance between the neighboring vehicles where it is assumed that closer vehicles have higher SINR values and thus will have larger weights, and vice-versa.

In [23], the idea of using distance measurements to improve the accuracy of the GPS-based location estimation is introduced. In their proposed framework (VLOCI), the authors assume that all vehicles are equipped with GPS to provide their estimated current locations, moving on a single lane, and communicating only with other vehicles on the same lane. The vehicles continuously measure the distance to their neighbors and each vehicle collects the estimated locations of its neighbors (obtained by GPS) to compute its own location in their coordinate frames, using the measured distance. The improved estimated location is finally obtained by calculating a weighted sum over the obtained estimated locations, where the weights are proportional to the distance of neighbors. In [23], two techniques used to measure the distance are based on TOA and the received signal strength where the accuracy of these techniques can be modeled to vary with the distance to be measured. Therefore, measuring the distance to closely range vehicles is more accurate than measuring the distance to those further away. To estimate the position, each vehicle receives messages from its neighbors containing their estimated positions as well as measures the distance between itself and its neighbors. Moreover, the variance in erroneous distance measurements is tackled by taking multiple measurements for which the average can be used as the final distance measurement. The main drawback of this approach is that the distance measurements may be obtained in any direction due to the fact that vehicles can be skewed from left side to right side of the ego vehicle or vice-versa. In other words, a neighboring vehicle at distance r can be in any direction relative to the ego vehicle meaning that its position forms a circle with radius r that is centered around the ego vehicle. This causes the phase shift giving additional time-delay and makes the distance measurement erroneous.

Our contribution is relevant to [23], and improves the proposed framework in [23] by eliminating the restriction of all vehicles having GPS, and employing data fusion techniques such as EKF to estimate the location of vehicles by predicting it using predefined dynamic motion model, and refining it using GPS sensor and the information received from other vehicles. On the other hand, we use both TOA and AOA for measuring the location of the neighboring vehicles in the polar coordinate frame, which further helps to communicate with the vehicles on other lanes. Finally, we improve the location accuracy by computing a weighted sum over all of the estimated locations for each vehicle, where the weights are proportional to the belief of each vehicle regarding its current position, which can be easily estimated using the above mentioned data fusion filtering method.

@&#BACKGROUND@&#

In this section, we briefly describe the methods we have adopted to our new localization approach for VANETs.

The most commonly used algorithm for the state estimation is the Bayesian filtering approach [7], which calculates the probabilities of multiple beliefs to allow a vehicle to infer its position and orientation. Bayesian filtering provides a general framework to estimate the state of the system (the current location of all vehicles in our case) based on probabilistic theory [24]. The general formulation of Bayesian filtering is as follows:

                           
                              (1)
                              
                                 
                                    
                                       
                                          
                                             
                                                Bel
                                                ¯
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             =
                                             ∫
                                             p
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                |
                                                
                                                   u
                                                   t
                                                
                                                ,
                                                
                                                   x
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             Bel
                                             
                                                (
                                                
                                                   x
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             d
                                             
                                                x
                                                
                                                   t
                                                   −
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       
                                          
                                             Bel
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   p
                                                   
                                                      (
                                                      
                                                         z
                                                         t
                                                      
                                                      |
                                                      
                                                         x
                                                         t
                                                      
                                                      ,
                                                      
                                                         z
                                                         
                                                            1
                                                            :
                                                            t
                                                            −
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         u
                                                         
                                                            1
                                                            :
                                                            t
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      Bel
                                                      ¯
                                                   
                                                   
                                                      (
                                                      
                                                         x
                                                         t
                                                      
                                                      )
                                                   
                                                
                                                
                                                   p
                                                   (
                                                   
                                                      z
                                                      t
                                                   
                                                   |
                                                   
                                                      z
                                                      
                                                         1
                                                         :
                                                         t
                                                         −
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      u
                                                      
                                                         1
                                                         :
                                                         t
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where x
                        
                           t
                        , u
                        
                           t
                        , and z
                        
                           t
                         are the vehicle’s state vector (the position expressed in polar coordinate), input control vector (consists of outputs from gas, brake pedal and steering wheel angle sensors), and sensor measurement (GPS measurement) at time t, respectively. Moreover, 
                           
                              p
                              (
                              
                                 x
                                 t
                              
                              |
                              
                                 u
                                 t
                              
                              ,
                              
                                 x
                                 
                                    t
                                    −
                                    1
                                 
                              
                              )
                           
                         and p(z
                        
                           t
                        |x
                        
                           t
                        ) are “state transition” and “measurement” probability density functions.

Using Markov assumption and the fact that the denominator does not depend on x (as it will be the same for all values of x), we can express Eq. (2) as follows:

                           
                              (3)
                              
                                 
                                    
                                       
                                          
                                             Bel
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             =
                                             η
                                             p
                                             
                                                (
                                                
                                                   z
                                                   t
                                                
                                                |
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             
                                                Bel
                                                ¯
                                             
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where η is a normalizing factor. Therefore, the belief of a vehicle about its current location as denoted by Bel(x
                        
                           t
                        ) in Eq. (3), is normalized between 0 and 1 with constant η.

Extended Kalman Filter is an extended version of Kalman filter, which is a recursive state estimator that constitutes the earliest tractable implementations of the Bayesian filter. If the initial uncertainty is assumed to be Gaussian and the observation model and system dynamics are linear functions of the state, then Kalman filters are the optimal estimators. However, since most of the systems are not strictly linear we need to apply EKF, which linearize the system using first-order Taylor series expansions. Although the main advantage of Kalman filter is its computational efficiency, it can represent only unimodal distributions which limits them to local localization. Moreover, Kalman filters cannot satisfactorily solve ambiguities such as symmetries, and therefore, for instance, it is unable to track an object (e.g. robot/vehicle) in case of failure. Another shortcoming of Kalman filters is that, they cannot incorporate negative information. Finally, Kalman filters provide no convincing solution to the data association problem and the false data associations often lead to disastrous failures [25].

For further refinement of the EKF estimation, unscented transform (UT) is incorporated. When the state evolution system f(u
                        
                           t
                        , x
                        
                           t
                        ) and/or the measurement system h(x
                        
                           t
                        ) is non-linear or EKF performance is poor then UT can be used. In this case, UT approximates the vehicle prior (prior mean and covariance) of EKF using the deterministic sampling technique by picking a minimal set of sample points (called sigma points) around the mean. The UT is based on selecting a set S that consists of sigma points Xi
                         and weights Wi
                         so that the resulting estimate on the state x
                        
                           t
                         and covariance Pt
                         become:

                           
                              (4)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   ^
                                                
                                                t
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                             
                                                W
                                                
                                                   i
                                                
                                                
                                                   m
                                                   e
                                                   a
                                                   n
                                                
                                             
                                             
                                                X
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   P
                                                   ^
                                                
                                                t
                                             
                                             =
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   0
                                                
                                                
                                                   2
                                                   n
                                                
                                             
                                             
                                                W
                                                
                                                   i
                                                
                                                
                                                   c
                                                   o
                                                   v
                                                
                                             
                                             
                                                [
                                                
                                                   X
                                                   i
                                                
                                                −
                                                
                                                   
                                                      x
                                                      ^
                                                   
                                                   t
                                                
                                                ]
                                             
                                             
                                                
                                                   [
                                                   
                                                      X
                                                      i
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                         ^
                                                      
                                                      t
                                                   
                                                   ]
                                                
                                                ′
                                             
                                             +
                                             
                                                Q
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where n, (′) and Q
                        
                           t
                         represent the number of states n = 3 in the analyzed cases, transpose and process noise, respectively and the weights of 
                           
                              W
                              
                                 i
                              
                              
                                 m
                                 e
                                 a
                                 n
                              
                           
                         and 
                           
                              W
                              
                                 i
                              
                              
                                 c
                                 o
                                 v
                              
                           
                         are calculated accordingly:

                           
                              (6)
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                                
                                                   0
                                                
                                                
                                                   m
                                                   e
                                                   a
                                                   n
                                                
                                             
                                             =
                                             
                                                λ
                                                
                                                   n
                                                   +
                                                   λ
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                                
                                                   0
                                                
                                                
                                                   c
                                                   o
                                                   v
                                                
                                             
                                             =
                                             
                                                λ
                                                
                                                   n
                                                   +
                                                   λ
                                                
                                             
                                             +
                                             
                                                (
                                                1
                                                −
                                                
                                                   φ
                                                   2
                                                
                                                +
                                                ψ
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                W
                                                
                                                   i
                                                
                                                
                                                   m
                                                   e
                                                   a
                                                   n
                                                
                                             
                                             =
                                             
                                                W
                                                
                                                   i
                                                
                                                
                                                   c
                                                   o
                                                   v
                                                
                                             
                                             =
                                             
                                                1
                                                
                                                   2
                                                   (
                                                   n
                                                   +
                                                   λ
                                                   )
                                                
                                             
                                             ,
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             2
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        where the constant φ which determines the spread of the sigma points, is usually set to a small positive value (e.g. 
                           
                              
                                 10
                                 
                                    −
                                    4
                                 
                              
                              ≤
                              φ
                              ≤
                              1
                           
                        ) with a default value of 
                           
                              
                                 10
                                 
                                    −
                                    3
                                 
                              
                              ,
                           
                         while the parameter ψ is used to incorporate the prior knowledge of the distribution with a default value of 2 [26]. The scaling parameter λ is given by 
                           
                              λ
                              =
                              
                                 
                                    φ
                                 
                                 2
                              
                              
                                 (
                                 n
                                 +
                                 κ
                                 )
                              
                              −
                              n
                           
                         with 
                           
                              κ
                              =
                              3
                              −
                              n
                           
                         
                        [27]. Note that generation of sigma points Xi
                        (0 ≤ i ≤ 2n) require cholesky factorization of the covariance matrix Pt
                         and can be calculated by:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                σ
                                                t
                                             
                                             ←
                                             2
                                             n
                                             
                                             columns
                                             
                                             from
                                             
                                             
                                                ±
                                                c
                                                
                                                   
                                                      
                                                         P
                                                         t
                                                      
                                                      +
                                                      
                                                         Q
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                X
                                                t
                                             
                                             
                                                (
                                                0
                                                )
                                             
                                             =
                                             
                                                x
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                X
                                                t
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             =
                                             
                                                σ
                                                t
                                             
                                             
                                                (
                                                i
                                                )
                                             
                                             +
                                             
                                                x
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where Q
                        
                           t
                         matrix is related to the process noise covariance, the coefficient 
                           
                              c
                              =
                              
                                 
                                    n
                                    +
                                    λ
                                 
                              
                           
                         and 
                           σ
                        
                        
                           t
                         represents 2n eigenvectors generated by Cholesky decomposition of the positive and negative square roots of the covariance matrix [28].

Referring to our problem in the context of information gathering and dissemination, we have proposed a framework in our previous work that consists of Context-Aware Information Processing Unit (CAIPU), Data Fusion Unit (DFU) and Cognitive Gateway [2]. Deployed hierarchically, these units interact with each other to provide necessary information for a service (e.g. congestion detection). In this context, a service with an abstract definition, such as congestion detection, enters first into the framework through CAIPU. Then, after determining different information attributes necessary to define a service (parameters), their values are computed using various sources of information, such as physical sensors in DFU. Among various attributes, one of the very important attributes in VANETs is the location of the vehicles which is often measured using typical GPS sensors. Considering the fact that the required accuracy of location is service-based [6], it is necessary (in critical services such as safe driving) to get more accurate location estimation. We tackle this problem by incorporating data fusion methods along with V2V communication. In the following, we first explain the DFU followed by our new localization approach.

Data Fusion Unit is located in the middle part of our proposed framework in Fig. 1
                        . This unit collaborates with the upper layered CAIPU, which is responsible for context-aware information dissemination after receiving list of the information attributes (parameters) to send out the estimated values. So, DFU interacts with the low-level/physical sensors and the data pool from which it can select the relevant information, fuse them, and find the values for the required attributes by CAIPU. As shown in Fig. 1, the inputs and outputs of DFU are from and to the CAIPU. Input of DFU is the high level information produced by CAIPU that has its attributes determined. Knowing the attributes, a specific data source (general definition of a sensor) or a bundle of data sources is selected from a set of data sources containing sensors on the ego vehicle, sensors on neighboring vehicles (V2V), and information provided by RSUs or infrastructures. Then the selected data is post-processed, and fed into the data fusion unit that employs. such as Extended Kalman Filter (EKF) to fuse the data and estimate a value for the given attributes. Finally, the completed information is sent back to the CAIPU for dissemination.

In this paper, we realize this framework by tackling the localization problem which is an important issue in many VANETs services such as safe driving and congestion detection. For the data source, we use the GPS data of each vehicle and collaborate with other vehicles to find the estimation of the ego vehicle’s location using TOA and AOA radio-ranging techniques. EKF is used to predict the next location of the vehicle using its dynamic motion model, and update this prediction using GPS sensor measurements. The estimation of the ego vehicle location is further improved by taking a weighted average over the estimations of all the neighboring vehicles.

To represent the vehicle motion model, we have used the well-known Ackermann steering model [29,30] coupled with a simple vehicle driving model that uses gas and brake pedal, and the steering wheel sensors to find the wheels angle and vehicle’s velocity. In this model, the current normalized amount of gas and brake are calculated as

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             C
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      α
                                                      C
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                         C
                                                      
                                                   
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                             
                                             
                                             D
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      α
                                                      D
                                                   
                                                   
                                                      (
                                                      t
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         α
                                                         D
                                                      
                                                   
                                                   
                                                      m
                                                      a
                                                      x
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where αC
                         and αD
                         are the current gas and brake pedal angles, respectively, αC
                        
                        
                           max
                         and αD
                        
                        
                           max
                         are their maximums. Considering that the wheel’s radius is Rw
                         and its maximum velocity is Vmax
                        , current velocity of vehicle is attained using the expressions below.

                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             V
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      (
                                                      C
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      −
                                                      D
                                                      
                                                         (
                                                         t
                                                         )
                                                      
                                                      )
                                                   
                                                   ×
                                                   
                                                      V
                                                      
                                                         m
                                                         a
                                                         x
                                                      
                                                   
                                                
                                                
                                                   R
                                                   w
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Therefore, the current input of the system can be defined by a vector 
                           
                              
                                 u
                                 t
                              
                              =
                              
                                 [
                                 C
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                 D
                                 
                                    (
                                    t
                                    )
                                 
                                 
                                 ϕ
                                 
                                    (
                                    t
                                    )
                                 
                                 ]
                              
                              ,
                           
                         where C(t) and D(t) are current gas and brake amount respectively, and ϕ(t) is the current steering wheel angle. Consequently, nonlinear state transition of the vehicle becomes

                           
                              (11)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                t
                                             
                                             =
                                             f
                                             
                                                (
                                                
                                                   u
                                                   t
                                                
                                                ,
                                                
                                                   x
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            V
                                                            (
                                                            t
                                                            )
                                                            cos
                                                            (
                                                            β
                                                            (
                                                            t
                                                            −
                                                            1
                                                            )
                                                            )
                                                            Δ
                                                            t
                                                            +
                                                            x
                                                            (
                                                            t
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            V
                                                            (
                                                            t
                                                            )
                                                            sin
                                                            (
                                                            β
                                                            (
                                                            t
                                                            −
                                                            1
                                                            )
                                                            )
                                                            Δ
                                                            t
                                                            +
                                                            y
                                                            (
                                                            t
                                                            −
                                                            1
                                                            )
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  V
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                               l
                                                            
                                                            tan
                                                            
                                                               (
                                                               ϕ
                                                               
                                                                  (
                                                                  t
                                                                  )
                                                               
                                                               )
                                                            
                                                            Δ
                                                            t
                                                            +
                                                            β
                                                            
                                                               (
                                                               t
                                                               −
                                                               1
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 x
                                 t
                              
                              =
                              
                                 
                                    [
                                    x
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                    y
                                    
                                       (
                                       t
                                       )
                                    
                                    
                                    β
                                    
                                       (
                                       t
                                       )
                                    
                                    ]
                                 
                                 ′
                              
                           
                         is the state of the vehicle at time t, Δt is the discretization size, and β(t) is the vehicle’s yaw (heading) angle with respect to the x-axis. With this dynamic motion model, we can then implement an EKF as follows:

                           
                              (12)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                t
                                             
                                             =
                                             f
                                             
                                                (
                                                
                                                   u
                                                   t
                                                
                                                ,
                                                
                                                   x
                                                   
                                                      t
                                                      −
                                                      1
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                
                                                   ɛ
                                                
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                z
                                                t
                                             
                                             =
                                             h
                                             
                                                (
                                                
                                                   x
                                                   t
                                                
                                                )
                                             
                                             +
                                             
                                                δ
                                                t
                                             
                                          
                                       
                                    
                                 
                              
                           
                        in which ε
                           t
                         and δt
                         are process and measurement Gaussian noises, respectively, and h(x
                        
                           t
                        ) is the sensor model, and its output is the sensor measurement on state x
                        
                           t
                        . Therefore, z
                        
                           t
                         is the sensor measurement that is perturbed with Gaussian noise. Finally, the beliefs of each vehicle about their current state x
                        
                           t
                        , which is their current location, is calculated using Eq. (1). By calculating the corresponding beliefs, the vehicles estimate the location of their one-hop neighbors using TOA and AOA measurements and share this measurements with them. One-hop neighbors of a vehicle, are those neighboring vehicles which are accessible using one of the communication protocols such as DSRC (Dedicated Short Range Communications) [3]. Note that DSRC is a medium range wireless communication system currently developed and designed for automotive applications and the spectrum that can be used, in the range of 5 GHz, is allocated by local government telecommunications authorities. The spectrum is partitioned into a number of 10 MHz channels following the 802.11p specifications. Also, its physical characteristics makes it suitable for the vehicle on road-side applications, securing reliable communications within the reasonable distances. The range and the data rate of this fully distributed standard protocol are 300 m and 10–50 Mb/s, respectively [31]. The detailed discussion about the implementation of the DSRC protocol for the V2V communication can be found in [32].

Let a vehicle and its neighbors set at time t are represented by ith vehicle (vi
                        ) and N
                        
                           t
                        (vi
                        ). Furthermore, the distance and the angle between the two vehicles at time t using TOA and AOA are calculated as

                           
                              (13)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   d
                                                   ^
                                                
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                d
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             +
                                             N
                                             
                                                (
                                                0
                                                ,
                                                
                                                   g
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   γ
                                                   ^
                                                
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                γ
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             +
                                             N
                                             
                                                (
                                                0
                                                ,
                                                
                                                   ω
                                                   2
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              d
                              t
                              
                                 (
                                 i
                                 j
                                 )
                              
                           
                         and 
                           
                              γ
                              t
                              
                                 (
                                 i
                                 j
                                 )
                              
                           
                         are error-free distance and angle between vi
                         and vj
                         at time t, which are then perturbed with Gaussian noise with standard deviation g and ω, respectively. Let 
                           
                              
                                 v
                                 j
                              
                              ∈
                              
                                 N
                                 t
                                 
                                    (
                                    i
                                    )
                                 
                              
                              ,
                           
                         then its estimation about the location of vi
                         is expressed as:

                           
                              (14)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                x
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   d
                                                   ^
                                                
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             cos
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                y
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   d
                                                   ^
                                                
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             sin
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              x
                              t
                              
                                 (
                                 i
                                 j
                                 )
                              
                           
                         and 
                           
                              y
                              t
                              
                                 (
                                 i
                                 j
                                 )
                              
                           
                         are the estimation of vi
                        ’s location in terms of the coordinate frame of vj
                        . Consequently, vi
                         improves its belief (Bel) about its location by calculating a weighted sum over estimated locations by its neighbors.

                           
                              (15)
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                t
                                                
                                                   (
                                                   i
                                                   )
                                                
                                             
                                             =
                                             η
                                             
                                                (
                                                
                                                   x
                                                   t
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                                ×
                                                
                                                   Bel
                                                   t
                                                   
                                                      (
                                                      i
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      j
                                                      ∈
                                                      
                                                         N
                                                         t
                                                         
                                                            (
                                                            i
                                                            )
                                                         
                                                      
                                                   
                                                
                                                
                                                   x
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                
                                                   Bel
                                                   t
                                                   
                                                      (
                                                      j
                                                      )
                                                   
                                                
                                                
                                                   (
                                                   
                                                      x
                                                      t
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              x
                              t
                              
                                 (
                                 i
                                 )
                              
                           
                         is the location of vi
                         at time t, and 
                           
                              
                                 Bel
                                 t
                                 
                                    (
                                    i
                                    )
                                 
                              
                              
                                 (
                                 
                                    x
                                    t
                                    
                                       (
                                       i
                                       )
                                    
                                 
                                 )
                              
                           
                         is its own belief about its location. 
                           
                              x
                              t
                              
                                 (
                                 i
                                 j
                                 )
                              
                           
                         is the estimated location of vi
                         in the coordinate frame of vj
                        , and 
                           
                              
                                 Bel
                                 t
                                 
                                    (
                                    j
                                    )
                                 
                              
                              
                                 (
                                 
                                    x
                                    t
                                    
                                       (
                                       j
                                       )
                                    
                                 
                                 )
                              
                           
                         is vj
                        ’s belief about its own location. Here, η is the normalization factor and is equal to:

                           
                              (16)
                              
                                 
                                    
                                       
                                          
                                             η
                                             =
                                             
                                                1
                                                
                                                   
                                                      Bel
                                                      t
                                                      
                                                         (
                                                         i
                                                         )
                                                      
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         j
                                                         ∈
                                                         
                                                            N
                                                            t
                                                            
                                                               (
                                                               i
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      Bel
                                                      t
                                                      
                                                         (
                                                         j
                                                         )
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        Note that the covariance of 
                           
                              
                                 [
                                 
                                    x
                                    t
                                    
                                       (
                                       i
                                       j
                                       )
                                    
                                 
                                 
                                    y
                                    t
                                    
                                       (
                                       i
                                       j
                                       )
                                    
                                 
                                 ]
                              
                              ′
                           
                         is [33]:

                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            P
                                                            
                                                               x
                                                               x
                                                            
                                                            
                                                               (
                                                               i
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                            
                                                               x
                                                               y
                                                            
                                                            
                                                               (
                                                               i
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            P
                                                            
                                                               y
                                                               x
                                                            
                                                            
                                                               (
                                                               i
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            P
                                                            
                                                               y
                                                               y
                                                            
                                                            
                                                               (
                                                               i
                                                               j
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where

                           
                              (18a)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   x
                                                   x
                                                
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                   ^
                                                
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                cos
                                                2
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ω
                                                2
                                             
                                             
                                                sin
                                                2
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18b)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   y
                                                   y
                                                
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                
                                                   r
                                                   ^
                                                
                                                t
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             
                                                g
                                                2
                                             
                                             
                                                sin
                                                2
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                ω
                                                2
                                             
                                             
                                                cos
                                                2
                                             
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (18c)
                              
                                 
                                    
                                       
                                          
                                             
                                                P
                                                
                                                   x
                                                   y
                                                
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                P
                                                
                                                   y
                                                   x
                                                
                                                
                                                   (
                                                   i
                                                   j
                                                   )
                                                
                                             
                                             =
                                             
                                                (
                                                
                                                   g
                                                   2
                                                
                                                −
                                                
                                                   
                                                      r
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                
                                                   ω
                                                   2
                                                
                                                )
                                             
                                             sin
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                             cos
                                             
                                                (
                                                
                                                   
                                                      γ
                                                      ^
                                                   
                                                   t
                                                   
                                                      (
                                                      i
                                                      j
                                                      )
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 r
                                 ^
                              
                              t
                           
                         denotes 
                           
                              
                                 d
                                 ^
                              
                              
                                 t
                              
                              2
                           
                        .

In Fig. 2
                        , a flowchart is presented to show the steps involved in the proposed method for the improved localization of the ego vehicle. The nomenclatures used in this paper are listed in Table 1
                        .

In the following, the simulation results of our proposed method are presented.

In our simulations, we define two test cases (Test Case 1 and Test Case 2) for which the results of the proposed approach is evaluated with and without V2V communication. In both cases, to show the efficiency of the method, we assume that all vehicles are equipped with erroneous GPS sensors that may provide inaccurate location information due to blockage problem [6]. The GPS accuracies of all 5 vehicles considered here are varied at different time slots as illustrated in Table 2
                     , where each column represents a Time Window (TW) for which the GPS standard deviation is set to a specific value. For example, the standard deviation (STD) of GPS for Vehicle 1 is 17 from time slot 1 to 5, 18.9 from time slot 6 to 13, etc as shown in Fig. 3
                     . In Table 2, although the length of the TW is different for each vehicle, the total number of time windows are the same which is equal to 6. Note that the motion model noise of each vehicle and its initial location are set randomly at the beginning of iteration, where the iteration refers to simulation. Also, in the following simulation analysis, the motion model parameters of C(t), D(t) and ϕ(t) are varied in the same way for all vehicles in the scenario assuming that all gas, brake and wheel angles have the same value for all vehicles time slot by time slot due to simplicity and will be removed in our future work.

Simulation results show how different approaches, namely, GPS, EKF, V2V without UT, and V2V with UT perform, given the test cases and scenarios introduced above. In addition, we have run the same test cases on the VLOCI model proposed in [23] to show the advantage of our proposed method among similar works in the literature. As it is also mentioned in the Section 2, VLOCI assumes that all vehicles are in the same lane, thus, have equal y coordinates on an 
                        
                           x
                           −
                           y
                        
                      coordinate system. To model this framework, we simply remove the error-free angle measurement 
                        
                           γ
                           t
                           
                              (
                              i
                              j
                              )
                           
                        
                      from Eq. (13), and leave it with just the uncertainty about AOA. Therefore, Eq. (13) becomes:

                        
                           (19)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                d
                                                ^
                                             
                                             t
                                             
                                                (
                                                i
                                                j
                                                )
                                             
                                          
                                          =
                                          
                                             d
                                             t
                                             
                                                (
                                                i
                                                j
                                                )
                                             
                                          
                                          +
                                          N
                                          
                                             (
                                             0
                                             ,
                                             
                                                g
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                γ
                                                ^
                                             
                                             t
                                             
                                                (
                                                i
                                                j
                                                )
                                             
                                          
                                          =
                                          N
                                          
                                             (
                                             0
                                             ,
                                             
                                                ω
                                                2
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           N
                           (
                           0
                           ,
                           
                              ω
                              2
                           
                           )
                        
                      is normal distribution with a mean of 0 and standard deviation of ω radians.

Moreover, all vehicles are supposed to have communication links between them and could calculate TOA and AOA accordingly. The neighborhood adjacency matrix at time t, N
                     
                        t
                     , as defined in Eq. (20), is considered to be static,

                        
                           (20)
                           
                              
                                 
                                    
                                       
                                          
                                             N
                                             t
                                          
                                          =
                                          
                                             [
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                   
                                                      0
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                          t
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          T
                                       
                                    
                                 
                              
                           
                        
                     where the rows and columns of N
                     
                        t
                      matrix are indexed from 1 to 5 representing vehicle’s number as 1–5, and T refers to total number of time slots. In practice, the duration of each time slot t can be few seconds before the vehicles can change their speeds and directions, whereas the time to compute TOA, DOA and EKF can be less than a second which results in real-time implications. The configuration of the vehicles at their initial states is displayed in Fig. 4
                     , where x and y-axes are in meters and there are 5 different lanes with lane-width of around 5 m (16 ft). The results of the following test cases are evaluated by comparing them with the ground truth and calculating the corresponding Mean Squared Error (MSE). The traversed path of the ego vehicle for each test case is also displayed.

Here, we consider the vehicles are moving along a straight-line path with equal velocity. As mentioned earlier, we further consider that the GPS sensor of each vehicle provides data with varying accuracies at different time slots due to the blockage (see Fig. 3), and the vehicles can communicate with their neighboring vehicles. For our data fusion method, we have used EKF to estimate the state of each vehicle, and run the simulation for 200 times. Motion model noise of each vehicle and its initial location are set randomly at the beginning of each iteration, and the observation noise is obtained at the specific time slots based on given GPS accuracy. From Figs. 3 and 5
                        , it is obvious that using sensor data fusion and state estimation by EKF, the corresponding belief of each vehicle varies with the GPS accuracy. Fig. 5 shows belief about the location of vehicle 1 with and without UT. After all the above experimental setup, we have used our proposed method based on V2V communication to improve the localization. The corresponding result of the estimated traversed path for the ego vehicle is presented in Fig. 6
                        , which shows the improvement of the location estimation using V2V communication (X and Y are expressed in meter(m) where each X-unit and Y-unit are 15 m and 1 m, respectively). It is noted that we have the same X- and Y-axis representations for Figs. 7
                         and 8
                         as well.


                        Table 3
                         shows the results of mean squared error (MSE) calculated over 200 iterations. For each iteration, the MSE is calculated over a certain period of time tb
                         and te
                        , to eliminate the effect of random setting for initial locations. In our simulation, we set 
                           
                              
                                 t
                                 b
                              
                              =
                              2
                           
                         and 
                           
                              
                                 t
                                 e
                              
                              =
                              T
                              ,
                           
                         where 2 refers the second time slot and T is the last time slot. Based on the results in Table 3, the estimation of traversed path for each vehicle is improved using V2V communication (without and with UT) (in compare to the trivial EKF and GPS sensor only localization). We have also included the results after running an implementation of VLOCI [23] on the same scenario. Noticeably, since VLOCI does not consider lateral displacement between vehicles, its uncertainty about a neighboring vehicle on a direction with a particular angle increases which consequently, leads to very high MSE.

In this test case, the ego vehicle travels in a curved path. The corresponding estimation results using only GPS and using our EKF filter-based fusion technique as used to integrate GPS information with other sensors as well as combining the belief of other neighboring vehicles, are presented. There are two scenarios, i.e. Scenario I and Scenario II, for this set of experiments. In Scenario I, we consider that GPS is continuously turned on. In Scenario II, we consider that GPS fails for a certain period of time (e.g. between time slots 21 to 30 in our simulations) to show the effect of this failure and the result of its improvement using the belief integration of other vehicles. All the experiments are conducted for 200 iterations and the MSE values are calculated by averaging over all runs.


                           Fig. 7 shows the path traveled by vehicle 1 in Scenario I. The path estimated by V2V (shown in red) is consistently much closer to the ground truth (shown in green) as displayed in Fig. 7. This can be further illustrated in terms of calculated Mean Squared Error (MSE). As it can be seen in Table 4
                           , the MSE obtained using V2V communication is much smaller than that of EKF and GPS alone.

In the second set of experiments, GPS data is lost for a certain period of time and the estimation is not accurate for that period (i.e. between the time slots 21 and 30 in our simulation). As shown in Fig. 8, the corresponding path cannot be estimated accurately using only the GPS (shown in light blue); however, the path estimated using V2V and EKF are much closer to the ground truth. In Fig. 8, the EKF results without using V2V communication is also depicted (shown in blue). The MSE of each method calculated for each vehicle is listed in Table 5
                           
                           
                           
                           .

From the experimental results performed for both scenarios in Test Case 2, it can be inferred that the MSE achieved using V2V and EKF is much lower than using the other methods as shown in Tables 4 and 5. Moreover, similar to Test Case 1, VLOCI still performs weakly due to poor direction detection upon receiving a V2V signal. The proposed method thus provides an accurate estimation of the current state over time for the entire path traveled (see Figs. 7 and 8).

We have shown here the performance of the proposed method by varying the number of vehicles, or traffic density. As shown in Table 6, the performance improves with the number of vehicles increases in normal situation when there is no outage of GPS (Test Case 1 and Scenario I) showing the significance of the proposed method. However, as expected the performance drops slightly with increasing number of vehicles (higher traffic) due to temporary GPS blockage in urban scenario (Scenario II) indicating the robustness of the presented method in urban environments. Here, the neighborhood adjacency matrices N
                        
                           t
                         for number of vehicles of 7 and 9, are defined in Eqs. (21) and (22).

                           
                              (21)
                              
                                 
                                    
                                       
                                          
                                             
                                                N
                                                t
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                    
                                       
                                          
                                             
                                                N
                                                t
                                             
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         1
                                                      
                                                      
                                                         0
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                                ]
                                             
                                             
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             T
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Also, the lists of time-varying GPS STD for all 7 vehicles and 9 vehicles are depicted in Tables 7 and 8.

In the above, we have considered uncorrelated Gaussian noise. Here we show how the performance varies with respect to correlated Gaussian noise, which is generated by the measurement noise covariance matrix R defined as

                           
                              (23)
                              
                                 
                                    
                                       
                                          
                                             R
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            σ
                                                            x
                                                         
                                                      
                                                      
                                                         
                                                            ρ
                                                            
                                                               σ
                                                               x
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ρ
                                                            
                                                               σ
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                            y
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ρ is the correlation factor varied as 
                           
                              ρ
                              =
                              0
                              ,
                              .
                              1
                              ,
                              …
                              ,
                              .
                              9
                           
                         and σx, σy
                         are the noise variances along x- and y-coordinates, respectively.

For illustration, Table 9 lists the average localization accuracy (MSE) of vehicle 1 with respect to ρ by using GPS alone as well as EKF and V2V based methods. The illustrative results are presented for Test Case 2 and Scenario I when the number of vehicles is five and UT is considered. As we can see in Table 9, the results achieved by the proposed V2V based method seem less sensitive to the correlated noise due to less variation of the MSE against ρ compared to the results obtained by GPS and EKF.

In Table 10
                        
                        , the results of performances for the above situation with non-Gaussian noise are illustrated based on the following measurement noise covariance [34]:

                           
                              (24)
                              
                                 
                                    
                                       
                                          
                                             R
                                             =
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            R
                                                            11
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                            12
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            R
                                                            21
                                                         
                                                      
                                                      
                                                         
                                                            R
                                                            22
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 R
                                 11
                              
                              =
                              
                                 (
                                 1
                                 /
                                 Ω
                                 )
                              
                              
                                 [
                                 
                                    (
                                    ν
                                    /
                                    ϱ
                                    
                                       (
                                       2
                                       /
                                       ν
                                       ,
                                       2
                                       /
                                       ν
                                       )
                                    
                                    )
                                 
                                 −
                                 1
                                 ]
                              
                              
                                 σ
                                 x
                                 2
                              
                              ,
                              
                                 R
                                 22
                              
                              =
                              
                                 (
                                 1
                                 /
                                 Ω
                                 )
                              
                              
                                 [
                                 
                                    (
                                    ν
                                    /
                                    ϱ
                                    
                                       (
                                       2
                                       /
                                       ν
                                       ,
                                       2
                                       /
                                       ν
                                       )
                                    
                                    )
                                 
                                 −
                                 1
                                 ]
                              
                              
                                 σ
                                 y
                                 2
                              
                              ,
                              
                                 R
                                 12
                              
                              =
                              
                                 (
                                 1
                                 /
                                 Ω
                                 )
                              
                              
                                 [
                                 
                                    (
                                    ν
                                    /
                                    
                                       (
                                       2
                                       ϱ
                                       
                                          (
                                          2
                                          /
                                          ν
                                          ,
                                          2
                                          /
                                          ν
                                          )
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    (
                                    1
                                    +
                                    ρ
                                    )
                                 
                                 −
                                 1
                                 ]
                              
                              
                                 σ
                                 x
                                 2
                              
                              ,
                              
                                 R
                                 21
                              
                              =
                              
                                 (
                                 1
                                 /
                                 Ω
                                 )
                              
                              
                                 [
                                 
                                    (
                                    ν
                                    /
                                    
                                       (
                                       2
                                       ϱ
                                       
                                          (
                                          2
                                          /
                                          ν
                                          ,
                                          2
                                          /
                                          ν
                                          )
                                       
                                       )
                                    
                                    )
                                 
                                 
                                    (
                                    1
                                    +
                                    ρ
                                    )
                                 
                                 −
                                 1
                                 ]
                              
                              
                                 σ
                                 y
                                 2
                              
                           
                         with 
                           
                              Ω
                              =
                              50
                              ,
                           
                        
                        
                           
                              ν
                              =
                              0.1
                              ,
                           
                         and 
                           
                              ϱ
                              (
                              m
                              ,
                              ℓ
                              )
                              =
                              Γ
                              (
                              m
                              )
                              Γ
                              (
                              ℓ
                              )
                              /
                              Γ
                              (
                              m
                              +
                              ℓ
                              )
                           
                         
                        [34]. As we can see in Table 10, the degradation of performance for non-Gaussian noise from that for Gaussian noise, is minimum for the proposed method.

Here, we have shown the improvement of our vehicular localization performance by considering sequential decentralized EKF [35], which improves the location estimation of the ith vehicle based on sequential filtering by its neighboring vehicles. Suppose a vehicle and the set of its neighboring vehicles at time t are represented by vi
                      and N
                     
                        t
                     (vi
                     ) where the neighboring vehicles vj
                      ∈ N
                     
                        t
                     (vi
                     ) and 
                        S
                      is the size of N
                     
                        t
                     (vi
                     ). Let the initial location estimation of the vehicle vi
                      at time t is given by

                        
                           (25)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             i
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                x
                                                ^
                                             
                                             i
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             −
                                             1
                                             )
                                          
                                          +
                                          
                                             K
                                             i
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             [
                                             
                                                z
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             −
                                             
                                                h
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                
                                                   x
                                                   ^
                                                
                                                i
                                             
                                             
                                                (
                                                t
                                                |
                                                t
                                                −
                                                1
                                                )
                                             
                                             ]
                                          
                                       
                                    
                                 
                              
                           
                        
                     where, Kalman gain:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             K
                                             i
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          P
                                          
                                             (
                                             t
                                             |
                                             t
                                             −
                                             1
                                             )
                                          
                                          
                                             h
                                             i
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                [
                                                
                                                   h
                                                   i
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                P
                                                
                                                   (
                                                   t
                                                   |
                                                   t
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   h
                                                   i
                                                   ′
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   R
                                                   i
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and error covariance:

                        
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                             i
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          =
                                          
                                             [
                                             I
                                             −
                                             
                                                K
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                h
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ]
                                          
                                          P
                                          
                                             (
                                             t
                                             |
                                             t
                                             −
                                             1
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     Then the subsequent jth estimates by the corresponding neighboring vehicles vj
                      ∈ Nt
                     (vi
                     ) are as follows.

                        
                           (26)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                x
                                                ^
                                             
                                             j
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          =
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               ^
                                                            
                                                            i
                                                         
                                                         
                                                            (
                                                            t
                                                            |
                                                            t
                                                            )
                                                         
                                                         +
                                                         
                                                            K
                                                            j
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            [
                                                            
                                                               z
                                                               i
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            −
                                                            
                                                               h
                                                               i
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            
                                                               
                                                                  x
                                                                  ^
                                                               
                                                               i
                                                            
                                                            
                                                               (
                                                               t
                                                               |
                                                               t
                                                               )
                                                            
                                                            ]
                                                         
                                                         ,
                                                         j
                                                         =
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                               ^
                                                            
                                                            
                                                               j
                                                               −
                                                               1
                                                            
                                                         
                                                         
                                                            (
                                                            t
                                                            |
                                                            t
                                                            )
                                                         
                                                         +
                                                         
                                                            K
                                                            j
                                                         
                                                         
                                                            (
                                                            t
                                                            )
                                                         
                                                         
                                                            [
                                                            
                                                               z
                                                               i
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            −
                                                            
                                                               h
                                                               j
                                                            
                                                            
                                                               (
                                                               t
                                                               )
                                                            
                                                            
                                                               
                                                                  x
                                                                  ^
                                                               
                                                               
                                                                  j
                                                                  −
                                                                  1
                                                               
                                                            
                                                            
                                                               (
                                                               t
                                                               |
                                                               t
                                                               )
                                                            
                                                            ]
                                                         
                                                         ,
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         j
                                                         ∈
                                                         [
                                                         2
                                                         ,
                                                         S
                                                         ]
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     where

                        
                           
                              
                                 
                                    
                                       
                                          
                                             K
                                             j
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          =
                                          
                                             P
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          
                                             h
                                             j
                                          
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             
                                                [
                                                
                                                   h
                                                   j
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                
                                                   P
                                                   
                                                      j
                                                      −
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   t
                                                   |
                                                   t
                                                   )
                                                
                                                
                                                   h
                                                   j
                                                   ′
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                +
                                                
                                                   R
                                                   j
                                                
                                                
                                                   (
                                                   t
                                                   )
                                                
                                                ]
                                             
                                             
                                                −
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and

                        
                           
                              
                                 
                                    
                                       
                                          
                                             P
                                             j
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          =
                                          
                                             [
                                             I
                                             −
                                             
                                                K
                                                j
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             
                                                h
                                                j
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             ]
                                          
                                          
                                             P
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Finally, the improved location estimate and the error covariance of vehicle vi
                      at time t become:

                        
                           (27)
                           
                              
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                   ^
                                                
                                                ¯
                                             
                                             i
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          =
                                          
                                             
                                                x
                                                ^
                                             
                                             S
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          
                                             
                                                P
                                                ¯
                                             
                                             i
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                          =
                                          
                                             P
                                             S
                                          
                                          
                                             (
                                             t
                                             |
                                             t
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The simulation results for Test Case 2 (Scenario I) with Gaussian measurement noise and the same experimental setup as given in Section 5, are presented in Table 11
                     .

Similarly, the simulation performance for more neighboring vehicles are presented in Table 12
                     . Comparing Tables 11 and 12, it can be found that the larger the number of neighboring vehicles the better the performance of the SEKF scheme.

As we see from the results in Tables 11–13
                     , improved performance has been achieved by SEKF for Gaussian noise (for both uncorrelated and correlated noise cases). It can be mentioned that the results (not shown here) in case of non-Gaussian noise, the SEKF provides much better performance over the EKF, however lower than the V2V based method. Moreover, the performance of the SEKF scheme is evaluated for varying the number of vehicles and shown improved results in all test cases (compare Tables 6 and 14
                     
                     ).

@&#DISCUSSION@&#

In this section, we have discussed the effects of some important issues, such as dynamic adjacency matrix, mobility model, inaccurate nodes, computational complexity.

The effect of dynamic adjacency matrix is illustrated here where the configuration of the adjacency matrix has been changed in each time slot randomly. For example, the simulation results for Test Case 2 (Scenario I) with Gaussian measurement noise and the same experimental setup as given in Section 5 together with dynamic adjacency matrix, are presented in Table 15 which can be compared to Table 4. As we see, the localization accuracy of the ego vehicle is decreased by 29% due to the effects of dynamic adjacency matrix. It is worth to mention that the dynamic adjacency matrix is generated based on intervehicle distance dint
                        . Considering the maximum transmission range of DSRC is 500 m [36], we set a threshold of 
                           
                              
                                 d
                                 
                                    T
                                    h
                                 
                              
                              =
                              500
                              
                              m
                           
                        . The distance dint
                         is generated based on the velocity of the vehicle V varied randomly with uniform distribution in the interval [0–80] km/hr. If dint
                         (i.e. the distance between a vehicle and the ego vehicle), which is calculated as dint
                         = dTh
                        .(V/Vff
                        ) [37] (Vff
                         is the free-flow velocity of the vehicle and set here as 80 km/hr) is less than dTh
                        , we assign the vehicle as a neighboring vehicle and set the corresponding value of the adjacency matrix to be 1; otherwise set as 0.

We have considered the Stationary Random Waypoint Model where the velocity difference ΔVi
                         of the ith vehicle applies the following rule [38]:

                           
                              (28)
                              
                                 
                                    
                                       
                                          
                                             
                                                V
                                                i
                                             
                                             
                                                (
                                                t
                                                +
                                                Δ
                                                t
                                                )
                                             
                                             =
                                             
                                                V
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             +
                                             
                                                
                                                   
                                                      ζ
                                                      a
                                                      Δ
                                                      t
                                                   
                                                   ︸
                                                
                                                
                                                   Δ
                                                   
                                                      V
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where ζ is a random variable uniformly distributed in [0, 1] and a(m/s
                        2) is the acceleration rate and Δt is the time interval.

A simple spacing model is employed to vary the difference distances (i.e. the spacing) of the vehicles, Δx with respect to time Δt which is computed as linear function of the current velocity [38]:

                           
                              (29)
                              
                                 
                                    
                                       
                                          
                                             Δ
                                             
                                                x
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                             =
                                             χ
                                             +
                                             ξ
                                             
                                                V
                                                i
                                             
                                             
                                                (
                                                t
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where χ and ξ are two constants whose values are chosen as 0.1 and 2, respectively [38] and i is the vehicle index. The effects of localization error (MSE) due to the change of the velocity as well as the inter-vehicle spacing are illustrated by Table 16, where it shows that the localization accuracy is decreasing with the increase of the acceleration a (m/sec2).

Here, we have considered the effects of inaccurate nodes to show how the accuracy of the other beliefs impact the performance of the ego vehicle. In Fig. 9
                        , the localization accuracy (MSE) of the ego vehicle is presented with respect to percent(%) of inaccurate nodes (neighbor vehicles). We have shown the results for Case 2 with 8 neighbor vehicles and similar result is obtained for Case 1 (not plotted here) where the inaccurate nodes provide random data error [39]. As we see in Fig. 9, the localization accuracy has dropped by 17% when the neighbor nodes are providing inaccurate information.

The computational requirement of the EKF is dominated by the need to store and update the filtering-error covariance matrix. At each time step t, the computational complexity of the EKF is O(n
                        2), where n (n = 3) represents the size of the state [40]. On the other hand, TOA-ranging calculation is based on MLE (Maximum Likelihood Estimation) algorithm [41], where the linear complexity of the MLE algorithm is O(L) with L represents the size of the signal which varies as the total number of nodes. The order of the complexity for the conventional MUSIC (Multiple Signal Classification) algorithm used for AOA estimation is O(N
                        3) where N is the length of the received signal (which is N = 2) [42].

The computational time (in elapsed CPU seconds) for the proposed scheme including the execution time of EKF, TOA, DOA are obtained using the PC with Pentium B940 Processor (2.0 GHz) and MATLAB implementation, which are listed as follows: EKF(0.138 s), TOA (0.029 s), AOA (0.020 s). Moreover, the time to change the speed and the direction of a vehicle is compatible with the EKF computation (<1 s). Moreover, the computational costs (i.e. CPU time) are 1.310 s, 1.388 s, 1.513 s when the number of vehicles are 5, 7, and 9, respectively. The computational time of the proposed approach in highway scenario (e.g. Test Case 1) is 1.185 s, where urban scenario (e.g. Test Case 2), it is 1.388 s. Also, the computational time of the proposed method due to UT can be increased by 1%.

@&#CONCLUSION@&#

In this paper, a new cooperative approach dealing with the localization problem in VANETs is proposed. In our approach, we combined data fusion and radio-ranging distance measurement techniques along with V2V communication in order to improve the location information of the vehicles. We further extend our ideas of cooperative approach by considering sequential EKF filtering within the neighboring vehicles to further improve the performance. We evaluated the methods by comparing vehicle’s estimated locations with their ground truth, and demonstrated that using V2V communication for measuring the distance and sharing belief about the estimation of the current location, the neighboring vehicles can cooperatively improve the knowledge of the current location. Moreover, we have tested the robustness of the methods by taking out the GPS sensor for a period of time to show how the ego vehicle can maintain its belief about its current location by communicating with other vehicles. The performances of the methods are also evaluated by using different types of noise as well as varying the number of vehicles. Comparing to another cooperative method of localization based on distance measurements for improving the GPS information, such as reported in [23], the proposed method eliminates the restriction of all vehicles having GPS, and employs data fusion techniques such as EKF to estimate the location of the vehicles by predicting it using predefined dynamic motion model, and refining it using GPS sensor and the information received from other vehicles.

@&#ACKNOWLEDGMENT@&#

This work has been supported by the NSERC Canada under DIVA project. The authors also gratefully acknowledge the valuable comments and suggestions by the Reviewers and the Editors that helped to improve the paper significantly.

@&#REFERENCES@&#

