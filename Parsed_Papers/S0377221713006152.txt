@&#MAIN-TITLE@&#An inventory–routing problem with the objective of travel time minimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We consider an inventory and routing problem to minimize maximum route travel time.


                        
                        
                           
                           We present tabu search algorithm with efficient improvement method in each iteration.


                        
                        
                           
                           Lagragian relaxation algorithm is proposed to obtain the lower bounds.


                        
                        
                           
                           It shows that results of tabu search are very close to the lower bounds.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Logistics

Distribution

Inventory routing

Tabu search

Lagrangian relaxation

@&#ABSTRACT@&#


               
               
                  In this paper, we consider an inventory–routing problem (IRP) in a large petroleum and petrochemical enterprise group. Compared to many other IRPs, the problem in this paper includes some special aspects due to the operational constraints, such as hours-of-service regulations of the company and the industry. Also, in some cases, it is more important to avoid stock out for any station, rather than purely focusing on transportation cost minimization. The objective is to minimize the maximum of the route travel time, which is not addressed in the literature so far. We present a tabu search algorithm to tackle the problem, which builds in an efficient and effective procedure to improve the search quality in each iteration. Moreover, lower bounds of reasonable sized problems, which are intractable in the formulated mathematical model by existing optimization software, are obtained via Lagrangian relaxation technique. Computational results indicate that the lower bounds are tight and the tabu search is capable of providing near optimal, close-to-lower-bound solutions in a computational time effective manner.
               
            

@&#INTRODUCTION@&#

This paper studies a problem which is observed in a large petroleum and petrochemical enterprise group in China. The company relies on the product of gasoline for the majority of its sales and owns almost 40,000 gas stations spread all over China. Hundreds of oil depots are also maintained to replenish gasoline to the gas stations. Considering the number of depots and gas stations involved, the daily operations of gasoline distribution within this network is particularly complex. Generally, the problem can be formulated as an inventory–routing problem (IRP) with the following features:
                        
                           1.
                           The distribution of gasoline to gas stations is operated independently by each province. Therefore, the overall network is divided into sub-networks. For each province, there might be dozens of oil depots and thousands of gas stations. The network within each province is further divided into different districts according to the current company policy. Normally, each district has several oil depots and hundreds of gas stations. This is the basic operating unit for gasoline distribution within the company.

For each operating unit, the depots are regularly replenished to maintain a proper level of inventory to avoid stock outs. A central scheduling office determines the time and the amount to be delivered to each gas station, which has limited storage capacity with the daily demand represented by a consumption rate.

The product is distributed by a fleet of tank trucks, which belongs to a third party logistics (3PL) service provider. The 3PL previously belonged to the enterprise but now operates as an independent company to serve the function of transportation department of the enterprise.

When a truck arrives at a gas station, the gasoline is delivered at a delivery rate, i.e., the delivery cannot be instantaneous. An order up to level policy is applied to each gas station for inventory replenishment. Therefore, the maximum inventory level will be reached once the gas station is visited by a truck.

In order to improve the utilization of transportation resources, a minimum delivery quantity (Campbell & Savelsbergh, 2004a) is specified for each station. The inventory level in the gas station declines as the time elapses. Thus, this minimum delivery quantity specifies the earliest time that the station should be visited. Moreover, the central scheduling office should guarantee that each gas station will not run out of stock, which specifies the latest time that the station should be visited. These two constraints naturally pose a delivery time window for each gas station.

Each day, a fleet of vehicles depart from the oil depot and visit the gas stations following the routes designated by the central scheduling office. At the end of the day, the fleet returns to the depot or a specified parking area. For IRPs, one objective is to minimize the total transportation cost, which has received much attention in the literature (Andersson, Hoff, Christiansen, Hasle, & Løkketangen, 2010). However, the consideration of time is also very important in this problem.

In this paper, we address the IRPs from the perspective of travel time minimization. The objective is to minimize the maximum route travel time among all vehicles due to two reasons. Firstly, each vehicle should deliver products to each gas station earlier than the latest allowable visiting time. If a gas station runs out of stock, it might not only be viewed as a business problem, but also a social problem by the local community. Therefore, it can be argued that in some cases, it is more important to avoid stocking outs, rather than purely focusing on transportation cost minimization. The similar priority rule is also applicable to the distribution of some scarce resource such as blood, and critical resources stored for use in emergencies. The delivery of these resources has a strong focus on speed of delivery. Secondly, in the petrol delivery network, all vehicles should return to the depot within the work shift so that the total driving hours are maintained at a safe level and workers’ preference on getting off duty on time are catered for. Furthermore, the maximum amount of accumulated driving time is limited by the regulations of the company. Similar regulations can be observed in the US, Europe and many other countries (Goel, 2009, 2010; Goel & Kok, 2012). Hence, the hours-of-service of each vehicle should be leveraged so that each driver has similar working hours, while the hours-of-service regulation is complied with at the same time. Although there is a large body of research addressing IRPs with objective of transportation cost minimization (Coelho, Cordeau, & Laporte, 2012a; Ng, Leung, Lam, & Pan, 2008), there is almost no work considering time in the objective function.

The IRPs are difficult to solve (Campbell & Savelsbergh, 2004a). According to the published work, it is not easy to develop an exact algorithm for solving IRP with reasonable sizes (Archetti, Bertazzi, Laporte, & Speranza, 2007; Engineer, Furman, Nemhauser, Savelsbergh, & Song, 2012). In practice, the tank of the gas station in urban area is relatively small due to limited space within the city and safety requirements. Thus, the delivery quantity for the gas station in the urban area is relatively small compared to vehicle capacity. As a first step, we concentrate on a simplified version of the problem, assuming that the vehicle capacity is un-constrained, which is similar to the uncapacitated assumption in Valle, Martinez, da Cunha, and Mateus (2011). However, we are well aware that in practice, more often than not, vehicles have limited capacity. We believe that our contribution will serve as a basis for solving more realistic cases.

The remainder of this paper is organized as follows. We review the related literature in Section 2. The problem definition and the mathematical model are presented in Section 3 and a tabu search algorithm is proposed in Section 4. Section 5 employs the Lagrangian relaxation technique to obtain the lower bound for the problem. Section 6 presents computational results of the tabu search algorithm and the lower bounds, followed by the concluding Section 7.

@&#LITERATURE REVIEW@&#

The IRPs are observed in various industries and have received the attention of the academic communities since 1980, such as supermarket chains (Gaur & Fisher, 2004), industrial gas industry (Bell et al., 1983; Campbell & Savelsbergh, 2004a, 2004b), vending machine chain (Huang & Lin, 2010), automobile industries (Alegre, Laguna, & Pacheco, 2007; Blumenfeld, Burns, Daganzo, Frick, & Hall, 1987; Ohlmann, Fry, & Thomas, 2008), meat industry (Oppen, Løkketangen, & Desrosiers, 2010), oil refineries (Persson & Göthe-Lundgren, 2005), frozen food distribution companies (Custódio & Oliveira, 2006), blood distribution (Hemmelmayr, Doerner, Hartl, & Savelsbergh, 2009) and maritime transportation industry (Al-Khayyal & Hwang, 2007; Dauzère-Pérès et al., 2007). Recently, Andersson et al. (2010) reviewed related literature published until 2008, where more than 100 papers or book chapters are classified accordingly to three types of planning horizon: instant time horizon, finite time horizon, and infinite planning horizon. IRPs are solved exactly by Archetti et al. (2007), Solyali and Süral (2011), Ceolho and Laporte (2012), Adulyasak, Cordeau, and Jans (2012), etc. Also, efficient heuristic algorithms are proposed by Bertazzi, Paletta, and Speranza (2002), Zhao, Wang, and Lai (2007), Campbell and Savelsbergh (2004), Archetti, Bertazzi, Paletta, and Speranza (2011), Coelho, Cordeau, and Laporte (2012b, 2012c), Michel and Vanderbeck (2012), Archetti, Bertazzi, Hertz, and Speranza (2012), etc. In this paper, we only review the work published after 2008, which is not covered by the survey of Andersson et al. (2010).

Considering the infinite planning horizon, Bertazzi (2008) determines shipping policies that minimize the sum of transportation cost and inventory cost at both the supplier and the retailers. The bounds of direct shipping over shipping with routing are developed subject to given conditions. Archibald, Black, and Glazebrook (2009) also considers direct deliveries. In the work of Li, Chen, and Chu (2010), the effectiveness of the direct shipping strategy is evaluated. Raa and Aghezzaf (2008, 2009) assume that the demand rate is constant.

The IRPs with finite planning periods are addressed by Bard and Nananukul (2009a, 2009b), Kang and Kim (2010), Toriello, Nemhauser, and Savelsbergh (2011), Solyali and Süral (2011), etc., where both exact and heuristic algorithms are presented.

There is a set of work which considers different network structures in the IRPs as well. For example, Ohlmann et al. (2008) address the inbound vehicle routing problem, with the constraints that limit the amount of inventory in the logistical network and present a two phase solution procedure. Moin, Salhi, and Aziz (2011) address the multi-product IRP in a many-to-one distribution network with finite planning periods. Zhao, Chen, and Zang (2008) and Li, Chu, and Chen (2011a) address an integrated IRP in a three-echelon logistics system, which consists of a supplier, a central warehouse and a group of retailers.

Variations of IRPs can be found in the literature by considering different constraints or assumptions. Abdelmaguid, Dessouky, and Ordóñez (2009) investigate the IRP with backlogging. Stochastic IRPs are considered by Chen and Lin (2009), Hvattum, Løkketangen, and Laporte (2009) and Hvattum and Løkketangen (2009). Grønhaug and Christiansen (2010) address a maritime IRP in the liquefied natural gas business. Huang and Lin (2010) study the multi-item IRPs with demand uncertainty. Benoist, Gardi, and Jeanjean (2011) present a randomized local search method for real-life IRP, which takes into account pickups, time windows, drivers’ safety regulations, and orders. Li, Chu, and Chen (2011b) consider the IRPs with split deliveries while Liu and Lee (2011) address the IRP with time windows.

Recently, there emerged a set of work, which focuses on the petrol delivery problems. Various formulations and solution methodologies are proposed. Avella, Boccia, and Sforza (2004) study the case of a company that delivers different types of fuel to a set of fuel pumps. The objective is to minimize total travel cost. A branch-and-price algorithm is proposed. Cornillier, Boctor, Laporte, and Renaud (2008) investigate a multi-period petrol station replenishment problem with the objective to maximize the total profit which equals to the revenue minus the sum of routing costs and of regular and overtime costs. Heuristic algorithm is proposed. Ng et al. (2008) present a case study on a single period tanker assignment and routing problem for petrol products in Hong Kong and develop a decision support system. Multiple objectives are considered simultaneously such that the number of tankers used and the number of drops in trips are minimized, profit in terms of total products delivered and utilization of resources are maximized. Muyldermans and Pang (2010) formulate the petrol delivery problem as the Multi-Compartment Vehicle Routing Problem with the objective of travel distance minimization and provide a local search procedure for this problem. Derigs et al. (2011) also formulate the petrol distribution problem as VRP with compartments. A heuristic algorithm is proposed, which combines local search and meta-heuristics. Cornillier, Boctor, and Renaud (2012) consider the multi-depot petrol station replenishment problem with time windows. Stations specify their demand by indicating the minimum and maximum quantities to be delivered for each ordered product and require the delivery within a predetermined time window. A heuristic algorithm is proposed to maximize the overall daily net revenue. Popović, Vidović, and Radivojević (2012) and Vidović, Popović, and Ratković (2013) investigate the multi-product multi-period IRP in fuel delivery with multi-compartment homogeneous vehicles, and deterministic consumption that varies with each petrol station. Variable neighborhood search algorithm and heuristic algorithms are presented.

According to the classification of the published work in Andersson et al. (2010), our problem focuses on the instant time horizon with deterministic demand. Routing of the fleet with homogeneous vehicles should be determined. Also, our problem is a variation of IRPs by considering a different objective function while most researchers take cost minimization as the objective. However, in some real cases, while cost is still important, time has higher priority in the network of IRPs. Thus, our work attempts to take travel time minimization as the objective function.

We consider a logistic network in which the product of gasoline is distributed from the oil depot to a set of gas stations each day using a fleet of homogenous vehicles. For each gas station, an initial inventory level is given and the maximum inventory level is determined by its tank capacity. The problem is formulated based on the following assumptions:
                        
                           •
                           The oil depot is assumed to have infinite inventory.

Each gas station has a product consumption rate.

The order up to level policy is applied for each visit. That is, if a station is visited at time t, then the delivered product quantity is such that the inventory level will be brought to its maximum value (tank capacity).

The vehicle’s delivery rate is the amount of product that can be delivered per hour. It is obvious that the delivery rate should be greater than the consumption rate for any gas station.

A station should only be visited if it meets the minimum delivery quantity requirement. This improves the utilization of delivery vehicles and creates better insurance against running out of product (Campbell & Savelsbergh, 2004a). This constrains the earliest time that a station should be visited. On the other hand, stock out is not allowed for each station, which specifies the latest time that a station should be visited. Thus, each station has a specific delivery time window.

As mentioned in Section 1, higher priority is assigned to route travel time. Therefore, this IRP is investigated with the objective of minimizing the maximum of vehicle travel time within the network. The decision is to determine the route for each vehicle such that each gas station is visited once within its delivery time windows. For each route, it is interesting that the visiting sequence of gas stations not only affects the vehicle travel time of this route, but also determines the delivery time and delivery quantity for the visited gas stations.

Before presenting the mathematical model, the following set of indices and parameters are defined.
                        
                           
                              
                              
                              
                                 
                                    
                                       i
                                    
                                    index of the gas station, which belongs to the gas station set N
                                       ={1,2,…,
                                       n}
                                 
                                 
                                    
                                       k
                                    
                                    index of vehicles, which belongs to the vehicle set V
                                       ={1,2,…,
                                       K}
                                 
                                 
                                    
                                       o
                                    
                                    the depot
                                 
                                 
                                    
                                       Ii
                                       
                                    
                                    the initial inventory level of gas station i
                                    
                                 
                                 
                                    
                                       Ci
                                       
                                    
                                    The tank capacity at gas station i
                                    
                                 
                                 
                                    
                                       ui
                                       
                                    
                                    The product consumption rate in gas station i
                                    
                                 
                                 
                                    
                                       R
                                    
                                    the vehicle’s delivery rate
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   min
                                                
                                             
                                          
                                       
                                    
                                    the minimum delivery quantity when station i is visited
                                 
                                 
                                    
                                       
                                          
                                             [
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                                
                                                   a
                                                
                                             
                                             ,
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                                
                                                   b
                                                
                                             
                                             ]
                                          
                                       
                                    
                                    the delivery time windows of station i, where 
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                                
                                                   a
                                                
                                             
                                             =
                                             Max
                                             (
                                             0
                                             ,
                                             (
                                             
                                                
                                                   q
                                                
                                                
                                                   i
                                                
                                                
                                                   min
                                                
                                             
                                             -
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   I
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             )
                                             /
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                        and 
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   i
                                                
                                                
                                                   b
                                                
                                             
                                             =
                                             
                                                
                                                   I
                                                
                                                
                                                   i
                                                
                                             
                                             /
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       TIij
                                       
                                    
                                    the travel time between station i and station j
                                    
                                 
                              
                           
                        
                     
                  

The variables that need to be determined are as follows:
                        
                           
                              
                              
                              
                                 
                                    
                                       xijk
                                       
                                    
                                    equals to 1 if vehicle k visits arc (i, j), 0 otherwise
                                 
                                 
                                    
                                       dik
                                       
                                    
                                    the delivery quantity to station i by vehicle k
                                    
                                 
                                 
                                    
                                       tik
                                       
                                    
                                    the delivery start time of vehicle k at station i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   ik
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    the departure time of vehicle k from station i
                                    
                                 
                                 
                                    
                                       t
                                       0
                                       
                                          k
                                       
                                    
                                    the time the vehicle k reaches the depot at the end of the route
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   t
                                                
                                                
                                                   0
                                                   k
                                                
                                                
                                                   d
                                                
                                             
                                          
                                       
                                    
                                    the time the vehicle k departs from the depot at the beginning of the route
                                 
                              
                           
                        
                     
                  

The mathematical model is presented below:
                        
                           (1)
                           
                              
                                 min
                              
                              
                              (
                              
                                 
                                    
                                       max
                                    
                                    
                                       k
                                    
                                 
                              
                              
                              
                                 
                                    t
                                 
                                 
                                    0
                                    k
                                 
                              
                              )
                           
                        
                     
                     
                        
                           (2)
                           
                              s.t.
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       k
                                       =
                                       1
                                    
                                    
                                       K
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                       ,
                                       j
                                       ≠
                                       i
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ijk
                                 
                              
                              =
                              1
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        
                     
                     
                        
                           (3)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    0
                                    jk
                                 
                              
                              =
                              1
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (4)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                    0
                                    k
                                 
                              
                              =
                              1
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (5)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ihk
                                 
                              
                              -
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    hjk
                                 
                              
                              =
                              0
                              ,
                              
                              h
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (6)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                             
                                                t
                                             
                                             
                                                jk
                                             
                                          
                                          ⩾
                                          
                                             
                                                t
                                             
                                             
                                                ik
                                             
                                             
                                                d
                                             
                                          
                                          +
                                          
                                             
                                                TI
                                             
                                             
                                                ij
                                             
                                          
                                          -
                                          M
                                          (
                                          1
                                          -
                                          
                                             
                                                x
                                             
                                             
                                                ijk
                                             
                                          
                                          )
                                          ,
                                          
                                          i
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          …
                                          ,
                                          n
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                          j
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          
                                          k
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          K
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7)
                           
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ijk
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                                 
                                    a
                                 
                              
                              ⩽
                              
                                 
                                    t
                                 
                                 
                                    jk
                                 
                              
                              ⩽
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    ijk
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                                 
                                    b
                                 
                              
                              ,
                              
                              j
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (8)
                           
                              
                              
                                 
                                    d
                                 
                                 
                                    ik
                                 
                              
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    jik
                                 
                              
                              (
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    I
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    t
                                 
                                 
                                    ik
                                 
                              
                              )
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (9)
                           
                              
                              
                                 
                                    t
                                 
                                 
                                    0
                                    k
                                 
                                 
                                    d
                                 
                              
                              =
                              0
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (10)
                           
                              
                              
                                 
                                    t
                                 
                                 
                                    ik
                                 
                                 
                                    d
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    ik
                                 
                              
                              +
                              
                                 
                                    d
                                 
                                 
                                    ik
                                 
                              
                              /
                              R
                              ,
                              
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                     
                        
                           (11)
                           
                              
                              
                                 
                                    t
                                 
                                 
                                    ik
                                 
                              
                              ⩾
                              0
                              ,
                              
                                 
                                    t
                                 
                                 
                                    ik
                                 
                                 
                                    d
                                 
                              
                              ⩾
                              0
                              ,
                              
                              i
                              =
                              0
                              ,
                              1
                              ,
                              2
                              …
                              ,
                              n
                              ,
                              
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              K
                           
                        
                     
                  

The objective is to minimize the maximum route travel time among all the vehicles. Constraints (2) ensure that each gas station is visited only once. Constraints (3)–(5) characterize the flow on the path to be followed by each vehicle. Constraints (6), which contain a large number M, eliminate subtours in each route. Constraints (7) specify the time window constraint for each gas station. Constraints (8) determine delivery quantity for each gas station, when it is visited by vehicle k. Constraints (9) and (10) determine the time that vehicle k leaves the depot and the stations.

If we assume that there is only one vehicle in this problem, the problem is obviously more complex than a Traveling Salesman Problem (TSP). Therefore, this problem is a NP-Hard problem. Due to the high complexity of the problem, exact methods become inapplicable for solving large scale instances that often arise in practice. Attention can be paid to meta-heuristic methods that are able to produce near optimal solutions for such problems within reasonable computing time. Tabu search is a local search meta-heuristic proposed independently by Glover (1986) and Hansen and Jaumard (1990). According to recent literature, tabu search is widely applied for solving vehicle routing problems (Archetti, Speranza, & Hertz, 2006; Cordeau, Gendreau, & Laporte, 1997; Zachariadis, Tarantilis, & Kiranoudis, 2009). It is proved to be an effective meta-heuristic method for large scale VRP problems. Thus, as a first attempt for solving the problem in this paper, a tabu search algorithm is proposed.

To construct an initial feasible solution, we first sequence the gas stations in non-decreasing order of 
                           
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                                 
                                    b
                                 
                              
                           
                        . Gas stations are subsequently inserted into the vehicle routes in a greedy manner. The obtained initial solution consists of several (vehicle) routes. Each route can be treated as the route of a TSP and therefore can be improved by a method adapted from the Unstring and String (US) algorithm proposed by Gendreau, Hertz, and Laporte (1992). The steps of constructing the initial solution are presented below.
                           
                              
                                 Step 1: sequence the gas stations in non-decreasing order of 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                          
                                             b
                                          
                                       
                                    
                                 . In case there is a tie of value 
                                    
                                       
                                          
                                             t
                                          
                                          
                                             i
                                          
                                          
                                             b
                                          
                                       
                                    
                                 , stations are sequenced in non-increasing order of available empty capacity, i.e., Ci
                                 
                                 −
                                 Ii
                                 .


                                 Step 2: take the first station in the sequence as current station, append the station to the route that the travel time of the route with current station appended is minimized.


                                 Step 3: repeat Step 2 until all stations are inserted into vehicle routes.


                        Gendreau et al. (1992) propose the US algorithm to improve the solution for the TSP. The algorithm first deletes selected nodes from the route and then re-inserts these nodes into the route by some pre-designed rules. The work shows that this algorithm is a very efficient method for the TSP. This procedure is widely employed in tabu search algorithm to improve the neighborhood solutions (Archetti et al., 2006; Cordeau et al., 1997, etc.). We modify the standard US algorithm in Gendreau et al. (1992) to improve the solutions of the tabu search algorithm in this paper according to the problem features. In the adapted US algorithm, the search is more extensive in some steps but less in other steps. The detailed differences are listed below:
                           
                              1.
                              For each route, there are time window constraints for customers and maximum operation hour constraint for each vehicle. Thus, there might be fewer customers in each route, compared to standard VRP for the similar sized problems. Hence, only type 1 unstring step and type 1 string step in Gendreau et al. (1992) are employed in the adapted algorithm.

In the standard US algorithm, the two adjacent nodes of the insertion point are selected from the p-neighborhood of the insertion point. Here we simplify it by selecting the two nearest nodes within the p-neighborhood of the insertion point as the two adjacent nodes.

For a given route in the solution of the tabu search, we enumerate all the possible sequences and select the best one if the number of nodes does not exceed 7 in the route considering the computational power advancement in the past two decades.

From preliminary experiments, we set p
                        =3 in the adapted US algorithm. In Gendreau et al. (1992), the complexity of the original procedure is o(np
                        4
                        +
                        n
                        2). As mentioned by the above item 2, the selection of the insertion point is simplified. Thus, the complexity of the corresponding step is decreased from o(p
                        4) to o(p
                        3). Therefore, the complexity of the adapted US algorithm is o(np
                        3
                        +
                        n
                        2).

The tabu search algorithm starts from the initial feasible solution and improves the solution quality by generating a set of neighbors in the hope that better solutions will be found. A tabu list is maintained during the search to prevent the search from getting stuck at local optimal solutions.

A neighbor can be generated by swapping pieces of any two routes in the current solution. For any two routes, once a cutting point is specified in each route, the two pieces from the cutting point to the end of each route can be exchanged to generate one neighbor solution.

Another way to generate neighbor solutions is to move one node in the longest route and insert it into the remaining routes with less travel time. This neighbor generation operation reflects the objective of min–max the route time.

As mentioned earlier, each neighbor consists of several routes. These routes can be improved by the adapted US algorithm. Prins (2004) shows that for searching algorithm, better results can be obtained if each randomly generated neighbor can be improved to be optimal. Though it is generally not possible to obtain the optimal solution for each generated neighbor due to computational time constraint, it is still desirable to apply the adapted US algorithm to obtain better TSP tours within allocated time.

We define each item in the tabu list by two parts. The first part is the two routes, from which the two neighbors can be generated. The second part is the cutting points in the two routes. When generating a neighbor by switching the two pieces, if the selected two routes and the cutting point are identical to an item in the tabu list, no neighbor will be generated. On the other hand, when generating a neighbor by inserting a node from a route to another route, if the selected two routes and the cutting point, which is on the left side of the selected node, are identical to an item in the tabu list, this move is forbidden. According to preliminary experiments, the tabu list length is set to 
                              
                                 
                                    
                                       n
                                    
                                 
                              
                           , where n is the number of nodes in the network.

Before presenting the detailed steps, we first define the notations. Let s
                           ∗ denotes the initial solution. CS and BS indicate the current solution and the best solution, respectively. It is obvious that a solution consists of several routes. The route with longest travel time is denoted by Ω. Y denotes the index of the remaining routes in current solution. Let X denotes the position index in Ω, the counter “Non_I” to record the number of times the solution has not been improved and Div_Num to denote the number of times that diversification is executed. The detailed steps are illustrated in Algorithm 1.
                              
                                 
                              
                           
                        

In order to validate the performance of the tabu search algorithm, lower bounds of the problem are developed via Lagrangian relaxation technique. By relaxing some constraints, the original complex problem can be converted to a tractable one which then can yield a lower bound of the optimal solution to the original problem. The foundations of the Lagrangian relaxation technique and related applications can be referred to Fisher (1981, 1985) and Geoffrion (1974). Recent successful applications can be found, for example, in Kallehauge, Larsen, and Madsen (2006), Imai, Nishimura, and Current (2007), etc.

We select Constraints (2) in the original model to be relaxed with Lagrangian multipliers αi
                     . Thus, the model can be presented as:
                        
                           (12)
                           
                              LR
                              =
                              min
                              
                                 
                                    
                                       (
                                       
                                          
                                             
                                                max
                                             
                                             
                                                k
                                             
                                          
                                       
                                       
                                       
                                          
                                             t
                                          
                                          
                                             0
                                             k
                                          
                                       
                                       )
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      
                                                         K
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         0
                                                         ,
                                                         j
                                                         ≠
                                                         i
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ijk
                                                   
                                                
                                                -
                                                1
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Subject to Constraints (3)–(11).

The purpose of the Lagrangian relaxation technique is to create a problem that can be decomposed into a number of subproblems with known usable structures (Guignard & Kim, 1987; Jörnsten, Näsberg, & Smeds, 1985). Normally, the resulting model decomposes the original problem into one subproblem for each vehicle (Kohl & Madsen, 1997). However, the min–max format in objective function indicates that the relaxed model cannot be easily decomposed at the first glance. Fortunately, the following property of the relaxed model implies that the relaxed model can be decomposed.
                           Property 1
                           For the optimal solution of the relaxed problem, each vehicle’s route can be identical.

We assume that the routes are not identical in the optimal solution of the relaxed problem. The routes can be denoted by 
                                 
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                k
                                             
                                          
                                       
                                    
                                    )
                                    ,
                                    …
                                    ,
                                    (
                                    
                                       
                                          i
                                       
                                       
                                          K
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          K
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          K
                                       
                                       
                                          
                                             
                                                l
                                             
                                             
                                                K
                                             
                                          
                                       
                                    
                                    )
                                 
                              . 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          k
                                       
                                       
                                          l
                                       
                                    
                                 
                               indicates the lth gas station in vehicle k’s route, where (k
                              =1,2,…,
                              K, l
                              =1,2,…,
                              lk
                              ). lk
                               indicates the number of gas station in vehicle k’s route. Assume that vehicle k
                              ∗ has the maximum travel time among the routes of the optimal solution. Thus, 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          max
                                       
                                       
                                          k
                                       
                                    
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          k
                                       
                                    
                                    }
                                 
                              . In (12), the term 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          α
                                       
                                       
                                          i
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                          ,
                                          j
                                          ≠
                                          i
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          ijk
                                       
                                    
                                 
                               denotes the sum of αi
                               on vehicle k’s route. Thus, the objective function can be written as:
                                 
                                    (13)
                                    
                                       LR
                                       =
                                       
                                          
                                             t
                                          
                                          
                                             0
                                             
                                                
                                                   k
                                                
                                                
                                                   ∗
                                                
                                             
                                          
                                       
                                       +
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                k
                                                =
                                                1
                                             
                                             
                                                K
                                             
                                          
                                       
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                l
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   k
                                                
                                                
                                                   l
                                                
                                             
                                          
                                       
                                       -
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                n
                                             
                                          
                                       
                                       
                                          
                                             α
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           

Let sk
                               denotes part of the second term, i.e., 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          α
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                k
                                             
                                             
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              . The second term can be written as 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          =
                                          1
                                       
                                       
                                          K
                                       
                                    
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                              . For the route of any vehicle p (p
                              ≠
                              k
                              ∗) in the solution, we have 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    ⩾
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          p
                                       
                                    
                                 
                              . If there is only one route has the value of 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              , we prove that each vehicle’s route can be identical.

(1) 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                 
                              : If vehicle p abandons its route and takes the route that is identical to k
                              ∗, we have 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              . Thus, the value is not changed for the first term in (13), while the value of the second term is decreased. Therefore, we obtain a better solution by change vehicle p’s route. It is straightforward that we can replace the route of any vehicle k with 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          k
                                       
                                    
                                 
                               to improve the solution.

(2) 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                 
                              : This condition indicates that the sum of the multipliers for each route is identical. Probably, the set of gas stations is identical for the two routes. The only difference is the visiting sequence of gas stations. Let 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          p
                                       
                                    
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          p
                                       
                                    
                                    }
                                 
                               for all routes p with 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                               Replacing the routes of all vehicle p and vehicle k
                              ∗ by the route of vehicle p
                              ∗, the solution of (12) can be improved.

(3) 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    >
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                 
                              : In this case, it is obvious that a better solution will be obtained by replacing the route of vehicle k
                              ∗ by the best of the remaining routes. Similar to condition (2), let 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          
                                             
                                                p
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          p
                                       
                                    
                                    {
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          p
                                       
                                    
                                    }
                                 
                               for all routes p with 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          p
                                       
                                    
                                    <
                                    
                                       
                                          s
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                               Then, replace the routes of all vehicle p and vehicle k
                              ∗ by the route of vehicle p
                              ∗, the solution of (12) can be improved.

Therefore, if there is only one route has the value of 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              , each vehicle’s route should be identical in the optimal solution of the relaxed problem. On the other hand, if there is more than one route have the value of 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              , such as 
                                 
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          k
                                          
                                             
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          k
                                          
                                             
                                                2
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          0
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                               we prove that these routes k1∗ and k2∗ can be converted to only one route.

(4) 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          
                                             
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    ≠
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          
                                             
                                                2
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              : Similar to case (1), the route with larger value of s will be replaced with the other route with a smaller value of s. Therefore, we obtain a better solution by reducing the value of the second term in (13).

(5) 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          
                                             
                                                1
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          k
                                          
                                             
                                                2
                                             
                                             
                                                ∗
                                             
                                          
                                       
                                    
                                 
                              : Since the route travel time and the sum of the multipliers of the two routes are identical, any route can be replaced by the other route without changing the value of (13).

Thus, for the optimal solution of the relaxed problem, each vehicle’s route can be identical.□

According to Property 1, the route of each vehicle should have identical travel time. Let tn
                        
                        +1 represents all t
                        0
                        
                           k
                        . Thus, (12) can be re-written as:
                           
                              (14)
                              
                                 LR
                                 =
                                 
                                    min
                                 
                                 
                                    
                                       t
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   =
                                                   1
                                                
                                                
                                                   K
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   0
                                                   ,
                                                   j
                                                   ≠
                                                   i
                                                
                                                
                                                   n
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ijk
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

By Property 1, each vehicle’s route is identical. Thus, the original problem can be decomposed into sub-problems for each vehicle. Also, the variable xijk
                         can be replaced by xij
                        . The second term of (14) consists of the total of the corresponding term in each sub-problem. By decomposing (14), the model of each subproblem is presented in (15)–(25). For the convenience of presentation, the depot that each vehicle returns to is represented by n
                        +1 in the model.
                           
                              (15)
                              
                                 
                                    
                                       LR
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    min
                                 
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         t
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   +
                                                   K
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            1
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            =
                                                            1
                                                            ,
                                                            j
                                                            ≠
                                                            i
                                                         
                                                         
                                                            n
                                                            +
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            i
                                                            =
                                                            0
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 K
                              
                           
                        
                        
                           
                              (16)
                              
                                 s.t.
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       0
                                       j
                                    
                                 
                                 =
                                 1
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                       ,
                                       n
                                       +
                                       1
                                    
                                 
                                 =
                                 1
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ih
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       hj
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 h
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                 
                                    
                                       t
                                    
                                    
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 0
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                                 ⩽
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 ⩽
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       b
                                    
                                 
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ji
                                    
                                 
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       I
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 /
                                 R
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                 
                                 ⩾
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 +
                                 
                                    
                                       TI
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 M
                                 (
                                 1
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 n
                                 +
                                 1
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                    
                                       t
                                    
                                    
                                       i
                                    
                                    
                                       d
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                 
                                    
                                       x
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 
                                 i
                                 =
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 n
                                 +
                                 1
                              
                           
                        
                     

The objective is the minimization of the travel time of each route. If we re-write tn
                        
                        +1 as 
                           
                              
                                 
                                    t
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              (
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    x
                                 
                                 
                                    ij
                                 
                              
                           
                        , thus, the objective function can be re-written as 
                           
                              
                                 
                                    LR
                                 
                                 
                                    k
                                 
                              
                              =
                              min
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      0
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                      +
                                                      1
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      j
                                                   
                                                
                                                -
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                                K
                                                )
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ij
                                                   
                                                
                                                -
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      n
                                                   
                                                
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              K
                           
                        . Since K and αi
                         are constants, the subproblem can be treated as a shortest path problem with time constraints (Desrosiers, Dumas, Solomon, & Soumis, 1995).

We develop a dynamic programming (DP) algorithm to solve the subproblem. The algorithm extends the dynamic algorithm in Desrosiers et al. (1995) to avoid cyclic routes in the network. Before presenting the algorithm, the following notation is explained.

Let 
                           
                              
                                 
                                    c
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    t
                                 
                                 
                                    j
                                 
                              
                              -
                              
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              K
                           
                        , which denotes the travel cost from node i to node j. For node i, there is a set of labels. Each label can be denoted by 
                           
                              (
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              ,
                              Front
                              (
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              ,
                              
                                 
                                    vt
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                              )
                              )
                           
                        . 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         indicate the travel time and cost of the kth path from o to i, respectively. 
                           
                              
                                 
                                    T
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         also indicates the delivery start time of the vehicle for customer i. On the kth path, 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         denotes the immediate predecessor of i. 
                           
                              
                                 
                                    vt
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                         denotes the route index from o to 
                           
                              
                                 
                                    v
                                 
                                 
                                    i
                                 
                                 
                                    k
                                 
                              
                           
                        . Qi
                         is the set of labels for node i. Pi
                         refers the set of labels that is exploited in the DP procedure. N denotes the set of nodes. o and d denote the depot that the vehicle departs and returns to, respectively. V denotes nodes including N and d. Γ(i) denotes successors of node i. To avoid cyclic routes, if a node is included in the route from o to i, the node cannot be included in Γ(i).

Similar to Desrosiers et al. (1995), among the set of labels of node i, we define the condition that one label dominates another label.
                              Definition
                              
                                 
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       ,
                                       Front
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             vt
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       )
                                       )
                                    
                                  dominates 
                                    
                                       (
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       ,
                                       Front
                                       (
                                       
                                          
                                             v
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             vt
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       )
                                       )
                                    
                                  if and only if 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       ⩽
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       ⩽
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       ,
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       -
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             1
                                          
                                       
                                       ⩽
                                       
                                          
                                             C
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                       -
                                       
                                          
                                             T
                                          
                                          
                                             i
                                          
                                          
                                             k
                                             2
                                          
                                       
                                    
                                 , and at least one of the inequalities holds strictly.

If we extend the sub-route 0−
                           i to node j, the labels are updated, so that 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 Front
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       vt
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 )
                                 )
                              
                            and 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 Front
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       vt
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 )
                                 )
                              
                            are obtained. The first sub-route is better than the second if 
                              
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                           . We now show that why 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                            is appended compared to the domination definition in Desrosiers et al. (1995).

When we extend the sub-route 0−
                           i to node j, 
                              
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 =
                                 max
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       ij
                                    
                                 
                                 }
                              
                           , 
                              
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 =
                                 max
                                 {
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                                 ,
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       T
                                    
                                    
                                       ij
                                    
                                 
                                 }
                              
                           , 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       ij
                                    
                                 
                              
                           . According to the definition of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                              
                           , it is obvious that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       k
                                    
                                 
                              
                           . If cij
                            is constant, the domination condition should be 
                              
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                           , which is given by Desrosiers et al. (1995). However, cij
                           
                           =
                           tj
                           
                           −
                           ti
                           
                           +
                           αiK in this sub-problem. Let ATj
                            denotes the arrival time of the vehicle to node j. Thus,
                              
                                 (26)
                                 
                                    
                                       
                                          AT
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          t
                                       
                                       
                                          i
                                       
                                    
                                    +
                                    
                                       
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                I
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                t
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          R
                                       
                                    
                                    +
                                    
                                       
                                          TI
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                           Then,
                              
                                 (27)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  C
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            -
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  u
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  t
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            R
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            TI
                                                         
                                                         
                                                            ij
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      K
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            AT
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      >
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      +
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      K
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      
                                                         
                                                            AT
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                      ⩽
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            j
                                                         
                                                         
                                                            a
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        


                           
                              
                                 (2)
                                 If 
                                       
                                          
                                             
                                                AT
                                             
                                             
                                                j
                                             
                                             
                                                k
                                                1
                                             
                                          
                                          ⩽
                                          
                                             
                                                AT
                                             
                                             
                                                j
                                             
                                             
                                                k
                                                2
                                             
                                          
                                          ⩽
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                a
                                             
                                          
                                       
                                    .

According to (26) and (27), 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 K
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       j
                                    
                                    
                                       a
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                 
                                 K
                                 .
                              
                           
                        

If 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                           
                           
                              
                                 (1)
                                 If 
                                       
                                          
                                             
                                                AT
                                             
                                             
                                                j
                                             
                                             
                                                k
                                                1
                                             
                                          
                                          ⩽
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                a
                                             
                                          
                                          ⩽
                                          
                                             
                                                AT
                                             
                                             
                                                j
                                             
                                             
                                                k
                                                2
                                             
                                          
                                       
                                    .


                           
                              
                                 (3)
                                 If 
                                       
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                a
                                             
                                          
                                          ⩽
                                          
                                             
                                                AT
                                             
                                             
                                                j
                                             
                                             
                                                k
                                                1
                                             
                                          
                                          ⩽
                                          
                                             
                                                AT
                                             
                                             
                                                j
                                             
                                             
                                                k
                                                2
                                             
                                          
                                       
                                    .

Therefore, the conditions of 
                              
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                            ensure that 
                              
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       T
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ⩽
                                 
                                    
                                       C
                                    
                                    
                                       j
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                              
                            which indicate that 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 Front
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       vt
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 )
                                 )
                              
                            dominates 
                              
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 Front
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 ,
                                 
                                    
                                       vt
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       2
                                    
                                 
                                 )
                                 )
                              
                           .

Let 
                              
                                 EFF
                                 (
                                 
                                    
                                       T
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 Front
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       vt
                                    
                                    
                                       i
                                    
                                    
                                       k
                                       1
                                    
                                 
                                 )
                                 )
                              
                            denotes the set of non-dominated labels of node i. The algorithm consists of the following steps.
                              
                                 
                                    Step 1. Initialization


                           
                              
                                 
                                    Step 2.selection of node i
                                    ∗
                                 

From the set 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          (
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                          
                                          ⧹
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          N
                                          ∪
                                          {
                                          o
                                          }
                                          ,
                                       
                                     select the label 
                                       
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          Front
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                vt
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          )
                                       
                                     with minimum value of 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                i
                                             
                                             
                                                k
                                             
                                          
                                          .
                                       
                                     If 
                                       
                                          
                                             
                                                U
                                             
                                             
                                                i
                                             
                                          
                                          ∈
                                          (
                                          
                                             
                                                Q
                                             
                                             
                                                i
                                             
                                          
                                          ⧹
                                          
                                             
                                                P
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          =
                                          ∅
                                          ,
                                          
                                          ∀
                                          i
                                          ∈
                                          N
                                          ∪
                                          {
                                          o
                                          }
                                       
                                    , stop, go to step 4. Otherwise, go to next step.


                                    Step 3: treatment of label 
                                       
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          Front
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                vt
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          )
                                       
                                    
                                 

For all j
                                    ∊
                                    Γ(i
                                    ∗),


                           
                              
                                 
                                    
                                       
                                          
                                             
                                                f
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                j
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          Front
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                vt
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          )
                                       
                                     is the treatment of labels of the node j, which is the successor of node i
                                    ∗. If 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          /
                                          R
                                          +
                                          
                                             
                                                TI
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                j
                                             
                                          
                                          ⩽
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                b
                                             
                                          
                                       
                                    ,


                           
                              
                                 The term 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          /
                                          R
                                          +
                                          
                                             
                                                TI
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                j
                                             
                                          
                                       
                                     denotes the sum of delivery start time at node i, the delivery time of the vehicle at node i and the travel time between node i and j. 
                                       
                                          [
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                a
                                             
                                          
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                b
                                             
                                          
                                          ]
                                       
                                     is the time windows for delivery at node j. It is obvious that if 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          -
                                          
                                             
                                                I
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          /
                                          R
                                          +
                                          
                                             
                                                TI
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                j
                                             
                                          
                                          >
                                          
                                             
                                                t
                                             
                                             
                                                j
                                             
                                             
                                                b
                                             
                                          
                                          ,
                                          
                                             
                                                f
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                j
                                             
                                          
                                          (
                                          
                                             
                                                T
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          Front
                                          (
                                          
                                             
                                                v
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          ,
                                          
                                             
                                                vt
                                             
                                             
                                                
                                                   
                                                      i
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                             
                                                k
                                             
                                          
                                          )
                                          )
                                       
                                     is empty.

When the treatment is executed, return to step 2.


                                    Step 4: from all the labels of {d}, select the label 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                d
                                             
                                             
                                                
                                                   
                                                      k
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          
                                       
                                     with the minimum value of 
                                       
                                          
                                             
                                                T
                                             
                                             
                                                d
                                             
                                             
                                                k
                                             
                                          
                                       
                                    . Then, find the shortest path from this label.

The subgradient method is used to find the appropriate multipliers for the Lagrangian relaxation technique. In the subgradient method, a sequence of Lagrangian multipliers is generated by the formula:
                           
                              (30)
                              
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                    
                                       s
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       α
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 +
                                 
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 *
                                 
                                    
                                       
                                          K
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   n
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                x
                                             
                                             
                                                ij
                                             
                                          
                                          -
                                          1
                                       
                                    
                                 
                              
                           
                        where ts
                         is a positive scalar step size defined as:
                           
                              (31)
                              
                                 
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             s
                                          
                                       
                                       *
                                       (
                                       Z
                                       -
                                       LB
                                       )
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             1
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             
                                                
                                                   K
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         1
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        The initial multipliers can be αi
                        
                        =0. μs
                         is a scalar satisfying 0<
                        μs
                        
                        ⩽2. Z is an upper bound on the optimal solution, which can be obtained by heuristics to the original problem. LB is the lower bound, which is obtained by the dynamic programming algorithm.

The steps of the Lagrangian relaxation technique are:
                           
                              
                                 Step 1: initialization. Set αf
                                 
                                 =0, μs
                                 
                                 =2, Maximum iteration kmax
                                 =1000, initial lower bound LB
                                 =0, initial upper bound UB
                                 =20,000, ɛ
                                 =0.05, a parameter named Max_No_Improve is set to 4, which will be used in the following step.


                                 Step 2: calculate relaxed lower bound LR and upper bound Z, 
                                    
                                       LB=Max(LR,LB)
                                    
                                 . if LB is not increased in Max_No_Improve iterations, take μn
                                  to its half.


                                 Step 3: calculate ts
                                  and αi
                                 .


                                 Step 4: if iteration number reaches its maximum or 
                                    
                                       100
                                       ×
                                       
                                          
                                             (
                                             Z
                                             -
                                             LB
                                             )
                                          
                                          
                                             Z
                                          
                                       
                                       ⩽
                                       ε
                                    
                                 , stop. Return LB. Otherwise, return to Step1.

The upper bound in Step 2 is generated by the tabu search algorithm. When applying the Lagrangian relaxation technique, we observe that the iteration is not always necessary to be 1000. In most of the cases, when μn
                                  is reduced to a certain value, LR cannot be increased. Thus, if LR stops increasing for some value of μn
                                  and the subsequent value of μn
                                 /2, we terminate the algorithm to save computing time.

In this section, the performance of the tabu search algorithm is evaluated by computational experiments based on randomly generated instances. Campbell and Savelsbergh (2004a) work on an industrial gas delivery problem, which is similar to the problem studied in this paper. Therefore, we generate our data in the way that is similar to the procedure described in Campbell and Savelsbergh (2004a). However, the ranges of the randomly generated data are adjusted slightly according to the assumptions in this paper. Three sets of data are generated based on 5–9 gas stations (first set S1), 10–100 gas stations (second set S2) and 60–200 gas stations (third set S3), respectively. The storage capacity of the gas stations is generated in [288, 312] with an average of 300. The average consumption rate of each gas station is 15 per hour. We allow the value to vary by 20% below or above the average value. It is safe to assume that the consumption rate in the day time is higher than that in the night. Based on observation and communications with employees from the company, the consumption rate during the 8-hour delivery time (day time) period is set to two times over the consumption rate of the 16-hour low demand time period (non-delivery time period, i.e., night time). In our model, the decision only cares about the operations within an 8-hour delivery time period. Thus, in order to simplify the model, the low demand time period can be condensed to 8hours with identical consumption rate within the delivery time period. The initial inventory at each gas station is set to be the consumption quantity between 4 and 16hours at the delivery time period consumption rate. Also, the minimum delivery quantity at each gas station should satisfy at least one day’s consumption. It is set to be 20hours consumption quantity minus the initial inventory. The position of the depot and each gas station is represented by the X and Y coordinates, which are generated in [0, 70]. There are 2–20 vehicles in each problem, with the travel speed of 40 per hour. The delivery rate of each vehicle to each gas station is set to 900 per hour. For each problem configuration, 5 instances are generated and the average is presented as the reported results.

The tabu search algorithm and the Lagrangian relaxation technique were coded in C++. The computational experiments are conducted on a personal computer with Intel Pentium dual-core 2.8gigahertz CPU and 2gigabytes RAM. The test instances with 5–9 gas stations are employed to validate that whether the tabu search can obtain the optimal solution for small sized problems, which are solved by CPLEX 12.0.

The computational results are shown in Tables 1–3
                     
                     
                     . Table 1 provides optimal solutions obtained by CPLEX and the results of the tabu search algorithm for the five instances generated for each combination of gas station number and vehicle number. It is shown that the tabu search algorithm can obtain the optimal solutions for all of the small sized instances. It is also observed from Table 1 that the tabu search algorithm spends shorter time for most of the problems. The gap of CPU time increases as the problem size increases. Note that CPLEX can only solve the problem with 9 gas stations and 2 vehicles. For larger sized problem, CPLEX cannot provide the optimal solution within 8hours, which is a shift time period in reality. Thus, we can find that for small-scale test instances, the tabu search algorithm dominates CPLEX.

In order to evaluate the performance of the presented tabu search algorithm for solving larger sized problem, we compare the results with the lower bounds obtained using the procedure described in Section 5. The results of the average travel time, lower bounds and computational time for five instances of each problem in the second set are reported in Table 2.

For small to medium sized problems in the second set, with the exception of problem configuration number 17 which is the largest instance in the test set and has a gap of 17.9%, the maximum of the average gap between the solution of the tabu search algorithm and the lower bound provided by the Lagrangian relaxation technique is less than 8.1%. It implies that the tabu search algorithm can obtain solutions which are close to the optimal ones. Also, the results indicate that the lower bound obtained by the Lagrangian relaxation technique is rather tight for most of the test instances in the set. It is worthwhile to mention that the computational time of the tabu search is very competitive compared to that of the Lagrangian relaxation technique.

As discussed earlier, an adapted US algorithm is applied in each iteration of the tabu search algorithm. To evaluate the effectiveness of the adapted US algorithm, the tabu search algorithm is compared to its duplication where the adapted US algorithm is removed (i.e., by removing Steps 9 and 14 from Algorithm 1). It should be mentioned that if the adapted US algorithm is totally removed from the tabu search algorithm, it is hard to find a feasible solution. Therefore, the adapted US algorithm is still applied to the selected best neighbor (i.e., applied to the solution in Step 18 in Algorithm 1) in each iteration of the tabu search. Meanwhile, we apply the standard US algorithm, i.e., without the adaptation, to the tabu search to see whether the adapted US algorithm contribute to the solutions. The computational results are shown in Table 3, where the three approaches are marked as “without”, “with standard” and “with adapted” which are linked with the US algorithm. The columns of “Gap (%)” below “without ” and “with standard” measure the relative difference of the particular approach to the tabu search with the adapted US algorithm.

The results indicate that the tabu search with the adapted US algorithm obtain much better results compared to the tabu search without the adapted US algorithm. The average gap is about 12.1%. Although the computational time of the former algorithm is longer than the latter, the time is still acceptable in practice. The results indicate that the adapted US algorithm enhance the performance of the tabu search algorithm considerably.

Since standard the US algorithm is quite time consuming, it is also only applied for the selected neighbor in each iteration of the tabu search algorithm. It is shown that the tabu search with standard US algorithm spent less time for smaller problem. However, the CPU time increases quickly when the problem size increases. It is also shown that the tabu search with adapted US algorithm performs better than tabu search with the standard US algorithm. For all of the 15 problems, tabu search with adapted US algorithm is slightly inferior to tabu search with standard US algorithm for 7 problems. However, for the remaining 8 problems, tabu search with adapted US algorithm clearly outperforms. The last row in Table 3 summarizes the performance of the three approaches across all the test instances in the third test set, which clearly shows that the tabu search with adapted US algorithm outperforms the one without by 12.1%, and slightly outperforms the one with standard US algorithm with a performance gap of 1.0%.

The results in Table 3 indicate that it is preferable to apply the adapted US algorithm or the standard US algorithm for each generated neighbor. However, as the standard US algorithm is quite time consuming, it can only be applied to one selected neighbor in each iteration. The adapted US algorithm can be applied to each generated neighbor to enhance the performance of the tabu search algorithm while maintain the time-effectiveness of the approach.

@&#CONCLUSION@&#

In this paper, we investigate a new variant of the inventory–routing problem in the gasoline distribution industry. We consider a couple of special constraints in this industry, which motivate us to concentrate on the vehicle travel time minimization as the objective. For this NP-hard problem, we have proposed a tabu search algorithm and developed an adapted US algorithm as part of the solution procedure which improves the solution quality in each iteration of the tabu search. For evaluating the performance of the proposed approach, we employ the Lagrangian relaxation technique to obtain the lower bound of the problem which decomposes the relaxed problem by exploiting its properties. Computational results show that the solution of the tabu search algorithm is close to the lower bounds for small to medium sized problems. It indicates that the tabu search algorithm can provide near optimal solution for these problems and the Lagrangian relaxation technique provides tight lower bounds. Computational results also demonstrate that the adapted US algorithm can improve the performance of the tabu search considerably.

Although the lower bound provided by the Lagrangian relaxation technique is tight, the computational time is relatively long. Thus, it is an interesting direction to reduce the computational complexity of the lower bound while not sacrificing the quality. From a practical perspective, a natural next step to tackle the problem is to consider the vehicle capacity constraint while routing the fleet of distribution vehicles. How to balance the maximum travel time and the overall distribution system cost would also be interesting and the trade-off between time and cost needs to be examined as future work as well.

@&#ACKNOWLEDGEMENT@&#

This research was supported by the National Nature Science Foundation of China (Nos. 70972019 and 71131004), and Program for New Century Excellent Talents in University (NCET-10-0410).

@&#REFERENCES@&#

