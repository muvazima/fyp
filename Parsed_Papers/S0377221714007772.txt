@&#MAIN-TITLE@&#A stochastic dynamic pricing model for the multiclass problems in the airline industry

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a dynamic pricing model with multiple products with different behaviors applied to the airline industry.


                        
                        
                           
                           We estimate the transition probabilities using the inter-arrival time distribution of bookings and the probability that a booking turns into a ticket.


                        
                        
                           
                           We fit these probabilities with phase type distributions.


                        
                        
                           
                           Applying this model to a case study improved the expected revenue by 31 percent.


                        
                        
                           
                           The phase type distributions fitted with a low error to the data of the industry.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Revenue management

Phase-type distributions

Stochastic dynamic programming

Dynamic pricing

OR in airlines

@&#ABSTRACT@&#


               
               
                  In the airline industry, deciding the ticket price for each flight directly affects the number of people that in the future will try to buy a ticket. Depending on the willingness-to-pay of the customers the flight might take off with empty seats or seats sold at a lower price. Therefore, based on the behavior of the customers, a price must be fixed for each type of product in each period. We propose a stochastic dynamic pricing model to solve this problem, applying phase type distributions and renewal processes to model the inter-arrival time between two customers that book a ticket and the probability that a customer buys a ticket. We test this model in a real-world case where as a result the revenue is increased on average by 31 percent.
               
            

@&#INTRODUCTION@&#

In the airline industry, deciding the price for a product (i.e., the ticket) is one of the major problems to be solved on a daily basis (Talluri and Van Ryzin, 2004). On the other hand, the price that is decided for a product directly affects its future demand (Phillips, 2005). In a single flight there are different products with different demand behaviors, and the price decision is to be made for each one of these products. Also, the product offered by the airlines cannot be replenished and is perishable, indicating that there is a finite number of products and a limited time period to which the decision is confined. If at the beginning of a period a low price is offered for a particular product then it is more likely that many potential customers buy the tickets at a lower price than what they would be willing to pay. On the other hand if a higher price is fixed only a few potential customers are likely to buy tickets and even lowering the price at the end of the sales period might still leave some unsold tickets. Therefore, the challenge in the airline industry is to fix a price in each period of time that minimizes this loss of revenue and takes advantage of the willingness-to-pay of the customers. Because the decision taken in a particular moment of time affects what could happen in the following periods and it should also be renewed dynamically to maximize the revenue, this problem is commonly known as dynamic pricing 
                     (Talluri and Van Ryzin, 2004).

Revenue Management (RM) techniques have been applied to the dynamic pricing problems in the airline industry since approximately 40 years ago. The objective of applying these techniques is to dynamically change the prices during the selling period, such that each seat is sold at the maximum price possible. The prices fixed by the airline for a product during the selling periods depend on the type of product, the type of customer, and the distribution channel. The airlines not only decide the new prices by these factors but also study the competitors’ decisions closely. Application of RM to airline ticket pricing has been proven to increment the revenue by between 2 percent and 8 percent (Li and Ji-hua, 2007). This in turn has increased the number of scientific studies on how to efficiently change the prices to maximize the total revenue of a flight (Talluri and Van Ryzin, 2004).

To maximize the total revenue, the price has to be changed in each period, based on the behavior of the demand. Also, in each period of time the decision to change the price for the next period should be made for each product. In the literature, to solve this problem, various dynamic pricing models are proposed. Maglaras and Meissner (2006) provide a thorough survey of the different approaches that use linear and nonlinear programming, stochastic and deterministic dynamic programming and statistical models, among others. In most of these approaches, similar assumptions are taken into account such as: Non-Homogeneous Poisson Process (NHPP) for the inter-arrival time distribution of bookings, absence of competition, known probability of buying a product, and the absence of effects such as no-shows, costs of overbooking and cancellations (Talluri and Van Ryzin, 2004). There are also some models that relax one or more of these assumptions. For example Li and Ji-hua (2007) propose a model with one competitor, Li and Chen (2009) present time-dependant arrival time distributions with multiple products, and Chen (2012) presents censored observation approaches where the demand is unknown.

Most of the models consulted in this paper share the assumption of NHPP for the inter-arrival time distribution of bookings. To accurately estimate the rates for the NHPP, the arrival process needs to follow an exponential distribution in each period of time. However, in reality this behavior could follow any distribution besides the exponential (Talluri and Van Ryzin, 2004). Therefore, a major challenge in this problem is how to accurately and efficiently estimate the behavior of the demand. This behavior can be divided into two parts, i.e., the demand inter-arrival time and the probability that a ticket is bought at a certain price.

There are different approaches on how to estimate the behavior of the customers in terms of their demand inter-arrival time distribution and their buying probability of a booked ticket. For example Chen (2012) applies Markov Decision Process (MDP) models with censored data, where censored data represent the non-buying customers due to product unavailability. Haensel and Koole (2011) apply a customer choice sets approach where the customers are grouped by their preferences. Also Fiig, Isler, Hopperstad, and Belobaba (2010) and Phillips (2005) propose multinomial approaches where they estimate the utility that the customer perceives over the available products. Although these methodologies try to estimate the probability distributions mentioned, most of them use the utility term which defines the customer’s appeal toward a product. Therefore, it is difficult to estimate this value unless information on the different choices that a customer can make is available. One of the possible ways to get this information is by conducting interviews, which is time consuming, expensive, and requires a large sample size to create useful data.

In a typical flight different types of products can be sold (Phillips, 2005), where each product has a different behavior of demand. Most of the airlines use RM software to help decide the price at which to sell a ticket. But the models behind the software suggest the optimal price using different methods of estimating the buying probability and the demand inter-arrival distribution. Ernst and Kamrad (2006) argue that these models rely heavily on historical data and can be inaccurate. On the other hand there are airlines that do not have RM software and their decisions are based on experience and comparison with the performance of the competition, which do not necessarily guarantee the optimal solution. Therefore, in this paper, we propose a stochastic dynamic programming model to solve the problem of maximizing the revenue over a finite horizon, divided into various decision periods and with different products. In each decision period a price is going to be decided, from a pool of available prices, for each product depending on the number of seats available for each of these products. We work under the assumption that the demand inter-arrival time does not necessarily follow a NHPP, and the probability that a ticket is bought at a certain price is not known and has to be estimated as well. In this model we approximate the inter-arrival time distribution of demand and the buying probability using Phase Type (PH) distributions. The PH distributions are combinations of exponential distributions (phases) that can fit different types of behavior (Latouche and Ramaswami, 1999). We use various algorithms proposed in the literature to fit the distributions of demand inter-arrival time and the buying probability, depending on the data characteristics. Finally, we use renewal processes to implement the PH distributions in counting processes.

Having the PH estimates of the inter-arrival time distribution, applying the renewal processes, and the buying probability, we solve the stochastic dynamic program with backward induction for different scenarios, each of which with a different combination of parameters to test the performance of our proposed method. We change the number of seats, the type of distributions and finally test our proposed model on a case study with industry data.

The rest of the paper is organized as follows. In Section 2 we present the proposed model with a detailed explanation on how to estimate each of the distributions and introduce the dynamic pricing model. In Section 3 we introduce the PH family of distributions and discuss data fitting techniques to a PH distribution using different algorithms. In Section 4 we present some structural properties of the dynamic pricing model and prove the existence of an optimal solution. In Section 5 we present the result for the scenarios and the case study, dividing them into three parts: the fitting of the purchasing probability distribution, the fitting of demand inter-arrival time distribution, and the results of the dynamic pricing model. Finally in Section 6 we conclude the paper and state future steps for this research.

In this section we first introduce some airline specific jargon and definitions, then we define the essential components of our proposed dynamic pricing model. The first component consists of estimating the probability that a customer buys a previously booked ticket at a certain price. We refer to this component as the ticketing probability. The second component is the probability that j customers buy tickets for a given product on a particular flight in a period of time t, which we will call the buying probability. The buying probability depends on the ticketing probability and the inter-arrival time distribution of the demand. We estimate the buying probability by the number of bookings (reservations) that the airline receives. To estimate the behavior of the probability distributions closer to reality and with more flexibility, we propose to fit PH distributions to them. This fitting allows us to find a relatively accurate approximation to the behavior of the underlying distributions when they do not necessarily follow the form of any standard distribution (e.g., the multi-modality behavior) (Latouche and Ramaswami, 1999). Then we apply renewal processes to approximate the arrival process of bookings by a counting process. After estimating the probability distributions of ticketing and buying, we present the dynamic pricing model that attempts to find optimal pricing policies, given these distributions.


In this section we present the terms and definitions used in the context of airline revenue management. We define booking as the reservation of a seat where no money is involved. On the other hand, ticketing occurs when the customer pays for this booking. We estimate the demand for a particular ticket by the number of bookings received for that product. Using these two definitions, the probability distribution of ticketing is defined as the probability that a booked ticket is paid for and bought eventually.

A product is defined by the benefits that it offers. The most common benefits of a product include the number of miles received, the costs of changing the ticket, the type of cabin, and promotions. Each product can be offered in various flying classes, which we denote as c. Each of these flying classes has a price assigned, depending on the type of product that they represent. In general, the number of cabins, the number of products, and the number of classes vary depending on the airline. Some airlines offer only two classes while others can have up to 26 different classes in a single flight (Phillips, 2005). For each class c, only one type of product is offered, while many classes can offer the same product.

The tickets are up for sale since almost a year before the departure date of the flight, and this period is called the selling period. Because different classes can have the same product but with different prices, only one class is available per product in each period of time. Therefore, during the selling period the class offered for a particular product changes, hence changing the prices of the product according to the available class. So the price that a customer sees during the selling period is the price of the available class for that product. The objective of our proposed dynamic pricing model is to set the prices in each time epoch throughout the selling period, such that the total revenue is maximized. All of the classes that offer the same product are grouped in fare families denoted by k. So each fare family represents a particular product.

Any average to large-scale commercial airline can have between 2000 to over 6000 flights during the day, which create plenty of data including the number of bookings per day, the number of tickets bought, and any related information regarding the flight. The selling period can be divided into different epochs where the prices are decided for each product. These epochs are commonly called Data Collection Points (DCP). The DCPs are moments in time when the airlines collect data, and are chosen such that the data can represent the behavior of the customers. The information saved on each DCP for all the flights that are available for purchase, includes the data of tickets and bookings. Normally airlines only save the data for 18–25 DCPs out of the whole selling period (Talluri and Van Ryzin, 2004).

The Authorized Capacity (AU) refers to the number of seats available for sale for each class. The sum of the AU of classes in a fare family is the AU of the fare family, and the sum of these is the AU of the flight. The total AUs of a flight is usually bigger than or equal to the number of seats on the plane that is assigned to the flight. During the selling period the AU remains constant, and the number of bookings cannot exceed this value. Fig. 1
                        shows a common curve of bookings for a given flight. Normally there is a decreasing effect at the end of the curve. This effect is mostly produced by cancellations of bookings during the whole period. Also at the departure date we may observe the no-show effect, which is defined as the number of customers that do not show up to board the flight for various reasons.

The price to be decided for a product varies depending on the behavior of demand, and this behavior changes for each product depending on the flight leg, flight number, or seasonality (Talluri and Van Ryzin, 2004). A leg is the route that a plane follows between two destinations. For example, consider the flight between the airports JFK and LAX. In each day there are different frequencies or flights between these two airports. Each of these flights takes off at a different hour, so each of them has a different flight number. Each of these flight numbers has a different demand behavior, depending on its departure time. A family is more likely to fly during the day, even more so if they are traveling with small children. A business traveler usually flies in the early morning and late night hours. Those who are looking for cheaper prices tend to fly in the first or the last flights of the day. The seasonality also affects the demand behavior. Vacations in the middle and at the end of the year help increase the price of the tickets, because most of the customers are willing to pay more. Therefore, in the estimation of the ticketing and buying probability distributions, the flight leg, flight number, and seasonality should be taken into account.

We define the ticketing probability as the probability that a booking turns into a ticket. As shown in the booking curve of Fig. 1, there is a point where the maximum number of bookings is reached. This number of bookings cannot exceed the AU capacity of the flight. Assuming that the number of tickets is the number of people that actually take the flight, we can estimate the probability that a booking turns into a ticket. Let Q be the total number of tickets sold and maxB = max{bt
                        } ∀t, where bt
                         is the number of bookings during any period of time with length t, along the selling period. So the ticketing probability Pr(Q) is determined as follows:

                           
                              (1)
                              
                                 
                                    P
                                    r
                                    
                                       (
                                       Q
                                       )
                                    
                                    =
                                    
                                       Q
                                       
                                          m
                                          a
                                          x
                                          B
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

For each flying class a booking curve (similar to Fig. 1) is generated. Assuming that Qc
                         is the number of tickets sold for class c and maxBc
                         the maximum number of bookings for class c, then, the probability Prc
                         that any booking turns into a ticket of a particular class c can be obtained as:

                           
                              (2)
                              
                                 
                                    P
                                    
                                       r
                                       c
                                    
                                    =
                                    
                                       
                                          Q
                                          c
                                       
                                       
                                          
                                             ∑
                                             c
                                          
                                          
                                             m
                                             a
                                             x
                                             
                                                B
                                                c
                                             
                                          
                                       
                                    
                                    
                                    ,
                                 
                              
                           
                        and the probability Pr
                        0 of a ticket not being bought is,

                           
                              (3)
                              
                                 
                                    P
                                    
                                       r
                                       0
                                    
                                    =
                                    1
                                    −
                                    
                                       ∑
                                       c
                                    
                                    
                                       P
                                       
                                          r
                                          c
                                       
                                    
                                    
                                    .
                                 
                              
                           
                        
                     

As mentioned in Section 2.1, each class within a fare family varies only in the value of the ticket. Given the ticketing probability for a class c (i.e., Prc
                        ) and the price assigned to that class, there is a probability that a booking turns into a ticket for the assigned price p. Let p be the price for a ticket in any period of time. If a customer arrives and is willing to pay more than this price then he is going to buy the ticket at price p. Setting a price for each class, and using Eq. (2), let Pr(Pc
                        ) = Prc
                         be the probability that at price Pc
                         a booking turns into a ticket, where the price Pc
                         is the price set for class c. Then the probability g(p) that a customer buys a ticket at price p is:

                           
                              (4)
                              
                                 
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          
                                             P
                                             c
                                          
                                          ≥
                                          p
                                       
                                    
                                    P
                                    r
                                    
                                       (
                                       
                                          P
                                          c
                                       
                                       )
                                    
                                    
                                    .
                                 
                              
                           
                        
                     

Now, assuming that there exists a continuous probability distribution f(x) that describes the probability of a booking turning to a ticket at price x, then Eq. (4) can be written as:

                           
                              (5)
                              
                                 
                                    g
                                    
                                       (
                                       p
                                       )
                                    
                                    =
                                    
                                       ∫
                                       p
                                       ∞
                                    
                                    
                                       f
                                       (
                                       x
                                       )
                                       d
                                       x
                                    
                                    ,
                                 
                              
                           
                        and the probability that a customer that arrives does not buy a ticket at price p is:

                           
                              (6)
                              
                                 
                                    1
                                    −
                                    g
                                    (
                                    p
                                    )
                                    .
                                 
                              
                           
                        
                     

We estimate the probability that j customers arrive in a period Δt, by a counting process. A counting process represents the probability that l events happen during a period of time Δt, is defined by Pr(N(Δt) = l). To estimate the probability that j customers buy tickets during a Δt period of time, we need to estimate the conditional probability that if l customers arrive, j of them buy tickets and l − j do not. Using Eqs. (5) and (6), the probability of this event occurring is:

                           
                              (7)
                              
                                 
                                    P
                                    r
                                    
                                       (
                                       j
                                       |
                                       l
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      (
                                                      
                                                         l
                                                         j
                                                      
                                                      )
                                                   
                                                   
                                                   g
                                                   
                                                      
                                                         (
                                                         p
                                                         )
                                                      
                                                      j
                                                   
                                                   
                                                      
                                                         (
                                                         1
                                                         −
                                                         g
                                                         
                                                            (
                                                            p
                                                            )
                                                         
                                                         )
                                                      
                                                      
                                                         l
                                                         −
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   j
                                                   ≤
                                                   l
                                                
                                             
                                          
                                          
                                             
                                                0
                                             
                                             
                                                
                                                   j
                                                   >
                                                   l
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                        so the unconditional probability that j customers buy their ticket during Δt period of time at price p will be:

                           
                              (8)
                              
                                 
                                    P
                                    r
                                    
                                       (
                                       j
                                       ,
                                       Δ
                                       t
                                       ,
                                       p
                                       )
                                    
                                    =
                                    
                                       ∑
                                       
                                          l
                                          =
                                          j
                                       
                                       ∞
                                    
                                    
                                       P
                                       r
                                       
                                          (
                                          N
                                          
                                             (
                                             Δ
                                             t
                                             )
                                          
                                          =
                                          l
                                          )
                                       
                                       
                                          (
                                          
                                             l
                                             j
                                          
                                          )
                                       
                                       g
                                       
                                          
                                             (
                                             p
                                             )
                                          
                                          j
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             g
                                             
                                                (
                                                p
                                                )
                                             
                                             )
                                          
                                          
                                             l
                                             −
                                             j
                                          
                                       
                                    
                                    
                                    ∀
                                    j
                                    ≤
                                    A
                                    U
                                    .
                                 
                              
                           
                        
                     

This probability is to be estimated for each price p for each fare family k and over the set of feasible prices to be assigned to k. Let Pik
                         denote the price i from the set of feasible prices of fare family k, where each fare family has a different number of feasible prices to choose from, then Eq. (8) can be written as follows for each fare family k:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             P
                                             
                                                r
                                                k
                                             
                                             
                                                (
                                                j
                                                ,
                                                Δ
                                                t
                                                ,
                                                
                                                   P
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   l
                                                   =
                                                   j
                                                
                                                ∞
                                             
                                             
                                                P
                                                
                                                   r
                                                   k
                                                
                                                
                                                   (
                                                   N
                                                   
                                                      (
                                                      Δ
                                                      t
                                                      )
                                                   
                                                   =
                                                   l
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      l
                                                      j
                                                   
                                                   )
                                                
                                                
                                                   g
                                                   k
                                                
                                                
                                                   
                                                      (
                                                      
                                                         P
                                                         
                                                            i
                                                            k
                                                         
                                                      
                                                      )
                                                   
                                                   j
                                                
                                                
                                                   
                                                      (
                                                      1
                                                      −
                                                      
                                                         g
                                                         k
                                                      
                                                      
                                                         (
                                                         
                                                            P
                                                            
                                                               i
                                                               k
                                                            
                                                         
                                                         )
                                                      
                                                      )
                                                   
                                                   
                                                      l
                                                      −
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             ∀
                                             j
                                             ≤
                                             A
                                             U
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

If the inter-arrival time distribution of the arriving l customers is exponential, then the counting process {N(Δt), t ≥ 0} is a Poisson process and hence Prk
                        (N(Δt) = l) follows a Poisson distribution. However, the assumption of exponential distribution for the inter-arrival time of demand for airline products is not necessarily valid and in many cases non-exponential behavior has been observed (Talluri and Van Ryzin, 2004). For such cases, we model the arrival process using renewal processes that relax the assumption of exponentiality.

After estimating the ticketing and buying probability distributions, we can proceed to define the dynamic pricing model that attempts to maximize the total revenue received for a particular flight. The maximum revenue is obtained by choosing the optimal price for each fare family in each period of time through a stochastic dynamic programming model.

We define the state of the system as the number of available seats in each fare family. In this model, the probability of going from one state to the other is composed of the combination of the inter-arrival time distribution of bookings and the probability that a booking turns into a ticket, i.e. Prk
                        (N(Δt) = l) and g(p), respectively. Given these probabilities in each period of time we can evaluate the total expected discounted revenue for making a decision, which is composed of the expected immediate revenue received in the current period of decision making and the expected revenue received in the following periods of time (till the end of the selling period) discounted to their present value. This total expected revenue is described by the Bellman equation and can be maximized by a variety of techniques including backward induction, which we apply in this paper (Puterman, 2005).

The airline industry has many variables that could affect the revenue of a single flight. However, some of these variables are difficult to estimate through data, and therefore some assumptions need to be made on such variables. The first and one of the strongest assumptions is the lack of any kind of competition. Under the influence of competition the price is regulated by the market. The market stands for all the available airlines that operate a particular leg. If the market increases the prices then the airline can increase its prices in accordance with the market. On the other hand when the market reduces the prices then the airline needs to reduce its price too, in order not to lose its market share. In the absence of competition an airline can fix the optimum price that only depends on the demand behavior. The survey made by Talluri and Van Ryzin (2004) indicates that most of the models for airline RM do not consider the market. For example, Li and Chen (2009) and Chen (2012) propose dynamic pricing models where there is no competition. They make this assumption because obtaining the data of the competitors is a difficult task, if not impossible. Li and Ji-hua (2007) propose a model with one competitor but assuming that the data are known which is a strong and in some cases unrealistic assumption. In our model we assume no competition as well.

As for the behavior of the customers, we also make some assumptions. First, we assume that each fare family has a different type of product. If a customer is looking for a specific product, then he is not going to buy any other one, even if the product he is looking for is out of stock. Also we assume that there is no time lag between when the customer books a ticket and buys it.

We also assume that the price fixed for each fare family must be greater than or equal to the price of a fare family with less benefits. So the price decision for a fare family depends on the decision taken for the other fare families. Although the demand behavior of each fare family is independent of the others, the problem is then solved altogether in order to observe this restriction. Although this assumption seems reasonable in some cases, when discounts apply this behavior does not necessarily happen. Offering discounts on a particular product is a decision made in order to increase the number of bookings, which inflicts loss on the revenue but causes an increase in customer loyalty. Although increase in loyalty is always good, indiscriminate use of discounts can generate high costs (Talluri and Van Ryzin, 2004). Therefore, we also assume that discounts are not possible in the decision for prices. Finally we do not consider the effects of cancellation, oversale, and no-shows like most of the models surveyed by Talluri and Van Ryzin (2004), because they need large quantities of industry data to estimate these effects adequately.

Let Vt
                           (X
                           1, X
                           2, …, Xn
                           ) be the total expected revenue at time t where Xk
                            seats are remaining to be sold for fare family k, k = 1, …, n. Let the set of decision epochs be E = {1, 2, 3, …, m} where each decision epoch is a DCP defined by the airline and m is the departure date, the last epoch where a decision can be made. In each period of time t ∈ E, we are going to decide on the set of prices that maximizes Vt
                           . In each of these periods of time the airline has new information, mostly of new bookings received. Having the new bookings received, the airline knows how many seats are still available. The set of states S is defined as the number of available seats per fare family where any combination of remaining seats is possible, and that on the first epoch the only state is the total number of seats of the flight, i.e., the AU of each fare family. This set can be written as:

                              
                                 (10)
                                 
                                    
                                       
                                          
                                             
                                                S
                                                =
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               A
                                                               
                                                                  U
                                                                  1
                                                               
                                                               ,
                                                               A
                                                               
                                                                  U
                                                                  2
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               A
                                                               
                                                                  U
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               t
                                                               =
                                                               1
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  X
                                                                  1
                                                               
                                                               ,
                                                               
                                                                  X
                                                                  2
                                                               
                                                               ,
                                                               …
                                                               ,
                                                               
                                                                  X
                                                                  n
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               0
                                                               ≤
                                                               
                                                                  X
                                                                  i
                                                               
                                                               ≤
                                                               A
                                                               
                                                                  U
                                                                  i
                                                               
                                                               
                                                               f
                                                               o
                                                               r
                                                               
                                                               1
                                                               <
                                                               t
                                                               ≤
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Each fare family has a possibly distinct set of prices to be decided on by the airline. Therefore, the set of decisions is defined as D = {P
                           
                              i1, P
                           
                              i2, …, Pin
                           }, where Pik
                            is the ith possible price to choose for the fare family k. Note that choosing the ith price for a particular fare family does not mean that the ith price is also chosen for the other fare families, and that this decision is independent for each fare family. Also the decision is only taken when the number of available seats is bigger than 0 for a specific fare family. If a fare family has 0 seats available then no decision is taken. Finally if all the seats are sold for all the fare families, then the expected revenue for the following periods is 0 and no more decisions are made. Another terminal condition occurs when the mth decision epoch i.e., the departure date is reached, since this is the last day the prices can be fixed. The set of probabilities of going from one state to another depending on the decision taken and the time epoch is defined by Eq. (9). Let St
                            be the set of states in epoch t and Xkt
                            the number of available seats in fare family k in epoch t, then the probability of going from any state in S
                           1 = {X
                           11, X
                           21, …, X
                           
                              n1} in time epoch t
                           1 to any state in the set S
                           2 = {X
                           12, X
                           22, …, X
                           
                              n2} in time epoch t
                           2, where X
                           
                              i1 ≥ X
                           
                              i2 ∀X
                           
                              i1 ∈ S
                           1 and X
                           
                              i2 ∈ S
                           2 is calculated as:

                              
                                 (11)
                                 
                                    
                                       
                                          
                                             
                                                P
                                                r
                                                (
                                                
                                                   S
                                                   1
                                                
                                             
                                          
                                          
                                             →
                                          
                                          
                                             
                                                
                                                   S
                                                   2
                                                
                                                
                                                   |
                                                   
                                                      P
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                =
                                                P
                                                
                                                   r
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      11
                                                   
                                                   −
                                                   
                                                      X
                                                      12
                                                   
                                                   ,
                                                   Δ
                                                   t
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                ×
                                                
                                                P
                                                
                                                   r
                                                   2
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      21
                                                   
                                                   −
                                                   
                                                      X
                                                      22
                                                   
                                                   ,
                                                   Δ
                                                   t
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                …
                                                P
                                                
                                                   r
                                                   n
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      
                                                         n
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      X
                                                      
                                                         n
                                                         2
                                                      
                                                   
                                                   ,
                                                   Δ
                                                   t
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where Δt = t
                           1 − t
                           2 and the number of tickets sold during this period of time for the fare family k is defined by X
                           
                              k1 − X
                           
                              k2. On the other hand, if at least one pair of available seats follows the inequality X
                           
                              i1 < X
                           
                              i2 then the probability shown in Eq. (11) is 0.

The set of rewards is also calculated using the probability term derived in Eq. (9). The reward function R(t, P
                           
                              i1, P
                           
                              i2, …, Pin
                           ) is defined as the revenue received from the seats sold at price i, from each fare family k, in a period of time t. This reward function is calculated as:

                              
                                 (12)
                                 
                                    
                                       R
                                       
                                          (
                                          t
                                          ,
                                          
                                             P
                                             
                                                i
                                                1
                                             
                                          
                                          ,
                                          
                                             P
                                             
                                                i
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             P
                                             
                                                i
                                                n
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          ∑
                                          
                                             k
                                             =
                                             1
                                          
                                          n
                                       
                                       
                                          P
                                          
                                             i
                                             k
                                          
                                       
                                       
                                          ∑
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             X
                                             k
                                          
                                       
                                       j
                                       P
                                       
                                          r
                                          k
                                       
                                       
                                          (
                                          j
                                          ,
                                          Δ
                                          t
                                          ,
                                          
                                             P
                                             
                                                i
                                                k
                                             
                                          
                                          )
                                       
                                       
                                       ∀
                                       t
                                       ∈
                                       E
                                       .
                                    
                                 
                              
                           
                        


                           Eq. (12) shows that the expected revenue received for the fare family k is the price Pik
                            chosen, times the expected value of the number of tickets sold at this price, i.e., 
                              
                                 
                                    ∑
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       X
                                       k
                                    
                                 
                                 j
                                 P
                                 
                                    r
                                    k
                                 
                                 
                                    (
                                    j
                                    ,
                                    Δ
                                    t
                                    ,
                                    
                                       P
                                       
                                          i
                                          k
                                       
                                    
                                    )
                                 
                                 ,
                              
                            during the period of time Δt, where Δt is the difference in time between the last and the current decision epochs. Then the total expected reward is calculated as the sum of the expected revenue received per fare family. Using Eq. (11), the expected revenue received in the next period, depending on the decision made in the current period is defined as:

                              
                                 (13)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                E
                                                
                                                   (
                                                   
                                                      V
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   |
                                                   
                                                      P
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   ∑
                                                   
                                                      
                                                         j
                                                         1
                                                      
                                                      =
                                                      0
                                                   
                                                   
                                                      X
                                                      1
                                                   
                                                
                                                P
                                                
                                                   r
                                                   1
                                                
                                                
                                                   (
                                                   
                                                      j
                                                      1
                                                   
                                                   ,
                                                   Δ
                                                   t
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                …
                                                
                                                   ∑
                                                   
                                                      
                                                         j
                                                         n
                                                      
                                                      =
                                                      0
                                                   
                                                   
                                                      X
                                                      n
                                                   
                                                
                                                P
                                                
                                                   r
                                                   n
                                                
                                                
                                                   (
                                                   
                                                      j
                                                      n
                                                   
                                                   ,
                                                   Δ
                                                   t
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                
                                                   V
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      1
                                                   
                                                   −
                                                   
                                                      j
                                                      1
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      X
                                                      n
                                                   
                                                   −
                                                   
                                                      j
                                                      n
                                                   
                                                   )
                                                
                                                
                                                
                                                for
                                                
                                                t
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                m
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Using Eqs. (12) and (13) we can determine the Bellman equation for this dynamic pricing model, which maximizes the total expected revenue in each period of time given the immediate reward R(t, P
                           
                              i1, P
                           
                              i2, …, Pin
                           ) for choosing the price Pik
                            for fare family k and the expected revenue received in the following epochs, till the end of the selling period. The equation is define as:

                              
                                 (14)
                                 
                                    
                                       
                                          
                                          
                                          
                                             
                                                
                                                   V
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      X
                                                      1
                                                   
                                                   ,
                                                   
                                                      X
                                                      2
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      X
                                                      n
                                                   
                                                   )
                                                
                                                =
                                                m
                                                a
                                                
                                                   x
                                                   
                                                      {
                                                      
                                                         P
                                                         
                                                            i
                                                            1
                                                         
                                                      
                                                      ,
                                                      
                                                         P
                                                         
                                                            i
                                                            2
                                                         
                                                      
                                                      ,
                                                      …
                                                      ,
                                                      
                                                         P
                                                         
                                                            i
                                                            n
                                                         
                                                      
                                                      }
                                                   
                                                
                                                
                                                   {
                                                   R
                                                
                                                
                                                   (
                                                   t
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      P
                                                      
                                                         i
                                                         n
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                +
                                                
                                                E
                                                (
                                                
                                                   V
                                                   
                                                      t
                                                      +
                                                      1
                                                   
                                                
                                                |
                                                
                                                   P
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                ,
                                                
                                                   P
                                                   
                                                      i
                                                      2
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   P
                                                   
                                                      i
                                                      n
                                                   
                                                
                                                )
                                                }
                                                
                                                for
                                                
                                                t
                                                =
                                                1
                                                ,
                                                …
                                                ,
                                                m
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We solve this problem using backward induction (Puterman, 2005), taking into account that the total number of decisions in each time epoch depends on the number of fare families and the number of initial available seats to sell. Recalling that S is the set of states, let |S| be the size of S, and |E| is the size of the set of decision epochs E. Also, let |St
                           | be the number of states in the epoch t, then the number of total decisions can be calculated with the following equation:

                              
                                 (15)
                                 
                                    
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             E
                                          
                                       
                                       
                                          |
                                       
                                       
                                          S
                                          t
                                       
                                       
                                          |
                                          =
                                       
                                       
                                          (
                                          
                                             ∏
                                             
                                                i
                                                ∈
                                                C
                                                l
                                                a
                                                s
                                                s
                                                e
                                                s
                                             
                                          
                                          
                                             (
                                             A
                                             
                                                U
                                                i
                                             
                                             −
                                             1
                                             )
                                          
                                          −
                                          1
                                          )
                                       
                                       
                                          (
                                          |
                                          E
                                          |
                                          −
                                          1
                                          )
                                       
                                       +
                                       1
                                    
                                 
                              
                           
                        


                           Eq. (15) uses the following reasoning. In all the decision epochs except the first one, any combination of available seats is possible except when the remaining number of seats is 0 for all the fare families, in which case there is no decision to be made. In the first decision epoch there is only one combination of seats, i.e., all the capacity is available.

The proposed dynamic pricing model depends heavily on the estimation of ticketing and buying probabilities, which in reality can possess any shape of density function. In the next section we introduce a methodology to estimate these distributions, by a family of continuous distributions called continuous PH distribution.

Each of fare families has a ticketing and buying probability distribution which can possess any shape. So a distribution has to be fitted for each of these behaviors. To do this, we present the PH distributions as a possible method to fit the ticketing and buying probabilities because of their useful properties to fit unconventional forms and their flexibility to describe rugged and multimodal data distributions. In this section we define the PH family of distributions and discuss their useful properties in fitting data from the airline industry.

The PH family of distributions is the combination of exponential distributions that can fit a variety of behaviors, including those that are not conventional (Ross, 2007). A PH distribution is defined as a Continuous Time Markov Chain (CMTC) with space of states S = {1, 2, 3, …, a, 0}, where the first a phases are transient and 0 is the absorbent state. Being a CMTC, the time spent in each of the transient states follows an exponential distribution (Latouche and Ramaswami, 1999). The most well-known PH distribution besides the exponential, is the Erlang distribution, which is a combination of a exponential distributions in series, with the same rate.

PH distributions are commonly defined by two characteristic matrices (Latouche and Ramaswami, 1999). The first matrix is the vector 
                        
                           τ
                           →
                        
                      that represents the initial vector of probabilities. The value in position j on 
                        
                           τ
                           →
                        
                      represents the probability that the movement in the absorbing CTMC begins in state j or phase j of the distribution. The other matrix is the matrix of transition probabilities denoted as T. This matrix contains the rates of going from one phase to the other before the chain is absorbed. With these matrices the cumulative distribution function of a PH random variable is defined as:

                        
                           (16)
                           
                              
                                 F
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 1
                                 −
                                 
                                    
                                       τ
                                       →
                                    
                                    ′
                                 
                                 
                                    e
                                    
                                       T
                                       x
                                    
                                 
                                 
                                    1
                                    →
                                 
                                 
                                 ,
                              
                           
                        
                     where eTx
                      is defined as:

                        
                           (17)
                           
                              
                                 
                                    e
                                    
                                       T
                                       x
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       k
                                       =
                                       0
                                    
                                    ∞
                                 
                                 
                                    1
                                    
                                       k
                                       !
                                    
                                 
                                 
                                    
                                       (
                                       T
                                       x
                                       )
                                    
                                    k
                                 
                                 
                                 .
                              
                           
                        
                     
                  

As mentioned before, the most common PH distribution is the exponential distribution, which can be represented as a PH distribution with 1 phase. Consider an exponential distribution with parameter λ, then τ = [1] and T = [ − λ], so Eq. (16) transforms to the known cumulative distribution function of the exponential distribution, i.e., F(x) = 1 − e
                     −λx
                     . Now consider an Erlang distribution with parameter λ and a phases with the transition rate diagram shown in Fig. 2
                     , then the characteristic matrices for this distribution will be:

                        
                           (18)
                           
                              
                                 τ
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             1
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             0
                                          
                                       
                                    
                                    ]
                                 
                                 ,
                              
                           
                        
                     
                     
                        
                           (19)
                           
                              
                                 T
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             
                                                −
                                                λ
                                             
                                          
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             
                                                −
                                                λ
                                             
                                          
                                          
                                             λ
                                          
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                       
                                       
                                          
                                             ⋮
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋱
                                          
                                          
                                             ⋮
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                −
                                                λ
                                             
                                          
                                          
                                             λ
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             ⋯
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                −
                                                λ
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 .
                              
                           
                        
                     
                  

According to the type of PH distribution used, different behaviors such as high variability, long tails, and sharp tails can be modeled (Perez and Riaño, 2007). Different algorithms are proposed to fit the most appropriate PH distribution to empirical data, where the results of the algorithm are the vector 
                        
                           τ
                           →
                        
                      and the matrix T. These algorithms can be divided into four groups: moment matching, maximum likelihood estimate (Perez and Riaño, 2007), nonlinear programming (Johnson and Taaffe, 1990), and minimum distance algorithms (Parr and Shucanny, 1979). Most of the algorithms in the literature are focused on the first two approaches, which are easier to implement and have satisfactory results (Perez and Riaño, 2007), which we will discuss in the next section.


                        Perez and Riaño (2007) study a wide range of PH fitting algorithms. They test different algorithms with different types of data and evaluate the performance of each one. For the maximum likelihood algorithms they test an Expectation-Maximization (EM) Phase algorithm (Asmussen, Nerman, and Olsson, 1996), an EM Hyper-Exponential algorithm (Khayari, 2003), and an EM Hyper-Erlang (HE) algorithm (Thummler, Buchholz and Telek, 2005). For the moment matching algorithms they test an Acyclic continuous PH Distribution with two phases (ACPH2) (Telek and Heindl, 2003), a general ACPH (Bobbio et al., 2003; Bobbio, Horvath, and Telek, 2005), and an Erlang–Coxian distribution (Osogami and Harchol-Balter, 2003). The algorithms that give the best results in terms of goodness-of-fit are: the EM Hyper-Erlang, ACPH, and the Coxian distribution.

The HE distribution is a distribution that combines m Erlang distributions, each of which called a root. Each root i has a probability Pri
                         to take up the movement in the CTMC. Each of these Erlang distributions can have a number of phases ai
                         and rate λi
                        . Fig. 3
                        shows a graphic representation for this type of distributions.

The ACPH presented by Bobbio, Horvath, and Telek (2005) is a distribution that combines an exponential phase with rate λ and an Erlang distribution with rate μ and a phases. Depending on the value of the moments of the data that are fitted, the ACPH is represented differently. Let Pr be the probability of going to the first phase of the ACPH distribution, then in Fig. 4
                        we show the two graphic representations of this type of distributions.


The Coxian PH distribution presented by Osogami and Harchol-Balter (2003) also combines the exponential and Erlang distributions. In this case, there is a probability Pr to go first to the Erlang phase with rate λ and a phases, then it directly goes to an exponential phase with rate λ
                        1, and finally a probability Pr
                        1 to go to an exponential phase with rate λ
                        2. In Fig. 5
                        we show the graphic representation of this type of distributions.

To show the performance of these fitting algorithms, we fit industry data on ticketing and buying probabilities using these algorithms. This dataset consists of data of bookings for flights with the same leg and flight number for a period of six months. In this dataset there is information of when the booking was performed, when was the actual flight date, in which fare family and class the ticket was bought, and at which price it was bought. In total, there are around 16,000 bookings in the data set. First we apply the HE algorithm (Thummler, Buchholz and Telek, 2005) for the ticketing distribution, which we divided by month and fare family. The fitted HE distribution to the dataset for the month of October is shown in Fig. 6
                        .


To measure the goodness-of-fit of the resulting HE distribution we estimate the error between this distribution and the data as the mean value of the absolute difference of the two distributions at various chosen data points along the density function curve as:

                           
                              (20)
                              
                                 
                                    Error
                                    =
                                    
                                       
                                          
                                             ∑
                                             
                                                i
                                                =
                                                1
                                             
                                             n
                                          
                                          
                                             |
                                             
                                                X
                                                
                                                   R
                                                   i
                                                
                                             
                                             −
                                             
                                                X
                                                
                                                   P
                                                   
                                                      H
                                                      i
                                                   
                                                
                                             
                                             |
                                          
                                       
                                       n
                                    
                                    ,
                                 
                              
                           
                        where 
                           
                              X
                              
                                 R
                                 i
                              
                           
                         is the value at price i of the real data and 
                           
                              X
                              
                                 P
                                 
                                    H
                                    i
                                 
                              
                           
                         is the value at price i of the fitted PH distribution.

In Table 1
                        we show the average error for each of the six months, using Eq. (20). All the errors in this table are relatively small, indicating adequate fitting. This result is somewhat expected since all of these datasets contain over 1000 data points and the HE algorithm is shown to work better with larger sets of data (Perez and Riaño, 2007). When fewer data are available other algorithms must be applied.

After fitting the ticketing distribution, we now focus on the inter-arrival time distribution of bookings, using the same dataset but with data divided into classes for each month. Fig. 7
                        shows the fitting for class Y, a high price class for the economy cabin, using the HE algorithm. The errors for different classes are shown in Table 2
                        .


Comparing Tables 1 and 2 shows that with fewer data, the HE algorithm does not work satisfactorily, in terms of the fitting error. To overcome this problem, one possible solution is to group the classes by fare families as a fare family is a combination of classes, all of which offering the same product but with different prices. But even grouping the classes in fare families, the amount of data is considerably small for some of these fare families. Therefore we also test the grouped data with the Coxian (Osogami and Harchol-Balter, 2003) and the ACPH (Bobbio, Horvath, and Telek, 2005) algorithms which tend to find a feasible fit with few data. To test the ACPH algorithm we use ACPH distributions with different number of states. In Fig. 8
                        we show the results of testing the data divided by fare families. These data represent the month of October for a certain domestic flight.

As Fig. 8 shows, the errors of the Coxian and the ACPH fittings are lower than the HE algorithm for Fare Family 1 (FF1). This example shows that each of the fitting algorithms performs differently depending on the data. Therefore, it is critical to test various algorithms to find an appropriate fit for the particular data set under consideration.

In conclusion, and based on the experimentation shown in this section the PH family of distributions is a good alternative to approximate the empirical data on inter-arrival time and ticketing distributions when the data do not closely fit any of the conventional distributions. Given the fitted distributions of ticketing and buying probabilities, we can now model the counting process {N(Δt), t > =0}, to estimate Prk
                        (N(Δt) = l). To this end we apply renewal processes as described in the next section.

The renewal process {N(t), t ≥ 0} is a counting process, where the Poisson process is a specific case (Ross, 2007). The Poisson process is used to calculate the probability that n events happen during a period of time t, where the inter-arrival times of these events follow an exponential distribution. The renewal process allows any general distribution for the inter-arrival times and calculates the same probability of n events happening during time period t. The renewal process can be defined in the following way: Let F(t) be the cumulative distribution function of the inter-arrival times of events and Fn
                        (t) the cumulative distribution of the sum of n of such distributions, also called the n-fold convolution of the distribution with itself (Ross, 2007). Then the probability that n events take place in a period t is:

                           
                              (21)
                              
                                 
                                    P
                                    r
                                    
                                       (
                                       N
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       n
                                       )
                                    
                                    =
                                    
                                       F
                                       n
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    −
                                    
                                       F
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    .
                                 
                              
                           
                        
                     

To estimate Eq. (21) 
                        Latouche and Ramaswami (1999) propose an exact solution by applying a uniformization to the PH distributions. Using the matrices T and 
                           
                              τ
                              →
                           
                         of the PH distribution they define Pr(n, t) as the matrix of probabilities where Prij
                        (n, t) is the probability that n events occur in time t and being in state j, given that at the time 0 the movement of the chain begins in state i. Therefore, the probability of n arrivals in a period of time t is:

                           
                              (22)
                              
                                 
                                    P
                                    r
                                    
                                       (
                                       N
                                       
                                          (
                                          t
                                          )
                                       
                                       =
                                       n
                                       )
                                    
                                    =
                                    
                                       τ
                                       →
                                    
                                    P
                                    r
                                    
                                       (
                                       n
                                       ,
                                       t
                                       )
                                    
                                    
                                       1
                                       →
                                    
                                    
                                    .
                                 
                              
                           
                        
                     

With this method, we can estimate Prk
                        (N(Δt) = l) which is the main component to estimate the buying probability. Having explained the estimation of these probabilities, in the next section we present different structural properties that our proposed dynamic model possesses. This helps us understand how the results behave depending on the number of available seats and the decision taken.

The dynamic pricing model discussed in this paper recommends the optimal choice of price depending on the behavior of the customers, for each fare family. To understand the dynamics of this decision process, we first study the behavior of the value function based on the decision taken. To this end we examine the shape of the value function after discussing the effect of changes in price, for which first we need to understand how the buying probability shown in Eq. (9) changes when the price varies. Then we show that an optimal policy exists to maximize the total revenue over a finite horizon. The following propositions show the behavior of this probability and the existence of an optimal policy:

                        Proposition 1
                        
                           Let P
                           1 
                           and P
                           2 
                           be two available prices for a particular fare family where P
                           1 < P
                           2 
                           then g(P
                           1) > g(P
                           2).

Using Eq. (5) we know that 
                              
                                 g
                                 
                                    (
                                    
                                       P
                                       1
                                    
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          P
                                          1
                                       
                                    
                                    ∞
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    d
                                    x
                                 
                              
                            then 
                              
                                 g
                                 
                                    (
                                    
                                       P
                                       1
                                    
                                    )
                                 
                                 −
                                 g
                                 
                                    (
                                    
                                       P
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          P
                                          1
                                       
                                    
                                    ∞
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    d
                                    x
                                 
                                 −
                                 
                                    ∫
                                    
                                       
                                          P
                                          2
                                       
                                    
                                    ∞
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    d
                                    x
                                 
                              
                           . Therefore 
                              
                                 g
                                 
                                    (
                                    
                                       P
                                       1
                                    
                                    )
                                 
                                 −
                                 g
                                 
                                    (
                                    
                                       P
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       
                                          P
                                          1
                                       
                                    
                                    
                                       P
                                       2
                                    
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    d
                                    x
                                 
                                 >
                                 0
                                 ,
                              
                            hence g(P
                           1) > g(P
                           2).□


                           Let P
                           1 
                           and P
                           2 
                           be two available prices for a particular fare family where P
                           1 < P
                           2 
                           then Pr(j, Δt, P
                           1) > Pr(j, Δt, P
                           2).

Consider the following difference, Pr(j, Δt, P
                           1) − Pr(j, Δt, P
                           2). Using Eq. (8) we know that 
                              
                                 P
                                 r
                                 
                                    (
                                    j
                                    ,
                                    Δ
                                    t
                                    ,
                                    
                                       P
                                       1
                                    
                                    )
                                 
                                 −
                                 P
                                 r
                                 
                                    (
                                    j
                                    ,
                                    Δ
                                    t
                                    ,
                                    
                                       P
                                       2
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    P
                                    
                                       r
                                       k
                                    
                                    
                                       (
                                       N
                                       
                                          (
                                          Δ
                                          t
                                          )
                                       
                                       =
                                       l
                                       )
                                    
                                    
                                       (
                                       
                                          l
                                          j
                                       
                                       )
                                    
                                    
                                       (
                                       g
                                       
                                          
                                             (
                                             
                                                P
                                                1
                                             
                                             )
                                          
                                          j
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             g
                                             
                                                (
                                                
                                                   P
                                                   1
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             l
                                             −
                                             j
                                          
                                       
                                       −
                                       g
                                       
                                          
                                             (
                                             
                                                P
                                                2
                                             
                                             )
                                          
                                          j
                                       
                                       
                                          
                                             (
                                             1
                                             −
                                             g
                                             
                                                (
                                                
                                                   P
                                                   2
                                                
                                                )
                                             
                                             )
                                          
                                          
                                             l
                                             −
                                             j
                                          
                                       
                                       )
                                    
                                 
                              
                           . Since Prk
                           (N(Δt) = l) and 
                              
                                 (
                                 
                                    l
                                    j
                                 
                                 )
                              
                            are always positive, we only need to consider (g(P
                           1)
                              j
                           (1 − g(P
                           1))
                              l − j
                            − g(P
                           2)
                              j
                           (1 − g(P
                           2))
                              l − j
                           ). Looking at the limits of the sum, we have that 
                              
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       g
                                    
                                    
                                       
                                          (
                                          
                                             P
                                             1
                                          
                                          )
                                       
                                       j
                                    
                                    
                                       (
                                       1
                                       −
                                    
                                 
                              
                            
                           g(P
                           1))
                              l − j
                            − g(P
                           2)
                              j
                           (1 − g(P
                           2))
                              l − j
                           ) is equal to 
                              
                                 g
                                 
                                    
                                       (
                                       
                                          P
                                          1
                                       
                                       )
                                    
                                    j
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       g
                                       
                                          (
                                          
                                             P
                                             1
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       l
                                       −
                                       j
                                    
                                 
                                 −
                                 g
                                 
                                    
                                       (
                                       
                                          P
                                          2
                                       
                                       )
                                    
                                    j
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       g
                                       
                                          (
                                          
                                             P
                                             2
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       l
                                       −
                                       j
                                    
                                 
                              
                           . Now, since 1 − g(Pi
                           ) < 1 for any price Pi
                           , then these sums are geometric series, hence 
                              
                                 g
                                 
                                    
                                       (
                                       
                                          P
                                          1
                                       
                                       )
                                    
                                    j
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       g
                                       
                                          (
                                          
                                             P
                                             1
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       l
                                       −
                                       j
                                    
                                 
                                 −
                                 g
                                 
                                    
                                       (
                                       
                                          P
                                          2
                                       
                                       )
                                    
                                    j
                                 
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    
                                       (
                                       1
                                       −
                                       g
                                       
                                          (
                                          
                                             P
                                             2
                                          
                                          )
                                       
                                       )
                                    
                                    
                                       l
                                       −
                                       j
                                    
                                 
                                 =
                                 g
                                 
                                    
                                       (
                                       
                                          P
                                          1
                                       
                                       )
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 −
                                 g
                                 
                                    
                                       (
                                       
                                          P
                                          2
                                       
                                       )
                                    
                                    
                                       j
                                       −
                                       1
                                    
                                 
                                 ,
                              
                            which is positive using Proposition 1. Then Pr(j, Δt, P
                           1) − Pr(j, Δt, P
                           2) > 0 and Pr(j, Δt, P
                           1) > Pr(j, Δt, P
                           2).□

These two propositions show that when the price increases the probability of buying decreases, implying that there should be a price Pi
                      where the maximum revenue is reached. But to prove that this price exists we need to show that the lim
                        P → ∞
                     R(t, P) = 0, where for just one fare family 
                        
                           R
                           
                              (
                              t
                              ,
                              P
                              )
                           
                           =
                           P
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              X
                           
                           
                              j
                              P
                              r
                              (
                              j
                              ,
                              Δ
                              t
                              ,
                              P
                              )
                           
                        
                     . Expanding this equation the limit becomes 
                        
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              X
                           
                           
                              j
                              
                                 ∑
                                 
                                    l
                                    =
                                    j
                                 
                                 ∞
                              
                              
                                 P
                                 
                                    r
                                    k
                                 
                                 
                                    (
                                    N
                                    
                                       (
                                       Δ
                                       t
                                       )
                                    
                                    =
                                    l
                                    )
                                 
                                 
                                    (
                                    
                                       l
                                       j
                                    
                                    )
                                 
                                 
                                    (
                                    
                                       lim
                                       
                                          P
                                          →
                                          ∞
                                       
                                    
                                    P
                                    g
                                    
                                       
                                          (
                                          P
                                          )
                                       
                                       j
                                    
                                    
                                       
                                          (
                                          1
                                          −
                                          g
                                          
                                             (
                                             P
                                             )
                                          
                                          )
                                       
                                       
                                          l
                                          −
                                          j
                                       
                                    
                                    )
                                 
                              
                           
                        
                     . The following two propositions are shown to prove this:

                        Proposition 3
                        
                           Let P be an available price for a particular fare family then lim
                              P → ∞
                           Pg(P) = 0.

First consider 
                              
                                 g
                                 
                                    (
                                    P
                                    )
                                 
                                 =
                                 
                                    ∫
                                    
                                       P
                                    
                                    ∞
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    d
                                    x
                                 
                                 ,
                              
                            for which f(x) is estimated with a PH distribution. Then, using Eq. (16), 
                              
                                 g
                                 
                                    (
                                    P
                                    )
                                 
                                 =
                                 1
                                 −
                                 F
                                 
                                    (
                                    P
                                    )
                                 
                                 =
                                 
                                    
                                       τ
                                       →
                                    
                                    ′
                                 
                                 
                                    e
                                    
                                       T
                                       P
                                    
                                 
                                 
                                    1
                                    →
                                 
                              
                            and because F(x) is the cumulative distribution function, then lim
                              P → ∞
                           F(P) = 1 and lim
                              P → ∞
                           g(P) = 0. Now, 
                              
                                 
                                    lim
                                    
                                       P
                                       →
                                       ∞
                                    
                                 
                                 
                                    P
                                    g
                                    
                                       (
                                       P
                                       )
                                    
                                    =
                                    P
                                    
                                       
                                          τ
                                          →
                                       
                                       ′
                                    
                                    
                                       e
                                       
                                          T
                                          P
                                       
                                    
                                    
                                       1
                                       →
                                    
                                 
                              
                            where it is clearly seen that g(P) decreases faster compared to the increase of P, because g(P) has an exponential component in its expression. Then lim
                              P → ∞
                           Pg(P) = 0.□


                           Let P be an available price for a particular fare family then lim
                              P → ∞
                           PPr(j, Δt, P) = 0.

lim
                              P → ∞
                           PPr(j, Δt, P) = 0 is equal to 
                              
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    P
                                    
                                       r
                                       k
                                    
                                    
                                       (
                                       N
                                       
                                          (
                                          Δ
                                          t
                                          )
                                       
                                       =
                                       l
                                       )
                                    
                                    
                                       (
                                       
                                          l
                                          j
                                       
                                       )
                                    
                                 
                              
                            (lim
                              P → ∞
                           Pg(P)
                              j
                           (1 − g(P))
                              l − j
                           ). Knowing that 
                              
                                 
                                    lim
                                    
                                       P
                                       →
                                       ∞
                                    
                                 
                                 g
                                 
                                    (
                                    P
                                    )
                                 
                                 =
                                 
                                    lim
                                    
                                       P
                                       →
                                       ∞
                                    
                                 
                                 
                                    ∫
                                    
                                       P
                                    
                                    ∞
                                 
                                 
                                    f
                                    (
                                    x
                                    )
                                    d
                                    x
                                 
                                 =
                                 0
                                 ,
                              
                            hence lim
                              P → ∞(1 − g(P))
                              l − j
                            = 1 and using Proposition 3 lim
                              P → ∞
                           Pg(P)
                              j
                            = 0, then lim
                              P → ∞
                           PPr(j, Δt, P) = 0.□

Then 
                        
                           
                              lim
                              
                                 P
                                 →
                                 ∞
                              
                           
                           
                              R
                              
                                 (
                                 t
                                 ,
                                 P
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    j
                                    =
                                    0
                                 
                                 X
                              
                              
                                 j
                                 
                                    ∑
                                    
                                       l
                                       =
                                       j
                                    
                                    ∞
                                 
                                 
                                    P
                                    
                                       r
                                       k
                                    
                                    
                                       (
                                       N
                                       
                                          (
                                          Δ
                                          t
                                          )
                                       
                                       =
                                       l
                                       )
                                    
                                    
                                       (
                                       
                                          l
                                          j
                                       
                                       )
                                    
                                 
                              
                           
                           
                              (
                           
                           
                              lim
                              
                                 P
                                 →
                                 ∞
                              
                           
                           P
                           g
                           
                              
                                 (
                                 P
                                 )
                              
                              j
                           
                        
                     
                     
                        
                           
                              
                                 (
                                 1
                                 −
                                 g
                                 
                                    (
                                    P
                                    )
                                 
                                 )
                              
                              
                                 l
                                 −
                                 j
                              
                           
                           
                              )
                              =
                           
                           
                              ∑
                              
                                 j
                                 =
                                 0
                              
                              X
                           
                           j
                           
                              ∑
                              
                                 l
                                 =
                                 j
                              
                              ∞
                           
                        
                     
                     
                        
                           
                              P
                              
                                 r
                                 k
                              
                              
                                 (
                                 N
                                 
                                    (
                                    Δ
                                    t
                                    )
                                 
                                 =
                                 l
                                 )
                              
                              
                                 (
                                 
                                    l
                                    j
                                 
                                 )
                              
                              0
                           
                           =
                           0
                           ,
                        
                      meaning that when the price tends to infinity the revenue received tends to 0. Finally having this result, we can study the shape of the value function. To explore this, we create an example of the value function using one fare family, 10 available seats, a Δt of 2, a Poisson distribution with parameter equal to 1 as the arrival process, and as the distribution g(p) we use g(P) = e
                     −P/100. The results of the total expected revenue are shown in Fig. 9
                     .


As seen in Fig. 9 the total expected revenue as a function of price is convex in a range of prices and concave in another range. However, as shown in Proposition 4, increasing the price to infinity makes the value of the total expected revenue tend to zero. On the other hand there is a minimum value for the price of any ticket, that can be 0, so at least one price exists that maximizes this problem.

We use backward induction as the proposed algorithm to solve this problem. Because there exists a price that maximizes the problem for each fare family, Proposition 5 shows that there exists at least one optimum policy that maximizes the dynamic pricing problem. Bertesaks (2000) proposes a proposition for the deterministic dynamic programming model, we use this methodology to prove Proposition 5:

                        Proposition 5
                        
                           Consider a stochastic dynamic pricing problem with Vt
                           (X
                           1, X
                           2, …, Xn
                           ) as the total expected revenue and 1 ≤ t ≤ m. Assume that for each fare family there is a pool of prices to choose from. Let
                           
                              
                                 π
                                 t
                                 *
                              
                            
                           be the optimal policy that maximizes the revenue for period t, then this
                           
                              
                                 π
                                 t
                                 *
                              
                            
                           exist for 1 ≤ t ≤ m.

The proof is done by induction. So let t = m then, as concluded through Propositions 1–4, there exists a price that maximizes the revenue for fare family k. Then for state X
                           1, X
                           2, …, Xn
                            which represents the available seats for each fare family, there is an optimal policy 
                              
                                 
                                    π
                                    m
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    
                                       X
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       P
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    
                                       P
                                       
                                          i
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       P
                                       
                                          i
                                          n
                                       
                                    
                                    )
                                 
                              
                            where if 
                              
                                 
                                    V
                                    m
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          m
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                              
                            is the value of the total expected revenue evaluated with the optimal policy, then 
                              
                                 
                                    V
                                    m
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          m
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                                 ≥
                                 
                                    V
                                    m
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          m
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                              
                            for any other policy πm
                           (X
                           1, X
                           2, …, Xn
                           ). Then 
                              
                                 
                                    V
                                    m
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          m
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    V
                                    m
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    
                                       X
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                              
                            where 
                              
                                 
                                    V
                                    m
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    
                                       X
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                              
                            is the optimal value of the expected revenue for state X
                           1, X
                           2, …, Xn
                           . Let 
                              
                                 π
                                 m
                                 *
                              
                            be the pool of optimal policies for each combination of possible available prices in t = m. Now let t = m − 1 and 
                              
                                 
                                    V
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                                 =
                                 m
                                 a
                                 
                                    x
                                    
                                       {
                                       
                                          P
                                          
                                             i
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          P
                                          
                                             i
                                             n
                                          
                                       
                                       }
                                    
                                 
                                 
                                    {
                                    R
                                    
                                       (
                                       m
                                       −
                                       1
                                       ,
                                       
                                          P
                                          
                                             i
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          P
                                          
                                             i
                                             n
                                          
                                       
                                       )
                                    
                                    +
                                    E
                                    
                                       (
                                       
                                          V
                                          m
                                       
                                       |
                                       
                                          P
                                          
                                             i
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          P
                                          
                                             i
                                             n
                                          
                                       
                                       )
                                    
                                    }
                                 
                              
                           . Then, as concluded through Propositions 1–4, there exists at least a set of prices (P
                           
                              i1, …, Pin
                           ) that maximizes R(m − 1, P
                           
                              i1, …, Pin
                           ). Then we define 
                              
                                 
                                    π
                                    
                                       m
                                       −
                                       1
                                    
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       P
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       P
                                       
                                          i
                                          n
                                       
                                    
                                    ,
                                    
                                       π
                                       m
                                       *
                                    
                                    )
                                 
                              
                            as the optimal policy and knowing that 
                              
                                 π
                                 m
                                 *
                              
                            is the set of optimal policies in t = m, then 
                              
                                 
                                    V
                                    
                                       m
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          
                                             m
                                             −
                                             1
                                          
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                                 ≥
                                 
                                    V
                                    
                                       m
                                       −
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    
                                       X
                                       2
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                                 
                                    
                                       π
                                       
                                          m
                                          −
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                 
                              
                            for any other policy π
                           
                              m − 1(X
                           1, X
                           2, …, Xn
                           ). Finally, assuming that this holds for t = j + 1 and that 
                              
                                 
                                    π
                                    
                                       j
                                       +
                                       1
                                    
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       P
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       P
                                       
                                          i
                                          n
                                       
                                    
                                    ,
                                    
                                       π
                                       
                                          j
                                          +
                                          2
                                       
                                       *
                                    
                                    )
                                 
                              
                            is the optimal policy for V
                           
                              j + 1(X
                           1, X
                           2, …, Xn
                           ), then in t = j, as concluded through Prepositions 1–4, and the same methodology of t = m − 1, we define 
                              
                                 
                                    π
                                    
                                       j
                                    
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       1
                                    
                                    ,
                                    …
                                    ,
                                    
                                       X
                                       n
                                    
                                    )
                                 
                                 =
                                 
                                    (
                                    
                                       P
                                       
                                          i
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       P
                                       
                                          i
                                          n
                                       
                                    
                                    ,
                                    
                                       π
                                       
                                          j
                                          +
                                          1
                                       
                                       *
                                    
                                    )
                                 
                              
                            as the optimal policy where 
                              
                                 
                                    V
                                    j
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          
                                             j
                                          
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                                 ≥
                                 
                                    V
                                    j
                                 
                                 
                                    
                                       (
                                       
                                          X
                                          1
                                       
                                       ,
                                       
                                          X
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          X
                                          n
                                       
                                       )
                                    
                                    
                                       
                                          π
                                          j
                                       
                                       
                                          (
                                          
                                             X
                                             1
                                          
                                          ,
                                          
                                             X
                                             2
                                          
                                          ,
                                          …
                                          ,
                                          
                                             X
                                             n
                                          
                                          )
                                       
                                    
                                 
                              
                            for any other policy πj
                           (X
                           1, X
                           2, …, Xn
                           ). This proves by induction that the optimal policy exists.□


                     Proposition 5 shows that the optimal policy exists for our proposed dynamic pricing model. However, this policy may not be unique and for a given problem various policies may result in the same optimal value of the total expected revenue. In the next section we proceed to present numerical results on a variety of scenarios and a case with real data to illustrate the performance of our proposed model, along with further structural properties of these results, involving the behavior of the price depending on the changes in available seats and days prior to the departure date.

In this section we examine the performance of our proposed approach on a series of created scenarios and a real-world case study. For each scenario and the case study we first present the results for fitting the distributions of inter-arrival time of bookings and the ticketing probability with appropriate PH distributions. Then we present the results of the dynamic pricing model for some proposed scenarios and analyze how the parameters of each scenario affect the computational time of the algorithm. We will show that the recommended decisions of our model follow a specific behavior in the scenarios and in the case study. Finally we will show that our proposed policies considerably improve the revenue compared to the real world pricing policies adopted for this case study.

To test the dynamic pricing model we create six scenarios with data generated from exponential and lognormal families of distributions for both the buying probability and inter-arrival times, except Scenario 3 where we use real industry data for the buying distribution. The parameters for each scenario are shown in Table 3
                        , where the time interval between each epoch, Δt, is equal to 2 days. The main difference between each of the scenarios is the number of states, which depends on the number of decision periods (epochs) and the number of seats initially available for sale (AU). Scenario 1, Scenario 2, and Scenario 4 use exponential distributions for both probability distributions of ticketing and buying. This is done to test only the dynamic pricing algorithm and exclude the PH fitting algorithm. So each of the other parameters of the model, decision epochs and available seats, vary to test the difference in computational time in the dynamic pricing algorithm. Scenario 3 is used to test the PH fitting algorithm for only one of the probability distributions. On the other hand, Scenarios 5 and 6 are used to test the performance of the PH fitting algorithms for both the arrival and buying distributions and observe how other variables such as the parameters of the distribution could affect the computational time.

We first fit the data on buying and inter-arrival time between bookings in each scenario by an appropriate PH distribution as described in Section 3, with the exception of the cases where data follow an exponential distribution, which is the most basic form of a PH distribution with only one phase.

Again, Scenarios 5 and 6 are used to test the PH fitting algorithms for the inter-arrival time probability and the buying probability. In particular, as shown in Table 4
                        , in Scenario 5 the inter-arrival time distribution is lognormal, where it has a mean value of 300 and a variance of 10,000. The error, calculated with Eq. (20) shows to be 0.0049, which is relatively small. For all the other lognormal distributions used in Scenarios 5 and 6, the errors were also in the same magnitude, as shown in Table 4.

The results in Table 4 show that for each of the lognormal distributions used, the fitting algorithm finds a feasible PH distribution that has a reduced error, where the Erlang distribution fitted best to all the cases. After fitting the distributions of ticketing and the inter-arrival time of bookings with the appropriate PH equivalents, we test the proposed dynamic pricing model in every scenario, as discussed in the next section.

We run the dynamic pricing model for each of the scenarios in Table 3. The results show the prices to be fixed for each fare family in each period of time. For example, the results of Scenario 4 for a particular decision period are presented in Table 5
                        . This scenario assumes 2 fare families, 10 decision epochs, 10 available seats for the higher fare family, where each seat can be sold at a price of 150, 200, or 300, and 20 available seats for the lowest fare family, where each seat can be sold at a price of 50, 100, or 175. In the columns of Table 5 we have the remaining seats of the high cost fare family and on the rows we have the remaining seats of the low cost fare family. In the body of the table, the first price shown in parentheses is that of the higher fare family and the second is that of the lower fare family. When either of the two fare families has zero seats available (or zero capacity) then the price shown is that of the fare family with available seats. Table 6
                        shows a different behavior, that represents what happens when the seats are not sold throughout the selling period. In this table we denote fare family as FF. When the seats are not sold the price tends to decrease, to attract more customers at the final epochs and at least receive some additional revenue. For example for FF 1, from 12 days to 10 days before departure, the price is reduced from 300 to 200.

Through Tables 5 and 6 we can observe some interesting behavior. If a low number of seats remain available, then the price is increased so the remaining seats can be sold at a higher price to take advantage of the maximum willingness-to-pay of the customer. If the number of seats remains the same, then the price decreases so at least some seats are sold and fewer empty seats remain at the departure date. In particular, Table 5 shows in bold the threshold line where the price changes for either one of the fare families. When the number of available seats decreases in either direction, the price tends to increase, increasing in this way the expected revenue received. On the other hand, if there are many seats available the price tends to be lower, increasing the probability of selling a seat, hence increasing the expected revenue. Table 6 shows that when the number of seats remains the same and there are fewer days prior to the departure date, the price decreases. Similar behavior is observed in all of the scenarios of Table 3.

To test the computational performance of our proposed model, we run each of the scenarios and in Table 7
                        we show the total computational time. The computational time is the performance of the algorithm (PH fitting when applicable, and solving the dynamic pricing model by backward induction) coded in MatLab and run on an Intel Core i3 of 2.10 gigahertz with 3 gigabytes of RAM.


                        Table 7 shows that the number of states affects the computation time, which is presented in seconds. The time taken to estimate the PH distribution is negligible compared to the time that it takes to estimate the whole algorithm. Estimating the transition probabilities by Eq. (11) takes the majority of time in this algorithm, which is affected by the behavior of input data and the number of classes. Looking at Scenarios 5 and 6 there is a relatively large difference in their computational times, although the number of states in both scenarios is the same. The main difference between them is the mean value and the standard deviation of the data. In this case, Scenario 5 has a mean value higher than Scenario 6. This affects the estimation of the probabilities because with a higher mean value, the HE fitting algorithm (Thummler, Buchholz and Telek, 2005) takes longer to reach its stopping criteria.

In this case study we use industry data for the month of October, using 31 domestic flights with the same characteristics, leg and flight number, divided into 3 fare families. This division is done such that the data are grouped by the type of product, suggesting the same behavior within a group. To test the performance of our model, we will compare our optimal price policy to that of the airline for these flights. The airline normally changes the price depending on the seats available in that moment but it does not take into account the effect of this change on the other periods of time. For example, a decision that the airline takes is to reduce the price to increase the revenue immediately, but this can result in the tickets to be sold at a lower price than what a customer is willing to pay in the following epochs. We will show that our proposed policy outperforms the current airline decisions.

Two types of input data are considered in this study. The first is the number of bookings per class with their corresponding price during the whole selling period, which is approximately one year. This information is taken for each fare family, and depending on the type of fare family, there can be between 600 and 3000 records in one month. The other type of data is the information on the arrival of bookings.

The number of seats in these flights is 138 in the economy cabin, divided into three fare families, 25 for the fare family with the highest prices, 38 for the medium fare, and 75 for the fare family with the lower price. For this case we exclude the executive cabin because the prices do not change significantly during the selling period. The number of decision periods is 10, since the bookings for a domestic flight begin closer to the departure date compared to an international flight. Then the total number of states where a decision is taken for this case study is approximately 690,000 states.

We fit the arrival and buying probability distributions of this case using the algorithms explained in Section 3. The results are shown in Table 8
                        . It can be seen that the fitting errors are relatively small, so we can assume that the chosen PH distributions fit the behavior of the real data well.

Most of the PH distributions that were used for the fitting were from the HE family of distributions. In particular, the fitting for the buying probability of Fare Family 1 is an HE distribution of 2 roots with 20 phases where the first root is an Erlang (0.071,12) and the second one is an Erlang (0.2387,8). Fig. 10
                        shows the graphical representation for this particular example.


We run the dynamic pricing model where we have as a result the decisions of the price at which to sell each seat for each fare family depending on the number of available seats and the epoch. In Table 9
                        we see a fragment of the complete set of results. In this table we fix the number of seats of the fare family with the highest price at a particular moment of time and change the number of seats available for the other two fare families. The total result is a table of 75X38 but with this fragment the results’ behavior is shown. The main observation of this case study is that the decisions follow the same behavior as shown in Table 5. When the number of available seats decreases then the prices increase and a threshold line can be established. For example, if we fix the period of time and the number of available seats of a particular fare family, we can see the behavior of the prices of the other fare families when the number of seats changes.

As the table shows, the price increases as we have less seats available. Blocks of prices are formed where the price does not change and threshold lines where the price changes. For example between 7 and 15 seats available for the medium fare family and from 53 to 59 seats available for the lower fare family there exists a block where the price is 100 for the medium fare family and 20 for the lower fare family. Surrounding this block, there is what we call a threshold line where the price changes for either or both of the fare families, highlighted in bold font. Take into account that we show the seats from 7 to 13 seats available in the same column for the higher fare family because the prices do not change between these two. For the airline, the threshold lines are the most important results, since they provide practical guidelines on when and how to change the price.

As for the results of the dynamic pricing model, the revenue is increased for 21 out of the 31 flights in the month. On average the revenue was increased by 31 percent for these flights over a month, making a higher profit than the current decisions of the airline. The revenue in our model was calculated with Eq. (14) applied in the first decision epoch to the state represented with the total capacity available for each fare family. This calculation of the revenue takes into account the policy that the model gives as the result, where this policy considers the effect of the price of the demand during all the selling period. The difference compared to the policies, as we mentioned before, is that the airline changes the price without taking into account what a customer is willing to pay in the following epochs. However, our model takes this effect into account.

For the other 10 flights where the revenue was not increased, we noticed that they were mostly on a weekend or a holiday, which shows that a segmentation of the demand may be needed. With a better segmentation, i.e., dividing the data into weekends and weekdays, we can find a policy that increments the revenue on the weekends as well.

Finally the total time taken to solve this problem was approximately 35 hours, taking into account that the specifications of the computer (as mentioned in Section 5.2) are lower than the servers of an airline. We should also take into account that the problem only needs to be run one time to calculate the decisions that optimize the revenue for the whole selling period.

@&#CONCLUSIONS AND FUTURE WORK@&#

In the airline industry fixing the price of a ticket can affect the demand in the future. Fixing a low price will force an increase in demand but also a loss in the expected revenue received. If a passenger is willing to pay more for a ticket than the actual price of the same ticket, then that difference in revenue is considered loss. On the other hand if a higher price is fixed then there exists a high chance that a seat flies empty, which is also a loss in the revenue. Therefore, in this paper we propose a dynamic pricing model to find the pricing policy which maximizes the total revenue of the flight, taking into account the trade-off between selling a seat underpriced or flying it empty. Most of the work on dynamic pricing in the literature assumes that the probability of buying follows a known distribution. This assumption may be unrealistic in practical settings as in many occasions empirical data do not follow a known distribution. In this paper we propose the application of phase type distributions to closely approximate empirical data.

The probability that a number of customers buy a previously booked ticket is affected by two behaviors. The first behavior is the arrival process of bookings where we use renewal processes to estimate this probability. The second behavior is the distribution of probability that at a certain price the customer buys a previously booked ticket. This probability is estimated with the number of bookings that become tickets at the end. The first prominent result of this work is that the phase type distributions fit the empirical data with noise or multimodality better than the standard distributions.

We test our proposed dynamic pricing model on different distributions and combination of seats, and observe reasonable results. By running our model, we find the prices for each fare family in each period of time to maximize the total expected revenue over the selling period. With these results, it is known when to increase or decrease the prices depending on the number of seats and the time left to departure. We prove that there exists at least one price that maximizes the total expected revenue and constantly increasing the price does not necessarily result in increasing the revenue. Furthermore, in the numerical results we show that the behavior of the price depending on the number of available seats is according to intuition. If many seats are sold then the prices rise and, on the other hand if the seats are not sold, then the prices decrease. The computational time for a common flight can take several hours on a personal computer but applying the model to an airline server will reduce the time. Also, since the model only runs one time for each flight and the results work for the whole selling period, we presume that the computational time is tolerable for this type of decision-making.

The case study presented in this paper shows an increase in revenue using our model, for 21 of the 31 flights in the month and on average the revenue is increased by 31 percent. The PH fitting algorithm fitted according to the behavior of the inter-arrival distribution of bookings and the ticketing probability. The fitting errors were not larger than 0.037, which is relatively low compared to fitting known distributions, such as the exponential distribution, to the same data.

To extend and improve this work, two main directions should be considered. The first is to reduce the computational time of the algorithm, which requires heuristics or methodologies such as approximate dynamic programming. Reducing the computational time will help find the optimum price policy for various flights at the same time. It also makes it possible to increase the number of decision epochs to have a more precise model. The second direction to be considered is to relax some of the assumptions of the dynamic pricing model, for example cancellations and overbooking, which will make the results closer to reality.

@&#REFERENCES@&#

