@&#MAIN-TITLE@&#Hub location under competition

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We proposed two competitive hub location models for the leader and follower.


                        
                        
                           
                           Investigated their computational complexities.


                        
                        
                           
                           Proposed mixed integer linear formulations for these problems.


                        
                        
                           
                           Proposed enumeration based solution algorithms for leader’s problem.


                        
                        
                           
                           Conducted computational experiments for both problems.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Hub location

Competition models

Competitive location

@&#ABSTRACT@&#


               
               
                  Hubs are consolidation and dissemination points in many-to-many flow networks. Hub location problem is to locate hubs among available nodes and allocate non-hub nodes to these hubs. The mainstream hub location studies focus on optimal decisions of one decision-maker with respect to some objective(s) even though the markets that benefit hubbing are oligopolies. Therefore, in this paper, we propose a competitive hub location problem where the market is assumed to be a duopoly. Two decision-makers (or firms) sequentially decide locations of their hubs and then customers choose one firm with respect to provided service levels. Each decision-maker aims to maximize his/her own market share. We propose two problems for the leader (former decision-maker) and follower (latter decision-maker): 
                        
                           (
                           r
                           |
                           
                              X
                              p
                           
                           )
                           h
                           u
                           b
                           −
                           m
                           e
                           d
                           i
                           a
                           n
                           o
                           i
                           d
                        
                      and 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      problems, respectively. Both problems are proven to be NP-complete. Linear programming models are presented for these problems as well as exact solution algorithms for the 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      problem. The performance of models and algorithms are tested by computational analysis conducted on CAB and TR data sets.
               
            

@&#INTRODUCTION@&#

Hubs are consolidation and dissemination points in many-to-many flow networks. Consolidation generates economies of scale and thus, unit transportation cost is discounted between hubs. Hubbing also reduces number of required links to ensure that each flow is routed to its desired destination. Hub networks are used in many applications in airline, cargo and telecom industries.

The hub location problem is to determine location of hubs and allocation of non-hub nodes to these hubs with respect to a given allocation structure and objective(s). A single decision-maker can determine locations of hubs depending on problem parameters such as amount of flow and unit transportation cost between each pair of nodes, interhub transportation discount factor, allocation strategy (single- or multiple-allocation), and structure of hub network (incomplete, star network etc.). In single-allocation case, whole flow originating from and destined to a node is routed via a unique hub. On the other hand, in multiple-allocation case, different hubs can be used to route different flows with same origin. However, in a competitive environment, a decision-maker should also consider decisions of his/her rivals and customer preferences. In this study, we consider a duopolistic market -a special case of oligopoly- where there are two operating firms. The decision-maker who makes the initial location decision is called leader and the other one is called as follower. We assume a multiple-allocation structure.

Then by combining retail location from marketing, spatial competition in economics and location theory in operations research, in this paper, we propose a discrete Stackelberg hub location problem where firms make sequential decisions. Each decision-maker (or firm) decides location of hubs and allocation of non-hub nodes to maximize their market share.

@&#LITERATURE REVIEW@&#

The pioneering study of competition in economics is due to Cournot (1838). He studied a market operated by two competing firms where each firm decides amount of production of a single product. Later, Bertrand (1883) considered a duopoly model where the competitors decide price of a single product. Hotelling (1929) presented the first competitive model that includes location decisions. He investigated location and price decisions of two ice cream vendors operating on a beach in which each customer prefers the vendor that offers lower price.

In duopoly models presented by Cournot (1838), Bertrand (1883) and Hotelling (1929), decisions of two firms are made simultaneously. Another streamline of research in competitive models deals with sequential decision making. The preliminary work of sequential decision making of location was first proposed in a book by Von Stackelberg (1951). Since sequential decisions result in an asymmetry between decision makers, we need to differentiate identities of the decision makers. Von Stackelberg (1951) studied a duopoly where the firm that makes the initial decision is called as leader and other one is called as follower. He suggested three major assumptions:

                           
                              •
                              Decisions are permanent.

Decisions are made sequentially.

The leader and the follower have full and complete knowledge about the system.

If leader’s decisions are given, follower makes decisions with respect to his/her own objective. These decisions are called reaction function of the follower. Since both parties have complete information of the system, the leader observes reaction function of the follower and hence the leader makes his/her decisions based on this reaction function. These leader–follower situations can be modeled as bilevel optimization problems. Bilevel optimization models consider the follower’s reaction function an input to the leader’s decisions. Bard (1999) and Dempe (2002) gave detailed discussion on bilevel programming models and solution techniques.


                        Teitz and Bart (1968) studied sequential location problem on a line segment. Moreover, Teitz and Bart (1968) considered an extension of Hotelling’s model by allowing each decision maker to locate more than one facility.


                        Drezner (1982) and Hakimi (1983) independently proposed sequential location problems with an OR point of view and attracted the community’s attention. They both studied same competitive model but with different spaces. While Drezner (1982) considered locations on a plane, Hakimi (1983) dealt with network models. Their problem includes a number of customers with inelastic demand, that is, amount of demand of each customer is known a priori and is not affected by the decisions of leader and follower. A customer prefers the closest facility to buy a homogenous product. The decision-makers act sequentially, that is, the leader locates p facilities and then the follower locates r facilities.

In order to describe contributions of Drezner (1982) and Hakimi (1983), the following conventions are necessary. Assume that n customers (or demand points) are located on points 
                           
                              V
                              =
                              {
                              
                                 v
                                 1
                              
                              ,
                              
                                 v
                                 2
                              
                              ,
                              …
                              ,
                              
                                 v
                                 n
                              
                              }
                           
                         with the demand of customer i being w(vi
                        ). For any subset of points Z⊆V, let 
                           
                              D
                              (
                              v
                              ,
                              Z
                              )
                              =
                              m
                              i
                              n
                              {
                              d
                              (
                              v
                              ,
                              z
                              )
                              :
                              z
                              ∈
                              Z
                              }
                           
                         where d(v, z) is the distance between v and z. The distance between two points is the Euclidean distance in a two-dimensional plane and the shortest path on a network. Assume that the leader’s and follower’s facilities are located on the set of points 
                           
                              
                                 X
                                 p
                              
                              =
                              
                                 {
                                 
                                    x
                                    1
                                 
                                 ,
                                 
                                    x
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    x
                                    p
                                 
                                 }
                              
                           
                         and 
                           
                              
                                 Y
                                 r
                              
                              =
                              
                                 {
                                 
                                    y
                                    1
                                 
                                 ,
                                 
                                    y
                                    2
                                 
                                 ,
                                 …
                                 ,
                                 
                                    y
                                    r
                                 
                                 }
                              
                              ,
                           
                         respectively. A customer vi
                         prefers the follower if and only if D(vi, Yr
                        ) < D(vi, Xp
                        ). Then, total demand captured by the follower can be expressed as 
                           
                              W
                              
                                 (
                                 
                                    Y
                                    r
                                 
                                 |
                                 
                                    X
                                    p
                                 
                                 )
                              
                              =
                              
                                 ∑
                                 
                                    i
                                    :
                                    D
                                    
                                       (
                                       
                                          v
                                          i
                                       
                                       ,
                                       
                                          Y
                                          r
                                       
                                       )
                                    
                                    <
                                    D
                                    
                                       (
                                       
                                          v
                                          i
                                       
                                       ,
                                       
                                          X
                                          p
                                       
                                       )
                                    
                                 
                              
                              w
                              
                                 (
                                 
                                    v
                                    i
                                 
                                 )
                              
                           
                        .

Assume that the leader has already been operating with facilities located on Xp
                        . Then, (r|Xp
                        ) medianoid is the set 
                           
                              Y
                              r
                              *
                           
                         such that 
                           
                              W
                              
                                 (
                                 
                                    Y
                                    r
                                    *
                                 
                                 |
                                 
                                    X
                                    p
                                 
                                 )
                              
                              ≥
                              W
                              
                                 (
                                 
                                    Y
                                    r
                                 
                                 |
                                 
                                    X
                                    p
                                 
                                 )
                              
                           
                         for all sets of follower’s possible facility locations Yr
                        . (r|Xp
                        ) medianoid is the optimal set of facility locations for the follower to capture the highest market share given the set Xp
                        .

Similarly, (r|p) centroid is the set 
                           
                              X
                              p
                              *
                           
                         such that 
                           
                              W
                              
                                 (
                                 
                                    Y
                                    r
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       p
                                       *
                                    
                                    )
                                 
                                 |
                                 
                                    X
                                    p
                                    *
                                 
                                 )
                              
                              ≤
                              W
                              
                                 (
                                 
                                    Y
                                    r
                                    *
                                 
                                 
                                    (
                                    
                                       X
                                       p
                                    
                                    )
                                 
                                 |
                                 
                                    X
                                    p
                                 
                                 )
                              
                           
                         for all sets of the leader’s possible set of facility locations Xp
                         where 
                           
                              
                                 Y
                                 r
                                 *
                              
                              
                                 (
                                 
                                    X
                                    p
                                 
                                 )
                              
                           
                         is the (r|Xp
                        ) medianoid given Xp
                        . (r|p) centroid is the optimal set of facility locations for the leader to capture the highest market share under realistic assumption that the follower will respond by (r|Xp
                        ) medianoid. Hakimi (1983) proved that both centroid and medianoid problems are NP-hard.

An interested reader may refer to surveys by Eiselt and Laporte (1997) and Dasci (2011) for a detailed discussion on competitive location problems.


                        O’Kelly (1986a, 1986b) presented the hub location problem as system-wide transportation cost of a network is minimized by locating p hubs in a single-allocation structure (This problem is later referred to as the single-allocation p-hub median problem). Later, O’Kelly (1987) also proposed the first mathematical formulation of single-allocation p-hub median problem.

Later, Skorin-Kapov, Skorin-Kapov, and O’Kelly (1996) provided a new linear model for the problem and Ernst and Krishnamoorthy (1996) modeled the single allocation p-hub median problem as a multi-commodity flow problem. The single allocation p-hub median problem was proven to be NP-hard by Kara (1999).

Multiple-allocation p-hub median problem has also attracted attention. Campbell (1992) presented first multiple-allocation hub model. Skorin-Kapov et al. (1996) developed a linear model for the problem. Ernst and Krishnamoorthy (1998) modeled the multiple-allocation p-hub median problem based on the idea that they use for the single-allocation version.

Although hub location problem with median objective constitutes the main streamline of the literature, other objectives were also investigated by researchers. O’Kelly (1992), Campbell (1992) and Aykin (1994) proposed mathematical models for the hub location problem with fixed costs.

In some applications of hub networks, such as the cargo applications, service levels are considered as well as cost. The p-hub center problem is to locate p hub on a network where the distance or travelling cost between the most disadvantageous pair of nodes is minimized. Campbell (1994) proposed linear models for the hub location problems with center-type objectives. Kara and Tansel (2000) proved that p-hub center problem is NP-hard. They also proposed different mathematical models for the problem. Later, Ernst, Hamacher, Jiang, Krishnamoorthy, and Woeginger (2009) provided a new formulation for the p-hub center problem based on the value of maximum collection/distribution distance between a hub and a non-hub node.

Hub covering is another version of the hub location problem. Campbell (1994) presented mathematical models for different types of hub covering problem. After his contribution, Kara and Tansel (2003) studied single allocation hub set covering problem and proposed three different linearizations of the problem. Later, Ernst, Jiang, and Krishnamoorthy (2005) provided new formulations of the problem based on the idea that they use for the p-hub center problem.

Various extensions of hub location problems were also considered such as latest arrival problems (Kara & Tansel, 2001; Yaman, Kara, & Tansel, 2007), hub location with stopovers (Kuby & Gray, 1993; Yaman et al., 2007), hierarchical hub network models (Yaman, 2009) and hub location problems with ordered averaging objective functions (Puerto, Ramos, & Rodríguez-Chía, 2011; 2013).

An interested reader may refer to surveys by Campbell, Ernst, and Krishnamoorthy (2002), Alumur and Kara (2008), Kara and Taner (2011) and Campbell and O’Kelly (2012) for detailed discussion of hub location problems.

Although competition in location decisions has been studied in detail, competitive hub location studies in the literature are rare. Marianov, Serra, and ReVelle (1999) proposed first hub location problem with competition. They proposed mathematical models for follower’s problem where the leader had already been operating the market with his/her existing hubs.

They also considered proportional capture levels in addition to all-or-nothing type capture. They assumed that the follower would capture half of the flow between nodes i and j if his/her service level is between 0.9Cij
                         and 1.1Cij
                        , three–fourth of the flow if his/her service level is between 0.7Cij
                         and 0.9Cij
                         and the whole flow if his/her service level is less than 0.7Cij
                         where Cij
                         is the service level of the leader. A mathematical model was provided for proportional capture case by triplicating the capture variables and constraints. Later Wagner (2008) proposed a new capture set where the follower gets nothing in case of equal service levels for the same problem.


                        Sasaki and Fukushima (2001) proposed a new kind of competitive hub location model where the decision space is a plane. Route between any O–D pair on the plane visits only one hub. First, a big firm locates one hub, and then several medium size firms locate their hubs. There is no competition between medium size firms. They used logit functions for customer preferences to express proportional capture. They initially modeled the problem as a bilevel program and then use a sequential quadratic programming approach.


                        Sasaki (2005) applied the same idea in the study by Sasaki and Fukushima (2001) to a discrete environment with some modifications. Her model includes two decision-makers: one leader and one follower. The leader and follower locate p and q hubs on the network, respectively. Capture rule is as in Sasaki and Fukushima (2001) and each route contains one only hub.


                        Eiselt and Marianov (2009) proposed another hub location model with competition where an airline transportation company enters a market. It is assumed that some other companies has already been operating in the market. The entrant firm aims to capture as many customers as possible. Customer preferences are based on basic attractiveness of the firms (such as safety record, personal space, quality of the foods etc.), number of stopover on the trip, cost of the route and time required by the flight.

Another hub location problem with Stackelberg competition was studied by Sasaki, Campbell, Ernst, and Krishnamoorthy (2014). In their problem environment, the decision-makers do not locate hubs but hub arcs. One leader and one competitor airline companies locate qa
                         and qb
                         hub arcs on the network to maximize the total revenue. The leader can capture 0, 25, 50, 75 or 100% of flow between any O–D pair based on cost and travel time of the trip and the remaining customers prefer the follower. They proposed a bilevel program for the problem.

A study by Lüer-Villagra and Marianov (2013) considered both hub location and pricing decisions of an entrant firm where an other firm has already been operating on the market. They propose a nonlinear model where the objective is to maximize the entrant’s profit. The customer preferences are represented as a logit function.

Although existing studies contribute to hub location and competition literature, both theoretical aspect of the problem and applications in industry require more effort. In order to motivate the studies in this area, in this paper, we formally define hub-medianoid and hub-centroid problems by following the terminology used by Hakimi (1983) for analogous competitive location problems. Moreover, we prove that both problems are NP-complete. Table 1 summarizes studies in the competitive hub location literature where the last row corresponds to this paper.

Given a network 
                        
                           G
                           =
                           (
                           N
                           ,
                           E
                           )
                        
                      where N is set of nodes and E is set of edges, let wij
                      be total flow and cij
                      be transportation cost of a unit flow from node i to node j for all i, j ∈ N. Interhub transportation cost is discounted by the factor α , 0 ≤ α ≤ 1. (Later we use 
                        
                           <
                           G
                           =
                           
                              (
                              N
                              ,
                              E
                              )
                           
                           ,
                           
                              w
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              c
                              
                                 i
                                 j
                              
                           
                           ,
                           α
                           >
                        
                      to refer this network.) The leader and follower would like to enter a market with a prespecified number of hubs. Let p and r be number of hubs to be opened by the leader and follower, respectively. We assume that both p and r are greater than or equal to 2 since otherwise economies of scale is not generated. Let H⊆N be the subset of nodes that are available to locate hubs. Customers prefer the leader or follower with respect to provided service levels. Service level is defined as the cost of routing the flow from a node to its destination via hubs. A customer prefers the follower if the service level provided by the follower is strictly better than the one provided by the leader, otherwise the demand is captured by the leader. Ties are broken in the advantage of the leader in case of equal service levels since the customer was already operating with the leader when the follower entered the market and the customer has no incentive to deviate from current position.

First, assume that the leader has already been operating the market with hubs located at a subset of nodes 
                        
                           
                              X
                              p
                           
                           =
                           
                              {
                              
                                 x
                                 1
                              
                              ,
                              
                                 x
                                 2
                              
                              ,
                              …
                              ,
                              
                                 x
                                 p
                              
                              }
                           
                           ,
                        
                      
                     Xp
                     ⊆H. The flow from node i ∈ N to node j ∈ N visits one or two hubs. Therefore, we can easily compute service level, say βij
                     , provided by the leader for the flow from node i ∈ N to node j ∈ N.

                        
                           (1)
                           
                              
                                 
                                    β
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    min
                                    
                                       k
                                       ,
                                       m
                                       ∈
                                       
                                          X
                                          p
                                       
                                    
                                 
                                 
                                    {
                                    
                                       c
                                       
                                          i
                                          k
                                       
                                    
                                    +
                                    α
                                    
                                       c
                                       
                                          k
                                          m
                                       
                                    
                                    +
                                    
                                       c
                                       
                                          m
                                          j
                                       
                                    
                                    }
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 
                                 j
                                 ∈
                                 N
                                 .
                              
                           
                        
                     
                  

Now, consider the follower enters the market by opening hubs on subset of nodes 
                        
                           
                              Y
                              r
                           
                           =
                           
                              {
                              
                                 y
                                 1
                              
                              ,
                              
                                 y
                                 2
                              
                              ,
                              …
                              ,
                              
                                 y
                                 r
                              
                              }
                           
                           ,
                        
                      
                     Yr
                     ⊆H. Similarly, followers service levels, say γij
                     , for all node pairs i and j can be calculated as:

                        
                           (2)
                           
                              
                                 
                                    γ
                                    
                                       i
                                       j
                                    
                                 
                                 =
                                 
                                    min
                                    
                                       k
                                       ,
                                       m
                                       ∈
                                       
                                          Y
                                          r
                                       
                                    
                                 
                                 
                                    {
                                    
                                       c
                                       
                                          i
                                          k
                                       
                                    
                                    +
                                    α
                                    
                                       c
                                       
                                          k
                                          m
                                       
                                    
                                    +
                                    
                                       c
                                       
                                          m
                                          j
                                       
                                    
                                    }
                                 
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ∈
                                 N
                                 .
                              
                           
                        
                     
                  

Flow wij
                      is captured by the follower if γij
                      < βij
                      for all i, j ∈ N. Given that the leader’s and follower’s hubs are located on the subset of nodes Xp
                      and Yr
                     , respectively, total flow captured by the follower can be expressed by a mapping 
                        
                           f
                           :
                           
                              P
                              p
                           
                           
                              (
                              H
                              )
                           
                           ×
                           
                              P
                              r
                           
                           
                              (
                              H
                              )
                           
                           →
                           
                              [
                              0
                              ,
                              W
                              ]
                           
                        
                      such that

                        
                           (3)
                           
                              
                                 f
                                 
                                    (
                                    
                                       X
                                       p
                                    
                                    ,
                                    
                                       Y
                                       r
                                    
                                    )
                                 
                                 =
                                 
                                    ∑
                                    
                                       i
                                       ,
                                       j
                                       ∈
                                       N
                                       :
                                       
                                          γ
                                          
                                             i
                                             j
                                          
                                       
                                       <
                                       
                                          β
                                          
                                             i
                                             j
                                          
                                       
                                    
                                 
                                 
                                    w
                                    
                                       i
                                       j
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              P
                              p
                           
                           
                              (
                              H
                              )
                           
                        
                      is the collection of subsets of H with cardinality p and W is the total flow over the network, that is, 
                        
                           W
                           =
                           
                              ∑
                              
                                 i
                                 ,
                                 j
                                 ∈
                                 N
                              
                           
                           
                              w
                              
                                 i
                                 j
                              
                           
                        
                     .

Given Xp
                     , the follower aims to maximize f(Xp, Yr
                     ) over all 
                        
                           
                              Y
                              r
                           
                           ∈
                           
                              P
                              p
                           
                           
                              (
                              H
                              )
                           
                        
                     . We define set 
                        
                           Y
                           r
                           *
                        
                      as 
                        
                           (
                           r
                           |
                           
                              X
                              p
                           
                           )
                           h
                           u
                           b
                           −
                           m
                           e
                           d
                           i
                           a
                           n
                           o
                           i
                           d
                        
                      if 
                        
                           f
                           
                              (
                              
                                 X
                                 p
                              
                              ,
                              
                                 Y
                                 r
                                 *
                              
                              )
                           
                           ≥
                           f
                           
                              (
                              
                                 X
                                 p
                              
                              ,
                              
                                 Y
                                 r
                              
                              )
                           
                           ,
                           ∀
                           
                              Y
                              r
                           
                           ∈
                           
                              P
                              r
                           
                           
                              (
                              H
                              )
                           
                        
                     . Therefore, 
                        
                           (
                           r
                           |
                           
                              X
                              p
                           
                           )
                           h
                           u
                           b
                           −
                           m
                           e
                           d
                           i
                           a
                           n
                           o
                           i
                           d
                        
                      is the set of follower’s hubs with cardinality r that maximizes captured demand given Xp
                     .

Now, we look at the problem from the leader’s perspective. The leader wants to minimize the demand captured by the follower (or equivalently maximize demand captured by himself/herself) while deciding his/her hub set. The leader also has the information that the follower will respond rationally.

We define set 
                        
                           X
                           p
                           *
                        
                      as 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      if 
                        
                           f
                           
                              (
                              
                                 X
                                 p
                                 *
                              
                              ,
                              
                                 Y
                                 r
                                 *
                              
                              
                                 (
                                 
                                    X
                                    p
                                    *
                                 
                                 )
                              
                              )
                           
                           ≤
                           f
                           
                              (
                              
                                 X
                                 p
                              
                              ,
                              
                                 Y
                                 r
                                 *
                              
                              
                                 (
                                 
                                    X
                                    p
                                 
                                 )
                              
                              )
                           
                           ,
                           ∀
                           
                              X
                              p
                           
                           ∈
                           
                              P
                              p
                           
                           
                              (
                              H
                              )
                           
                        
                      where 
                        
                           
                              Y
                              r
                              *
                           
                           
                              (
                              
                                 X
                                 p
                              
                              )
                           
                        
                      is the 
                        
                           (
                           r
                           |
                           
                              X
                              p
                           
                           )
                           h
                           u
                           b
                           −
                           m
                           e
                           d
                           i
                           a
                           n
                           o
                           i
                           d
                        
                      given Xp
                     . 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      is the set of leader’s hubs with cardinality p so that in the remaining scenario the follower can capture the least possible flow.

Let 
                        
                           <
                           G
                           =
                           
                              (
                              N
                              ,
                              E
                              )
                           
                           ,
                           
                              w
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              c
                              
                                 i
                                 j
                              
                           
                           ,
                           α
                           >
                        
                      be a many-to-many flow network. At the time the follower makes decision, the leader has already located his/her hubs on the set Xp
                     ⊆H and locations of these hubs are observed by the follower. Then, the follower has the information of the service levels provided by the leader for each pair of nodes i, j ∈ N. These service levels can be calculated as in Eq. (1).

We prove that the problem of finding a 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         is NP-complete by using polynomial time reduction from clique problem, a known NP-complete problem due to Karp (1972).


                        Decision version of clique problem: Given an undirected graph 
                           
                              G
                              =
                              (
                              N
                              ,
                              E
                              )
                           
                         and an integer r, determine if G has a r-clique, that is, there is a set of vertices K with |K| ≥ r such that for each pair of vertices in K there is an edge in E between them.

                           Theorem 1
                           
                              
                                 
                                    (
                                    r
                                    |
                                    
                                       X
                                       p
                                    
                                    )
                                    h
                                    u
                                    b
                                    −
                                    m
                                    e
                                    d
                                    i
                                    a
                                    n
                                    o
                                    i
                                    d
                                 
                               
                              is NP-complete even if
                              
                                 
                                    α
                                    =
                                    0
                                 
                              
                              .
                           

Given an instance of clique problem, we construct a network 
                                 
                                    
                                       G
                                       ′
                                    
                                    =
                                    
                                       (
                                       
                                          N
                                          ′
                                       
                                       ,
                                       
                                          E
                                          ′
                                       
                                       )
                                    
                                 
                               where 
                                 
                                    
                                       N
                                       ′
                                    
                                    =
                                    N
                                    ∪
                                    
                                       X
                                       p
                                    
                                    ,
                                 
                               where 
                                 
                                    
                                       X
                                       p
                                    
                                    =
                                    
                                       {
                                       
                                          x
                                          1
                                       
                                       ,
                                       
                                          x
                                          2
                                       
                                       ,
                                       …
                                       ,
                                       
                                          x
                                          p
                                       
                                       }
                                    
                                 
                               and 
                                 
                                    
                                       E
                                       ′
                                    
                                    
                                       =
                                       E
                                       ∪
                                       {
                                       
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                       :
                                       i
                                       ∈
                                       N
                                    
                                 
                               and j ∈ Xp
                              } where Xp
                               is assumed to be the hub set of the leader. Let 
                                 
                                    
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    1
                                 
                               if (i, j) ∈ E and 
                                 
                                    
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    0.5
                                 
                               if i ∈ N and j ∈ Xp
                               and let 
                                 
                                    α
                                    =
                                    0
                                 
                              . The flow values for all pairs i, j ∈ N are set to 1. Clearly, 
                                 
                                    β
                                    =
                                    1
                                 
                               for all i, j ∈ N.

We prove the theorem by showing that there exists a set of r points Yr
                              (Xp
                              ) on G′ such that 
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       ,
                                       
                                          Y
                                          r
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                          
                                          )
                                       
                                       )
                                    
                                    ≥
                                    
                                       (
                                       
                                          r
                                          2
                                       
                                       )
                                    
                                    =
                                    
                                       (
                                       
                                          r
                                          2
                                       
                                       −
                                       r
                                       )
                                    
                                    /
                                    2
                                 
                               if and only if there exists an 
                                 
                                    r
                                    −
                                    c
                                    l
                                    i
                                    q
                                    u
                                    e
                                 
                               on G.

Assume that clique problem has solution K⊆N and |K| ≥ r. By letting Yr
                              ⊇K, we can observe that 
                                 
                                    
                                       γ
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    0
                                 
                               for all i, j ∈ K since all flows on the clique benefit discounting where 
                                 
                                    α
                                    =
                                    0
                                 
                               and the total flow among the clique is captured by the follower, that is, 
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       ,
                                       
                                          Y
                                          r
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                          
                                          )
                                       
                                       )
                                    
                                    ≥
                                    
                                       (
                                       
                                          r
                                          2
                                       
                                       −
                                       r
                                       )
                                    
                                    /
                                    2
                                 
                              .

On the other hand, suppose Yr
                               in G′ is such that 
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       ,
                                       
                                          Y
                                          r
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                          
                                          )
                                       
                                       )
                                    
                                    ≥
                                    
                                       (
                                       
                                          r
                                          2
                                       
                                       −
                                       r
                                       )
                                    
                                    /
                                    2
                                 
                              . If for all i, j ∈ Yr
                               there exists an edge (i, j) ∈ E, then Yr
                               itself form an 
                                 
                                    r
                                    −
                                    c
                                    l
                                    i
                                    q
                                    u
                                    e
                                 
                               on G. Then set 
                                 
                                    K
                                    =
                                    
                                       Y
                                       r
                                    
                                 
                              . Otherwise, assume that Yr
                               does not form an 
                                 
                                    r
                                    −
                                    c
                                    l
                                    i
                                    q
                                    u
                                    e
                                    ,
                                 
                               then there must be 
                                 
                                    (
                                    
                                       r
                                       2
                                    
                                    −
                                    r
                                    )
                                    /
                                    2
                                 
                               units of flow captured by the follower and at least one unit of flow should be routed via a spoke link. Equivalently, we can say that for 
                                 
                                    (
                                    
                                       r
                                       2
                                    
                                    −
                                    r
                                    )
                                    /
                                    2
                                 
                               pairs of node γij
                               < 1. Then, none of the captured flow is routed via the spoke link of the follower which contradicts the assumption.

Hence, we conclude that 
                                 
                                    (
                                    r
                                    |
                                    
                                       X
                                       p
                                    
                                    )
                                    h
                                    u
                                    b
                                    −
                                    m
                                    e
                                    d
                                    i
                                    a
                                    n
                                    o
                                    i
                                    d
                                 
                               is reducible from clique problem in polynomial time. So, it is NP-complete.□

To provide a mathematical model for the 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem, we define following decision variables:

                           
                              
                                 
                                    
                                       h
                                       k
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   the
                                                   
                                                   follower
                                                   
                                                   locates
                                                   
                                                   a
                                                   
                                                   hub
                                                   
                                                   on
                                                   
                                                   node
                                                   
                                                   k
                                                   ∈
                                                   H
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       
                                          
                                             u
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         flow
                                                         
                                                         from
                                                         
                                                         node
                                                         
                                                         i
                                                         ∈
                                                         N
                                                         
                                                         to
                                                         
                                                         node
                                                         
                                                         j
                                                         ∈
                                                         N
                                                         
                                                         visits
                                                         
                                                         hub
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         k
                                                         ∈
                                                         H
                                                         
                                                         as
                                                         
                                                         the
                                                         
                                                         first
                                                         
                                                         hub
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             v
                                             
                                                i
                                                j
                                                m
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         flow
                                                         
                                                         from
                                                         
                                                         node
                                                         
                                                         i
                                                         ∈
                                                         N
                                                         
                                                         to
                                                         
                                                         node
                                                         
                                                         j
                                                         ∈
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         
                                                         visits
                                                         
                                                         hub
                                                         
                                                         m
                                                         ∈
                                                         H
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         as
                                                         
                                                         the
                                                         
                                                         second
                                                         
                                                         hub
                                                         
                                                         and
                                                         
                                                         this
                                                         
                                                         flow
                                                         
                                                         is
                                                         
                                                         captured
                                                         
                                                         by
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         the
                                                         
                                                         follower
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The following mixed integer problem, namely H-MED, solves the 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem:

                           
                              (4)
                              
                                 
                                    maximize
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          m
                                          ∈
                                          H
                                       
                                    
                                    
                                       w
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       v
                                       
                                          i
                                          j
                                          m
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    subject
                                    
                                    to
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          H
                                       
                                    
                                    
                                       h
                                       k
                                    
                                    =
                                    r
                                    ,
                                 
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          H
                                       
                                    
                                    
                                       u
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       ∑
                                       
                                          m
                                          ∈
                                          H
                                       
                                    
                                    
                                       v
                                       
                                          i
                                          j
                                          m
                                       
                                    
                                    ≤
                                    1
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       u
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ≤
                                    
                                       h
                                       k
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    k
                                    ∈
                                    H
                                    ,
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       v
                                       
                                          i
                                          j
                                          m
                                       
                                    
                                    ≤
                                    
                                       h
                                       m
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    m
                                    ∈
                                    H
                                    ,
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   k
                                                   ∈
                                                   H
                                                
                                             
                                             
                                                u
                                                
                                                   i
                                                   j
                                                   k
                                                
                                             
                                             
                                                (
                                                
                                                   c
                                                   
                                                      i
                                                      k
                                                   
                                                
                                                +
                                                α
                                                
                                                   c
                                                   
                                                      k
                                                      m
                                                   
                                                
                                                )
                                             
                                             +
                                             
                                                c
                                                
                                                   m
                                                   j
                                                
                                             
                                             −
                                             
                                                β
                                                
                                                   i
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             +
                                             
                                             ϵ
                                             ≤
                                             (
                                             1
                                             −
                                             
                                                v
                                                
                                                   i
                                                   j
                                                   m
                                                
                                             
                                             )
                                             M
                                             
                                             ∀
                                             i
                                             ,
                                             j
                                             ∈
                                             N
                                             
                                             ∀
                                             m
                                             ∈
                                             H
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                    
                                       h
                                       k
                                    
                                    ,
                                    
                                       u
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ,
                                    
                                       v
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    k
                                    ,
                                    m
                                    ∈
                                    H
                                 
                              
                           
                        
                     

The objective (4) maximizes amount of flow captured by the follower. Constraint (5) ensures that follower locates r hubs on the set of available nodes. Constraints (6) guarantee that each flow is allocated to a first hub. Constraints (7) state flow from node i ∈ N to node j ∈ N can be captured by the follower using a hub located at node m ∈ H. Constraints (8) and (9) prevent allocation of flows to non-hub nodes. Constraints (10) determine captured flows in the following manner: LHS of the constraint is the difference of service level provided by the follower and service level provided by the leader plus ϵ. Let 
                           
                              ϵ
                              =
                              
                                 10
                                 
                                    −
                                    6
                                 
                              
                           
                         be a very small positive number used to break ties in favor of the leader. If this value is non-negative, the corresponding variable vijm
                         is forced to be 0 that is the follower cannot provide a better service level for flow from i ∈ N to node j ∈ N; otherwise there is no restriction on vijm. M is a large positive value but 
                           
                              M
                              =
                              
                                 (
                                 2
                                 +
                                 α
                                 )
                              
                              
                                 max
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                 
                              
                              
                                 c
                                 
                                    i
                                    j
                                 
                              
                           
                         value is large enough since the LHS can be at most 
                           
                              
                                 (
                                 2
                                 +
                                 α
                                 )
                              
                              m
                              a
                              
                                 x
                                 
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                 
                              
                              
                                 c
                                 
                                    i
                                    j
                                 
                              
                           
                        . Since the objective is to maximize the captured flow, corresponding vijm
                         value is assigned to 1 when there is no restriction on vijm
                        . Constraints (11) are domain Constraints.

If flow from i ∈ N to node j ∈ N visits only one hub k ∈ H, then 
                           
                              
                                 u
                                 
                                    i
                                    j
                                    k
                                 
                              
                              =
                              1
                           
                        . Additionally, if this flow is captured by the follower, corresponding variable vijk
                         is set to 1 and 0 otherwise.

Performance of 
                        H-MED is investigated by computational experiments conducted on two different data sets: CAB and TR. α values are chosen as either 0.6 or 0.8. Also, for TR data α is set to 0.9 due to Tan and Kara (2007). Nodes in the CAB data set are numbered based on the alphabetical order of the city names whereas nodes in the TR data sets are plate codes of cities in Turkey which ranges from 1 to 81. All instances are solved with CPLEX 12.4 (ILOG, 2012) and a 4 x AMD Opteron Interlagos 16C 6282SE 2.6G 16M 6400MT computer running under a Linux operating system. Table 2
                         summarizes all 139 instances used in the computational study of 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem.

Since we need to take βij
                         values as parameters of 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem, we have to make some assumptions for the leaders hub set in advance. Therefore, we assume that the leader locates his/her hubs on a set of nodes according to his/her optimal choices of well-studied multiple-allocation hub location problems: uncapacitated multiple-allocation p-hub median (UMApHM) and p-hub center (UMApHC). However, current models in the literature are not able to solve the UMApHC for the size of TR data set, so only UMApHM solutions are used as leaders hub set for this data set.

The distance matrices of both data sets are symmetric. Therefore, if from node i ∈ N to node j ∈ N is routed via the leader’s (follower’s) hubs then flow from node j to node i is also routed via the leader’s (follower’s) hubs. By using this fact, the constraints (6)–(11) of H-MED are imposed for only i < j and the objective (4) is replaced with 
                           
                              
                                 ∑
                                 
                                    i
                                    <
                                    j
                                    :
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                 
                              
                              
                                 ∑
                                 
                                    m
                                    ∈
                                    H
                                 
                              
                              
                                 (
                                 
                                    w
                                    
                                       i
                                       j
                                    
                                 
                                 +
                                 
                                    w
                                    
                                       j
                                       i
                                    
                                 
                                 )
                              
                              
                                 v
                                 
                                    i
                                    j
                                    m
                                 
                              
                           
                         for computational studies.


                        Tables 3 and 4
                         summarize CPU time and market share of the follower in an optimal solution of 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem where the leader has already located his/her hubs on the optimal solution of UMApHM and UMApHC on CAB and TR data sets, respectively.

Since the leader chooses his/her hub locations without being aware of competition, the follower can capture high amounts of flow even 
                           
                              p
                              =
                              r
                           
                        . For example, if 
                           
                              p
                              =
                              r
                              =
                              2
                           
                         the follower can capture more than 65% of total demand.

The proposed mathematical model H-MED can be regarded as the formulation of maximal hub cover problem so that covering radius for each pair of nodes i, j ∈ N are defined as 
                           
                              
                                 β
                                 
                                    i
                                    j
                                 
                              
                              −
                              ϵ
                           
                         where ϵ is a small positive real number. Having this property, CPLEX efficiently solves H-MED within reasonable times. All instances of CAB data set could be optimally solvable within 25  s.

For TR data set in case of equal number of hubs, that is 
                           
                              p
                              =
                              r
                              ,
                           
                         the leader captures more than half of the market. The follower should open at least two more hubs to defeat the leader. Moreover, since the same discount factor applies for both firms, there is no important correlation between market shares and α value.

As p value gets closer to |H|, the leader can capture at least one half of the market even for the case r > p . As seen in TR instances, the leader locates his/her hubs on strategic locations and prevents good choices for the follower when p ≥ 10. Then, for these instances, the follower is not able to capture one half of the market. Hence, if p is not a small value compared to |H|, the leader uses the advantageous of being the first mover. Therefore, the firms have incentive of competing to be the leader. For example, even if the leader chooses his/her hubs according to an optimal solution of UMApHM for 
                           
                              α
                              =
                              0.6
                              ,
                           
                        
                        
                           
                              p
                              =
                              10
                           
                         and 
                           
                              r
                              =
                              14
                              ,
                           
                         he/she can capture more flow than follower even without considering competition. However, in CAB instances, p is relatively small compared to |H|, so after the leader makes his/her decision, the follower still has big action space and being the latter decision-maker is more advantageous if the former one does not have information about the competition.

Let 
                        
                           <
                           G
                           =
                           
                              (
                              N
                              ,
                              E
                              )
                           
                           ,
                           
                              w
                              
                                 i
                                 j
                              
                           
                           ,
                           
                              c
                              
                                 i
                                 j
                              
                           
                           ,
                           α
                           >
                        
                      be a many-to-many flow network. At the time the leader makes his/her decision, he/she knows that the follower is going to respond rationally, that is, the follower is going to choose the optimal solution of 
                        
                           (
                           r
                           |
                           
                              X
                              p
                           
                           )
                           h
                           u
                           b
                           −
                           m
                           e
                           d
                           i
                           a
                           n
                           o
                           i
                           d
                        
                      problem after observing Xp
                     . Therefore, 
                        
                           (
                           r
                           |
                           
                              X
                              p
                           
                           )
                           h
                           u
                           b
                           −
                           m
                           e
                           d
                           i
                           a
                           n
                           o
                           i
                           d
                        
                      problem is embedded in 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      problem. Due to this relation, 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      problem has a bilevel structure.

We prove that the problem of finding a 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         is NP-complete by using polynomial time reduction from vertex cover problem, a known NP-complete problem due to Karp (1972).


                        Decision version of vertex cover problem: Given an undirected graph 
                           
                              G
                              =
                              (
                              N
                              ,
                              E
                              )
                           
                         and an integer p, determine if G has a vertex cover, that is, if there is a set of vertices C with |C| ≤ p such that for each edge (i, j) ∈ E, either i or j is in C.

                           Theorem 2
                           
                              The problem of finding
                              
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               
                              is NP-complete even if
                              
                                 
                                    α
                                    =
                                    1
                                 
                              
                              .
                           

Given an instance of vertex cover problem, we construct a network 
                                 
                                    
                                       G
                                       ′
                                    
                                    =
                                    
                                       (
                                       
                                          N
                                          ′
                                       
                                       ,
                                       
                                          E
                                          ′
                                       
                                       )
                                    
                                 
                               where 
                                 
                                    
                                       G
                                       ′
                                    
                                    =
                                    G
                                 
                              . Let 
                                 
                                    
                                       c
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    1
                                 
                               if (i, j) ∈ E. The flow values for all pairs i, j ∈ N is set to 1 if (i, j) ∈ E and 0 otherwise. Also, assume that 
                                 
                                    α
                                    =
                                    1
                                 
                              .

We prove the theorem by showing that there exists a set of p points Xp
                               on G′ such that 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                    
                                    ,
                                    
                                       Y
                                       r
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       )
                                    
                                    )
                                    =
                                    0
                                 
                               if and only if there exists a vertex cover C with |C| ≤ p .

Assume that vertex cover problem has solution C⊆N and |C| ≤ p. By letting Xp
                              ⊇C, we can observe that unit flow wij
                               either i or j is in Xp
                              . Therefore, for each flow wij
                              , the service level provided by the leader 
                                 
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    1
                                 
                               noting that each flow is routed via only a single link. Since the follower cannot provide a strictly better service level for any of the node pairs i and j, no flow is captured by the follower. Then, 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       )
                                    
                                    )
                                    =
                                    0
                                 
                              .

On the other hand, suppose Xp
                               in G′ is such that 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       )
                                    
                                    )
                                    =
                                    0
                                 
                              . Also, assume that Xp
                               does not contain a subset which is a vertex cover C of G. So, there exists an edge (i, j) ∈ E′ where neither i nor j is in Xp
                              . Then, the follower can capture the flow wij
                               by location his/her hubs on both i and j which yields 
                                 
                                    
                                       γ
                                       
                                          i
                                          j
                                       
                                    
                                    =
                                    1
                                 
                              . On the other hand, the follower can provide a service level βij
                               ≥ 2 since the flow should visit a hub that is different from both i and j. Then, 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       )
                                    
                                    )
                                    ≥
                                    1
                                 
                               which contradicts with the assumption.

Hence, we conclude that 
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               is reducible from vertex cover problem in polynomial time. So, it is NP-complete.□

To provide a bilevel mathematical model for the 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem, we define following decision variables:

                           
                              
                                 
                                    
                                       
                                          
                                             H
                                             k
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         the
                                                         
                                                         leader
                                                         
                                                         locates
                                                         
                                                         a
                                                         
                                                         hub
                                                         
                                                         on
                                                         
                                                         node
                                                         
                                                         k
                                                         ∈
                                                         H
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             U
                                             
                                                i
                                                j
                                                k
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         flow
                                                         
                                                         from
                                                         
                                                         node
                                                         
                                                         i
                                                         ∈
                                                         N
                                                         
                                                         to
                                                         
                                                         node
                                                         
                                                         j
                                                         ∈
                                                         N
                                                         
                                                         visits
                                                         
                                                         hub
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         k
                                                         ∈
                                                         H
                                                         
                                                         as
                                                         
                                                         the
                                                         
                                                         first
                                                         
                                                         hub
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             V
                                             
                                                i
                                                j
                                                m
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         flow
                                                         
                                                         from
                                                         
                                                         node
                                                         i
                                                         ∈
                                                         N
                                                         
                                                         to
                                                         
                                                         node
                                                         
                                                         j
                                                         ∈
                                                         N
                                                         
                                                         visits
                                                         
                                                         hub
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         m
                                                         ∈
                                                         H
                                                         
                                                         as
                                                         
                                                         the
                                                         
                                                         second
                                                         
                                                         hub
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             a
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         1
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         if
                                                         
                                                         flow
                                                         
                                                         from
                                                         
                                                         node
                                                         
                                                         i
                                                         ∈
                                                         N
                                                         
                                                         to
                                                         
                                                         node
                                                         
                                                         j
                                                         ∈
                                                         N
                                                         
                                                         is
                                                         
                                                         captured
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                      
                                                         by
                                                         
                                                         the
                                                         
                                                         follower
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             β
                                             
                                                i
                                                j
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             the
                                             
                                             service
                                             
                                             level
                                             
                                             for
                                             
                                             the
                                             
                                             node
                                             
                                             pair
                                             
                                             i
                                             ,
                                             j
                                             ∈
                                             N
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             provided
                                             
                                             by
                                             
                                             the
                                             
                                             leader.
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Note that capital letter decision variables Hk, Uijk, Vijm
                         of the leader are analogous to their lowercase versions defined for the follower and location variable Hk
                         should not be confused set of possible hub locations H.

The following bilevel mixed integer problem H-CEN-B solves the 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem:

                           
                              (12)
                              
                                 
                                    minimize
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       w
                                       
                                          i
                                          j
                                       
                                    
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                    subject
                                    
                                    to
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          H
                                       
                                    
                                    
                                       H
                                       k
                                    
                                    =
                                    p
                                    ,
                                 
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          H
                                       
                                    
                                    
                                       U
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       ∑
                                       
                                          m
                                          ∈
                                          H
                                       
                                    
                                    
                                       V
                                       
                                          i
                                          j
                                          m
                                       
                                    
                                    =
                                    1
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       U
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ≤
                                    
                                       H
                                       k
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    k
                                    ∈
                                    H
                                 
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       V
                                       
                                          i
                                          j
                                          m
                                       
                                    
                                    ≤
                                    
                                       H
                                       m
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    m
                                    ∈
                                    H
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    ≥
                                    
                                       ∑
                                       
                                          k
                                          ∈
                                          H
                                       
                                    
                                    
                                       U
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    
                                       (
                                       
                                          c
                                          
                                             i
                                             k
                                          
                                       
                                       +
                                       α
                                       
                                          c
                                          
                                             k
                                             m
                                          
                                       
                                       )
                                    
                                    +
                                    
                                       V
                                       
                                          i
                                          j
                                          m
                                       
                                    
                                    
                                       c
                                       
                                          m
                                          j
                                       
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    m
                                    ∈
                                    H
                                 
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       γ
                                       
                                          i
                                          j
                                       
                                    
                                    ≤
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    M
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             where
                                             
                                             
                                                γ
                                                
                                                   i
                                                   j
                                                
                                             
                                             
                                             is
                                             
                                             induced
                                             
                                             from
                                             
                                             optimal
                                             
                                             solution
                                             
                                             of
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                                H
                                                −
                                                MED
                                             
                                             
                                             for
                                             
                                             
                                                H
                                                k
                                             
                                             ,
                                             k
                                             ∈
                                             H
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       H
                                       k
                                    
                                    ,
                                    
                                       U
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ,
                                    
                                       V
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ,
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    
                                    and
                                    
                                    
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    ≥
                                    0
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    k
                                    ,
                                    m
                                    ∈
                                    H
                                 
                              
                           
                        
                     

The objective (12) minimizes amount of flow captured by the follower which is equivalent to maximizing amount of flow captured by the leader. Constraint (13) ensures the leader locates p hubs on the set of available nodes. Constraints (14), (15), (16) and (17) guarantee that flow from node i ∈ N to j ∈ N visits two (not necessarily different) hub nodes k ∈ H and m ∈ H. Constraints (18) correctly calculate the service levels of the follower in the following manner: if 
                           
                              
                                 V
                                 
                                    i
                                    j
                                    m
                                 
                              
                              =
                              0
                              ,
                           
                         the constraint becomes redundant. However, if 
                           
                              
                                 V
                                 
                                    i
                                    j
                                    m
                                 
                              
                              =
                              1
                           
                         the RHS of the constraint becomes the service level provided by the leader for flow from node i ∈ N to j ∈ N. Constraints (19) correctly calculate whether a flow is captured by the follower or not in the following manner: If the LHS of the constraint is positive, that is the follower provides a service level for the flow from node i ∈ N to j ∈ N which is better than the service level provided by the leader, the RHS of the constraint must be positive and 
                           
                              
                                 a
                                 
                                    i
                                    j
                                 
                              
                              =
                              1
                           
                        . Otherwise, the constraint becomes redundant. Constraint (20) states that service levels of the follower are induced from another optimization problem, H-MED according to decisions of the leader and hence H-CEN-B is a bilevel problem due to Constraint (20). Constraints (21) are the domain constraints.

As stated by Bard (1999) and Dempe (2002), bilevel models are hard to solve even for a small number of decision variables. We use a mini–max approach to linearize H-CEN-B where the leaders choose a hub set so as to minimize the total captured flow by the follower in the remaining scenario. Let us define a new parameter:

                           
                              
                                 
                                    
                                       
                                          
                                             γ
                                             
                                                i
                                                j
                                             
                                             S
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             service
                                             
                                             level
                                             
                                             for
                                             
                                             pair
                                             
                                             i
                                             ,
                                             j
                                             ∈
                                             N
                                             
                                             provided
                                             
                                             by
                                             
                                             the
                                             
                                             follower
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             if
                                             
                                             he/she
                                             
                                             chooses
                                             
                                             S
                                             ⊆
                                             H
                                             
                                             as
                                             
                                             hub
                                             
                                             set
                                          
                                       
                                    
                                 
                              
                           
                        that is, 
                           
                              
                                 γ
                                 
                                    i
                                    j
                                 
                                 S
                              
                              =
                              m
                              i
                              
                                 n
                                 
                                    k
                                    ,
                                    m
                                    ∈
                                    S
                                 
                              
                              
                                 {
                                 
                                    c
                                    
                                       i
                                       k
                                    
                                 
                                 +
                                 α
                                 
                                    c
                                    
                                       k
                                       m
                                    
                                 
                                 +
                                 
                                    c
                                    
                                       m
                                       j
                                    
                                 
                                 }
                              
                           
                        . Also define a new decision variable:

                           
                              
                                 
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       S
                                    
                                    =
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   if
                                                   
                                                   flow
                                                   
                                                   from
                                                   
                                                   node
                                                   
                                                   i
                                                   ∈
                                                   N
                                                   
                                                   to
                                                   
                                                   node
                                                   
                                                   j
                                                   ∈
                                                   N
                                                   
                                                   is
                                                   
                                                   captured
                                                   
                                                   by
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   the
                                                   
                                                   follower
                                                   
                                                   when
                                                   
                                                   he/she
                                                   
                                                   chooses
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   S
                                                   ⊆
                                                   H
                                                   
                                                   as
                                                   
                                                   hub
                                                   
                                                   set
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                otherwise
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Then, the following mixed integer problem H-CEN solves the 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem with exponential number of decision variables and constraints:

                           
                              (22)
                              
                                 
                                    minimize
                                    
                                    Z
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    subject
                                    
                                    to
                                    
                                    (
                                    13
                                    )
                                    −
                                    (
                                    18
                                    )
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 
                                    Z
                                    ≥
                                    
                                       ∑
                                       
                                          i
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          j
                                          ∈
                                          N
                                       
                                    
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       S
                                    
                                    
                                       w
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    
                                    S
                                    ⊆
                                    H
                                    
                                    with
                                    
                                    
                                       |
                                       S
                                       |
                                    
                                    =
                                    r
                                    ,
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    −
                                    
                                       γ
                                       
                                          i
                                          j
                                       
                                       S
                                    
                                    ≤
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       S
                                    
                                    M
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    
                                    S
                                    ⊆
                                    H
                                    
                                    
                                    with
                                    
                                    
                                    
                                       |
                                       S
                                       |
                                    
                                    =
                                    r
                                    ,
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       H
                                       k
                                    
                                    ,
                                    
                                       U
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ,
                                    
                                       V
                                       
                                          i
                                          j
                                          k
                                       
                                    
                                    ,
                                    
                                       a
                                       
                                          i
                                          j
                                       
                                       S
                                    
                                    ∈
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                    and
                                    
                                    
                                       β
                                       
                                          i
                                          j
                                       
                                    
                                    
                                    ≥
                                    
                                    0
                                    
                                    ∀
                                    i
                                    ,
                                    j
                                    ∈
                                    N
                                    
                                    ∀
                                    
                                    S
                                    ⊆
                                    H
                                    
                                    with
                                    
                                    
                                       |
                                       S
                                       |
                                    
                                    
                                    =
                                    
                                    r
                                    ,
                                 
                              
                           
                        
                     

Objective function (22) and constraints (23) together minimize the highest possible captured flow value by the follower in the remaining scenario. Constraints (24) correctly calculate whether a flow is captured with a hub set S ⊆ H by the follower or not, similar to (18). Constraints (25) are domain constraints.

The mixed integer program H-CEN has 
                           
                              3
                              
                                 n
                                 2
                              
                              m
                              +
                              2
                              
                                 n
                                 2
                              
                              +
                              2
                              
                                 n
                                 2
                              
                              
                                 (
                                 
                                    m
                                    r
                                 
                                 )
                              
                              +
                              1
                           
                         constraints and 
                           
                              2
                              
                                 n
                                 2
                              
                              m
                              +
                              
                                 n
                                 2
                              
                              
                                 (
                                 
                                    m
                                    r
                                 
                                 )
                              
                              +
                              
                                 n
                                 2
                              
                              +
                              m
                              +
                              1
                           
                         variables of which 
                           
                              2
                              
                                 n
                                 2
                              
                              m
                              +
                              
                                 n
                                 2
                              
                              
                                 (
                                 
                                    m
                                    r
                                 
                                 )
                              
                              +
                              m
                           
                         are binary where 
                           
                              |
                              N
                              |
                              =
                              n
                              ,
                           
                        
                        
                           
                              |
                              H
                              |
                              =
                              m
                           
                        .

We used CAB data set to observe the performance of H-CEN model via CPLEX. Since H-CEN model contains exponential number of variables and constraints, the experiment is conducted for first n nodes of the data set where n ranges from 5 to 25 for the 
                           
                              α
                              =
                              0.6
                           
                         value. Moreover, values of problem parameters p and r are set to two which yield O(n
                        4) variables and constraints. Table 5
                         summarizes the results of the computational study for these instances within a time limit of 7200 s (= 2 h).

The conducted computational study revealed that the H-CEN model can only be solvable within 2  h for n ≤ 11. Moreover, for values n ≥ 15, the optimality gap is greater than 50%. Therefore, for even very small instances, an optimal solution of H-CEN cannot be obtained via CPLEX. Thus, we develop enumeration-based solution algorithms presented in the next section.

Since H-CEN-B is a bilevel model and H-CEN contains exponential number of constraints, they are inefficient to solve 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem for even small and medium size networks. Therefore, we propose enumeration-based algorithms to obtain optimal solutions of 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem for problem instances with reasonable sizes.

The first idea is observing all possible choices of leader’s hub sets and the response that the follower gives to these possible solutions. This leads us to complete enumeration algorithm for 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem where for all possible hub set choices of the leader and follower, service level provided to each flow is calculated.

The complete enumeration algorithm enumerates all the possible choices of hub sets of the leader and follower, then for all node pairs i, j ∈ N determines if the flow wij
                         is captured by the follower or not. Therefore, running time of the algorithm is proportional to 
                           
                              
                                 n
                                 2
                              
                              
                                 |
                              
                              
                                 P
                                 p
                              
                              
                                 (
                                 H
                                 )
                              
                              
                                 ∥
                                 
                                    P
                                    r
                                 
                                 
                                    (
                                    H
                                    )
                                 
                                 |
                              
                           
                        .

However, the following theorem states that enumerating all of the remaining feasible solutions is redundant if a feasible solution to 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem is observed.

                           Theorem 3
                           
                              Let Xp be a feasible solution to
                              
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               
                              problem. If there exist
                              
                                 
                                    X
                                    p
                                    ′
                                 
                               
                              and
                              
                                 
                                    Y
                                    r
                                    ′
                                 
                               
                              with
                              
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                          
                                          )
                                       
                                       )
                                    
                                    <
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          ′
                                       
                                       )
                                    
                                 
                               
                              then
                              
                                 
                                    X
                                    p
                                    ′
                                 
                               
                              cannot be an optimal solution to
                              
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               
                              problem.
                           


                              
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          ′
                                       
                                       )
                                    
                                    ≤
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                             ′
                                          
                                          )
                                       
                                       )
                                    
                                 
                               where 
                                 
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       )
                                    
                                 
                               is the optimal solution to 
                                 
                                    (
                                    r
                                    |
                                    
                                       X
                                       p
                                    
                                    )
                                    h
                                    u
                                    b
                                    −
                                    m
                                    e
                                    d
                                    i
                                    a
                                    n
                                    o
                                    i
                                    d
                                 
                               problem given that the hub set of the leader is Xp
                              . Then,
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                          
                                          )
                                       
                                       )
                                    
                                    <
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          ′
                                       
                                       )
                                    
                                 
                               and 
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          ′
                                       
                                       )
                                    
                                    ≤
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                             ′
                                          
                                          )
                                       
                                       )
                                    
                                 
                               together imply that 
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                          
                                          )
                                       
                                       )
                                    
                                    <
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          ′
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                             ′
                                          
                                          )
                                       
                                       )
                                    
                                 
                              . Therefore, 
                                 
                                    X
                                    p
                                    ′
                                 
                               cannot be an optimal solution to 
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               problem.□

By using Theorem 3, we can improve the solution time of complete enumeration algorithm by skipping the search of the follower’s reaction to the choices of the leader which cannot be an optimal solution to 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem. We call this modified version of the algorithm as smart enumeration algorithm.

We can still decrease running time of smart enumeration algorithm if another bound on the amount of the flow captured by the leader is obtained. For the special case p ≥ r, we can improve the efficiency of the algorithm by skipping some feasible solutions that cannot be optimal.

                           Theorem 4
                           
                              If
                              
                                 
                                    p
                                    ≥
                                    r
                                    ,
                                    p
                                    <
                                    |
                                    H
                                    |
                                    −
                                    2
                                    ,
                                    r
                                    ≥
                                    2
                                    ,
                                 
                               
                              all flow values wij
                               > 0 for all i ≠ j and the cost matrix satisfies triangular inequality, then the optimal solution of
                              
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               
                              problem
                              
                                 
                                    X
                                    p
                                    *
                                 
                               
                              satisfies
                              
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                       *
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                    )
                                    <
                                    W
                                    /
                                    2
                                 
                               
                              where W is the total flow over the network.
                           

Assume that 
                                 
                                    X
                                    p
                                    *
                                 
                               is an optimal solution of 
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               problem which satisfies 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                       *
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                    )
                                    ≥
                                    W
                                    /
                                    2
                                 
                              . Then, at least one half of the total flow on the network is captured by the follower. Equivalently, we can say γij
                               < βij
                               hold for at least half of the total flow where γij
                               and βij
                               values are implied by 
                                 
                                    X
                                    p
                                    *
                                 
                               and 
                                 
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                    ,
                                 
                               respectively. Then, the follower can provide a better service level (viz. can provide a better βij
                               value) for at least one half of the total flow by setting his/her hub set 
                                 
                                    
                                       X
                                       p
                                       ′
                                    
                                    =
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                 
                              . Then, 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                       ′
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                    )
                                    =
                                    0
                                 
                               since both the leader and follower provide same service levels for all flows and in case of equity the follower captures the flow. Since 
                                 
                                    p
                                    <
                                    |
                                    H
                                    |
                                    −
                                    2
                                 
                               then there are two nodes i, j ∈ H⊆N but not in 
                                 
                                    X
                                    p
                                    ′
                                 
                              . The follower can move two of his/her hubs to i and j ,and captures the flow wij
                               due to triangular inequality. Let 
                                 
                                    Y
                                    r
                                    ′
                                 
                               this new hub set. Then, 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                       ′
                                    
                                    ,
                                    
                                       Y
                                       r
                                       ′
                                    
                                    )
                                    >
                                    0
                                 
                              . So, we can say that the service levels induced by 
                                 
                                    Y
                                    r
                                    ′
                                 
                               dominate the service levels implied by 
                                 
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                 
                               contradicting with the optimality condition 
                                 
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       ,
                                       
                                          Y
                                          r
                                          *
                                       
                                       
                                          (
                                          
                                             X
                                             p
                                             *
                                          
                                          )
                                       
                                       )
                                    
                                    ≥
                                    f
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       ,
                                       
                                          Y
                                          r
                                          ′
                                       
                                       )
                                    
                                 
                              .

Hence, under the conditions 
                                 
                                    p
                                    ≥
                                    r
                                    ,
                                    p
                                    <
                                    |
                                    H
                                    |
                                    −
                                    2
                                    ,
                                    r
                                    ≥
                                    2
                                    ,
                                 
                               all flow values wij
                               > 0 for all i ≠ j and the cost matrix satisfies triangular inequality, an optimal solution of 
                                 
                                    (
                                    r
                                    |
                                    p
                                    )
                                    h
                                    u
                                    b
                                    −
                                    c
                                    e
                                    n
                                    t
                                    r
                                    o
                                    i
                                    d
                                 
                               problem 
                                 
                                    X
                                    p
                                    ′
                                 
                               satisfies 
                                 
                                    f
                                    (
                                    
                                       X
                                       p
                                       *
                                    
                                    ,
                                    
                                       Y
                                       r
                                       *
                                    
                                    
                                       (
                                       
                                          X
                                          p
                                          *
                                       
                                       )
                                    
                                    )
                                    <
                                    W
                                    /
                                    2
                                 
                              
                              □

Utilizing Theorem 4, we can further improve running time of the algorithm. The bound states that in an optimal solution the leader should get at least 50% of the total flow, so if there exist Xp
                         and Yr
                         with f(Xp, Yr
                        ) > W/2 where W is the total flow on the network with p ≥ r then we can say that Xp
                         is not an optimal solution to 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem. We call this improved version of the algorithm as smart enumeration with 50%-bound.

All algorithms are coded in Java 1.6.0_23 using the same computer. Table 6
                         summarizes all 80 instances used in the computational study of smart enumeration and smart enumeration with 50%-bound algorithms:

For 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem, TR instances are generated for relatively smaller values of number of hubs to be located, that is p, r ∈ {2, 3, 4, 5}, unlike the instances for 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem due to memory requirements and long CPU times. Although worst case running times of all three algorithms are proportional to 
                           
                              
                                 n
                                 2
                              
                              
                                 |
                              
                              
                                 P
                                 p
                              
                              
                                 (
                                 H
                                 )
                              
                              
                                 ∥
                                 
                                    P
                                    r
                                 
                                 
                                    (
                                    H
                                    )
                                 
                                 |
                              
                              ,
                           
                         in practice smart enumeration and smart enumeration with 50%-bound algorithms outperforms complete enumeration dramatically in large instances.


                        Tables 7
                         and 8
                         summarize conducted experiments for 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem for CAB and TR data sets respectively.

Computational analysis also revealed that the leader can increase his/her market share by acting rationally in case of competition. If the leader makes his/her decision ignoring competition, his/her decision will be based on the solutions of some classic models, such as p-hub median and p-hub center. However, the leader may lose some of his/her market in case of another firm entering the market and capturing some of the customers that previously belonged to the leader. In Table 9
                        , we compare percentage of captured flow by the follower if the leader locates his/her hubs on the optimal locations of 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         or the leader locates his/her hubs on p-hub median and p-hub center (without considering competition) and the follower responds based on 
                           
                              (
                              r
                              |
                              
                                 X
                                 p
                              
                              )
                              h
                              u
                              b
                              −
                              m
                              e
                              d
                              i
                              a
                              n
                              o
                              i
                              d
                           
                         problem.

For example, if 
                           
                              p
                              =
                              r
                              =
                              2
                              ,
                              α
                              =
                              0.6
                           
                         and the leader locates his/her hubs by being aware of competition, then the follower can only capture 46.14% of the market. However, if the leader locates his/her hubs according to the optimal solution of p-hub median problem, the follower can capture 65.62% of the market and leader loses 19.48% of the market to the follower. Likewise, optimal solution of p-hub center problem is a worse choice and the follower can capture 75.86% of the market which means that the leader losts 29.72%. Fig. 1
                         depicts the optimal hub locations of 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                              ,
                           
                         
                        p-hub median and p-hub center problems where 
                           
                              p
                              =
                              r
                              =
                              2
                           
                         and 
                           
                              α
                              =
                              0.6
                           
                        .

As seen above, optimal solution of p-hub median is preferable to optimal solution of the p-hub center problem in all instances. This result is a direct consequence of difference in definition of these two problems. While p-hub median problem minimizes weighted sum of service levels of each node pair, p-hub center problem minimizes service level of the most disadvantageous node pair. p-hub center problem ignores the flows between node pairs and focuses only on the distance between them. On the other hand, p-hub median problem locates hubs on a set of node so that the node pairs with higher flow are given more consideration.

Also observe that the p-hub median optimal solution can be regarded as a promising solution to 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem. Especially for larger values of p, the difference in the market share between the optimal solution of 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         and p-hub median is reasonably small and for seven of the 16 instances the optimal hub sets and optimal values of these problems coincide.

Required CPU time for smart enumeration algorithms directly depends on the order of enumeration of leader’s hub set choices. Currently, the algorithm enumerates sets lexicographically. For example, if 
                           
                              p
                              =
                              3
                              ,
                           
                         first algorithm starts with 
                           
                              
                                 X
                                 p
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 }
                              
                              ,
                           
                         then goes on with {1, 2, 4}, {1, 2, 5} and so on. However, as stated in Theorem 3, if a feasible solution which provided genuine bound is already obtained, running time of the algorithm can be improved.

For the instances reported above, the optimal solution of p-hub median problem diverges 4.32% on average from the optimal solution of 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem. Then, another computational experiment is conducted for smart enumeration algorithm on CAB data set with p, r ∈ {2, 3, 4, 5} and 
                           
                              α
                              =
                              0.6
                           
                         by including the bound obtained by the optimal solution of p-hub median problem. Table 10
                         depicts CPU times of this experiment.

The experiment revealed that the running time of smart enumeration algorithm has improved up to 81% (37% on average) for these instances when the optimal solution of p-hub median problem is used a bound on the optimal value of 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problem. Also, as the difference between optimal solutions of p-hub median and 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         problems get smaller, higher improvement is obtained.

Since running times of proposed enumeration based algorithms increase exponentially as p or r increase, for large p and r values these algorithms may not be very efficient. However, as discussed in Table 9, follower’s captures are compared for the cases the leader either chooses UMApHM or 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         as his/her hub set. Similar comparison is summarized in Table 11
                         for TR data set.

As in Table 11, the average demand lost by the leader is 2.45% on average and for the instances where 
                           
                              p
                              =
                              r
                           
                         the average lost is 2.06%. Therefore, additional computational experiments are conducted for the case where the leader chooses UMApHM for TR data set where both the leader and follower locate equal number of hubs.

Since, we do not have chance to compare UMApHM and 
                           
                              (
                              r
                              |
                              p
                              )
                              h
                              u
                              b
                              −
                              c
                              e
                              n
                              t
                              r
                              o
                              i
                              d
                           
                         results for large p and r values, a fair measure of performance UMApHM in a competitive environment could be the case where both firms have equal capabilities. As seen on Table 12
                        , if both player locate equal number of hubs, the leader can capture high amount of flows even ignoring competition and locating hubs according to UMApHM. As number of hubs increases, solution times get reasonably short as well. Hence, it can be concluded that for large values of p and r, UMApHM is a preferable solution for the leader.

@&#CONCLUSIONS@&#

In this paper, we propose a duopoly model where two competitors sequentially choose hub locations and aim to maximize their own market share under Stackelberg competition. Although competitive location has attracted attention of economists and OR practitioners, hub location studies considering competition are rare in the literature. Therefore, formal definitions of terminology and problem were deficiencies in both competitive location and hub location literature. It is assumed that both players have perfect information of the environment. It is also assumed that both players are rational which means that they aim to maximize their market share. The market share of firms is determined by captured flow. Although choice of customers depend on many attributes, we assume that customers prefer the firm which offers a better service level.

From the view of the follower the problem is a maximum cover problem rather than a competitive model. On the other hand, the competition issue becomes important from perspective of the leader. After the leader makes his/her decisions, the follower takes action and then the markets shares are determined. Therefore, the leader’s problem has a bilevel nature. We then propose a bilevel model and an equivalent mathematical model as well as computational complexity results for the problems. Mathematical model of the leader can only be solvable for very small instances and solving the bilevel model is much harder. However, proposed enumeration-based algorithms can solve the problem for relatively bigger instances even though the worst-case complexity tends to complete enumeration. On the other hand, UMApHM can be a promising solution for the leader when solving 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      requires higher amount of CPU time and memory.

Solving the 
                        
                           (
                           r
                           |
                           p
                           )
                           h
                           u
                           b
                           −
                           c
                           e
                           n
                           t
                           r
                           o
                           i
                           d
                        
                      problem exactly or near-optimally is an open research direction. Exact methods such as column generation or branch-and-price can be thought of as possible ideas. Also, some meta-heuristic approaches can be employed to solve the problem within an acceptable optimality gap.

@&#ACKNOWLEDGMENT@&#

The authorssincerely thank the three anonymous referees for contributing to the improvement of their paper. The corresponding author gratefully acknowledges support from the Turkish Academy of Sciences.

@&#REFERENCES@&#

