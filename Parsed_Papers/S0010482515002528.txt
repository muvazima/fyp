@&#MAIN-TITLE@&#A novel multi-scale Hessian based spot enhancement filter for two dimensional gel electrophoresis images

@&#HIGHLIGHTS@&#


               
                  
                  
                     
                        
                           
                           We introduce a novel spot filter for separating the closely overlapping protein spots.


                        
                        
                           
                           We compute the eigen components of the image Hessian of two overlapping spots.


                        
                        
                           
                           We evaluate the performance of the proposed filter on the synthetic and real images.


                        
                        
                           
                           Comparison with other methods and a commercial software package reveals the superior performance of the proposed filter.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spot enhancement filter

Two-dimensional gel electrophoresis

Detection

Segmentation

Proteomics

Hessian

@&#ABSTRACT@&#


               
               
                  Two dimensional gel electrophoresis (2DGE) is a useful method for studying proteins in a wide variety of applications including identifying post-translation modification (PTM), biomarker discovery, and protein purification. Computerized segmentation and detection of the proteins are the two main processes that are carried out on the scanned image of the gel. Due to the complexities of 2DGE images and the presence of artifacts, the segmentation and detection of protein spots in these images are non-trivial, and involve supervised and time consuming processes. This paper introduces a new spot filter for enhancing, and separating the closely overlapping spots of protein in 2DGE images based on the multi-scale eigenvalue analysis of the image Hessian. Using a Gaussian spot model, we have derived closed form equations to compute the eigen components of the image Hessian of two overlapping spots in a multi-scale fashion. Based on this analysis, we have proposed a novel filter that suppresses the overlapping area and results in a better spot separation. The performance of the proposed filter has been evaluated on the synthetic and real 2DGE images. The comparison with three conventional techniques and a commercial software package reveals the superiority and effectiveness of the proposed filter.
               
            

@&#INTRODUCTION@&#

Proteomics is a branch of biotechnology that was introduced for the first time in mid-1990s to study and analyse proteom and its functions [1,2]. Proteomics is used for the large-scale characterization of an entire set of proteins in a cell line, tissue, organism or other biological samples. As a branch of an established science, protemoics governs various methods and tools such as two dimensional gel electrophoresis (2DGE) and mass-spectrometry to study characteristics of proteins. 2DGE is an important, useful and unrivalled method for protein separation and is widely used in the search for disease biomarkers particularly those used for cancer and neurological diseases [3]. The initial reports of successful 2DGE that combined isoelectric focusing (IEF) and sodium dodecyl sulfate polyacrylamide gel electrophoresis (SDS PAGE) were published in 1974 and 1975 [4,5]. The method creates a complete map of separated proteins within the primary sample such as complex whole cells, tissues and organisms. The proteins are separated due to the differences in their isoelectric points, in the first dimension, and subsequently, their molecular weight in the second dimension. These separated and accumulated proteins appear as spots in the resulting gel as well as in the output image (Fig. 1
                     ). 2DGE images pose various challenges such as streaks, cracks, fingerprints, dust, staining variation and overlapping spots [6–8] that can affect the reliability of the analysis [9]. These issues were categorized by Dowsey [10] as
                        
                           •
                           artifacts and co-migration,

intensity inhomogeneity,

geometric distortion.

There have been a considerable number of published works which have tried to overcome problems associated with processing of the 2DGE images. One of the earliest studies of image analysis was performed by Lemkin et al. [12]. They proposed a computer program, FLICKER, for aiding the analysis of two-dimensional gel electrophoresis images. The development of the computers in the 80s facilitated the implementations of these techniques. For example in 1985 Potter et al. presented a new program for the analysis of 2DGE images using an array processor [13]. Initial attempts to build an automated analyser for images were reported in the late 90s [14,15]. In recent years, the main research works have focused on image pre-processing, image denoising, background correction and normalization [7,16–18]. Some works have presented methods to segment 2DGE images [19,20]. Most recently, researchers have focused on reducing the manual interference in image analysis such as unsupervised 2DGE image segmentation based on active contours [21,22]. Nevertheless, recent studies on spot segmentation such as [8,19] show that there are still unresolved problems associated with the spot segmentation in the 2DGE images.

Pedersen categorized the publications on segmentation into three groups of methods based on mathematical morphology, parametric spot modeling, and Gaussian scale-space based blob detectors [23]. Mathematical morphology in image analysis is a broad field of research. One of the earliest works on segmentation of electrophoresis gels using mathematical morphology was performed by Beucher et al. [24,25]. They proposed a watershed based method for segmenting blobs from the background. These methods are well known and commonly used to detect protein spots in images. However, by using these marker-controlled watershed algorithms [26,27], over-segmentation remains a major problem. H-dome is another mathematical-morphology based method used to determine maximal structures in grey-scale inverted images [27]. The main drawback of this method is the detection of overlapping spots. Neighbor overlapping spots are not regional maxima. Therefore H-dome can not separate these spots [23].

Another category of spot detection methods, known as parametric models, is based on some common characteristics of protein spots that can be captured by a model. For instance a 2D Gaussian is one common protein spot model. Inability to simulate saturated spots is the main drawback of the Gaussian kernel used in these methods. Bettens et al. [14] showed that the Gaussian kernel cannot completely capture the patterns of real spots. Instead, they proposed a diffusion model that models the diffusion process of protein migration in the 2DGE. The results showed that these parametric models have good performances on saturated and faint spots [23]. However, overlapping spots are the main problems in these techniques.

There have been some published works on the use of Gaussian scale-space blob detectors. These methods are based on the Laplacian of the Gaussian (LoG) of the image. In LoG method, the critical points of the Laplacian operator are detected as the centers of the blob-like regions after fulfilling certain criteria and constrains [28–30,23]. Protein spots vary in size and therefore the scale-space theory is an effective framework for separating the spots [28,31,32]. Nevertheless, the Laplacian operator that is used in this method is the sum of the second derivatives in each component and returns a scalar with low structural information. Furthermore the LoG method is highly sensitive to noise. Also, the weak and overlapping spots are detected only at low scales where too many false positive local minima are found [23]. It should be noted that scale-space methods such as multi-scale Gaussian techniques help reduce the over-segmentation in watershed algorithm [33]. Despite these published works, overlapping spots remain the main problems in the segmentation of the 2DGE images.

In this work, we propose a novel multi-scale spot enhancement filter (SEF) based on the local second order (Hessian matrix) eigenvalues to overcome the challenge of overlapping spots. The Hessian matrix contains more structural information than the laplace operator and leads to the extraction of more morphological features in comparison to the LoG method. The proposed SEF filter is inspired by the work conducted by the Frangi et al. [34]. They have presented a scale-space method for blood vessel enhancement filtering. We have modified their approach by considering all combinations of eigenvalues in a blob-like regions and proposing a new spot enhancement filter that deals with different sizes and scales of real spots.

Our objective is to improve the detection and segmentation of close and overlapping spots in 2DGE images. For this purpose, we propose a filter formed as a combination of three terms; first, a strength measure which is used to detect all structures; second, a blobness measure which is presented to enhance the blob-like structures; and third, an internal border measure which is provided to extract internal borders in overlapping spots. The Receiver Operating Characteristic (ROC) is used to evaluate the performance of the proposed SEF. We compare the proposed filter with a number of methods including the one proposed by Kostopoulou et al. [19], a marker controlled watershed (MCW) segmentation algorithm [35] and a 2DGE spot segmentation method proposed by Mylona et al. [22]. Also the role of internal border measure in spot segmentation and the effects of the presence of noise are investigated.

The remainder of the paper is organized as follows: In Section 2, the proposed SEF is introduced. In Section 3 the image acquisition and processing tools are described and the quantitative evaluation and results of the application of the proposed filter to synthetic and real images are presented. The conclusion of the work is given in Section 4.

We have proposed a multi-scale morphometric filter based on the second order local-structural-characteristics of images that look for the geometrical circular Gaussian structures throughout the image. Since the spots appear in different sizes, the scales of these spots should be considered in a certain range; hence all the calculations will depend on the selected scales.

The Taylor expansion [34] in the neighborhood of any pixel 
                        
                           
                              x
                           
                           
                              o
                           
                        
                      of the image I can be rewritten as
                        
                           (1)
                           
                              I
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          o
                                       
                                    
                                    +
                                    δ
                                    
                                       
                                          x
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              ≈
                              I
                              
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          o
                                       
                                    
                                    )
                                 
                                 
                                    s
                                 
                              
                              +
                              δ
                              
                                 
                                    x
                                 
                                 
                                    o
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    ∇
                                 
                                 
                                    o
                                    ,
                                    s
                                 
                              
                              +
                              
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                              
                              δ
                              
                                 
                                    x
                                 
                                 
                                    o
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    H
                                 
                                 
                                    o
                                    ,
                                    s
                                 
                              
                              δ
                              
                                 
                                    x
                                 
                                 
                                    o
                                 
                              
                              +
                              
                                 
                                    O
                                 
                                 
                                    3
                                 
                              
                              (
                              δ
                              
                                 
                                    x
                                 
                                 
                                    o
                                 
                              
                              )
                              ,
                           
                        
                     where s is the scale, 
                        
                           
                              ∇
                           
                           
                              o
                              ,
                              s
                           
                        
                      and 
                        
                           
                              H
                           
                           
                              o
                              ,
                              s
                           
                        
                      are the gradient vector and Hessian matrix of the image computed in 
                        
                           
                              x
                           
                           
                              o
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    o
                                 
                              
                              
                              
                                 
                                    y
                                 
                                 
                                    o
                                 
                              
                              ]
                           
                           
                              T
                           
                        
                      at scale s, respectively. To calculate these second order derivatives of I, the convolution with derivatives of Gaussian kernels are used as
                        
                           (2)
                           
                              
                                 
                                    ∂
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              I
                              (
                              x
                              ,
                              s
                              )
                              =
                              I
                              (
                              x
                              )
                              ⁎
                              
                                 
                                    ∂
                                 
                                 
                                    ∂
                                    x
                                 
                              
                              G
                              (
                              x
                              ,
                              s
                              )
                              ,
                              
                                 
                                    ∂
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              I
                              (
                              x
                              ,
                              s
                              )
                              =
                              I
                              (
                              x
                              )
                              ⁎
                              
                                 
                                    ∂
                                 
                                 
                                    ∂
                                    y
                                 
                              
                              G
                              (
                              x
                              ,
                              s
                              )
                              ,
                           
                        
                     where D-dimensional Gaussian is defined as
                        
                           (3)
                           
                              G
                              (
                              x
                              ,
                              s
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          
                                             
                                                2
                                                π
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          D
                                       
                                    
                                 
                              
                              exp
                              (
                              
                                 −
                                 
                                    
                                       ∥
                                       x
                                       
                                          
                                             ∥
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       2
                                       
                                          
                                             s
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                              ,
                           
                        
                     where s is the scale of the calculations. Then the Hessian matrix can be determined as
                        
                           (4)
                           
                              H
                              =
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                xx
                                             
                                          
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                xy
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                yx
                                             
                                          
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                yy
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                              =
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          I
                                          
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   x
                                                   ∂
                                                   y
                                                
                                             
                                          
                                          I
                                          
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   y
                                                   ∂
                                                   x
                                                
                                             
                                          
                                          I
                                          
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                                s
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         ∂
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          I
                                          
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                              .
                           
                        
                     Using the Hessian matrix and its eigenvalues allows us to investigate the principal directions of the local structure. By definition of the relationships between eigenvalues and vectors of H, the local geometric properties can be extracted. From the definition of eigenvalues, we have
                        
                           (5)
                           
                              
                                 
                                    H
                                 
                                 
                                    o
                                    ,
                                    s
                                 
                              
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    s
                                    ,
                                    k
                                 
                              
                              =
                              
                                 
                                    λ
                                 
                                 
                                    s
                                    ,
                                    k
                                 
                              
                              
                                 
                                    
                                       
                                          u
                                       
                                       
                                          ^
                                       
                                    
                                 
                                 
                                    s
                                    ,
                                    k
                                 
                              
                              ,
                           
                        
                     where 
                        
                           
                              λ
                           
                           
                              s
                              ,
                              k
                           
                        
                      is the eigenvalue corresponding to the kth normalized eigenvector 
                        
                           
                              
                                 
                                    u
                                 
                                 
                                    ^
                                 
                              
                           
                           
                              s
                              ,
                              k
                           
                        
                      of the Hessian matrix 
                        
                           
                              H
                           
                           
                              o
                              ,
                              s
                           
                        
                      (at scale s). Due to the dimensions of the 2DGE images discussed in this study, there are 2 eigenvalues that are sorted in ascending order 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ≤
                        
                           
                              λ
                           
                           
                              2
                           
                        
                     . All calculations in this paper are carried out under this assumption. In our 2DGE images, the protein spots appear as dark regions on a brighter background, however, the polarity inverted images are used to simplify the calculations. In Fig. 2
                      a synthetic 2DGE image (a) and its corresponding inverted 3D image (b) are shown.

We study the states of eigenvalues of an ideal Gaussian spot. (The detailed calculations and results are presented in Appendix A.) Based on Eq. (A.3), it can be inferred that the first eigenvalue of the local Hessian is smaller than the second eigenvalue throughout the spot region. The magnitude of the first eigenvalue follows the local intensity of the image; hence the magnitude of the first eigenvalue decreases by moving outward from the center of the Gaussian spot. The border of Ω is defined as the zero-crossing of λ
                     2. Evidently, this border depends on the scale of the Gaussian, as we have shown in Appendix A. The conditions 
                        
                           
                              r
                           
                           
                              2
                           
                        
                        +
                        
                           
                              r
                           
                           
                              ′
                              2
                           
                        
                        =
                        1
                     , 
                        
                           
                              x
                           
                           
                              2
                           
                        
                        +
                        
                           
                              y
                           
                           
                              2
                           
                        
                        =
                        
                           
                              σ
                           
                           
                              2
                           
                        
                     , 
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        <
                        0
                      and 
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        =
                        0
                      are satisfied on the border. In order to illustrate the variation of the eigenvalues, a regional map versus the cross-section of a Gaussian-shape 
                        (
                        
                           
                              I
                           
                           
                              x
                              ,
                              σ
                           
                        
                        )
                      has been plotted in Fig. 3
                     . The relationships between eigenvalues of the Hessian and the geometric structures are summarized in Table 1
                     . As shown, spots can be identified as regions with equal and negative eigenvalues (on polarity inverted images).

The spot enhancement function must eliminate the linear structures and artifacts; furthermore it must keep blob-like spots. Therefore, to create a blobness function the three major terms explained below should be combined. The first term is the energy term which is called hereafter the strength measure. The second term is the blobness measure and the third measure helps separating the overlapping spots. Thus the proposed filter consists of three special structural terms:
                        
                           •
                           Strength measure.

Blobness measure.

Internal border measure.

The strength measure evaluates the structural local energy and is used to differentiate the background from any outstanding feature. We have defined the strength measure as
                           
                              (6)
                              
                                 
                                    
                                       M
                                    
                                    
                                       S
                                    
                                 
                                 =
                                 1
                                 −
                                 exp
                                 (
                                 −
                                 
                                    
                                       S
                                    
                                    
                                       2
                                    
                                 
                                 /
                                 2
                                 
                                    
                                       α
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ,
                              
                           
                        where 
                           S
                           =
                           
                              
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                    
                                       2
                                    
                                 
                              
                           
                         is the second order structureness measure, α is the threshold that controls the sensitivity of the spot filter to the measure S. In this measure, the energy of eigenvalues is calculated. Therefore, according to Table 1, the strength measure suppresses the background and accentuates the other structures that might exist in an image.

We propose the following geometric ratio to measure the local blobness based on eigenvalues of the second order derivatives:
                           
                              (7)
                              
                                 
                                    
                                       R
                                    
                                    
                                       BN
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             λ
                                          
                                          
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             λ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                           
                        As it can be seen, similar values of the first and second eigenvalues (
                           
                              
                                 λ
                              
                              
                                 1
                              
                           
                           ≃
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                        ) reduce 
                           
                              
                                 R
                              
                              
                                 BN
                              
                           
                        . Therefore we plug this ratio in an exponential function to define the blobness:
                           
                              (8)
                              
                                 
                                    
                                       M
                                    
                                    
                                       B
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    −
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                BN
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          
                                             
                                                β
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        where β controls the sensitivity of the spot filter. Thus, as it is seen, this measure is large (
                           ≃
                           1
                        ) in the spot regions and is small in the background.

The above defined blobness measure is insufficient to separate closely overlapping spots. Therefore we propose a new measure to separate the close regions. We have shown that λ
                        2 has a specific behavior around the border between two closely located spots. A zero crossing of λ
                        2 occurs when the distance value between two centers of spots crosses a certain value Appendix B. We have defined a new measure, which depends only on λ
                        2 as below:
                           
                              (9)
                              
                                 T
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 =
                                 exp
                                 (
                                 
                                    −
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                                
                                                   s
                                                
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 )
                                 ,
                                 
                                    
                                       M
                                    
                                    
                                       IB
                                    
                                 
                                 =
                                 exp
                                 (
                                 
                                    −
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   T
                                                   (
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                
                                                   γ
                                                
                                             
                                          
                                          )
                                       
                                       
                                          2
                                       
                                    
                                 
                                 )
                                 ,
                              
                           
                        where s is the scale, γ controls the sensitivity of the function to the measure 
                           T
                           (
                           
                              
                                 λ
                              
                              
                                 2
                              
                           
                           )
                         and 
                           
                              
                                 M
                              
                              
                                 IB
                              
                           
                         is the proposed internal border measure. The basic idea is illustrated in Fig. 18 (Appendix B) where as seen, λ
                        2 increases significantly with increasing the spot distance. As a result, internal border measure defined in (9) is a rapidly increasing function of the distance of two spots. That is, when two spots get closer this measure drops rapidly and suppresses the filter response. Thus, this effect helps isolate closely overlapping spots.

Our spot enhancement filter combines the strength, blobness and internal border measures as
                           
                              (10)
                              
                                 
                                    
                                       B
                                    
                                    
                                       N
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         BN
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   2
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             (
                                             1
                                             −
                                             
                                                
                                                   e
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   2
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                             
                                                
                                                   e
                                                
                                                
                                                   
                                                      
                                                         (
                                                         −
                                                         T
                                                         /
                                                         γ
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             <
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        To study the effect of the internal border measure, the performance of the filter without this measure has been compared to the proposed SEF. Thus, the spot enhancement filter without the internal border measure (SEFW) is defined using the following equations:
                           
                              (11)
                              
                                 
                                    
                                       B
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 {
                                 
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         R
                                                      
                                                      
                                                         BN
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   2
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             (
                                             1
                                             −
                                             
                                                
                                                   e
                                                
                                                
                                                   (
                                                   −
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   /
                                                   2
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                             ,
                                          
                                          
                                             
                                                
                                                   λ
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   λ
                                                
                                                
                                                   2
                                                
                                             
                                             <
                                             0
                                          
                                       
                                       
                                          
                                             0
                                          
                                          
                                             otherwise
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To specify the final values of SEF at each pixel, we compute the filter in a range of s scales, and chose the maximum response over the above range, i.e.
                           
                              (12)
                              
                                 
                                    
                                       B
                                    
                                    
                                       o
                                    
                                 
                                 (
                                 θ
                                 )
                                 =
                                 max
                                 {
                                 
                                    
                                       
                                          B
                                       
                                       
                                          o
                                       
                                    
                                    (
                                    s
                                    ,
                                    θ
                                    )
                                 
                                 }
                                 
                                 for
                                 
                                 
                                    
                                       s
                                    
                                    
                                       min
                                    
                                 
                                 ≤
                                 s
                                 ≤
                                 
                                    
                                       s
                                    
                                    
                                       max
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 s
                              
                              
                                 min
                              
                           
                         and 
                           
                              
                                 s
                              
                              
                                 max
                              
                           
                         are the minimum and maximum scales which are determined by the user and depend on the typical spot sizes, respectively.

In this section, we describe the process we followed to acquire our 2DGE images, and then we present the results including quantitative and qualitative evaluations of our proposed SEF.

Eight real 2DGE images and their corresponding expert segmentations were acquired in the laboratory of the Protein-Chemistry of the Biotechnology research center of the Pasteur Institute (Tehran, Iran). The real images were obtained in a TIFF format with 24-bit gray-level depth, 400 DPI and 3181×3361 pixels. We have converted these 24-bit gray-level depth images to 8-bit gray-level depth. Also, eight synthetic 2DGE images with common noise were created in this work. These synthetic images were used to evaluate the performance of the methods particularly in terms of the noise effects. To create these synthetic images, we combined synthetic two-dimensional Gaussian spots with common noise and artifacts such as streaks, fingerprint, background noise, and staining noise. These synthetic images were created in a TIFF format with 8-bit gray-level depth, and 1000×1000 pixels. To investigate the effects of the level of noise, we created two sets of synthetic images with different SNR of 20dB and 10dB [36]. The proposed filters were implemented using the open source InsightToolkit, and executed on a 3.2GHz Intel workstation running under a Linux system.

In this section, we apply the proposed SEF and SEFW filters on synthetic and real 2DGE images and present the results. Over our entire set of evaluations, the scale and the other parameters were set as follows:
                           
                              •
                              The sensitivity parameters α, β and γ were set to 5, 5 and 1, respectively. It should be noted that increasing α intensifies the spots, whereas reducing β isolates them further. These settings were achieved based on an extensive series of experiments.

Depending on the size of the target spots, we set the min, max and increment size of the scale parameter 2, 15 and 1 pixels respectively.

Similar to the previous studies [37–40], we used Gaussian kernels to model our simulated spots. Fig. 4
                         shows an example comparing the results from SEF and SEFW filters. As expected, both filters enhance the spots as long as only one is considered (Fig. 4(a), (e), (i)) or in the case of two non-overlapping spots (Fig. 4(b), (f), (j)). However, when the overlap between two spots increases (Fig. 4(c)), SEFW detects the two spots as a single merged spot (Fig. 4(g)). In contrast, SEF is more robust to overlapping and detects these spots separately (Fig. 4(k)). This is because of the effect of the additional internal border measure introduced in Eq. (9). As seen, the proposed SEF has a better performance compared to the SEFW for these synthetic samples. In Fig. 4(d), (h) and (l) the single spot plotted in Fig. 4(a) and the two overlapping spot plotted in Fig. 4(c) have been placed in one image to investigate the performance of the proposed SEF in response to single and overlapping spots in one mixed image. As seen, the segmented regions corresponding to the single and overlapping spots have remained unchanged in comparison to Fig. 4(i) and (k). It should be noted that the spot regions in the output of the SEF are smaller than in the outputs of the SEFW. This is because the internal border measure suppresses the intensity on the borders of the spots as a colateral effect. To reduce this counter effect, we dilate the segmented spots in a post-processing step (see Section 3.3.2). The applied dilation may re-merge the segmented regions. To preserve the borders of the isolated regions, we extract the missed borders from the non-dilated image and then we fuse these borders and the dilated image.

To further investigate the effect of the internal border, we compare the mean intensity value on the internal border (MIB) of the output images filtered by SEF and SEFW. We plot the MIB versus distance between two spots for both filters in Fig. 5
                        (a). Also the counts of the segmented spots versus distances between them is plotted in Fig. 5(b). As shown, SEF successfully separates the spots that are only 42 pixels away (center to center), however, SEFW requires much longer distances. The borders of the isolated regions are obtained by a edge detection step. To segment unified regions with multiple maxima, we use the filtered images and the internal borders within these images.

The qualitative results of filtering two real 2DGE images and two synthetic 2DGE images with the proposed spot filters are presented in Figs. 6 and 7
                        
                        , respectively. As seen, the vertical and horizontal streaks of the original image are eliminated by applying SEF and those spots placed within streaks are now observable and segmented. To further discriminate the results of two filters, we have magnified selected subregions of the original and filtered images in Fig. 8
                        . As seen, the spots are enhanced and most of the artifacts and background noise are suppressed in the filtered counterparts. Also, the filters are able to detect the spots quite independently from their sizes, a behavior that is further studied below.


                        Fig. 9
                         shows how the multi-scale computations of the filters allow us to detect spots with various sizes. Panels (a)–(e) have been obtained using scales of 2, 5, 10, 15 and 20 (pixels), respectively. As shown, the bigger the scales, the larger the structures are detected accordingly. By selecting the maximum response of the filter over the employed scales in each pixel, a fused result is obtained in Fig. 9(e), which contains the combined responses of all structures in a single image.

Here, we compare our proposed method with other available segmentation methods that have been implemented in this work. The first comparison is made with Otsu׳s thresholding method [41] utilized and modified by Kostopoulou et al. [19]. The Watershed transform is a useful segmentation algorithm that has been used frequently for 2DGE images segmentation [42,43,35]. We have compared our method with a marker controlled watershed (MCW) segmentation method proposed by Beare et al. [35]. Furthermore, we have implemented the work of Mylona et al. [22] and compared the segmentation results with those of our proposed method. Mylona did not report evaluations for the regional measures; thus we have only compared the number of the detected spots. As a further step, we have compared the results of the proposed method with those of the software package Melanie 7.0. The initial parameters of Melanie 7.0 have been adjusted to overcome the over-segmentation problem of this software.

Here we explain our criteria and tools that will be needed to evaluate the performance of our proposed filter in comparison to the performance of the methods mentioned above. The ground-truth images have been provided by the expert biologists of the Pasteur Institute of Iran for each 2DGE image. In Fig. 10
                            (a) and (b), two ground-truth images for two different yet similar 2DGE images are shown. In the ground-truth images, the white areas indicate the spot regions and the black areas indicate the background of the corresponding 2DGE images.

We have plotted the receiver operator characteristic (ROC) curves [44–46] to figure out the best possible outcomes using our filters described by Eqs. (10) and (11). This plot is a function of true positive rate (TPR) versus false positive rate (FPR) [45,46]. In our application, the positive rate is determined by segmenting the spot pixels out of the background and comparing them with the reference spot pixels from the ground-truth images (Fig. 10(a) and (b)). To segment the filtered images, we have initially binarized them by applying a threshold, and then dilated the outcomes by variable radii. By doing this procedure, we have measured TPR and FPR values at each setting and plotted the ROC curves.

The Yuden index (J) [47,48] and the distance from the optimum classifier point (minimum distance (MI)) [44] are the other two common criteria that are usually used to measure effectiveness of a classifier. J and MI are defined as
                              
                                 (13)
                                 
                                    J
                                    =
                                    max
                                    (
                                    TPR
                                    −
                                    FPR
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    MI
                                    =
                                    min
                                    (
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   TPR
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   FPR
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    )
                                    .
                                 
                              
                           
                        

To calculate the MI (minimum distance index) and J (Yuden) index, the value of the true negative (TN) is required. However, in the case of comparing the spot counts, the value of the TN cannot be determined. Hence, we use the Efficiency as an alternative measure to compare the number of the detected spots by each method. The efficiency is defined as follows [49,50]:
                              
                                 (15)
                                 
                                    Efficiency
                                    =
                                    
                                       
                                          TNDS
                                          −
                                          FP
                                       
                                       
                                          TNDS
                                          +
                                          FN
                                       
                                    
                                    =
                                    
                                       
                                          TP
                                       
                                       
                                          TP
                                          +
                                          FP
                                          +
                                          FN
                                       
                                    
                                    ,
                                 
                              
                           where TP (true positive) and FP (false positive) are defined as the number of correctly detected and falsely detected protein spots, respectively. FN (false negative) is defined as the number of spots incorrectly not detected, and TNDS denotes the total number of detected spots.

In this section, the regional volume of the segmented spots by the proposed SEF is compared with the other implemented methods. To compare visually, the final segmented images of SEFW (spot enhancement filter without internal border measure) and SEF (spot enhancement filter) are shown in Fig. 10(c), (d) and (e), (f) respectively. The unified regions in the outputs of SEFW (Fig. 10(c)–(d)) are segmented to smaller regions in the outputs of the SEF (Fig. 10(e)–(f)).

In addition to binary classification visual results, we have further evaluated the spot volume as an important criterion [40,51]. In this case, the essential parameters TP, TN, FP and FN are calculated as the enclosed volume under the spot region. For instance, the TP is obtained according to the following relationship [40]:
                              
                                 (16)
                                 
                                    
                                       
                                          TP
                                       
                                       
                                          Ω
                                       
                                    
                                    =
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          C
                                          ∩
                                          Ω
                                       
                                    
                                    
                                       
                                          I
                                       
                                       
                                          p
                                       
                                    
                                    ,
                                 
                              
                           where Ω denotes the spot region, C denotes the total true positive regions, and I
                           
                              p
                            is the intensity of the reversed polarity image in pixel p.


                           Fig. 11
                            shows the ROC curve for a sample 2DGE image which has been filtered by the proposed SEF or SEFW. The red star shows the nearest point to the prefect classification point (FPR=0 and TPR=1 condition) [44]. We found that in the optimal condition the point with minimum distance from the prefect classifier is placed on the point selected based on the Yuden index. The threshold corresponding to this optimal condition was selected as a discriminative threshold to segment the filtered image.

As discussed earlier, since the proposed SEF filter suppresses the spot borders and often leads to under-segmentation, we have dilated the segmented spots in an additional post-processing step. We determined the optimum value for the dilation radius using a training image and its corresponding ground-truth segmentation. The Yuden index versus dilation radius was plotted for this image and the optimum radius leading to the maximum Yuden index was chosen. Furthermore, to ensure that the radius we found through this procedure was optimum, each dilation radius was applied to a series of images that were thresholded differently in the range of 0 to 255. Once determined, the dilation radius was not altered during the rest of the experiments in this work. The results of this procedure are shown in Fig. 12
                           . As shown, we found that the radius of 1 (pixel) was optimum.


                           Table 2
                            compares our proposed method with the other implemented methods (Section 3.3). The images 1–3 were used for training of the parameters (applied threshold and dilation size) and the rest of the images were used for testing the performance of the trained filter. The mean and standard deviations of the TPR, FPR, MI and J indices are shown in Fig. 13
                           . As seen, the performance of the proposed SEF is in general better than the other methods.
                              1
                           
                           
                              1
                              The comparison has not been made to the method proposed by Mylona et al. [22] that extracts only the locations of the spots.
                            Also, the final visualizations of the segmented output of the compared methods are shown in Fig. 14
                           . In this figure, a sub-image of a real 2DGE image and a sub-image of a synthetic 2DGE image have been segmented by the compared methods in Fig. 14(a)–(e) and Fig. 14(f)–(j), respectively. Spot regions are shown by red borders and the blue lines in the outputs of MCW are the watershed lines. Table 3
                            compares the mean value of the TPR, FPR, MI and J of the methods applied to our two sets of synthetic images with different SNR. As seen, the segmentation results of the set of images with SNR of 20dB are better than the set of images with SNR of 10dB.

We have further investigated the statistically significant differences between the results of SEF and the other implemented methods by performing t-test evaluations. Table 4
                            presents the h and p values of the t-test method applied to the segmentation, with h=1 indicating a significant difference. As shown, no significant difference exists between SEFW and SEF segmented spots, mainly because the latter is only better in separating spots. However, the differences between the SEF segmented spots and those segmented by the method proposed by Kostopoulou, the MCW method and the commercial software package Melanie 7.0 are significant, suggesting that the improvement made by the proposed filter is in fact effective.

In this section, the counts of the detected spots by the proposed SEF are compared with the other published methods. To specify the locations of the SEF and SEFW segmented spots, we use thresholding to segment the filtered image and find the local maximum intensities of the segmented spots. Then, to compute TP, FP and FN of the spot counts, the locations of the extracted maxima are compared with true locations of the spots using Eq. (15). True locations of the spots are available in the ground-truth database. Fig. 15
                            shows the results obtained through this process. As shown, to count the number of detected spots optimally, the best possible threshold values for SEFW and SEF filters are 11 (Fig. 15(a)) and zero (Fig. 15(b)), respectively. This means that almost every design of non-zero value in the filtered SEF images belongs to a spot region. On the other hand, in order to achieve the best outcome for the number of detected spots using SEFW images, an appropriate thresholding value must be applied.

The results of the counted spots obtained using different methods are shown in Table 5
                           . Additionally, the mean and standard deviations of the TPR, Precision (Pr.) [45], and Efficiency (Eff.) are plotted in Fig. 16
                           . Evidently, these values are maximal for SEF, because of the internal border measure that is involved in the filter׳s response. As shown in Table 5 the Precision of the method proposed by Kostopoulou is good, but the low TPR is the drawback of this method. The method proposed by Mylona et al. [22] has a moderate performance across our database. Furthermore, due to the over segmenting problem associated with the watershed algorithm, the Precision of this method is lower when compared with the proposed SEF. Indeed, despite the good TPR, the large number of falsely detected spots leads to poor Precision. In the case of the commercial software package Melanie 7.0, to reduce the over-segmented regions of the output, we have adjusted the initial parameters; consequently, the Precision of Melanie 7.0 is good but because of the large number of undetected spot regions, the Efficiency of this software is moderate. Table 6
                            compares the mean value of TPR, Precision and Efficiency of the methods applied to our two sets of synthetic images with different SNR. Also, Fig. 17
                            provides a visualization of the mean value of Precision and Efficiency of the methods. As seen, the Efficiency and Precision of all methods applied to the set of synthetic images with higher level of noise (SNR of 10dB) are lower than those of achieved from the set of images with lower level of noise (SNR of 20dB). Nevertheless, the presence of noise reduces the segmentation performance of the method presented by Kostopoulou and those of MCW. The proposed SEF is not sensitive to the presence of noise.

Also, we have applied the t-test to study and compare the results of count-evaluation in Table 7
                           . The h-values of the tests between SEF and the other methods demonstrate the differences. As shown, in terms of the number of detected spots, the proposed SEF filter outperforms all the other methods, suggesting that the internal border measure has been an effective design parameter.

@&#CONCLUSIONS@&#

In this work, a novel spot enhancement filter was proposed for spot detection and noise removal in 2DGE images. The filter is based on the multi-scale image Hessian analysis, which allows us to investigate the local structures and their properties more accurately.

As an important contribution in this work, we proposed two structural measures, blobness and internal border, to accurately characterize the local structure of spots particularly the overlapping spots. The proposed SEF suppresses the intensities in the internal border of overlapping spots and separates the spots located close together.

We compared our segmentation method with other published methods in terms of the regional spot volume, the spot counts and the results of the t-test. We evaluated our proposed and implemented methods using synthetically-made and real 2DGE images. Our quantitative evaluations show that the proposed SEF filter is a viable multi-scale tool that can be employed for enhancing and separating overlapping spots. The proposed filter deals with different sizes and scales of real 2DGE spots and is not sensitive to the presence of noise.

None declared.

@&#ACKNOWLEDGMENT@&#

The authors would like to thank Dr. Behrouz Vaziri, the head of Protein-chemistry laboratory at Pasteur Institute of Iran for his support and guidance.

Here, we calculate the eigenvalues and eigenvectors of the Hessian matrix of an ideal Gaussian-shape spot located on the center of an image (Fig. 3). The intensity equation of this shape can be written as
                        
                           (A.1)
                           
                              
                                 
                                    I
                                 
                                 
                                    0
                                 
                              
                              =
                              
                                 
                                    exp
                                 
                                 
                                    −
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where x and y are the coordination of the pixel p and σ is the space scale of the Gaussian-shape spot. The Hessian matrix of each pixel p can be obtained as
                        
                           (A.2)
                           
                              H
                              =
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   2
                                                
                                             
                                             −
                                             1
                                          
                                          
                                             
                                                
                                                   rr
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   rr
                                                
                                                
                                                   ′
                                                
                                             
                                          
                                          
                                             
                                                
                                                   r
                                                
                                                
                                                   ′
                                                   2
                                                
                                             
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 ]
                                 ,
                              
                           
                        
                     where 
                        r
                        =
                        x
                        /
                        σ
                      and 
                        
                           
                              r
                           
                           
                              ′
                           
                        
                        =
                        y
                        /
                        σ
                      are the normalized coordination values. The eigenvalues of the Hessian matrix can be obtained as
                        
                           (A.3)
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              =
                              −
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          I
                                       
                                       
                                          0
                                       
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    ′
                                    2
                                 
                              
                              −
                              1
                              )
                              .
                           
                        
                     In this work, the eigenvalues are sorted in ascending order 
                        (
                        
                           
                              λ
                           
                           
                              1
                           
                        
                        ≤
                        
                           
                              λ
                           
                           
                              2
                           
                        
                        )
                     . Thus, λ
                     1 is always negative and λ
                     2 can take negative, zero or positive values depending on the pixel location:
                        
                           
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    ′
                                    2
                                 
                              
                              <
                              1
                              ⇒
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              ⟹
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              <
                              0
                              ,
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    ′
                                    2
                                 
                              
                              =
                              1
                              ⇒
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              ⟹
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    r
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    r
                                 
                                 
                                    ′
                                    2
                                 
                              
                              >
                              1
                              ⇒
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              +
                              
                                 
                                    y
                                 
                                 
                                    2
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                              ⟹
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                              .
                           
                        
                     Thus, a border-line in which the sign of λ
                     2 changes is located.

The states of the eigenvalues in a synthetic image with two Gaussian spots close together are investigated in this section. We found that the distance between two spots affects the second eigenvalue on the internal border region. In Fig. 18
                      the eigenvalue states of Hessian images of two Gaussian spots located close together are investigated. In Fig. 18(a)–(c) the overlaps between spots are decreased. The corresponding surfaces of these spots are shown is Fig. 18(d)–(f) and the corresponding 3-D variations of λ
                     2 are shown in Fig. 18(g)–(i). Also the cross-sections of the eigenvalues along the X-axis are plotted in Fig. 18(j)–(l), respectively. As shown, greater distance (Fig. 18(c)) leads to larger variation in second eigenvalue (Fig. 18(i) and (l)).

In this work, the behavior of the eigenvalues of the two close spots has been mathematically studied. In Fig. 19
                      two Gaussian spots with an overlapped region are presented. The intensity function of this image can be written as
                        
                           (B.1)
                           
                              I
                              (
                              x
                              ,
                              y
                              )
                              =
                              
                                 
                                    e
                                 
                                 
                                    −
                                    (
                                    
                                       
                                          (
                                          x
                                          −
                                          A
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              +
                              
                                 
                                    e
                                 
                                 
                                    −
                                    (
                                    
                                       
                                          (
                                          x
                                          +
                                          B
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                    )
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where σ
                     1 and σ
                     2 are the spacial scale of the two Gaussian spots, and A and B are the distances of the centers of the spots from the origin. The first and second derivatives of this 2-D functions can be calculated and then the Hessian matrix can be determined as
                        
                           (B.2)
                           
                              H
                              =
                              [
                              
                                 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                xx
                                             
                                          
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                xy
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                yx
                                             
                                          
                                       
                                       
                                          
                                             
                                                I
                                             
                                             
                                                yy
                                             
                                          
                                       
                                    
                                 
                              
                              ]
                              .
                           
                        
                     
                  

On the origin, the Hessian matrix will be simplified and the eigenvalues of the Hessian matrix on the origin can be obtained as
                        
                           (B.3)
                           
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              =
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (B.4)
                           
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              =
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             1
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          A
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              −
                              
                                 
                                    1
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              (
                              
                                 1
                                 −
                                 
                                    
                                       
                                          
                                             B
                                          
                                          
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              )
                              
                                 
                                    e
                                 
                                 
                                    −
                                    
                                       
                                          B
                                       
                                       
                                          2
                                       
                                    
                                    /
                                    2
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              .
                           
                        
                     We found that the distance between the centers of the spots affects the sign of λ
                     2, while λ
                     1 is negative. The important locations of the spot centers and relevant eigenvalues are summarized below:
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                              and
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ⟹
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              <
                              0
                              
                              and
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              <
                              0
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                              and
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ⟹
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              <
                              0
                              
                              and
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              =
                              0
                              ,
                              
                                 
                                    A
                                 
                                 
                                    2
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                              and
                              
                              
                                 
                                    B
                                 
                                 
                                    2
                                 
                              
                              >
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                                 
                                    2
                                 
                              
                              ⟹
                              
                              
                                 
                                    λ
                                 
                                 
                                    1
                                 
                              
                              <
                              0
                              
                              and
                              
                              
                                 
                                    λ
                                 
                                 
                                    2
                                 
                              
                              >
                              0
                              .
                           
                        
                     Thus, if the distance between two centers is bigger than the sum of the standard deviations of spots, the second eigenvalue has a positive value and vice versa.

@&#REFERENCES@&#

