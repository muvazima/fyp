@&#MAIN-TITLE@&#Identification of representative operating conditions of HVAC systems in passenger rail vehicles based on sampling virtual train trips

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Monte-Carlo-simulation for sampling virtual train trips.


                        
                        
                           
                           Use of GTFS feeds on train schedules and trips as simulation input.


                        
                        
                           
                           Application of an acausal thermal rail vehicle model.


                        
                        
                           
                           Tool to identify HVAC operating conditions for stationary and dynamic simulation.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Rail vehicle thermal loads

Rail HVAC load cycles

Representative operating conditions

Monte-Carlo-based data sampling

General transit feed specification

@&#ABSTRACT@&#


               
               
                  Simulation-driven development and optimization of heating, ventilation and air-conditioning (HVAC) systems in passenger rail vehicles is of growing relevance to further increase product quality and energy efficiency. However, today required knowledge of realistic operating conditions is mostly unavailable. This work introduces methodologies and tools to identify representative operating conditions of HVAC systems in passenger rail vehicles. First a Monte-Carlo-simulation approach was employed to acquire a large set of close-to-reality HVAC operating conditions based on simulated train trips. Sampling simulated train trips bypassed the issue of unavailability of appropriate real-world data. Furthermore the approach allowed high flexibility in considering HVAC-relevant factors associated to different categories of trains, rail networks, operation profiles and meteorological conditions. Second, algorithms and methodologies such as k-means clustering and an adapted Finkelstein–Schafer statistical method were implemented to identify representative HVAC operating conditions from the sampled dataset. Final results comprise a set of time-independent HVAC operating points with associated frequencies of occurrence (ROC-points) as well as a set of time-domain signals for representative days (ROC-signals). These results are input for stationary or dynamic system-level simulations, which are used to support design decisions. The developed methodology was exemplarily applied to urban/suburban trains in Switzerland.
               
            

@&#INTRODUCTION@&#

In passenger rail transportation typical heating, ventilation and air-conditioning (HVAC
                           1
                           Definition of specific abbreviations used in this article: HVAC – heating, ventilation and air-conditioning; ROC – representative operating conditions of HVAC systems in passenger rail vehicles; GTFS – general transit feed specification.
                        
                        
                           1
                        ) systems fitted to rail vehicles account for up to 30% of the overall energy demand [1]. A reduction of energy demand allowing decreased operating costs and lower environmental impact becomes increasingly important in the rail HVAC industry. Consequently it is the task of engineers to identify innovative, efficient, and feasible HVAC concepts as well as effective measures of HVAC optimization.

During real-world operation a rail HVAC system is exposed to a wide range of transient operating conditions. Reasons include varying thermal loads within the vehicle, changing meteorological parameters, and different operation profiles of a train. Thus it is essential to consider representative HVAC operating conditions (ROC) as a base for effective decisions on HVAC system design and optimization right from early phases of the system development process. However, today operating conditions being representative of a specific real-world application are mostly unavailable. Instead, the standards DIN EN 14750-1:2006-08 [2], DIN EN 13129-1:2003-01 [3], and typical customer requirement specifications define single stationary design points, which serve as the dominant criterion for HVAC design. These design points represent extreme operating conditions, which are typically rarely encountered in real-world operation. Vice versa, frequently encountered part-load conditions are usually considered insufficiently today.

Besides serving as an input to front-loading in system development, widely acknowledged representative operating conditions can support communication between system manufacturers, customers, and potentially legislative bodies. Driving cycles (such as the New European Driving Cycle) used to assess emission levels and fuel consumption of motor vehicles are a good example. In a similar way rail HVAC ‘load cycles’ would be valuable for a realistic, transparent, and communicable assessment of different HVAC systems. Here energy efficiency (relative to investment costs) can be seen as a key parameter of HVAC system assessment.

This work introduces a methodology to identify representative rail HVAC operating conditions as a set of time-independent points (ROC-points) and as a set of time series (ROC-signals) of HVAC-specific variables. HVAC-specific variables may include ambient air temperature, ambient air humidity, heat flow of solar radiation, passenger occupancy, and train driving velocity. ROC-points are intended for application in stationary studies of HVAC systems, while ROC-signals address dynamic studies. Out of the basic HVAC operating modes including standby, pre-conditioning, and passenger-operation, the passenger-operation mode is seen as most important and therefore considered in the work at hand. The remaining HVAC modes are left to future studies.

As an objective, generated ROC themselves shall be independent of a specific HVAC implementation to allow comparability of different HVAC concepts and control strategies. Furthermore ROC must appropriately aggregate the total population of HVAC operating conditions, or – in a practical sense – a large number of samples drawn from that total population.

Generated ROC are intended to be used as inputs to numeric simulation models comprising a specific HVAC system in junction with a rail vehicle. Such models may be complex and computationally demanding. Simulation-based studies with these models and ROC as input shall yield results that give insight into the overall system performance. In theory, very similar results should be derived from simulations with the same models but with the total population of HVAC operating conditions as input. So the practical relevance of applying ROC is to obtain insight expressive of real-world conditions with available resources (an up-to-date desktop computer) and with reasonable effort (time to run complex simulation models).

Typically the railway industry is a project business. HVAC systems are engineered to meet the specific demands of a given train service provider (the customer). As a consequence a one-time definition of an overall standard load profile would be insufficient. Hence the required methodology and tools shall allow flexible capturing of project-specific boundary conditions including the regional climate and the train network of future operation. To achieve the objectives the following steps were carried out in this work:
                           
                              ▪
                              Development of a simulation model on thermal loads of a passenger rail vehicle.

Acquisition of data to appropriately describe real-world influencing factors.

Application of a Monte-Carlo-simulation approach for sampling close-to-reality HVAC operating conditions based on virtual train trips.

Development of a methodology to identify a set of points (ROC-points) and a set of signals (ROC-signals) of representative HVAC operating conditions from the sampled data set.

In the present work ROC-points describe the distribution of operating conditions encountered in the sampled trips. Here frequencies of occurrence define weighting factors. Time-dependence is not regarded for ROC-points. On the other hand, ROC-signals are constituted by sets of related time-domain signals of variables characterizing HVAC operation. Each set is associated to an appropriate weighting factor and its signals are defined for one full day. For both, ROC-points and ROC-signals, weighting factors are relevant regarding the computation of yearly energy demand: The demand of the HVAC system as derived from simulating one day of ROC-signals or one ROC-point is multiplied by the corresponding factor. Finally the sum of the energy demand values is an approximation of the overall yearly energy demand.

In simulation-based studies on HVAC systems it depends on the research question and the overall system concept, whether ROC-points or ROC-signals shall be applied. Basically ROC-points are the input to stationary simulations, whereas ROC-signals are used for dynamic simulations. The key question is whether time-dependence and storage effects are of relevance or not. For instance, if charging/discharging cycles of a thermal energy storage are to be analyzed, ROC-signals are required.

This paper is structured as follows: First a brief overview of HVAC system boundaries and related work on ROC is given. In Section 2 key variables are defined and the methodology and input data for the random sampling process are described. In Section 3 the methodology for the identification of ROC is outlined. For demonstration, the methodology and tools developed were applied to generate ROC for urban/suburban trains operating in Switzerland. Results are given in Section 4 followed by a discussion and conclusion in Section 5.


                        Fig. 1
                         schematically shows a passenger rail vehicle with HVAC system. As it can be seen the typical air flows between vehicle and the HVAC unit result in a closed loop. The scheme also indicates key influencing factors on thermal loads, which are to be compensated by the HVAC system.

The time-variance of different influences may differ greatly throughout operation: As an example, the ambient temperature influencing heat influx (in cooling mode) or heat loss (in heating mode) basically changes slowly in the course of a day. On the other hand, heat loads imposed by solar radiation may change rapidly as the exposure of vehicle side walls and windows varies depending on the orientation of the train track in relation to the sun. Switching between travelling on the surface versus in a tunnel generally imposes abrupt changes of influences. At stations door opening goes along with infiltration of ambient air and possibly fast shifts of passenger occupancy. Passengers cause sensible and latent thermal loads and require a certain volume flow of ambient air supply to compensate CO2-production of the human metabolism. The influence of convection at the outer vehicle skin and the impact of solar radiation vary because the relevant outer heat transfer coefficient depends on driving velocity.

In [4] technical recommendations on the specification and verification of energy consumption of rolling stock are presented. There the primary focus lies on traction. The new draft standard prEN 13129:2013 [5] incorporates a set of signals characterizing HVAC operation throughout one day of winter, summer, and intermediate season respectively. However, climatic zones are not differentiated here. The approaches in [4,5] do not sufficiently represent ROC with respect to applications aimed at in the present work.

Small sets of 6–12 operating points associated to weighting factors are proposed in [1,6].
                           2
                           Ref. [6] was elaborated in cooperation with the German Railway Industry Association (VDB).
                        
                        
                           2
                         These small sets of points aim at minimal effort in physical testing in climatic chambers. In contrast, the work at hand focuses at a more detailed set of representative points for application in stationary numeric simulations and at signals for dynamic numeric simulations. Considering the methodology in [1] a random selection process comparable to a common approach used to identify driving cycles is incorporated. As a reference a comprehensive overview of methodologies applied in the field of driving cycles in the automotive industry is provided in [7].

A simulation tool for computing annual energy demand of HVAC units in rail vehicles is presented in [8]. To reduce computation time the simulation can be reduced to a subset of days with representative weather conditions. In contrast to [8] the present work follows the approach of splitting loads from HVAC system implementation. Thus, besides meteorological conditions, characteristics of train trips and rail networks are comprehensively incorporated in the generated ROC.

In summary the present work differs from previous works through primary intended application (numeric simulation versus physical measurement), usability in stationary and dynamic studies, level of detail (e.g. consideration of door opening and solar direction), and flexibility (e.g. regarding different categories of trains and networks).

To generate ROC being independent of a specific HVAC implementation it was necessary to split the HVAC unit from the rail vehicle appropriately. This splitting went along with defining the variables that explicitly show up in the ROC. Depending on the definition of explicit ROC variables HVAC-influencing factors are represented in the ROC at different levels of aggregation. In this context aggregation means that effects of certain influencing factors may be implicitly included in one or multiple of the explicit ROC variables. A higher level of aggregation is associated to a larger computational scope of the model used in the process of ROC generation and a smaller remaining computational scope of the model in ROC application. In other words, sub-models of specific thermodynamic effects (such as the sub-model on air infiltration due to door opening) can be shifted between the models used in ROC generation and ROC application. The variable definition also has an impact on required modelling assumptions and the possibility of modifying model parameters in the model of ROC application.


                        Table 1
                         shows two sets of HVAC-relevant time-dependent variables. The first set can be seen as generic for a HVAC system as it aggregates factors at a high level. The second set is more rail HVAC-specific and comes closer to a definition in draft standard DIN prEN 13129:2013 [5]. This second set aggregates the complex influences related to solar radiation (driving direction, train schedule, vehicle geometry, etc.) only. In this way intuitive understanding and transparency of variable meanings are largely maintained. Furthermore important factors such as passenger occupancy can still be modified in the overall model applying the ROC. As a disadvantage the complexity of the overall model associated to the second variable set is higher than that linked to the first variable set. Finally the second set of variables was chosen to build the representative operation conditions upon. Nevertheless the developed methodology may still be applied to other variable sets, which may include project-specific characterizing variables. This allows a high level of flexibility to adapt to new research questions.

Identification of ROC for a given climatic region, vehicle design, rail network, and train operation clearly requires knowledge of the total population of realistic operating conditions. For the specific project reported in [8], a subset of the variables in Table 1 set 1 was measured throughout a full year during regular operation. However, in general real-world HVAC operational data covering a long period of time (to adequately represent changing weather conditions) as well as a large number of train trips is hardly available. The reason of this lack lies in the high costs and time demand associated to comprehensive field data acquisition. As a solution measurements were substituted by numeric simulations of train trips in the present work. In this way information on encountered operating conditions could be acquired faster and even before a specific train had been built, thus enabling front-loading in development. Furthermore numeric simulation allowed for higher flexibility regarding the examination of influencing factors. In [9] a comparable approach is applied in the field of building energy demand: Building simulation is used to replace lacks of automatic meter readings.

In the present work the key idea regarding data sampling was to run a high number of randomly selected train trips through simulation. These virtual train trips were conducted on randomly selected days on the service provider’s train network and schedule. Regarding the random selection of key inputs, a Monte-Carlo-simulation approach was chosen.

The simulation of train trips considered train driving direction (based on geographic coordinates of stations), train time schedules (for door opening sequences), meteorological data taken from representative meteorological years, rail vehicle parameters, and time variant passenger occupancy. In this way it became possible to find consistent and close-to-reality time signals for the relevant influencing factors. To allow capturing transient effects as they occur during door opening (compare [10]), the simulation was carried out at a sampling time of 1s. Sampling results comprised time signals of ambient air temperature, ambient air relative humidity, heat flow of solar radiation, passenger occupancy, and train driving velocity for each simulated train trip. Time signals covered one full day in seconds.

An acausal quasi-stationary simulation model on thermal loads was built up in the modelling language Modelica. Model equations were based on applicable standards, literature or system insight derived from year-long experience of the rail HVAC manufacturer. As far as possible sub-models, which had been verified and validated through measurements conducted in previous works, were used. A detailed description of the thermal vehicle model itself is not given here as it would burst the scope of this paper. The simulation in Dymola was found to be very robust and sufficiently fast to allow for a high number of simulation runs on an up-to-date PC. In the demonstration 3650days of HVAC operation were sampled within a couple of hours of computation. 3650days equal to measurements on one train throughout about 10years and correspond to more than 3.15*108 sampled operating points.

Employing the random selection approach the input signals for the simulation were automatically generated as outlined in the following:
                           
                              ▪
                              A train trip was randomly selected from a set of train service. The set of train service was in accordance with service provided by a specific train operator and with the train category of interest. (See Section 2.3.1 for details on train service data.)

The selected train trip was replicated such that the train traveled forth and back on the respective route throughout 24h. This step ensured consistent signals throughout one full day. Furthermore this reflected that a particular train is often bound to a certain route in reality.

A day of the year (a date) was randomly selected.

Meteorological data associated to the selected day and the trip/route-specific information were aligned appropriately. (See Section 2.3.2 for details on meteorological data used.)

The time-domain signal of passenger occupancy (as per Section 2.3.3) was added in accordance with train stops.

The time-domain signal of average driving velocity between train stations was added. This signal encoded the sequence of door-opening.

The time-domain signal of driving direction between train stations was added.

Additional time-domain signals such as track type (surface/tunnel) or operating mode were added and properly aligned to the timestamps of the trip. In case of long tunnel sections as they are relevant for metro lines for instance, switching between ambient conditions at the surface and inside the tunnel was implemented.


                        Fig. 2
                         shows a flowchart of the overall workflow. Details on the required input data and associated preprocessing are given in Section 2.3. The identification of ROC is described in Section 3.

For the computation of HVAC operating conditions information on train driving direction, sequence of stops, travelling speed, and the distribution of service provided over the time of the day were of relevance. This sort of information could be largely extracted from schedules as provided by transport service providers. As it was the aim to consider a complete train network, program-based data processing was required. Use of the quasi-standard data format of General Transit Feed Specification (GTFS) according to [11] was found to be a potential and flexible solution.

GTFS feeds allow public transit agencies to publish their transit schedules including associated information, and developers to write applications that consume the data. A GTFS feed is structured as a set of required and optional tables stored as csv-files. Required tables include routes, trips, stops, stop times, calendar, and agency. Tables are composed of defined data fields and are related to each other through id-fields. GTFS is used to feed transit data to Google Maps [11,12]. It can be expected that a growing number of train service providers following open-data-initiatives will make their public transportation schedules available using this format. A list of available GTFS feeds is provided in [13].

In the present work appropriate Matlab functions were implemented to query relevant data from GTFS feeds. Based on the dataset of all train trips offered by a specific service provider (the customer) it was possible to extract a train category (e.g. the category of regional trains) relevant for a rail HVAC development project at hand. Additional functions were implemented to compute information such as the average travelling speed between stops, which was not directly available from GTFS feeds. The service distribution over time of the day was found by automatically counting the number of trains (of a certain train category) being in operation at each minute of the day. The distribution was then normalized.

To demonstrate the methodology several train trips of train category ‘R’ (regional train) were extracted from the GTFS feed of the Swiss federal railways (SFR) available in [14] and based on [15]. In Fig. 3
                            about 3000 trips, from which virtual train trips were sampled in the ongoing, are plotted. As a comparison of different train categories revealed, characteristics differ greatly, which made it essential to generate separate sets of ROC for different train categories.

As an input to the simulation hourly meteorological data including the variables ambient temperature, ambient relative humidity, and solar radiation were used in the form of a representative year for a given geographic region. Such a representative meteorological year, sometimes referred to as a test reference year (TRY), is typically derived from actual measurements over about 20–30years. For example test reference years are available from the American Society of Heating, Refrigerating and Air-Conditioning in [16]. Additionally the corresponding solar position (sun azimuth and elevation angle) was computed with a Matlab function in [17].

Passenger occupancy was basically modeled as an hourly profile defined over a full week. Different prototype profiles were implemented based on data from [18,19], and a customer’s specification. To generate different passenger occupancy profiles based on one prototype profile, fluctuations were modelled by adding noise to the base data. For doing so, data points of the prototype profile were multiplied by a factor, which was randomly drawn from a user-defined Gaussian probability distribution function. For the demonstration in this work the parameters of the Gaussian distribution were chosen to be 
                              
                                 μ
                                 =
                                 1
                              
                            and 
                              
                                 
                                    
                                       σ
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 0.15
                              
                           . As an alternative more detailed data on passenger occupancy might be employed if provided by train operators in the future.

If vehicle parameters of a specific rail vehicle are unavailable or a generic study on a certain category of rail vehicles is aimed at, a set of vehicle parameters typical for a specific vehicle category may be used. To find typical sets of parameters vehicles encountered in previous customer projects of the rail HVAC manufacturer were first categorized as urban/suburban trains or main-line/high-speed trains. Then the mean value within a category was computed for each vehicle parameter (such as the U-value of walls). The specific parameter values of each vehicle in a category were then compared to the parameter mean values and the computed deviations were normalized. The parameter deviations were aggregated to one scalar value for each rail vehicle in a category. The rail vehicle showing the smallest total deviation in a category was selected as the best fit. Optional slight parameter harmonization through an expert completed the process. Key parameters of the urban/suburban rail vehicle used for demonstration in this work are as follows: nominal passenger capacity: 110 persons; window area: 26.8m2; window U-value: 2.5W/(m2
                           K); window absorption coefficient: 0.40; window transmission coefficient: 0.42; skin area (without windows): 182.8m2; skin U-value: 2W/(m2
                           K); skin absorption coefficient: 0.7.

After a large number of operating conditions had been sampled from a specific population through simulations of train trips covering 24h each, ROC-points and ROC-signals were extracted. An overview of the identification algorithms implemented in the present work is shown in Fig. 4
                     . Details are given in the following sections.

To acquire representative HVAC operating conditions in the sense of a set of time signals the following basic approaches were considered:
                           
                              1.
                              Synthetic generation of signals based on characteristics identified from sampled signals.

Extraction of representative signals from sampled signals.

Regarding the first approach an example of application can be found in [20]. There realistic synthetic vertical force signals induced by people walking are generated to serve as a design input for structures such as footbridges or long-span floors. Based on a large database of measured walking time series the authors extracted a template signal waveform of normalized walking cycles, modelled the variability of cycle intervals, and finally generated synthetic vertical load cycles. A typical application of the second approach addresses the identification of representative meteorological years. In the application at hand, having a number of related signals, the second approach was considered as more straight-forward and was thus implemented.

For ROC-signals the simulated train trips were first grouped either based on the time of the year or on clusters of signal characteristics. Then each trip within a group was rated based on the trip’s representativeness of the entirety of the trips assigned to the respective group. Finally the best rated trip(s) of each group was/were exported as ROC-signals for use in HVAC simulation.

In the implemented software tool the user can define the method of grouping and the number of groups. The group count affects the resolution of the generated ROC-signals and the compression-rate of the original data. In practice it depends primarily on the application and research question, which option of grouping is preferable.


                           Option 1: Grouping of trips based on the time of the year
                        

Grouping based on time is conceptionally close to the identification of representative years of meteorological data. In the present work groups represented user-definable bins of consecutive days throughout a year. For instance a group may represent a month. The criterion for assigning virtual trips to groups was the date when a train trip was conducted. The weighting factor associated to a group was defined by the number of days represented by the group and the number of representative trips drawn from that group.


                           Option 2: Grouping of trips based on clusters of signal-characterizing statistical measures
                        

First a set of r
                           scalar descriptive parameters was computed for the signals of each sampled trip. To be specific, the eleven (r
                           =11) parameters given in Table 2
                            were used. The date of a virtual train trip was not of relevance here. Based on this characterization each trip can be perceived as a point in an r-dimensional hyperspace. To identify a user-defined number of clusters in that r-dimensional point cloud, the k-means clustering algorithm (with distance measure city block) could be applied on the set of descriptive parameters right away. Unfortunately distance measures as used in the k-means clustering algorithm tend to lose their expressiveness in high dimensional spaces. Consequently clustering may perform unsatisfactory in high dimensions. This issue is known as ‘curse of dimensionality’ in the literature, compare with [21] for details. To bypass the risk of clustering failure it was found to be reasonable to perform a Principle Component Analysis (PCA) on the set of descriptive parameters first. Principle components that did not add much information could be discarded, which reduced the dimensionality of the feature space to 6. This reduced feature set was then presented to the k-means clustering algorithm. As a result each sampled trip was assigned to a cluster. The number of trips assigned to a particular cluster was used to define the weighting factor associated to that cluster. The clusters represented the groups used for further processing.

Now the m most representative trips of each group needed to be identified. Here m is a user-defined number. The implemented methodology was inspired by a common methodology applied to extract representative meteorological years from weather data observed throughout some 20–30years. Useful insight into this field is provided in [22,23]. There weather data was first characterized by using the distributions of separate meteorological signals (temperature, humidity, etc.). Then associated distributions were compared by means of the Finkelstein–Schafer statistical method. In the context of measuring distribution distances on cumulative distribution functions (cdf) and probability density functions (pdf), a practical overview is given in [24].

In the present work the compound distribution of the n HVAC-relevant signals was used to describe the overall distribution and correlation comprehensively. This enhanced the approach described in [22,23]. In practice a ‘n-dimensional histogram’ – further referred to as (n-dimensional) frequency-matrix – was introduced. Here n was 5 according to the definition of the ROC variable set 2 shown in Table 1. Besides the compound distribution, total variation of driving speed, which contains the door opening sequence, was additionally included for signal characterization in this work. In detail the developed algorithm comprised the following steps:
                              
                                 1.
                                 Supported by the developed tool the user defined bins for each variable to create a n-dimensional grid of the frequency-matrix. The number of bins on each dimension correlates with resolution.

For each trip i of the k trips assigned to group j the frequency-matrix 
                                       
                                          
                                             
                                                FM
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     was generated as a characterization of the respective trip. More precisely, for each time instance 
                                       
                                          τ
                                          ∈
                                          {
                                          1
                                          ;
                                          
                                          2
                                          ;
                                          
                                          3
                                          ;
                                          
                                          …
                                          ;
                                          
                                          86
                                          ,
                                          400
                                          }
                                       
                                     the signal values 
                                       
                                          
                                             
                                                t
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                          
                                          (
                                          τ
                                          )
                                       
                                    , 
                                       
                                          
                                             
                                                φ
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                          
                                          (
                                          τ
                                          )
                                       
                                    , 
                                       
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      sun
                                                   
                                                   
                                                      trip
                                                      
                                                      i
                                                      ,
                                                      
                                                      group
                                                      
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                          (
                                          τ
                                          )
                                       
                                    , 
                                       
                                          
                                             
                                                pax
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                          
                                          (
                                          τ
                                          )
                                       
                                     and 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                trip
                                                
                                                i
                                                ,group
                                                
                                                j
                                             
                                          
                                          
                                          (
                                          τ
                                          )
                                       
                                     corresponded to one cell of the frequency-matrix and the count of occurrences for this cell was increased by one.

To characterize the entirety of operating conditions encountered in all k trips assigned to group j the overall frequency-matrix 
                                       
                                          
                                             
                                                FM
                                             
                                             
                                                overall
                                                ,group
                                                
                                                j
                                             
                                          
                                       
                                     was computed according to (1) and served as a reference for later comparison with single trips.
                                       
                                          (1)
                                          
                                             
                                                
                                                   
                                                      FM
                                                   
                                                   
                                                      overall
                                                      ,
                                                      
                                                      group
                                                      
                                                      j
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   
                                                      FM
                                                   
                                                   
                                                      trip
                                                      
                                                      i
                                                      ,
                                                      
                                                      group
                                                      
                                                      j
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

To ensure comparability of the trip-specific frequency-matrices with the overall frequency-matrix, each matrix was normalized such that the sum of all of its elements equaled 1. This resulted in 
                                       
                                          
                                             
                                                
                                                   
                                                      FM
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                
                                                   
                                                      FM
                                                   
                                                   
                                                      ∼
                                                   
                                                
                                             
                                             
                                                overall
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                    . As described in [22,23] the so-called Finkelstein–Schafer statistics was employed in the field of identifying representative meteorological years. In the present work the comparison of the frequency-matrices was achieved in a closely related way according to (2). d1–d5 denote the indices of bins along the five dimensions of the frequency matrix. #d1–#d5 are the associated numbers of bins. The scalar value 
                                       
                                          
                                             
                                                WS
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     was computed as a measure of dissimilarity between the signals’ compound distribution of trip i on the one hand and the signals’ overall compound distribution of all k trips in group j on the other hand. The smaller 
                                       
                                          
                                             
                                                WS
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     is, the more representative trip i is with respect to the group. 
                                       
                                          (2)
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     FS
                                                                  
                                                                  
                                                                     ∼
                                                                  
                                                               
                                                               
                                                                  trip
                                                                  
                                                                  i
                                                                  ,
                                                                  
                                                                  group
                                                                  
                                                                  j
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 fs
                                                                              
                                                                              
                                                                                 ∼
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           trip
                                                                           
                                                                           i
                                                                           ,
                                                                           
                                                                           group
                                                                           
                                                                           
                                                                              
                                                                                 j
                                                                              
                                                                              
                                                                                 d
                                                                                 1
                                                                                 ,
                                                                                 d
                                                                                 2
                                                                                 ,
                                                                                 d
                                                                                 3
                                                                                 ,
                                                                                 d
                                                                                 4
                                                                                 ,
                                                                                 d
                                                                                 5
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       FM
                                                                                    
                                                                                    
                                                                                       ∼
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 overall
                                                                                 ,
                                                                                 
                                                                                 group
                                                                                 
                                                                                 j
                                                                              
                                                                           
                                                                           -
                                                                           
                                                                              
                                                                                 
                                                                                    
                                                                                       FM
                                                                                    
                                                                                    
                                                                                       ∼
                                                                                    
                                                                                 
                                                                              
                                                                              
                                                                                 trip
                                                                                 
                                                                                 i
                                                                                 ,
                                                                                 
                                                                                 group
                                                                                 
                                                                                 j
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               
                                                                  #
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              FM
                                                                           
                                                                           
                                                                              ∼
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        overall
                                                                        ,
                                                                        
                                                                        group
                                                                        
                                                                        j
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  WS
                                                               
                                                               
                                                                  trip
                                                                  
                                                                  i
                                                                  ,
                                                                  
                                                                  group
                                                                  
                                                                  j
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     1
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     #
                                                                     d
                                                                     1
                                                                  
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     2
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     #
                                                                     d
                                                                     2
                                                                  
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     3
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     #
                                                                     d
                                                                     3
                                                                  
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     4
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     #
                                                                     d
                                                                     4
                                                                  
                                                               
                                                            
                                                            
                                                            
                                                               
                                                                  
                                                                     ∑
                                                                  
                                                                  
                                                                     d
                                                                     5
                                                                     =
                                                                     1
                                                                  
                                                                  
                                                                     #
                                                                     d
                                                                     5
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 fs
                                                                              
                                                                              
                                                                                 ∼
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           trip
                                                                           
                                                                           i
                                                                           ,
                                                                           
                                                                           group
                                                                           
                                                                           
                                                                              
                                                                                 j
                                                                              
                                                                              
                                                                                 d
                                                                                 1
                                                                                 ,
                                                                                 d
                                                                                 2
                                                                                 ,
                                                                                 d
                                                                                 3
                                                                                 ,
                                                                                 d
                                                                                 4
                                                                                 ,
                                                                                 d
                                                                                 5
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

In a similar way, additional parameters characterizing the time-domain signals can be computed for each trip i of group j, aggregated to form a reference representing the entirety and compared to that reference. Here the total variation 
                                       
                                          tv
                                       
                                     of the driving velocity 
                                       
                                          v
                                       
                                     was used as a measure of the door opening sequence. Here 
                                       
                                          
                                             
                                                tvm
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     denotes the dissimilarity of trip
                                       i to the entire group j, compare (3).
                                       
                                          (3)
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        tv
                                                                     
                                                                     
                                                                        ∼
                                                                     
                                                                  
                                                               
                                                               
                                                                  group
                                                                  
                                                                  j
                                                               
                                                            
                                                            =
                                                            median
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              tv
                                                                              (
                                                                              
                                                                                 
                                                                                    v
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    1
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              tv
                                                                              (
                                                                              
                                                                                 
                                                                                    v
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    2
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              ⋮
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              tv
                                                                              (
                                                                              
                                                                                 
                                                                                    v
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    k
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                              )
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  tvm
                                                               
                                                               
                                                                  trip
                                                                  
                                                                  i
                                                                  ,
                                                                  
                                                                  group
                                                                  
                                                                  j
                                                               
                                                            
                                                            =
                                                            abs
                                                            
                                                               
                                                                  
                                                                     tv
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    v
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    i
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                     -
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 tv
                                                                              
                                                                              
                                                                                 ∼
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           group
                                                                           
                                                                           j
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

In the next step the (e.g. two) measures of dissimilarity of each trip i, 
                                       
                                          
                                             
                                                WS
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     and 
                                       
                                          
                                             
                                                tvm
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                    , were normalized to 1. A weighted average based on user-definable weighting factors aggregated the measures of dissimilarity to one scalar value 
                                       
                                          
                                             
                                                rep
                                             
                                             
                                                trip
                                                
                                                i
                                                ,
                                                
                                                group
                                                
                                                j
                                             
                                          
                                       
                                     per trip i. According to (4) this could be rewritten to a vector 
                                       
                                          
                                             
                                                rep
                                             
                                             
                                                group
                                                
                                                j
                                             
                                          
                                       
                                    , which was sorted in an ascending order. The trip indices of the first m vector elements denoted the most representative trips of group j. These were exported for application in dynamic system performance simulations. 
                                       
                                          (4)
                                          
                                             
                                                
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  rep
                                                               
                                                               
                                                                  group
                                                                  
                                                                  j
                                                               
                                                            
                                                            =
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    rep
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    1
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    rep
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    2
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              ⋮
                                                                           
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 
                                                                                    rep
                                                                                 
                                                                                 
                                                                                    trip
                                                                                    
                                                                                    k
                                                                                    ,
                                                                                    
                                                                                    group
                                                                                    
                                                                                    j
                                                                                 
                                                                              
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  rep
                                                               
                                                               
                                                                  group
                                                                  
                                                                  j
                                                                  ,
                                                                  
                                                                  sorted
                                                               
                                                            
                                                            =
                                                            sort
                                                            (
                                                            
                                                               
                                                                  rep
                                                               
                                                               
                                                                  group
                                                                  
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 

Steps 2–6 were repeated for all l groups.

ROC-points were obtained from an overall frequency-matrix, a n-dimensional ‘histogram’ of key variables for HVAC operation (compare Section 3.1.2). For all trips sampled, the signal values were sorted into the frequency-matrix on the time-basis of one second. The high temporal resolution allowed representation of door opening. To increase expressiveness, the algorithm enabled the consideration of the distribution of train service over the time of the day (derived from the GTFS feed) through weightings in the frequency-matrix. In this way operating conditions encountered when only few trains were in operation (e.g. during night time), were considered as less relevant compared to those encountered when many trains were in service.

In the next step the bins of the frequency-matrix were sorted based on their frequency values (the numbers of weighted assignments). Next, for each bin the centroid was computed, which represents a single ROC-point. The s most important (most frequent) operating points were then exported for further use in stationary simulations. The definition of bins of the frequency-matrix and the number s could be adjusted by the user to suit demands on resolution and total number of points.

The key results of the present work include the developed methodology as well as appropriate simulation models and specific processing tools implemented to identify ROC for use in stationary or dynamic numeric simulations. As a demonstration ROC-points and ROC-signals for urban/suburban trains operating in Switzerland were generated. Extracts of the results are presented in the following.


                        Table 3
                         shows an excerpt of the generated set of 500 ROC-points. Point indices rank the points based on their total times of occurrence during a year. As it can be seen for this case, the most relevant point 1 represents relatively moderate conditions with respect to ambient temperature, passenger occupancy and solar heat influx. Thus, and as indicated earlier, this point differs greatly from common design points. In the practical application each point of the overall set is passed to the stationary simulation on HVAC system performance. The simulation result is then weighted by the time associated to each point.

To modify the resolution of the ROC-points the user can modify two parameters in the algorithm: the overall number of cells in the frequency-matrix and the number of cells to be exported to the results list. Regarding the latter Fig. 5
                         shows the information content over the number of frequency-matrix cells. In the given case, 500 operating points out of 26,250 cells covered about 85% of the secondly sampled operating points.


                        Fig. 6
                         exemplarily shows a 2-dimensional projection of the 5-dimensional frequency-matrix. As a 2-dimensional histogram, the given heat plot approximates the compound distribution of ambient temperature and ambient relative humidity. As it can be seen hot temperatures occurred very seldom in junction with high humidity levels in this case. On the other hand temperatures in the range of 3–14°C at a relative humidity of around 74% were encountered frequently. Information of this kind may itself be an input for design decisions on HVAC systems.

In this demonstration ROC-signals were identified by using time-based grouping with one group per calendar month of the year. As an example Fig. 7
                         shows the signals of HVAC-relevant variables of a representative day in March. The plots show signals of arbitrarily chosen virtual trips of the time-based group March in grey color as a reference on general trends. The signals of the virtual trip found as most representative are plotted in red. To give an overview of the overall ROC-signals, the mean values of each signal and of each group (month) are plotted in Fig. 8
                        .

The overall set of representative signals is applied as input to dynamic performance simulations of a HVAC system fitted to a rail vehicle. While the signals are basically defined for 24h, the actual train operation time needs to be taken into account to compute yearly energy demand. Irrelevant timespans can be discarded based on project-specific operation times. This is exemplarily indicated by the dark background for out-of-service time in Fig. 7. The distribution of train service provided over the time of day (as derived from GTFS feeds) can be used to characterize practical relevance of time intervals.

The signal of heat flow due to solar radiation clearly shows sunrise and sunset. The high-frequent fluctuations are the results of changing orientation of the rail vehicle with respect to the sun as well as varying train speed (e.g. due to train stops). The speed-dependence is due to the implicit consideration of convection at the outer vehicle skin in the applied thermal vehicle model. In the profile of passenger occupancy morning and evening peak are clearly apparent. The signals of ambient temperature and ambient relative humidity show reverse trends. At a higher zoom level time and duration of train stops can be seen in the plot of driving speed. In principle result plots derived through k-means clustering instead of time-based grouping are congeneric.

@&#DISCUSSION AND CONCLUSIONS@&#

Regarding the overall methodology, simulation models, and processing tools, common techniques of verification and validation were carefully carried out. Following [25,26] these techniques included desk checking, sub-model testing, face validity, and a sensitivity analysis. As shown above results are relatively transparent and intuitively interpretable due to the selection of characterizing variables. This facilitated checks on plausibility of results.

To foster wide acceptance and to identify possible needs for improvement, the next level of methodology verification and ROC validation shall be based on long-term real-world measurement data. Currently applicable data is not available. To fill the gap a program of continuous field data acquisition running over about two years has recently been started. An ICE high speed train mainly operating in Germany has been equipped with a data acquisition system and additional sensors to comprehensively log relevant data at a frequency of about 0.1Hz. Via a mobile network connection measurement data is transferred to a central server and fed into a custom-developed database. Field data acquisition and basic processing shall be finished by early 2018. Afterwards the measurement-based verification and validation can be carried out. In this context it must be noted that the field data represents an excerpt of the total population of HVAC operating conditions. In particular the weather conditions encountered during field data acquisition might differ considerably from the long-term average and from data in representative meteorological years.

In the current implementation of the methodology, virtual train trips incorporated meteorological data associated to one location only. The implied spatial limitation of validity is not critical for urban/suburban trains travelling short distances only. However, along long distance train trips of main-line/high-speed trains possible regional differences of climatic conditions are currently not considered.

Representative meteorological years, which are commonly used in building simulation software and which served as input to the simulations in the present work, do not reflect the global warming aspect. Given that rail vehicles are designed for up to about 30years of operation, consideration of global warming could increase the level of detail of generated ROC.

Both aspects, spatial weather data resolution and global warming, could be handled by employing a weather generator. A weather generator predicts weather parameters for a given region and a given day in the future while ensuring consistency of different weather parameters. The methodology of sampling virtual trips could be modified such that the random selection algorithm picks a day of the future vehicle operating time instead of a day of the representative meteorological year.

Future work aiming at the increase of the overall level of detail should address these aspects besides the improvement of level of detail of passenger occupancy profiles. Furthermore HVAC modes of pre-conditioning and standby could be considered in a future work to fully represent the mission profile of a rail HVAC system. Immediate next steps will address the application of ROC for simulation-based assessments of HVAC concepts.

@&#CONCLUSION@&#

The present work introduced a methodology to (1) sample close-to-reality HVAC operating conditions based on simulated train trips via a Monte-Carlo-simulation approach and to (2) identify representative rail HVAC operating conditions (ROC). Thus this research fills the existing lack of ROC. Random sampling of virtual train trips with GTFS feeds as input was found to be an appropriate solution to the issue of measurement data unavailability. This approach also enabled flexible generation of project-specific ROC for front-loading. A common methodology applied in the generation of representative meteorological years was recognized to be a suitable base for the developed methodology to identify ROC. Enhancements included the multi-dimensional signal characterization as well as the option of k-means clustering. In contrast to developments in the literature, the presented methodology can generate ROC as a set of points and as a set of signals to meet needs of different research questions. As a demonstration methodology and tools were applied on regional trains operating in Switzerland. Results were found to be credible, but further verification based on long-term real-world measurements is aimed at. Looking at the practical relevance the research outcome represents a tool to support profound design decisions, effective optimizations and transparent communication in the development of rail HVAC systems.

@&#ACKNOWLEDGEMENTS@&#

This research was partly funded by the Austrian Research Promotion Agency, FFG under the Reference No. 848204. The authors thank Mr. Aigner, head of the department of advanced research and development at Liebherr-Transportation Systems, for his contribution to the work at hand.

@&#REFERENCES@&#

