@&#MAIN-TITLE@&#A computer algebra system for analysis and control of nonlinear time-delay systems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           SAC is a toolbox developed for analysis and control of nonlinear time-delay systems.


                        
                        
                           
                           This GNU/GPL software can be used to work with systems without delays.


                        
                        
                           
                           It includes routines, based on the differential-algebraic and geometric approaches.


                        
                        
                           
                           These powerful approaches involve lengthy and cumbersome computations.


                        
                        
                           
                           An algorithm of a new powerful geometric tool, the extended Lie bracket, is included.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Nonlinear time-delay systems

Differential-algebraic approach

Extended lie bracket

Computer-aided control systems design

Symbolic Analysis and Control software

Algorithms

@&#ABSTRACT@&#


               
               
                  An open-source computer algebra system toolbox devoted to the analysis and synthesis for a wide class of nonlinear time-delay systems is introduced. This contribution provides a practical way to carry out all the computations used to characterize several properties of the systems under consideration, which involve elements in a non-commutative ring of polynomials, and an extended version of the Lie brackets. The package usage will be illustrated with some examples.
               
            

@&#INTRODUCTION@&#

There are several reasons which motivate the continuous interest and development in the time-delay systems field research. Time delays naturally appear in many physical systems (see e.g. [1]). However, standard control techniques generally cannot be applied because they generally lead to non-causal solutions [2–4]. This lack of mathematical tools is even greater in the nonlinear case, where the Lie derivative and Lie brackets, which are basic operations for the so-called geometric approach are not valid for this class of systems due to its infinite-dimensional nature. An algebraic approach, valid for nonlinear time-delay systems (NLTDS), developed in [5,6] has proved to be effective in tackling several problems of analysis [6–11], and synthesis [12,13]. The geometric tools have also been generalized with the introduction of an extended Lie bracket in [14]. However, the computations associated to both, the geometric and algebraic approaches, are difficult to use in practice, especially as the order of the system and the quantity of associated variables increase.

Nowadays there are few symbolic packages specialized in nonlinear systems. Amongst them, NOLIACPA, based on Maple®, was developed for continuous-time systems [15]. NLControl is a software project addressing continuous and discrete nonlinear control systems based on Mathematica®, and made available online via the webMathematica software. It was reported in [16,17]. For delay-differential algebraic equations OreModules [18], a Maple® implementation, deals with modules over Ore algebras computationally. An toolbox [19], and a numerical bifurcation analysis package [20], were developed in Matlab®. CoCoA [21], and Macaulay [22], are software systems that have been used to deal with linear time-delay systems.

Despite all these contributions, a general-purpose software toolbox for time-delay systems was still missing in the literature.

SAC is a library written in Maxima, an open-source Computer Algebra System (CAS), devoted to the analysis and control of a wide class of nonlinear time-delay systems described by
                        
                           (1)
                           
                              Σ
                              :
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                                (
                                                t
                                                )
                                                =
                                                f
                                                (
                                                x
                                                (
                                                t
                                                -
                                                i
                                                )
                                                ,
                                                
                                                u
                                                (
                                                t
                                                -
                                                i
                                                )
                                                ,
                                                
                                                i
                                                ∈
                                                S
                                                _
                                                )
                                             
                                          
                                          
                                             
                                                y
                                                (
                                                t
                                                )
                                                =
                                                h
                                                (
                                                x
                                                (
                                                t
                                                -
                                                i
                                                )
                                                ,
                                                
                                                i
                                                ∈
                                                S
                                                _
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The state 
                        
                           x
                           (
                           t
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                     , the control input 
                        
                           u
                           (
                           t
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 m
                              
                           
                        
                     , and the output 
                        
                           y
                           (
                           t
                           )
                           ∈
                           
                              
                                 R
                              
                              
                                 p
                              
                           
                        
                     . The entries of f(⋅) and h(⋅) are meromorphic functions of their arguments. S_ is a finite set of constant time delays, such that
                        
                           (2)
                           
                              f
                              (
                              x
                              (
                              t
                              -
                              i
                              )
                              ,
                              i
                              ∈
                              S
                              _
                              )
                              :
                              =
                              f
                              (
                              x
                              (
                              t
                              )
                              ,
                              x
                              (
                              t
                              -
                              1
                              )
                              ,
                              …
                              ,
                              x
                              (
                              t
                              -
                              s
                              )
                              )
                              ;
                              
                              S
                              _
                              :
                              =
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              s
                              }
                           
                        
                     and 
                        
                           h
                           (
                           ·
                           )
                        
                      defined in a similar vein.

The effectiveness showed by the so-called algebraic approach in tackling analysis issues like accessibility [23], observability [6,7], triangular equivalence [8], identifiability [9] and to solve control problems like input–output feedback linearization [24], disturbance decoupling [25] and trajectory tracking [12]. Also the recent introduction of the extended Lie brackets in [14] and, through its application, the advances to answer some basic problems related to integrability [14], feedback linear equivalence [26], observability [27] and new results on accessibility [28], are other motivation for studying this particular class of systems.

However, a drawback of both approaches is the difficulty of the involved computations to be carried out by hand, due to the use of a very particular non-commutative ring of polynomials, and to the distributions, in the case of the algebraic and geometric approach, respectively, hence the necessity of a software development [29].

The main contribution of this paper is the presentation of SAC, a free open-source and general-purpose toolbox, which implements most of the basic computations involved in the delay-differential algebraic approach [30], the geometric tools developed recently in [14], and the combination of both approaches to determine important structural properties of nonlinear systems with or without delays. SAC is freely available at [31].

The paper structure is as follows. First, some definitions and notations of the differential-algebraic approach are recalled in Section 2. The software development process is detailed in Section 3, followed by some examples that give an overview of the current toolbox capabilities in Section 4. Section 5 discusses some techniques to improve the performance, and it ends with a discussion in Section 6.

Let 
                        
                           K
                        
                      denote the field of meromorphic functions of a finite number of symbols in
                        
                           
                              {
                              x
                              (
                              t
                              -
                              i
                              )
                              ,
                              u
                              (
                              t
                              -
                              i
                              )
                              ,
                              …
                              ,
                              
                                 
                                    u
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              (
                              t
                              -
                              i
                              )
                              ,
                              
                              i
                              ∈
                              S
                              _
                              ,
                              
                              k
                              ∈
                              N
                              }
                           
                        
                     
                  

Define d as the standard differential operator that maps elements from 
                        
                           K
                        
                      to 
                        
                           E
                        
                     . That is, 
                        
                           d
                           :
                           K
                           →
                           E
                           =
                           span
                           {
                           d
                           ξ
                           ,
                           ξ
                           ∈
                           K
                           }
                        
                     , which is the vector space spanned by the symbols
                        
                           
                              {
                              dx
                              (
                              t
                              -
                              i
                              )
                              ,
                              du
                              (
                              t
                              -
                              i
                              )
                              ,
                              …
                              ,
                              
                                 
                                    du
                                 
                                 
                                    (
                                    k
                                    )
                                 
                              
                              (
                              t
                              -
                              i
                              )
                              ,
                              
                              i
                              ∈
                              S
                              _
                              ,
                              
                              k
                              ∈
                              N
                              }
                              
                              over
                              
                              K
                           
                        
                     
                  

Now, define the shift operator 
                        
                           δ
                           :
                           ε
                           →
                           ε
                        
                      as: 
                        
                           
                              δ
                              a
                              (
                              t
                              )
                              df
                              (
                              t
                              )
                              =
                              a
                              (
                              t
                              -
                              1
                              )
                              δ
                              df
                              (
                              t
                              )
                              =
                              a
                              (
                              t
                              -
                              1
                              )
                              df
                              (
                              t
                              -
                              1
                              )
                              ,
                              
                              a
                              (
                              ·
                              )
                              ,
                              
                              f
                              (
                              ·
                              )
                              ∈
                              K
                           
                        
                     
                  

For notation simplicity, we will write 
                        
                           
                              
                                 δ
                              
                              
                                 i
                              
                           
                           dx
                        
                      instead of 
                        
                           dx
                           (
                           t
                           -
                           i
                           )
                        
                     .

Let 
                        
                           K
                           (
                           δ
                           )
                        
                      be the (left) ring of polynomials in 
                        
                           δ
                        
                      with coefficients on 
                        
                           K
                        
                     .

Define 
                        
                           M
                        
                      as an increasing sequence of left 
                        
                           K
                           (
                           δ
                           )
                        
                      -modules by 
                        
                           M
                           =
                           span
                           {
                           d
                           ξ
                           ,
                           ξ
                           ∈
                           K
                           }
                        
                     .

The concept of closure of a submodule, introduced in [29], is generalized to submodules over 
                        
                           K
                           (
                           δ
                           ]
                        
                      in [30], where it is shown that any decreasing sequence of closed submodules of a finitely generated module over 
                        
                           K
                           (
                           δ
                           ]
                        
                      stabilizes. This is a very important property with various applications.

Every 
                        
                           K
                           (
                           δ
                           ]
                        
                      element may be written as
                        
                           
                              α
                              (
                              δ
                              ]
                              =
                              
                                 
                                    α
                                 
                                 
                                    0
                                 
                              
                              +
                              
                                 
                                    α
                                 
                                 
                                    1
                                 
                              
                              δ
                              +
                              ⋯
                              +
                              
                                 
                                    α
                                 
                                 
                                    r
                                    α
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    
                                       
                                          r
                                       
                                       
                                          α
                                       
                                    
                                 
                              
                              ,
                              
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              ∈
                              K
                           
                        
                     where 
                        
                           
                              
                                 r
                              
                              
                                 α
                              
                           
                        
                      is the polynomial degree of 
                        
                           α
                           (
                           δ
                           ]
                        
                     .

The addition is defined as usual.
                        
                           
                              α
                              (
                              δ
                              ]
                              +
                              β
                              (
                              δ
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       max
                                       {
                                       
                                          
                                             r
                                          
                                          
                                             α
                                          
                                       
                                       ,
                                       
                                          
                                             r
                                          
                                          
                                             β
                                          
                                       
                                       }
                                    
                                 
                              
                              (
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    β
                                 
                                 
                                    i
                                 
                              
                              )
                              
                                 
                                    δ
                                 
                                 
                                    i
                                 
                              
                           
                        
                     
                  

However, the multiplication is non-commutative:
                        
                           
                              α
                              (
                              δ
                              ]
                              β
                              (
                              δ
                              ]
                              =
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             α
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       j
                                       =
                                       0
                                    
                                    
                                       
                                          
                                             r
                                          
                                          
                                             β
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    α
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    K
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    β
                                 
                                 
                                    j
                                 
                              
                              )
                              
                                 
                                    δ
                                 
                                 
                                    i
                                    +
                                    j
                                 
                              
                           
                        
                     
                  

Whenever possible, system (1) is represented in affine form
                        
                           (3)
                           
                              Σ
                              :
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                                (
                                                t
                                                )
                                                =
                                                f
                                                (
                                                x
                                                (
                                                t
                                                -
                                                i
                                                )
                                                ,
                                                
                                                i
                                                ∈
                                                S
                                                _
                                                )
                                                +
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         =
                                                         0
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                                
                                                   
                                                      g
                                                   
                                                   
                                                      j
                                                   
                                                
                                                (
                                                x
                                                (
                                                t
                                                -
                                                i
                                                )
                                                ,
                                                
                                                i
                                                ∈
                                                S
                                                _
                                                )
                                                u
                                                (
                                                t
                                                -
                                                j
                                                )
                                             
                                          
                                          
                                             
                                                y
                                                (
                                                t
                                                )
                                                =
                                                h
                                                (
                                                x
                                                (
                                                t
                                                -
                                                i
                                                )
                                                ,
                                                
                                                i
                                                ∈
                                                S
                                                _
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     and under differential form:
                        
                           (4)
                           
                              Σ
                              :
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                                =
                                                
                                                   
                                                      f
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                (
                                                δ
                                                ]
                                                dx
                                                +
                                                g
                                                (
                                                δ
                                                ]
                                                du
                                             
                                          
                                          
                                             
                                                dy
                                                =
                                                
                                                   
                                                      h
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                                (
                                                δ
                                                ]
                                                dx
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

The operations that have been implemented in the proposed toolbox will now be recalled. For any 
                        
                           a
                           (
                           δ
                           ]
                           ,
                           b
                           (
                           δ
                           ]
                           ∈
                           K
                           (
                           δ
                           ]
                           ,
                           b
                           (
                           δ
                           ]
                           ≠
                           0
                           ,
                        
                      there exist:
                        
                           •
                           Non-zero polynomials 
                                 
                                    c
                                    (
                                    δ
                                    ]
                                    ,
                                    d
                                    (
                                    δ
                                    ]
                                    ∈
                                    K
                                    (
                                    δ
                                    ]
                                 
                               s.t. 
                                 
                                    a
                                    (
                                    δ
                                    ]
                                    =
                                    c
                                    (
                                    δ
                                    ]
                                    b
                                    (
                                    δ
                                    ]
                                    +
                                    r
                                    (
                                    δ
                                    ]
                                 
                               with 
                                 
                                    d
                                    eg
                                    .
                                    r
                                    (
                                    δ
                                    ]
                                    <
                                    deg
                                    .
                                    b
                                    (
                                    δ
                                    ]
                                 
                               (Left Euclidian division).

Non-zero polynomials 
                                 
                                    α
                                    (
                                    δ
                                    ]
                                    ,
                                    β
                                    (
                                    δ
                                    ]
                                 
                               s.t. 
                                 
                                    α
                                    (
                                    δ
                                    ]
                                    a
                                    (
                                    δ
                                    ]
                                    +
                                    β
                                    (
                                    δ
                                    ]
                                    b
                                    (
                                    δ
                                    ]
                                    =
                                    0
                                 
                               (Left Ore condition).

Non-zero polynomials 
                                 
                                    α
                                    (
                                    δ
                                    ]
                                    ,
                                    β
                                    (
                                    δ
                                    ]
                                 
                               s.t. 
                                 
                                    α
                                    (
                                    δ
                                    ]
                                    a
                                    (
                                    δ
                                    ]
                                    +
                                    β
                                    (
                                    δ
                                    ]
                                    b
                                    (
                                    δ
                                    ]
                                    =
                                    1
                                 
                              , if 
                                 
                                    a
                                    (
                                    δ
                                    ]
                                    ,
                                    b
                                    (
                                    δ
                                    ]
                                 
                               are relatively primes (Left Bezout coefficients).

Non-zero polynomials 
                                 
                                    α
                                    (
                                    δ
                                    ]
                                    ,
                                    β
                                    (
                                    δ
                                    ]
                                 
                               s.t. 
                                 
                                    α
                                    (
                                    δ
                                    ]
                                    a
                                    (
                                    δ
                                    ]
                                    +
                                    β
                                    (
                                    δ
                                    ]
                                    b
                                    (
                                    δ
                                    ]
                                    =
                                    f
                                    (
                                    δ
                                    ]
                                    ,
                                 
                               where 
                                 
                                    f
                                    (
                                    δ
                                    ]
                                    ∈
                                    K
                                    (
                                    δ
                                    ]
                                 
                               is the greatest common divisor (gcd) if 
                                 
                                    a
                                    (
                                    δ
                                    ]
                                    ,
                                    b
                                    (
                                    δ
                                    ]
                                 
                               are not relatively primes.

An invertible matrix 
                                 
                                    T
                                    (
                                    δ
                                    ]
                                 
                               s.t. 
                                 
                                    T
                                    (
                                    δ
                                    ]
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      a
                                                      (
                                                      δ
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      b
                                                      (
                                                      δ
                                                      ]
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               = 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      gcd
                                                      (
                                                      a
                                                      (
                                                      δ
                                                      ]
                                                      ,
                                                      b
                                                      (
                                                      δ
                                                      ]
                                                      )
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              .

For any matrix 
                        
                           A
                           (
                           δ
                           ]
                           ∈
                           
                              
                                 K
                              
                              
                                 mxn
                              
                           
                           (
                           δ
                           ]
                        
                     , there exist:
                        
                           •
                           At least one unimodular matrix 
                                 
                                    P
                                    (
                                    δ
                                    ]
                                 
                               s.t. 
                                 
                                    P
                                    (
                                    δ
                                    ]
                                    A
                                    (
                                    δ
                                    ]
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            A
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                      (
                                                      δ
                                                      ]
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              , with 
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ¯
                                       
                                    
                                    (
                                    δ
                                    ]
                                 
                               full row-rank.

If 
                                 
                                    ∃
                                    ν
                                    ≠
                                    0
                                    |
                                    ν
                                    ·
                                    M
                                    =
                                    0
                                    ,
                                 
                               then 
                                 
                                    P
                                    (
                                    δ
                                    ]
                                    A
                                    (
                                    δ
                                    ]
                                    Q
                                    (
                                    δ
                                    ]
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      I
                                                   
                                                
                                                
                                                   
                                                      0
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                               (Particular case of the Smith form).

The routine which computes the formal rank of 
                                 
                                    A
                                    (
                                    δ
                                    ]
                                 
                              .

Regarding differential one-forms, we defined:
                        
                           •
                           The differential operator 
                                 
                                    d
                                    :
                                    K
                                    →
                                    E
                                 
                              .

The wedge product 
                                 
                                    ∧
                                    :
                                    E
                                    ×
                                    E
                                    →
                                    
                                       
                                          E
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                 
                              .

The relative degree 
                                 
                                    r
                                    (
                                    ω
                                    )
                                 
                               of 
                                 
                                    ω
                                    ∈
                                    X
                                 
                              , with 
                                 
                                    X
                                    =
                                    
                                       
                                          span
                                       
                                       
                                          K
                                          (
                                          δ
                                          ]
                                       
                                    
                                    {
                                    dx
                                    }
                                 
                              , defined by

For the set of submodules of 
                        
                           M
                        
                      there exist:
                        
                           •
                           The filtration of a decreasing sequence of submodules 
                                 
                                    M
                                    ⊃
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    ⊃
                                    
                                       
                                          H
                                       
                                       
                                          1
                                       
                                    
                                    ⊃
                                    …
                                    ⊃
                                    
                                       
                                          H
                                       
                                       
                                          k
                                       
                                    
                                    ⊃
                                    …
                                    ⊃
                                    
                                       
                                          H
                                       
                                       
                                          ∞
                                       
                                    
                                 
                               defined by 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          0
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          span
                                       
                                       
                                          K
                                          (
                                          δ
                                          ]
                                       
                                    
                                    {
                                    dx
                                    ,
                                    du
                                    }
                                 
                              , 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          j
                                       
                                    
                                    :
                                    =
                                    
                                       
                                          span
                                       
                                       
                                          K
                                          (
                                          δ
                                          ]
                                       
                                    
                                    {
                                    ω
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          j
                                          -
                                          1
                                       
                                    
                                    |
                                    
                                       
                                          ω
                                       
                                       
                                          ̇
                                       
                                    
                                    ∈
                                    
                                       
                                          H
                                       
                                       
                                          j
                                          -
                                          1
                                       
                                    
                                    }
                                 
                              , to study the accessibility of the system. This sequence 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          j
                                       
                                    
                                 
                               was shown to stabilize to 
                                 
                                    
                                       
                                          H
                                       
                                       
                                          ∞
                                       
                                    
                                 
                               
                              [23].

The subspace 
                                 
                                    X
                                    ∩
                                    Y
                                    :
                                    =
                                    
                                       
                                          span
                                       
                                       
                                          K
                                          (
                                          δ
                                          ]
                                       
                                    
                                    {
                                    dx
                                    }
                                    ∩
                                    
                                       
                                          span
                                       
                                       
                                          K
                                          (
                                          δ
                                          ]
                                       
                                    
                                    {
                                    dy
                                    ,
                                    d
                                    
                                       
                                          y
                                       
                                       
                                          ̇
                                       
                                    
                                    ,
                                    …
                                    }
                                 
                               which is isomorphic to the smallest observable space and useful in solving the disturbance decoupling problem.

The filtration of a decreasing sequence of submodules

Let 
                        
                           Δ
                           =
                           
                              
                                 span
                              
                              
                                 K
                                 (
                                 δ
                                 ]
                              
                           
                           {
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           (
                           δ
                           ]
                           ,
                           …
                           ,
                           
                              
                                 r
                              
                              
                                 j
                              
                           
                           (
                           δ
                           ]
                           }
                        
                      be the right module spanned over 
                        
                           K
                           (
                           δ
                           ]
                        
                      by 
                        
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           (
                           δ
                           ]
                           ,
                           …
                           ,
                           
                              
                                 r
                              
                              
                                 j
                              
                           
                           (
                           δ
                           ]
                           ∈
                           
                              
                                 K
                              
                              
                                 n
                              
                           
                           (
                           δ
                           ]
                        
                     . For two elements of 
                        
                           Δ
                           
                           
                              
                                 r
                              
                              
                                 1
                              
                           
                           (
                           δ
                           ]
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 s
                              
                           
                           
                              
                                 r
                              
                              
                                 1
                              
                              
                                 j
                              
                           
                           (
                           x
                           (
                           t
                           -
                           i
                           )
                           ,
                           u
                           (
                           t
                           -
                           i
                           )
                           ,
                           i
                           ∈
                           S
                           _
                           )
                           
                              
                                 δ
                              
                              
                                 j
                              
                           
                        
                     , and 
                        
                           
                              
                                 r
                              
                              
                                 2
                              
                           
                           (
                           δ
                           ]
                           =
                           
                              
                                 ∑
                              
                              
                                 j
                                 =
                                 0
                              
                              
                                 s
                              
                           
                           
                              
                                 r
                              
                              
                                 2
                              
                              
                                 j
                              
                           
                           (
                           x
                           (
                           t
                           -
                           i
                           )
                           ,
                           u
                           (
                           t
                           -
                           i
                           )
                           ,
                           i
                           ∈
                           S
                           _
                           )
                           
                              
                                 δ
                              
                              
                                 j
                              
                           
                        
                     , there exist:
                        
                           •
                           The extended Lie bracket defined in [14] as

These basic routines can then be combined to form more elaborated programs.

This section states some aspects of the key stages in the software development.

An important task in creating a software is extracting the general requirements and to clarify the scope of the development. SAC requirements are grouped in the following categories.

The input information for software performance are the mathematical equations, which represent the behavior of each control system. There are three forms in which the state equations can be defined within SAC: affine (3), general (1) and differential form (4). In all of them the state, input, and output variables must be defined.

The software Maxima was chosen to develop SAC because it complies with the following characteristics:
                                 
                                    •
                                    It is a Computer Algebra System (CAS) program, so it can manipulate mathematical expressions in symbolic form.

Open source software license (GNU General Public License). SAC is for non-profit uses. It is our interest to improve the software and a GNU GPL can motivate the collaboration of the user’s community. More important, this allows any person to use it without requiring a license of any particular commercial software.

Multi-platform. This allows the use of the software in the major operating systems (Windows, MacOS, and Linux).

Modular structure. The functionality of a program must be separated into independent, interchangeable modules, such that each contains everything necessary to execute only one aspect of the desired functionality.

Good memory management, to hold a large number of mathematical expressions.

Compatibility. It refers to the need of a CAS language to be compatible with previous and future versions of itself.

Easy to handle. The software operation must be similar to other specialized packages in the control area.

The services that the system must provide are:
                                 
                                    •
                                    Basic input/output operations: save and load the state equations of a control system.

The system must be capable to handle several systems in the same session. This characteristic is required to solve some control problems, for example the observer synthesis can be seen like the union of two independent systems.

The considered main control issues in this software version include:
                                          
                                             –
                                             accessibility,

observability,

equivalence with the triangular form,

linearization by additive output injections,

linear equivalence by means of a change of coordinates.

The previous requirements were used to define the subset of characteristics that most expected SAC users would have in common.

Typical SAC end-user studies or works with nonlinear control systems with or without delay. The minimal technical expertise required to a SAC end-user are:
                              
                                 •
                                 Knowledge on nonlinear control theory of systems, with or without delays.

Basic computation skills.

Knowledge of the syntax of the software Maxima.

There exist several CAS, the most popular are Mathematica, Maple, muPAD, REDUCE, YACAS and Maxima. However, based on the software requirements, the CAS Maxima has been selected to develop SAC mainly because it is a mature open-source software. This characteristic allows more people to install a local copy to work with. We also took into account:
                              
                                 •
                                 It is multi-platform, available for Linux, Windows, and MacOS.

It is written in common Lisp language and includes a complete programming language with algorithmic language-like syntax but Lisp-like semantics. It allows to write routines in Lisp, which can be called from Maxima.

It is an active project, with constant updates.

There are different GUI’s available for Maxima. Some of them are xmaxima, wxmaxima and Texmacs. They have different characteristics. It is important to clarify that Texmacs is an independent software, which can be used as a graphic user interface for different programs, including Maxima.

One drawback of this choice is that neither Lisp nor the Maxima native language are very popular amongst the control community. However, the basic required skills can be quickly learned. Users can visit the documentation center [32], where detailed information, manuals, and tutorials of Maxima and Xmaxima, are available in several languages.

SAC has a modular architecture, it has been developed combining the bottom-up design, and the modular software approach. The system is composed of independent modules which serve for specific purposes, and communicate to each other. Fig. 1
                            shows the different components of SAC in a pyramidal form. The modules which appear in the basis of the pyramid are the basic components of SAC. They do not have dependence of other SAC routines, that is, they are written just with Maxima or Lisp commands. The components which appear on the second level depend of one or more modules of the basis and the connections are increased level by level in the pyramid. For example, the isaccessible module, at the top of the pyramid, depends on the hk module in the fifth level, and hk depends of routines in the fourth one.

This allows using Maxima as a highly-specialized scientific calculator, and as a programming language. For example, starting from very simple commands, like the delay operator and the non-commutative product, we implemented the left Euclidian division. Then, this algorithm is used to compute the Ore polynomials, which is part of the routine to obtain the Smith form of a matrix. Any given procedure can be called at any point because it is a language command itself.

Some benefits of this structure are:
                              
                                 •
                                 The code is fragmented in small routines, and each of them performs a very specific task. This allows using them as building blocks to create more complex routines.

An easier way to keep track of the program flow.

A software that is easy to maintain, and easy to improve.

The following step is to program the code for the project. This process will be described in the following subsection.

@&#IMPLEMENTATION@&#

The main control issues include system’s accessibility, observability, equivalence with the triangular form, linearization by additive output injections, and linear equivalence by means of a change of coordinates. The particular algorithms are available in Spanish language in the thesis works [33,34]. SAC can be downloaded from [31], and the documentation includes the SAC manual with the algorithms.

The first step in this stage was to identify each module or component according to their use in the principal routines.

SAC was developed under the guidelines given in Section 3.1 using the following software engineering tools:
                           
                              •
                              
                                 Use cases: Define the interactions between external actors, and the system under consideration to accomplish a goal. The system is treated as a black box, and these interactions are perceived as from outside the system. An actor is a role that a person or process plays when interacting with the software.


                                 Data flow diagrams (DFD): They give an overall picture of what the system does, and how the data flows through the system. The design starts with the context-level DFD. Then the diagram is expanded to other levels to show more detail of the system being modeled.


                                 Decision trees: Graphically show the logic of the process.


                                 Logical data dictionary: Gives details about the system data like contents of data flows, and data storages.

The main use cases corresponding to the principal actions of the software are identified and the developer starts with the use case of each one. Fig. 2
                         shows as example the use case of the routine isaccessible, which computes the accessibility property of a system. Now we have the interactions between the different modules, and the following step is to create the DFD of the overall system, it is shown in Fig. 3
                        . Taking the rectangle 4, which represents the isaccessible process, it can be expanded in the DFD shown in Fig. 4
                        . After that, a decision tree of each process shown in Fig. 3 must be done. The logic of the process isaccessible is shown in Fig. 5
                        . The logical data of each process must be specified in the dictionary. For example, in Fig. 5 appears the MaxDel data flow. Looking in the data dictionary we found: MaxDel=
                        *Maximum time delay of the maxd process input data.*
                     

Now the algorithm can be implemented, the programmer knows the different modules, and actions that must be done to define if the control system is accessible. The algorithm corresponding to this routine is shown in Fig. 6
                        .

The methodology to prove the SAC functionality and the accomplishment of the requirements was the following:
                           
                              •
                              A testing procedure was designed.

Unit tests to prove the functionality of SAC was developed.

A bug-tracking system was implemented.

The tests realized on the software for the functional requirements are classified according to Table 1
                        . The requirements and tests are shown in Table 2
                        .

Note that test 4 in Table 1 implies to use the software NOLIACPA, which was developed in the laboratory IRCCyN of Nantes, France. This software is based on Maple CAS, and can be used for nonlinear control systems. The compared routines with SAC were the accessibility and the observability routines.

No errors were detected for the tests 3, 4, and 5. However, some missing error messages for invalid data were detected with the test 1, and some defects were found with test 2 like long execution times in critical routines. Some corrective actions were done changing some routines to Lisp to accelerate the computation process.

The current release of the SAC package is the beta version, and may be downloaded from the software code repository SourceForge [31]. Once the file SAC_v_beta.zip has been uncompressed the SAC package is ready to be used. One assumes that the Maxima software is installed, and it starts in the same directory as SAC. In what follows, the nth input line begins with (
                              %in
                           ), while its corresponding output line begins with (
                              %on
                           ). Some outputs were removed for readability. It will be assumed that the following initialization code was executed:
                              
                                 
                              
                           
                        

The uninstall procedure consists of deleting all the directory where SAC was extracted to.

SAC is a current project in the CICESE research center. Its modular structure and the use of software engineering tools are key to have a software easy to maintain.

We briefly outline some SAC capabilities by presenting results for several systems, and indicate how the package can be used to solve analysis and control synthesis problems.

Consider the following system, taken from [35].
                        
                           (6)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             1
                                          
                                          
                                             10
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       +
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       -
                                       2
                                       )
                                       u
                                       (
                                       t
                                       -
                                       1
                                       )
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       t
                                       )
                                       -
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             (
                                             t
                                             )
                                          
                                          
                                             3
                                          
                                       
                                    
                                 
                                 
                                    
                                       Y
                                       =
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                       (
                                       t
                                       )
                                    
                                 
                              
                           
                        
                     
                  

First, the system matrices are defined following the notation of system (1).
                        
                           
                        
                     
                  

The system is named MarMoo01 using the systdef command. The state variable is x, the input variable is u and the output variable is y.
                        
                           
                        
                     
                  

SAC represents 
                        
                           f
                           (
                           x
                           (
                           t
                           -
                           i
                           )
                           ,
                           u
                           (
                           t
                           -
                           i
                           )
                           )
                        
                      and 
                        
                           h
                           (
                           x
                           (
                           t
                           -
                           i
                           )
                           )
                        
                      of system (6), like the matrices MarMoo01_Fg and MarMoo01_Hg.

Some applications of control analysis and synthesis will be recalled in the following sections.

The instruction lie(h,
                        sys,
                        n) computes the nth. Lie derivative of the function h along the trajectories of the system sys. This routine is useful to search the so-called linearizing output, which is an output function without zero dynamics, see Eq. (5).

The instructions to compute the relative degree of the output 
                           
                              y
                              =
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                           
                         of system (6) are:
                           
                              
                           
                        
                     

The system has relative degree 2, because one needs to time-differentiate the output twice to obtain explicit dependence on u. However, the relative degree could be computed of any previously defined output. For example, the output
                           
                              
                                 y
                                 (
                                 t
                                 )
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 t
                                 )
                                 +
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 t
                                 -
                                 1
                                 )
                              
                           
                        is stored in the matrix g.
                           
                              
                           
                        
                     

Then the time-derivative is computed.
                           
                              
                           
                        
                     

In this case, the relative degree is 1. The following example illustrates how SAC is useful in control synthesis problems.

Consider the trajectory tracking problem as defined in [12]. There exists a static state feedback which solves the trajectory tracking problem for 
                           
                              Σ
                           
                         if all the output components have finite relative degree, and the decoupling matrix 
                           
                              D
                              (
                              δ
                              ]
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    s
                                 
                              
                              
                                 
                                    D
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    k
                                 
                              
                           
                         is invertible over 
                           
                              K
                              (
                              δ
                              ]
                           
                         
                        [12].

Consider the system, taken from [12]:
                           
                              (7)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          -
                                          1
                                          )
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          -
                                          1
                                          )
                                          +
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                (
                                                t
                                                -
                                                1
                                                )
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

First, the system is defined in SAC with the following commands:
                           
                              
                           
                        
                     

The Lie derivative is computed to determine the relative degree of the output.
                           
                              
                           
                        
                     

This represents the first time-derivative of the output vector h along the trajectories of the system (7). Since in both components a control input appears, the corresponding relative degrees are 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    ρ
                                 
                                 
                                    
                                       
                                          y
                                       
                                       
                                          2
                                       
                                    
                                 
                              
                              =
                              1
                           
                        . The commands gen2aff and submat are used to form the decoupling matrix.
                           
                              
                           
                        
                     

The command invmat computes the inverse matrix over 
                           
                              K
                              (
                              δ
                              ]
                           
                        .
                           
                              
                           
                        
                     

Since the inverse matrix exists, then the system is solvable via static state feedback according to the conditions defined in [12]. Now, the following steps will be done to solve the trajectory tracking problem.

Defining 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              -
                              
                                 
                                    y
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          ref
                                       
                                    
                                 
                              
                              (
                              t
                              )
                           
                        , with 
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , and 
                           
                              err
                              :
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   e
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        
                        
                           
                              
                           
                        
                     

Pick the following stable dynamics for the error signal 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              +
                              2
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              (
                              t
                              )
                              =
                              0
                           
                        , for 
                           
                              i
                              =
                              1
                              ,
                              2
                           
                        , or equivalently.
                           
                              
                           
                        
                     

Solving the first equation for 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              )
                           
                        
                        
                           
                              
                           
                        
                     

Solving the second one for 
                           
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              (
                              t
                              )
                           
                        .
                           
                              
                           
                        
                     

There is a dependence of 
                           
                              
                                 
                                    u
                                 
                                 
                                    1
                                 
                              
                              (
                              t
                              -
                              1
                              )
                           
                        , then using the command tshift we will apply a time- shift to the first equation, and substitute the result in the second one.
                           
                              
                           
                        which solves the trajectory tracking. The next examples show that the software usefulness is not limited to time-delay systems.

The disturbance decoupling problem is basic in control theory. The idea is to get a feedback to make the system’s output independent from those state components whose evolution is influenced by the disturbance. In the case of nonlinear systems the solution of this problem is related to the structure of the subspace 
                           
                              X
                              ∩
                              Y
                           
                        , which is the smallest subspace that is observable under transformations induced by regular dynamic compensators, as described in the following theorem:
                           Theorem 1
                           
                              [30] 
                              The disturbance decoupling problem is solvable via quasi-static state feedback, if and only if the disturbance vector 
                              
                                 
                                    p
                                    (
                                    x
                                    )
                                 
                               
                              is orthogonal to the subspace 
                              
                                 
                                    X
                                    ∩
                                    Y
                                 
                              .

SAC includes the routine xiy to compute this subspace. Let consider the system of the form 
                           
                              
                                 
                                    x
                                 
                                 
                                    ̇
                                 
                              
                              =
                              f
                              (
                              x
                              )
                              +
                              g
                              (
                              x
                              )
                              u
                              +
                              p
                              (
                              x
                              )
                              q
                           
                         
                        [30]:
                           
                              (8)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                5
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          t
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                4
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                u
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                5
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          
                                             
                                                u
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          q
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          t
                                          )
                                       
                                    
                                 
                              
                           
                        
                     

Defining the system in SAC.
                           
                              
                           
                        
                     

The routine xiy, computes the list of matrices 
                           
                              [
                              [
                              X
                              ∩
                              Y
                              ]
                              ,
                              [
                              
                                 
                                    d
                                 
                                 
                                    dt
                                 
                              
                              X
                              ∩
                              Y
                              ]
                              ]
                           
                        . Then to apply the conditions of Theorem 1, just the first matrix is needed.
                           
                              
                           
                        Then
                           
                              
                                 X
                                 ∩
                                 Y
                                 =
                                 
                                    
                                       span
                                    
                                    
                                       K
                                    
                                 
                                 {
                                 
                                    
                                       dx
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       dx
                                    
                                    
                                       3
                                    
                                 
                                 ,
                                 (
                                 ·
                                 )
                                 
                                    
                                       dx
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 (
                                 ·
                                 )
                                 
                                    
                                       dx
                                    
                                    
                                       4
                                    
                                 
                                 }
                              
                           
                        and system (8) is solvable via quasi-static state feedback since the vector 
                           
                              p
                              (
                              x
                              )
                              =
                              
                                 
                                    [
                                    
                                       
                                          
                                             0
                                          
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      0
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                           
                        , satisfies the condition of Theorem 1.

Detailed information on the system model (diagrams), algorithms, and the use of SAC package can be found in [33].

Necessary and sufficient conditions that indicate if a system 
                           
                              Σ
                           
                         is equivalent to a time-delay linear system, by means of a bicausal change of coordinates, are presented in [14].
                           Theorem 2
                           
                              [14] 
                              The system 
                              
                                 
                                    Σ
                                 
                               
                              is equivalent, under a bicausal change of coordinates, to a linear weakly accessible delay system if and only if there exist a unimodular matrix 
                              
                                 
                                    
                                       
                                          T
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    δ
                                    ]
                                 
                              , and a full rank matrix 
                              
                                 
                                    Q
                                    (
                                    δ
                                    )
                                 
                              , such that

The module generators 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                    
                                  do not depend on 
                                    
                                       u
                                    
                                 , that is, for 
                                    
                                       1
                                       ⩽
                                       i
                                       ⩽
                                       n
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       ·
                                       )
                                       :
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       )
                                    
                                 ,


                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       )
                                       =
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       )
                                       =
                                       
                                          
                                             T
                                          
                                          
                                             -
                                             1
                                          
                                       
                                       (
                                       δ
                                       ]
                                       Q
                                       (
                                       δ
                                       )
                                    
                                 ,


                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       (
                                       ·
                                       )
                                       :
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ∈
                                       
                                          
                                             span
                                          
                                          
                                             R
                                             [
                                             δ
                                             ]
                                          
                                       
                                       {
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       }
                                    
                                 ,

For 
                                    
                                       i
                                       ,
                                       j
                                       ∈
                                       [
                                       1
                                       ,
                                       n
                                       ]
                                    
                                 , and 
                                    
                                       r
                                       ≤
                                       k
                                       ∈
                                       
                                          
                                             
                                                0
                                                ,
                                                2
                                                
                                                   
                                                      s
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                          
                                       
                                    
                                 , where 
                                    
                                       
                                          
                                             s
                                          
                                          
                                             ¯
                                          
                                       
                                       =
                                       max
                                       (
                                       deg
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             l
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       j
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       j
                                       ∈
                                       θ
                                       )
                                       ,
                                       l
                                       ∈
                                       [
                                       1
                                       ,
                                       n
                                       ]
                                       ,
                                       α
                                       )
                                    
                                 , the following relation is satisfied

The module generators are computed, using the differential form of 
                           
                              Σ
                           
                        , recursively:
                           
                              (9)
                              
                                 
                                    
                                       g
                                    
                                    
                                       k
                                    
                                 
                                 (
                                 δ
                                 ]
                                 =
                                 
                                    
                                       f
                                    
                                    
                                       ̃
                                    
                                 
                                 (
                                 δ
                                 ]
                                 
                                    
                                       g
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 δ
                                 ]
                                 -
                                 
                                    
                                       
                                          
                                             g
                                          
                                          
                                             ̇
                                          
                                       
                                    
                                    
                                       k
                                       -
                                       1
                                    
                                 
                                 (
                                 δ
                                 ]
                                 ,
                                 
                                 k
                                 ≥
                                 1
                                 ,
                                 
                                 
                                    
                                       g
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 δ
                                 ]
                                 =
                                 g
                                 (
                                 δ
                                 ]
                                 .
                              
                           
                        
                     

Given the nonlinear system represented by the next state equations
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          )
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          -
                                          1
                                          )
                                          +
                                          u
                                          (
                                          t
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          t
                                          )
                                          -
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          -
                                          2
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          t
                                          -
                                          1
                                          )
                                          -
                                          2
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          -
                                          3
                                          )
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                          
                                          (
                                          t
                                          -
                                          1
                                          )
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      ̇
                                                   
                                                
                                             
                                             
                                                3
                                             
                                          
                                          =
                                          
                                             
                                                x
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          -
                                          1
                                          )
                                          +
                                          
                                             
                                                x
                                             
                                             
                                                3
                                             
                                             
                                                2
                                             
                                          
                                          (
                                          t
                                          -
                                          2
                                          )
                                       
                                    
                                 
                              
                           
                        the name of the system is defined as follows:
                           
                              
                           
                        
                     

The matrix 
                           
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                              (
                              x
                              (
                              t
                              -
                              i
                              )
                              ,
                              δ
                              ,
                              i
                              ∈
                              S
                              _
                              )
                              ,
                           
                         and the element 
                           
                              
                                 
                                    g
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              (
                              ·
                              )
                           
                         are both computed by the function accessubmod.
                           
                              
                           
                        
                     

Using this result, testing the conditions (a), (b), and (c) of Theorem 2 is straightforward. The function ELieBracket computes the extended Lie bracket operation, for instance
                           
                              
                           
                        is the result of 
                           
                              
                                 
                                    [
                                    
                                       
                                          g
                                       
                                       
                                          1
                                       
                                       
                                          0
                                       
                                    
                                    (
                                    x
                                    (
                                    t
                                    -
                                    i
                                    )
                                    ,
                                    i
                                    ∈
                                    S
                                    _
                                    )
                                    ,
                                    
                                       
                                          g
                                       
                                       
                                          3
                                       
                                       
                                          2
                                       
                                    
                                    (
                                    x
                                    (
                                    t
                                    -
                                    i
                                    )
                                    ,
                                    i
                                    ∈
                                    S
                                    _
                                    )
                                    ]
                                 
                                 
                                    
                                       
                                          E
                                       
                                       
                                          0
                                       
                                    
                                 
                              
                           
                        . The condition (d) of Theorem 2 is fulfilled as shown by the application of the ELieBracket function iteratively. The routine iseq2lwads indicates if the conditions of Theorem 2 are satisfied.
                           
                              
                           
                        
                        
                           Corollary
                           
                              [14] 
                              System 
                              
                                 
                                    Σ
                                 
                               
                              is equivalent, under a bicausal change of coordinates, to a delay-free linear system if, and only if, conditions (a) and (d) of Theorem 2 are satisfied, and
                           


                                 
                                    
                                       (
                                       
                                          
                                             b
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       
                                       
                                          
                                             R
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       )
                                       =
                                       (
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       )
                                    
                                  is unimodular.


                                 
                                    
                                       (
                                       
                                          
                                             c
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                       
                                       
                                          
                                             g
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       (
                                       ·
                                       )
                                       :
                                       =
                                       
                                          
                                             g
                                          
                                          
                                             n
                                             +
                                             1
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ∈
                                       
                                          
                                             span
                                          
                                          
                                             R
                                          
                                       
                                       {
                                       
                                          
                                             g
                                          
                                          
                                             1
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       …
                                       ,
                                       
                                          
                                             g
                                          
                                          
                                             n
                                          
                                       
                                       (
                                       x
                                       (
                                       t
                                       -
                                       i
                                       )
                                       ,
                                       δ
                                       )
                                       ,
                                       i
                                       ∈
                                       S
                                       _
                                       }
                                    
                                 
                              

These conditions are tested by iseq2lcnd, which shows that exalineq is not equivalent to a delay-free linear system.
                           
                              
                           
                        
                     

The main drawback found with the proposed software, is that its performance decreases very quickly as the number of terms in the system equations increases (either variables, constants, or parameters). This problem appears in any CAS system since, in practice, the complexity of the involved computations increases exponentially with number of terms in the equations. This problem can, however, be alleviated by reducing as much as possible the number of symbols in the equations, and by avoiding vector notations like a 
                     [7], which requires more memory allocation than 
                        
                           a
                           7
                        
                     , since the former sets up a vector while the latter is treated as a symbol. To reduce the number of symbols, the best is to group as much terms as possible in a single one, but only for those which appear only once, otherwise this might prevent Maxima from finding simplifications involving terms that appear in several places. For example, instead of writing
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         100
                                                      
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                   
                                                
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      m
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         i
                                                         =
                                                         1
                                                      
                                                      
                                                         50
                                                      
                                                   
                                                
                                                
                                                   
                                                      c
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Use
                        
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       m
                                       1
                                       ·
                                       s
                                       1
                                       ·
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   ̇
                                                
                                             
                                          
                                          
                                             2
                                          
                                       
                                       =
                                       m
                                       1
                                       ·
                                       s
                                       2
                                       ·
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that 
                        
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                        
                      was not included in the sum terms s1 nor s2, since it appears in both equations. The state must be left in vector form, but 
                        
                           
                              
                                 m
                              
                              
                                 1
                              
                           
                        
                      is replaced by 
                        
                           m
                           1
                        
                     , which is treated as a single symbol by Maxima. This changes not only reduce the required allocation memory, but also reduces the length of expressions appearing in the Lie brackets or the Euclidean division, which greatly improves the computational time.

Another technique to improve the performance, is to first linearize as much as possible the system by static state feedback. This operation must be done carefully since, although it does not change basic properties like accessibility, it may destroy the observability. This technique was used, for instance, in [12].

In this work, we have presented a computer software toolbox that provides a practical way to carry out the otherwise cumbersome computations involved in the analysis and synthesis of nonlinear time-delay systems under the delay-differential algebraic and geometric approaches. This toolbox is under constant development, and its aim is to be a general purpose tool for analysis and control of nonlinear systems, with or without delays. Its open-source and multi-platform nature guarantees that all the potential users will be able to use a legal copy of it. Also, this will encourage other users to contribute with its development, resulting in a more powerful free software.

Future work includes more routines for analysis and synthesis, and support for other classes of systems, like, for example, discrete-time nonlinear systems as well as the identification of the bottlenecks, followed by the development of more efficient algorithms.

As it was shown by many examples, the toolbox can be very handy to carry out complicated operations found when dealing with nonlinear time-delay systems. It hasalready been used for real applications in [36–38].

@&#ACKNOWLEDGEMENTS@&#

This work was partially supported by CONACyT, Mexico. Second author wants to thank A. Glumineau for his contributions to the definition of the structure of the software.

@&#REFERENCES@&#

