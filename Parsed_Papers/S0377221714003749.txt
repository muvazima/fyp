@&#MAIN-TITLE@&#A stochastic appointment scheduling system on multiple resources with dynamic call-in sequence and patient no-shows for an outpatient clinic

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study an outpatient appointment scheduling problem with dynamic call-in and patient no-shows.


                        
                        
                           
                           A stochastic approach is used to find best block for the current patient to minimize total costs.


                        
                        
                           
                           The model is available for both single and multiple resources.


                        
                        
                           
                           Two methods are proposed to estimate the cost of overflow patients waiting for multiple resources.


                        
                        
                           
                           Numerical results show that this approach outperforms traditional rule-based systems.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Stochastic processes

OR in health services

Appointment scheduling

Overbooking

Patient no-shows

@&#ABSTRACT@&#


               
               
                  This research focuses on the stochastic assignment system motivated by outpatient clinics, especially the physical therapy in rehabilitation service. The aim of this research is to develop a stochastic overbooking model to enhance the service quality as well as to increase the utilization of multiple resources, like therapy equipment in a physical therapy room, with the consideration of patients’ call-in sequence. The schedule for a single-service period includes a fixed number of blocks of equal length. When patients call, they are assigned to an appointment time for that block, and an existing appointment is not allowed to be changed. In each visit, a patient might require more than one resource and a probability of no-show. Two estimation methods were proposed for the expected waiting and overtime cost with multiple resources: Convolution Estimation Method and Joint Cumulative Estimation Method for the upper and lower bound value; respectively. A numerical example based on a physical therapy room was used to show that this stochastic model was able to schedule patients for better profitability compared with traditional appointment systems based on four prioritization rules. The workload in each appointment slot was more balanced albeit more patients were assigned to the first slot to fill up the empty room.
               
            

@&#INTRODUCTION@&#

In a healthcare delivery system, efficient appointment scheduling can serve as a connection between two important quality-related criteria: timely access to services and efficient healthcare services, especially for the outpatient clinics (Cayirli & Veral, 2003). Appointment delay, or the time interval between the need for service and the actual use of healthcare service, can be effectively measured by the timeliness in the service accessibility (Liu, Ziya, & Kulkarni, 2010; Robinson & Chen, 2010). On the other hand, the efficiency of healthcare service was usually measured by patients’ waiting time in the clinic and physicians’ idle time or overtime in sessions (Bailey, 1954).

Many studies have scrutinized the accessibility issue of appointment systems and found a strong relationship between appointment delay and the rate of cancellations and no-shows. A 1997 study in the UK analyzed 1927 referrals from 26 general practitioners and found a longer interval between referral and appointment as one of the five factors significantly associated with non-attendance (Hamilton, Round, & Sharp, 2002). A study of referrals to the Johns Hopkins Bayview Medical Center community psychiatry outpatient programs from 1995 to 2000 found that the rate of cancellations and no-shows increased to 23 from 12% for patients who were given a next-day appointment rather than on the same day as their initial contact (Gallucci, Swartz, & Hackerman, 2005). A study analyzing data for patients in outpatient additional treatment program units from 2003 to 2006 demonstrated a strong negative correlation in the probability of completing four sessions of treatment with increasing time between the clinical assessment and first treatment session (Hoffman, Ford, Tillotson, Choi, & McCarty, 2011). To address the issue of no-shows, a new advanced access model, or “open access policy, was introduced to ensure patients called in the morning to obtain same-day appointments (Murray & Tantau, 2000).

The efficiency of an appointment scheduling system can be represented as a combination of patient satisfaction and hospital revenue gains. A good appointment system should also reduce the patient’s waiting time and the hospital’s operational cost at the same time (Gupta & Denton, 2008). Early researches observed excessive waiting for patients due to their being called to the clinic in large batches at a volume greater than the physicians’ capacity to see them (Bailey, 1954; Welch, 1964). Even when patient was scheduled individually for a specific treatment time, Vissers (1979) observed that punctual patients might reduce idle time for the physician but result in unacceptable waiting time for the patients. Patients might end up undermining the appointment time by either arriving too early to receive treatment earlier or by arriving later to avoid waiting.

Research on the appointment problem pertaining to physical therapy has been rather limited. Chien, Tseng, and Chen (2008) had formulated the rehabilitation patient scheduling problem as a hybrid shop scheduling problem. Their solution approach involved two phases: to find the optimal sequencing of patients using genetic algorithm, and then to construct the feasible therapy sequence for all patients using a timetabling algorithm based on the sequence from the first phase. The numerical results showed that, after considering the patients’ preference, their approach was more effective than the hospital’s empirical method in terms of reducing patient’s waiting time as half of the patients were without an appointment. Ogulata, Koyuncu, and Karakas (2008) also formulated the scheduling problem in a physiotherapy clinic as deterministic mathematical models. Since a high demand for the service was assumed, the entire problem was decomposed to three hierarchical models: selection of patients, assignment of patients to therapists, and scheduling of patients. None of these studies considered walk-in patients, rate of no-shows, and uncertainty concerning the actual service times.

This research is motived by the assignment scheduling problem in outpatient departments for special clinics, especially from the observation for a physical therapy room in an academic medical center in Taipei (Rau et al., 2013). Most patients’ treatment plans include two to five physical treatments with no predetermined sequence. As discussed in Rau et al. (2013) about therapist pooling to reduce patient wait times, a major concern in adopting this strategy from therapists’ viewpoint was the additional work in synchronizing patient appointment schedules. Further, with the consideration of patient promptness and no shows, the study hinted a need to develop an advanced appointment scheduling to further improve the patient flow in this room. Focusing on real-world settings, this research aims to develop a stochastic model for the appointment scheduling problem to achieve better service quality and profitability for outpatient clinics. Each service session is divided into a fixed number of appointment blocks with equal length. With the consideration of existing appointments, this appointment system optimally assigns patients to an appointment block with given probabilities of patient no-shows. The remainder of the paper is organized as follows. In the next section, literature on appointment scheduling is briefly reviewed. The introduction of mathematical formulation of the stochastic process and the implementation results are depicted in Sections 3 and 4, respectively. Then, discussion and concluding remarks are summarized in Section 5.

The development of an appointment system depends on the design to access medical services among three options: traditional model, carve-out model, and advanced-access model (Murray & Berwick, 2003). In a traditional model, appointments are completely arranged and booked in advance. Same-day urgent care is piled on top of an already full schedule or deflected to the emergency department. This model presents a significant obstacle to obtaining care due to the system’s inability to offer appointments soon, which leads to high no-show rates. In a carve-out model, some of the appointment slots are reserved for urgent demands and the rest are booked for non-urgent requests in advance. The caveat of this model is the fairness in the triage decisions in addition to the same impediment of delaying more non-urgent demands as in the traditional model. The advanced-access system, also known as a “same-day access” or “open access” system, tries to eliminate appointment delay entirely, with the clinic having to offer an appointment to patients on the same day as they call about any problem, urgent or not (Murray & Berwick, 2003). Successful implementation showed significant reduction in patients’ appointment delay from a range of 26 to 55days to just one to two days, along with an increase in satisfaction of patients, staff, and even service providers (Murray & Tantau, 2000). Although benefits are substantial, this advance-access policy is more vulnerable to the variations in arrival demand, and is sensitive to the imbalance between demands and capacities (Liu et al., 2010; Robinson & Chen, 2010).

The design of an appointment system has three components: an appointment rule, patient classification or preference, and an adjustment policy for walk-ins and no-shows. The design of the appointment rule also has three components: appointment block sizes, appointment intervals, and the initial block design (Cayirli & Veral, 2003). The appointment interval can be fixed or variable, and the initial block design can be present or absent. The “single-block” rule assigns all patients to arrive as a block at the beginning of the clinic session, and the “individual-block” rule gives patients unique appointment times distributed evenly over the clinic session. The “multiple-block” rule assigns a fixed number of patients to each appointment block (Blanco White & Pike, 1964; Fetter & Thompson, 1966).

Consideration of patient preference can be helpful in deciding the patients’ appointment schedule at the time of booking. Also, patient classification can make the resulting schedule more practical if the appointment intervals are adjusted based on patients’ acuity levels. Other classification includes new/return patients, variability in the service times, and type of procedure (Cayirli & Veral, 2003). Walter (1973) found that, for the same chest examination on an ordinary X-ray machine, patient age had a significant impact on the average examination length, and the variances of the times for patients age 60 or older and those under 20 were both significantly higher. Vanden Bosch and Dietz (2000) adopted a classification scheme to sequence assignments for a specific primary clinic based on patients’ appointment history or type of procedure. Their simulation results concluded that there was no easy rule for the optimal assignment scheduling.

The dynamic case is to allocate the appointment block/time specifically to a patient depending on the state of the system represented by the number of appointed patients in each session. This appointment system tends to have a variable block size, and the next patient is allocated optimally by considering the possible number of remaining patients at the end of each session. Fries and Marathe (1981) and Liu and Liu (1998) proposed a dynamic programming approach to find the optimal allocation for new patients with the consideration of the expected number served in each block. Gupta and Wang (2008) extended the dynamic appointment case so as to include patient choices and proposed a threshold-type optimal policy for a primary clinic with a single physician. Green, Savin, and Wang (2006) considered the appointment problem for diagnostic facilities to find the optimal capacity allocation for inpatient and outpatient demands. Day, Dean, Garfinkel, and Thompson (2010) applied the appointment system design to both single and multiple testing stages as patients might need the same type of test room more than once.

To access various appointment systems under realistic environment settings, simulation modeling has prevailed. Klassen and Rohleder (1996) used simulation to evaluation designs in sequencing patients with “high” or “low” service time variability while the appointment intervals were constant. They concluded that better results can be obtained if patients with higher service-time standard deviations are scheduled toward the end of the appointment session. Cayirli, Veral, and Rosen (2006) tested similar appointment rules as in Klassen and Rohleder (1996) in primary care clinics in New York. Su and Shih (2003) evaluated four appointment policies using simulation for a urology clinic. Wijewickrama and Takakuwa (2005) compared all appointment rules in Ho and Lau (1992) using simulation for an outpatient department of internal medicine and found the best policy was to appoint two patients at a time with an interval of twice the average consultation time. Comprehensive reviews of the assignment scheduling problem can be found in Cayirli and Veral (2003) and Gupta and Denton (2008).

Most literature has assumed that the demand for care is steady and sufficiently abundant to fill every schedule block, and the ratios of walk-in and no-show patients are negligibly small. However, the probability of no-shows had the largest impact on the scheduling results (Ho & Lau, 1992). Vissers (1979) used two options to incorporate walk-in patients: insert additional appointments evenly throughout the clinic session (i.e., overbooking), or shorten the appointment intervals proportionally. The study suggested that the second option was slightly better, and a scaling factor could be applied to extend or shorten schedule intervals according to the expected number of no-shows and walk-ins.

Unlike the overbooking used in the airline industry, overbooking in healthcare requires a realistic estimation of no-shows in appointment slots to avoid overcrowding clinics (Kim & Giachetti, 2006). Kim and Giachetti (2006) proposed a stochastic mathematic overbooking model to determine the optimal number of appointments to be scheduled in advance to maximize the expected profit. Kolish and Sickinger (2008) formulated the appointment scheduling problem as Markov Decision Process for a radiology department. Muthuraman and Lawley (2008) further investigate this dynamic decision in appointment scheduling along with the sequential patient call-in process. A myopic strategy was used to maximize the expected profit as a weighted sum of service rewards, patient overflow, and physician overtime as patients called in sequentially. Lin, Muthuraman, and Lawley (2011) further expended this problem beyond myopic appointment decisions and proposed an approximate dynamic programming to solve for optimal schedule. Erdogan and Denton (2013) considered the planned appointment and the actual arrival to a clinic as a two-stage stochastic programming problem. Given the sequence of patients’ arrivals, this model tried to determine the optimal appointment times for patients to minimize the total expected costs of patient waiting and overtime.

Considering the similar appointment problem as in Muthuraman and Lawley (2008), this study focuses on appointment model for multiple healthcare resources for a Markov Decision Process with heterogeneous no-show rates. Moreover, the patient might require more than one resource in an appointment visit. The purpose of this stochastic appointment scheme is to improve the expected profit for the clinic to adopt overbooking while balancing the costs related to overtime and patients’ wait times.

@&#METHODOLOGY@&#

In general, this system is to appoint a total of N patients to a total of I blocks in one clinic session with equal appointment intervals. When a patient is assigned to one appointment block, he/she would either show up at the starting time of that block, or he/she would be considered a no-show. Depending on the no-show rate, a patient is identified as belonging to one of the J patient classes. Each patient has a different treatment plan that requires at most T types of equipment in the physical therapy room. Whenever the nth patient (1⩽
                     n
                     ⩽
                     N) calls in for an appointment, all appointments made before this call-in patient are not allowed to be altered. This stochastic appointment model requires finding the appointment for this nth patient to maximize the total profit of the clinic with the consideration of patients’ waiting cost and therapists’ overtime cost.

Suppose r is the revenue of each patient treated, w is the overflow cost to have a patient not able to finish the treatment and stay for the next slot, and v is the overtime cost per patient in the last session. Then, when nth patient is appointed, the expected profit, W(n), can be calculated as follows:
                        
                           (1)
                           
                              W
                              (
                              n
                              )
                              =
                              r
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                    
                                 
                              
                              E
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              )
                              -
                              w
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       1
                                    
                                    
                                       I
                                       -
                                       1
                                    
                                 
                              
                              E
                              (
                              
                                 
                                    Y
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              )
                              -
                              v
                              ·
                              E
                              (
                              
                                 
                                    Y
                                 
                                 
                                    I
                                 
                              
                              (
                              n
                              )
                              )
                              ,
                           
                        
                     where E(X
                     
                        i
                     (n)) is the expected number of patients who arrive at the beginning of the ith block as the number of patients appears in the clinic for this block is X
                     
                        i
                     (n); E(Y
                     
                        i
                     (n)) is the expected number of patients who remain in the clinic at the end of the ith block as Y
                     
                        i
                     (n) is the number of patients arrive at or before this block and remain in the clinic at the end of the ith block, i
                     ∈{1,…,
                     I}. It is worth noting that when i
                     =
                     I, E(Y
                     
                        I
                     (n)) represents the expected number of patients remaining in the clinic at the end of the last block and requiring extra service hours (i.e., overtime). The dynamic of the clinic is shown as in Fig. 1
                     .

Let binary variables 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                           
                         be the resulting schedule for nth call-in patient who belongs to jth patient class, i
                        ∈{1,…,
                        I}, j
                        ∈{1,…,
                        J}. If this patient is appointed to the ith block, 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                           
                        ; otherwise, 
                           
                              
                                 
                                    S
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              =
                              0
                           
                        . Moreover, 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    I
                                 
                              
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                              
                              
                                 
                                    S
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              =
                              1
                              ,
                              
                              ∀
                              n
                              =
                              {
                              1
                              ,
                              …
                              ,
                              N
                              }
                           
                         if none of the call-in patient is turned away for an appointment.

We consider the calculation for the number of patients arriving at each block. Note that the number of patients assigned to the ith block is 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                 
                              
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    J
                                 
                              
                              
                              
                                 
                                    S
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                           
                        . If all patients have the same no-show rate of p, the expected number of patients at the beginning of the ith block can be calculated simply as 
                           
                              E
                              (
                              
                                 
                                    X
                                 
                                 
                                    i
                                 
                              
                              (
                              n
                              )
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    x
                                 
                              
                              
                              x
                              ·
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                   
                                                
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             
                                                x
                                             
                                          
                                       
                                    
                                 
                              
                              ·
                              
                                 
                                    (
                                    p
                                    )
                                 
                                 
                                    x
                                 
                              
                              
                                 
                                    (
                                    1
                                    -
                                    p
                                    )
                                 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    n
                                    )
                                    -
                                    x
                                 
                              
                           
                        .

Then we extend to J patient classes with a corresponding no-show rate of p
                        =(p
                        1,
                        p
                        2,…,
                        p
                        
                           J
                        ). Suppose X
                        
                           i,j
                        (n) is the number of patients belongs to jth patient class allocated to the ith block; 
                           
                              
                                 
                                    X
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              (
                              n
                              )
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    n
                                 
                              
                              
                              
                                 
                                    S
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                                 
                                    n
                                 
                              
                              ,
                              
                              i
                              ∈
                              {
                              1
                              ,
                              …
                              ,
                              I
                              }
                           
                        , j
                        ∈{1,…,
                        J}. Let Φ
                        
                           i
                         be the set of permutations of arrived patients from J patient classes at the beginning of the ith block, and φ
                        =(φ
                        1,
                        φ
                        2,…, 
                        φ
                        
                           J
                        )∈
                        Φ
                        i where φ
                        
                           j
                        
                        ⩽
                        X
                        
                           i,j
                        (n), ∀j
                        ∈{1,…,
                        J}, be the number of patients showing up from the jth class. We further define 
                           
                              
                                 
                                    f
                                 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    n
                                    )
                                 
                              
                              (
                              x
                              )
                           
                         as the probability of having x patients arriving at the beginning of the ith block when nth patient called-in, and
                           
                              (2)
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          φ
                                          ∈
                                          
                                             
                                                Φ
                                             
                                             
                                                i
                                             
                                          
                                          
                                          and
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                             
                                          
                                          
                                             
                                                φ
                                             
                                             
                                                j
                                             
                                          
                                          =
                                          x
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∏
                                       
                                       
                                          j
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                (
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      j
                                                   
                                                
                                             
                                          
                                          
                                             
                                                (
                                                1
                                                -
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                             
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      i
                                                      ,
                                                      j
                                                   
                                                
                                                (
                                                n
                                                )
                                                -
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      j
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Then, the expected number of patients is calculated as follows:
                           
                              (3)
                              
                                 E
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 (
                                 n
                                 )
                                 )
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          x
                                       
                                    
                                 
                                 x
                                 ·
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                                 .
                              
                           
                        
                     

In this section, the calculation of E(Y
                        
                           i
                        (n)) is discussed for single resource and multiple resources.

The number of remaining patients at the end of the ith block, Y
                           
                              i
                           (n), depends on the total number of patients in the clinic at the ith block and the number of patients been served and complete treatment in the same block. The total number of patients in the clinic at the ith block includes the newly arrived patients at the beginning of the ith block and any remaining patients from the (i
                           −1)th block. The number of patients who left the clinic before the end of the ith block depends on the capacity of the clinic. Let Z(n) be the number of patients that could be served in one appointment block. Then, Y
                           
                              i
                           (n) can be obtained through the following recursive relationship.
                              
                                 (4)
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    n
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      (
                                                      0
                                                      ,
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      -
                                                      Z
                                                      (
                                                      n
                                                      )
                                                      )
                                                      )
                                                      ,
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      
                                                         
                                                            
                                                               0
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              X
                                                                           
                                                                           
                                                                              i
                                                                           
                                                                        
                                                                        (
                                                                        n
                                                                        )
                                                                        +
                                                                        
                                                                           
                                                                              Y
                                                                           
                                                                           
                                                                              i
                                                                              -
                                                                              1
                                                                           
                                                                        
                                                                        (
                                                                        n
                                                                        )
                                                                        -
                                                                        Z
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      i
                                                      =
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      I
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Suppose the stochastic variable Z(n) to be discrete, then the probability function f
                           
                              Z
                           (z) and F
                           
                              Z
                           (z) is defined as f
                           
                              Z
                            (z)=
                           Pr{Z(n)=
                           z} and F
                           
                              Z
                           (z)=
                           Pr{Z(n)⩽
                           z}; respectively. Note that if Z(n) follows a continuous probability distribution, then the probability of serving z patients in one appointment block is then defined as f
                           
                              Z
                           (z)=
                           Pr{z
                           −1⩽
                           Z(n)⩽
                           z}. Hence, the stochastic variable Y
                           
                              i
                           (n) follows the following probability distribution:

For the first appointment block (i
                           =1):
                              
                                 (5)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                1
                                             
                                          
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               =
                                                               z
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               =
                                                               z
                                                               +
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For the remaining appointment blocks (i
                           =2,…,
                           I):
                              
                                 (6)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               +
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                               =
                                                               z
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               +
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                               =
                                                               z
                                                               +
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            Z
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

Therefore, the
                              
                                 (7)
                                 
                                    E
                                    (
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                       
                                    
                                    (
                                    n
                                    )
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             y
                                          
                                       
                                    
                                    y
                                    ·
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                    .
                                 
                              
                           
                        

When a patent might require more than one resource during the visit, the actual number of remaining patients at the end of the ith block, Y
                           
                              i
                           (n), would depend on the number of patients who might complete using part of the resources required on their visits. Suppose T types of equipment are available in a physical therapy room with given capacity. It is fair to assume that the service time for each type of equipment is independent of all others. We first need to extend the current arrival process to include T types of equipment. Here the set of binary variables 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                              
                            is supplementary to the original schedule for nth call-in patient 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 I
                                 }
                                 ,
                                 
                                 j
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 J
                                 }
                              
                           . Further, 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 1
                              
                            if this patient requires tth type of equipment; otherwise, 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                                 =
                                 0
                                 ,
                                 
                                 t
                                 ∈
                                 {
                                 1
                                 ,
                                 …
                                 ,
                                 T
                                 }
                              
                           . Moreover, 
                              
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                                 ⩽
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ,
                                 t
                              
                           .

Let X
                           
                              i,j,t
                           (n) be the number of patients belongs to jth patient class allocated to the ith block requiring tth type of equipment is, and 
                              
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       t
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       n
                                    
                                 
                                 
                                 
                                    
                                       S
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                    
                                       n
                                    
                                 
                                 (
                                 t
                                 )
                                 ,
                                 
                                 ∀
                                 i
                                 ,
                                 j
                                 ,
                                 t
                              
                           . Let Φ
                           
                              i,t
                            be the set of permutations of arrived patients from J patient classes for tth type of equipment at the beginning of the ith block, and φ
                           =(φ
                           1,
                           φ
                           2,…,
                           φ
                           
                              J
                           )∈
                           Φ
                           
                              i,t
                            where φ
                           
                              j
                           
                           ⩽
                           X
                           
                              i,j,t
                           (n), ∀j
                           ∈{1,…,
                           J}, be the number of show-up patients from the jth class. Suppose the number of patients arriving at the beginning of the ith block for tth type of equipment is X
                           
                              i,t
                           (n). We further define 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                             ,
                                             t
                                          
                                       
                                       (
                                       n
                                       )
                                    
                                 
                                 (
                                 x
                                 )
                              
                            as the probability of x patients having arrived at the beginning of the ith block for the tth type of equipment when the nth patient called in, and
                              
                                 (8)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                X
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    x
                                    )
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             φ
                                             ∈
                                             
                                                
                                                   Φ
                                                
                                                
                                                   i
                                                   ,
                                                   t
                                                
                                             
                                             
                                             and
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                
                                             
                                             
                                                
                                                   φ
                                                
                                                
                                                   j
                                                
                                             
                                             =
                                             x
                                          
                                       
                                    
                                    
                                       
                                          
                                             ∏
                                          
                                          
                                             j
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   1
                                                   -
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                                
                                                   (
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         i
                                                         ,
                                                         j
                                                         ,
                                                         t
                                                      
                                                   
                                                   (
                                                   n
                                                   )
                                                   -
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

Let Z
                           
                              t
                           (n) be the number of patients that could be served for the tth type of equipment in one block and Y
                           
                              i,t
                           (n) be the number of remaining patients for the tth type of equipment at the end of the ith block. Then, Y
                           
                              i,t
                           (n) can be obtained through the following recursive relationship:
                              
                                 (9)
                                 
                                    
                                       
                                          Y
                                       
                                       
                                          i
                                          ,
                                          t
                                       
                                    
                                    (
                                    n
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      (
                                                      0
                                                      ,
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            ,
                                                            t
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      -
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      )
                                                      )
                                                      ,
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                      ,
                                                      
                                                      t
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      T
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         max
                                                      
                                                      (
                                                      0
                                                      ,
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            i
                                                            ,
                                                            t
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      +
                                                      
                                                         
                                                            Y
                                                         
                                                         
                                                            i
                                                            -
                                                            1
                                                            ,
                                                            t
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      -
                                                      
                                                         
                                                            Z
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      (
                                                      n
                                                      )
                                                      )
                                                      )
                                                      ,
                                                   
                                                   
                                                      i
                                                      =
                                                      2
                                                      ,
                                                      …
                                                      ,
                                                      I
                                                      ,
                                                      
                                                      t
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      T
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The dynamic of the system is shown as in Fig. 2
                           . Suppose the stochastic variable Z
                           
                              t
                           (n) follows some discrete probability distribution, the probability function 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 z
                                 )
                              
                            and 
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 z
                                 )
                              
                            is defined as 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 Pr
                                 {
                                 
                                    
                                       Z
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 n
                                 )
                                 =
                                 z
                                 }
                              
                            and 
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 Pr
                                 {
                                 
                                    
                                       Z
                                    
                                    
                                       t
                                    
                                 
                                 ⩽
                                 z
                                 }
                              
                           . Note that if Z
                           
                              t
                           (n) is a continuous stochastic variable, then the probability function 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 z
                                 )
                              
                            is defined as 
                              
                                 
                                    
                                       f
                                    
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 (
                                 z
                                 )
                                 =
                                 Pr
                                 {
                                 z
                                 -
                                 1
                                 ⩽
                                 
                                    
                                       Z
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 n
                                 )
                                 ⩽
                                 z
                                 }
                              
                           . Hence, the stochastic variable Y
                           
                              i,t
                           (n) follows the probability distribution:

For the first appointment block (i
                           =1) and tth type of equipment, t
                           =1,…,
                           T:
                              
                                 (10)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                1
                                                ,
                                                t
                                             
                                          
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               =
                                                               z
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               =
                                                               z
                                                               +
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  1
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      n
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

For the remaining appointment blocks (i
                           =2,…,
                           I) and tth type of equipment t
                           =1,…,
                           T:
                              
                                 (11)
                                 
                                    
                                       
                                          f
                                       
                                       
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          (
                                          n
                                          )
                                       
                                    
                                    (
                                    y
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               +
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                               =
                                                               z
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            F
                                                         
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      0
                                                      ,
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ∑
                                                            
                                                            
                                                               x
                                                               +
                                                               
                                                                  
                                                                     y
                                                                  
                                                                  
                                                                     ˆ
                                                                  
                                                               
                                                               =
                                                               z
                                                               +
                                                               y
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  X
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      x
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  Z
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      (
                                                      z
                                                      )
                                                      ·
                                                      
                                                         
                                                            f
                                                         
                                                         
                                                            
                                                               
                                                                  Y
                                                               
                                                               
                                                                  i
                                                                  -
                                                                  1
                                                               
                                                            
                                                            (
                                                            n
                                                            )
                                                         
                                                      
                                                      (
                                                      
                                                         
                                                            y
                                                         
                                                         
                                                            ˆ
                                                         
                                                      
                                                      )
                                                      ,
                                                   
                                                   
                                                      y
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      n
                                                      .
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              Proposition 1
                              
                                 The lower bound and upper bound of the number of remaining patients at the end of the ith block is the maximum number of remaining patients for some equipment type t, t
                                 ∈{1,
                                 …
                                 ,
                                 
                                 T}, and the sum of the remaining patients for all equipment types. That means,
                                 
                                    
                                       (12)
                                       
                                          max
                                          {
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                1
                                             
                                          
                                          (
                                          n
                                          )
                                          ,
                                          …
                                          ,
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                T
                                             
                                          
                                          (
                                          n
                                          )
                                          }
                                          ⩽
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                             
                                          
                                          (
                                          n
                                          )
                                          ⩽
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                Y
                                             
                                             
                                                i
                                                ,
                                                t
                                             
                                          
                                          (
                                          n
                                          )
                                          .
                                       
                                    
                                 
                              

The upper bound is satisfied by the trivial case when each call-in patient requires only one type of equipment. Then, the number of remaining patients in the clinic is simply equal to the sum of remaining patients for each type of equipment. Similarly, the lower bound is another trivial case when all patients require the same type of equipment. Therefore, the number of remaining patients in the clinic is equal to the number of remaining patients for that specific resource. □

The calculation of the actual value for the stochastic variable Y
                           
                              i
                            (n) is quite cumbersome since one remaining patient could be waiting for more than one type of equipment. Hence, based on proposition 1, we simplify the process by approximating this value using either the upper bound or the lower bound, which is denoted as ⌈Y
                           
                              i
                           (n)⌉or ⌈Y
                           
                              i
                            (n)⌉; respectively. From now on, the method of using the upper bound value, ⌈Y
                           
                              i
                           (n)⌉, to approximate Y
                           
                              i
                           (n) is referred to as “Convolution Estimation Method”. Or referred to as “Joint Cumulative Estimation Method” if the lower bound value, ⌈Y
                           
                              i
                           (n)⌉, is used.

Let Ω
                                 i
                               be the set of permutation of overflow patients for different types of equipment at the end of ith block, and ω
                              =(ω
                              1,
                              ω
                              2,…,
                              ω
                              
                                 T
                              )∈Ωi where ω
                              
                                 t
                              
                              ⩽
                              n, ∀t
                              ∈{1,…,
                              T}, be the number of remaining patients require tth type of equipment. Then, the aggregated probability for Y
                              
                                 i
                              (n) can be calculated as follows.
                                 
                                    (13)
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ⌈
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             n
                                             )
                                             ⌉
                                          
                                       
                                       (
                                       y
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  ω
                                                                  ∈
                                                                  
                                                                     
                                                                        Ω
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                                  
                                                                  and
                                                                  
                                                                  
                                                                     
                                                                        ∑
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        ω
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  =
                                                                  y
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  ∏
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                     ,
                                                                     t
                                                                  
                                                               
                                                               (
                                                               n
                                                               )
                                                            
                                                         
                                                         (
                                                         
                                                            
                                                               ω
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         )
                                                         ,
                                                      
                                                      
                                                         y
                                                         =
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         (
                                                         n
                                                         -
                                                         1
                                                         )
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         -
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  y
                                                                  ⩽
                                                                  (
                                                                  n
                                                                  -
                                                                  1
                                                                  )
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               f
                                                            
                                                            
                                                               ⌈
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               (
                                                               n
                                                               )
                                                               ⌉
                                                            
                                                         
                                                         (
                                                         y
                                                         )
                                                         ,
                                                      
                                                      
                                                         y
                                                         =
                                                         n
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Therefore,
                                 
                                    (14)
                                    
                                       E
                                       (
                                       ⌈
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                       ⌉
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                y
                                             
                                          
                                       
                                       y
                                       ·
                                       
                                          
                                             f
                                          
                                          
                                             ⌈
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             n
                                             )
                                             ⌉
                                          
                                       
                                       (
                                       y
                                       )
                                       .
                                    
                                 
                              
                           

The lower bound value of the remaining patients in the clinic at the end of the ith block is defined as the maximum remaining patients for some equipment type t, and t
                              ∈{1,…,
                              T}. Here it is assumed that the number of patients can be served in one block for each type of equipment is independent of all others. Hence, we have the cdf and pdf for the stochastic variable Y
                              
                                 i
                              (n) as follows.
                                 
                                    (15)
                                    
                                       
                                          
                                             F
                                          
                                          
                                             ⌈
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             n
                                             )
                                             ⌉
                                          
                                       
                                       (
                                       y
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∏
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     
                                                                        
                                                                           ∑
                                                                        
                                                                        
                                                                           
                                                                              
                                                                                 ω
                                                                              
                                                                              
                                                                                 t
                                                                              
                                                                           
                                                                           =
                                                                           0
                                                                        
                                                                        
                                                                           y
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        F
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              Y
                                                                           
                                                                           
                                                                              i
                                                                              ,
                                                                              t
                                                                           
                                                                        
                                                                        (
                                                                        n
                                                                        )
                                                                     
                                                                  
                                                                  (
                                                                  
                                                                     
                                                                        ω
                                                                     
                                                                     
                                                                        t
                                                                     
                                                                  
                                                                  )
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         y
                                                         =
                                                         0
                                                         ,
                                                         …
                                                         ,
                                                         (
                                                         n
                                                         -
                                                         1
                                                         )
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         1
                                                         -
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               ⌈
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               (
                                                               n
                                                               )
                                                               ⌉
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  n
                                                                  -
                                                                  1
                                                               
                                                            
                                                         
                                                         ,
                                                      
                                                      
                                                         y
                                                         =
                                                         n
                                                         ,
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              and
                                 
                                    (16)
                                    
                                       
                                          
                                             f
                                          
                                          
                                             ⌈
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             n
                                             )
                                             ⌉
                                          
                                       
                                       (
                                       y
                                       )
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               ⌈
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               (
                                                               n
                                                               )
                                                               ⌉
                                                            
                                                         
                                                         (
                                                         0
                                                         )
                                                         ,
                                                      
                                                      
                                                         y
                                                         =
                                                         0
                                                         ,
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               ⌈
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               (
                                                               n
                                                               )
                                                               ⌉
                                                            
                                                         
                                                         (
                                                         y
                                                         )
                                                         -
                                                         
                                                            
                                                               F
                                                            
                                                            
                                                               ⌈
                                                               
                                                                  
                                                                     Y
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               (
                                                               n
                                                               )
                                                               ⌉
                                                            
                                                         
                                                         (
                                                         y
                                                         -
                                                         1
                                                         )
                                                         ,
                                                      
                                                      
                                                         y
                                                         =
                                                         1
                                                         ,
                                                         …
                                                         ,
                                                         n
                                                         .
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

Then,
                                 
                                    (17)
                                    
                                       E
                                       (
                                       ⌈
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                       ⌉
                                       )
                                       =
                                       
                                          
                                             
                                                ∑
                                             
                                             
                                                y
                                             
                                          
                                       
                                       y
                                       ·
                                       
                                          
                                             f
                                          
                                          
                                             ⌈
                                             
                                                
                                                   Y
                                                
                                                
                                                   i
                                                
                                             
                                             (
                                             n
                                             )
                                             ⌉
                                          
                                       
                                       (
                                       y
                                       )
                                       .
                                    
                                 
                              
                           

Moreover, we have
                                 
                                    (18)
                                    
                                       E
                                       (
                                       ⌈
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                       ⌉
                                       )
                                       ⩽
                                       E
                                       (
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                       )
                                       ⩽
                                       E
                                       (
                                       ⌈
                                       
                                          
                                             Y
                                          
                                          
                                             i
                                          
                                       
                                       (
                                       n
                                       )
                                       ⌉
                                       )
                                       .
                                    
                                 
                              
                           

This stochastic appointment model consists of an iterative algorithm. Whenever a patient either calls in or simply walks in for an appointment, all appointment blocks in that service session are examined to find the best appointment block for this patient according to the objective function as in Eq. (1). The pseudo code of this appointment algorithm is depicted as follows.
                           
                              Initialization: Let n
                                 =0.


                                 Step 1: Update n
                                 =
                                 n
                                 +1 and suppose the call-in patient belongs to jth patient class, j
                                 ∈{1,…,
                                 J}. Moreover, this patient requires L
                                 
                                    n
                                  different equipment types as in the set 
                                    
                                       L
                                       (
                                       n
                                       )
                                       =
                                       {
                                       
                                          
                                             τ
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             τ
                                          
                                          
                                             
                                                
                                                   L
                                                
                                                
                                                   n
                                                
                                             
                                          
                                       
                                       }
                                    
                                 , where τ
                                 
                                    k
                                 
                                 ∈{1,…,
                                 T}, k
                                 =1,…,
                                 L
                                 
                                    n
                                 . Let W(n)=0.


                                 Step 2: For each appointment block i, i
                                 ∈{1,…,
                                 I}:
                                    
                                       
                                          Step 2.1: Set binary variables 
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                           to “1” if i′=
                                          i, j′=
                                          j, or “0”; otherwise. Calculate the value of E(X
                                          
                                             i
                                          (n)) as in Eq. (3).


                                          Step 2.2: Set binary variables 
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            i
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            j
                                                         
                                                         
                                                            ′
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                   
                                                
                                                (
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                )
                                             
                                           to “1” if i′=
                                          i, j′=
                                          j, and t′∈
                                          L(n), or “0”; otherwise. Estimate the value of E(Y
                                          
                                             i
                                          (n)) by either “Convolution Estimation Method” as in Eq. (14) or “Joint Cumulative Estimation Method” as in Eq. (17).


                                          Step 2.3: Find the expected profit to appoint nth patient as in Eq. (1). Update the value of W(n) only if the expected profit of assigning to this block is larger.


                                 Step 3: Assign the patient to the block with the largest W(n). Wait for the next patient, then go back to step 1.

Further note that no patient is turned away for an appointment in this algorithm. However, it is easy to include hospital policies in step 3 to achieve better service quality as well as the financial performance of the entire clinic. It is also possible to extend this appointment algorithm to reschedule appointments for cancellation or even to further reserve capacity for new patients in advance.

In this section, numerical examples inspired from the real settings for an outpatient clinic providing physical rehabilitation services are used to demonstrate the appointment process in Section 3.3. With multiple resources, the comparisons in the estimation methods in finding expected overflow patients are also demonstrated. Further, this stochastic appointment scheme is compared to traditional ones that assume to use homogeneous no-show probability or even ignore this information in making appointments.

Based on the observation in Rau et al. (2013), two types of equipment, namely interferential current (IFC) units and traction units for intermittent pelvic/cervical traction (IPT/ICT), counted for 43.09% of total service provided. IFC units were found to have the longest queue length and the traction units had the highest utilization rates (Rau et al., 2013). Therefore, our numerical example considered a treatment plan for each patient to require either one or both critical equipment in this therapy room, which includes 22 IFC units and 18 traction units. Since a 15-minute treatment time was assumed for these treatments based on the suggestion by the Bureau of National Health Insurance (BNHI) in Taiwan, an ideal maximum numbers of 44 patients and 36 patients were able to complete IFC treatments and IPT/ICT treatments in a 30-minute block; respectively. As was the actual practice in this outpatient clinic, we also assumed that appointments were only allowed to be scheduled in the first 3hours of a session to avoid extra overtime for a 4-hour session. An extensive description about this physical therapy room can be found in Rau et al. (2013).

In the following numerical runs, the first 3hours which are available for appointment is separated into six blocks of 30minutes, that is I
                     =6. Further, we assume there are two classes of patients; i.e., J
                     =2. Patients belonging to the first class have a show-up probability of 0.9; those belonging to the second class have a show-up probability of 0.6; that is, p
                     =(0.9,0.6). We consider only the capacity of two groups of rehabilitation resources: interferential current units and traction units. As T
                     =2 types of equipment, the number of patients that could be served to complete some treatment t in each block is assumed to follow triangular distributions, where Z
                     1(n)∼tri(0,44,22) and Z
                     2(n)∼tri(0,36,18), 1⩽
                     n
                     ⩽
                     N.

A total of 170 call-in patients with a given call-in sequence were used to simulate the observation during the most congested sessions. Table 1
                      summarizes the patients’ aggregated data. The ratio of patients belonging to class 1 is 74.7% and the ratio requiring both types of rehabilitation treatment is 60%. Also, it is assumed that no patient is turned away for an appointment.

For illustration purpose, the revenue of each patient treated is assumed to be 100; i.e., r
                        =100, where the overflow cost to be 40 per patient (i.e., w
                        =40) and the overtime cost in the last session to be 200 per patient (i.e., v
                        =200). Fig. 3
                         is the expected best profit W(n) as the nth patient called-in for an appointment. It was found that the difference in the expected profits calculated by “Convolution Estimation” costs and the “Joint Cumulative Estimation” costs was trivial, being fewer than 5 units before the 75th called-in patient. The detailed comparison on the maximum expected profits was depicted in Fig. 4
                        . The maximum expected profits with a value of 9587.5 and 9324.6 were achieved when patient 150 and patient 140 were assigned in the system.

Further, two trivial scenarios based on the assumption of patient classes were considered: all patients belong to either class 1 (j
                        =1) or class 2 (j
                        =2). As shown in Fig. 3, when every patient was prompted with a show-up probability of 0.9, this outpatient clinic could achieve a greater expected profit with a lower number of patients. The expected profit would deteriorate more dramatically as additional patients were scheduled. Fig. 4 shows the maximum profit of 9701.2 and 9413.4 when patient 135 and patient 133 were appointed. On the contrary, in the case of j
                        =2, significantly more patients would need to be appointed to reach the same level of expected profit. However, in the case of j
                        =1, the profit decreased more dramatically when an excess number of patients was scheduled.


                        Table 2
                         summarizes the workload in each appointment block after 170 patients were scheduled. It can be observed that the workload is similar in the different blocks for both estimation methods. The first block favors having more prompt patients, 36 patients and 34 patients for the Convolution Method and the Joint Cumulative Method, compared to the remaining blocks which range from 24 to 30 for both methods. When the Convolution Estimation Method was used to estimate the waiting and overtime costs with upper bound values, this algorithm tried to schedule more patients in earlier blocks than the Joint Cumulative Estimation Method to avoid a huge penalty.

In a traditional appointment system, patients are assigned to the appointment block with remaining capacity on a first-come, first-served basis. For example, based on the historical data, each appointment block is able to serve 30 patients on average. Then the block capacity can be set to 30 patients and any block with fewer than 30 scheduled patients is referred to as an available block. When a patient calls, he/she would be assigned to the earliest available block with currently fewer than 30 patients. Here, the traditional method is extended further with the design of prioritization rules based on either patient classes or on a treatment plan depicted as follows.
                           
                              
                                 Prompt patient first (or “class 1 first”) rule: This is a prioritization rule based on a patient’s class. If the current call-in patient belongs to class 1, which means that he/she is a more prompt patient with a show-up probability of 0.9, then he/she is assigned to the earliest available block. Otherwise, he/she is assigned to the latest available block.


                                 Negligent patient first (or “class 2 first”) rule: This prioritization rule is also based on a patient’s class. If the current call-in patient belongs to class 2, which means that he/she is a less prompt patient, or is referred as a negligent patient, with a show-up probability of only 0.6, then he/she is assigned to the earliest available block. Otherwise, he/she is assigned to the latest available block.


                                 Single-treatment patient first (or “single first”) rule: This is a prioritization rule based on a patient’s treatment plan. If the current call-in patient’s treatment plan involves only one type of equipment, which means that he/she needs a shorter treatment time, then he/she is assigned to the earliest available block. Otherwise, he/she is assigned to the latest available block.


                                 Multiple-treatment first patient (or “multiple first”) rule: This prioritization rule is also based on a patient’s treatment plan. If the call-in patient’s treatment plan requires multiple types of equipment, which means that he/she needs a longer treatment time, then he/she is assigned to the earliest available block. Otherwise, he/she is assigned to the latest available block.


                        Table 3
                         summarizes the workload in each appointment block after 170 patients were scheduled using different prioritization rules. The maximum number of patients in any appointment block had been limited to no more than 30 due to the block capacity. Regardless of which prioritization rule was used, it could be observed that the variation in the workload among different blocks was greater compared to the results by the stochastic algorithm as in Table 2. Moreover, the imbalance of workload was much more apparent when the prioritization rules based on treatment plan were used. Both the “single first” rule and the “multiple first” rule would flood the therapy room with patients requiring both types of treatment scheduled in the same appointment block, and cause additional fluctuation in the demand pattern for both treatment types.

To further compare the rule-based appointment system with the stochastic one, we then calculate the expected profit using Eq. (1) for resulting appointment schedules by prioritization rules as in Figs. 5 and 6
                        
                        . The performance using the stochastic algorithm dominated that for traditional methods. When patient class was used to prioritize patients, it was better to use the “class 1 first” rule, and the difference in profit obtained from the stochastic algorithm after appointing all patients was within 1000 units. If the treatment plan was used for prioritization rules, it was found that the “multiple first” rule outperformed the “single first” rule. However, the difference in the profit for the stochastic method and for the “multiple first” rule was larger than that for the “class 1 first” rule. Among all prioritization rules, the “single first” rule had the worst performance in expected profit since the most demanding patients were scheduled toward the later blocks, which resulted in a higher overtime cost.

In this stochastic appointment scheduling model, the total cost in the expected profit combines overflow cost (w) and overtime cost (v). As opposed to the value for revenue (r), these costs are rather obscure and difficult to quantify. To investigate the robustness of the proposed method under various cost setting, Fig. 7
                         shows the number of patients to be assigned with an appointment to achieve the maximum expected profit. For all scenarios, the revenue of treating each patient was 100; i.e., r
                        =100, and the patients’ calling sequence was assumed to be the same. In Fig. 7, six levels of overflow cost (w) were considered: 0, 20, 40, 60, 80, and 100 per patient. As for overtime cost in the last block, three levels considered were 100 (v
                        =100), 200 (v
                        =200), and 300 (v
                        =300) per patient.

Compared with Joint Cumulative Estimation Method (bold lines), the solutions obtained by Convolution Estimation Method (dash lines) were more conservative with less number of assigned patients since the upper bound value was used in estimating the waiting and overtime costs. When the overtime cost was low (i.e., v
                        =100), using Joint Cumulative Estimation Method generated the most aggressive solutions to accept almost all patients regardless the overflow cost levels. It had the largest difference (i.e., 34 patients) to the solution obtained by using Convolution Estimation Method when the overflow cost was the same as the overtime cost (i.e., w
                        =
                        v
                        =100). However, as the overtime costs increased, the gap between the solutions by these two methods reduced significantly. The average difference was 6 and 3.8 patients for overtime cost was set to be 200 and 300, respectively. It could be observed that, when the overtime cost level (v) was high, the impact of overflow cost levels (w) would be reduced and hence the resulting patient assignment schedules obtained were more robust.

@&#DISCUSSION AND CONCLUSION@&#

A stochastic appointment system for patients with a dynamic call-in sequence to outpatient clinics with multiple resources was proposed in this research. This model assigned the current call-in patient to a suitable appointment block in a manner to maximize the expected profit, which was a combined performance in revenue and patient waiting/overtime costs, alternatively referred to as overflow costs. With multiple resources, the expected overflow costs were estimated with the upper and lower bound values by using the Convolution Estimation Method and the Joint Cumulative Estimation Method. Since it was assumed that a scheduled patient might be a no-show with a given probability, overbooking policy was implied in this stochastic model such that the number of patients assigned to a block might exceed the average number of patients served to maximize the expected profit. Major conclusions are as follows.
                        
                           1.
                           The higher ratio of prompt patients, the better the profitability. The impact of different ratios in prompt and negligent patients was discussed in Section 4.1. The results showed that, when the system had more prompt patients, a higher maximum profit was achieved by serving fewer patients. As in the scenario of j
                              =1 and j
                              ={1,2} in Section 4.1, the maximum profit was in the range of 9413.4–9701.2 and 9324.6–9587.5 with the number of patients ranging from 133 to 135 and from 140 to 150 when the ratio of class 1 patients was 100% vs. 74.7%, respectively. It should be noted that, when all patients were prompt, the expected overflow costs would be increased faster than expected revenue when more patients than the optimal level were scheduled.

Prompt patient first vs. multiple-treatment patient first. In the traditional system, the “class 1 first” rule would generate better results in expected profit than other rules. The performance using the “multiple first” rule might seem compatible with the “class 1 first” rule, but the scheduling results would induce greater imbalance in the resource workload between the early and late blocks.

Number of patients scheduled in each session. It had been one of the most difficult decisions for any clinic administrative staff to decide on the cutoff number of patients to be scheduled in each session. It might not be the best practice to schedule all call-in patients, and the optimal number of patients in a session would depend on the patients’ show-up probabilities as well as the costs such as patients’ excessive waiting and possible overtime.

The maximum number of patients to be assigned for an appointment using this stochastic algorithm depends more on the level of overtime cost than the level of overflow cost. Moreover, when a much higher overtime cost is considered, the impact overflow cost levels would be significantly reduced.

Most outpatient clinics in Taiwan are still using a manual system to schedule patients based on empirical rules such as “first-come, first-served” to avoid socio debates on fairness in access to care. Although there is a dire need to improve efficiency and accessibility for the healthcare delivery system, changing the system of making appointments could be a challenging task. In a study of a local hospital at Chia-yi in Taiwan (Huarng & Lee, 1996), it was reported that the staff in this department was not willing to make more effort to implement the appointment system even though the benefits were shown to be significant. To cope with all outpatient visits, hospitals often opted to extend doctor hours and shorten visit length to maintain the timely access to service. This approach not only jeopardizes the quality of care but also the work conditions of physicians.

To fully consider the complicated factors such as no-shows and walk-ins in hospitals, the design in appointment systems would go beyond the traditional first-come, first-served mentality. This study addresses the misalignment of patients’ best interests with those of physicians’ and enables outpatient clinics to accommodate more new visits with same-day appointments. Our results have provided managerial insights into the impact of the strategies in appointment scheduling and overbooking toward the goal of achieving efficiency and timely patient accessibility to healthcare services. A possible future research could be a detail investigation on the variance of therapist overtimes and the patients waiting times. Other clinic performances in adopting stochastic scheduling methods can also be included and compared with traditional appointment rules using simulation or similar approach.

@&#ACKNOWLEDGEMENTS@&#

This research was sponsored in part by Taiwan’s National Science Council (NSC 101-2221-E-027-075). The authors would like to thank Dr. Chi-Lun Rau, M.D. and the entire staff from the participating clinic for their support. They are also thankful to the anonymous reviewers for their valuable comments and suggestions.

@&#REFERENCES@&#

