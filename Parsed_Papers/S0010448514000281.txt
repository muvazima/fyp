@&#MAIN-TITLE@&#Multi-dimensional dynamic programming in ruled surface fitting

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A multi-dimensional dynamic programming based ruled surface fitting scheme to a freeform rational surface.


                        
                        
                           
                           Providing solutions for the Ruled Surface Fitting (RSF) problem and the Ruled Surface Partitioning (RSP) problem in the discrete domain.


                        
                        
                           
                           Error-bound can be achieved by using the surface–surface composition technique.


                        
                        
                           
                           Highly parallel algorithms running on GPUs are employed to evaluate the multi-dimensional dynamic programming.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Ruled surface fitting

Multi-dimensional dynamic programming

Surface–surface composition

GPU algorithms

@&#ABSTRACT@&#


               
               
                  Ruled surfaces play an important role in many manufacturing and construction applications. In this work, we explore a multi-dimensional dynamic programming based ruled surface fitting scheme to a given freeform rational surface, 
                        S
                     . Considering two initial opposite boundaries of 
                        S
                     , sampled into a discrete piecewise linear polyline representation, the ruled surface fitting problem is reduced to a pairing-search between the polylines and elevations above the polylines, in the normal directions of 
                        S
                     . A four-dimensional dynamic programming solution is sought for the four dimensions prescribed by the two polylines and the two elevation levels along the surface normals. This multi-dimensional dynamic programming is evaluated using highly parallel algorithms running on GPUs that ensures the best fit to the sampled data. In order to evaluate the fitting error with respect to 
                        S
                     , we derive a scheme to compute a bound from above on the maximal error between a bilinear surface patch (formed by two consecutive point-pairs) and its corresponding surface region on 
                        S
                     . Surface–surface composition is employed to extract the corresponding surface region on 
                        S
                      to compare against. Finally, the above ruled surface fitting approach is also extended into a discrete algorithm to find the non-isoparametric subdivision curve on 
                        S
                      when a discrete recursive piecewise-ruled surface fitting is considered. A five- or seven-dimensional dynamic programming solution is employed towards this end and once again, surface–surface composition is employed to extract the two subdivided patches as tensor products.
               
            

@&#INTRODUCTION@&#

Ruled surfaces are widely used in many applications in manufacturing as well as civil engineering application. In manufacturing, while multi-axis CNC processes are well known, other manufacturing technologies, such as wire Electrically Discharged Machining (EDM)  [1] and 5-axis CNC flanking milling  [2–4] are also in extensive use. In wire EDM, a conducting wire is discharging electricity against a conductive stock and evaporates and cuts ruling lines in the material. Tool side CNC machining (e.g., flank milling) exploits the linear edge of the rotating tool to similarly cut along a line after carefully considering the non-zero thickness of the tool. Interestingly enough, other manufacturing processes also cut along lines in 3D. Examples include CNC water jet cutting as well as laser cutting. In building construction, ruled surfaces are used for the realization of free-form architecture  [5]. Recently, the use of hot wire cutting in styrofoam was also proposed towards mold making of surface tiles in architecture design [6].

Within all above applications, it is interesting that the following Ruled Surface Fitting (RSF) is still a highly investigated problem:


                     
                        Problem
                        RSF


                        Given a parametric surface 
                              
                                 S
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                           , find the best ruled surface fit to 
                              
                                 S
                              
                            under some metric.

A good solution to the above RSF problem would clearly increase the usability and quality of all aforementioned technologies for fabricating a given surface 
                        
                           S
                        
                      by swept cutting lines. The accuracy of the resulting artifact would greatly benefit from such an optimal ruling fit. However, as a ruled surface is hyperbolic in general  [7], one can expect that only a hyperbolic patch (or parabolic) 
                        
                           S
                        
                      will benefit from such a ruled surface fitting. Forced to use a line-cutting based technology that constructs ruled surfaces, the benefits for elliptical surface regions cannot be significant. Nevertheless, one can still hope to find the optimal ruled surface fit to any surface 
                        
                           S
                        
                      under this constrained manufacturing technologies. If multiple ruled surface patches may be tiled together, while fitting 
                        
                           S
                        
                     , the solution of the best Ruled Surface Partitioning (RSP) problem is also highly desirable:


                     
                        Problem
                        RSP


                        Given a parametric surface 
                              
                                 S
                              
                           , find the non-isoparametric partitioning of 
                              
                                 S
                              
                            into two sub-patches 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    L
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    R
                                 
                              
                            (or more generally several sub-patches), that is best fitted by two (several) piecewise ruled surfaces, minimizing some metric in RSF.

Finding the global optimum for RSF and RSP is difficult; unlike the prior work based on numerical optimization, this paper presents a ruled surface fitting scheme for solving the RSF and RSP problems in the discrete domain formed by sample points. The scheme finds an optimal ruled surface fitting once the discrete piecewise linear sampled sets of the boundaries of 
                        
                           S
                        
                      and the possible elevation (again discrete) of these points along the local normal of 
                        
                           S
                        
                     , are given. Each discrete ruling line is defined through two elevated sampled points on two opposite boundaries. The elevation is along the normal of 
                        
                           S
                        
                      and is also discretized.

Two consecutive ruling lines above the discrete sampled point set define a bilinear surface patch 
                        
                           B
                        
                      for which the corresponding patch of 
                        
                           S
                        
                     , 
                        
                           
                              
                                 S
                              
                           
                           
                              b
                           
                        
                     , is extracted using a surface–(bilinear) surface composition. An upper bound on the Hausdorff distance between 
                        
                           B
                        
                      and 
                        
                           
                              
                                 S
                              
                           
                           
                              b
                           
                        
                      is established by computing a bound on 
                        
                           ‖
                           
                              B
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           −
                           
                              
                                 
                                    S
                                 
                              
                              
                                 b
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ‖
                        
                     .

A four-dimensional dynamic programming problem is defined for all possible pairs of points and all possible allowed elevations. The best ruling fit to this discrete arrangement is then determined by solving a four-dimensional dynamic programming (4D-DP). A simple example can be seen in Fig. 1
                     . The DP algorithm has two phases. First a multi-dimensional table is computed for all possible pairing and elevations, a 4D table in this case. Then, path tracking is conducted from the source (the first ruling line at the beginning of the two boundaries) to the destination (the last ruling line at the end of the two boundaries). Special treatment must be made for the end conditions as the first and last ruling lines can be in arbitrary elevations. Further, if 
                        
                           S
                        
                      is a periodic surface, the first and the last ruling lines must be the same ruling line.

Both DP steps are of a complexity order that depends on the dimension of the built table. If each side of the table is of length 
                        n
                     , the 4D-DP has complexity of 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 4
                              
                           
                           )
                        
                     . However, the computation of each entry in the table requires an upper bound on the Hausdorff distance of 
                        
                           ‖
                           
                              B
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           −
                           
                              
                                 
                                    S
                                 
                              
                              
                                 b
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                           ‖
                        
                      and the construction time of the DP table governs the entire computation costs. Therefore, we employ highly parallel algorithms running on Graphics Processing Units (GPUs) to speed up the construction of the DP table.

@&#RELATED WORK@&#

To approximate a general surface, 
                           
                              S
                           
                        , by ruled surface(s) 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 i
                              
                           
                        , 
                           
                              S
                           
                         can be divided recursively into strips along isoparametric directions, as in  [2], and then each of the strips is fitted with a ruled surface. In [9], a surface subdivision with similar ruled surface fitting goals is made but along isophotes, which bounds the normal deviations but not the maximal deviation between 
                           
                              S
                           
                         and 
                           
                              
                                 
                                    R
                                 
                              
                              
                                 i
                              
                           
                        . In both cases, the algorithm is greedy and the RSF/RSP computations are not optimal. Approximation of a general surface using ruled surfaces is also considered in  [10] by solving a non-linear optimization function that minimizes distances between the tangent planes of the original surface and the fitted ruled surface over the domain. The special case of a surface of revolution is also considered in  [10], exploiting fitted hyperboloid of one sheet that are ruled surfaces. Some work on fitting ruled surfaces was also done by using a curve representation on the dual Gaussian sphere of a surface (Refs. [11–13]).

The research of  [14,5] focuses on using continuous non-linear optimization methods to solve the RSF problem over sampled point sets from the input surface 
                           
                              S
                           
                        . They conducted a sequence of quadratic programs to solve the optimal surface problem by the Squared Distance Minimization (SDM)  [15] and applications in architecture has been demonstrated. A given surface is divided into strips in  [14] by the asymptotic curves computed from the level-set of field of asymptotic directions—tangents to the intersection curves between the input surface and the tangent plane at a surface point. Overall, the result has not Hausdorff distance guarantee to/from the original input surface. Further, this is different from our method, were we tackle the RSP problem in a discrete domain.

While not much can be found on ruled surface fitting to general surfaces, there is also a large body of research on piecewise developable surface fitting to general surfaces [16–24]. Developable surfaces are a special type of ruled surfaces. In [17,20], the input general surface is first divided into strips (along isoparametric curves in  [17]), which are then fitted with developable surfaces.

Although polygonal meshes are not in the scope of this work, the construction of ruled and developable sheets for a mesh representation has captured much attention. Wang and Tang  [8] introduced a fitting of a polygonal strip to a ruled surface and employs the shortest path algorithm to find a best fitting on a graph scored by the fitting error, which is in fact a 2D-DP. The resultant polygonal strips interpolate the boundary curves of the given surface 
                           
                              S
                           
                        , ending up in a larger fitting error (see Fig. 1 as an example). Mesh surfaces are also processed in [22,21] under nonlinear optimization framework into shapes that converge to developable surfaces. In  [19], the mesh is divided into polygonal strips and each strip is then laid out flat as a developable sheet. In  [18], the mesh model is first decomposed into cylindrical shapes that are then fitting with developable sheets. Other segmentation methods for using developable mesh surface to approximate a given freeform surface can be found in  [25].

We present algorithms for solving the RSF and the RSP problems in a discrete domain formed by sampling points over freeform input surfaces. The main contributions of our work include: 
                           
                              –
                              An approach is introduced to find the best ruled surface fitting for a discrete, piecewise linear, sampled set of a given general freeform surface, using a four-dimensional dynamic programming scheme.

A method is presented to provide a guaranteed yet fairly tight upper bound on the Hausdorff distance between the bilinear patch formed out of two adjacent ruling lines and the corresponding region in the input surface 
                                    
                                       S
                                    
                                 .

GPU-based algorithms are employed to speed up the evaluation of multi-dimensional DP table.

The presented ruled surface fitting approach based on dynamic programming is also extended to solve the RSP problem by a 5D-DP–7D-DP (which allows to elevate boundary curves). A locally-optimal partitioning curve can be determined for a given surface, 
                                    
                                       S
                                    
                                 , so two ruled surfaces can be fitted to the two subdivided patches, while minimizing some fitting error metric.

The rest of the paper is organized as follows. We present the multi-dimensional DP based method for solving the RSF problem in Section  2, with a guaranteed bounds on the Hausdorff error. The GPU-based algorithms for speeding up the computation are introduced in Section  3. The extension of this multi-dimensional DP technique to compute a solution to the RSP problem is derived in Section  4. Examples and performance evaluations of our approach are described in Section  5. Finally, we conclude in Section  6. Acronyms will be used in the rest of this paper—a summary is given in Table 1
                        .

In order to offer a viable solution to the RSF problem, we discretize the solution domain. Without loss of generality, the 
                        
                           
                              v
                           
                           
                              
                                 min
                              
                           
                        
                      and 
                        
                           
                              v
                           
                           
                              
                                 max
                              
                           
                        
                      boundary curves of a tensor product parametric surface 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      are denoted by 
                        
                           
                              
                                 C
                              
                           
                           
                              0
                           
                        
                        
                           (
                           u
                           )
                        
                        =
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    min
                                 
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 C
                              
                           
                           
                              1
                           
                        
                        
                           (
                           u
                           )
                        
                        =
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    max
                                 
                              
                           
                           )
                        
                      with 
                        u
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                     . Let 
                        
                           
                              
                                 C
                              
                           
                           
                              0
                           
                        
                        
                           (
                           
                              
                                 u
                              
                              
                                 i
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 C
                              
                           
                           
                              1
                           
                        
                        
                           (
                           
                              
                                 u
                              
                              
                                 j
                              
                           
                           )
                        
                      (
                        i
                        ,
                        j
                        ∈
                        
                           [
                           0
                           ,
                           n
                           −
                           1
                           ]
                        
                     ) be 
                        n
                      uniformly sampled points along 
                        
                           
                              
                                 C
                              
                           
                           
                              0
                           
                        
                      and 
                        
                           
                              
                                 C
                              
                           
                           
                              1
                           
                        
                     : 
                        
                           (1)
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       0
                                    
                                 
                                 
                                    (
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             i
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    +
                                    
                                       
                                          i
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    )
                                 
                                 ,
                              
                           
                           
                              
                                 
                                    
                                       
                                          Q
                                       
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       
                                          C
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             j
                                          
                                          
                                             n
                                             −
                                             1
                                          
                                       
                                       )
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             min
                                          
                                       
                                    
                                    +
                                    
                                       
                                          j
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          
                                             max
                                          
                                       
                                    
                                    )
                                 
                                 .
                              
                           
                        
                      Further, let 
                        
                           
                              
                                 n
                              
                           
                           
                              ˆ
                           
                        
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                      denote the unit normal vector of 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      at 
                        
                           (
                           
                              
                                 u
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 0
                              
                           
                           )
                        
                     . The surface normal space above or below 
                        
                           
                              
                                 C
                              
                           
                           
                              0
                           
                        
                        
                           (
                           u
                           )
                        
                      is discretized into 
                        n
                        ×
                        
                           (
                           2
                           m
                           +
                           1
                           )
                        
                      sample points, 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              ,
                              k
                           
                        
                     , with 
                        i
                        ∈
                        
                           [
                           0
                           ,
                           n
                           −
                           1
                           ]
                        
                      marches along 
                        
                           
                              
                                 C
                              
                           
                           
                              0
                           
                        
                      and 
                        k
                        ∈
                        
                           [
                           −
                           m
                           ,
                           m
                           ]
                        
                      along the surface normals, as 
                        
                           (2)
                           
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              =
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    0
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                              +
                              k
                              τ
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        τ
                      governs the step size along the normal direction. These points are called 
                        P
                     -points.

In a similar fashion, we define a set of 
                        Q
                     -points around 
                        
                           
                              
                                 C
                              
                           
                           
                              1
                           
                        
                        
                           (
                           u
                           )
                        
                     as 
                        
                           (3)
                           
                              
                                 
                                    
                                       Q
                                    
                                 
                                 
                                    j
                                    ,
                                    l
                                 
                              
                              =
                              
                                 
                                    
                                       C
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                              +
                              l
                              τ
                              
                                 
                                    
                                       n
                                    
                                 
                                 
                                    ˆ
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 )
                              
                              ,
                           
                        
                      where 
                        j
                        ∈
                        
                           [
                           0
                           ,
                           n
                           −
                           1
                           ]
                        
                      and 
                        l
                        ∈
                        
                           [
                           −
                           m
                           ,
                           m
                           ]
                        
                     . An illustration for this point elevation is given in Fig. 2
                     .

Every (
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              ,
                              k
                           
                        
                     , 
                        
                           
                              
                                 Q
                              
                           
                           
                              j
                              ,
                              l
                           
                        
                     ) pair defines a ruling line, 
                        
                           
                              
                                 L
                              
                           
                           
                              i
                              ,
                              k
                           
                           
                              j
                              ,
                              l
                           
                        
                        =
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              ,
                              k
                           
                        
                        
                           
                              
                                 Q
                              
                           
                           
                              j
                              ,
                              l
                           
                        
                     , with 
                        O
                        
                           (
                           
                              
                                 n
                              
                              
                                 2
                              
                           
                           
                              
                                 m
                              
                              
                                 2
                              
                           
                           )
                        
                      possible ruling lines in all. Once discretized, the RSF problem can be reduced to finding a sequence of ruling line segments 
                        Γ
                     :
                        
                           (4)
                           
                              Γ
                              =
                              
                                 〈
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       0
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             0
                                          
                                       
                                    
                                    
                                       0
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             0
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       
                                          L
                                       
                                    
                                    
                                       n
                                       −
                                       1
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             
                                                |
                                                Γ
                                                |
                                             
                                             −
                                             1
                                          
                                       
                                    
                                    
                                       n
                                       −
                                       1
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             
                                                |
                                                Γ
                                                |
                                             
                                             −
                                             1
                                          
                                       
                                    
                                 
                                 〉
                              
                              ,
                           
                        
                      where 
                        
                           
                              i
                           
                           
                              t
                           
                        
                        ≤
                        
                           
                              i
                           
                           
                              t
                              +
                              1
                           
                        
                      and 
                        
                           
                              j
                           
                           
                              t
                           
                        
                        ≤
                        
                           
                              j
                           
                           
                              t
                              +
                              1
                           
                        
                     . The set of ruling lines, 
                        Γ
                     , defines a piecewise ruled surface, 
                        
                           R
                        
                     , and spans all domain, starting from 
                        
                           
                              
                                 L
                              
                           
                           
                              0
                              ,
                              
                                 
                                    k
                                 
                                 
                                    0
                                 
                              
                           
                           
                              0
                              ,
                              
                                 
                                    l
                                 
                                 
                                    0
                                 
                              
                           
                        
                      and terminating at 
                        
                           
                              
                                 L
                              
                           
                           
                              n
                              −
                              1
                              ,
                              
                                 
                                    k
                                 
                                 
                                    
                                       |
                                       Γ
                                       |
                                    
                                    −
                                    1
                                 
                              
                           
                           
                              n
                              −
                              1
                              ,
                              
                                 
                                    l
                                 
                                 
                                    
                                       |
                                       Γ
                                       |
                                    
                                    −
                                    1
                                 
                              
                           
                        
                     . 
                        
                           R
                        
                     , in turn, should minimize some fitting error metric to the input surface 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     .

The ruled surface constructed in this way is 
                        
                           
                              G
                           
                           
                              1
                           
                        
                      when 
                        n
                        →
                        ∞
                     . In practice, the 4D-DP creates a dense list of ruling lines, 
                        Γ
                      (i.e. Eq. (4)), which is monotone (but not strictly monotone) in both 
                        i
                      and 
                        j
                     . If a smooth result is desired, one can fit a pair of smooth and regular spline curves to the sequence of corresponding points on 
                        Γ
                     . This curve fitting should ensure monotonicity, on one hand, and should bound the error it introduces, on the other.

We now introduce the metrics under which the fitting takes place, and then present methods for evaluating these metrics. Lastly, the DP algorithm to find the best 
                        Γ
                     , given points 
                        
                           
                              
                                 P
                              
                           
                           
                              i
                              ,
                              k
                           
                        
                      and 
                        
                           
                              
                                 Q
                              
                           
                           
                              j
                              ,
                              l
                           
                        
                     , will be discussed.

The Hausdorff distance has been widely used to evaluate the shape similarity between two surfaces. However, the computation of the precise Hausdorff distance is typically time-consuming  [26] and therefore difficult to use as a metric to search for the best set of ruling line segments.

Here, seeking the best (piecewise) ruling fit of 
                           Γ
                         to 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , we offer two computationally tractable alternatives to  [26], one that is based on line–surface distance computations and one that is based on surface–surface distance computation. The latter also provides an upper bound on the precise Hausdorff distance:


                        
                           
                              (i)
                              
                                 Line–Surface Metric: The maximal distance from line 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  to 
                                    
                                       S
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                  is 
                                    
                                       (5)
                                       
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                H
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                
                                                
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ,
                                             
                                                S
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                max
                                             
                                             
                                                
                                                   p
                                                
                                                ∈
                                                
                                                   
                                                      
                                                         L
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                   
                                                   
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                             
                                          
                                          
                                             
                                                min
                                             
                                             
                                                u
                                                ,
                                                v
                                             
                                          
                                          
                                             ‖
                                             
                                                p
                                             
                                             −
                                             
                                                S
                                             
                                             
                                                (
                                                u
                                                ,
                                                v
                                                )
                                             
                                             ‖
                                          
                                          ,
                                       
                                    
                                  where 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          H
                                       
                                    
                                  is the one-sided Hausdorff distance from 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  to 
                                    
                                       S
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 . Assuming 
                                    
                                       S
                                    
                                  is 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                 , one can derive an upper bound on 
                                    
                                       
                                          
                                             
                                                D
                                             
                                             
                                                ̃
                                             
                                          
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             j
                                             ,
                                             l
                                          
                                       
                                       ,
                                       
                                          S
                                       
                                       )
                                    
                                  by searching for the bi-normal line to both 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  and 
                                    
                                       S
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 , a problem that can be formulated as three algebraic constraints in three variables and that can be further reduced to two constraints in two variables by projecting this arrangement to a plane orthogonal to 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                 .

The sought ruled surface should minimize the following line–surface metric in average error: 
                                    
                                       (6)
                                       
                                          
                                             
                                                D
                                             
                                             
                                                A
                                                v
                                                g
                                             
                                             
                                                L
                                             
                                          
                                          
                                             (
                                             Γ
                                             ,
                                             
                                                S
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               L
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            k
                                                         
                                                         
                                                            j
                                                            ,
                                                            l
                                                         
                                                      
                                                      ∈
                                                      Γ
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      j
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            D
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      H
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            L
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                      
                                                         j
                                                         ,
                                                         l
                                                      
                                                   
                                                   ,
                                                   
                                                      S
                                                   
                                                   )
                                                
                                             
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      S
                                                   
                                                
                                             
                                          
                                       
                                    
                                  where 
                                    
                                       
                                          A
                                       
                                       
                                          S
                                       
                                    
                                  is the total area of the input surface 
                                    
                                       S
                                    
                                  and 
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                  is the supporting area of line 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  in 
                                    
                                       S
                                    
                                 , or the area 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  is considered contributing to. 
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                  can be estimated as the area half way between 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  and its previous ruling line and half way to the next ruling line. Alternatively, the supporting area of ruling line 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  can be estimated as the area of the bilinear patch formed by 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                       
                                          j
                                          ,
                                          l
                                       
                                    
                                  and its previous ruling line, next ruling line, or the average of the two.

As an alternative to the average error we can also employ the 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                  norm: 
                                    
                                       (7)
                                       
                                          
                                             
                                                D
                                             
                                             
                                                
                                                   
                                                      L
                                                   
                                                   
                                                      ∞
                                                   
                                                
                                             
                                             
                                                L
                                             
                                          
                                          
                                             (
                                             Γ
                                             ,
                                             
                                                S
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                max
                                             
                                             
                                                
                                                   
                                                      
                                                         L
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                   
                                                   
                                                      j
                                                      ,
                                                      l
                                                   
                                                
                                                ∈
                                                Γ
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      D
                                                   
                                                   
                                                      ̃
                                                   
                                                
                                             
                                             
                                                H
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      L
                                                   
                                                
                                                
                                                   i
                                                   ,
                                                   k
                                                
                                                
                                                   j
                                                   ,
                                                   l
                                                
                                             
                                             ,
                                             
                                                S
                                             
                                             )
                                          
                                          .
                                       
                                    
                                  Assuming 
                                    
                                       S
                                    
                                  is 
                                    
                                       
                                          C
                                       
                                       
                                          1
                                       
                                    
                                  and is Lipschitz continuous, 
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          L
                                       
                                    
                                    
                                       (
                                       Γ
                                       ,
                                       
                                          S
                                       
                                       )
                                    
                                  converges to the one-sided Hausdorff distance from 
                                    Γ
                                  to 
                                    
                                       S
                                    
                                  as the distance between two neighboring line segments in 
                                    Γ
                                  is shrinking.

In the ensuing discussion, the computation of Line–Surface Approximate Distance is denoted by LSAD.


                                 Surface–Surface Metric: The Line–surface metric is simple to evaluate. However, it is one sided and as a result, regions on 
                                    
                                       S
                                    
                                  can be arbitrarily far from the ruling lines, between sampled points. A better, yet somewhat more expensive computationally, symmetric error-bound, that consider surface–surface distances, is now described.

Considering two consecutive ruling line segments 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 . A bilinear surface patch 
                                    
                                       (8)
                                       
                                          
                                             
                                                
                                                   B
                                                
                                             
                                             
                                                t
                                             
                                          
                                          =
                                          
                                             〈
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                             〉
                                          
                                       
                                    
                                  is defined between the four end points
                                    1
                                 
                                 
                                    1
                                    In fact, the final ruled surface obtained from 
                                          Γ
                                        can be approximated in the discrete form by the collection of these bilinear patches.
                                  of the two ruling segments, 
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Q
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    ∈
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                j
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                                +
                                                1
                                             
                                          
                                       
                                    
                                 .

Let 
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   l
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          
                                             v
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                       )
                                    
                                  be the four corresponding parameters of these corners of 
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          t
                                       
                                    
                                  in the parametric space of 
                                    
                                       S
                                    
                                  and let 
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       r
                                       ,
                                       s
                                       )
                                    
                                 , 
                                    r
                                    ,
                                    s
                                    ∈
                                    
                                       [
                                       0
                                       ,
                                       1
                                       ]
                                    
                                  be a bilinear surface defined through these four 
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                  parametric locations. Finally, Let 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                  be the supporting area of 
                                    
                                       S
                                    
                                  to 
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          t
                                       
                                    
                                 , in Euclidean space, as 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    =
                                    
                                       S
                                    
                                    
                                       (
                                       
                                          
                                             
                                                b
                                             
                                          
                                          
                                             t
                                          
                                       
                                       
                                          (
                                          r
                                          ,
                                          s
                                          )
                                       
                                       )
                                    
                                 . The Hausdorff distance between 
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          t
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                  is 
                                    
                                       (9)
                                       
                                          
                                             
                                                D
                                             
                                             
                                                H
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      B
                                                   
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      S
                                                   
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          max
                                          
                                             (
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      p
                                                   
                                                   ∈
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   min
                                                
                                                
                                                   r
                                                   ,
                                                   s
                                                
                                             
                                             
                                                ‖
                                                
                                                   p
                                                
                                                −
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   r
                                                   ,
                                                   s
                                                   )
                                                
                                                ‖
                                             
                                             ,
                                             
                                                
                                                   max
                                                
                                                
                                                   r
                                                   ,
                                                   s
                                                
                                             
                                             
                                                
                                                   min
                                                
                                                
                                                   
                                                      p
                                                   
                                                   ∈
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                ‖
                                                
                                                   p
                                                
                                                −
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   (
                                                   r
                                                   ,
                                                   s
                                                   )
                                                
                                                ‖
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                  and in Section  2.2 we describe how the bound on 
                                    
                                       
                                          D
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                B
                                             
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             
                                                S
                                             
                                          
                                          
                                             
                                                
                                                   b
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                  is computed. Here again, one can consider the average error or the 
                                    
                                       
                                          L
                                       
                                       
                                          ∞
                                       
                                    
                                  norms: 
                                    
                                       
                                          (10)
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   A
                                                   v
                                                   g
                                                
                                                
                                                   B
                                                
                                             
                                             
                                                (
                                                Γ
                                                ,
                                                
                                                   S
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  B
                                                               
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         ∈
                                                         Γ
                                                      
                                                   
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   
                                                      
                                                         D
                                                      
                                                      
                                                         H
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               B
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               S
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  b
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                         
                                                      
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         A
                                                      
                                                      
                                                         S
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                       
                                          (11)
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         ∞
                                                      
                                                   
                                                
                                                
                                                   B
                                                
                                             
                                             
                                                (
                                                Γ
                                                ,
                                                
                                                   S
                                                
                                                )
                                             
                                             =
                                             
                                                
                                                   max
                                                
                                                
                                                   
                                                      
                                                         
                                                            B
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ∈
                                                   Γ
                                                
                                             
                                             
                                                
                                                   D
                                                
                                                
                                                   H
                                                
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         B
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         S
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             ,
                                          
                                       
                                    
                                  where 
                                    
                                       
                                          A
                                       
                                       
                                          i
                                       
                                       
                                          j
                                       
                                    
                                  is the area of patch 
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          A
                                       
                                       
                                          S
                                       
                                    
                                  is the whole area of 
                                    
                                       S
                                    
                                    
                                       (
                                       u
                                       ,
                                       v
                                       )
                                    
                                 .

Reconsider the composition 
                           
                              S
                           
                           
                              (
                              
                                 
                                    
                                       b
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 (
                                 r
                                 ,
                                 s
                                 )
                              
                              )
                           
                        . This composition extracts the region of 
                           
                              S
                           
                         that is supporting the bilinear region 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 t
                              
                           
                           
                              (
                              r
                              ,
                              s
                              )
                           
                        . By support region we hint to the fact that this region is typically going to be the closest region in 
                           
                              S
                           
                         to 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                        . Other unrelated regions of 
                           
                              S
                           
                         might be closer, but this support region provides an upper bound that is expected to be fairly tight. Further, the supporting region follows the parameterization of 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 t
                              
                           
                           
                              (
                              r
                              ,
                              s
                              )
                           
                        . A simple scheme to compute the surface–surface composition, in the Bézier domain, can be found in the Appendix.

We now have two surfaces in Euclidean space: surface 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              (
                              r
                              ,
                              s
                              )
                           
                         that is confined to the bilinear domain 
                           
                              
                                 
                                    b
                                 
                              
                              
                                 t
                              
                           
                           
                              (
                              r
                              ,
                              s
                              )
                           
                         and a bilinear surface patch 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                           
                              (
                              r
                              ,
                              s
                              )
                           
                         (i.e., Eq. (8)). Further, both surfaces share the 
                           
                              
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                              
                              
                                 2
                              
                           
                         domain but do not share the same functional space (i.e. orders and knot sequences of 
                           B
                        -spline surfaces). However, one can apply degree elevation to the surface with the lower orders (i.e., the bilinear surface patch 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                        ) and insert missing knots as necessary, to make the functional space compatible. Then, 
                           
                              (12)
                              
                                 
                                    
                                       D
                                    
                                    
                                       H
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    )
                                 
                                 ≤
                                 
                                    
                                       max
                                    
                                    
                                       r
                                       ,
                                       s
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          
                                             S
                                          
                                       
                                       
                                          
                                             
                                                b
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       (
                                       r
                                       ,
                                       s
                                       )
                                    
                                    −
                                    
                                       
                                          
                                             B
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       r
                                       ,
                                       s
                                       )
                                    
                                    ‖
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       r
                                       ,
                                       s
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             
                                                S
                                             
                                             
                                                
                                                   
                                                      b
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                    −
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             P
                                          
                                       
                                       
                                          i
                                          j
                                       
                                       
                                          
                                             
                                                B
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                    ‖
                                 
                                 =
                                 
                                    
                                       max
                                    
                                    
                                       r
                                       ,
                                       s
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                u
                                             
                                          
                                       
                                    
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          0
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                v
                                             
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          i
                                       
                                    
                                    
                                       (
                                       r
                                       )
                                    
                                    
                                       
                                          B
                                       
                                       
                                          j
                                       
                                    
                                    
                                       (
                                       s
                                       )
                                    
                                    ‖
                                 
                                 ≤
                                 
                                    
                                       max
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 
                                    {
                                    
                                       ‖
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   
                                                      
                                                         b
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       −
                                       
                                          
                                             
                                                P
                                             
                                          
                                          
                                             i
                                             j
                                          
                                          
                                             
                                                
                                                   B
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ‖
                                    
                                    }
                                 
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 i
                                 j
                              
                              
                                 
                                    
                                       B
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         are the control points of 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                        , respectively, and 
                           
                              
                                 k
                              
                              
                                 u
                              
                           
                         and 
                           
                              
                                 k
                              
                              
                                 v
                              
                           
                         are the respective lengths of the control meshes of the surfaces. By this formulation, one should simply examine the maximum difference between corresponding control points of the two surfaces for the error-bound of 
                           
                              
                                 D
                              
                              
                                 H
                              
                           
                           
                              (
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              )
                           
                        . Hence after, the computation of the Surface–Surface Hausdorff-distance Bound following Eq. (12) is denoted as SSHB.

When degree raising (or refining) the bilinear surface 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                        , two options can be used — either place the new control points uniformly in 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                         or let the control points of 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                         proportionally distributed according to the control points of 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        , a method we denote projected parameterization (see Fig. 3
                         for an illustration). Specifically, the control points of 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                         are
                           
                              (13)
                              
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       i
                                       j
                                    
                                    
                                       
                                          
                                             B
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 =
                                 
                                    [
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         u
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      
                                                         i
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      Q
                                                   
                                                
                                                
                                                   
                                                      
                                                         j
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         t
                                                         +
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                                 
                                    [
                                    
                                       
                                          
                                             1
                                             −
                                             
                                                
                                                   α
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   α
                                                
                                                
                                                   j
                                                
                                             
                                          
                                       
                                    
                                    ]
                                 
                              
                           
                         with 
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           =
                           
                              
                                 j
                              
                              
                                 
                                    
                                       k
                                    
                                    
                                       v
                                    
                                 
                              
                           
                         in the uniform parameterization. When taking projected parameterization on 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                        , 
                           
                              (14)
                              
                                 
                                    
                                       α
                                    
                                    
                                       j
                                       
                                       
                                          (
                                          j
                                          ≠
                                          0
                                          )
                                       
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                          
                                          
                                             j
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                a
                                                −
                                                1
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                a
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             a
                                          
                                          
                                             
                                                
                                                   k
                                                
                                                
                                                   v
                                                
                                             
                                          
                                       
                                       
                                          ‖
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                a
                                                −
                                                1
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         P
                                                      
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                0
                                                ,
                                                a
                                             
                                             
                                                
                                                   
                                                      S
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ‖
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       α
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 0
                                 ,
                              
                           
                         where 
                           
                              
                                 
                                    
                                       
                                          P
                                       
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 0
                                 ,
                                 j
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                         is the projected point of 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        ’s control point, 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 0
                                 ,
                                 j
                              
                              
                                 
                                    
                                       S
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                              
                           
                        , on the line 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        . Note that, 
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                         defined in this way is monotonic and 
                           
                              
                                 α
                              
                              
                                 j
                              
                           
                           ∈
                           
                              (
                              0
                              ,
                              1
                              )
                           
                        , and the shape of 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         will keep as a bilinear patch. While projected parameterization is somewhat more expensive computationally, it also provides a tighter bound on 
                           
                              
                                 D
                              
                              
                                 H
                              
                           
                           
                              (
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              )
                           
                         as will be demonstrated in the results section.

Having the ability to bound 
                           
                              
                                 D
                              
                              
                                 H
                              
                           
                           
                              (
                              
                                 
                                    
                                       B
                                    
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    
                                       
                                          b
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              )
                           
                         (i.e., Eq. (9)), we are now ready to derive the optimal ruling lines for approximating 
                           
                              S
                           
                        . Assume, for now, that 
                           
                              S
                           
                         is open and hence the first ruling line must be between 
                           
                              
                                 
                                    P
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         (i.e.,  
                           
                              
                                 
                                    L
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                              
                           
                        ), where all elevated combinations of 
                           
                              
                                 k
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 l
                              
                              
                                 0
                              
                           
                         should be examined as initial candidates and selecting the best fit. Similarly, recalling we sampled 
                           n
                         samples in 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 0
                              
                           
                         and 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 1
                              
                           
                        , the last ruling line must be 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 n
                                 −
                                 1
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       
                                          |
                                          Γ
                                          |
                                       
                                       −
                                       1
                                    
                                 
                              
                              
                                 n
                                 −
                                 1
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       
                                          |
                                          Γ
                                          |
                                       
                                       −
                                       1
                                    
                                 
                              
                           
                        . Considering an intermediate ruling line 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        , the next ruling line can be obtained by succeeding in 
                           
                              (i)
                              a 
                                    P
                                 -point only (i.e.,  
                                    
                                       
                                          i
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    1
                                  and 
                                    
                                       
                                          j
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                 ),

a 
                                    Q
                                 -point only (i.e.,  
                                    
                                       
                                          i
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                  and 
                                    
                                       
                                          j
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    1
                                 ), or

both 
                                    P
                                 - and 
                                    Q
                                 -points (i.e.,  
                                    
                                       
                                          i
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    1
                                  and 
                                    
                                       
                                          j
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    1
                                 ).

upward, in the normal direction, by assigning 
                                    
                                       
                                          k
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    1
                                  (or 
                                    
                                       
                                          l
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                    +
                                    1
                                 ),

downward, in the reversed normal direction, by assigning 
                                    
                                       
                                          k
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                    −
                                    1
                                  (or 
                                    
                                       
                                          l
                                       
                                       
                                          t
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                    −
                                    1
                                 ), or

staying at the same elevation by keeping 
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                  (or 
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                 ) unchanged.

Assume the successor line of 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         is line 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                        . Then, the approximation error between the bilinear patch formed by 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                         and 
                           
                              S
                           
                         can be computed by SSHB, introduced in Section  2.1. The supporting area of the bilinear patch 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    L
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                         is approximated by the summed area of two triangles: 
                           △
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                    
                                 
                              
                           
                         and 
                           △
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                    
                                 
                              
                           
                           
                              
                                 
                                    Q
                                 
                              
                              
                                 
                                    
                                       j
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                           
                              
                                 
                                    P
                                 
                              
                              
                                 
                                    
                                       i
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       t
                                       +
                                       1
                                    
                                 
                              
                           
                        , or a refined tessellation on the given surface 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . By this formulation, the optimal set of ruling lines, which minimize the metrics 
                           
                              
                                 D
                              
                              
                                 A
                                 v
                                 g
                              
                              
                                 B
                              
                           
                           
                              (
                              Γ
                              ,
                              
                                 S
                              
                              )
                           
                        , are determined by dynamic-programming  [27], in two phases:


                        Phase I of DP: Scoring
                     

To compute the minimal averaged-error of bilinear patches to 
                           
                              S
                           
                         in some path from 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         to 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 n
                                 −
                                 1
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       
                                          |
                                          Γ
                                          |
                                       
                                       −
                                       1
                                    
                                 
                              
                              
                                 n
                                 −
                                 1
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       
                                          |
                                          Γ
                                          |
                                       
                                       −
                                       1
                                    
                                 
                              
                           
                        , we initialize a 4D score table for the dynamic-programming (DP) with dimensions: 
                           n
                           ×
                           n
                           ×
                           
                              (
                              2
                              m
                              +
                              1
                              )
                           
                           ×
                           
                              (
                              2
                              m
                              +
                              1
                              )
                           
                        .

Consider an intermediate ruling line 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 i
                                 ,
                                 k
                              
                              
                                 j
                                 ,
                                 l
                              
                           
                        , and denote its (so-far) score value by 
                           
                              
                                 D
                              
                              
                                 A
                                 v
                                 g
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 l
                              
                           
                        . For this averaging case, and considering the predecessors of 
                           
                              
                                 D
                              
                              
                                 A
                                 v
                                 g
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 l
                              
                           
                        , the score table entries are updated by the following rule: 
                           
                              (15)
                              
                                 
                                    
                                       D
                                    
                                    
                                       A
                                       v
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          D
                                       
                                       
                                          A
                                          v
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          D
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             j
                                             ,
                                             l
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          S
                                       
                                       )
                                    
                                    }
                                 
                                 ,
                              
                           
                         with 
                           
                              
                                 
                                    
                                       (
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          i
                                          ,
                                          k
                                          )
                                       
                                       ,
                                       
                                          (
                                          i
                                          −
                                          1
                                          ,
                                          k
                                          )
                                       
                                       ,
                                       
                                          (
                                          i
                                          −
                                          1
                                          ,
                                          k
                                          −
                                          1
                                          )
                                       
                                       ,
                                       
                                          (
                                          i
                                          −
                                          1
                                          ,
                                          k
                                          +
                                          1
                                          )
                                       
                                       }
                                    
                                    ,
                                 
                              
                              
                                 (16)
                                 
                                    
                                       (
                                       
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             t
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       {
                                       
                                          (
                                          j
                                          ,
                                          l
                                          )
                                       
                                       ,
                                       
                                          (
                                          j
                                          −
                                          1
                                          ,
                                          l
                                          )
                                       
                                       ,
                                       
                                          (
                                          j
                                          −
                                          1
                                          ,
                                          l
                                          −
                                          1
                                          )
                                       
                                       ,
                                       
                                          (
                                          j
                                          −
                                          1
                                          ,
                                          l
                                          +
                                          1
                                          )
                                       
                                       }
                                    
                                    ,
                                    
                                    0
                                    ≤
                                    
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    <
                                    n
                                    
                                    −
                                    m
                                    ≤
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                    ≤
                                    m
                                    .
                                 
                              
                           
                         To avoid singularities and self-intersections in the DP computation, we do not allow 
                           P
                        - or 
                           Q
                        -points to move upward or downward without moving forward (i.e. the predecessor options of 
                           
                              (
                              i
                              ,
                              k
                              ±
                              1
                              )
                           
                         and 
                           
                              (
                              j
                              ,
                              l
                              ±
                              1
                              )
                           
                         are excluded). Only straight-forward, up-forward, down-forward or stay stationary moves are allowed. Furthermore, stationary move of both 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              )
                           
                           =
                           
                              (
                              i
                              ,
                              k
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    t
                                 
                              
                              )
                           
                           =
                           
                              (
                              j
                              ,
                              l
                              )
                           
                         cannot be selected simultaneously. In summary, Eq. (16), offers 15 different possible movements of the 
                           P
                        –
                           Q
                         ruling lines.

Similarly, for minimizing the maximal error case, we have (compare with Eq. (15)): 
                           
                              (17)
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       ,
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       min
                                    
                                    
                                       
                                          
                                             j
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             i
                                          
                                          
                                             t
                                          
                                       
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             t
                                          
                                       
                                    
                                 
                                 
                                    {
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             j
                                             ,
                                             l
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                
                                                   j
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          S
                                       
                                       )
                                    
                                    }
                                 
                              
                           
                         with the same set of candidate combinations of 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         as in Eq. (16).

All the entries of the 4D table can be updated row by row, top to bottom, left to right in four nested loops—i.e., letting 
                           i
                           ,
                           j
                           =
                           0
                           ⇒
                           n
                           −
                           1
                         and 
                           k
                           ,
                           l
                           =
                           −
                           m
                           ⇒
                           m
                        . The computational complexity of this update is in the order of the number of entries in the table, or 
                           O
                           
                              (
                              
                                 
                                    n
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    m
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        .

Finally, as a standard step of DP, every entry 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              ,
                              l
                              )
                           
                         in the 4D score table should be record which predecessor is used to update the score at 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              ,
                              l
                              )
                           
                        , so we can back trace it.


                        Phase II of DP: Back-tracking
                     

Once all the scores of all the entries in the 4D table are computed, the optimal solution path can be determined by the following two steps:
                           
                              –
                              Checking all the entries with 
                                    i
                                    =
                                    j
                                    =
                                    n
                                    −
                                    1
                                  to find an entry 
                                    
                                       (
                                       n
                                       −
                                       1
                                       ,
                                       n
                                       −
                                       1
                                       ,
                                       
                                          
                                             k
                                          
                                          
                                             o
                                          
                                       
                                       ,
                                       
                                          
                                             l
                                          
                                          
                                             o
                                          
                                       
                                       )
                                    
                                  with minimal value 
                                    
                                       
                                          D
                                       
                                       
                                          A
                                          v
                                          g
                                       
                                       
                                          n
                                          −
                                          1
                                          ,
                                          n
                                          −
                                          1
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                o
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                o
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          min
                                       
                                       
                                          k
                                          ,
                                          l
                                       
                                    
                                    
                                       {
                                       
                                          
                                             D
                                          
                                          
                                             A
                                             v
                                             g
                                          
                                          
                                             n
                                             −
                                             1
                                             ,
                                             n
                                             −
                                             1
                                             ,
                                             k
                                             ,
                                             l
                                          
                                       
                                       }
                                    
                                 . If there are more than one such end ruling line with minimal score value, we can randomly pick one or adopt some heuristic to choose one (e.g., selecting the ruling line with 
                                    min
                                    
                                       {
                                       
                                          |
                                          k
                                          |
                                       
                                       +
                                       
                                          |
                                          l
                                          |
                                       
                                       }
                                    
                                  which is less elevated from the given surface).

Starting from the selected end ruling line, and using the recorded predecessor of each entry, the sought sequence of ruling lines can be traced back one by one. The process of back-tracking stops when reaching an entry with 
                                    i
                                    =
                                    j
                                    =
                                    0
                                 .

At every step, either 
                           i
                         or 
                           j
                         (or both), are decreased in the back-tracking procedure that hence always terminates. The piecewise ruled surface that globally minimizes the desired discrete norm for 
                           
                              S
                           
                         can hence be created in 
                           O
                           
                              (
                              n
                              +
                              m
                              )
                           
                        .

The above multi-dimensional DP based method for searching for the best ruled surface in the discrete domain can be extended to fit periodic surfaces as well. Finding the best periodic ruled surface can be realized by a 5D dynamic-programming with dimensions: 
                           n
                           ×
                           n
                           ×
                           
                              (
                              2
                              m
                              +
                              1
                              )
                           
                           ×
                           
                              (
                              2
                              m
                              +
                              1
                              )
                           
                           ×
                           n
                        , where we introduce an additional dimension of size 
                           n
                         to consider shifting the starting ruling line from 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 0
                                 ,
                                 k
                              
                              
                                 0
                                 ,
                                 l
                              
                           
                         to 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 0
                                 ,
                                 k
                              
                              
                                 q
                                 ,
                                 l
                              
                           
                         along this new dimension (denoted the 
                           Q
                        -shifting dimension). The update rules for the score table entries are similar to what are introduced above. Specifically, the value of table entry 
                           
                              
                                 D
                              
                              
                                 A
                                 v
                                 g
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 l
                                 ,
                                 q
                              
                           
                         can only be updated by the other entries with the same 
                           q
                         shift. From Eq. (15), we obtain 
                           
                              (18)
                              
                                 
                                    
                                       D
                                    
                                    
                                       A
                                       v
                                       g
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       ,
                                       l
                                       ,
                                       q
                                    
                                 
                                 =
                                 min
                                 
                                    {
                                    
                                       
                                          D
                                       
                                       
                                          A
                                          v
                                          g
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          q
                                       
                                    
                                    +
                                    
                                       
                                          D
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             
                                                (
                                                j
                                                +
                                                q
                                                )
                                             
                                             mod
                                             n
                                             ,
                                             l
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                                +
                                                q
                                                )
                                             
                                             mod
                                             n
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          S
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                         As a result, we do not really need to run a 5D-DP. Instead, we conduct 
                           n
                         4D-DP’s by using different shift values of 
                           q
                           ∈
                           
                              {
                              0
                              ,
                              1
                              ,
                              …
                              ,
                              n
                              −
                              1
                              }
                           
                        . Similarly, for 
                           
                              
                                 D
                              
                              
                                 
                                    
                                       L
                                    
                                    
                                       ∞
                                    
                                 
                              
                              
                                 i
                                 ,
                                 j
                                 ,
                                 k
                                 ,
                                 l
                                 ,
                                 q
                              
                           
                         and following Eq. (17), we get 
                           
                              (19)
                              
                                 
                                    
                                       D
                                    
                                    
                                       
                                          
                                             L
                                          
                                          
                                             ∞
                                          
                                       
                                    
                                    
                                       i
                                       ,
                                       j
                                       ,
                                       k
                                       ,
                                       l
                                       ,
                                       q
                                    
                                 
                                 =
                                 min
                                 
                                    {
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                j
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                          ,
                                          q
                                       
                                    
                                    ,
                                    
                                       
                                          D
                                       
                                       
                                          H
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             
                                                (
                                                j
                                                +
                                                q
                                                )
                                             
                                             mod
                                             n
                                             ,
                                             l
                                          
                                       
                                       
                                          
                                             
                                                L
                                             
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   t
                                                
                                             
                                             ,
                                             
                                                
                                                   k
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      j
                                                   
                                                   
                                                      t
                                                   
                                                
                                                +
                                                q
                                                )
                                             
                                             mod
                                             n
                                             ,
                                             
                                                
                                                   l
                                                
                                                
                                                   t
                                                
                                             
                                          
                                       
                                       ,
                                       
                                          S
                                       
                                       )
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

One difficulty in using the above DP to fit a periodic ruled surfaces stems from the fact that the starting ruling line and the ending ruling line must coincide (see Fig. 4
                         for an example). We enforce the coincidence of 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       0
                                    
                                 
                              
                              
                                 0
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       0
                                    
                                 
                              
                           
                         and 
                           
                              
                                 
                                    L
                                 
                              
                              
                                 n
                                 −
                                 1
                                 ,
                                 
                                    
                                       k
                                    
                                    
                                       
                                          |
                                          Γ
                                          |
                                       
                                       −
                                       1
                                    
                                 
                              
                              
                                 n
                                 −
                                 1
                                 ,
                                 
                                    
                                       l
                                    
                                    
                                       
                                          |
                                          Γ
                                          |
                                       
                                       −
                                       1
                                    
                                 
                              
                           
                         by modifying the score updating rule as follows: 
                           
                              –
                              At the initialization step, the scores of all 
                                    
                                       
                                          D
                                       
                                       
                                          A
                                          v
                                          g
                                          
                                          /
                                          
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          n
                                          −
                                          1
                                          ,
                                          n
                                          −
                                          1
                                          ,
                                          k
                                          ,
                                          l
                                          ,
                                          q
                                       
                                    
                                  are assigned to infinity.

During the score update, not only the predecessors but also the ‘source’ of the first ruling line 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          0
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                0
                                             
                                          
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                  which contributes to the score 
                                    
                                       
                                          D
                                       
                                       
                                          i
                                          ,
                                          j
                                          ,
                                          k
                                          ,
                                          l
                                          ,
                                          q
                                       
                                    
                                  is recorded in each entry of the scoring table.

When the updating process gets to the end with 
                                    i
                                    =
                                    n
                                    −
                                    1
                                  and 
                                    j
                                    =
                                    n
                                    −
                                    1
                                 , the score updating of 
                                    
                                       
                                          D
                                       
                                       
                                          A
                                          v
                                          g
                                          
                                          /
                                          
                                          
                                             
                                                L
                                             
                                             
                                                ∞
                                             
                                          
                                       
                                       
                                          n
                                          −
                                          1
                                          ,
                                          n
                                          −
                                          1
                                          ,
                                          k
                                          ,
                                          l
                                          ,
                                          q
                                       
                                    
                                  is only allowed if the ‘source’ of its predecessor is at the same level in normal elevation (i.e.,  
                                    k
                                    =
                                    
                                       
                                          k
                                       
                                       
                                          s
                                       
                                    
                                  and 
                                    l
                                    =
                                    
                                       
                                          l
                                       
                                       
                                          s
                                       
                                    
                                  when the ‘source’ of its predecessor is 
                                    
                                       
                                          
                                             L
                                          
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                k
                                             
                                             
                                                s
                                             
                                          
                                       
                                       
                                          0
                                          ,
                                          
                                             
                                                l
                                             
                                             
                                                s
                                             
                                          
                                       
                                    
                                 ).

We now present the GPU-based algorithms for computing the ruled surface approximating to a given surface 
                        
                           S
                        
                      in the discrete domain. First, a method for computing SSHB is introduced, which can be parallelized and run on GPUs. Second, we develop a method to conduct the approximate distance queries between a ruling line and 
                        
                           S
                        
                      in a more efficient way with the help of distance-field on GPUs.

In practice, SSHB was mainly used in 4D-DP, and LSAD in higher dimensions DP (e.g., 5D-DP for fitting periodic surfaces), mainly due to the excessive computing and memory needs of the SSHB method.

The surface–surface distance computation with a tight error-bound is time-consuming. For a 4D-DP with dimension 
                           
                              
                                 50
                              
                              
                                 2
                              
                           
                           ×
                           
                              
                                 41
                              
                              
                                 2
                              
                           
                        , it takes more than an hour on a PC with iCore 7 CPU. Most of the computation time is spent on the surface–surface distance query (i.e., the step that fills the score table of the DP). To reduce the computing time, a GPU/CPU hybrid scheme is developed to compute the SSHB for the score table used in the DP.

At first, we compute the set of control meshes for all possible surface regions on the given surface 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         according to the boundary samples 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 0
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         and 
                           
                              
                                 
                                    C
                                 
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              )
                           
                        . As 
                           i
                           ,
                           j
                           ∈
                           
                              {
                              0
                              ,
                              …
                              ,
                              n
                              −
                              1
                              }
                           
                        , there are 
                           
                              (i)
                              
                                 
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    ×
                                    n
                                  triangular patches formed by 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 , 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                  (called 
                                    P
                                 -succeed patches),


                                 
                                    n
                                    ×
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                  triangular patches formed by 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 , 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                  (called 
                                    Q
                                 -succeed patches),

and 
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                    ×
                                    
                                       (
                                       n
                                       −
                                       1
                                       )
                                    
                                  quadrangular patches formed by 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 , 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          0
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             i
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                 , 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                             +
                                             1
                                          
                                       
                                       )
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                       
                                       
                                          1
                                       
                                    
                                    
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       )
                                    
                                  (called 
                                    P
                                    Q
                                 -succeed patches).

The three arrays are copied to the memory of the GPU, and the solution of a 4D-DP is computed by a CPU/GPU hybrid approach. According to the update rules of the score table (e.g., either Eqs.  (15) or (17)), we construct 15 surface–surface distance tables (in 4D)—according to the 15 possible 
                           P
                        - and 
                           Q
                        -succeeding options presented in Eq. (16). The entries of these tables are filled in a highly parallel manner. Specifically, the 15 surface–surface distance tables, 
                           
                              
                                 Θ
                              
                              
                                 1
                                 ,
                                 …
                                 ,
                                 15
                              
                           
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              ,
                              l
                              )
                           
                        , are for the items, 
                           
                              
                                 D
                              
                              
                                 H
                              
                           
                           
                              (
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          k
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       
                                          j
                                       
                                       
                                          t
                                       
                                    
                                    ,
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                                 
                                    j
                                    ,
                                    l
                                 
                              
                              ,
                              
                                 S
                              
                              )
                           
                         (with 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         and 
                           
                              (
                              
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    l
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         as given in Eq. (16)), that are checked during the 4D-DP score table update. Each thread fills one entry of the score table by computing the corresponding distance between the bilinear patch formed by the two ruling lines 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                           =
                           
                              〈
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    
                                       L
                                    
                                 
                                 
                                    t
                                    +
                                    1
                                 
                              
                              〉
                           
                         and its corresponding surface region 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        . Specifically, the control points of 
                           
                              
                                 
                                    B
                                 
                              
                              
                                 t
                              
                           
                         are refined to follow the surface 
                           
                              
                                 
                                    S
                                 
                              
                              
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                              
                           
                        , by a projected parameterization (see Section  2.2). An error-bounded distance is then established by Eq. (12). Both steps are implemented in a highly parallel way running on GPUs.

Copying the entries of 
                           
                              
                                 Θ
                              
                              
                                 1
                                 ,
                                 …
                                 ,
                                 15
                              
                           
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              ,
                              l
                              )
                           
                         back to the CPU side, the score table of 4D-DP can be updated according to Eqs.  (15) or (17). Lastly, the best ruling lines according to the scores can be determined at the CPU side by the back-tracking method proposed in Section  2.3. For the 4D-DP with a table of size 
                           
                              
                                 50
                              
                              
                                 2
                              
                           
                           ×
                           
                              
                                 41
                              
                              
                                 2
                              
                           
                        , this GPU/CPU hybrid approach can generate the optimal fitting in around 5 s.

One drawback of the above method is that the surface–surface distance tables can easily exhaust the graphics memory when the dimension of DP or the sampling rate (i.e.,  
                           n
                         and 
                           m
                        ) increases. To realize the computation on high dimensional DP and dense samples, the line–surface distance based metrics can be adopted (i.e., Eqs. (6) and (7)). In the update rules of the 4D-DP, the error term introduced by a bilinear patch (Eq. (9)) are changed to the error introduced by a new ruling line (Eq. (5)). By this change, a more efficient but less accurate (and no error bound) GPU-based algorithm can be realized (i.e., LSAD).

A discrete Voronoi diagram (VD) sampled on uniform voxels using a GPU-based distance transformation  [29] is constructed to help conducting line–surface distance queries to the given freeform surface 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        . The VD employed here is a discrete one. The voxels containing any point of 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         are labeled as site points of VD. Every voxel stores the coordinate of its nearest site point in the discrete domain 
                           
                              
                                 Z
                              
                              
                                 3
                              
                           
                         of voxels, specifically for a voxel 
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                           
                         the value 
                           I
                           
                              (
                              i
                              ,
                              j
                              ,
                              k
                              )
                           
                           ∈
                           
                              
                                 Z
                              
                              
                                 3
                              
                           
                         gives the coordinates of its nearest site. Fig. 5
                         shows the example VD of a NURBS surface.

To evaluate the distance between a line segment 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 s
                              
                           
                           
                              
                                 
                                    q
                                 
                              
                              
                                 e
                              
                           
                         and 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                         (with 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 s
                              
                           
                         and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 e
                              
                           
                           ∈
                           
                              
                                 ℜ
                              
                              
                                 3
                              
                           
                        ), we need to first find out all the voxels 
                           
                              (
                              
                                 
                                    i
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    j
                                 
                                 
                                    t
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         that are swept by a point 
                           
                              q
                           
                           
                              (
                              t
                              )
                           
                           =
                           
                              (
                              1
                              −
                              t
                              )
                           
                           
                              
                                 
                                    q
                                 
                              
                              
                                 s
                              
                           
                           +
                           t
                           
                              
                                 
                                    q
                                 
                              
                              
                                 e
                              
                           
                         with 
                           t
                           ∈
                           
                              [
                              0
                              ,
                              1
                              ]
                           
                        . Then, the closest distance between the centers of these voxels and 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 s
                              
                           
                           
                              
                                 
                                    q
                                 
                              
                              
                                 e
                              
                           
                         is used as an approximation of the one-side Hausdorff distance between 
                           
                              
                                 
                                    q
                                 
                              
                              
                                 s
                              
                           
                           
                              
                                 
                                    q
                                 
                              
                              
                                 e
                              
                           
                         and 
                           
                              S
                           
                           
                              (
                              u
                              ,
                              v
                              )
                           
                        , which can be efficiently computed in parallel on GPUs.

The dynamic programming based method for computing optimal ruled surface fitting can be further extended to determine an optimal ruling subdivision curve for 
                        
                           S
                        
                     —i.e., the RSP problem. The solution domain is discretized in a higher dimension. The boundary curves 
                        
                           
                              
                                 C
                              
                           
                           
                              0
                           
                        
                        
                           (
                           u
                           )
                        
                      and 
                        
                           
                              
                                 C
                              
                           
                           
                              1
                           
                        
                        
                           (
                           u
                           )
                        
                      of 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      are uniformly sampled into 
                        n
                        
                        P
                     - and 
                        n
                     
                     
                        Q
                     -points as in Eq. (1). However, the interior region of surface 
                        
                           S
                        
                      is now also sampled by 
                        n
                        ×
                        d
                      points as 
                        
                           (20)
                           
                              
                                 
                                    
                                       M
                                    
                                 
                                 
                                    a
                                    ,
                                    b
                                 
                              
                              =
                              
                                 S
                              
                              
                                 (
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          a
                                       
                                       
                                          n
                                          −
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    
                                       u
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       n
                                       −
                                       1
                                    
                                 
                                 
                                    
                                       u
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 ,
                                 
                                    (
                                    1
                                    −
                                    
                                       
                                          b
                                          +
                                          1
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    )
                                 
                                 
                                    
                                       v
                                    
                                    
                                       
                                          min
                                       
                                    
                                 
                                 +
                                 
                                    
                                       b
                                       +
                                       1
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 
                                    
                                       v
                                    
                                    
                                       
                                          max
                                       
                                    
                                 
                                 )
                              
                           
                        
                      with 
                        a
                        ∈
                        
                           [
                           0
                           ,
                           n
                           −
                           1
                           ]
                        
                      and 
                        b
                        ∈
                        
                           [
                           0
                           ,
                           d
                           −
                           1
                           ]
                        
                     . These new points are denoted 
                        M
                     -points. By this formulation, picking one 
                        P
                     -point, one 
                        Q
                     -point and one 
                        M
                     -point can form a pair of ruling line segments: 
                        
                           
                              
                                 L
                              
                           
                           
                              i
                              ,
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           
                        
                        ≡
                        
                           
                              
                                 P
                              
                           
                           
                              i
                           
                        
                        
                           
                              
                                 M
                              
                           
                           
                              a
                              ,
                              b
                           
                        
                      and 
                        
                           
                              
                                 L
                              
                           
                           
                              j
                              ,
                              
                                 (
                                 a
                                 ,
                                 b
                                 )
                              
                           
                        
                        ≡
                        
                           
                              
                                 M
                              
                           
                           
                              a
                              ,
                              b
                           
                        
                        
                           
                              
                                 Q
                              
                           
                           
                              j
                           
                        
                     . The RSP problem is reduced to finding a sequence of such pairs of ruling line segments. For a set of ruling line pairs, 
                        Υ
                     , the solution of RSP problem needs to minimize the difference between the ruled surfaces and 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     , where the ruled surfaces are approximated by 
                        
                           {
                           
                              
                                 
                                    L
                                 
                              
                              
                                 i
                                 ,
                                 
                                    (
                                    a
                                    ,
                                    b
                                    )
                                 
                              
                           
                           }
                        
                      and 
                        
                           {
                           
                              
                                 
                                    L
                                 
                              
                              
                                 j
                                 ,
                                 
                                    (
                                    a
                                    ,
                                    b
                                    )
                                 
                              
                           
                           }
                        
                     .

Again, to avoid self-intersections in the DP computation, we allow 
                        P
                     - or 
                        Q
                     -points to either move forward or keep their current position. For an 
                        M
                     -point, it can move left-forward, straight-forward, right-forward or stay stationary. Finally, it is not allowed to keep all three points stationary.

The optimal 
                        M
                     -curve in the form of a sequence of 
                        M
                     -points can be determined by the dynamic programming framework. If none of the 
                        P
                     -, 
                        Q
                     - and 
                        M
                     -points is allowed to be elevated above/below 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     , the result can be obtained by a 4D-DP. If only 
                        M
                     -points can be elevated along surface normals, a 5D-DP is used. The dimension of DP can be further raised to 7D if all 
                        P
                     -, 
                        Q
                     - and 
                        M
                     -points are allowed to be elevated (see Fig. 6
                      for an example).


                     Virtual refinement: The subdivision of a given surface 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                      by a general interior curve 
                        
                           
                              
                                 b
                              
                           
                           
                              M
                           
                        
                        
                           (
                           t
                           )
                        
                        =
                        
                           (
                           u
                           
                              (
                              t
                              )
                           
                           ,
                           v
                           
                              (
                              t
                              )
                           
                           )
                        
                      into two surface patches 
                        
                           
                              
                                 S
                              
                           
                           
                              L
                           
                        
                      and 
                        
                           
                              
                                 S
                              
                           
                           
                              R
                           
                        
                      that together precisely represent the original shape of 
                        
                           S
                        
                      is not trivial and typically necessitates the use of surface–surface composition. Moreover, such a subdivision will increase the complexity of the resulting surfaces (e.g., raise the degrees due to the composition and hence the number of control points). Further recursive subdivision of the surfaces, towards a finer ruled surfaces’ fitting (as is shown in Fig. 11), expands the magnitude of this degree raising difficulty. Hence, we adopt a strategy of virtual subdivision to overcome this problem.

For a given tensor surface 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     , its four boundary curves are represented by four straight lines, in the parametric domain. Assume, w.l.o.g., the initial subdivision curve 
                        
                           
                              
                                 b
                              
                           
                           
                              M
                           
                        
                        
                           (
                           t
                           )
                        
                        =
                        
                           (
                           u
                           
                              (
                              t
                              )
                           
                           ,
                           v
                           
                              (
                              t
                              )
                           
                           )
                        
                      according to the 
                        M
                     -points in the 
                        u
                        ,
                        v
                     -domain spans from the 
                        u
                        =
                        0
                      boundary to the 
                        u
                        =
                        1
                      boundary. The two new subdivided surface patches 
                        
                           
                              
                                 S
                              
                           
                           
                              L
                           
                        
                        
                           (
                           
                              
                                 u
                              
                              
                                 l
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 l
                              
                           
                           )
                        
                        ,
                        ∀
                        
                           
                              u
                           
                           
                              l
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              l
                           
                        
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                      and 
                        
                           
                              
                                 S
                              
                           
                           
                              R
                           
                        
                        
                           (
                           
                              
                                 u
                              
                              
                                 r
                              
                           
                           ,
                           
                              
                                 v
                              
                              
                                 r
                              
                           
                           )
                        
                        ,
                        ∀
                        
                           
                              u
                           
                           
                              r
                           
                        
                        ,
                        
                           
                              v
                           
                           
                              r
                           
                        
                        ∈
                        
                           [
                           0
                           ,
                           1
                           ]
                        
                      can be represented as follows: 
                        
                           (i)
                           A continuous mapping 
                                 
                                    
                                       Ω
                                    
                                    
                                       L
                                    
                                 
                               from 
                                 
                                    
                                       u
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                               to the 
                                 u
                                 ,
                                 v
                               region which is bounded by 
                                 
                                    {
                                    u
                                    =
                                    0
                                    ,
                                    u
                                    =
                                    1
                                    ,
                                    v
                                    =
                                    0
                                    ,
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    }
                                 
                               is constructed with the help of a Coons patch interpolation  [30]. Similarly, a mapping 
                                 
                                    
                                       Ω
                                    
                                    
                                       R
                                    
                                 
                               from 
                                 
                                    
                                       u
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    1
                                    ]
                                 
                               to the 
                                 u
                                 ,
                                 v
                               region which is bounded by 
                                 
                                    {
                                    u
                                    =
                                    0
                                    ,
                                    u
                                    =
                                    1
                                    ,
                                    
                                       
                                          
                                             b
                                          
                                       
                                       
                                          M
                                       
                                    
                                    
                                       (
                                       t
                                       )
                                    
                                    ,
                                    v
                                    =
                                    1
                                    }
                                 
                               is formulated as another Coons patch interpolation.

When using the method in Section  2 to evaluate the shape error, every point in the 
                                 
                                    
                                       u
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       l
                                    
                                 
                               (or 
                                 
                                    
                                       u
                                    
                                    
                                       r
                                    
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       r
                                    
                                 
                              ) domain is mapped to a point in the 
                                 u
                                 ,
                                 v
                               domain by 
                                 
                                    
                                       Ω
                                    
                                    
                                       L
                                    
                                 
                               or 
                                 
                                    
                                       Ω
                                    
                                    
                                       R
                                    
                                 
                              , evaluating the surface–surface composition on a point-by-point basis.

@&#RESULTS@&#

This section highlight the performance of our algorithm on different examples. All the results reported here were generated on a PC using an Intel Core i7 3.10 GHz CPU +8 GB RAM and a GeForce GTX580 GPU with 3 GB of video memory. We implemented our algorithms in C++ with the help of Visual Studio 2008, the IRIT [28] library, and the nVidia CUDA SDK library.

The first two examples shown in Figs. 1 and 7
                      are two open Bézier surfaces, which are quite well fitted with a ruling approximation as these input surfaces are hyperbolic. The statistics in terms of fitting errors, the average error–
                        
                           
                              D
                           
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                           
                              B
                           
                        
                      (Eq. (10)) and the maximal error–
                        
                           
                              D
                           
                           
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                           
                           
                              B
                           
                        
                      (Eq. (11)), are shown in Fig. 8
                     , where the optimal fitting results by 4D-DP are compared with the results of 2D-DP by using the benchmark with different sampling rates (i.e.,  
                        n
                        =
                        30
                        ,
                        50
                        ,
                        100
                     ). In addition and for further assurance, the maximal errors (
                        
                           
                              E
                           
                           
                              
                                 max
                              
                           
                        
                     ) and the mean errors (
                        
                           
                              E
                           
                           
                              m
                              e
                              a
                              n
                           
                        
                     ) between the surfaces are estimated with the help of the publicly available Metro tool [31]—see Fig. 9
                     . When 4D-DP is conducted (rather than 2D-DP), the maximal error 
                        
                           
                              E
                           
                           
                              
                                 max
                              
                           
                        
                      and the mean error 
                        
                           
                              E
                           
                           
                              m
                              e
                              a
                              n
                           
                        
                      can drop up to 40% and 35% respectively.

The example shown in Fig. 4 is a periodic surface. Another example of a periodic surface is shown in Fig. 10
                     . Our fitting results present maximal errors: 
                        
                           
                              E
                           
                           
                              
                                 max
                              
                           
                        
                        =
                        0.0193
                        
                           
                              L
                           
                           
                              ̄
                           
                        
                      in the example of Fig. 4 and 
                        
                           
                              E
                           
                           
                              
                                 max
                              
                           
                        
                        =
                        0.0109
                        
                           
                              L
                           
                           
                              ̄
                           
                        
                      in the example of Fig. 10, where 
                        
                           
                              L
                           
                           
                              ̄
                           
                        
                      denotes the diagonal length of input surface’s bounding box. Again, the errors are estimated by the third party software—the Metro tool [31]. 
                  


                     Fig. 6 shows the results of applying the subdivision based on optimal fitting using 4D-DP. An example for the comparison of using 4D-DP and 7D-DP in determining the optimal subdivision is given in Fig. 11. Fig. 12
                      gives the error comparison on the fitting results obtained on the 4D-DP/7D-DP based subdivisions vs. the uniform subdivision (i.e., subdivision on iso-parametric curves 
                        v
                        =
                        0.25
                        ,
                        0.5
                        ,
                        0.75
                     —see the top row of Fig. 11). The fitting results are all generated by 4D-DP with dimensions: 
                        
                           
                              50
                           
                           
                              2
                           
                        
                        ×
                        
                           
                              11
                           
                           
                              2
                           
                        
                     . Subdivision based on 4D-DP gives much better results than the uniform subdivisions. The subdivision curve determined by 7D-DP is only slightly better than 4D-DP (in terms of maximal errors); however, 7D-DP has a much higher consumption of both memory and computing power (see Table 3). During the computation of optimal subdivision, the maximal error, 
                        
                           
                              D
                           
                           
                              
                                 
                                    L
                                 
                                 
                                    ∞
                                 
                              
                           
                           
                              L
                           
                        
                        
                           (
                           Γ
                           ,
                           
                              S
                           
                           )
                        
                      (Eq. (7)), is used. As a result, mean errors on the results of 7D-DP subdivision could be slightly larger than 4D-DP subdivision.

The last example (see Fig. 13
                     ) is employed to demonstrate the expected benefits of the projected parameterization. The rulings result obtained by 4D-DP gives inferior approximation when the uniform parameterization is used compared to the projected parameterization.

In our algorithm, the control meshes of sub-surface patches are generated with the help of the IRIT library. For the cases with 
                        n
                        <
                        100
                     , the computation can be finished in 2 s by using only one CPU. Table 2
                     
                      lists the statistics on the example shown in Fig. 1 when using different resolutions in both SSHB 4D-DP and LSAD 4D-DP. The LSAD 4D-DP is more efficient as it can be fully evaluated on GPU with the help of discrete Voronoi diagram. Statistics of computational time on a periodic surface (the example in Fig. 4 by using LSAD) is given in Table 4
                     .

In this work, we presented a method to compute an optimal set of ruling lines to solve the discrete RSF problem. Multi-dimensional dynamic programming is conducted to find the global optimum in a discrete domain. We sampled the boundary curves of a given surface and elevate them along surface normals. The discrete domain has four degrees-of-freeform for solving the RSF problem and is formulated over these samples.

In our current implementation, the discrete domains are formed by the sample points on 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    min
                                 
                              
                           
                           )
                        
                      and 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    max
                                 
                              
                           
                           )
                        
                      and the points evaluated along surface normals on these two curves. One may wish to generate the discrete domain on other iso-parametric curves (e.g.,  
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    min
                                 
                              
                           
                           +
                           Δ
                           )
                        
                      and 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    max
                                 
                              
                           
                           −
                           Δ
                           )
                        
                     ). However, by allowing normal deviation, the 4D-DP sampled space subsumes the space of samples covered by sampling between 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    min
                                 
                              
                           
                           +
                           Δ
                           )
                        
                      and 
                        
                           S
                        
                        
                           (
                           u
                           ,
                           
                              
                                 v
                              
                              
                                 
                                    max
                                 
                              
                           
                           −
                           Δ
                           )
                        
                     .

Our current implementation computes the optimal ruling approximation to periodic surfaces by using the line–surface metric. To employ the better SSHB, we need to overcome the (technical) difficulty of computing the composition across the boundary of 
                        S
                        
                           (
                           u
                           ,
                           v
                           )
                        
                     . A possible solution can first split the 
                        u
                        ,
                        v
                      patch when it crosses the boundary, divide the split regions into rectangles and compute the composition for the divided pieces. In the future, we will work on how to incorporate the manufacturing constraints (e.g., collision between the cutter and the workpiece) into the procedure of optimal fitting.

@&#ACKNOWLEDGMENTS@&#

This work was supported by the Hong Kong RGC/GRF Grants (CUHK/417508 and CUHK/417109) and the Direct Research Grant (CUHK/2050518). The research leading to these results has also received partial funding from the People Programme (Marie Curie Actions) of the European Union’s Seventh Framework Programme FP7/2007–2013/ under REA grant agreement PIAP-GA-2011-286426, and was supported in part by the Technion Vice President for Research Fund—Glasberg-Klein research fund.

Consider the 3-space Bézier surface 
                        
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 u
                                 ,
                                 v
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 
                                    
                                       y
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    u
                                    ,
                                    v
                                    )
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 u
                                 )
                              
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 v
                                 )
                              
                              ,
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                              u
                              ,
                              v
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                              ,
                           
                        
                      where 
                        
                           
                              θ
                           
                           
                              i
                           
                           
                              n
                           
                        
                        
                           (
                           u
                           )
                        
                        =
                        
                           
                              
                                 n
                              
                              
                                 i
                              
                           
                        
                        
                           
                              u
                           
                           
                              i
                           
                        
                        
                           
                              
                                 (
                                 1
                                 −
                                 u
                                 )
                              
                           
                           
                              n
                              −
                              i
                           
                        
                      is the 
                        i
                     ’th Bézier basis function of order 
                        n
                      and consider the planar Bézier surface 
                        
                           
                              
                                 
                                    
                                       s
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 r
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                                 ,
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    =
                                    0
                                 
                                 
                                    a
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    l
                                    =
                                    0
                                 
                                 
                                    b
                                 
                              
                              
                                 (
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       l
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       k
                                       l
                                    
                                    
                                       v
                                    
                                 
                                 )
                              
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                                 
                                    a
                                 
                              
                              
                                 (
                                 r
                                 )
                              
                              
                                 
                                    θ
                                 
                                 
                                    l
                                 
                                 
                                    b
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                              
                              
                                 
                                    q
                                 
                                 
                                    k
                                    l
                                 
                                 
                                    u
                                 
                              
                              ,
                              
                                 
                                    q
                                 
                                 
                                    k
                                    l
                                 
                                 
                                    v
                                 
                              
                              ∈
                              R
                              ,
                              
                              r
                              ,
                              t
                              ∈
                              
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                              .
                           
                        
                      The composition of 
                        
                           
                              
                                 S
                              
                           
                           
                              12
                           
                        
                        
                           (
                           r
                           ,
                           t
                           )
                        
                        =
                        
                           
                              
                                 S
                              
                           
                           
                              1
                           
                        
                        
                           (
                           
                              
                                 
                                    s
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              r
                              ,
                              t
                              )
                           
                           )
                        
                      equals 
                        
                           (21)
                           
                              
                                 
                                    
                                       S
                                    
                                 
                                 
                                    12
                                 
                              
                              
                                 (
                                 r
                                 ,
                                 t
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    θ
                                 
                                 
                                    i
                                 
                                 
                                    n
                                 
                              
                              
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                                 )
                              
                              
                                 
                                    θ
                                 
                                 
                                    j
                                 
                                 
                                    m
                                 
                              
                              
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    r
                                    ,
                                    t
                                    )
                                 
                                 )
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    u
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       r
                                       ,
                                       t
                                       )
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             u
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          r
                                          ,
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       (
                                       r
                                       ,
                                       t
                                       )
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             v
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          r
                                          ,
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    m
                                    −
                                    j
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    0
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    0
                                 
                                 
                                    m
                                 
                              
                              
                                 
                                    
                                       P
                                    
                                 
                                 
                                    i
                                    j
                                 
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             a
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             0
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             k
                                             l
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             a
                                          
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             l
                                          
                                          
                                             b
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             a
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             0
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             k
                                             l
                                          
                                          
                                             u
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             a
                                          
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             l
                                          
                                          
                                             b
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    n
                                    −
                                    i
                                 
                              
                              
                                 
                                    
                                       m
                                    
                                    
                                       j
                                    
                                 
                              
                              
                                 
                                    
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             a
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             0
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             k
                                             l
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             a
                                          
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             l
                                          
                                          
                                             b
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             =
                                             0
                                          
                                          
                                             a
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             l
                                             =
                                             0
                                          
                                          
                                             b
                                          
                                       
                                       
                                          
                                             q
                                          
                                          
                                             k
                                             l
                                          
                                          
                                             v
                                          
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             k
                                          
                                          
                                             a
                                          
                                       
                                       
                                          (
                                          r
                                          )
                                       
                                       
                                          
                                             θ
                                          
                                          
                                             l
                                          
                                          
                                             b
                                          
                                       
                                       
                                          (
                                          t
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    m
                                    −
                                    j
                                 
                              
                              .
                           
                        
                     
                  

Products and summations of polynomial Bézier basis functions are polynomials Bézier basis functions. Eq. (21) consists of merely summations and products of polynomial Bézier basis functions and hence is computable and representable as a Bézier surface (of high degrees).

@&#REFERENCES@&#

