@&#MAIN-TITLE@&#Detection of number of components in CANDECOMP/PARAFAC models via minimum description length

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           The problem of CANDECOMP/PARAFAC (CP) model order selection is addressed.


                        
                        
                           
                           Computational efficiency is achieved via matricization of a tensor.


                        
                        
                           
                           Eigenvalues associated with the block or multi-mode matricization are exploited.


                        
                        
                           
                           Able to detect rank up to the square root of the product of all dimension lengths.


                        
                        
                           
                           Accuracy comparable to CP-decomposition based tensor rank detectors.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Model order selection

Minimum description length (MDL)

Core consistency diagnostic (CORCONDIA)

CANDECOMP/PARAFAC

Tensor decomposition

@&#ABSTRACT@&#


               
               
                  Detecting the number of components of the CANDECOMP/PARAFAC (CP) model, also known as CP model order selection, is an essential task in signal processing and data mining applications. Existing multilinear detection algorithms for handling N-dimensional data, where 
                        N
                        ≥
                        3
                     , e.g., the CORe CONsistency DIAgnostic, rely on the CP decomposition which is computationally very expensive. An alternative solution is to rearrange the tensor as a matrix using the unfolding operation and then utilize the eigenvalues of the resultant matrices for CP model order selection. We propose to employ the eigenvalues associated with the unfolding along merged dimensions, namely, the multi-mode eigenvalues, as well as the n-mode eigenvalues for accurate rank detection. These multiple sets of eigenvalues are combined via the information theoretic criterion. By designing a sequential detection scheme starting from the most squared unfolded matrix, the identifiable rank is increased to the square root of the product of all dimension lengths, which renders the detection algorithm to estimate the rank that can exceed any individual dimension length. The conditions under which the proposed multilinear detection algorithm correctly detects the tensor rank are theoretically investigated and its computational efficiency and detection performance are verified.
               
            

@&#INTRODUCTION@&#

The CANDECOMP/PARAFAC (CP) (short for CANonical DECOMPosition and PARAllel FACtor analysis, also known as canonical polyadic decomposition) model [1–3] has a variety of applications in psychometrics [1], chemometrics [4,5], sensor array processing [6], telecommunications [7], blind source separation [8,9], neuroscience [3,10–13], data mining [14–16], as well as image recognition and classification [17–19]. In the CP model, a tensor is decomposed into a sum of rank-one component tensors, which are expressed as the outer product of vectors. In practice, each rank-one component corresponds to a natural source or signal. Finding the tensor rank or number of multilinear components in the underlying CP model of noisy tensor observations, also known as multilinear rank detection, is an important research topic.

Existing approaches to multilinear rank detection include the DIFFerence in FIT (DIFFIT) [20], Numerical Convex Hull (NumConvHull) [21], CORe CONsistency DIAgnostic (CORCONDIA) [22], Automatic Relevance Determination (ARD) [23], and reconstruction-error-based CP rank selector [25]. These methods rely on the CP decomposition [24] for estimating the factor/loading matrices and diagonal core tensor. The DIFFIT and NumConvHull procedures examine the fitting error (or residual) of each candidate model and select the number of components that corresponds to the maximal curvature of the residual versus number of components curve. On the other hand, the CORCONDIA exploits the deviation of the estimated core tensor from the ideal super-identity core (i.e., core consistency) for each candidate model and determines the correct number of components by looking at the gap between the core consistency of neighboring models. Within a Bayesian framework, the ARD assumes a prior distribution (Gaussian or Laplace) on the entries of the loading matrices, and infers the number of components by solving an 
                        
                           
                              ℓ
                           
                           
                              2
                           
                        
                     - or 
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                     -regularized CP decomposition problem. In [25], the probabilistic upper bound of the reconstruction error of the CP model is derived and used for order selection. These techniques may be able to identify the typical tensor rank [26,27] that exceeds the size of individual dimension of the tensor. However, the CP decomposition algorithms usually rely on an iterative procedure, which may require a large number of iterations to converge and thus is computationally expensive.

In matrix case, it is common to use the eigenspectrum for detecting the number of signals. Numerous bilinear or two-dimensional (2-D) rank detectors have been developed in the literature, including the classical information theoretic criterion based methods [28], such as minimum description length (MDL) [29] and Akaike information criterion (AIC) [30], as well as the random matrix theory (RMT) algorithms [31–35]. Note that AIC and MDL are suitable when the number of samples is much larger than the dimension length, while the RMT algorithms are designed for relatively small sample scenarios.

However, these methods do not have direct multilinear counterparts that correspond to the multilinear rank detection problem at hand. To handle that, in [36–38], the N-D MDL where 
                        N
                        ≥
                        3
                     , is proposed by stacking the measurement tensor into a matrix with the n-mode unfolding operation, and the eigenvalue spectrum obtained from the singular value decomposition (SVD) of the resultant matrix is used for N-D detection. In this paper, we contribute to the matrix-unfolding-based N-D rank detection methods by proposing an improved version of N-D MDL. Our contributions lie in twofold. First, using the generalized unfolding of the observation tensor, 
                        (
                        
                           
                              2
                           
                           
                              N
                              −
                              1
                           
                        
                        −
                        1
                        )
                      sets of eigenvalues are obtained and combined for accurate signal number detection. Moreover, by designing a sequential detection scheme, the number of identifiable signals is up to the size of the most squared unfolded matrix and is much larger than that in [36–38]. When the actual tensor rank is smaller than the size of the most squared unfolded matrix, which is the case in most scenarios of practical interests, the proposed N-D MDL is proved to be a consistent signal detector. Here by “consistency” it means that the proposed N-D MDL is able to correctly detect the number of signals when the length of any one of the dimensions tends to infinity. To distinguish the proposed N-D MDL from that developed in [36–38], we refer the former to as generalized N-D MDL.

The remainder of the paper is organized as follows. In Section 2, we formulate the multilinear rank detection problem using the CP data model. In Section 3, we provide a brief review of state-of-the-art tensor-based multilinear rank detectors. By exploiting the properties of MDL and generalized matrix unfolding of the measurement tensor, the generalized N-D MDL is developed in Section 4. In Section 5, experiments on synthetic datasets are conducted to evaluate the performance of the proposed multilinear MDL rank detector. Finally, conclusions are drawn in Section 6.


                     Notations: Scalars are denoted as italic letters, column vectors as bold-face lower-case letters, matrices as bold-face capitals, and tensors as bold-face calligraphic letters. The superscripts T, H and † represent transpose, conjugate transpose of a matrix or vector and matrix pseudo-inverse, respectively. The symbol 
                        C
                      denotes the complex number field which includes the real number field 
                        R
                      as a special case. The 
                        f
                        (
                        n
                        )
                        =
                        O
                        
                           (
                           g
                           (
                           n
                           )
                           )
                        
                      means 
                        f
                        (
                        n
                        )
                        /
                        g
                        (
                        n
                        )
                        →
                        c
                      as 
                        n
                        →
                        +
                        ∞
                     , where c is a non-zero constant and 
                        f
                        (
                        n
                        )
                        =
                        o
                        
                           (
                           g
                           (
                           n
                           )
                           )
                        
                      stands for 
                        f
                        (
                        n
                        )
                        /
                        g
                        (
                        n
                        )
                        →
                        0
                      as 
                        n
                        →
                        +
                        ∞
                     .

An Nth-order tensor 
                        X
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                           
                        
                      is a multidimensional matrix whose elements are referenced by N indices: 
                        
                           
                              x
                           
                           
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    i
                                 
                                 
                                    N
                                 
                              
                           
                        
                        ∈
                        C
                     , 
                        
                           
                              i
                           
                           
                              n
                           
                        
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        
                           
                              I
                           
                           
                              n
                           
                        
                     , 
                        n
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        N
                     . Note that N is the order or dimension of the tensor, and 
                        
                           
                              I
                           
                           
                              n
                           
                        
                      is the size or length of the nth dimension (or mode), 
                        n
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        N
                     . The 
                        
                           
                              I
                           
                           
                              N
                              ,
                              R
                           
                        
                      denotes a super-identity tensor of size 
                        R
                        ×
                        R
                        ×
                        ⋯
                        ×
                        R
                     , whose elements are equal to one when the indices 
                        
                           
                              i
                           
                           
                              1
                           
                        
                        =
                        
                           
                              i
                           
                           
                              2
                           
                        
                        =
                        ⋯
                        =
                        
                           
                              i
                           
                           
                              N
                           
                        
                      and zero elsewhere. The n-mode vectors of a tensor 
                        X
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                           
                        
                      are obtained by varying the nth index within its range (
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        
                           
                              I
                           
                           
                              n
                           
                        
                     ) and keeping all the other indices fixed. The n-mode unfolding of a tensor 
                        X
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                           
                        
                     , denoted as 
                        
                           
                              [
                              X
                              ]
                           
                           
                              (
                              n
                              )
                           
                        
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                              ×
                              (
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              …
                              
                                 
                                    I
                                 
                                 
                                    n
                                    −
                                    1
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              …
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                              )
                           
                        
                     , is a matrix collecting all n-mode vectors of 
                        X
                     . The columns in the unfolded matrix are arranged in reverse lexicographical order of their indices 
                        (
                        
                           
                              i
                           
                           
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              i
                           
                           
                              n
                              −
                              1
                           
                        
                        ,
                        
                           
                              i
                           
                           
                              n
                              +
                              1
                           
                        
                        ,
                        …
                        ,
                        
                           
                              i
                           
                           
                              N
                           
                        
                        )
                      
                     [39]. The n-mode product of a tensor 
                        X
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                           
                        
                      and a matrix 
                        U
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              ×
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                        
                      along the nth mode, denoted as 
                        X
                        
                           
                              ×
                           
                           
                              n
                           
                        
                        U
                     , is a tensor of size 
                        
                           
                              I
                           
                           
                              1
                           
                        
                        ×
                        ⋯
                        ×
                        
                           
                              J
                           
                           
                              n
                           
                        
                        ×
                        ⋯
                        ×
                        
                           
                              I
                           
                           
                              N
                           
                        
                      obtained by multiplying the n-mode unfolding of 
                        X
                      from the left-hand side by 
                        U
                     . The operators ∘ and ⊗ stand for the outer product and Kronecker product, respectively. The 
                        
                           vec
                        
                        (
                        ⋅
                        )
                      represents vectorization of a matrix or tensor by stacking its columns or 1-mode vectors on top of each other. The 
                        
                           
                              ‖
                              ⋅
                              ‖
                           
                           
                              1
                           
                        
                      and 
                        ‖
                        ⋅
                        ‖
                      denote respectively the 
                        
                           
                              ℓ
                           
                           
                              1
                           
                        
                      norm and 
                        
                           
                              ℓ
                           
                           
                              2
                           
                        
                      norm of a vector, and 
                        
                           
                              ‖
                              ⋅
                              ‖
                           
                           
                              F
                           
                        
                      represents the Frobenius norm of a matrix or tensor, which is defined as the square root of the sum of the squared magnitudes of its elements.


                     
                        Definition 2.1
                        An Nth-order tensor 
                              X
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    ×
                                    ⋯
                                    ×
                                    
                                       
                                          I
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                            has rank one if it equals the outer product of N vectors 
                              
                                 
                                    a
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              ,
                              
                                 
                                    a
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    (
                                    N
                                    )
                                 
                              
                           , with 
                              
                                 
                                    a
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          n
                                       
                                    
                                    ×
                                    1
                                 
                              
                            for 
                              n
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                           , namely,
                              
                                 (1)
                                 
                                    X
                                    =
                                    
                                       
                                          a
                                       
                                       
                                          (
                                          1
                                          )
                                       
                                    
                                    ∘
                                    
                                       
                                          a
                                       
                                       
                                          (
                                          2
                                          )
                                       
                                    
                                    ∘
                                    ⋯
                                    ∘
                                    
                                       
                                          a
                                       
                                       
                                          (
                                          N
                                          )
                                       
                                    
                                    .
                                 
                              
                           
                        

In the CP model, the noise-free signal 
                        X
                        ∈
                        
                           
                              C
                           
                           
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ×
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              ×
                              ⋯
                              ×
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                           
                        
                      is modeled as a sum of R rank-one tensors:
                        
                           (2)
                           
                              X
                              =
                              
                                 ∑
                                 
                                    r
                                    =
                                    1
                                 
                                 R
                              
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              ∘
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ∘
                              ⋯
                              ∘
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    N
                                    )
                                 
                              
                              ,
                           
                        
                      where the entries of 
                        X
                      are given by
                        
                           (3)
                           
                              
                                 
                                    x
                                 
                                 
                                    
                                       
                                          i
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          i
                                       
                                       
                                          N
                                       
                                    
                                 
                              
                              =
                              
                                 ∑
                                 
                                    r
                                    =
                                    1
                                 
                                 R
                              
                              
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              (
                              
                                 
                                    i
                                 
                                 
                                    1
                                 
                              
                              )
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              (
                              
                                 
                                    i
                                 
                                 
                                    2
                                 
                              
                              )
                              ⋯
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    N
                                    )
                                 
                              
                              (
                              
                                 
                                    i
                                 
                                 
                                    N
                                 
                              
                              )
                              ,
                           
                        
                      with 
                        
                           
                              a
                           
                           
                              r
                           
                           
                              (
                              n
                              )
                           
                        
                        =
                        
                           
                              [
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              (
                              1
                              )
                              ,
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              (
                              2
                              )
                              ,
                              …
                              ,
                              
                                 
                                    a
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              (
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                              )
                              ]
                           
                           
                              T
                           
                        
                     , 
                        r
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        R
                     , 
                        n
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        N
                     .

The rank of a tensor 
                        X
                      is defined as the minimal number of rank-one tensors required to represent it [40–43]. In practice, each rank-one component typically corresponds to a natural source or signal.

Defining the loading/factor matrix in the nth mode as
                        
                           (4)
                           
                              
                                 
                                    A
                                 
                                 
                                    (
                                    n
                                    )
                                 
                              
                              =
                              
                                 [
                                 
                                    
                                       
                                          
                                             
                                                a
                                             
                                             
                                                1
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                2
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                       
                                       
                                          …
                                          
                                       
                                       
                                          
                                             
                                                a
                                             
                                             
                                                R
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                    
                                 
                                 ]
                              
                              ∈
                              
                                 
                                    C
                                 
                                 
                                    
                                       
                                          I
                                       
                                       
                                          n
                                       
                                    
                                    ×
                                    R
                                 
                              
                              ,
                           
                        
                      
                     (2) can be rewritten in terms of n-mode products as
                        
                           (5)
                           
                              X
                              =
                              
                                 
                                    I
                                 
                                 
                                    N
                                    ,
                                    R
                                 
                              
                              
                                 
                                    ×
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              
                                 
                                    ×
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ⋯
                              
                                 
                                    ×
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    A
                                 
                                 
                                    (
                                    N
                                    )
                                 
                              
                              .
                           
                        
                     
                  

In practice, the data are contaminated by noise:
                        
                           (6)
                           
                              Y
                              =
                              X
                              +
                              Z
                              ,
                           
                        
                      where 
                        Z
                      is the noise tensor collecting independent and identically distributed (i.i.d.) zero-mean real or circularly-symmetric complex Gaussian samples with variance 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                     . The noise is assumed uncorrelated with the signals. Given the noisy measurement tensor 
                        Y
                     , our goal is to estimate the model order, i.e., the number of multilinear signals R.

We review four state-of-the-art tensor-based methods for CP model selection: CORCONDIA, DIFFIT, NumConvHull, and ARD. Except for CORCONDIA, all of these rank detectors are generally applicable to the Tucker model [43–47], which can be considered as generalization of the CP model. For CP model selection, they rely on the PARAFAC to work.

Given r as a candidate value for the number of components, the r-component CP decomposition of 
                        Y
                      gives
                        
                           (7)
                           
                              Y
                              ≃
                              
                                 
                                    I
                                 
                                 
                                    N
                                    ,
                                    r
                                 
                              
                              
                                 
                                    ×
                                 
                                 
                                    1
                                 
                              
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    1
                                    )
                                 
                              
                              
                                 
                                    ×
                                 
                                 
                                    2
                                 
                              
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                 
                                 
                                    (
                                    2
                                    )
                                 
                              
                              ⋯
                              
                                 
                                    ×
                                 
                                 
                                    N
                                 
                              
                              
                                 
                                    
                                       
                                          A
                                       
                                       
                                          ˆ
                                       
                                    
                                 
                                 
                                    r
                                 
                                 
                                    N
                                 
                              
                              ,
                           
                        
                      where 
                        
                           
                              
                                 
                                    A
                                 
                                 
                                    ˆ
                                 
                              
                           
                           
                              r
                           
                           
                              (
                              n
                              )
                           
                        
                      is the estimate of 
                        
                           
                              A
                           
                           
                              (
                              n
                              )
                           
                        
                     , 
                        n
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        N
                     . The CP decomposition can be accomplished by standard algorithms in the literature, e.g., the alternating least squares (ALS) algorithm [1,2]. An excellent review of the CP decomposition algorithms and their empirical performance comparison can be found in [24]. More recently, a semi-algebraic framework for approximating CP decomposition has been proposed in [48,49]. In this work, we use the ALS algorithm for CP decomposition because it presents a good trade-off between computational complexity and solution accuracy among all existing algorithms for CP decomposition [24].

For the CORCONDIA, the core consistency (CC), which means the closeness to an ideal core, is used to estimate the number of components [22].

From (7) the CP core is estimated as
                           
                              (8)
                              
                                 
                                    
                                       
                                          G
                                       
                                       
                                          N
                                          ,
                                          r
                                       
                                    
                                    =
                                    Y
                                    
                                       
                                          ×
                                       
                                       
                                          1
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                       
                                       
                                          †
                                       
                                    
                                    
                                       
                                          ×
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                       
                                       
                                          †
                                       
                                    
                                    ⋯
                                    
                                       
                                          ×
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                r
                                             
                                             
                                                N
                                             
                                          
                                       
                                       
                                          †
                                       
                                    
                                    .
                                 
                              
                           
                         The CC in % is defined as [22]
                        
                           
                              (9)
                              
                                 
                                    
                                       CC
                                    
                                    (
                                    r
                                    )
                                    =
                                    100
                                    
                                       (
                                       1
                                       −
                                       
                                          
                                             
                                                ‖
                                                
                                                   
                                                      G
                                                   
                                                   
                                                      N
                                                      ,
                                                      r
                                                   
                                                
                                                −
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      N
                                                      ,
                                                      r
                                                   
                                                
                                                ‖
                                             
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          r
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         and it is a measure of the similarity between the estimated core and ideal core. In the absence of noise, if the PARAFAC model is perfectly fitted with 
                           r
                           =
                           R
                         and if all factor matrices 
                           
                              
                                 {
                                 
                                    
                                       A
                                    
                                    
                                       (
                                       n
                                       )
                                    
                                 
                                 }
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                         are of full column rank,
                           1
                        
                        
                           1
                           The condition that 
                                 
                                    
                                       {
                                       
                                          
                                             A
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       }
                                    
                                    
                                       n
                                       =
                                       1
                                    
                                    
                                       N
                                    
                                 
                               are of full column rank is necessary since otherwise the identity core 
                                 
                                    
                                       I
                                    
                                    
                                       N
                                       ,
                                       r
                                    
                                 
                               may not be the unique solution to (7).
                         
                        
                           
                              
                                 G
                              
                              
                                 N
                                 ,
                                 r
                              
                           
                         is equal to 
                           
                              
                                 I
                              
                              
                                 N
                                 ,
                                 r
                              
                           
                        , or 
                           
                              CC
                           
                           (
                           R
                           )
                           =
                           100
                           %
                        .

Note that for a one-component CP model the CC is always 100%, because there are no off-superdiagonal elements in a 
                           1
                           ×
                           1
                           ×
                           ⋯
                           ×
                           1
                         core array. In fact, empirical results show that the CC of fitting any 
                           r
                           <
                           R
                        -component CP model is approximately equal to 100%. However, when 
                           r
                           >
                           R
                        , the CC typically decreases dramatically with the number of components. It follows that the valid model with the highest number of components is the one to choose:
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       CORCONDIA
                                    
                                 
                                 =
                                 max
                                 ⁡
                                 
                                 r
                                 
                                 s.t.
                                 
                                 
                                 
                                    CC
                                 
                                 (
                                 r
                                 )
                                 ≥
                                 η
                                 ,
                              
                           
                         where 
                           0
                           <
                           η
                           <
                           100
                           %
                         is the threshold coefficient. Typically, 
                           50
                           %
                           ≤
                           η
                           ≤
                           90
                           %
                         is used [22].

For the DIFFIT and NumConvHull, the number of components is estimated based on the fitting/reconstruction error [20,21]. The fitting/reconstruction error, for a candidate number of components r, is expressed as:
                           
                              (11)
                              
                                 e
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       ‖
                                       Y
                                       −
                                       
                                          
                                             I
                                          
                                          
                                             N
                                             ,
                                             r
                                          
                                       
                                       
                                          
                                             ×
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       
                                          
                                             ×
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ⋯
                                       
                                          
                                             ×
                                          
                                          
                                             N
                                          
                                       
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             N
                                             )
                                          
                                       
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 .
                              
                           
                        
                     

Both the DIFFIT and NumConvHull go through a model screening procedure prior to model selection. In the NumConvHull some models are filtered out such that the set of retained models 
                           (
                           r
                           ,
                           e
                           (
                           r
                           )
                           )
                         forms a convex hull, while the DIFFIT excludes some models so that for the remaining models 
                           [
                           e
                           (
                           r
                           −
                           1
                           )
                           −
                           e
                           (
                           r
                           )
                           ]
                         monotonically decreases as r increases. After model screening, both the DIFFIT and NumConvHull find the optimal r by maximizing the ratio of the difference in fitting error between consecutive models:
                           
                              (12)
                              
                                 
                                    DIFFIT
                                 
                                 (
                                 r
                                 )
                                 =
                                 
                                    
                                       e
                                       (
                                       r
                                       −
                                       1
                                       )
                                       −
                                       e
                                       (
                                       r
                                       )
                                    
                                    
                                       e
                                       (
                                       r
                                       )
                                       −
                                       e
                                       (
                                       r
                                       +
                                       1
                                       )
                                    
                                 
                                 ,
                              
                           
                         which is the curvature of the 
                           {
                           r
                           ,
                           e
                           (
                           r
                           )
                           }
                         graph.

The ARD [23] is a Bayesian approach that is originally derived for the Tucker model [43–47] selection problem. Note that the ARD also applies for the CP model. In this case, the CP ARD is a simplified version of the Tucker ARD since the core tensor is not updated [23].

In CP ARD, the entries of the loading matrices of the CP model are assigned a Gaussian prior
                           2
                        
                        
                           2
                           In [23], the Laplace prior is also considered. Here we only introduce the ARD with Gaussian prior.
                        :
                           
                              (13)
                              
                                 Pr
                                 ⁡
                                 
                                    (
                                    
                                       
                                          A
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    ∏
                                    r
                                 
                                 
                                    
                                       (
                                       
                                          
                                             
                                                α
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             2
                                             π
                                          
                                       
                                       )
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             n
                                          
                                       
                                       /
                                       2
                                    
                                 
                                 exp
                                 ⁡
                                 
                                    {
                                    −
                                    
                                       
                                          
                                             α
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             n
                                             )
                                          
                                       
                                       2
                                    
                                    
                                       
                                          ‖
                                          
                                             
                                                a
                                             
                                             
                                                r
                                             
                                          
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    }
                                 
                                 .
                              
                           
                        
                     

Assuming independence of the entries of the factor matrices across different modes, the negative log posterior after removing irrelevant constant terms is
                           
                              (14)
                              
                                 
                                    
                                       
                                          −
                                          log
                                          ⁡
                                          P
                                       
                                       
                                          =
                                          
                                             1
                                             
                                                2
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ‖
                                                Y
                                                −
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      ×
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      (
                                                      1
                                                      )
                                                   
                                                
                                                
                                                   
                                                      ×
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      (
                                                      2
                                                      )
                                                   
                                                
                                                ⋯
                                                
                                                   
                                                      ×
                                                   
                                                   
                                                      N
                                                   
                                                
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      (
                                                      N
                                                      )
                                                   
                                                
                                                ‖
                                             
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             ∑
                                             r
                                          
                                          
                                             
                                                α
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                          
                                             
                                                ‖
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      r
                                                   
                                                
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             ∑
                                             
                                                n
                                                =
                                                1
                                             
                                             N
                                          
                                          
                                             ∑
                                             r
                                          
                                          
                                             
                                                I
                                             
                                             
                                                n
                                             
                                          
                                          log
                                          ⁡
                                          
                                             
                                                α
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                n
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          …
                                          
                                             
                                                I
                                             
                                             
                                                N
                                             
                                          
                                          log
                                          ⁡
                                          
                                             
                                                σ
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 I
                              
                              
                                 N
                              
                           
                         denotes an Nth-order super-identity tensor with sizes matching the numbers of components/columns in 
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                        , 
                           n
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                        .

The objective is to find both the number of components R as well as the model parameters 
                           {
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           }
                        , 
                           {
                           
                              
                                 α
                              
                              
                                 r
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           }
                         and 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                         by minimizing (14), which is essentially an 
                           
                              
                                 ℓ
                              
                              
                                 2
                              
                           
                        -regularized CP decomposition problem.

Given 
                           
                              
                                 α
                              
                              
                                 r
                              
                              
                                 (
                                 n
                                 )
                              
                           
                        , 
                           r
                           =
                           1
                           ,
                           2
                           ,
                           …
                        , 
                           n
                           =
                           1
                           ,
                           2
                           …
                           ,
                           N
                        , and 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                        , like CP-ALS the regularized CP decomposition can be performed iteratively in N alternate steps, namely, estimation of 
                           
                              
                                 A
                              
                              
                                 (
                                 1
                                 )
                              
                           
                         with 
                           {
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           |
                           n
                           =
                           2
                           ,
                           3
                           ,
                           …
                           ,
                           N
                           }
                         fixed, estimation of 
                           
                              
                                 A
                              
                              
                                 (
                                 2
                                 )
                              
                           
                         with 
                           {
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           
                              |
                              n
                              =
                              1
                              ,
                              3
                              ,
                              …
                              ,
                              N
                           
                           }
                         fixed, until estimation of 
                           
                              
                                 A
                              
                              
                                 (
                                 N
                                 )
                              
                           
                         with 
                           {
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           
                              |
                              n
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              N
                              −
                              1
                           
                           }
                        . In the nth step solving 
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                         can be cast as a ridge regression problem [50] of the form:
                           
                              (15)
                              
                                 
                                    
                                       min
                                    
                                    A
                                 
                                 
                                 
                                    1
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                                 
                                    
                                       ‖
                                       Y
                                       −
                                       A
                                       S
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 
                                    ∑
                                    r
                                 
                                 
                                    
                                       α
                                    
                                    
                                       r
                                    
                                 
                                 
                                    
                                       ‖
                                       
                                          
                                             a
                                          
                                          
                                             r
                                          
                                       
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                         which admits a closed-form solution:
                           
                              (16)
                              
                                 
                                    
                                       A
                                    
                                    
                                       ˆ
                                    
                                 
                                 =
                                 Y
                                 
                                    
                                       S
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       (
                                       S
                                       
                                          
                                             S
                                          
                                          
                                             T
                                          
                                       
                                       +
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                       
                                          diag
                                       
                                       
                                       
                                          {
                                          α
                                          }
                                       
                                       )
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                         where 
                           α
                         is a vector containing 
                           {
                           
                              
                                 α
                              
                              
                                 r
                              
                           
                           }
                         as its elements.

Once 
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                         for 
                           n
                           =
                           1
                           ,
                           2
                           …
                           ,
                           N
                         are estimated, the parameters 
                           {
                           
                              
                                 α
                              
                              
                                 r
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           }
                         and 
                           
                              
                                 σ
                              
                              
                                 2
                              
                           
                         can be obtained via maximum a posteriori criterion as
                           
                              (17)
                              
                                 
                                    
                                       
                                          
                                             
                                                α
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          r
                                       
                                       
                                          (
                                          n
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          
                                             I
                                          
                                          
                                             n
                                          
                                       
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         ˆ
                                                      
                                                   
                                                
                                                
                                                   r
                                                
                                             
                                             ‖
                                          
                                          
                                             2
                                          
                                       
                                    
                                    ,
                                    
                                    r
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    n
                                    =
                                    1
                                    ,
                                    2
                                    …
                                    ,
                                    N
                                    ,
                                 
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                    
                                       
                                          
                                             
                                                σ
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       1
                                       
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          …
                                          
                                             
                                                I
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                          Y
                                          −
                                          
                                             
                                                I
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                ×
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                          
                                             
                                                ×
                                             
                                             
                                                2
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                (
                                                2
                                                )
                                             
                                          
                                          ⋯
                                          
                                             
                                                ×
                                             
                                             
                                                N
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                (
                                                N
                                                )
                                             
                                          
                                          ‖
                                       
                                       
                                          F
                                       
                                       
                                          2
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

The ARD algorithm starts by guessing an upper bound of the number of components 
                           
                              
                                 R
                              
                              
                                 max
                              
                           
                         and randomly initializing the fat/wide factor matrices 
                           
                              
                                 A
                              
                              
                                 (
                                 n
                                 )
                              
                           
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    
                                       I
                                    
                                    
                                       n
                                    
                                 
                                 ×
                                 
                                    
                                       R
                                    
                                    
                                       max
                                    
                                 
                              
                           
                        , 
                           n
                           =
                           1
                           ,
                           2
                           …
                           ,
                           N
                        . To reduce the computational complexity, the ARD algorithm does not wait until convergence to remove all excess components at once but gradually prunes them as the iteration proceeds. In this way, the column width of the factor matrices shrinks with the iteration, resulting in a lower time complexity of the algorithm. The implementation of the ARD algorithm for CP model selection is described in Algorithm 1
                        . Note that after convergence the output of the ARD algorithm may not satisfy 
                           
                              
                                 R
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 2
                              
                           
                           =
                           ⋯
                           =
                           
                              
                                 R
                              
                              
                                 N
                              
                           
                        , in which case additional components need to be pruned in some modes so that the numbers of components in all modes are equal to 
                           min
                           ⁡
                           
                              (
                              
                                 
                                    R
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    R
                                 
                                 
                                    2
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    R
                                 
                                 
                                    N
                                 
                              
                              )
                           
                        .

The unfolding, also known as matricization, of a tensor is the operation for transforming a tensor into a matrix. For an Nth-order tensor 
                           Y
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 
                                    
                                       I
                                    
                                    
                                       2
                                    
                                 
                                 ×
                                 ⋯
                                 ×
                                 
                                    
                                       I
                                    
                                    
                                       N
                                    
                                 
                              
                           
                        , its n-mode unfolding is a matrix collecting all n-mode vectors of 
                           Y
                        . Fig. 1
                         illustrates the 1-, 2- and 3-mode matrix unfoldings of a 3rd-order tensor 
                           Y
                           ∈
                           
                              
                                 C
                              
                              
                                 2
                                 ×
                                 2
                                 ×
                                 2
                              
                           
                        .

In the n-mode unfolding of a tensor, the columns of the unfolded matrix correspond to only one mode. Next, we introduce the n-mode unfolding where the columns are generated from multiple modes of the tensor [51–54].


                        
                           Definition 4.1
                           Given an Nth-order tensor 
                                 Y
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       
                                          
                                             I
                                          
                                          
                                             1
                                          
                                       
                                       ×
                                       
                                          
                                             I
                                          
                                          
                                             2
                                          
                                       
                                       ×
                                       ⋯
                                       ×
                                       
                                          
                                             I
                                          
                                          
                                             N
                                          
                                       
                                    
                                 
                              , for 
                                 1
                                 ≤
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 ≤
                                 N
                               
                              
                                 (
                                 1
                                 ≤
                                 m
                                 ≤
                                 N
                                 −
                                 1
                                 )
                              , its 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 )
                              -mode vectors are obtained by varying the 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 )
                               indices and keeping the remaining indices fixed. The 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 )
                              -mode unfolding of 
                                 Y
                              , denoted as 
                                 
                                    
                                       [
                                       Y
                                       ]
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                 
                              , is a matrix collecting all 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 )
                              -mode vectors. Both the entries in each column and the columns in the unfolded matrix are arranged in reverse lexicographical order of their indices [39].


                        
                           Example 4.1
                           Given a 4th-order tensor 
                                 Y
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       2
                                       ×
                                       2
                                       ×
                                       2
                                       ×
                                       2
                                    
                                 
                              , its 
                                 (
                                 1
                                 ,
                                 2
                                 )
                              -mode, 
                                 (
                                 1
                                 ,
                                 3
                                 )
                              -mode and 
                                 (
                                 2
                                 ,
                                 3
                                 )
                              -mode unfoldings are shown in Fig. 2
                              .

Define a set of indices 
                           S
                           =
                           {
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           N
                           }
                        . Note that each division of 
                           S
                         into two non-empty disjoint subsets 
                           {
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                           }
                         and 
                           S
                           ∖
                           {
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                           }
                         corresponds to a pair of mutually-transposed unfolded matrices of 
                           Y
                           ∈
                           
                              
                                 C
                              
                              
                                 
                                    
                                       I
                                    
                                    
                                       1
                                    
                                 
                                 ×
                                 ⋯
                                 ×
                                 
                                    
                                       I
                                    
                                    
                                       N
                                    
                                 
                              
                           
                        : one is the 
                           (
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                           )
                        -mode unfolding of size 
                           (
                           
                              
                                 I
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           …
                           
                              
                                 I
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                              
                           
                           )
                           ×
                           
                              
                                 I
                              
                              
                                 T
                              
                           
                           /
                           
                              (
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              …
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              )
                           
                        , and the other is the 
                           S
                           ∖
                           {
                           
                              
                                 n
                              
                              
                                 1
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 n
                              
                              
                                 m
                              
                           
                           }
                        -mode unfolding of size 
                           
                              
                                 I
                              
                              
                                 T
                              
                           
                           /
                           
                              (
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              …
                              
                                 
                                    I
                                 
                                 
                                    
                                       
                                          n
                                       
                                       
                                          m
                                       
                                    
                                 
                              
                              )
                           
                           ×
                           (
                           
                              
                                 I
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                              
                           
                           …
                           
                              
                                 I
                              
                              
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                              
                           
                           )
                        , where 
                           
                              
                                 I
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 ∏
                              
                              
                                 n
                                 =
                                 1
                              
                              
                                 N
                              
                           
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                        .

The total number of such divisions of 
                           S
                        , which is the same as the number of pairs of mutually-transposed unfoldings of 
                           Y
                        , is
                           
                              (20)
                              
                                 
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       
                                          (
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   2
                                                
                                             
                                          
                                          )
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          (
                                          
                                             
                                                
                                                   N
                                                
                                             
                                             
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                    
                                    2
                                 
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                                 ,
                              
                           
                         where 
                           
                              (
                              
                                 
                                    
                                       N
                                    
                                 
                                 
                                    
                                       n
                                    
                                 
                              
                              )
                           
                           =
                           
                              
                                 N
                                 !
                              
                              
                                 (
                                 N
                                 −
                                 n
                                 )
                                 !
                                 
                                 n
                                 !
                              
                           
                         is the total number of n-combinations of N numbers.

Since each pair of mutually-transposed unfolded matrices has a common set of non-zero eigenvalues, we only choose the oblate matrix whose number of rows is less than or equal to number of columns. The resultant 
                           (
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                           )
                         unfolded matrices are sorted in descending order of their number of rows as
                           
                              (21)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       (
                                       2
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       Y
                                    
                                    
                                       (
                                       
                                          
                                             2
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                 
                                 .
                              
                           
                         Let 
                           
                              
                                 P
                              
                              
                                 k
                              
                           
                         and 
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                         be the numbers of rows and columns of 
                           
                              
                                 Y
                              
                              
                                 (
                                 k
                                 )
                              
                           
                        , respectively, we have
                           
                              (22)
                              
                                 
                                    
                                       P
                                    
                                    
                                       1
                                    
                                 
                                 ≥
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ≥
                                 ⋯
                                 ≥
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 ,
                              
                           
                         and for 
                           k
                           =
                           1
                           ,
                           …
                           ,
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                        ,
                           
                              (23)
                              
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 ≤
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       
                                          I
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                 
                                 .
                              
                           
                        
                     


                        
                           Example 4.2
                           
                              
                                 N
                                 =
                                 4
                              , 
                                 Y
                                 ∈
                                 
                                    
                                       C
                                    
                                    
                                       4
                                       ×
                                       3
                                       ×
                                       5
                                       ×
                                       8
                                    
                                 
                              , there are totally 
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                                 =
                                 7
                               unfolded matrices, namely,
                                 
                                    
                                       
                                       
                                       
                                          
                                             
                                                
                                                   Y
                                                
                                                (1):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         ,
                                                         3
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         2
                                                         ,
                                                         4
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         20
                                                         ×
                                                         24
                                                      
                                                   
                                                , P
                                                1
                                                =20, Q
                                                1
                                                =24
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                (2):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         2
                                                         ,
                                                         3
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         ,
                                                         4
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         15
                                                         ×
                                                         32
                                                      
                                                   
                                                , P
                                                2
                                                =15, Q
                                                2
                                                =32
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                (3):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         ,
                                                         2
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         3
                                                         ,
                                                         4
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         12
                                                         ×
                                                         40
                                                      
                                                   
                                                , P
                                                3
                                                =12, Q
                                                3
                                                =40
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                (4):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         4
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         3
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         8
                                                         ×
                                                         60
                                                      
                                                   
                                                , P
                                                4
                                                =8, Q
                                                4
                                                =60
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                (5):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         3
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         ,
                                                         2
                                                         ,
                                                         4
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         5
                                                         ×
                                                         96
                                                      
                                                   
                                                , P
                                                5
                                                =5, Q
                                                5
                                                =96
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                (6):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         2
                                                         ,
                                                         3
                                                         ,
                                                         4
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         4
                                                         ×
                                                         120
                                                      
                                                   
                                                , P
                                                6
                                                =4, Q
                                                6
                                                =120
                                          
                                          
                                             
                                                
                                                   Y
                                                
                                                (7):
                                             
                                                
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         2
                                                         )
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         [
                                                         Y
                                                         ]
                                                      
                                                      
                                                         (
                                                         1
                                                         ,
                                                         3
                                                         ,
                                                         4
                                                         )
                                                      
                                                      
                                                         T
                                                      
                                                   
                                                 
                                                
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         3
                                                         ×
                                                         160
                                                      
                                                   
                                                , P
                                                7
                                                =3, Q
                                                7
                                                =160
                                          
                                       
                                    
                                 
                              
                           

Denote the sets of eigenvalues of the sample covariance matrices 
                           
                              
                                 Y
                              
                              
                                 (
                                 k
                                 )
                              
                           
                           
                              
                                 
                                    
                                       Y
                                    
                                    
                                       (
                                       k
                                       )
                                    
                                 
                              
                              
                                 H
                              
                           
                           /
                           
                              
                                 Q
                              
                              
                                 k
                              
                           
                        , 
                           k
                           =
                           1
                           ,
                           2
                           ,
                           …
                           ,
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                        , as
                           
                              (24)
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                          ,
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                          ,
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          1
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                          ,
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                          ,
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          2
                                       
                                    
                                    ,
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    ⋮
                                 
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          1
                                          ,
                                          
                                             
                                                2
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          2
                                          ,
                                          
                                             
                                                2
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          −
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          ℓ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                                ,
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

Next, we combine these 
                           (
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                           )
                         sets of sample eigenvalues for multilinear signal number estimation using the MDL.

The MDL detection algorithm was originally formulated using an information argument [55], although it can also be derived/interpreted in a Bayesian or Kullback–Leibler information framework [28]. The MDL determines the number of signals by minimizing the penalized negative log-likelihood function:
                           
                              (27)
                              
                                 
                                    MDL
                                 
                                 (
                                 r
                                 )
                                 =
                                 log
                                 ⁡
                                 
                                    (
                                    
                                       
                                          p
                                       
                                       
                                          r
                                       
                                    
                                    
                                       (
                                       Y
                                       ,
                                       
                                          
                                             
                                                
                                                   θ
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             r
                                          
                                       
                                       )
                                    
                                    )
                                 
                                 +
                                 
                                    1
                                    2
                                 
                                 log
                                 ⁡
                                 (
                                 Q
                                 )
                                 ⋅
                                 ν
                                 (
                                 r
                                 ;
                                 P
                                 ,
                                 Q
                                 )
                              
                           
                         where 
                           
                              
                                 p
                              
                              
                                 r
                              
                           
                           (
                           Y
                           ,
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 r
                              
                           
                           )
                         is the likelihood function with 
                           
                              
                                 
                                    
                                       θ
                                    
                                    
                                       ˆ
                                    
                                 
                              
                              
                                 r
                              
                           
                         being the maximum likelihood estimate of the parameter vector of the rth model, namely, 
                           
                              
                                 θ
                              
                              
                                 r
                              
                           
                        , and the second term is the penalty term with ν being the number of free parameters in 
                           
                              
                                 θ
                              
                              
                                 r
                              
                           
                        . In particular, in the context of multichannel time-series analysis [29], we have 
                           ν
                           (
                           r
                           ;
                           P
                           ,
                           Q
                           )
                           =
                           r
                           (
                           2
                           P
                           −
                           r
                           )
                         and the likelihood function in (27) is
                           
                              (28)
                              
                                 
                                    log
                                    ⁡
                                    
                                       (
                                       
                                          
                                             p
                                          
                                          
                                             r
                                          
                                       
                                       
                                          (
                                          Y
                                          ,
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      ˆ
                                                   
                                                
                                             
                                             
                                                r
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    =
                                    −
                                    Q
                                    (
                                    P
                                    −
                                    r
                                    )
                                    log
                                    ⁡
                                    
                                       (
                                       
                                          
                                             
                                                (
                                                
                                                   ∏
                                                   
                                                      i
                                                      =
                                                      r
                                                      +
                                                      1
                                                   
                                                   P
                                                
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                             
                                                
                                                   1
                                                   
                                                      P
                                                      −
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                1
                                                
                                                   P
                                                   −
                                                   r
                                                
                                             
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   =
                                                   r
                                                   +
                                                   1
                                                
                                                
                                                   P
                                                
                                             
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                 
                              
                           
                         where P and Q are the numbers of channels and samples, respectively.

The MDL is widely used in practice due to its simplicity and consistency (that is, it returns the correct number of signals as the sample size tends to infinity) [29,56,57]. However, it tends to underestimate the number of signals when the sample size is small [58–64].

For the tensor rank detection, i.e., detection of number of multilinear signals from 
                           Y
                        , to reduce the detection error due to underestimation, a natural choice is that we employ the set of eigenvalues (24)–(26) associated to the most oblate unfolded matrix 
                           
                              
                                 Y
                              
                              
                                 (
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                        , namely, (26). Note that 
                           
                              
                                 Y
                              
                              
                                 (
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                         has the smallest number of rows but largest number of columns among all 
                           (
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                           )
                         unfolded matrices of 
                           Y
                        .

To further improve the performance, we propose to construct the global eigenvalues by summing (or averaging)
                           3
                        
                        
                           3
                           Note that the ‘summing’ and “averaging” operations are equivalent in the sense that their defined global eigenvalues yield the same cost function of (30b).
                         all 
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                         sets of eigenvalues:
                           
                              (29)
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                    
                                    
                                       (
                                       G
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       
                                          
                                             2
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             2
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

The global eigenvalues are substituted into the MDL criterion for detection:
                           
                              (30a)
                              
                                 
                                    
                                       
                                          
                                             R
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       (
                                       
                                          
                                             2
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       −
                                       1
                                       )
                                    
                                 
                                 =
                                 arg
                                 ⁡
                                 
                                    min
                                    
                                       r
                                       ∈
                                       
                                          {
                                          0
                                          ,
                                          1
                                          ,
                                          …
                                          ,
                                          
                                             
                                                P
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          −
                                          1
                                          }
                                       
                                    
                                 
                                 ⁡
                                 
                                    
                                       MDL
                                    
                                    
                                       N
                                       −
                                       D
                                    
                                 
                                 (
                                 r
                                 )
                                 ,
                              
                           
                         where
                           
                              (30b)
                              
                                 
                                    
                                       
                                          
                                             
                                                MDL
                                             
                                             
                                                N
                                                −
                                                D
                                             
                                          
                                          (
                                          r
                                          )
                                       
                                       
                                          =
                                          
                                             
                                                Q
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   P
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   1
                                                
                                             
                                             −
                                             r
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          ×
                                          
                                             log
                                          
                                          
                                             
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               
                                                                  2
                                                               
                                                               
                                                                  N
                                                                  −
                                                                  1
                                                               
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                      −
                                                      r
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      r
                                                      +
                                                      1
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                            
                                                               N
                                                               −
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                      
                                                   
                                                
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      (
                                                      G
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      ∏
                                                      
                                                         i
                                                         =
                                                         r
                                                         +
                                                         1
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            
                                                               
                                                                  2
                                                               
                                                               
                                                                  N
                                                                  −
                                                                  1
                                                               
                                                            
                                                            −
                                                            1
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ℓ
                                                      
                                                      
                                                         i
                                                      
                                                      
                                                         (
                                                         G
                                                         )
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      1
                                                      
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               
                                                                  
                                                                     2
                                                                  
                                                                  
                                                                     N
                                                                     −
                                                                     1
                                                                  
                                                               
                                                               −
                                                               1
                                                            
                                                         
                                                         −
                                                         r
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                          +
                                          
                                             1
                                             2
                                          
                                          r
                                          
                                             (
                                             2
                                             
                                                
                                                   P
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                      
                                                         N
                                                         −
                                                         1
                                                      
                                                   
                                                   −
                                                   1
                                                
                                             
                                             −
                                             r
                                             )
                                          
                                          log
                                          ⁡
                                          
                                             
                                                Q
                                             
                                             
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         with 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                              
                           
                         and 
                           
                              
                                 Q
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                              
                           
                         being respectively the numbers of rows and columns of 
                           
                              
                                 Y
                              
                              
                                 (
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                                 )
                              
                           
                         in (21).

The drawback of this detection scheme is that the number of detectable/identifiable signals is too small (only 
                           
                              
                                 P
                              
                              
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                              
                           
                           −
                           1
                        ). To maximize the identifiability and inspired by [36–38], we adopt a sequential detection procedure where the MDL incrementally utilizes the 
                           (
                           
                              
                                 2
                              
                              
                                 N
                                 −
                                 1
                              
                           
                           −
                           1
                           )
                         sets of eigenvalues in an order defined in (24)–(26). In the k-th sequential step, the global eigenvalues are formed by summing the first k sets of eigenvalues:
                           
                              (31)
                              
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                    
                                       (
                                       G
                                       )
                                    
                                 
                                 =
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       2
                                    
                                 
                                 +
                                 ⋯
                                 +
                                 
                                    
                                       ℓ
                                    
                                    
                                       i
                                       ,
                                       k
                                    
                                 
                                 ,
                                 
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       P
                                    
                                    
                                       k
                                    
                                 
                                 .
                              
                           
                         
                        Figs. 3–5
                        
                        
                         illustrate the adaptive definition of the global eigenvalues in the first, second and third steps of the sequential rank detection algorithm, where the tensor data have the same size as in Example 4.2, and the number of components is 
                           R
                           =
                           6
                        . The sequential detection algorithm is described in Algorithm 2
                        .

Note that the definition of global eigenvalues in (31) extends [36–38] in two aspects.
                           
                              •
                              First, the global eigenvalues in [36–38] only use the n-mode eigenvalues, while the new definition exploits both the n-mode and multi-mode eigenvalues. Therefore, the generalized N-D MDL can identify much more signals than [36–38] for 
                                    N
                                    ≥
                                    4
                                 . More specifically, the maximum number of identifiable signals by the generalized N-D MDL is equal to the size of the most squared matrix minus 1:
                                    
                                       (33)
                                       
                                          
                                             
                                                R
                                             
                                             
                                                max
                                             
                                          
                                          =
                                          
                                             max
                                             
                                                
                                                   
                                                      1
                                                      ≤
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      <
                                                      ⋯
                                                      <
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ≤
                                                      N
                                                   
                                                
                                                
                                                   
                                                      1
                                                      ≤
                                                      m
                                                      ≤
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          ⁡
                                          min
                                          ⁡
                                          
                                             (
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             ⋯
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ⋯
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         N
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   ⋯
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                             )
                                          
                                          −
                                          1
                                          ,
                                       
                                    
                                  which is on the order of 
                                    
                                       
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          ⋯
                                          
                                             
                                                I
                                             
                                             
                                                N
                                             
                                          
                                       
                                    
                                 . This is the highest identifiability we can expect from the matrix-unfolding-based N-D detection schemes. By contrast, the N-D MDL in [36–38] can detect at most 
                                    [
                                    max
                                    ⁡
                                    
                                       (
                                       
                                          
                                             I
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             I
                                          
                                          
                                             N
                                          
                                       
                                       )
                                    
                                    −
                                    1
                                    ]
                                  signals.

Second, in the N-D MDL [36–38] the global eigenvalues are defined as the product of individual sets of eigenvalues, while in the generalized N-D MDL they are formed by adding individual sets of eigenvalues. Since the sum operation deflates the dispersion of noise eigenvalues, the global noise eigenvalues are more closely clustered leading to wider signal-noise spectrum gap and more efficient test of sphericity of noise subspace than that of individual eigenvalues. As shown in Theorem 4.1, the definition of global eigenvalues in (31) leads to a consistent detection criterion which correctly detects the number of signals R in the large-sample limit when 
                                    R
                                    ≤
                                    
                                       
                                          R
                                       
                                       
                                          max
                                       
                                    
                                 , while in the original N-D MDL [36–38] the consistency is an open problem.


                        
                           Remark 4.1
                           A generalization to (31) is obtained by defining the global eigenvalues as a weighted sum of individual sets of eigenvalues:
                                 
                                    (34)
                                    
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                          
                                             (
                                             G
                                             )
                                          
                                       
                                       =
                                       
                                          
                                             c
                                          
                                          
                                             1
                                          
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                             ,
                                             1
                                          
                                       
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             2
                                          
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                             ,
                                             2
                                          
                                       
                                       +
                                       ⋯
                                       +
                                       
                                          
                                             c
                                          
                                          
                                             i
                                          
                                       
                                       
                                          
                                             ℓ
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       ,
                                       
                                       i
                                       =
                                       1
                                       ,
                                       2
                                       ,
                                       …
                                       ,
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                       ,
                                    
                                 
                               where 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       i
                                    
                                 
                               are the weighting coefficients. In this case, the penalty term in (32b) may need to be modified for better performance. This will be an interesting topic for further research.

We analyze the asymptotic behavior of the generalized N-D MDL described in Algorithm 2 as the number of samples tends to infinity. Define
                           
                              (35)
                              
                                 Q
                                 =
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                                 =
                                 min
                                 ⁡
                                 
                                    {
                                    
                                       
                                          Q
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          Q
                                       
                                       
                                          (
                                          
                                             
                                                2
                                             
                                             
                                                N
                                                −
                                                1
                                             
                                          
                                          −
                                          1
                                          )
                                       
                                    
                                    }
                                 
                              
                           
                         as the number of columns of the most “squared” unfolded matrix 
                           
                              
                                 Y
                              
                              
                                 (
                                 1
                                 )
                              
                           
                        .

Denote the highest mode rank of a tensor 
                           X
                         as
                           
                              (36)
                              
                                 
                                    
                                       
                                          
                                             
                                                rank
                                             
                                             
                                                1
                                                :
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          
                                             (
                                             X
                                             )
                                          
                                       
                                       
                                          =
                                          
                                             max
                                             
                                                
                                                   
                                                      1
                                                      ≤
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      <
                                                      ⋯
                                                      <
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                      ≤
                                                      N
                                                   
                                                
                                                
                                                   
                                                      1
                                                      ≤
                                                      m
                                                      ≤
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                             
                                          
                                          ⁡
                                          
                                             rank
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   [
                                                   X
                                                   ]
                                                
                                                
                                                   (
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          =
                                          
                                             max
                                             
                                                1
                                                ≤
                                                k
                                                ≤
                                                
                                                   
                                                      2
                                                   
                                                   
                                                      N
                                                      −
                                                      1
                                                   
                                                
                                                −
                                                1
                                             
                                          
                                          ⁡
                                          
                                             rank
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   X
                                                
                                                
                                                   (
                                                   k
                                                   )
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                         First, we show that the generalized N-D MDL consistently estimates 
                           
                              
                                 rank
                              
                              
                                 1
                                 :
                                 
                                    
                                       2
                                    
                                    
                                       N
                                       −
                                       1
                                    
                                 
                                 −
                                 1
                              
                           
                           
                              (
                              X
                              )
                           
                         with probability one as Q tends to infinity.


                        
                           Theorem 4.1
                           
                              Suppose the highest mode rank of the signal tensor 
                              
                                 X
                               
                              satisfies
                              
                                 
                                    (37)
                                    
                                       
                                          
                                             rank
                                          
                                          
                                             1
                                             :
                                             
                                                
                                                   2
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          X
                                          )
                                       
                                       ≤
                                       
                                          
                                             P
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       1
                                       .
                                    
                                 
                               
                              The generalized N-D MDL in 
                              
                                 Algorithm 2
                               
                              is a consistent estimator of the highest mode rank of the signal tensor 
                              
                                 X
                              
                              , namely,
                              
                                 
                                    (38)
                                    
                                       
                                          
                                             
                                                
                                                   R
                                                
                                                
                                                   ˆ
                                                
                                             
                                          
                                          
                                             N
                                             −
                                             D
                                          
                                       
                                       =
                                       
                                          
                                             rank
                                          
                                          
                                             1
                                             :
                                             
                                                
                                                   2
                                                
                                                
                                                   N
                                                   −
                                                   1
                                                
                                             
                                             −
                                             1
                                          
                                       
                                       
                                          (
                                          X
                                          )
                                       
                                       
                                       
                                          a.s.
                                       
                                       
                                        as 
                                       Q
                                       →
                                       +
                                       ∞
                                       ,
                                    
                                 
                               
                              where a.s. (short for almost surely) means “with probability one”.
                           


                        
                           Remark 4.2
                           According to (23) and (35), we have 
                                 Q
                                 ≥
                                 
                                    max
                                 
                                 
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                              . This implies that Theorem 4.1 holds when
                                 
                                    (39)
                                    
                                       
                                          max
                                       
                                       
                                          (
                                          
                                             
                                                I
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                I
                                             
                                             
                                                N
                                             
                                          
                                          )
                                       
                                       →
                                       +
                                       ∞
                                       ,
                                    
                                 
                               i.e., when the maximum dimension length tends to infinity. In particular, in the context of array processing, the last dimension, i.e., Nth mode, corresponds to the temporal dimension, and 
                                 
                                    
                                       I
                                    
                                    
                                       N
                                    
                                 
                                 =
                                 T
                               is the number of temporal samples. When T is infinitely large, it trivially holds that it is the maximum dimension length, and the condition (39) reduces to 
                                 T
                                 →
                                 +
                                 ∞
                              , which is in accordance with the consistency condition for the 2-D MDL case [29,56,57].

Next we prove that the highest mode rank of a tensor will not exceed the rank of the tensor.


                        
                           Theorem 4.2
                           
                              Given an Nth-order tensor 
                              
                                 X
                               
                              of rank R, for any 
                              
                                 1
                                 ≤
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 ≤
                                 N
                               
                              
                                 (
                                 1
                                 ≤
                                 m
                                 ≤
                                 N
                                 −
                                 1
                                 )
                              
                              , the 
                              
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 )
                              
                              -mode rank of 
                              
                                 X
                              
                              , is less than or equal to R, namely,
                              
                                 
                                    (40)
                                    
                                       
                                          rank
                                       
                                       
                                       
                                          (
                                          
                                             
                                                [
                                                X
                                                ]
                                             
                                             
                                                (
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      1
                                                   
                                                
                                                ,
                                                …
                                                ,
                                                
                                                   
                                                      n
                                                   
                                                   
                                                      m
                                                   
                                                
                                                )
                                             
                                          
                                          )
                                       
                                       ≤
                                       R
                                       .
                                    
                                 
                              
                           

For any 
                                 1
                                 ≤
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 <
                                 ⋯
                                 <
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 ≤
                                 N
                               
                              
                                 (
                                 1
                                 ≤
                                 m
                                 ≤
                                 N
                                 −
                                 1
                                 )
                              , the 
                                 (
                                 
                                    
                                       n
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       m
                                    
                                 
                                 )
                              -mode matrix unfolding of 
                                 X
                               is
                                 
                                    (41)
                                    
                                       
                                          
                                             [
                                             X
                                             ]
                                          
                                          
                                             (
                                             
                                                
                                                   n
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   n
                                                
                                                
                                                   m
                                                
                                             
                                             )
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             r
                                             =
                                             1
                                          
                                          R
                                       
                                       
                                          
                                             c
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             1
                                             )
                                          
                                       
                                       ∘
                                       
                                          
                                             c
                                          
                                          
                                             r
                                          
                                          
                                             (
                                             2
                                             )
                                          
                                       
                                       ∈
                                       
                                          
                                             C
                                          
                                          
                                             (
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             …
                                             
                                                
                                                   I
                                                
                                                
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                
                                             
                                             )
                                             ×
                                             
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                      
                                                   
                                                   …
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                       ,
                                    
                                 
                               where
                                 
                                    (42)
                                    
                                       
                                          
                                             
                                                c
                                             
                                             
                                                r
                                             
                                             
                                                (
                                                1
                                                )
                                             
                                          
                                          =
                                          
                                             vec
                                          
                                          
                                          
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                             
                                             ∘
                                             ⋯
                                             ∘
                                             
                                                
                                                   a
                                                
                                                
                                                   r
                                                
                                                
                                                   (
                                                   
                                                      
                                                         n
                                                      
                                                      
                                                         m
                                                      
                                                   
                                                   )
                                                
                                             
                                             )
                                          
                                          ∈
                                          
                                             
                                                C
                                             
                                             
                                                (
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                …
                                                
                                                   
                                                      I
                                                   
                                                   
                                                      
                                                         
                                                            n
                                                         
                                                         
                                                            m
                                                         
                                                      
                                                   
                                                
                                                )
                                                ×
                                                1
                                             
                                          
                                          ,
                                       
                                    
                                 
                              
                              
                                 
                                    (43)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         c
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         2
                                                         )
                                                      
                                                   
                                                
                                                
                                                   =
                                                   
                                                      vec
                                                   
                                                   
                                                   
                                                      (
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         1
                                                         )
                                                      
                                                   
                                                   ∘
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         2
                                                         )
                                                      
                                                   
                                                   ∘
                                                   ⋯
                                                   ∘
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         1
                                                         )
                                                      
                                                   
                                                   ∘
                                                   ⋯
                                                
                                             
                                             
                                                
                                                
                                                   
                                                   ∘
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         r
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               n
                                                            
                                                            
                                                               m
                                                            
                                                         
                                                         −
                                                         1
                                                         )
                                                      
                                                   
                                                   ∘
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            (
                                                            
                                                               
                                                                  n
                                                               
                                                               
                                                                  m
                                                               
                                                            
                                                            +
                                                            1
                                                            )
                                                         
                                                      
                                                      ∘
                                                      ⋯
                                                      ∘
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            r
                                                         
                                                         
                                                            (
                                                            N
                                                            )
                                                         
                                                      
                                                      )
                                                   
                                                   ∈
                                                   
                                                      
                                                         C
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  I
                                                               
                                                               
                                                                  T
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                  
                                                               
                                                               …
                                                               
                                                                  
                                                                     I
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           n
                                                                        
                                                                        
                                                                           m
                                                                        
                                                                     
                                                                  
                                                               
                                                            
                                                         
                                                         ×
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The inequality (40) follows from the fact that each column of 
                                 
                                    
                                       [
                                       X
                                       ]
                                    
                                    
                                       (
                                       
                                          
                                             n
                                          
                                          
                                             1
                                          
                                       
                                       ,
                                       …
                                       ,
                                       
                                          
                                             n
                                          
                                          
                                             m
                                          
                                       
                                       )
                                    
                                 
                               is a linear combination of 
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       c
                                    
                                    
                                       R
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                              .  □


                        
                           Remark 4.3
                           
                              Theorem 4.2 states that any n- or multi-mode rank of a tensor 
                                 X
                               will not exceed its tensor rank R. Therefore, the highest mode rank of 
                                 X
                               will not exceed its tensor rank R as well, namely, 
                                 
                                    
                                       rank
                                    
                                    
                                       1
                                       :
                                       
                                          
                                             2
                                          
                                          
                                             N
                                             −
                                             1
                                          
                                       
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    X
                                    )
                                 
                                 ≤
                                 R
                              .


                        
                           Remark 4.4
                           Like the n-mode ranks [43], the multi-mode ranks of different modes of a tensor may be different.


                        
                           Remark 4.5
                           According to Theorem 4.1, the generalized N-D MDL works as long as one of the n- or multi-mode ranks of the noise-free signal tensor is equal to its tensor rank R. To the best of our knowledge, the conditions under which the n- or multi-mode rank is equal to the tensor rank is an open problem in the literature that remains unsolved.

For a third-order tensor, the maximum and typical ranks
                                 4
                              
                              
                                 4
                                 The maximum rank is defined as the largest attainable rank of a tensor, whereas the typical rank is any rank that occurs with probability greater than zero (i.e., on a set with positive Lebesgue measure). See Section 2.1 in [27] for definitions.
                               can be larger than individual dimension lengths (see Tables 1 and 2 in [27]). In this case the general N-D MDL fails, because its maximum number of detectable signals is less than 
                                 max
                                 ⁡
                                 
                                    (
                                    
                                       
                                          I
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          I
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                              . However, as far as we know, this scenario is not common in practical applications where the number of signals is often smaller than individual dimension lengths. Moreover, in the subspace/subset of tensors with tensor rank less than or equal to 
                                 
                                    
                                       I
                                    
                                    
                                       n
                                    
                                 
                              , it is shown in extensive Monte Carlo simulations (which randomly draw each entry of the tensor from a normal distribution with mean zero and variance one) that the rank of a tensor is equal to its n-rank with probability 1.
                                 5
                              
                              
                                 5
                                 In the Monte Carlo simulation, the tensors are randomly generated in each trial and those with tensor rank less than or equal to 
                                       
                                          
                                             I
                                          
                                          
                                             n
                                          
                                       
                                     are kept and formed a set. To avoid an empty set, the sizes of tensors are chosen such that at least one typical rank is less than or equal to 
                                       
                                          
                                             I
                                          
                                          
                                             n
                                          
                                       
                                    . Then we find out the percentage of the subset of tensors whose tensor rank equals its n-rank.
                              
                           

For a fourth- or higher-order tensor, it seems that the tensor rank will not be larger than (33) (no counter-example is reported in the literature). Moreover, our empirical results reveal that the rank of the most squared unfolded matrix 
                                 
                                    
                                       X
                                    
                                    
                                       (
                                       1
                                       )
                                    
                                 
                               equals the tensor rank of 
                                 X
                               with probability 1.

We conduct simulations to evaluate the performance of the generalized N-D MDL in estimating the tensor rank. The data are generated using the noisy CP model. The entries of the factor matrices are i.i.d. drawn from 
                        N
                        (
                        0
                        ,
                        1
                        )
                     , i.e., real Gaussian distribution with zero mean and unit variance. The entries of the noise tensor 
                        Z
                      are i.i.d. drawn from 
                        N
                        (
                        0
                        ,
                        
                           
                              σ
                           
                           
                              2
                           
                        
                        )
                     . The signal-to-noise ratio (SNR) is defined as
                        
                           
                              
                                 SNR
                              
                              =
                              
                                 
                                    
                                       ‖
                                       X
                                       ‖
                                    
                                    
                                       F
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          ∏
                                       
                                       
                                          n
                                          =
                                          1
                                       
                                       
                                          N
                                       
                                    
                                    
                                       
                                          I
                                       
                                       
                                          n
                                       
                                    
                                 
                              
                              .
                           
                        
                      The noise power 
                        
                           
                              σ
                           
                           
                              2
                           
                        
                      is scaled to obtain different SNRs. For each SNR, 100 independent Monte Carlo runs have been conducted. The performance measure is the probability of correct detection (PoD), i.e. 
                        Pr
                        ⁡
                        
                           (
                           
                              
                                 R
                              
                              
                                 ˆ
                              
                           
                           =
                           R
                           )
                        
                     , averaged over signal and noise realizations.

The following schemes are used in the performance comparison: CORCONDIA [22], Adaptive CORCONDIA [65], DIFFIT [20], NumConvHull [21], ARD using Gaussian prior – ridge ARD [23], ARD using Laplace prior – sparse ARD [23], reconstruction-error-based CP rank selector [25], MDL applied to individual n-mode eigenvalues, 
                        n
                        =
                        1
                        ,
                        2
                        ,
                        …
                        ,
                        N
                     , denoted as n-mode MDL, and the N-D MDL and N-D exponential fitting test (EFT) proposed in [38]. For CORCONDIA, three thresholds are adopted: 
                        η
                        =
                        50
                        %
                        ,
                        75
                        %
                        ,
                        90
                        %
                     .

We use the MATLAB package in http://www.mortenmorup.dk/MMhomepageUpdated_files/Page327.htm for implementing the ARD algorithms. For CP decomposition and other tensor operations, we have employed the N-way toolbox for MATLAB [66]. Unless otherwise stated, for all parameters of the ARD and CP algorithms (e.g., initialization method, convergence criterion and maximum number of iterations) their default values are used. The MATLAB codes of all rank detection algorithms are available for download at http://www.ee.cityu.edu.hk/~hcso/publication.html.

The ridge ARD and sparse ARD require a guess of the maximum possible number of components, i.e., 
                        
                           
                              R
                           
                           
                              max
                           
                        
                     . When such information is unavailable a priori, 
                        
                           
                              R
                           
                           
                              max
                           
                        
                      can be estimated instead based on the uniqueness condition of the CP decomposition. According to [40,41,67], the R-component CP decomposition of an N-order tensor is essentially unique (up to permutation and scaling ambiguities of the factor matrices) provided that
                        
                           (44)
                           
                              min
                              ⁡
                              (
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              ,
                              R
                              )
                              +
                              min
                              ⁡
                              (
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              ,
                              R
                              )
                              +
                              ⋯
                              +
                              min
                              ⁡
                              (
                              
                                 
                                    I
                                 
                                 
                                    N
                                 
                              
                              ,
                              R
                              )
                              ≥
                              2
                              R
                              +
                              N
                              −
                              1
                              .
                           
                        
                      From (44), 
                        
                           
                              R
                           
                           
                              max
                           
                        
                      can be determined
                        6
                     
                     
                        6
                        The sufficient uniqueness condition of the CP decomposition in (44) has been relaxed in recent literature, e.g., [68,69], which implies an improved upper bound 
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                            of the number of resolvable signals. Since the performance of the compared algorithms is not sensitive to 
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                           , we have not employed the improved 
                              
                                 
                                    R
                                 
                                 
                                    max
                                 
                              
                           .
                     . For the ARD algorithms, the maximum number of iterations is set as 1000.

We have conducted an extensive simulation study where the generalized N-D MDL shows competitive performance with the best of existing methods. Due to space limit, we only show results for a four-way array of size 
                        7
                        ×
                        7
                        ×
                        7
                        ×
                        7
                     .

In Fig. 6
                     , we consider a 3-component four-way array of size 
                        7
                        ×
                        7
                        ×
                        7
                        ×
                        7
                     . We see that the CORCONDIAs with 
                        η
                        =
                        50
                        %
                        ,
                        75
                        %
                      perform very well at low SNRs but poorly at high SNRs (cannot attain a PoD of 1 due to over-enumeration). The CORCONDIAs with 
                        η
                        =
                        90
                        %
                      performs better at high SNRs but shows inferior performance at low SNRs. The adaptive CORCONDIA presents a good trade-off between performance at low and high SNRs. The NumConvHull, ARD algorithms and reconstruction-error-based CP rank selector possess PoDs that increase monotonically with SNR and attain 1 at sufficiently high SNRs, but all have inferior performance compared to the generalized N-D MDL.

In Fig. 6(b), the ‘N-D MDL (w/o multi-mode)’ denotes the proposed N-D MDL applied to n-mode unfoldings only (without considering the multi-mode unfoldings). It happens that the ‘N-D MDL (w/o multi-mode)’ performs equally to the N-D MDL [38]
                     
                        7
                     
                     
                        7
                        For a larger array size, e.g., 
                              
                                 
                                    I
                                 
                                 
                                    1
                                 
                              
                              =
                              20
                              ,
                              
                                 
                                    I
                                 
                                 
                                    2
                                 
                              
                              =
                              30
                              ,
                              
                                 
                                    I
                                 
                                 
                                    3
                                 
                              
                              =
                              40
                           , and 
                              
                                 
                                    I
                                 
                                 
                                    4
                                 
                              
                              =
                              50
                           , our simulations show that the ‘N-D MDL (w/o multi-mode)’ outperforms the N-D MDL [38].
                      and the N-D EFT,
                        8
                     
                     
                        8
                        In EFT, the detection threshold is determined by Monte Carlo simulation using a preset probability of false alarm (Pfa) [31]. For typical Pfa value such as 0.01 and 0.1, the N-D EFT [38] turns out to perform poorly due to its tendency to overestimate the number of signals. To handle that, a very small 
                              
                                 Pfa
                              
                              =
                              
                                 
                                    10
                                 
                                 
                                    −
                                    18
                                 
                              
                            is used in our simulations, just as done in [38]. However, with such a small Pfa, the number of trials in the Monte Carlo simulation is so large that it takes an unacceptably long time (months or longer) to calculate the thresholds. Therefore, we estimate the thresholds for 
                              
                                 Pfa
                              
                              =
                              
                                 
                                    10
                                 
                                 
                                    −
                                    18
                                 
                              
                            via the extrapolation method based on the simulated thresholds for 
                              
                                 Pfa
                              
                              =
                              0.1
                              ,
                              0.01
                              ,
                              0.001
                              ,
                              0.0001
                           .
                      and by considering the multi-mode unfoldings, the generalized N-D MDL is superior to the N-D MDL proposed in [38].

In Fig. 7
                     , the number of components is increased to 
                        R
                        =
                        8
                     . Note that all n-mode MDLs and N-D MDL in [38] fail since they can detect no more than 6 signals in this case and the results are not shown here. Note that all three CORCONDIAs and adaptive CORCONDIA fail as well. This is because estimation of the CP core in CORCONDIA involves inversion of the factor matrices 
                        
                           
                              A
                           
                           
                              r
                           
                           
                              (
                              n
                              )
                           
                        
                     , 
                        n
                        =
                        1
                        ,
                        2
                        …
                        ,
                        N
                     , as shown in (8). When 
                        R
                        >
                        
                           min
                        
                        
                           (
                           
                              
                                 I
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 I
                              
                              
                                 2
                              
                           
                           ,
                           …
                           ,
                           
                              
                                 I
                              
                              
                                 N
                              
                           
                           )
                        
                        =
                        7
                     , at least one of the 
                        
                           
                              A
                           
                           
                              r
                           
                           
                              (
                              n
                              )
                           
                        
                     s is column rank deficient. Consequently, the calculation of the core tensor is an ill-posed problem which admits infinitely many solutions and thus the identity core cannot be uniquely recovered. The DIFFIT, NumConvHull, ARD algorithms and reconstruction-error-based CP rank selector work properly but when SNR > 12.5 dB they have inferior performance compared to the generalized N-D MDL.

We evaluate the performance of the proposed detection algorithm in two difficult scenarios: (i) rank-overlap [70]: some factor matrices contain collinear columns; (ii) distinct magnitudes of components: instead of using the identity tensor in (5), a diagonal core tensor with different values on the diagonal is used. The array sizes and number of components are the same as those in Fig. 6, i.e., 
                           
                              
                                 I
                              
                              
                                 1
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 2
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 3
                              
                           
                           =
                           
                              
                                 I
                              
                              
                                 4
                              
                           
                           =
                           7
                         and 
                           R
                           =
                           3
                        .

For the rank-overlap problem, we consider a simple example similar to [25]:
                           
                              (45)
                              
                                 X
                                 =
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       b
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       c
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       d
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       1
                                    
                                 
                                 ∘
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ∘
                                 
                                    
                                       c
                                    
                                    
                                       2
                                    
                                 
                                 ∘
                                 
                                    
                                       d
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       2
                                    
                                 
                                 ∘
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                                 ∘
                                 
                                    
                                       c
                                    
                                    
                                       3
                                    
                                 
                                 ∘
                                 
                                    
                                       d
                                    
                                    
                                       3
                                    
                                 
                              
                           
                        
                     


                        Fig. 8
                         depicts the PoD versus SNR. Note that all three versions of the CORCONDIAs and adaptive CORCONDIA fail as well. This can be justified based on a similar argument to Fig. 7: due to rank deficiency of the first two factor matrices 
                           A
                           =
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             1
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             a
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              ]
                           
                         and 
                           B
                           =
                           
                              [
                              
                                 
                                    
                                       
                                          
                                             b
                                          
                                          
                                             1
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                       
                                    
                                    
                                       
                                          
                                             b
                                          
                                          
                                             2
                                          
                                       
                                    
                                 
                              
                              ]
                           
                         cannot be uniquely inverted and as a result the CP core cannot be uniquely recovered. By contrast, all other tensor-based rank detectors suffer no performance degradation compared to Fig. 6(a).

In Fig. 8(b), the N-D EFT and two N-D MDLs suffer a slight performance degradation compared to Fig. 6(b), and they perform even worse than the 3-mode and 4-mode MDLs. The 1-mode and 2-mode MDLs fail due to rank deficiency of the first two factor matrices. The generalized N-D MDL suffers almost no performance degradation and outperforms all the alternatives.

In Fig. 9
                        , we compare the performance of algorithms in the second difficult scenario, where we assume the elements on the core diagonal follow a Laplace distribution with zero mean and unit variance. We see that all matrix- and tensor-based rank detectors suffer a significant performance degradation to various degrees compared to Fig. 6. The generalized N-D MDL is still superior to all other algorithms except for the two CORCONDIAs with thresholds 
                           η
                           =
                           50
                           %
                           ,
                           75
                           %
                        , which perform the best for low-to-intermediate SNRs. Fig. 10
                         shows the histogram of estimated number of components at SNR = 25 dB. We see that for the CORCONDIAs, DIFFIT, NumConvHull, and reconstruction-error-based CP rank selector, the detection error comes from both underestimation and overestimation of the number of components, while for other rank detection algorithms, the deviation is due to underestimation only.


                        Fig. 11
                         shows the mean computational times in seconds of different rank detectors for a three-way array of various sizes. The experiments are run on a desktop PC with an Intel 3.6 GHz Dual Core i7 CPU and a 32 GB RAM. The parameters settings are described in the figure caption.

In Fig. 11(a), the computational complexities of all tensor-based rank detectors are much higher than that of the generalized N-D MDL. As the size of the array 
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                         increases from 5 to 30, the gap in computational time significantly increases, and when 
                           
                              
                                 I
                              
                              
                                 n
                              
                           
                           =
                           30
                        , the mean computational time of the tensor-based rank detectors is tens of millions more than that of the generalized N-D MDL. Among the tensor-based rank detectors, the ARDs require relatively less computational time than others. As discussed in Section 3.2, this may be because in the ARDs, the model selection is integrated into the CP decomposition algorithm, and the removal of redundant components is performed not after the convergence of the CP decomposition algorithm but throughout the iterations. Note that the N-D EFT also requires longer computational time than the N-mode MDL.

In Fig. 11(b), the generalized N-D MDL requires approximately 3 times larger computational time than those required in the n-mode MDLs. Note that for such a three-way array, the complexity of the generalized N-D MDL is similar to the N-D MDL [38]. Their slight difference may owe to the different arithmetic operations used in calculating the global eigenvalues (addition versus multiplication).

@&#CONCLUSION@&#

We propose a computationally efficient multilinear MDL for detecting the number of components in CP models. Using the generalized unfolding of the observation tensor, 
                        (
                        
                           
                              2
                           
                           
                              N
                              −
                              1
                           
                        
                        −
                        1
                        )
                      sets of eigenvalues are obtained and combined for accurate estimation of the number of signals. Using a sequential detection scheme, the number of signals the N-D MDL can identify is of the order of the square root of the product of the sizes of all dimensions of the observation tensor. Under mild conditions, the generalized N-D MDL criterion consistently estimates the number of signals when the length of any dimension, e.g., the temporal dimension, tends to infinity. The drawback of the multilinear MDL algorithm is that it fails to work when the tensor rank is larger than the size of the most squared unfolded matrix. This scenario, however, is uncommon in practice to the best of our knowledge.

The idea of generalized unfolding of the observation tensor may also be used to design multidimensional extensions to other order selection rules, such as AIC and EFT [31]. This will be left for future research.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to thank the Coordenação de Aperfeiçoamento de Pessoal de Nível Superior (CAPES) under the PVE grant number 88881.030392/2013-01, the Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq) under the CSF grant number 207644/2015-2 and the productivity grant number 303905/2014-0, and the Fundação de Apoio à Pesquisa Distrito Federal (FAPDF) under the registration number 6650.23.33822.17092015 for their financial support.


                     
                        Proof
                        Define
                              
                                 (A.1)
                                 
                                    
                                       
                                          rank
                                       
                                       
                                          1
                                          :
                                          k
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                    ≜
                                    
                                       
                                          max
                                       
                                       
                                          1
                                          ≤
                                          j
                                          ≤
                                          k
                                       
                                    
                                    
                                       rank
                                    
                                    
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             (
                                             j
                                             )
                                          
                                       
                                       )
                                    
                                    .
                                 
                              
                           
                        

To prove (38), it suffices to show that in the kth 
                              (
                              k
                              =
                              1
                              ,
                              2
                              ,
                              …
                              )
                            step,
                              
                                 (A.2)
                                 
                                    
                                       
                                          
                                             
                                                R
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          (
                                          k
                                          )
                                       
                                    
                                    =
                                    
                                       
                                          rank
                                       
                                       
                                          1
                                          :
                                          k
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                    
                                    a.s.
                                    
                                     as 
                                    Q
                                    →
                                    +
                                    ∞
                                    ,
                                 
                              
                            which is equivalent to proving that for any 
                              r
                              ≠
                              
                                 
                                    rank
                                 
                                 
                                    1
                                    :
                                    k
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                           ,
                              
                                 (A.3)
                                 
                                    
                                       MDL
                                    
                                    (
                                    r
                                    )
                                    >
                                    
                                       MDL
                                    
                                    
                                       (
                                       
                                          
                                             rank
                                          
                                          
                                             1
                                             :
                                             k
                                          
                                       
                                       
                                          (
                                          X
                                          )
                                       
                                       )
                                    
                                    
                                     a.s.
                                    
                                    as 
                                    Q
                                    →
                                    +
                                    ∞
                                    .
                                 
                              
                           
                        

To prove (A.3), we observe from (32b) that
                              
                                 (A.4a)
                                 
                                    
                                       
                                          
                                             
                                                1
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                [
                                                
                                                   MDL
                                                
                                                (
                                                r
                                                )
                                                −
                                                
                                                   MDL
                                                
                                                
                                                   (
                                                   
                                                      
                                                         rank
                                                      
                                                      
                                                         1
                                                         :
                                                         k
                                                      
                                                   
                                                   
                                                      (
                                                      X
                                                      )
                                                   
                                                   )
                                                
                                                ]
                                             
                                          
                                       
                                       
                                          
                                             
                                             =
                                             G
                                             (
                                             r
                                             )
                                             −
                                             G
                                             
                                                (
                                                
                                                   
                                                      rank
                                                   
                                                   
                                                      1
                                                      :
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                             
                                             +
                                             
                                                [
                                                r
                                                −
                                                
                                                   
                                                      rank
                                                   
                                                   
                                                      1
                                                      :
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                ]
                                             
                                             
                                                [
                                                2
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                r
                                                −
                                                
                                                   
                                                      rank
                                                   
                                                   
                                                      1
                                                      :
                                                      k
                                                   
                                                
                                                
                                                   (
                                                   X
                                                   )
                                                
                                                ]
                                             
                                             
                                                
                                                   log
                                                   ⁡
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   2
                                                   
                                                      
                                                         Q
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                            where
                              
                                 (A.4b)
                                 
                                    
                                       
                                          
                                             G
                                             (
                                             r
                                             )
                                          
                                          
                                             =
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                r
                                                )
                                             
                                             
                                                log
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            −
                                                            r
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            r
                                                            +
                                                            1
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            ∑
                                                            
                                                               j
                                                               =
                                                               1
                                                            
                                                            k
                                                         
                                                         
                                                            
                                                               ℓ
                                                            
                                                            
                                                               i
                                                               ,
                                                               j
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      
                                                         ∏
                                                         
                                                            i
                                                            =
                                                            r
                                                            +
                                                            1
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               ∑
                                                               
                                                                  j
                                                                  =
                                                                  1
                                                               
                                                               k
                                                            
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  j
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               1
                                                               
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  −
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                          
                                          
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                r
                                                )
                                             
                                             
                                                log
                                             
                                             
                                                (
                                                
                                                   
                                                      
                                                         1
                                                         
                                                            
                                                               
                                                                  P
                                                               
                                                               
                                                                  k
                                                               
                                                            
                                                            −
                                                            r
                                                         
                                                      
                                                      
                                                         ∑
                                                         
                                                            i
                                                            =
                                                            r
                                                            +
                                                            1
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ∏
                                                         
                                                            i
                                                            =
                                                            r
                                                            +
                                                            1
                                                         
                                                         
                                                            
                                                               P
                                                            
                                                            
                                                               k
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     
                                                                        ℓ
                                                                     
                                                                     
                                                                        ¯
                                                                     
                                                                  
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  k
                                                               
                                                            
                                                            )
                                                         
                                                         
                                                            
                                                               1
                                                               
                                                                  
                                                                     
                                                                        P
                                                                     
                                                                     
                                                                        k
                                                                     
                                                                  
                                                                  −
                                                                  r
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                          
                                       
                                    
                                 
                              
                            and
                              
                                 (A.4c)
                                 
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       ∑
                                       
                                          j
                                          =
                                          1
                                       
                                       k
                                    
                                    
                                       
                                          ℓ
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    /
                                    k
                                    .
                                 
                              
                           
                        

Denote the population signal eigenvalues of the ordered unfolded matrices of 
                              X
                            in (21) as
                              
                                 (A.5)
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          1
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          2
                                          ,
                                          j
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          λ
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          j
                                       
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    2
                                    ,
                                    …
                                    ,
                                    
                                       
                                          2
                                       
                                       
                                          N
                                          −
                                          1
                                       
                                    
                                    −
                                    1
                                    .
                                 
                              
                           
                        

According to [71],
                              
                                 (A.6)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             =
                                             
                                                
                                                   λ
                                                
                                                
                                                   i
                                                   ,
                                                   j
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             O
                                             
                                                (
                                                
                                                   
                                                      
                                                         log
                                                         ⁡
                                                         log
                                                         ⁡
                                                         
                                                            
                                                               Q
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            Q
                                                         
                                                         
                                                            j
                                                         
                                                      
                                                   
                                                
                                                )
                                             
                                             
                                              a.s.
                                             ,
                                          
                                       
                                       
                                          
                                          
                                             
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   P
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             k
                                             .
                                          
                                       
                                    
                                 
                              
                            As
                              
                                 
                                    
                                       
                                          
                                             log
                                             ⁡
                                             log
                                             ⁡
                                             
                                                
                                                   Q
                                                
                                                
                                                   j
                                                
                                             
                                          
                                          
                                             
                                                Q
                                             
                                             
                                                j
                                             
                                          
                                       
                                    
                                    =
                                    O
                                    
                                       (
                                       
                                          
                                             
                                                log
                                                ⁡
                                                log
                                                ⁡
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    j
                                    =
                                    1
                                    ,
                                    …
                                    ,
                                    k
                                    −
                                    1
                                    ,
                                 
                              
                            it follows that
                              
                                 (A.7)
                                 
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    +
                                    
                                       
                                          σ
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             
                                                log
                                                ⁡
                                                log
                                                ⁡
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    
                                     a.s.
                                 
                              
                            where 
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              =
                              
                                 
                                    ∑
                                 
                                 
                                    j
                                    =
                                    1
                                 
                                 
                                    k
                                 
                              
                              
                                 
                                    λ
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                              /
                              k
                           .

1) Case I: 
                              r
                              <
                              
                                 
                                    rank
                                 
                                 
                                    1
                                    :
                                    k
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                           . From (A.7), it follows that when 
                              Q
                              →
                              +
                              ∞
                            (and hence 
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                              →
                              +
                              ∞
                           ), 
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                           , 
                              i
                              =
                              r
                              +
                              1
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                           , are not all equal with probability one. Therefore, by the arithmetic-mean geometric-mean inequality it follows that in the large-sample limit, we have
                              
                                 (A.8)
                                 
                                    
                                       1
                                       
                                          
                                             
                                                P
                                             
                                             
                                                k
                                             
                                          
                                          −
                                          r
                                       
                                    
                                    
                                       ∑
                                       
                                          i
                                          =
                                          r
                                          +
                                          1
                                       
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                ℓ
                                             
                                             
                                                ¯
                                             
                                          
                                       
                                       
                                          i
                                          ,
                                          k
                                       
                                    
                                    >
                                    
                                       ∏
                                       
                                          i
                                          =
                                          r
                                          +
                                          1
                                       
                                       
                                          
                                             P
                                          
                                          
                                             k
                                          
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      ℓ
                                                   
                                                   
                                                      ¯
                                                   
                                                
                                             
                                             
                                                i
                                                ,
                                                k
                                             
                                          
                                          )
                                       
                                       
                                          
                                             1
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                r
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Hence, 
                              G
                              (
                              r
                              )
                              >
                              0
                           .

On the other hand, in the large-sample limit, 
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              ,
                              i
                              =
                              
                                 
                                    rank
                                 
                                 
                                    1
                                    :
                                    k
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              +
                              1
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                           , are all equal to 
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                            with probability one. Therefore,
                              
                                 (A.9)
                                 
                                    G
                                    
                                       (
                                       
                                          
                                             rank
                                          
                                          
                                             1
                                             :
                                             k
                                          
                                       
                                       
                                          (
                                          X
                                          )
                                       
                                       )
                                    
                                    =
                                    0
                                    .
                                 
                              
                           
                        

Considering that the last term on the right-hand side (RHS) of (A.4a) approaches zero as Q tends to infinity, it follows that
                              
                                 (A.10)
                                 
                                    
                                       MDL
                                    
                                    (
                                    r
                                    )
                                    >
                                    
                                       
                                          rank
                                       
                                       
                                          1
                                          :
                                          k
                                       
                                    
                                    
                                       (
                                       X
                                       )
                                    
                                    
                                     a.s.
                                    
                                    as 
                                    Q
                                    →
                                    +
                                    ∞
                                    .
                                 
                              
                           
                        

2) Case II: 
                              r
                              >
                              
                                 
                                    rank
                                 
                                 
                                    1
                                    :
                                    k
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                           . Expanding 
                              {
                              
                                 
                                    
                                       
                                          ℓ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              }
                            in a Taylor series around 
                              
                                 
                                    σ
                                 
                                 
                                    2
                                 
                              
                           , we obtain
                              
                                 (A.11)
                                 
                                    
                                       
                                          
                                             G
                                             (
                                             r
                                             )
                                          
                                          
                                             =
                                             
                                                (
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                                −
                                                r
                                                )
                                             
                                             
                                                log
                                             
                                             
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   1
                                                   
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      −
                                                      r
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      i
                                                      =
                                                      r
                                                      +
                                                      1
                                                   
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               ℓ
                                                            
                                                            
                                                               ¯
                                                            
                                                         
                                                      
                                                      
                                                         i
                                                         ,
                                                         k
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             −
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   r
                                                   +
                                                   1
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                log
                                             
                                             
                                                (
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                +
                                                
                                                   
                                                      
                                                         
                                                            ℓ
                                                         
                                                         
                                                            ¯
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                      ,
                                                      k
                                                   
                                                
                                                −
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      2
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             =
                                             
                                                1
                                                2
                                             
                                             
                                                ∑
                                                
                                                   i
                                                   =
                                                   r
                                                   +
                                                   1
                                                
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ℓ
                                                               
                                                               
                                                                  ¯
                                                               
                                                            
                                                         
                                                         
                                                            i
                                                            ,
                                                            k
                                                         
                                                      
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   −
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                o
                                                (
                                                1
                                                )
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                             −
                                             
                                                1
                                                
                                                   2
                                                   (
                                                   
                                                      
                                                         P
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   −
                                                   r
                                                   )
                                                
                                             
                                             
                                                
                                                   [
                                                   
                                                      ∑
                                                      
                                                         i
                                                         =
                                                         r
                                                         +
                                                         1
                                                      
                                                      
                                                         
                                                            P
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ℓ
                                                                  
                                                                  
                                                                     ¯
                                                                  
                                                               
                                                            
                                                            
                                                               i
                                                               ,
                                                               k
                                                            
                                                         
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                      
                                                      −
                                                      1
                                                      )
                                                   
                                                   ]
                                                
                                                
                                                   2
                                                
                                             
                                             
                                                (
                                                1
                                                +
                                                o
                                                (
                                                1
                                                )
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        

From (A.1) it follows that 
                              
                                 
                                    
                                       
                                          λ
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                    ,
                                    k
                                 
                              
                              =
                              0
                           , 
                              i
                              =
                              
                                 
                                    rank
                                 
                                 
                                    1
                                    :
                                    k
                                 
                              
                              
                                 (
                                 X
                                 )
                              
                              +
                              1
                              ,
                              …
                              ,
                              
                                 
                                    P
                                 
                                 
                                    k
                                 
                              
                           , and therefore
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ℓ
                                                
                                                
                                                   ¯
                                                
                                             
                                          
                                          
                                             i
                                             ,
                                             k
                                          
                                       
                                       
                                          
                                             σ
                                          
                                          
                                             2
                                          
                                       
                                    
                                    =
                                    1
                                    +
                                    O
                                    
                                       (
                                       
                                          
                                             
                                                log
                                                ⁡
                                                log
                                                ⁡
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                       )
                                    
                                    ,
                                    
                                    i
                                    =
                                    r
                                    +
                                    1
                                    ,
                                    …
                                    ,
                                    
                                       
                                          P
                                       
                                       
                                          k
                                       
                                    
                                 
                              
                            which, when being substituted into (A.11), yields
                              
                                 (A.12)
                                 
                                    G
                                    (
                                    r
                                    )
                                    =
                                    O
                                    
                                       (
                                       
                                          
                                             log
                                             ⁡
                                             log
                                             ⁡
                                             
                                                
                                                   Q
                                                
                                                
                                                   k
                                                
                                             
                                          
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                             
                                          
                                       
                                       )
                                    
                                    
                                    
                                       a
                                       .
                                       s
                                       .
                                    
                                    
                                    as 
                                    
                                    Q
                                    →
                                    +
                                    ∞
                                    .
                                 
                              
                           
                        

Substituting (A.9) and (A.12) in (A.4a), and recalling that as 
                              Q
                              →
                              +
                              ∞
                           , 
                              log
                              ⁡
                              log
                              ⁡
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                              /
                              log
                              ⁡
                              
                                 
                                    Q
                                 
                                 
                                    k
                                 
                              
                              →
                              0
                           , we arrive at (A.3). This completes the proof.  □

We note that from the above proof it follows that replacing 
                        
                           1
                           2
                        
                        log
                        ⁡
                        
                           
                              Q
                           
                           
                              k
                           
                        
                      in the last term on the RHS of (32b) with any 
                        f
                        (
                        
                           
                              Q
                           
                           
                              k
                           
                        
                        )
                      that satisfies
                        
                           (A.13)
                           
                              
                                 
                                    log
                                    ⁡
                                    
                                       (
                                       log
                                       ⁡
                                       
                                          (
                                          
                                             
                                                Q
                                             
                                             
                                                k
                                             
                                          
                                          )
                                       
                                       )
                                    
                                 
                                 
                                    f
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                              
                              →
                              0
                               and 
                              
                                 
                                    f
                                    (
                                    
                                       
                                          Q
                                       
                                       
                                          k
                                       
                                    
                                    )
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       k
                                    
                                 
                              
                              →
                              0
                           
                        
                      yields a consistent estimator as well.

Supplementary material related to this article can be found online at http://dx.doi.org/10.1016/j.dsp.2016.01.003.

The following is the Supplementary material related to this article.
                        
                           MMC 1
                           
                              Comparison of the generalized N-D MDL and existing detection algorithms in terms of probability of correct detection and computational time.
                           
                           
                        
                     
                     
                        
                           MMC 2
                           
                              MATLAB codes of the generalized N-D MDL and existing detection algorithms in Section 5. Main functions: main.m, main_histogram.m and main_computational_complexity.m. main.m: Comparison of various detection algorithms in terms of probability of correct detection for different SNRs; main_histogram.m: Comparison of various detection algorithms in terms of histogram of estimated number of signals at a specific SNR; main_computational_complexity.m: Comparison of various detection algorithms in terms of computational time. The folder “algorithms” contains MATLAB implementation of all detection algorithms, and the simulation results are stored in the folder “matfile” as .mat files.
                           
                           
                        
                     
                  

@&#REFERENCES@&#

