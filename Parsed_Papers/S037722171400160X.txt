@&#MAIN-TITLE@&#An evaluation of semidefinite programming based approaches for discrete lot-sizing problems

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We study a lot-sizing problem with sequence-dependent changeover costs and times.


                        
                        
                           
                           This problem is formulated as a quadratically constrained quadratic binary program.


                        
                        
                           
                           We compute lower bounds using a semidefinite rather than a linear relaxation.


                        
                        
                           
                           Comparison with the best known linear relaxations shows a significant improvement.


                        
                        
                           
                           The SDP relaxation provides the optimal integer value for 83% of the small-size instances.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Manufacturing

Discrete lot-sizing and scheduling problem

Sequence-dependent changeover costs and times

Quadratically constrained quadratic binary programming

Semidefinite relaxation

Cutting planes

@&#ABSTRACT@&#


               
               
                  The present work is intended as a first step towards applying semidefinite programming models and tools to discrete lot-sizing problems including sequence-dependent changeover costs and times. Such problems can be formulated as quadratically constrained quadratic binary programs. We investigate several semidefinite relaxations by combining known reformulation techniques recently proposed for generic quadratic binary problems with problem-specific strengthening procedures developed for lot-sizing problems. Our computational results show that the semidefinite relaxations consistently provide lower bounds of significantly improved quality as compared with those provided by the best previously published linear relaxations. In particular, the gap between the semidefinite relaxation and the optimal integer solution value can be closed for a significant proportion of the small-size instances, thus avoiding to resort to a tree search procedure. The reported computation times are significant. However improvements in SDP technology can still be expected in the future, making SDP based approaches to discrete lot-sizing more competitive.
               
            

@&#INTRODUCTION@&#

Capacitated lot-sizing arises in industrial production planning whenever changeover operations such as preheating, tool changing or cleaning are required between production runs of different products on a machine. The amount of the related changeover costs usually does not depend on the number of products processed after the changeover. Thus, to minimize changeover costs, production should be run using large lot sizes. However, this generates inventory holding costs as the production cannot be synchronized with the actual demand pattern: products must be held in inventory between the time they are produced and the time they are used to satisfy customer demand. The objective of lot-sizing is thus to reach the best possible trade-off between changeover and inventory holding costs while taking into account both the customer demand satisfaction and the technical limitations of the production system.

An early attempt at modelling this trade-off can be found in Wagner and Whitin (1958): the authors consider the problem of planning production for a single product on a single resource with an unlimited production capacity. Since this seminal work, a large part of the research on lot-sizing problems has focused on modelling operational aspects in more detail to answer the growing industry need to solve more realistic and complex production planning problems. An overview of recent developments in the field of modelling industrial extensions of lot-sizing problems is provided in Jans and Degraeve (2008).

In the present paper, we focus on one of the variants of lot-sizing problems mentioned in Jans and Degraeve (2008), namely the multi-product single-resource discrete lot-sizing and scheduling problem or DLSP. As defined in Fleischmann (1990) and Jans and Degraeve (2008), several key assumptions are used in the DLSP to model the production planning problem:
                        
                           •
                           A set of products is to be produced on a single capacitated production resource.

A finite time horizon subdivided into discrete periods is used to plan production.

Demand for products is time-varying (i.e. dynamic) and deterministically known.

At most one product can be produced per period (small bucket model) and the facility processes either one product at full capacity or is completely idle (discrete or all-or-nothing production policy).

Costs to be minimized are the inventory holding costs and the changeover costs.

In the DLSP, it is assumed that a changeover between two production runs for different products results in a changeover cost and/or a changeover time. Changeover costs and times can depend either on the next product only (sequence-independent case) or on the sequence of products (sequence-dependent case). Significant changeover times which consume scarce production capacity tend to further complicate the problem. We consider here the DLSP with sequence-dependent changeover costs and times (denoted DLSPSD in what follows) and assume that the changeover times are expressed as integer numbers of planning periods and satisfy the triangular inequality.

Sequence-dependent changeover costs and times are mentioned in Jans and Degraeve (2008) as one of the relevant operational aspects to be incorporated into lot-sizing models. Moreover, a significant number of real-life lot-sizing problems involving sequence-dependent changeover costs and times have been recently reported in the academic literature: see among others (Dastidar & Nagi, 2005) for an injection moulding process, Silva and Magalhaes (2006) for a textile fibre industry or (Ferreira, Clark, Almada-Lobo, & Morabito, 2012) for soft drink production.

A wide variety of solution techniques from the Operations Research field have been proposed to solve lot-sizing problems: the reader is referred to (Buschkühl, Sahling, Helber, & Tempelmeier, 2010; Jans & Degraeve, 2007) for recent reviews on the corresponding literature. The present paper belongs to the line of research dealing with exact solution approaches, i.e. aiming at providing guaranteed optimal solutions for the problem. A large amount of existing solution techniques in this area consists in formulating the problem as a mixed-integer linear program (MILP) and in relying on a Branch & Bound type procedure to solve the obtained MILP. However the efficiency of such a procedure strongly depends on the quality of the lower bounds used to evaluate the nodes of the search tree. Much research has been devoted to the polyhedral study of lot-sizing problems and tight MILP formulations are now available for many variants of lot-sizing problems: see e.g. (Pochet & Wolsey, 2006) for a general overview of the related literature and (Belvaux & Wolsey, 2001; Eppen & Martin, 1987; Gicquel, Minoux, & Dallery, 2009; van Eijl & van Hoesel, 1997) for contributions focusing specifically on the DLSP.

Nevertheless, even if substantial improvements of the lower bounds can be obtained by using these MILP strengthening techniques, there are still cases where the obtained linear reformulation of the DLSPSD provides lower bounds of rather weak quality (see e.g. the numerical results reported in Gicquel et al. (2009)). These difficulties thus motivate the study of more powerful formulations for the problem. One such possibility consists in using a semidefinite reformulation of the problem rather than the standard linear reformulation used in MILP-based solution approaches.

Semidefinite programming (SDP) is a recent area of mathematical programming which can broadly be described as the extension of linear programming from the space of real vectors to the space of symmetric matrices: variables of the optimization problem are semidefinite positive matrices instead of positive real vectors. Since the seminal papers (Goemans & Williamson, 1995; Lovàsz & Schrijver, 1991) were published, semidefinite programming and its use to solve quadratic optimization problems have attracted a keen interest among researchers. Thanks to this, there is now a rather good knowledge on how to efficiently reformulate a quadratic optimization problem into a semidefinite program (see e.g. Roupin, 2004). Semidefinite programming has thus proved succesful at providing tight bounds for some well known quadratic binary problems such as the quadratic knapsack problem or the quadratic assignment problem (see e.g. Helmberg, Rendl, & Weismantel, 2000; Povh & Rendl, 2009; Zhao, Kharisch, Rendl, & Wolkovicz, 1998). However, applications of semidefinite programming in the field of industrial production management are still scarce (see Anjos, Kennings, & Vannelli, 2005; Mhanna & Jabr, 2012; Skutella, 2001 for noticeable exceptions) and to the best of our knowledge, there is no previous attempt at using semidefinite programming to solve lot-sizing problems. The purpose of the present paper is thus to provide a first assessment of the potential of semidefinite programming based approaches to solve discrete lot-sizing problems.

The main contributions of the present paper are thus threefold. First we introduce a new quadratically constrained quadratic binary programming formulation for the DLSPSD. Second, we propose to compute lower bounds for the DLSPSD using a semidefinite reformulation of the problem rather than a standard linear reformulation. Finally we present a cutting-plane generation algorithm based on a semidefinite programming solver to tighten the initial semidefinite relaxation. The results of the computational experiments carried out on small to medium-size instances show that the proposed approach provides lower bounds of significantly improved quality as compared to those provided by the best previously published linear reformulations, especially for the instances featuring a product family structure. Furthermore, for a high proportion of the small-size instances, the residual gap between the semidefinite relaxation and the optimal integer solution value is entirely closed so that there would be no need to resort to a Branch & Bound procedure to obtain the optimal integer solution. However, due to the limitations of available state-of-the art semidefinite programming solvers, these tight lower bounds are obtained at the expense of significant computation times.

The paper is organized as follows. We introduce in Section 2 a quadratically constrained quadratic binary programming (QCQBP) formulation for the DLSPSD. We then explain in Section 3 how this QCQBP can be reformulated as a semidefinite program and how lower bounds can be obtained for the DLSPSD by semidefinite relaxation. To achieve this, we not only exploit reformulation and strengthening techniques recently proposed in the SDP literature for generic (0–1) quadratic binary problems but also use problem-specific information such as the polyhedral representation of single-product discrete lot-sizing problems. Section 4 is devoted to the description of the valid inequalities used to strengthen the initial semidefinite relaxation of the problem and to the presentation of the cutting-plane generation algorithm implemented to add these valid inequalities iteratively into the initial formulation. Some computational results involving a comparison with the best previously published MILP strengthening techniques are then presented in Section 5.

We first discuss a new formulation of the DLSPSD as a quadratically constrained quadratic binary (QCQBP) program. The sequence-dependent nature of the changeover costs namely leads to the introduction of a series of quadratic terms in the objective function. Moreover, inequalities involving quadratic terms are needed to ensure that the positive changeover times between different production runs for different products are respected.

We wish to plan production for a set of products denoted 
                           
                              p
                              =
                              1
                              ,
                              …
                              ,
                              P
                           
                         to be processed on a single production machine over a planning horizon involving 
                           
                              t
                              =
                              1
                              ,
                              …
                              ,
                              T
                           
                         periods. Product 
                           
                              p
                              =
                              0
                           
                         represents the idle state of the machine and period 
                           
                              t
                              =
                              0
                           
                         is used to describe the initial state of the production system.

Production capacity is assumed to be constant throughout the planning horizon. We can thus w.l.o.g. normalize the production capacity to one unit per period and apply a preprocessing step on the original demand matrix (see Fleischmann, 1990; Gicquel, Minoux, & Dallery, 2011) resulting in a demand matrix containing only 0/1 values. We denote 
                           
                              
                                 
                                    d
                                 
                                 
                                    pt
                                 
                              
                              ∈
                              {
                              0
                              ,
                              1
                              }
                           
                         the demand for product p in period 
                           
                              t
                              ,
                              
                              
                                 
                                    h
                                 
                                 
                                    p
                                 
                              
                           
                         the inventory holding cost per unit per period for product 
                           
                              p
                              ,
                              
                              
                                 
                                    S
                                 
                                 
                                    pq
                                 
                              
                           
                         the sequence-dependent changeover cost to be incurred whenever the resource setup state is changed from product p to product q and 
                           
                              
                                 
                                    Δ
                                 
                                 
                                    pq
                                 
                              
                           
                         the required sequence-dependent changeover time between a production run for product p and a production run for product q.

Using this notation, the DLSPSD can be seen as the problem of assigning at most one product to each period of the planning horizon while ensuring demand satisfaction and respect of required changeover durations.

We thus introduce the binary decision variables 
                           
                              
                                 
                                    y
                                 
                                 
                                    pt
                                 
                              
                           
                         where 
                           
                              
                                 
                                    y
                                 
                                 
                                    pt
                                 
                              
                              =
                              1
                           
                         if product p is assigned to period t and 0 otherwise, and 
                           
                              
                                 
                                    ν
                                 
                                 
                                    t
                                 
                              
                           
                         where 
                           
                              
                                 
                                    ν
                                 
                                 
                                    t
                                 
                              
                              =
                              1
                           
                         if the resource is undergoing a transition between production runs at period t and 0 otherwise. This leads to the following DLSPSD1 formulation.

The objective function (1) corresponds to the minimization of the inventory holding and changeover costs over the planning horizon. 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    τ
                                    =
                                    1
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    y
                                 
                                 
                                    p
                                    τ
                                 
                              
                              -
                              
                                 
                                    d
                                 
                                 
                                    p
                                    τ
                                 
                              
                              )
                           
                         is the inventory level of product p at the end of period t and the quadratic term 
                           
                              
                                 
                                    y
                                 
                                 
                                    p
                                    ,
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    q
                                    ,
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    +
                                    1
                                 
                              
                           
                         is equal to 1 if and only if the machine starts a changeover from product p to product q at the beginning of period 
                           
                              t
                              +
                              1
                           
                        . Constraints (2) impose that the cumulated demand over interval 
                           
                              [
                              1
                              ,
                              t
                              ]
                           
                         is satisfied by the cumulated production over the same time interval. Constraints (3) ensure that, in each period, the resource is either producing a single product or undergoing a changeover between two production runs. Constraints (4) and (5) impose that the requested changeover times between production runs are respected. Thus, equalities (4) guarantee that product p can be produced in period t if and only if a changeover from p to another product q (possibly 
                           
                              q
                              =
                              p
                           
                        ) takes place at the beginning of period 
                           
                              t
                              +
                              1
                           
                        . Similarly, equalities (5) guarantee that product q can be produced in period t if and only if a changeover from another product p (possibly 
                           
                              p
                              =
                              q
                           
                        ) to product q begins early enough (i.e. in period 
                           
                              t
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    pq
                                 
                              
                           
                        ) to be finished at the beginning of period t. 
                           
                              
                                 
                                    Π
                                 
                                 
                                    p
                                    ,
                                    t
                                 
                                 
                                    start
                                 
                              
                              =
                              {
                              q
                              =
                              0
                              ,
                              …
                              ,
                              P
                              
                              s
                              .
                              t
                              .
                              
                              t
                              +
                              
                                 
                                    Δ
                                 
                                 
                                    pq
                                 
                              
                              +
                              1
                              ⩽
                              T
                              }
                           
                         is defined as the set of products towards which it is possible to start a changeover from product p at the beginning of period 
                           
                              t
                              +
                              1
                           
                        . Similarly, 
                           
                              
                                 
                                    Π
                                 
                                 
                                    q
                                    ,
                                    t
                                 
                                 
                                    end
                                 
                              
                              =
                              {
                              p
                              =
                              0
                              ,
                              …
                              ,
                              P
                              
                              s
                              .
                              t
                              .
                              
                              t
                              -
                              
                                 
                                    Δ
                                 
                                 
                                    pq
                                 
                              
                              -
                              1
                              ⩾
                              0
                              }
                           
                         is the set of products from which a changeover to product q ending at the beginning of period t can be done.
                           
                              (1)
                              
                                 
                                    
                                       
                                       
                                          
                                             (
                                             DLSPSD
                                             1
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Z
                                                
                                                
                                                   DLSPSD
                                                
                                             
                                             =
                                             min
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   y
                                                
                                                
                                                   p
                                                   τ
                                                
                                             
                                             -
                                             
                                                
                                                   d
                                                
                                                
                                                   p
                                                   τ
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      ,
                                                      q
                                                      =
                                                      0
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   p
                                                   ,
                                                   q
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      0
                                                   
                                                   
                                                      T
                                                      -
                                                      
                                                         
                                                            Δ
                                                         
                                                         
                                                            pq
                                                         
                                                      
                                                      -
                                                      1
                                                   
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   pt
                                                
                                             
                                             
                                                
                                                   y
                                                
                                                
                                                   q
                                                   ,
                                                   t
                                                   +
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         pq
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          1
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       τ
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          1
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       p
                                       τ
                                    
                                 
                                 
                                 ∀
                                 p
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (3)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          =
                                          0
                                       
                                       
                                          P
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       pt
                                    
                                 
                                 +
                                 
                                    
                                       ν
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (4)
                              
                                 
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          
                                             
                                                Π
                                             
                                             
                                                p
                                                ,
                                                t
                                             
                                             
                                                start
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       q
                                       ,
                                       t
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             pq
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 
                                 ∀
                                 p
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                 
                                    
                                       y
                                    
                                    
                                       q
                                       ,
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                Π
                                             
                                             
                                                q
                                                ,
                                                t
                                             
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       p
                                       ,
                                       t
                                       -
                                       
                                          
                                             Δ
                                          
                                          
                                             pq
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       y
                                    
                                    
                                       q
                                       ,
                                       t
                                    
                                 
                                 
                                 ∀
                                 q
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                 
                                    
                                       y
                                    
                                    
                                       pt
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 p
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 t
                              
                           
                        Formulation (DLSPSD1) can be seen as the quadratic counterpart of the MILP formulation proposed for the DLSPSD in Gicquel et al. (2009). Namely, introducing the so-called changeover variables defined as 
                           
                              
                                 
                                    w
                                 
                                 
                                    pq
                                    ,
                                    t
                                    +
                                    1
                                 
                              
                              =
                              
                                 
                                    y
                                 
                                 
                                    p
                                    ,
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    q
                                    ,
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    +
                                    1
                                 
                              
                           
                         enables us to linearize the proposed QCQBP formulation and leads to the formulation discussed in Gicquel et al. (2009). We would like to point out that this can only be done if the changeover times satisfy the triangular inequality. Otherwise, we may have situations where 
                           
                              
                                 
                                    y
                                 
                                 
                                    p
                                    ,
                                    t
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    q
                                    ,
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    +
                                    1
                                 
                              
                              =
                              1
                           
                         while no changeover from product p to product q starts at the beginning of period 
                           
                              t
                              +
                              1
                           
                         (i.e. 
                           
                              
                                 
                                    w
                                 
                                 
                                    pq
                                    ,
                                    t
                                    +
                                    1
                                 
                              
                              =
                              0
                           
                        ). To the best of our knowledge, this is the first time such a QCQBP formulation is proposed for the DLSPSD.

Note that, in case all changeover times are equal to zero, transition variables 
                           
                              
                                 
                                    ν
                                 
                                 
                                    t
                                 
                              
                           
                         are not needed in the formulation, capacity constraints (3) are reformulated as 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    p
                                    =
                                    0
                                 
                                 
                                    P
                                 
                              
                              
                                 
                                    y
                                 
                                 
                                    pt
                                 
                              
                              =
                              1
                           
                         and changeover time constraints (4) and (5) are removed from the formulation.

In what follows, to derive a semidefinite relaxation of the DSLPSD, we intend to apply on the demand satisfaction constraints a reformulation technique proposed by Helmberg (2000) and Lemarechal and Oustry (1999) for linear knapsack constraints. However, this reformulation technique requires that all coefficients in the knapsack constraints are positive. This is why we carry out a change of decision variables by replacing each binary variable 
                           
                              
                                 
                                    y
                                 
                                 
                                    pt
                                 
                              
                           
                         by its complementary variable 
                           
                              
                                 
                                    z
                                 
                                 
                                    pt
                                 
                              
                              =
                              1
                              -
                              
                                 
                                    y
                                 
                                 
                                    pt
                                 
                              
                           
                        .

We thus introduce the binary decision variables 
                           
                              
                                 
                                    z
                                 
                                 
                                    pt
                                 
                              
                           
                         where 
                           
                              
                                 
                                    z
                                 
                                 
                                    pt
                                 
                              
                              =
                              1
                           
                         if product p is not assigned to period t and 0 otherwise. This leads to the following DLSPSD2 formulation of the DLSPSD which involves a series of linear knapsack constraints with positive coefficients to model the customer demand satisfaction.
                           
                              (8)
                              
                                 
                                    
                                       
                                       
                                          
                                             (
                                             DLSPSD
                                             2
                                             )
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                                
                                                   Z
                                                
                                                
                                                   DLSPSD
                                                
                                             
                                             =
                                             min
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                             
                                                
                                                   h
                                                
                                                
                                                   p
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   p
                                                   τ
                                                
                                             
                                             -
                                             
                                                
                                                   d
                                                
                                                
                                                   p
                                                   τ
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      ,
                                                      q
                                                      =
                                                      0
                                                   
                                                   
                                                      P
                                                   
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   p
                                                   ,
                                                   q
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      0
                                                   
                                                   
                                                      T
                                                      -
                                                      
                                                         
                                                            Δ
                                                         
                                                         
                                                            pq
                                                         
                                                      
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   pt
                                                
                                             
                                             )
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   q
                                                   ,
                                                   t
                                                   +
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         pq
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          1
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       τ
                                    
                                 
                                 ⩽
                                 t
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          =
                                          1
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       d
                                    
                                    
                                       p
                                       τ
                                    
                                 
                                 
                                 ∀
                                 p
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          =
                                          0
                                       
                                       
                                          P
                                       
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       pt
                                    
                                 
                                 -
                                 
                                    
                                       ν
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 P
                                 
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          
                                             
                                                Π
                                             
                                             
                                                p
                                                ,
                                                t
                                             
                                             
                                                start
                                             
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       q
                                       ,
                                       t
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             pq
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       q
                                       ,
                                       t
                                       +
                                       
                                          
                                             Δ
                                          
                                          
                                             pq
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 )
                                 =
                                 |
                                 
                                    
                                       Π
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                    
                                       start
                                    
                                 
                                 |
                                 -
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                 
                                 
                                 ∀
                                 p
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          p
                                          ∈
                                          
                                             
                                                Π
                                             
                                             
                                                q
                                                ,
                                                t
                                             
                                             
                                                end
                                             
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       t
                                       -
                                       
                                          
                                             Δ
                                          
                                          
                                             pq
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       z
                                    
                                    
                                       q
                                       ,
                                       t
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       t
                                       -
                                       
                                          
                                             Δ
                                          
                                          
                                             pq
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       q
                                       ,
                                       t
                                    
                                 
                                 )
                                 =
                                 |
                                 
                                    
                                       Π
                                    
                                    
                                       end
                                    
                                 
                                 q
                                 ,
                                 t
                                 |
                                 -
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       q
                                       ,
                                       t
                                    
                                 
                                 
                                 ∀
                                 q
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                 
                                    
                                       z
                                    
                                    
                                       pt
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 p
                                 ,
                                 ∀
                                 t
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                 
                                    
                                       ν
                                    
                                    
                                       t
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 
                                 ∀
                                 t
                              
                           
                        The objective function (8) corresponds to the minimization of the inventory holding and changeover costs over the planning horizon. Constraints (9) limit the number of non-productive periods for product p over interval 
                           
                              [
                              1
                              ,
                              t
                              ]
                           
                         so as to garantee that there are enough productive periods left to satisfy the cumulated demand for this product over interval 
                           
                              [
                              1
                              ,
                              t
                              ]
                           
                        . Constraints (10) ensure that, in case the resource is undergoing a changeover in period t, then none of the 
                           
                              P
                              +
                              1
                           
                         products involved in the production planning problem can be produced, and that in case there is no changeover during period 
                           
                              t
                              ,
                              
                              P
                           
                         out of the 
                           
                              P
                              +
                              1
                           
                         products are not produced. Quadratic equalities (11) and (12) garantee that the imposed duration of changeovers between production runs is respected.

As mentioned in Section 2.1, the current state of the art to solve the DLSPSD is to carry out a linearization of formulation DLSPSD1 by introducing linearization variables 
                        
                           
                              
                                 w
                              
                              
                                 pqt
                              
                           
                        
                      and linking these variables to the variables 
                        
                           
                              
                                 y
                              
                              
                                 pt
                              
                           
                        
                      using a so-called flow formulation of the changeovers (see among others Belvaux & Wolsey (2001) and Gicquel et al. (2009)). The obtained linear reformulation can then be strengthened by using the valid inequalities proposed in Gicquel et al. (2009).

In what follows, we investigate another way of solving the problem which does not rely on a linearization of the quadratic formulation but rather uses a semidefinite reformulation.

We first introduce some useful notation and definitions. We refer the reader to the survey provided in Helmberg (2002) for a more comprehensive introduction to the field of semidefinite programming.

We denote 
                           
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                           
                         the set of symmetric matrices of size n. The standard scalar product between two matrices A and B in 
                           
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                           
                         is defined as:
                           
                              
                                 〈
                                 A
                                 ,
                                 B
                                 〉
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       ij
                                    
                                 
                                 
                                    
                                       B
                                    
                                    
                                       ij
                                    
                                 
                                 .
                              
                           
                        
                        
                           
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                         denotes the unit matrix of size 
                           
                              n
                              ,
                              e
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         is the vector of all ones and 
                           
                              
                                 
                                    e
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                         is the ith unit vector. We denote 
                           
                              diag
                              (
                              A
                              )
                           
                         the vector containing the main diagonal of a square matrix A and 
                           
                              Diag
                              (
                              a
                              )
                              =
                              
                                 
                                    a
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    I
                                 
                                 
                                    n
                                 
                              
                           
                         the 
                           
                              n
                              ×
                              n
                           
                         diagonal matrix formed from vector 
                           
                              a
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                 
                              
                           
                        .

A matrix 
                           
                              X
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                           
                         is said to be positive semidefinite if and only if all its eigenvalues are non-negative: we write it 
                           
                              X
                              
                              ⪰
                              
                              0
                           
                        . The set of positive semidefinite matrices is denoted 
                           
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                              ⊂
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                              
                           
                        .

As explained in Helmberg (2002), semidefinite programming is linear programming over the cone of positive semidefinite matrices 
                           
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                           
                        . A semidefinite program thus involves a matrix variable 
                           
                              X
                              ∈
                              
                                 
                                    S
                                 
                                 
                                    n
                                 
                                 
                                    +
                                 
                              
                           
                         and deals with the maximization of a linear function of X subject to a series of constraints whose expression are also linear with respect to X. Symmetric matrices 
                           
                              C
                              ,
                              
                                 
                                    A
                                 
                                 
                                    1
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    A
                                 
                                 
                                    M
                                 
                              
                           
                         are used to formulate the objective function and the technical constraints. The non-negativity constraints on the vector variable used in linear programming are replaced by semidefiniteness constraints on the matrix variable.

This leads to the following standard formulation for a semidefinite program:
                           
                              (15)
                              
                                 Z
                                 =
                                 max
                                 〈
                                 C
                                 ,
                                 X
                                 〉
                              
                           
                        
                        
                           
                              (16)
                              
                                 〈
                                 
                                    
                                       A
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 X
                                 〉
                                 ⩽
                                 
                                    
                                       b
                                    
                                    
                                       m
                                    
                                 
                                 ,
                                 
                                 ∀
                                 m
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 M
                              
                           
                        
                        
                           
                              (17)
                              
                                 X
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                    
                                       +
                                    
                                 
                              
                           
                        Semidefinite programs are convex optimization problems which can be solved either by interior-point algorithms (see e.g. Benson, Ye, & Zhang, 2000) or by spectral bundle methods (see e.g. Helmberg & Rendl, 2000).

We now explain how a semidefinite relaxation can be derived from the QCQBP formulation of the DLSPSD. To carry out this reformulation, we rely on reformulation techniques recently developped for generic 0–1 quadratic programs (see e.g. Helmberg, 2000; Lovàsz & Schrijver, 1991; Poljak, Rendl, & Wolkowicz, 1995). Moreover, as pointed out by several authors (Helmberg et al., 2000; Roupin, 2004), semidefinite relaxations of significantly improved quality can be obtained by applying some specific pretreatments to the linear (equality or inequality) constraints of the original QCQBP: in what follows, we exploit this knowledge to improve the quality of the bounds provided by the semidefinite relaxation of the DLSPSD. One of these pretreatments requires that linear knapsack inequality constraints involve only non-negative coefficients: this is why we start from formulation DLSPSD2 (instead of formulation DLSPSD1) to derive the semidefinite relaxation of the DLSPSD.

The first step of the reformulation consists in lifting the problem from the space of real vectors to the higher dimensional space of the symmetric matrices.

Let 
                              
                                 n
                                 =
                                 (
                                 P
                                 +
                                 2
                                 )
                                 T
                              
                           .

We first define the vector 
                              
                                 x
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                    
                                 
                              
                           :
                              
                                 
                                    x
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                z
                                             
                                             
                                                01
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                0
                                                T
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                pt
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                PT
                                             
                                          
                                          ,
                                          
                                             
                                                ν
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                ν
                                             
                                             
                                                T
                                             
                                          
                                          ]
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       
                                          [
                                          
                                             
                                                x
                                             
                                             
                                                i
                                             
                                          
                                          ]
                                       
                                       
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                       
                                    
                                 
                              
                           and introduce the following matrix 
                              
                                 X
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           .
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           We would like to point out here that each possible quadratic term 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       x
                                    
                                    
                                       j
                                    
                                 
                              
                            now corresponds to a coefficient 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                 
                              
                            of matrix X. Thus, given a quadratic expression involving vector x such as 
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       ∼
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       t
                                    
                                 
                                 x
                              
                           , we can obtain an equivalent linear expression involving matrix X, i.e. 
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       Q
                                    
                                    
                                       ∼
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       q
                                    
                                    
                                       t
                                    
                                 
                                 x
                              
                            = 
                              
                                 〈
                                 Q
                                 ,
                                 X
                                 〉
                              
                            where 
                              
                                 Q
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                            is defined as:
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           The second step of the reformulation consists in reformulating the initial QCQBP formulation as a linear optimization problem in space 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           .

The reformulation of the objective function (8) is straightforward. Namely, (8) is a quadratic expression of the form 
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       ∼
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       c
                                    
                                    
                                       t
                                    
                                 
                                 x
                              
                            and can therefore be reformulated as 
                              
                                 min
                                 〈
                                 C
                                 ,
                                 X
                                 〉
                              
                            where C is defined using matrix 
                              
                                 
                                    
                                       C
                                    
                                    
                                       ∼
                                    
                                 
                              
                            and vector c as explained above.

We now consider the reformulation of the customer demand satisfaction constraints (9). These constraints can be seen as linear knapsack constraints of the form 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 ⩽
                                 b
                              
                            with 
                              
                                 
                                    
                                       a
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 [
                                 1
                                 ,
                                 n
                                 ]
                              
                           . A straightforward way of reformulating each of these linear inequalities would be to use a so-called ”diagonal representation” (see Helmberg et al., 2000): we add a zero coefficient to vector a to obtain a vector 
                              
                                 [
                                 0
                                 ,
                                 a
                                 ]
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           , introduce the diagonal matrix 
                              
                                 Diag
                                 (
                                 [
                                 0
                                 ,
                                 a
                                 ]
                                 )
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                            and reformulate the knapsack constraint as: 
                              
                                 〈
                                 Diag
                                 (
                                 [
                                 0
                                 ,
                                 a
                                 ]
                                 )
                                 ,
                                 X
                                 〉
                                 ⩽
                                 b
                              
                           . However a better semidefinite relaxation can be obtained by applying a pretreatment of these constraints before reformulating them in the SDP. This pretreatment consists in multiplying both sides of the linear inequality 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 ⩽
                                 b
                              
                            by 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 x
                              
                            (see Helmberg, 2000; Lemarechal & Oustry, 1999; Roupin, 2004). This can be done only if 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 x
                                 ⩾
                                 0
                              
                           , i.e. if all coefficients of vector a are non-negative. We obtain the quadratic inequality 
                              
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       aa
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       ba
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 ⩾
                                 0
                              
                           , which can be reformulated 
                              
                                 〈
                                 A
                                 ,
                                 X
                                 〉
                                 ⩾
                                 0
                              
                            where A is defined using matrix 
                              
                                 
                                    
                                       aa
                                    
                                    
                                       t
                                    
                                 
                              
                            and vector 
                              
                                 
                                    
                                       ba
                                    
                                    
                                       t
                                    
                                 
                              
                            as explained above. We carry out this reformulation on each of the PT customer demand satisfaction constraints (9), which leads to a series of constraints: 
                              
                                 〈
                                 
                                    
                                       
                                          
                                             A
                                          
                                          
                                             ∼
                                          
                                       
                                    
                                    
                                       pt
                                    
                                 
                                 ,
                                 
                                    
                                       X
                                    
                                    
                                       ∼
                                    
                                 
                                 〉
                                 ⩾
                                 0
                                 ,
                                 ∀
                                 p
                                 ,
                                 
                                 ∀
                                 t
                              
                            in the semidefinite reformulation of DLSPSD2.

We then deal with the reformulation of the resource capacity constraints (10). These are linear equality constraints of the form 
                              
                                 
                                    
                                       a
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 =
                                 b
                              
                           . Following the recommandations found in Poljak et al. (1995) and Roupin (2004), we first reformulate each of them using the ”diagonal representation” 
                              
                                 〈
                                 Diag
                                 (
                                 [
                                 0
                                 ,
                                 a
                                 ]
                                 )
                                 ,
                                 X
                                 〉
                                 =
                                 b
                              
                           . We then seek to improve the reformulation through the use of a ”square representation” of these linear equalities. This is done by squaring both sides of the equality. This leads to quadratic equalities of the form 
                              
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       aa
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 =
                                 
                                    
                                       b
                                    
                                    
                                       2
                                    
                                 
                              
                            which can then be reformulated in space 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           . We thus obtain 
                              
                                 2
                                 T
                              
                            equality constraints of the form: 
                              
                                 〈
                                 
                                    
                                       B
                                    
                                    
                                       t
                                    
                                    
                                       d
                                    
                                 
                                 ,
                                 X
                                 〉
                                 =
                                 P
                                 ,
                                 
                                 ∀
                                 t
                              
                            and 
                              
                                 〈
                                 
                                    
                                       B
                                    
                                    
                                       t
                                    
                                    
                                       s
                                    
                                 
                                 ,
                                 X
                                 〉
                                 =
                                 
                                    
                                       P
                                    
                                    
                                       2
                                    
                                 
                                 ,
                                 
                                 ∀
                                 t
                              
                           .

Constraints (11) and (12) ensuring that changeover times between production runs for different products are respected are quadratic equalities of the form 
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ∼
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       t
                                    
                                 
                                 x
                                 =
                                 θ
                              
                            and can therefore be reformulated as 
                              
                                 〈
                                 F
                                 ,
                                 X
                                 〉
                                 =
                                 θ
                              
                            where matrix F is obtained from matrix 
                              
                                 
                                    
                                       F
                                    
                                    
                                       ∼
                                    
                                 
                              
                            and vector f as explained above. We carry out this reformulation on each of the 
                              
                                 2
                                 PT
                              
                            changeover times satisfaction constraints, wich leads to a series of constraints: 
                              
                                 〈
                                 
                                    
                                       F
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                    
                                       start
                                    
                                 
                                 ,
                                 X
                                 〉
                                 =
                                 |
                                 
                                    
                                       Π
                                    
                                    
                                       p
                                       ,
                                       t
                                    
                                    
                                       start
                                    
                                 
                                 |
                                 -
                                 1
                                 ,
                                 ∀
                                 p
                                 ,
                                 
                                 ∀
                                 t
                              
                            and 
                              
                                 〈
                                 
                                    
                                       F
                                    
                                    
                                       q
                                       ,
                                       t
                                    
                                    
                                       end
                                    
                                 
                                 ,
                                 X
                                 〉
                                 =
                                 |
                                 
                                    
                                       Π
                                    
                                    
                                       end
                                    
                                 
                                 q
                                 ,
                                 t
                                 |
                                 -
                                 1
                                 ,
                                 ∀
                                 q
                                 ,
                                 
                                 ∀
                                 t
                              
                            in the semidefinite reformulation of DLSPSD2.

We finally focus on the constraints (13) and (14) imposing the binary character of the decision variables. We note that 
                              
                                 x
                                 ∈
                                 
                                    
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                    
                                       n
                                    
                                 
                              
                            is equivalent to 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       2
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 [
                                 1
                                 ,
                                 n
                                 ]
                              
                           , i.e. to 
                              
                                 
                                    
                                       X
                                    
                                    
                                       ii
                                    
                                 
                                 -
                                 0.5
                                 
                                    
                                       X
                                    
                                    
                                       i
                                       0
                                    
                                 
                                 -
                                 0.5
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       i
                                    
                                 
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 [
                                 1
                                 ,
                                 n
                                 ]
                              
                           . This is enforced in the semidefinite reformulation by a series of constraints of the form 
                              
                                 〈
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 X
                                 〉
                                 =
                                 0
                              
                            where 
                              
                                 
                                    
                                       D
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                            is defined as:
                              
                                 
                                    
                                       
                                          
                                       .
                                 
                              
                           We thus obtain the following semidefinite reformulation of formulation DLSP2 in the space 
                              
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                           .
                              
                                 (18)
                                 
                                    
                                       
                                          
                                             
                                                (
                                                SDP
                                                )
                                             
                                          
                                          
                                             
                                                
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      DLDPSD
                                                   
                                                
                                                =
                                                min
                                                〈
                                                C
                                                ,
                                                X
                                                〉
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (19)
                                 
                                    〈
                                    
                                       
                                          A
                                       
                                       
                                          pt
                                       
                                    
                                    ,
                                    X
                                    〉
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    t
                                    ,
                                    ∀
                                    p
                                 
                              
                           
                           
                              
                                 (20)
                                 
                                    〈
                                    
                                       
                                          B
                                       
                                       
                                          t
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    P
                                    ,
                                    
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (21)
                                 
                                    〈
                                    
                                       
                                          B
                                       
                                       
                                          t
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (22)
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          t
                                       
                                       
                                          start
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    |
                                    
                                       
                                          Π
                                       
                                       
                                          p
                                          ,
                                          t
                                       
                                       
                                          start
                                       
                                    
                                    |
                                    -
                                    1
                                    
                                    ∀
                                    p
                                    ,
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (23)
                                 
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          q
                                          ,
                                          t
                                       
                                       
                                          end
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    |
                                    
                                       
                                          Π
                                       
                                       
                                          end
                                       
                                    
                                    q
                                    ,
                                    t
                                    |
                                    -
                                    1
                                    
                                    ∀
                                    q
                                    ,
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (24)
                                 
                                    〈
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    i
                                    ∈
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                              
                           
                           
                              
                                 (25)
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           In case all changeover times are equal to zero, the proposed reformulation of the problem can be adapted in a straightforward manner. As transition variables 
                              
                                 
                                    
                                       ν
                                    
                                    
                                       t
                                    
                                 
                              
                            are not introduced into the formulation, we define 
                              
                                 n
                                 =
                                 (
                                 P
                                 +
                                 1
                                 )
                                 T
                              
                            and 
                              
                                 x
                                 =
                                 [
                                 
                                    
                                       z
                                    
                                    
                                       01
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       0
                                       T
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       pt
                                    
                                 
                                 ,
                                 …
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       PT
                                    
                                 
                                 ]
                              
                           . Constraints (22) and (23) are not included in the formulation, the other constraints are reformulated as described above.

Problem (18)–(25) is equivalent to the initial QCQBP problem. However it cannot be solved as such due to the presence of the nonconvex constraint (25). We thus carry out a convex relaxation, i.e. we enlarge the feasible set of the problem to make it convex by dropping some of the constraints of the problem.

This convex relaxation can be explained as follows (see e.g. Helmberg et al., 2000).

We first note that:
                              
                                 
                                    
                                       
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                 
                              
                            is a 
                              
                                 (
                                 n
                                 +
                                 1
                                 )
                                 ×
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                            matrix where all coefficients are 0 except 
                              
                                 
                                    
                                       D
                                    
                                    
                                       0
                                    
                                    
                                       00
                                    
                                 
                                 =
                                 1
                              
                           .

We then relax the problem by dropping the rank one constraint. This leads to the formulation of a standard semidefinite program such as (15)–(17) which is a convex optimization problem solvable by available SDP solvers. However, as some constraints of the original problem have been removed, the corresponding optimal solution value will only provide a lower bound on the integer optimal solution value 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       DLSPSD
                                    
                                 
                              
                           . We denote it 
                              
                                 
                                    
                                       Z
                                    
                                    
                                       SDP
                                       0
                                    
                                 
                                 ⩽
                                 
                                    
                                       Z
                                    
                                    
                                       DLSPSD
                                    
                                 
                              
                           .

We thus obtain the following semidefinite program which provides an initial semidefinite relaxation of the DLSPSD.
                              
                                 (26)
                                 
                                    
                                       
                                          
                                          
                                             
                                                (
                                                SDP
                                                0
                                                )
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                
                                                   
                                                      Z
                                                   
                                                   
                                                      SDP
                                                      0
                                                   
                                                
                                                =
                                                min
                                                〈
                                                C
                                                ,
                                                X
                                                〉
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (27)
                                 
                                    
                                    〈
                                    
                                       
                                          A
                                       
                                       
                                          pt
                                       
                                    
                                    ,
                                    X
                                    〉
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    t
                                    ,
                                    ∀
                                    p
                                 
                              
                           
                           
                              
                                 (28)
                                 
                                    
                                    〈
                                    
                                       
                                          B
                                       
                                       
                                          t
                                       
                                       
                                          d
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    P
                                    ,
                                    
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (29)
                                 
                                    
                                    〈
                                    
                                       
                                          B
                                       
                                       
                                          t
                                       
                                       
                                          s
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    
                                       
                                          P
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (30)
                                 
                                    
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          p
                                          ,
                                          t
                                       
                                       
                                          start
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    |
                                    
                                       
                                          Π
                                       
                                       
                                          p
                                          ,
                                          t
                                       
                                       
                                          start
                                       
                                    
                                    |
                                    -
                                    1
                                    
                                    ∀
                                    p
                                    ,
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (31)
                                 
                                    
                                    〈
                                    
                                       
                                          F
                                       
                                       
                                          q
                                          ,
                                          t
                                       
                                       
                                          end
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    |
                                    
                                       
                                          Π
                                       
                                       
                                          end
                                       
                                    
                                    q
                                    ,
                                    t
                                    |
                                    -
                                    1
                                    
                                    ∀
                                    q
                                    ,
                                    ∀
                                    t
                                 
                              
                           
                           
                              
                                 (32)
                                 
                                    
                                    〈
                                    
                                       
                                          D
                                       
                                       
                                          i
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    0
                                    ,
                                    
                                    ∀
                                    i
                                    ∈
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                    〈
                                    
                                       
                                          D
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    X
                                    〉
                                    =
                                    1
                                 
                              
                           
                           
                              
                                 (34)
                                 
                                    
                                    X
                                    
                                    ⪰
                                    
                                    0
                                 
                              
                           
                        

As explained above, solving formulation SDP0 provides an initial lower bound 
                           
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    0
                                 
                              
                           
                         of the optimal integer value 
                           
                              
                                 
                                    Z
                                 
                                 
                                    DSDP
                                 
                              
                           
                         of the DLSPDP. This lower bound can be improved by strengthening the initial semidefinite relaxation of the DLSPSD. In what follows, we propose to achieve this by using five families of valid inequalities: one family exploiting some specific features of the problem under study and four families which have been proposed to strengthen semidefinite relaxations of generic quadratic binary problems.

We first consider a family of valid inequalities proposed for the single-product DLSP with sequence-dependent changeover times in Gicquel et al. (2009). These valid inequalities can be seen as an extension of the valid inequalities developed by van Eijl and van Hoesel (1997) for the case whithout changeover times. They are shown in Gicquel et al. (2009) to be rather efficient at strengthening the continuous relaxation of the linear reformulation of the DLSPSD.

We introduce some additional notation to express these constraints:
                              
                                 •
                                 
                                    
                                       
                                          
                                             
                                                d
                                             
                                             
                                                p
                                                ,
                                                t
                                                ,
                                                τ
                                             
                                          
                                       
                                    : cumulated demand for product p in the interval 
                                       
                                          {
                                          t
                                          ,
                                          …
                                          ,
                                          τ
                                          }
                                       
                                    .


                                    
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                p
                                                ,
                                                v
                                             
                                          
                                       
                                    : period where the 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                th
                                             
                                          
                                       
                                     unit demand for product p occurs. Note that 
                                       
                                          
                                             
                                                θ
                                             
                                             
                                                p
                                                ,
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      p
                                                      ,
                                                      1
                                                      ,
                                                      t
                                                   
                                                
                                                +
                                                v
                                             
                                          
                                       
                                     denotes the period in which the 
                                       
                                          
                                             
                                                v
                                             
                                             
                                                th
                                             
                                          
                                       
                                     positive demand for product p after period t occurs.

The following constraints are valid inequalities for the DLSPSD.
                              
                                 (35)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          p
                                          τ
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             =
                                             1
                                          
                                          
                                             t
                                          
                                       
                                    
                                    
                                       
                                          d
                                       
                                       
                                          p
                                          τ
                                       
                                    
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             v
                                             =
                                             1
                                          
                                          
                                             w
                                          
                                       
                                    
                                    
                                       
                                          
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   p
                                                   ,
                                                   t
                                                   +
                                                   v
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      =
                                                      t
                                                      +
                                                      v
                                                      +
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            θ
                                                         
                                                         
                                                            p
                                                            ,
                                                            
                                                               
                                                                  d
                                                               
                                                               
                                                                  p
                                                                  ,
                                                                  1
                                                                  ,
                                                                  t
                                                               
                                                            
                                                            +
                                                            v
                                                         
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      q
                                                      ∈
                                                      
                                                         
                                                            Π
                                                         
                                                         
                                                            p
                                                            ,
                                                            τ
                                                         
                                                         
                                                            end
                                                         
                                                      
                                                      ,
                                                      q
                                                      ≠
                                                      p
                                                   
                                                
                                             
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   q
                                                   ,
                                                   τ
                                                   -
                                                   
                                                      
                                                         Δ
                                                      
                                                      
                                                         qp
                                                      
                                                   
                                                   -
                                                   1
                                                
                                             
                                             )
                                             (
                                             1
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   p
                                                   ,
                                                   τ
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ⩾
                                    w
                                    
                                    ∀
                                    p
                                    ,
                                    
                                    ∀
                                    t
                                    ,
                                    ∀
                                    w
                                    ∈
                                    [
                                    1
                                    ,
                                    
                                       
                                          d
                                       
                                       
                                          p
                                          ,
                                          t
                                          +
                                          1
                                          ,
                                          T
                                       
                                    
                                    ]
                                 
                              
                           The idea underlying (35) is to make sure, that, at the end of period t, we will be capable of satisfying the forthcoming w unit demands for product p, either by relying on units of product p currently in inventory or by producing them on the resource within the time interval 
                              
                                 [
                                 t
                                 +
                                 1
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             p
                                             ,
                                             1
                                             ,
                                             t
                                          
                                       
                                       +
                                       w
                                    
                                 
                                 ]
                              
                           . The first term of the left hand side of inequalities (35) thus computes the inventory level of product p at the end of period t as the difference between the cumulated production and the cumulated demand for this product over the interval 
                              
                                 [
                                 1
                                 ,
                                 t
                                 ]
                              
                           . The second term computes the production capacity available for product p within interval 
                              
                                 [
                                 t
                                 +
                                 1
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             p
                                             ,
                                             1
                                             ,
                                             t
                                          
                                       
                                       +
                                       w
                                    
                                 
                                 ]
                              
                            by considering the resource setup states on these periods. Inequalities (35) thus state that the sum of these two terms (inventory+production capacity) should be large enough to satisfy the first w units of demand for product p occuring after period t.

We now explain in more detail how the production capacity available for product p within interval 
                              
                                 [
                                 t
                                 +
                                 1
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             p
                                             ,
                                             1
                                             ,
                                             t
                                          
                                       
                                       +
                                       w
                                    
                                 
                                 ]
                              
                            is computed. We first consider the case where 
                              
                                 w
                                 =
                                 1
                              
                           , i.e. the case where we focus on satisfying the first unit of demand for product p after period t. If the unit demand is to be produced in the interval 
                              
                                 [
                                 t
                                 +
                                 1
                                 ;
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             p
                                             ,
                                             1
                                             ,
                                             t
                                          
                                       
                                       +
                                       1
                                    
                                 
                                 ]
                              
                           , the resource either has to be setup for product p in period 
                              
                                 t
                                 +
                                 1
                              
                            (in which case the term 
                              
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       t
                                       +
                                       1
                                    
                                 
                              
                            is equal to one) or has to undergo a changeover from a product q to product p to allow production of product p in at least one of the periods 
                              
                                 t
                                 +
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       θ
                                    
                                    
                                       p
                                       ,
                                       
                                          
                                             d
                                          
                                          
                                             p
                                             ,
                                             1
                                             ,
                                             t
                                          
                                       
                                       +
                                       1
                                    
                                 
                              
                            (in which case at least one of the terms 
                              
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       q
                                       ,
                                       τ
                                       -
                                       
                                          
                                             Δ
                                          
                                          
                                             qp
                                          
                                       
                                       -
                                       1
                                    
                                 
                                 )
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       p
                                       ,
                                       τ
                                    
                                 
                                 )
                              
                            is equal to one). This reasoning can be generalized by a mathematical induction on w to take into account not only the first unit demand for product p after period t (
                              
                                 w
                                 =
                                 1
                              
                           ), but any possible number of unit demands (
                              
                                 w
                                 ∈
                                 [
                                 1
                                 ,
                                 
                                    
                                       d
                                    
                                    
                                       p
                                       ,
                                       t
                                       +
                                       1
                                       ,
                                       T
                                    
                                 
                                 ]
                              
                           ).

We now explain how some of the valid inequalities recently proposed for strengthening the semidefinite relaxation of generic quadratic binary programs can be used for computing tight lower bounds for the DLSPSD.

The first family of generic valid inequalities exploits the presence of implicit binary exclusion constraints implied by the resource capacity constraints (3) and changeover time satisfaction constraints (11) and (12). Namely, assigning a product p to a given period t is not compatible with assigning another product q to any period 
                              
                                 τ
                                 ∈
                                 [
                                 t
                                 ;
                                 t
                                 +
                                 
                                    
                                       Δ
                                    
                                    
                                       pq
                                    
                                 
                                 ]
                              
                           . This leads to the following valid equalities:
                              
                                 (36)
                                 
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          pt
                                       
                                    
                                    )
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          q
                                          τ
                                       
                                    
                                    )
                                    =
                                    0
                                    
                                    ∀
                                    p
                                    ,
                                    ∀
                                    q
                                    
                                    s
                                    .
                                    t
                                    .
                                    
                                    p
                                    
                                    ≠
                                    
                                    q
                                    ,
                                    
                                    ∀
                                    t
                                    ,
                                    ∀
                                    τ
                                    ∈
                                    [
                                    t
                                    ;
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    ]
                                 
                              
                           We also use two families of valid inequalities discussed among others in Helmberg et al. (2000) for the quadratic knapsack problem and in Roupin (2004) for general bivalent quadratic problems. These valid inequalities are obtained by multiplying each knapsack inequality of type (9) either by 
                              
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             qt
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                              
                            or by 
                              
                                 (
                                 1
                                 -
                                 
                                    
                                       z
                                    
                                    
                                       
                                          
                                             qt
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 )
                              
                           . This approach can be seen as a generalization of the reformulation method first proposed by Sherali and Adams (1990) to obtain strong relaxations for bivalent linear programs. We thus obtain:
                              
                                 (37)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             t
                                          
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          p
                                          τ
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             t
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   p
                                                   τ
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                    ∀
                                    q
                                    ,
                                    ∀
                                    t
                                    ,
                                    ∀
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             τ
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             t
                                          
                                       
                                    
                                    
                                       
                                          z
                                       
                                       
                                          p
                                          τ
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    ⩽
                                    
                                       
                                          
                                             t
                                             -
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      =
                                                      1
                                                      ,
                                                      …
                                                      ,
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   d
                                                
                                                
                                                   p
                                                   τ
                                                
                                             
                                          
                                       
                                    
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          q
                                          ,
                                          
                                             
                                                t
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                    ∀
                                    q
                                    ,
                                    ∀
                                    t
                                    ,
                                    ∀
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           We note here that a similar strengthening technique could have been applied on the linear equality constraints (10). However, the preliminary computational experiments we carried out showed that it neither lead to better lower bounds nor improve the overall computation time. This is why we do not include them in our strengthening procedure.

Finally, we use a family of simple valid inequalities which are part of the triangle inequalities used in computing semidefinite relaxation for unconstrained quadratic programs (see e.g. Helmberg et al., 2000). These are obtained by relying on the fact that we have:
                              
                                 (39)
                                 
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          pt
                                       
                                    
                                    )
                                    (
                                    1
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          
                                             
                                                qt
                                             
                                             
                                                ′
                                             
                                          
                                       
                                    
                                    )
                                    ⩾
                                    0
                                    ,
                                    
                                    ∀
                                    p
                                    ,
                                    ∀
                                    q
                                    ,
                                    ∀
                                    t
                                    ,
                                    ∀
                                    
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                           Valid inequalities (35)–(39) are quadratic constraints of the form 
                              
                                 
                                    
                                       
                                          
                                             x
                                          
                                          
                                             ̃
                                          
                                       
                                    
                                    
                                       t
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       ∼
                                    
                                 
                                 x
                                 +
                                 
                                    
                                       f
                                    
                                    
                                       t
                                    
                                 
                                 s
                                 ⩽
                                 g
                              
                           . We reformulate them in the semidefinite progam by introducing a matrix 
                              
                                 F
                                 ∈
                                 
                                    
                                       S
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                              
                            such that 
                              
                                 
                                    
                                       
                                    
                                 
                              
                            and add them to formulation SDP0 as 
                              
                                 〈
                                 F
                                 ,
                                 X
                                 〉
                                 ⩽
                                 g
                              
                           .

The number of valid inequalities (35)–(39) grows very fast with the problem size. It is therefore not possible to include all of them directly in the initial formulation SDP0. A cutting-plane generation algorithm is thus proposed in the next subsection to iteratively include a subset of these valid inequalities in formulation SDP0.

We use the following cutting-plane generation algorithm (CPA) to strengthen the initial semidefinite relaxation of the DLSPSD obtained by solving formulation SDP0.
                           Algorithm 1
                           (CPA)
                                 
                                    
                                 
                              
                           

Step 1 of algorithm (CPA) starts with the initial semidefinite relaxation (SDP0) of the problem. Our computational experiments showed that this initial formulation provides rather poor lower bounds. For some instances, we even have 
                           
                              
                                 
                                    Z
                                 
                                 
                                    sdp
                                    0
                                 
                              
                              ⩽
                              0
                           
                         which means that the gap between the lower bound provided by the semidefinite relaxation and the integer optimal solution value is larger than 100%. This is due among others to the fact that the coefficients of the variable matrix X violate a large proportion of the triangle inequalities (39). In particular, they do not comply with the subset of the triangle inequalities (39) for which 
                           
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              =
                              t
                              +
                              
                                 
                                    Δ
                                 
                                 
                                    pq
                                 
                              
                              +
                              1
                              :
                              
                              (
                              1
                              -
                              
                                 
                                    z
                                 
                                 
                                    pt
                                 
                              
                              )
                              (
                              1
                              -
                              
                                 
                                    z
                                 
                                 
                                    q
                                    ,
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    +
                                    1
                                 
                              
                              )
                              ⩾
                              0
                           
                         The left hand side of these inequalities corresponds to a term with a positive cost coefficient 
                           
                              
                                 
                                    S
                                 
                                 
                                    pq
                                 
                              
                           
                         in the objective function (8) of the problem. Thus, in case 
                           
                              
                                 
                                    X
                                 
                                 
                                    pT
                                    +
                                    t
                                    ,
                                    qT
                                    +
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    X
                                 
                                 
                                    1
                                    ,
                                    pT
                                    +
                                    t
                                 
                              
                              -
                              
                                 
                                    X
                                 
                                 
                                    1
                                    ,
                                    qT
                                    +
                                    t
                                    +
                                    
                                       
                                          Δ
                                       
                                       
                                          pq
                                       
                                    
                                    +
                                    1
                                 
                              
                              +
                              1
                              <
                              0
                           
                         in the current SDP solution, the corresponding term in the objective value takes a negative value, which decreases the quality of the obtained lower bound. This is why we add a priori to the initial formulation of the problem all valid inequalities of family (39) corresponding to 
                           
                              
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                              =
                              t
                              +
                              
                                 
                                    Δ
                                 
                                 
                                    pq
                                 
                              
                              +
                              1
                           
                         to improve the quality of the initial lower bound 
                           
                              
                                 
                                    Z
                                 
                                 
                                    sdp
                                    0
                                 
                              
                           
                         and reduce the number of iterations of the cutting-plane generation algorithm. Similarly, we add a priori all single-product valid inequalities (35) as this leads to an overall decrease in the number of cutting-plane generation iterations needed to strengthen the semidefinite relaxation.

At the end of step 1 of algorithm (CPA), we obtain a lower bound 
                           
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    1
                                 
                              
                           
                         of the optimal integer solution value 
                           
                              
                                 
                                    Z
                                 
                                 
                                    DSLP
                                 
                              
                           
                         of problem DSLPSD with 
                           
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    0
                                 
                              
                              ⩽
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    Z
                                 
                                 
                                    DSLP
                                 
                              
                           
                        .

Step 2 of algorithm (CPA) starts with removing the inequalities added in the formulation which are inactive for the current primal solution. Theoretically, the redundancy of a primal constraint should be indicaded by a zero dual variable. However, as mentioned e.g. in Engau (2012), interior-point algorithms terminate at approximate solutions that are still interior so that the complentary condition is never satisfied exactly and dual variables of redundant inequalities might take values significantly different from zero. This is why we choose to remove valid inequalities from the formulation using only the value of their primal slack variable.

Step 2 of algorithm (CPA) then goes on with the addition of valid inequalities which are violated by the current solution. In the numerical experiments presented in Section 5, we used 
                           
                              
                                 
                                    p
                                 
                                 
                                    1
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    2
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    3
                                 
                              
                              =
                              
                                 
                                    p
                                 
                                 
                                    4
                                 
                              
                              =
                              100
                              ,
                              
                              
                                 
                                    p
                                 
                                 
                                    5
                                 
                              
                              =
                              300
                           
                         and 
                           
                              minCuts
                              =
                              200
                           
                        . Namely, solving large semidefinite programs is computationally intensive and usually requires a rather large amount of computation time. During the cutting plane generation, we should thus avoid to repeatidly solve semidefinite programs differing from one another only by the addition of a small number of cuts. This is why we try to generate at each step a rather large number of violated cuts belonging to the different families of valid inequalities and, in any case, we prevent the algorithm from resolving the semidefinite program if less than minCuts cuts have been added to the formulation.

When algorithm (CPA) stops, we obtain a lower bound 
                           
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    2
                                 
                              
                           
                         of the optimal integer solution value 
                           
                              
                                 
                                    Z
                                 
                                 
                                    DSLP
                                 
                              
                           
                         of problem DSLPSD with 
                           
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    0
                                 
                              
                              ⩽
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    1
                                 
                              
                              ⩽
                              
                                 
                                    Z
                                 
                                 
                                    SDP
                                    2
                                 
                              
                              ⩽
                              
                                 
                                    Z
                                 
                                 
                                    DSLPSD
                                 
                              
                           
                        .

We now discuss the results of some computational experiments carried out to evaluate the quality of the lower bounds provided by the semidefinite relaxation of the DLSPSD discussed in Sections 3 and 4.

We randomly generated instances of the problem using a procedure similar to the one described in Salomon, Solomon, van Wassenhove, Dumas, and Dauzère-Pérès (1997) for the DLSP with sequence-dependent change-over costs and times. More precisely, the various instances tested have the following characteristics:
                           
                              •
                              
                                 Problem dimension. The problem dimension is represented by the number of products P and the number of periods T: we solved small to medium-size instances involving 4–6 products and 15–50 periods.


                                 Changeover times. We have experimented with problem instances without changeover times (sets A1–A11 and A1f–A11f) and problem instances with changeover times (sets B1–B9 and B1f–B9f). Among the instances with positive changeover times, instances of sets B1–B9 have a general changeover time structure where the changeover times are randomly generated from a discrete uniform 
                                    
                                       DU
                                       (
                                       0
                                       ,
                                       1
                                       )
                                    
                                  distribution. Instances B1f–B9f correspond to the case where products can be grouped into families. In this case, there is a changeover time of 1 period between products belonging to different families and no changeover time between products belonging to the same family.


                                 Inventory holding costs. For each product, inventory holding costs have been randomly generated from a discrete uniform 
                                    
                                       DU
                                       (
                                       5
                                       ,
                                       10
                                       )
                                    
                                  distribution.


                                 Changeover costs. We used two different types of structure for the changeover cost matrix S. Instances of sets A1–A11 and B1–B9 have a general cost structure: the cost of a changeover from product p to product 
                                    
                                       q
                                       ,
                                       
                                       
                                          
                                             S
                                          
                                          
                                             pq
                                          
                                       
                                    
                                 , was randomly generated from a discrete uniform 
                                    
                                       DU
                                       (
                                       100
                                       ,
                                       200
                                       )
                                    
                                  distribution. Instances of sets A1f–A11f and B1f–B9f correspond to the frequently encountered case where products can be grouped into product families: there is a high changeover cost between products of different families and a smaller changeover cost between products belonging to the same family. In this case, for products p and q belonging to different product families, 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             pq
                                          
                                       
                                    
                                  was randomly generated from a discrete uniform 
                                    
                                       DU
                                       (
                                       100
                                       ,
                                       200
                                       )
                                    
                                  distribution; for products p and q belonging to the same product family, 
                                    
                                       
                                          
                                             S
                                          
                                          
                                             pq
                                          
                                       
                                    
                                  was randomly generated from a discrete uniform 
                                    
                                       DU
                                       (
                                       0
                                       ,
                                       100
                                       )
                                    
                                  distribution.


                                 Production capacity utilization. Production capacity utilization 
                                    
                                       ρ
                                    
                                  is defined as the ratio between the total cumulated demand (
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             p
                                             =
                                             1
                                          
                                          
                                             P
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             t
                                             =
                                             1
                                          
                                          
                                             T
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             pt
                                          
                                       
                                    
                                 ) and the total cumulated available capacity (T). We set 
                                    
                                       ρ
                                       =
                                       0.95
                                    
                                  for instances with zero changeover times and 
                                    
                                       ρ
                                       =
                                       0.80
                                    
                                  for instances with positive changeover times.


                                 Demand pattern. Binary demands 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             pt
                                          
                                       
                                       ∈
                                       {
                                       0
                                       ,
                                       1
                                       }
                                    
                                  for each product have been randomly generated according to the following procedure:
                                    
                                       1.
                                       We randomly select a product 
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                           from a discrete uniform 
                                             
                                                DU
                                                (
                                                1
                                                ,
                                                N
                                                )
                                             
                                           distribution and set 
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                         
                                                            ∗
                                                         
                                                      
                                                      T
                                                   
                                                
                                                =
                                                1
                                             
                                          .

For each product p, except product 
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                             
                                          , we randomly select a period 
                                             
                                                
                                                   
                                                      t
                                                   
                                                   
                                                      p
                                                   
                                                
                                             
                                           from a discrete uniform 
                                             
                                                DU
                                                (
                                                1
                                                ,
                                                T
                                                )
                                             
                                           distribution and set 
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      p
                                                      ,
                                                      
                                                         
                                                            t
                                                         
                                                         
                                                            p
                                                         
                                                      
                                                   
                                                
                                                =
                                                1
                                             
                                          .

For each entry in a 
                                             
                                                P
                                                ×
                                                T
                                             
                                           matrix, except for the entries corresponding to the 
                                             
                                                (
                                                p
                                                ,
                                                t
                                                )
                                             
                                           combinations for which we set 
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      pt
                                                   
                                                
                                                >
                                                0
                                             
                                           in steps 1 or 2, we randomly generate a number 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      pt
                                                   
                                                
                                             
                                           from a discrete uniform 
                                             
                                                DU
                                                (
                                                1
                                                ,
                                                PT
                                                )
                                             
                                           distribution.

While the total cumulated demand (
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                      =
                                                      1
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      pt
                                                   
                                                
                                             
                                          ) does not exceed 
                                             
                                                ρ
                                                T
                                             
                                          , we consider the entries 
                                             
                                                (
                                                p
                                                ,
                                                t
                                                )
                                             
                                           one by one in the increasing order of the corresponding value 
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      pt
                                                   
                                                
                                             
                                           and set 
                                             
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      pt
                                                   
                                                
                                                =
                                                1
                                             
                                          .

When the total cumulated demand reaches 
                                             
                                                ρ
                                                T
                                             
                                          , we examine whether the corresponding instance is feasible by checking that 
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      p
                                                      =
                                                      1
                                                   
                                                   
                                                      P
                                                   
                                                
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   
                                                      d
                                                   
                                                   
                                                      p
                                                      τ
                                                   
                                                
                                                ⩽
                                                t
                                             
                                           for all t. If the instance is infeasible, we repeat steps 1–4.

We generated 220 instances with zero changeover times and 180 instances with positive changeover times, leading to a total of 400 instances.

For each instance, we compute:
                           
                              •
                              the lower bound 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  provided by the linear relaxation of DLSPSD1 discussed in Gicquel et al. (2009) and strengthened by the valid inequalities proposed by Gicquel et al. (2009) for the single-product DLSP.

the lower bound 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             sdp
                                             1
                                          
                                       
                                    
                                  provided by the semidefinite relaxation of DLSPSD2 discussed in Section 3 and strengthened by step 1 of algorithm (CPA).

the lower bound 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             sdp
                                             2
                                          
                                       
                                    
                                  provided by the semidefinite relaxation of DLSPSD2 discussed in Section 3 and strengthened by steps 1 and 2 of algorithm (CPA).

the optimal integer solution value 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             ip
                                          
                                       
                                    
                                  obtained by applying on the problem a Branch & Bound procedure using the lower bound 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  at each node of the search tree.

Linear programs are computed using the simplex algorithm embedded in CPLEX 12.5 whereas the optimal integer solution value is obtained using the standard Branch & Bound algorithm embedded in CPLEX 12.5. We use the semidefinite programming solver DSDP based on an interior-point type algorithm (see Benson et al., 2000) to solve the various semidefinite programs involved in algorithm (CPA). All tests were run on an Intel Core i5 (2.7gigahertz) with 4gigabyte of RAM, running under Windows 7.


                        Tables 1–4
                        
                        
                        
                         display the computational results. We provide for each set of 10 instances:
                           
                              •
                              
                                 P and T: the number of products and planning periods involved in the production planning problem.


                                 
                                    
                                       
                                          
                                             V
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             lp
                                          
                                       
                                    
                                 : the number of variables and constraints in the linear relaxation.


                                 
                                    
                                       n
                                       +
                                       1
                                    
                                  and 
                                    
                                       
                                          
                                             C
                                          
                                          
                                             sdp
                                          
                                       
                                    
                                 : the size of the variable matrix X and the number of constraints involved in the initial semidefinite relaxation.


                                 
                                    
                                       
                                          
                                             Cut
                                          
                                          
                                             1
                                          
                                       
                                    
                                 : the average number of cuts added to the SDP formulation by step 1 of algorithm (CPA) and 
                                    
                                       
                                          
                                             Cut
                                          
                                          
                                             2
                                          
                                       
                                    
                                  the average total number of cuts generated by steps 1 and 2 of algorithm (CPA).


                                 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  (resp. 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             sdp
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             G
                                          
                                          
                                             sdp
                                             2
                                          
                                       
                                    
                                 ): the average percentage gap between the lower bound 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  (resp. 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             sdp
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             sdp
                                             2
                                          
                                       
                                    
                                 ) and the optimal integer solution value 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             ip
                                          
                                       
                                    
                                 .


                                 Opt: the number of instances for which the proposed semidefinite programming based approach provides the exact optimal solution value of the DLSPSD.


                                 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  (resp. 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             sdp
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             T
                                          
                                          
                                             sdp
                                             2
                                          
                                       
                                    
                                 ): the average computation time (in seconds) needed to obtain 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             lp
                                          
                                       
                                    
                                  (resp. 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             sdp
                                             1
                                          
                                       
                                    
                                  and 
                                    
                                       
                                          
                                             Z
                                          
                                          
                                             sdp
                                             2
                                          
                                       
                                    
                                 ).

Results from Tables 1 and 2 show that, for the instances with zero changeover times, the lower bounds provided by the proposed semidefinite relaxation of the DLSPSD are of significantly improved quality as compared with the ones provided by the strongest linear relaxations known for the problem. Namely, the average gap over the 110 instances A1–A11 involving a general changeover cost structure is decreased from 2.2% with the strengthened linear reformulation to 0.4% with the semidefinite relaxation. The improvement is even more significant for instances A1f–A11f involving a product family cost structure as the average gap over the 110 corresponding instances is decreased from 10.1% to 2.3%.

Similar results can be seen from Tables 3 and 4 for the instances with positive changeover times. Namely, the average gap is decreased from 9.9% to 2.4% for the 90 instances B1–B9 involving a general cost structure and from 16.5% to 6.5% for the 90 instances B1f–B9f involving a family cost structure.

Moreover, we point out that for 166 out of the 200 small-size instances involving up to 4 products and 25 periods, we have 
                           
                              
                                 
                                    Z
                                 
                                 
                                    sdp
                                    1
                                 
                              
                              =
                              
                                 
                                    Z
                                 
                                 
                                    DSLP
                                 
                              
                           
                        , i.e. the proposed semidefinite relaxation provides the optimal integer solution value so that the residual gap vanishes. This means that for these instances, the discrete problem is solved to exact optimality without resorting to any kind of tree search process. We are not aware of any other previously published relaxation achieving such an accurate approximation of the MIP solution set for the class of discrete lot-sizing problems addressed here.

@&#DISCUSSION@&#

The improvement in the quality of the lower bounds obtained by using the proposed semidefinite relaxation of the problem might be explained by two main reasons. First, lifting the problem into a higher dimensional space where every possible quadratic term 
                           
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    j
                                 
                              
                           
                         might be used to express the problem constraints enables us to exploit a variety of formulation strengthening techniques which can otherwise not be directly applied when using the linear reformulation of DLSPSD1 considered in Belvaux and Wolsey (2001) and Gicquel et al. (2009). Moreover, by reformulating the problem as a semidefinite program and requiring that the variable matrix X is positive semidefinite, we implicitly add an infinite number of constraints in the problem. Namely, imposing the semidefiniteness of matrix 
                           
                              X
                              
                              ⪰
                              
                              0
                           
                         would be equivalent to incorporating into the linear reformulation an infinite set of constraints of the form 
                           
                              
                                 
                                    v
                                 
                                 
                                    t
                                 
                              
                              Xv
                              ⩾
                              0
                              ,
                              
                              ∀
                              v
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                           
                        .

However, our results are obtained at the expense of significant computation time. This might be first explained by the limitations of available state-of-the-art semidefinite programming solvers. Solving a semidefinite program is namely more computationally intensive than solving a linear program. As mentioned by Rendl (2012), currently available SDP interior-point methods work nicely for instances with a matrix size below 200 and less than 2000 constraints whereas instances with a matrix size over 1000 and more than 10,000 constraints are considered as impractical. Study of algorithms and development of software capable of solving large-size semidefinite programs is currently an active area of research so that significant progress may be expected in the near future (see e.g. Yamashita et al., 2012). A second possible explanation for the observed significant computation times could be that, in the proposed solution procedure, we solve a series of semidefinite programs of increasing size during the cutting-plane generation algorithm without being able to use a warm-start strategy. Namely, using the optimal solution of the previous iteration of the cutting-plane generation to reoptimize the problem slightly changed by the addition of some valid inequalities is difficult to implement with interior-point algorithms such as the one embedded in the solver DSDP. It might thus be worth investigating the use of a semidefinite programming solver based on another type of algorithm (such as the spectral bundle method presented in Helmberg et al. (2000)) as this might enable us to more easily exploit a warm-start strategy during the cutting-plane generation.

@&#CONCLUSION@&#

We studied the discrete lot-sizing and scheduling problem with sequence-dependent changeover costs and times. This optimization problem can be formulated as a quadratically constrained quadratic binary progam. We proposed in the present paper to compute a lower bound of the optimal integer solution value of the problem by carrying out a semidefinite relaxation. To achieve this, we not only exploited reformulation and strengthening techniques recently proposed in the SDP literature for generic (0–1) quadratic binary problems but also used problem-specific information such as the polyhedral representation of single-product discrete lot-sizing problems. The results of our computational experiments show that, in terms of solution quality, the proposed approach compares well with the best MILP strengthening techniques known for the problem. It provides lower bounds of significantly improved quality, especially for the instances featuring a product family cost structure, and is capable of completely closing the gap between the lower bound and the optimal integer solution value for a significant proportion of the small-size instances. However, due to the limitations of available state-of-the art semidefinite programming solvers, these results are obtained at the expense of significant computation times so that it does not seem possible for the time being to solve large-size industrial instances with the proposed approach.

The present work can thus be viewed as a first step towards applying SDP models and tools to discrete lot-sizing problems. Sure, the reported computation times are still significant, however future improvements in the computational efficiency of the SDP technology are likely to occur. In such a perspective, the methodology proposed here might serve as a basis for competitive SDP-based approaches to lot-sizing.

The work described in this paper was funded by the French National Research Agency through its research funding program JCJC2011 for young researchers (Project ANR-11-JS0002-01 LotRelax). The authors would also like to thank two anonymous referees for their detailed reviews that helped improving an initial version of this paper.

@&#REFERENCES@&#

