@&#MAIN-TITLE@&#New real-time heartbeat detection method using the angle of a single-lead electrocardiogram

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           This study presents a new real-time heartbeat detection algorithm using the geometric angle.


                        
                        
                           
                           The angle was adopted as a new index representing the slope of ECG signal.


                        
                        
                           
                           The proposed method shows superior or comparable performance than previous works.


                        
                        
                           
                           It could be effectively applied in real-time healthcare and medical devices.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Heartbeat detection

Angle of ECG signal

Adaptive thresholding technique

Single-lead electrocardiogram

Real-time processing

@&#ABSTRACT@&#


               
               
                  This study presents a new real-time heartbeat detection algorithm using the geometric angle between two consecutive samples of single-lead electrocardiogram (ECG) signals. The angle was adopted as a new index representing the slope of ECG signal. The method consists of three steps: elimination of high-frequency noise, calculation of the angle of ECG signal, and detection of R-waves using a simple adaptive thresholding technique. The MIT-BIH arrhythmia database, QT database, European ST-T database, T-wave alternans database and synthesized ECG signals were used to evaluate the performance of the proposed algorithm and compare with the results of other methods suggested in literature. The proposed method shows a high detection rate—99.95% of the sensitivity, 99.95% of the positive predictivity, and 0.10% of the fail detection rate on the four databases. The result shows that the proposed method can yield better or comparable performance than other literature despite the relatively simple process. The proposed algorithm needs only a single-lead ECG, and involves a simple and quick calculation. Moreover, it does not require post-processing to enhance the detection. Thus, it can be effectively applied to various real-time healthcare and medical devices.
               
            

@&#INTRODUCTION@&#

The electrocardiogram (ECG) is the recording of the electrical activity of the heart which is non-invasively measured. The ECG is important in the diagnosis of cardiovascular disease because it provides critical information about ischemic heart diseases, arrhythmia, coronary artery disease, angina pectoris, myocardial infarction, atherosclerosis [1]. The system that automatically analyzes the ECG firstly requires accurate heartbeat detection prior to identify the diagnosis parameters of the cardiovascular disease [2–6].

Numerous heartbeat detection algorithms that can be applied to automatic diagnosis systems have been proposed. Existing methods have used derivative-based algorithms [2,5,7,8], wavelet transforms [3,6,9,10], filter bank [11], Hilbert transform [12,13], matched filters [14,15], artificial neural networks [14,16–18], and hidden Markov models [17,19,20]. Using a different concept, phasor transform was also applied for automatic delineation of fiducial points of single-lead ECG [21]. Most of the previous methods have produced excellent results in heartbeat detection.

However, these methods have complex pre- and/or post-processing procedure, and they need too many parameters for calculation [4,15]. In addition, some methods require multi-lead ECG signals [22], or additional training or a reference signal in order to enhance the detection performance [14,17]. Increasing of the computational complexity and cost in algorithm is hindered real-time implementation. Furthermore, their performance is seriously affected by various noises, such as baseline wandering, and high frequency noise [2,5].

This study presents a computationally efficient and accurate method for the heartbeat (actually R-peak) detection based on the geometric angle between two consecutive samples of single-lead ECG signal. It is a new approach for detecting the heartbeat that uses the angle between two consecutive samples without the amplitude or morphology of the ECG. Its primary advantage is that it can accurately emphasize the QRS complex without being influenced by variations in amplitude, width, or the morphology of the QRS complex. Moreover, it yields high detection rates despite the relatively simple process. Therefore, the proposed method is suitable for the real-time automated diagnosis, the various real-time healthcare and medical devices.

@&#METHODS@&#

Prior to calculating the angle of ECG signal, as a preprocessing stage, a 64th order low-pass finite impulse response (FIR) filter with a cut-off frequency of 25Hz was used to eliminate high-frequency noise. The cut-off frequency and the order of the filter were chosen within a range that does not affect the morphology of the QRS complex. After the preprocessing, the angle of ECG signal was calculated. In this study, the geometric angle, y(n) in degree, between two consecutive samples of ECG signal is defined as
                           
                              (1)
                              
                                 y
                                 (
                                 n
                                 )
                                 =
                                 
                                    
                                       tan
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          a
                                          b
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       tan
                                    
                                    
                                       −
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             c
                                             ×
                                             
                                                |
                                                
                                                   x
                                                   (
                                                   n
                                                   )
                                                   −
                                                   x
                                                   (
                                                   n
                                                   −
                                                   1
                                                   )
                                                
                                                |
                                             
                                          
                                          
                                             360
                                             /
                                             f
                                             s
                                          
                                       
                                    
                                    )
                                 
                              
                           
                        where x(n) is a n
                        th sample of digitized ECG signal, a is a scaled version of absolute value of amplitude difference between the two samples, and b is a scaled time interval between the two samples, and f
                        
                           s
                         is the sampling rate of the signal. The absolute value of amplitude difference is multiplied by a scale factor, c. The initial value of c is 512, but when a/b is smaller than 58 (about 89.01 degree) during two seconds, the value is changed to 1024. After that, the value of c is changed to 512 again when a/b is larger than 120 (about 89.5 degree). This helps to detect the beat which is inherently small or getting smaller. Actually, b is a constant value according to the sampling rate in digitized signal. In case of digitized signal with 360 samples per second, b is set to 1, and we can easily calculate the angle in degrees, y(n), using an arctangent operation of scaled absolute value of amplitude difference between the two samples as described in the right term of Eq. (1). 
                        Fig. 1 shows the filtered ECG signals (f
                        
                           s
                        =360Hz) and corresponding angles obtained by Eq. (1). As shown in this figure, the angles of QRS complex of typical Lead II fall within a range of 80 to 90 degrees. Also, despite the beat-to-beat change in morphology and amplitude of QRS complex, the angles are still maintained within a range of 80 to 90 degrees.

In order to detect the heartbeat, we applied an adaptive threshold method to the angle obtained from Eq. (1). The value of threshold is also expressed as an angle. First, by comparing the calculated y(n) and the threshold, a time window to detect the R-peak was determined. Then, the R-peak was detected from the filtered ECG signal which is corresponding to the time window. In this procedure, the threshold is automatically adjusted to the each beat, since the characteristics of QRS complex, such as amplitude, width and shape or morphology vary depending on the subject and measuring environment. For this reason, an adaptive threshold method was adopted to respond properly to different conditions. The value of threshold, w(n), can be updated according to the following condition:
                           
                              (2)
                              
                                 w
                                 (
                                 n
                                 +
                                 1
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   (
                                                   n
                                                   )
                                                   −
                                                   k
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   y
                                                   (
                                                   n
                                                   )
                                                   >
                                                   w
                                                   (
                                                   n
                                                   )
                                                   +
                                                   k
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   w
                                                   (
                                                   n
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   w
                                                   (
                                                   n
                                                   )
                                                   <
                                                   y
                                                   (
                                                   n
                                                   )
                                                   ≤
                                                   w
                                                   (
                                                   n
                                                   )
                                                   +
                                                   k
                                                   1
                                                   ,
                                                   c
                                                   t
                                                   =
                                                   0
                                                
                                             
                                          
                                          
                                             
                                                
                                                   w
                                                   (
                                                   n
                                                   )
                                                   −
                                                   (
                                                   k
                                                   2
                                                   ×
                                                   c
                                                   t
                                                   )
                                                   ,
                                                
                                             
                                             
                                                
                                                   y
                                                   (
                                                   n
                                                   )
                                                   ≤
                                                   w
                                                   (
                                                   n
                                                   )
                                                   ,
                                                   c
                                                   t
                                                   =
                                                   c
                                                   t
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   80
                                                   ,
                                                
                                             
                                             
                                                
                                                   w
                                                   (
                                                   n
                                                   )
                                                   ≤
                                                   80
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where k1 and k2 are 0.5 and 0.0001 degrees, respectively. The initial value of the threshold is zero degree. If y(n) is greater than w(n)+k1, w(n+1) is updated as y(n)−k1. If y(n) is equal or less than w(n), the decreasing constant, ct, increases by one, and w(n+1) is reduced by the value of the ct multiplied by k2. Since the value of ct increases over time, w(n+1) decreases rapidly. When this condition continues and the threshold reaches to 80 degrees, the threshold is not updated. If y(n) is greater than w(n) and less than or equal to w(n)+k1, ct is reset to zero, and w(n+1) is equal to w(n). This adjusting rule described in Eq. (2) has been devised to have larger threshold value at the time of occurrence of R-peak and to have lower value at the rest time. As can be seen from Eq. (2), the upper limit and reduction rate of threshold value are determined by k1 and k2. The higher the value of k1 and k2, the threshold is determined to smaller value and is reduced quickly. As a result, the false detection (false positive) increases by tall T-wave or noise. In the opposite case, the missed detection (false negative) increases. Therefore, it is important to select the proper value of k1 and k2. These two values were determined empirically to reduce the detection error.

After the R-peak occurs, the adjusting technique reduces the threshold value, and increases the value of ct over time. When a new R-peak occurs, the value of ct becomes zero. So, it can be considered that the R-peak exists only when the value of ct is small. Therefore, by observing the value of ct, we can determine the range of time window to be used to detect the R-peak. The time window, d(n), to be used to detect the R-peak is generated as:
                           
                              (3)
                              
                                 d
                                 (
                                 n
                                 )
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                             
                                             
                                                
                                                   0
                                                   ≤
                                                   c
                                                   t
                                                   ≤
                                                   k
                                                   3
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0
                                                   ,
                                                
                                             
                                             
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 k
                                 3
                                 =
                                 
                                    {
                                    
                                       
                                          
                                             
                                                
                                                   0.417
                                                   ×
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   average
                                                   
                                                   RR
                                                   
                                                   interval
                                                   
                                                   ≥
                                                   0.723
                                                   s
                                                
                                             
                                          
                                          
                                             
                                                
                                                   0.278
                                                   ×
                                                   
                                                      
                                                         f
                                                      
                                                      
                                                         s
                                                      
                                                   
                                                   ,
                                                
                                             
                                             
                                                
                                                   otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where k3 means the length of time. The k3 is divided into two values depending on the RR interval. When the RR interval is too short, a following R-peak may be included in the time window of prevenient R-peak. In this case, shorter length of time window than that of usual RR interval is desirable. If an average of recent eight RR intervals is greater than 0.723s, k3 is set to 0.417s multiplied by f
                        
                           s
                        . And if not, in the case of short RR interval, k3 is set to 0.278s multiplied by f
                        
                           s
                        . These two values of k3 were experimentally determined. The value of k3 was initially set to 0.278s and was changed according to the equation whenever the each heartbeat was detected. After the length of time window was determined, absolute value of local minimum and maximum of the filtered ECG signal within this time window were compared, and then larger one was selected as a peak of R-wave. 
                        Fig. 2 shows an example of R-peak detection procedure.

@&#RESULTS@&#

To evaluate the performance of the proposed method, two types of validation were performed. First, the performance of proposed heartbeat detection method was assessed using several standard databases and the result was compared with previous studies which use single-lead ECG. Next, relative noise susceptibility of the proposed method was validated and compared with open source QRS detectors. In this case, some synthesized signals were used. All databases and annotations used in this study have been downloaded from the PhysioNet [23].

For the first validation, standard MIT-BIH arrhythmia database (MITDB), QT database (QTDB), European ST-T database (EDB) and T-wave alternans database (TWADB) were used. In order to increase the reliability of the validation, several databases having different sampling rates and voltage resolutions were used in this study. The information of the databases is summarized in 
                     Table 1.

The MITDB consists of 48 half-hour records; each record has two-channel ECG signals range [24]. The recordings were digitized at 360 samples per second with 11-bit resolution over a 10mV. In this database, ventricular flutter waves, which are part of record 207, were excluded from the total number of beats, since which are not annotated. The QTDB consists of 105 fifteen-minute records digitized at 250 samples per second [25]. This database provides annotation including location of QRS complexes and waveform boundaries for the some representative beats of each record. Additionally, 82 records in this database included the annotation of QRS complexes of whole signal. Therefore, the remaining 23 records were excluded from the performance evaluation. The EDB contains 90 two-hour records; each record has two-channel ECG signals [26]. The recordings were digitized at 250 samples per second with 12-bit resolution over a 20mV range. This database provides annotation for location of QRS complexes, changes in ST segment and T-wave morphology, rhythm, and signal quality. The TWADB consists of 100 two-minute records digitized at 500 samples per second with 16-bit resolution over a ±32mV range [27]. Each record contains standard 12 diagnostic ECG signals, but a few contain only two or three signals. This database provides annotation containing the times of occurrence of the QRS complexes within the records. In this validation, the performance of the proposed method on these databases was compared with previous studies [2–6,10,21].

In the second validation, to quantify the noise immunity of the proposed method, synthesized ECG signals were used by adding different levels of noise to the above mentioned four databases. From the each database 10 records were randomly selected, and total 40 records were used. The noise signals to be added were excerpt from the MIT-BIH Noise Stress Test Database (NSTDB). This database contains three half-hour records of noise typical in ambulatory ECG recordings [28]. Each noise record contains predominantly baseline wander, muscle artifact, and electrode motion artifact, respectively. These noise records were sampled at 250 samples per second with 12-bit resolution. In order to add into the abovementioned 40 records, the noise records were resampled to match with the sampling rate of each record. The noise level is represented as signal-to-noise ratio (SNR) defined as:
                        
                           (5)
                           
                              S
                              N
                              R
                              (
                              d
                              B
                              )
                              =
                              10
                              
                                 
                                    log
                                 
                                 
                                    10
                                 
                              
                              
                                 (
                                 
                                    
                                       
                                          
                                             
                                                S
                                             
                                             2
                                          
                                       
                                       
                                          
                                             
                                                N
                                             
                                             2
                                          
                                       
                                    
                                 
                                 )
                              
                           
                        
                     where S and N are the signal and noise, respectively. The typical SNR of ECG signal with contact electrodes usually ranges between 10 and 40dB [29]. Subsequently, four levels of each noise were added to 40 records; 10, 20, 30 and 40dB. In this validation, the performance of the proposed method on these synthesized signals was compared with open source QRS detectors; wqrs 
                     [23,30], sqrs 
                     [23,31].

In both validations, the limb lead II was used to detect the heartbeat, but precordial lead (V4 or V5) or first channel was used when the lead II was not available in some records. In order to assess the performance, sensitivity (S
                     
                        e
                     ), positive predictivity (+P), and failed detection (F
                     
                        d
                     ) were used. These indices are expressed as:
                        
                           (6)
                           
                              
                                 
                                    S
                                 
                                 
                                    e
                                 
                              
                              (
                              %
                              )
                              =
                              
                                 
                                    T
                                    P
                                 
                                 
                                    T
                                    P
                                    +
                                    F
                                    N
                                 
                              
                              ×
                              100
                           
                        
                     
                     
                        
                           (7)
                           
                              +
                              P
                              (
                              %
                              )
                              =
                              
                                 
                                    T
                                    P
                                 
                                 
                                    T
                                    P
                                    +
                                    F
                                    P
                                 
                              
                              ×
                              100
                           
                        
                     
                     
                        
                           (8)
                           
                              
                                 
                                    F
                                 
                                 
                                    d
                                 
                              
                              (
                              %
                              )
                              =
                              
                                 
                                    F
                                    P
                                    +
                                    F
                                    N
                                 
                                 
                                    Total
                                    
                                    beats
                                 
                              
                              ×
                              100
                           
                        
                     where TP is correctly detected beats (True Positive), FP is falsely detected beats (False Positive), and FN is undetected beats (False Negative).


                     
                     Table 2 shows the detection performance on MITDB, QTDB, EDB and TWADB obtained by the proposed method and other methods of previous works. All previous works were tested on the MITDB, but only a part of them were also tested on the QTDB, EDB and TWADB. As shown in the table, the proposed method shows superior or comparable performance than previous works on the all databases.

Comparison of detection performance on the synthesized ECG records is given in 
                     Fig. 3. The average value of failed detection ratio on the 40 synthesized ECG records, obtained by the proposed method and open source QRS detectors (wqrs, sqrs) were compared according to the SNR. As can be seen in this figure, the proposed method shows lower failed detection ratio than open source detectors within typical SNR range.

@&#DISCUSSION@&#

We propose a new heartbeat detection method for a single-lead ECG using a simple adaptive thresholding technique and a geometric angle which is formed by two consecutive samples of ECG. On the four databases (1006,045beat), the overall sensitivity, positive predictivity and fail detection rate of the proposed method were 99.95%, 99.95% and 0.10%, respectively.

The MITDB is used widely as a standard database, to evaluate the heartbeat detection method. However, for the reliable validation of the proposed method, we used additional databases having different sampling rates and voltage resolutions. As can be seen in Table 2, the proposed method shows similar performance on the four databases without any adjustment of method depending on each database. Resampling process according to each database is also not necessary since the equation deriving the angle of the ECG signal contains the sampling rate. In addition, relative noise susceptibility of the proposed method was validated using the noise contaminated synthesized ECG signals and compared with open source QRS detectors. The proposed method shows the lower failed detection ratio than open source detectors on the synthesized ECG signals within typical SNR range. These results indicate that the proposed method has robustness and excellent performance.

The slope of the R-wave is the most distinctive feature used widely to detect the heartbeat in existing methods [2], and the derivative signal of ECG is commonly used to characterize the slope. On the other hand, the angle between two consecutive samples was adopted in this work as a new measure representing the slope of ECG signal. This approach is probably not novel in the sense that the slope information represented by angle has been used for the heartbeat detection. Actually, the angle obtained by Eq. (1) is the inverse tangent of absolute value of scaled difference between two consecutive samples of ECG signal. However, this transform makes the difference signal to have non-linear characteristics. The values of angle are limited to constant range from 0 to 90 degrees, this is the most distinctive feature of the angle compared to the difference or derivative signal of ECG. 
                     Fig. 4 represents the relationship between the absolute value of first difference and the angle of ECG signal in record 203 and 113 of MITDB. As shown in this figure, these two variables have non-linear relationship. Most notable feature between two variables is that the angle is changed steeply until to about 80 degrees when the absolute value of first difference is small. However, if the angle exceeds about 80 degrees, even though the first difference abruptly changes, the angle is not greatly changed. This enables the angle to have the robustness to the beat-to-beat changes in morphology and amplitude. Additionally, even though the first differences of ECG signals have different amplitude according the record, the angles are always maintained from 0 to 90 degrees. Moreover, the angles of most R-peaks fall within a range of 80 to 90 degrees. So, compared to the difference or derivative signals, the angles are not sensitive to changes in morphology and amplitude of the QRS complex. In this point of view, we believe that the angle is a proper measure of highlighting the slope information favorable to heartbeat detection.

Some records of databases used in this study have several problems (severe baseline drift, sudden change of morphology and amplitude of QRS complex, and occurrence of the abnormal beat) which can degrade the detection performance. 
                     Fig. 5 shows ECG signals of the record 201 and 203 in MITDB which have aforementioned problems. For comparison, the angle and squared derivative of ECG signal are simultaneously demonstrated. The squared derivative signal was obtained by reference to the method of Tompkins [2]. As shown in this figure, the squared derivative signal shows large amplitude difference between heartbeats according to the variation of the morphology and amplitude of QRS complex, whereas the angle of the heartbeat shows smaller difference than that of the squared derivative signal and maintains a range of 80 to 90 degrees. This indicates that the angle is more effective than the derivative signal in emphasizing the QRS complex. Furthermore, the computational complexity of arctangent operation for calculating the angle is not high than other conventional method. In order to compare the computational load, the proposed method and Tompkins’s method [2] were implemented to operate in real-time on a 32-bit ARM Cortex-M0 microcontroller (NXP LPC11A04UK, Netherlands) board running at a clock frequency of 48MHz. To compare the computational efficiency of operation for deriving the slope information of each method, the preprocessing and thresholding procedure of both methods were excluded. The ECG signals from a patient simulator (Fluke Biomedical, medSim 300B, USA) via the 3-lead cable was digitized at 500 samples per second with 24-bit analog-to-digital converter (Texas Instruments, ADS1294R, USA) and transmitted to the microcontroller board through a serial peripheral interface (SPI) communication. The execution time of arctangent operation to determine the angle was about 20.82㎲ for a single iteration. While, the execution time of Tompkins’s method [2] including derivative operation, squaring function and moving-window integration was about 27.99㎲, it took more time than arctangent operation. Because of these advantages, the angle makes it easy to detect the heartbeat despite a simple calculation.

Meanwhile, in the case of the squared derivative signal in Fig. 5, unless the detection threshold is appropriately determined, the large amplitude difference between the QRS complexes can cause the FNs and FPs for the higher and lower threshold, respectively. Some adaptive threshold techniques in the literature well cope with the gradual variation in the amplitude and morphology of the QRS complex but may have limitation in the abrupt change [2,22]. Additional post-processing to reduce the FNs and FPs by inadequate threshold causes the increase of computational complexity and makes it not suitable for real-time implementation. In contrast, due to the non-linear characteristics of angle, the angle of the ECG signal is robust and insensitive to the variation of the amplitude and morphology of the QRS complex and baseline drift as well as abrupt change. This enables the simple adaptive thresholding technique to detect the heartbeat easily without an additional post-processing. In addition to these advantages of angle, the adaptive threshold adjustment technique also contributes to accurate heartbeat detection. In particular, value of the k1 and k2 in Eq. (2) has a significant effect on the detection accuracy. In order to reduce the detection error, these two parameters must be set to proper values. To determine the values of k1 and k2, we have analyzed the performance changes of the proposed method by varying the values of k1 and k2. The MITDB was used for this test, the other databases were excluded. 
                     Table 3 shows the failed detection ratio according to the k1 and k2. As shown this table, the value of k1 representing overall small failed detection ratio is 0.5. At this time, the value of k2 providing the smallest failed detection ratio is 0.00009 and 0.0001. As described in Section 2.2, higher value of k2 increases the false detection and decreases the missed detection. As a result, the value of k2 was selected to 0.0001 in a direction to reduce the missed detection.

Another property of the proposed method is that the length of time window to detect the heartbeat can be changed. As mentioned in Section 2.2, the length of time window is divided into two values depending on the average RR interval of the ECG signal. A shorter length of time window is desirable, to avoid the false detection of a T-wave as a heartbeat in the same time window. However, if the length of time window is too short, a T-wave may be detected as a following R-peak. Therefore, the length of time window is needed to be properly changed, but it is difficult to find the rule to divide finely. So, in this study, the length of the time window is divided into two classes according to the average of recent eight RR intervals, the values of length were experimentally obtained using the MITDB. As can be seen in Table 2 and Fig. 3, despite of simple dividing into two classes, the proposed method shows good performance on the four databases and noise contaminated synthesized ECG signals. The noise immunity of the proposed method could have an advantage in wearable or ambulatory applications in which the ECG is more contaminated to the various noises.

On the other hand, the proposed method shows some limitations. The detection errors occasionally occurred when the QRS complex disappearance and a severe contamination by muscle artifact arose in the channel that was applied to the proposed method. These are intrinsic limitations of the method that uses only a single-lead ECG signal. In addition, the angle is relatively sensitive to the high frequency noise such as muscle artifact, since the angle falls within a similar range with that of the QRS complex.

@&#CONCLUSION@&#

We described a new method to detect the heartbeat based on the angle between two consecutive samples of single-lead ECG and a simple adaptive thresholding technique. The proposed method, due to the non-linear characteristics of the angle, is robust and insensitive to the variation of the amplitude and morphology of the QRS complex and baseline drift as well as abrupt change. Also, the angle enables the simple adaptive thresholding technique to detect the heartbeat easily.

To evaluate the performance of the proposed method, several standard databases and synthesized ECG signals were used. The proposed method shows superior or comparable performance than previous works on the standard databases, and shows the lower failed detection ratio than open source detectors on the synthesized ECG signals within typical SNR range. Furthermore, the algorithm is easy and quick to use, and it does not require post-processing, which makes it suitable for real-time detection. The results implied that it could be effectively applied in real-time healthcare and medical devices, such as automatic ECG diagnostic systems or Holter systems, as well as implantable medical devices, including cardioverter defibrillators (ICD).

@&#SUMMARY@&#

In this paper, we proposed a new real-time heartbeat detection algorithm using the angle between two consecutive samples of single-lead electrocardiogram (ECG) signals. The proposed method, due to the non-linear characteristics of the angle, is robust and insensitive to the variation of the amplitude and morphology of the QRS complex and baseline drift as well as abrupt change. To evaluate the performance of the proposed algorithm, we used four databases and synthesized ECG signals, and compare with the results of other methods suggested in literature. The proposed method shows better or comparable performance in most of the evaluation indexes, such as 99.95% of the sensitivity, 99.95% of the positive predictivity, and 0.10% of the fail detection rate, than other literature despite the relatively simple process. Furthermore, our algorithm requires only a single-lead ECG, and does not require complex post-processing. Consequently, the proposed method can be effectively applied to various real-time healthcare and medical devices.

All the authors have not transmitted any conflicts of interest.

@&#ACKNOWLEDGEMENTS@&#

This research was financially supported by the Ministry of Trade, Industry & Energy(MOTIE), Korea Institute for Advancement of Technology(KIAT) and Gangwon Institute for Regional Program Evaluation(GWIRPE) through the Leading Industry Development for Economic Region.

@&#REFERENCES@&#

