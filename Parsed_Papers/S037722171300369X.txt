@&#MAIN-TITLE@&#A rewarding-punishing coordination mechanism based on Trust in a divergent supply chain

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Introducing trust as a non-pecuniary factor to develop coordination mechanisms.


                        
                        
                           
                           Formulating the model as a non-linear constrained optimization problem.


                        
                        
                           
                           Transforming the model into a quadratic mixed-integer programming problem.


                        
                        
                           
                           Proposing a trust-based mechanism with capability to punish or reward agents.


                        
                        
                           
                           Simulating four instances of the supply chain regarding market and demand factors.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Supply chain management

Coordination

Divergent supply chain

Contract design

Trust

Monte Carlo simulation

@&#ABSTRACT@&#


               
               
                  Coordination of decentralized supply chains using contract design is a problem that has been widely addressed in the literature. We consider a divergent supply chain including a supplier and several retailers producing fashion products with short sale seasons. The retailers cooperate with the supplier as sales agents; i.e., they work in the framework of revenue sharing contracts. Because of their proximity to the market, retailers can provide more accurate demand forecasts to the supplier that is used to decide on issues such as capacity building and market prices with regard to retailers stiff due dates, different lead times and different price-dependent demand functions. To ensure abundant supply and cope with the demand variability, the retailers have an incentive to exaggerate their private forecast information. In this study, we propose a new rewarding-punishing coordination mechanism based on trust between supply chain tiers, considered as a differentiation factor between honest and deceptive partners. An optimization model is developed as a building block of this mechanism. An approximation method is used to simplify and solve the problem. The model is then implemented using Monte-Carlo simulation in four different situations, according to 10 different strategies for forecast information sharing. The findings from the tests show that the mechanism including trust as a decisional factor performs better than ‘No Trust’ mechanism in all situations. These results suggest that taking into account Trust in designing coordination mechanism may have significant influence on the financial performance of the supply chain.
               
            

Non-Linear Constrained optimization model

Quadratic Approximation model

Discretization Model of Price

Approximated Quadratic Mixed Integer optimization model

Symmetric Information model (used for comparison in simulation)

No Trust model (used for comparison in simulation)

the time period index, t
                        =1,2,…,
                        s
                     

the retailer index, i
                        =1,2,…,
                        n
                     

the price level, j
                        =1,2,…,
                        m
                        
                           i
                        
                     

linearization variables, l
                        =1,…,4

the quantity of product to be delivered to retailer i
                     

the safety reservation quantity corresponding to retailer i
                     

the price for retailer i
                     

the available production rate that should be set up for the next period

the extra production rate that should be built for the next period

the quantity of products to be delivered to retailer i with price level j
                     

the safety reservation quantity of retailer i if the retailer’s price value is p
                        
                           ij
                        
                     

a binary decision variable defined clearly in expression (14)
                     

a binary decision variable used to build mathematical optimization model

variables used for linear approximation

binary decision variables used to build mathematical optimization model

expected quantity of sale of retailer i if X
                        
                           i
                         is concerned

supplier’s belief about stochastic demand quantity

supplier’s Trust-based belief about stochastic demand quantity

level of the supplier’s trust in retailer i which is between zero and one and updated in each period

stochastic demand which has a truncated normal distribution over interval 
                           
                              (
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                           
                        
                     

number of retailers

number of periods

number of price levels for retailer i
                     

number of periods which is considered to run Matched-Pairs t-test

mean and standard deviation of stochastic demand of retailer i
                     

the actual superior information of retailer i about stochastic demand

the reported information as the retailer i’s private forecast information about stochastic demand

the supplier’s Trust-based belief about the retailer i’s stochastic demand

the extent to which the product is accepted in the market in region i
                     

the coefficient of the demand responsiveness in region i
                     

the deterministic retailer i’s lead time

maximum available time to produce and deliver the products for each period

available amount of capacity used as an upper bound for C
                        1
                     

an upper bound for C
                        2
                     

holding cost per product unit per time unit which only attributed to supplier due to his ownership

the supplier’s production, transportation and operational costs per product unit including operational costs regarding retailer i
                     

set up cost for the available capacity and building cost for the extra required capacity respectively

the amount paid for each reserved product in advance by the retailer to the supplier under revenue sharing contract

the retailer i’s revenue share from sales

value of price of retailer i at jth level

agents’ forecast accuracy based on interval length

the minimum value for α
                        
                           i
                        
                     

the initial value for score of retailer i, at the beginning of the first period

retailer i’s score which updates at the end of each period

values of significance levels respectively used for first, second and third Matched-Pairs test

points that a retailer gets if Null hypothesis is failed to be rejected at a significance level of SL
                        1
                     

points that a retailer gets if Null hypothesis is failed to be rejected at a significance level of SL
                        2
                     

points that a retailer gets if Null hypothesis is failed to be rejected at a significance level of SL
                        3
                     

points that a retailer gets if Null hypothesis is rejected at a significance level of SL
                        3
                     

a coefficient with values between zero and one to restrict the share of X
                        
                           i
                         in W
                        
                           i
                        
                     

In a centralized supply chain, a central planner tries to optimize the total supply chain profits (or costs) considering different decision variables. The central planner can use information from any supply chain echelon to develop optimal decisions since all information gathered belong to a single body. This case is referred as ‘Symmetric Information’ mechanism. In a decentralized supply chain, a member’s decision is based on his own interests and individual rationality, which can be in conflict with others’ ones. Conflicts of interest can severely damage information sharing and can have serious damages on the entire chain’s performance. Creating a partnership among the members and sharing credible information throughout the supply chain can improve its efficiency (e.g., Cachon and Lariviere, 2001; Viswanathan and Qinan, 2003; Chen et al., 2010). A well-designed contract can align the members’ decisions to achieve optimal performance for the entire chain as well as fairly sharing profits and risks among them (e.g., Donohue, 2000; Serel et al., 2001; Wu et al., 2002; Erkoc and Wu, 2005; Jin and Wu, 2007). Cachon (2003) provide a comprehensive literature review on coordination with contracts. The development of coordinating contracts has led to the hope that these methods are adopted extensively in practice and they can significantly improve the performance of the decentralized supply chain, which has not been achieved yet. The main possible reason is that most of the existent literature has tended to focus on optimizing the main decisions based on financial aspects and assuming that players are Bayesian decision makers, rather than trying to understand the actual behaviors of decision makers and designing coordination mechanisms based on identified characteristics.

Several attempts have been made to coordinate divergent supply chains. Some studies investigate the identical retailers such as Lau et al. (2008), Sarmah et al. (2008) and Qin et al. (2007), where the former work considers a deterministic and price-dependent demand, the second study investigates a stochastic demand, while the latter work with a constant demand. A number of studies investigate divergent supply chains with heterogeneous retailers such as Jin and Wu (2007), Cachon and Lariviere (2005), Bernstein and Federgruen (2005), Klastorin et al. (2002), and Anupindi et al. (2001). Sarlak and Nookabadi (2011) investigate a three level supply chain with several retailers with stochastic demand using a timing discount contract to synchronize the timing of retailers’ orders with the supplier’s order cycle. However, the demand structures in these works are either deterministic or stochastic or price-dependent; there are few studies which consider coordination in a divergent supply chain with stochastic and price-dependent demand (Pezeshki et al. (2013)).

In a different stream of research, some works, especially in the field of behavioral economy address the behavior of decision makers in business. In their seminal work, Özer et al. (2011) study a cheap talk mechanism in a dyadic supply chain in which the supplier requests private forecast information from a supplier to take his capacity investment decision under a simple wholesale price contract. The supplier has an incentive to exaggerate her forecast information in such a costless and nonbinding interaction called as “cheap talk”. No cooperation is the equilibrium point for this cheap talk model based on standard game theory; i.e., the supplier ignores the retailer’s forecast information. Several controlled laboratory experiments are undertaken, which simulate cooperation between players even in absence of reputation-building mechanisms and imperative contracts. They state that trust and trustworthiness are the main reasons for this cooperation. They conclude that the retailer’s forecast information is positively connected with the supplier’s capacity decisions; i.e., the supplier more likely decides to build higher capacity, as he receives a high forecast report, than a supplier receiving a lower forecast. They inferred that participants in their experiments use simpler methods to adjust their beliefs, rather than Bayes’ rules, which is consistent with the work of Kahneman and Tversky (1982), who show that people are not Bayesian decision makers. Moreover, Özer et al. (2011) suggest that repeated interactions lead to significant reduction in forecast exaggeration. In this context, if retailer’s forecast information is revealed to the supplier once each interaction is completed, the supplier can perfectly verify the trustworthiness of the report; this kind of feedback is called “full information feedback”. In contrary, if the supplier only is aware of the realized demand but not the private forecast, the retailer may exaggerate her forecast; this feedback is named as “partial information feedback”. Another laboratory study is undertaken in Inderfurth et al. (2008) to evaluate effectiveness of a proposed screening contract to coordinate a vendor–buyer supply chain, where the buyer is privileged to access to private demand information within a just-in-time context. It is indicated that retailers harm the supply chain performance with strategically manipulated information. Li and Lin (2006) empirically study information sharing and information quality in supply chain management using data gathered from 196 companies. Their results suggest that there is a positive correlation between information sharing and its quality and trust between supply chain partners. Handfield and Bechtel (2002) come to the conclusion that to build a new relationship based on trust, a wisely use of contracts to control their relative levels of dependency is advised. Their model is tested using data collected from a sample of purchasing managers in North America. Hill et al. (2009) also provide another controlled experimental work which tries to explain behavioral issues linked to agent decisions in real world. It is derived from these studies that analytical models that consider non-pecuniary factors have more potential to better explain human behavior in complex supply chain situations. Although considerable research is devoted to experimental and empirical works to determine whether or not partners in real world are Bayesian decision makers, there is a need to develop new models to better explain their behaviors. Indeed, less attention has been paid to design mechanisms based on non-pecuniary factors such as Trust which better fits the human behavior in business interactions.

Based on trust literature in supply chains, there are some retailers who work honestly and convey truthful information to their partners even in the absence of reputation-building mechanisms and obligatory contracts. However, there may be some deceptive agents, which manipulate their private information to increase their own performances. According to Özer et al. (2011), this disutility of misreporting can be interpreted as a psychological cost derived from the retailers’ aversion to be caught in deceit. On the other side, the supplier’s ability to discriminate between honest and deceptive retailers has an important role in truthful information sharing. In other words, honest retailers may report truthful information as long as the coordination mechanism is fair enough as for Alger and Renault (2006). Retailers with better abilities to misrepresent their private information can benefit from the existence of honest retailers who are not able or not willing to misreport their private information (Severinov and Deneckere, 2006). Voigt (2009) links information sharing, trust and trustworthiness to a traditional principal-agent setting in a supply chain. He claims that the strategic use of private information harms the total supply chain performance. He concludes that the effect of information sharing on the supplier’s performance is not clear. Especially, if the supplier manages to assess the retailer’s information sharing behavior delicately to find the probability of credible signals, he will be able to improve his performance. In studying different collaborative organization structures, Cheikhrouhou et al. (2012) identify trust as one of the most important factors that has to be considered to improve and to sustain the global performances. They state that trust plays an important role not only in coordinating the activities between enterprises of a networked organization, but also during the different other phases of its lifecycle.

So far, studies have been confined to develop coordination mechanisms regarding only financial/economic factors. This paper introduces Trust as a main non-pecuniary factor to develop coordination mechanisms in decentralized supply chain using simple and prevalent contracts. To the best of our knowledge, there is not any study that develop a coordination mechanism based on Trust. In this paper, it is assumed that players are not Bayesian decision makers. Furthermore, repeated interactions and partial forecast information sharing are considered in the proposed mechanism. The mechanism proposed is associated with a rewarding-punishing system to relatively identify the deceptive agents and to encourage honest agents to continue sharing their private information truthfully. An optimization model is designed as a building block of the mechanism and transformed into a mixed-integer quadratic model to ease its resolution. To better examine the performance of the proposed mechanism in different contextual situations, four situations are chosen in terms of both market size and demand variability, two levels determined for each factor. The mechanism is evaluated in each situation according to ten different reporting strategies using a Monte-Carlo simulation approach. A short description about the Monte Carlo simulation is provided in the Supplementary document. As dimensions of models considered in this study grow, computation time may increase if applications such as CPLEX are used to find optimal solutions. In these cases, Meta-heuristic methods can be helpful to implement the proposed mechanism in reasonable time (Engelbrecht, 2007; Haupt and Haupt, 2004; Ganesan and Vasant, 2012; Vasant, 2010; Vasant and Barsoum, 2009).

The rest of this paper is organized in the following way. In Section 2, a description of the model and its features are provided. Basic mathematical optimization model is presented and trust-based coordination mechanism is explained. In Section 3, an approximate mathematical optimization model is built and the resolution method is detailed. Section 4 presents the simulation experiments of the proposed mechanism in four different contextual situations. In Section 5, results of simulation experiments and performance evaluation regarding ten different strategies are represented. Finally, Section 6 concludes the work and provides future research directions.

We consider the problem of coordination by contract in a divergent supply chain constituted by one supplier and several retailers which produce fashion products with short sale seasons. Retailers’ demand are independent of each other. The product considered is a fashionable product and can be changed for each period in its fashion features but not in nature. Demand is stochastic and price-dependent, which is represented by a linear decreasing function of retailer’s price to which a stochastic variable is added in order to capture the demand uncertainty. It is assumed that the stochastic demand variable has a truncated normal distribution on definite and predetermined intervals. The retailers cooperates with the supplier in the form of sale agents; i.e., they work in the framework of revenue sharing contracts. Parameters of Demand functions and probability distributions are common knowledge between the supplier and the retailers. However, owing to retailers’ proximity to the market, they can provide more accurate demand forecast by the time the supplier decides on his capacity building (expansion), product assignment and market price. In order to take these decisions, the supplier considers the constraints regarding retailers’ different lead times. On account of retailers’ information prominence, the retailers have an incentive to exaggerate their private forecast information to benefit from acquiring high quantity of products, to avoid stock outs and increase their sales when it is possible. In addition, the retailers can have considerable influence on the supplier’s capacity and price decision through manipulating their own prominent forecast information. The information prominence of the retailers can be formulated in a way that the retailers are assumed to estimate the stochastic demand within a significantly tighter interval than that of the supplier. Since retailers cooperate as agents with the supplier, the supplier holds the ownership of products all the time until they are delivered to final customers. Hence, production costs, u
                     
                        s,i
                     , and holding costs, h
                     
                        s,i
                     , are assumed to only be attributed to the supplier i. Different values of u
                     
                        s,i
                      and h
                     
                        s,i
                      are considered due to different operational and holding costs from the retailers’ side, for which the supplier is responsible due to the product ownership.

We assume that the supplier and the retailers cooperate on a long-term basis. The supplier produces similar kinds of fashion products in each time period. A product batch is sold during a single period. For the next period, the product nature is constant, and the changes are only subject to fashionable features and apparent specifications like color and design. As a consequence, the demand form, distribution and parameters are the same over all periods. During the time between two consequent periods, the supplier needs a specific time as a set up time or an extra capacity building time. Then, the supplier starts production with the provided production rate and delivers the products to each retailer once in each period. Based on his optimization model, the supplier decides on the quantity to deliver to each retailer for the coming period. Delivery lead-times are deterministic and not necessarily equal, thus, the supplier has several dispatches at different times to satisfy all the retailers. The proposed mechanism includes a scoring and rating system based on the result of a Matched-Pairs t-test to examine whether there is any significant difference between reported information and actual demand. At the end of each period, the scores are updated and the retailers are divided into three groups according to their scores: High trust, Medium trust and Low trust groups. Three different revenue sharing contracts are then designed to take appropriate measures to exert discrimination between honest and deceptive agents according to each retailer’s score. To the low trust group, a stringent contract is assigned, whereas a moderate contract is proposed to the medium trust group, and a trust-based contract is offered to the high trust group. Ten different reporting strategies are developed so as to examine the performance of the proposed mechanism in identifying deceptive agents and the possible improvement in the whole chain performance. To do so, two factors are considered: First, exaggeration in demand forecast amount, which is considered at three levels (5%, 10% and 15%). Second, frequency of exaggeration which also has three levels (every period, every two periods and every three periods). Combinations of different levels of the two factors constitute nine strategies, to which the honesty strategy is added, obtaining finally 10 reporting strategies. The following notations and definitions are used in modeling:

The demand, as presented in Eq. (1), consists of a deterministic part which has to be completely satisfied by the supplier and a stochastic part specified by ε
                     
                        i
                     . In addition to satisfy all of her deterministic demand, D
                     
                        i
                     (p
                     
                        i
                     ), in order to cope with stochastic part of demand, the retailer i places her safety reservation quantity, X
                     
                        i
                     . In this way, the retailer i expects to sell S(X
                     
                        i
                     ) quantity of the products regarding X
                     
                        i
                      as well as her deterministic demand, D
                     
                        i
                     (p
                     
                        i
                     ), see Eq. (3).
                        
                           (1)
                           
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              +
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    D
                                 
                                 
                                    i
                                 
                              
                              (
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              )
                              =
                              
                                 
                                    a
                                 
                                 
                                    1
                                    i
                                 
                              
                              -
                              
                                 
                                    a
                                 
                                 
                                    2
                                    i
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              ∈
                              (
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ̲
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                              
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          ¯
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                              )
                              ,
                              
                              ∀
                              i
                              =
                              1
                              ,
                              2
                              ,
                              …
                              ,
                              n
                           
                        
                     
                  

One of the building blocks of the proposed Trust-based mechanism (detailed in Section 2.2) is the optimization model used by the supplier and the retailers to make their decisions. The retailers do not have explicit decisions in the proposed mechanism and they act as sales agents, but they have an implicit decision which is to decide on whether they should exaggerate their forecasts and how much. The supplier is assumed to be committed to deliver products to retailers at a specific predetermined due date which is set to the beginning of each selling period. The supplier determines the quantity to deliver to each retailer. In addition, it is assumed that lead times are deterministic and known. Therefore, lead times are sorted in a descending order, and the index i is then used to specify this order; i.e., L
                        1 denotes the largest lead-time and corresponds to retailer 1. Note that using this method, retailers are numbered too. In this way, the supplier has to send the products to retailers at different time points according to their different lead times. It is assumed that the production starts k time units before the beginning of each selling period (see Fig. 1
                        ).

Considering that φ
                        
                           i
                         and r
                        
                           i
                         are parameters of the revenue sharing contract applied to retailer i, the latter should pay r
                        
                           i
                         for each reserved product and earns φ
                        
                           i
                         portion of price of each sold product. The supplier revenue is constituted of reservation fee and revenue earned from selling products as presented in Eq. (2). The expected quantity sold according to the stochastic demand and the safety reservation quantity, X
                        
                           i
                         of retailer i is denoted by S(X
                        
                           i
                        ) as shown in Eq. (3). Particularly, S(X
                        
                           i
                        ) is the expected sales regardless of deterministic demand if safety reservation quantity of retailer i is X
                        
                           i
                        . Henceforth, X
                        
                           i
                         and W
                        
                           i
                        
                        − (a
                        
                           i1
                        −
                        a
                        
                           i2
                        p
                        
                           i
                        ) will be used in an exchangeable way.
                           
                              (2)
                              
                                 
                                    
                                       Supplier
                                    
                                    
                                       ′
                                    
                                 
                                 s
                                 
                                 revenue
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 {
                                 (
                                 1
                                 -
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 [
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 +
                                 S
                                 (
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                                 ]
                                 +
                                 
                                    
                                       r
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 }
                              
                           
                        
                        
                           
                              (3)
                              
                                 S
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 =
                                 (
                                 1
                                 -
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 )
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (4)
                              
                                 where
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                        
                     

The supplier’s Non-Linear Constrained optimization model (NLC) is to maximize his profit, considering his revenue in Eq. (2).


                        NLC Model
                        
                           
                              (5)
                              
                                 Max
                                 
                                 f
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 (
                                 1
                                 -
                                 
                                    
                                       φ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             ∫
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      W
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                (
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                      1
                                                   
                                                
                                                -
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      i
                                                      2
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                                )
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      ∊
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          d
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                r
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                u
                                             
                                             
                                                s
                                                ,
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                h
                                             
                                             
                                                s
                                                ,
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         k
                                                         -
                                                         
                                                            
                                                               L
                                                            
                                                            
                                                               M
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         L
                                                      
                                                      
                                                         M
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 W
                                 -
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (6)
                              
                                 
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   A
                                                
                                             
                                             Y
                                             ⩽
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ⩽
                                             
                                                
                                                   c
                                                
                                                
                                                   A
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (7)
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 ⩽
                                 
                                    
                                       c
                                    
                                    
                                       B
                                    
                                 
                                 Y
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 [
                                 k
                                 -
                                 
                                    
                                       L
                                    
                                    
                                       i
                                    
                                 
                                 ]
                                 (
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                                 ⩽
                                 0
                                 ,
                                 
                                 ∀
                                 t
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                    
                                       
                                          
                                             
                                                LB
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                p
                                             
                                             
                                                i
                                             
                                          
                                          ⩽
                                          
                                             
                                                UB
                                             
                                             
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                W
                                             
                                             
                                                i
                                             
                                          
                                          ⩾
                                          0
                                          ,
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          …
                                          ,
                                          n
                                          ;
                                          
                                          
                                             
                                                C
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                C
                                             
                                             
                                                2
                                             
                                          
                                          ⩾
                                          0
                                          ;
                                          
                                          Y
                                          =
                                          0
                                          
                                          or
                                          
                                          1
                                       
                                    
                                 
                              
                           
                        
                     

As inventory costs are not the optimization focus in this model, they are approximated with linear functions to simplify the model. The precise production time is 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              /
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         which can be at most k
                        −
                        L
                        
                           n
                        . In order to satisfy on-time delivery constraints, i.e., Eq. (8), the production time may be considerably less than k
                        −
                        L
                        
                           n
                        . Therefore, a linear approximation of 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    n
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              /
                              (
                              
                                 
                                    C
                                 
                                 
                                    1
                                 
                              
                              +
                              
                                 
                                    C
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         can be (k
                        −
                        L
                        
                           M
                        ), where L
                        
                           M
                         is the median of L
                        
                           i
                        . Eq. (8) represents the constraints which guarantee the existence of enough quantity of products for all sendings with regard to the different retailers’ lead times. The left side of constraint (9) is equivalent to safety reservation quantity of retailer i. X
                        
                           i
                        , and d
                        
                           i
                         at the right side are constant values which work as the upper bounds for the values of X
                        
                           i
                        . The reason of this restriction is to avoid possible situations where a retailer may use an abnormally high price to benefit from sales with regards to the stochastic demand.

We propose the following approach to determine an approximate solution as shown in Fig. 1. The flowchart depicts the steps and actions of the proposed mechanism.
                           
                              1.
                              The supplier solves his optimization problem (described in Section 4 – AQMI model) with regard to the available capacity amount C
                                 
                                    A
                                 , which is set to zero at the beginning, and by ignoring retailers’ reported information. The optimal values of the optimization model build the supplier’s belief that 
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             s
                                             ,
                                             i
                                          
                                       
                                       =
                                       
                                          
                                             X
                                          
                                          
                                             i
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 , about stochastic demand.

The retailers prepare their own interval forecasts of stochastic demand with length of ρσ
                                 
                                    i
                                 , i.e. 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      ρ
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ̃
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      ρ
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .

Each retailer makes up her reported interval with length of ρσ
                                 
                                    i
                                 , i.e. 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ⌢
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      ρ
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ⌢
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      ρ
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 , using one of the predefined reporting strategies considered in Section 4.

The supplier updates his prior belief about the stochastic demand regarding retailers’ reports. Particularly, he creates his Trust-based interval estimation regarding his own belief and retailers’ reports using Eq. (11); i.e. 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      TB
                                                      ,
                                                      i
                                                   
                                                
                                                -
                                                
                                                   
                                                      ρ
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                ,
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      TB
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   
                                                      ρ
                                                      
                                                         
                                                            σ
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                       
                                    
                                 .
                                    
                                       (11)
                                       
                                          
                                             
                                                ε
                                             
                                             
                                                TB
                                                ,
                                                i
                                             
                                          
                                          =
                                          (
                                          1
                                          -
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                ε
                                             
                                             
                                                s
                                                ,
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                α
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      ⌢
                                                   
                                                
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              

The supplier solves his optimization model (Section 4 – AQMI model) using the Trust-based interval. To do so, conditional cumulative distribution function is substituted into the optimization model for non-conditional one. The optimal solution is obtained, and the capacity expansion, number of products, products assignment and market price are determined according to the optimal solution. The required capacity is built, the production is done regarding available production rate, and each retailer’s products are sent to them on time.

During the selling period, each retailer observes the actual demand. As the players use revenue sharing contracts in their transactions, the supplier knows the actual demand quantity. Once the actual demand, D
                                 
                                    i
                                 (p
                                 
                                    i
                                 ,
                                 ε
                                 
                                    i
                                 ), is determined, the value of actual stochastic demand ε
                                 
                                    i
                                 , can be calculated using Eq. (1) concerning the value of p
                                 
                                    i
                                 . In other words, this mechanism takes into account partial information feedback; That is, at the end of each selling season, although the supplier is aware of the actual demand, he does not have access to the retailers’ private forecast information.

The difference between each retailer’s reported demand information and the actual demand quantity is tested using Matched-Pairs t-test with three different significance levels to determine how much a retailer is trustworthy. The hypotheses considered are detailed in the following equations:
                                    
                                       (12)
                                       
                                          
                                             
                                                H
                                             
                                             
                                                0
                                             
                                          
                                          :
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ⌢
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          >
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       (13)
                                       
                                          
                                             
                                                H
                                             
                                             
                                                1
                                             
                                          
                                          :
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            ε
                                                         
                                                         
                                                            ⌢
                                                         
                                                      
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          ⩽
                                          
                                             
                                                μ
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              

The retailer can earn or lose some points according to the following rules:
                                    
                                       7.1.
                                       To conduct this test, data for the last d periods are considered.

For the first d periods, it is assumed that all retailers have a score of Score
                                          
                                             i,init
                                          .

If Null hypothesis is rejected at a significance level of SL
                                          1, the retailer gets η
                                          ++ points (η
                                          ++
                                          >0).

Otherwise if Null hypothesis is rejected at a significance level of SL
                                          2, the retailer gets η
                                          + points (η
                                          ++
                                          >
                                          η
                                          +
                                          >0).

Otherwise if Null hypothesis is rejected at a significance level of SL
                                          3, the retailer gets η
                                          − point (η
                                          −
                                          <0). If it is failed to be rejected, the retailer gets η
                                          −− point (η
                                          −−
                                          <
                                          η
                                          −).

Scores acquired by retailers have to be integer values from 
                                             
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                            -
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                           to 10. In other words, no retailer can have a score greater than 10 or less than 
                                             
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                            -
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                          . This means that if a retailer’s score is 10 and then earns an extra point, the score is still 10. Likewise, if a retailer has ascore of 
                                             
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                            -
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                           and then loses some points, she keeps her 
                                             
                                                
                                                   
                                                      10
                                                   
                                                   
                                                      
                                                         
                                                            α
                                                         
                                                         
                                                            i
                                                            -
                                                            min
                                                         
                                                      
                                                   
                                                
                                             
                                           score.

The scores are normalized (divided by 10) and used as supplier’s trust factor in retailer i, α
                                          
                                             i
                                           in the next period.

One of three revenue sharing contracts is assigned to each retailer based on their scores according to the following rules:
                                    
                                       8.1.
                                       If a retailer’s score is equal or less than a lower threshold, it is put into the low trust group to which a stringent contract is assigned.

If a retailer’s score is greater than the lower threshold and less than or equal to an upper threshold, it is put into the medium trust group to which a moderate contract is assigned.

If a retailer’s score is greater than the upper threshold, it is put into the high trust group to which a trust-based contract is assigned.

The long-term interaction between the supplier and retailers has be conducted using the above mechanism where each iteration corresponds to each selling season. The stopping criterion considered in the trust based coordination mechanism is the number of periods. Note that in real world, the supplier may come across situations where most of the retailers lay in low trust group. In this situation, the supplier may decide to terminate his cooperation with the deceptive retailers and replace them by new ones.

Note that α
                        
                           i
                         is the supplier’s trust factor in retailer i and quantifies the supplier’s relative confidence in the retailer’s reported forecast. If α
                        
                           i
                        
                        =1, the supplier fully trusts the retailer. Inversely, if α
                        
                           i
                        
                        =0, the supplier considers the report as an upper bound for her real forecast. Unlike in Özer et al. (2011), which is subject to a ‘cheap talk’ in a dyadic supply chain under a simple wholesale contract, a trustworthiness evaluation mechanism is included in our proposed coordination mechanism. Thus, retailers are ‘rewarded’ or ‘punished’ using three proposed revenue sharing contracts according to their scores. A flowchart is provided in Supplementary document which depicts the above mentioned steps. In addition, a detailed flowchart is provided in Section 4 “Simulation experiments”.

The constraints in the NCL model are linear and the decision variables are either real or binary integer, but the objective function is non-linear. In order to solve this model, discretization of price variables and linear approximation of demand cumulative distribution functions are used. The model is then transformed into a mixed-integer quadratic programming model which is solved using CPLEX 12.3.

Price levels are used instead of price decision variables to solve the multiplication issue in the objective function. The feasible interval for p
                        
                           i
                         is discretized using m
                        
                           i
                         points which may be located at unequal distances from each other. Discretization Model of Price (DMP) is as follows:


                        DMP Model
                        
                           
                              (14)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                   ,
                                                
                                                
                                                   If
                                                   
                                                   jth
                                                   
                                                   price
                                                   
                                                   level
                                                   
                                                   of
                                                   
                                                   retailer
                                                   
                                                   i
                                                   
                                                   is
                                                   
                                                   chosen
                                                
                                             
                                             
                                                
                                                   0
                                                   ,
                                                
                                                
                                                   Otherwise
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                    
                                       
                                       
                                          
                                             0
                                             ⩽
                                             
                                                
                                                   X
                                                
                                                
                                                   ij
                                                
                                             
                                             ⩽
                                             M
                                             .
                                             
                                                
                                                   Z
                                                
                                                
                                                   ij
                                                
                                             
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                             ,
                                             
                                             and
                                             
                                             M
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             
                                             
                                             
                                             has a sufficiently large value.
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (17)
                              
                                 0
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                 
                                 ⩽
                                 
                                    
                                       d
                                    
                                    
                                       i
                                    
                                 
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 0
                                 
                                 or
                                 
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ;
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                     

Eq. (16) makes sure that only one price level is chosen for each retailer. Eq. (15) defines the relationship between each price level and its corresponding safety reservation quantity where if a price level is not chosen, its relevant X
                        
                           ij
                         must be zero. It is worth noting that the relations in Eq. (18) hold:
                           
                              (18)
                              
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       i
                                    
                                 
                                 ;
                                 
                                 
                                    
                                       X
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ;
                                 
                                 
                                    
                                       W
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ;
                                 
                                 
                                    
                                       W
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 (
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       1
                                    
                                 
                                 -
                                 
                                    
                                       a
                                    
                                    
                                       i
                                       2
                                    
                                 
                                 
                                    
                                       p
                                    
                                    
                                       ij
                                    
                                 
                                 )
                                 
                                    
                                       Z
                                    
                                    
                                       ij
                                    
                                 
                              
                           
                        
                     

In order to approximate the function 
                           
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              )
                              d
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                           
                         where 
                           
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              )
                           
                         is the cumulative normal distribution function with the parameters (μ
                        
                           i
                        ,σ
                        
                           i
                        ), linear approximation is used. The five break points used for the approximation are indicated in Table 1
                        . As this approximation results in a mixed integer quadratic programming model, the number of break points has significant effect on the complexity of the model and the required time to find an acceptable solution. In order to avoid imposing unnecessary complexity on the model, a five-break-point approximation is used, which provides acceptable errors for normal values greater than μ
                        
                           i
                        
                        −1.9σ
                        
                           i
                        . Table 1 shows the break points and the maximum values of errors in the interval between consecutive break points. In this table, error 1 is the difference between the values of approximated and original cumulative distribution function. Error 2 denotes the difference between the values of integral of approximating function and integral of normal CDF function. Although the maximum value of error 1 for normal values less than μ
                        
                           i
                        
                        −1.9σ
                        
                           i
                         is 521%, the probability values in this interval are so small that the linear approximation is acceptable. The maximum error 1 significantly decreases with the increase of normal value to the extent that for the normal values greater than μ
                        
                           i
                        
                        −1.9σ
                        
                           i
                        , the maximum value of error 1 is only 4.3%. The values of maximum error 2 shown in Table 1 indicate that the error resulted from this method has less impact on the model for normal values less than μ
                        
                           i
                        
                        −1.9σ
                        
                           i
                         due to the fact that integral of normal CDF is used in the objective function.

To ensure that the stochastic demand is always positive; the tiny probability of negative demand is eliminated in the linear approximation which has positive impact on reducing approximating errors. The approximating function is shown as follows:
                           
                              (19)
                              
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ≅
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         0.0189
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   1.9
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0.0287
                                                   +
                                                   
                                                      
                                                         0.14444
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   ⩽
                                                   0.9
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0.1587
                                                   +
                                                   
                                                      
                                                         0.3237
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         3
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         3
                                                      
                                                   
                                                   ⩽
                                                   2.3
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   0.9032
                                                   +
                                                   
                                                      
                                                         0.0459
                                                      
                                                      
                                                         
                                                            
                                                               σ
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         4
                                                      
                                                   
                                                   ,
                                                
                                                
                                                   0
                                                   ⩽
                                                   
                                                      
                                                         ε
                                                      
                                                      
                                                         i
                                                         4
                                                      
                                                   
                                                   ⩽
                                                   2.1
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 where
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    
                                       ε
                                    
                                    
                                       il
                                    
                                 
                              
                           
                        
                     

After substituting Eq. (19) into 
                           
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              )
                              d
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                           
                         and taking the definite integral, the following Quadratic Approximation model (QA) obtained includes a quadratic mixed integer expression under constraints (21)–(25). 
                           
                              App
                              
                                 
                                    
                                       
                                          ∫
                                          
                                             0
                                          
                                          
                                             
                                                
                                                   X
                                                
                                                
                                                   ij
                                                
                                             
                                          
                                       
                                       
                                          
                                             F
                                          
                                          
                                             
                                                
                                                   ε
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                       (
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       d
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                              
                           
                         denotes the quadratic approximation of 
                           
                              
                                 ∫
                                 
                                    0
                                 
                                 
                                    
                                       
                                          X
                                       
                                       
                                          ij
                                       
                                    
                                 
                              
                              
                                 
                                    F
                                 
                                 
                                    
                                       
                                          ε
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              (
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                              )
                              d
                              
                                 
                                    ε
                                 
                                 
                                    i
                                 
                              
                           
                        , See Eq. (20):


                        QA Model
                        
                           
                              (20)
                              
                                 
                                    ∫
                                    
                                       0
                                    
                                    
                                       
                                          
                                             X
                                          
                                          
                                             ij
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       
                                          
                                             ε
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       ε
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 d
                                 
                                    
                                       ε
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ≅
                                 App
                                 
                                    
                                       
                                          
                                             ∫
                                             
                                                0
                                             
                                             
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      ij
                                                   
                                                
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                
                                                   
                                                      ε
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          d
                                          
                                             
                                                ε
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       0.0189
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       0.1444
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       2
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       0.3237
                                    
                                    
                                       2
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       3
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       0.0459
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       4
                                    
                                    
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       0.0189
                                    
                                    
                                       
                                          
                                             σ
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       μ
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 1.9
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       2
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                0.0189
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1.9
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          0.1444
                                          ×
                                          0.9
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 +
                                 
                                    
                                       
                                          
                                             
                                                0.0189
                                             
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                μ
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          1.9
                                          
                                             
                                                σ
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          +
                                          0.1444
                                          ×
                                          0.9
                                          +
                                          0.3237
                                          ×
                                          2.3
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       4
                                    
                                 
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             1.9
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   Y
                                                
                                                
                                                   ij
                                                   2
                                                
                                             
                                             ⩽
                                             
                                                
                                                   X
                                                
                                                
                                                   ij
                                                   1
                                                
                                             
                                             ⩽
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             1.9
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   Y
                                                
                                                
                                                   ij
                                                   1
                                                
                                             
                                             ,
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (22)
                              
                                 0.9
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       2
                                    
                                 
                                 ⩽
                                 0.9
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       2
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (23)
                              
                                 2.3
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       4
                                    
                                 
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 ⩽
                                 2.3
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (24)
                              
                                 0
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       4
                                    
                                 
                                 ⩽
                                 2.1
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       4
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ijl
                                    
                                 
                                 =
                                 0
                                 
                                 or
                                 
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                     

With regard to the approximation and the new decision variables, Eq. (26) can be written:
                           
                              (26)
                              
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          l
                                          =
                                          1
                                       
                                       
                                          4
                                       
                                    
                                 
                                 
                                    
                                       X
                                    
                                    
                                       ijl
                                    
                                 
                              
                           
                        
                     

The discretization model (DMP) and quadratic approximation model (QA) described respectively in Sections 3.1 and 3.2 are applied to NCL model which results in the following Approximated Quadratic Mixed Integer (AQMI) model:


                        AQMI Model
                        
                           
                              (27)
                              
                                 Max
                                 
                                 f
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          (
                                          1
                                          -
                                          
                                             
                                                φ
                                             
                                             
                                                1
                                             
                                          
                                          )
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                ij
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                         1
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         i
                                                         2
                                                      
                                                   
                                                   
                                                      
                                                         p
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   )
                                                   +
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   App
                                                   
                                                      
                                                         
                                                            
                                                               ∫
                                                               
                                                                  0
                                                               
                                                               
                                                                  
                                                                     
                                                                        X
                                                                     
                                                                     
                                                                        ij
                                                                     
                                                                  
                                                               
                                                            
                                                            
                                                               
                                                                  F
                                                               
                                                               
                                                                  
                                                                     
                                                                        ε
                                                                     
                                                                     
                                                                        i
                                                                     
                                                                  
                                                               
                                                            
                                                            (
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            )
                                                            d
                                                            
                                                               
                                                                  ε
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         r
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         s
                                                         ,
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         h
                                                      
                                                      
                                                         s
                                                         ,
                                                         i
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  (
                                                                  k
                                                                  -
                                                                  
                                                                     
                                                                        L
                                                                     
                                                                     
                                                                        M
                                                                     
                                                                  
                                                                  )
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  L
                                                               
                                                               
                                                                  M
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  T
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   =
                                                   1
                                                
                                                
                                                   
                                                      
                                                         m
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          [
                                          
                                             
                                                X
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                i
                                                1
                                             
                                          
                                          -
                                          
                                             
                                                a
                                             
                                             
                                                i
                                                2
                                             
                                          
                                          
                                             
                                                p
                                             
                                             
                                                ij
                                             
                                          
                                          )
                                          ]
                                       
                                    
                                 
                                 -
                                 (
                                 
                                    
                                       λ
                                    
                                    
                                       1
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 
                                    
                                       λ
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 )
                              
                           
                        
                        
                           
                              (28)
                              
                                 
                                    
                                       
                                       
                                          
                                             s
                                             .
                                             t
                                             .
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   c
                                                
                                                
                                                   A
                                                
                                             
                                             Y
                                             ⩽
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             ⩽
                                             
                                                
                                                   c
                                                
                                                
                                                   A
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (29)
                              
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 ⩽
                                 
                                    
                                       c
                                    
                                    
                                       B
                                    
                                 
                                 Y
                              
                           
                        
                        
                           
                              (30)
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                      =
                                                      1
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      j
                                                      =
                                                      1
                                                   
                                                   
                                                      
                                                         
                                                            m
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                             
                                             [
                                             
                                                
                                                   X
                                                
                                                
                                                   ij
                                                
                                             
                                             -
                                             (
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                   1
                                                
                                             
                                             -
                                             
                                                
                                                   a
                                                
                                                
                                                   i
                                                   2
                                                
                                             
                                             
                                                
                                                   p
                                                
                                                
                                                   ij
                                                
                                             
                                             )
                                             ]
                                             -
                                             [
                                             k
                                             -
                                             
                                                
                                                   L
                                                
                                                
                                                   j
                                                
                                             
                                             ]
                                             (
                                             
                                                
                                                   C
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   C
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ⩽
                                             0
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             ∀
                                             t
                                             =
                                             1
                                             ,
                                             …
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (31)
                              
                                 
                                    
                                       
                                          0
                                          ⩽
                                          
                                             
                                                X
                                             
                                             
                                                ij
                                             
                                          
                                          ⩽
                                          
                                             min
                                          
                                          (
                                          M
                                          ,
                                          
                                             
                                                d
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          
                                             
                                                Z
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                       
                                       
                                          ∀
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          n
                                          ,
                                          j
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          where
                                          
                                          M
                                          
                                          is
                                          
                                          a
                                          
                                          sufficient
                                          
                                          large
                                          
                                          value
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (32)
                              
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          =
                                          1
                                       
                                       
                                          
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       Z
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                              
                           
                        
                        
                           
                              (33)
                              
                                 
                                    
                                       
                                       
                                          
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             1.9
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   Y
                                                
                                                
                                                   ij
                                                   2
                                                
                                             
                                             ⩽
                                             
                                                
                                                   X
                                                
                                                
                                                   ij
                                                   1
                                                
                                             
                                             ⩽
                                             (
                                             
                                                
                                                   μ
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             1.9
                                             
                                                
                                                   σ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             
                                                
                                                   Y
                                                
                                                
                                                   ij
                                                   1
                                                
                                             
                                             
                                             ∀
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             n
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             j
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   m
                                                
                                                
                                                   i
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (34)
                              
                                 0.9
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       2
                                    
                                 
                                 ⩽
                                 0.9
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       2
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (35)
                              
                                 2.3
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       4
                                    
                                 
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 ⩽
                                 2.3
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       3
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (36)
                              
                                 0
                                 ⩽
                                 
                                    
                                       X
                                    
                                    
                                       ij
                                       4
                                    
                                 
                                 ⩽
                                 2.1
                                 
                                    
                                       σ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       Y
                                    
                                    
                                       ij
                                       4
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (37)
                              
                                 
                                    
                                       Z
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 0
                                 
                                 or
                                 
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                              
                           
                        
                        
                           
                              (38)
                              
                                 
                                    
                                       Y
                                    
                                    
                                       ijl
                                    
                                 
                                 =
                                 0
                                 
                                 or
                                 
                                 1
                                 ,
                                 
                                 ∀
                                 i
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 n
                                 ,
                                 
                                 j
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 …
                                 ,
                                 
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 l
                                 =
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 ,
                                 4
                              
                           
                        
                        
                           
                              (39)
                              
                                 Y
                                 =
                                 0
                                 
                                 or
                                 
                                 1
                              
                           
                        
                        
                           
                              (40)
                              
                                 
                                    
                                       C
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       2
                                    
                                 
                                 ⩾
                                 0
                              
                           
                        
                     

In order to examine the performance of the proposed Trust-based mechanism, two important streams are considered: Reporting strategies and contextual situations. The former stream addresses the efficiency of the proposed mechanism in rewarding honest agents and punishing deceptive agents. In order to address this concern, several reporting strategies are developed so as to examine the performance of the proposed mechanism in identifying deceptive agents and the possible improvement in the whole chain’s performance. Two factors are then considered: exaggeration of demand forecast which is considered at three levels (5%, 10% and 15%) and frequency of exaggeration which also has three levels (every period, every two periods and every three periods of time). Combinations of different levels of the two factors constitute nine reporting strategies completed by adding the honesty strategy, leading to 10 reporting strategies. The latter stream emphasizes possible effects of different contextual situations on the performance of the proposed mechanism. In order to take into account contextual situations, two factors, each at two levels, are identified and shown in Table 2
                     . In this way, there are four different supply chain instances to be examined. The detailed flowchart provided in Fig. 2
                      illustrates different processes in the simulation approach.

Long-term interactions between the supplier and 10 retailers is simulated for 26 periods, which are divided into two stages: the first six periods and the last 20 periods. During the first stage (first six periods), a moderate contract is employed to conduct transactions between the players regardless whether the individual retailer is honest or deceptive due to the lack of sufficient data to conduct statistical tests. The second stage can be better representative of performance of the mechanism in long-term interactions. However, average profits of retailers, supplier and total supply chain over the last 20 periods are considered as a performance criterion.

Owing to the fact that differences between profits in different mechanisms are compared using a simulation approach, sufficient number of simulation runs can be computed using interval estimation concept in matched-pairs experiments. In this way, number of simulation runs is equal to n
                     = (2sz
                     
                        α/2/E)2 where s is the estimated standard deviation of the sample and E is the desirable error. In this study, data from the last 20 periods is used in the comparison of the differences between mechanisms of interest, which are sufficient in all four contextual situations (Bowker and Lieberman (1959)).

The parameters values for the supply chain instances corresponding to A
                     1 and A
                     2 are presented in Table 3
                     . Let μ
                     
                        i
                     
                     =0.45a
                     
                        i1 for all retailers in all supply chain instances. It is worth recalling from Table 2 that demand variability (B factor) is characterized by its standard deviation. Furthermore, three types of revenue sharing contracts shown in Table 4
                      are employed to manage interactions between the supplier and the retailers. Different reservation fees are considered for each level of the contextual factor A owing to different price ranges which each level of factor A concerns with.

The parameters values of the Trust-based coordination mechanism used to run the scoring system and to calculate the trust index values are summarized in Table 5
                     .

Two other mechanisms named as No Trust (NT) and Symmetric Information (SI) are considered in this study to compare the performances of the Trust-Based (TB) mechanism with other coordination mechanisms. If the supplier has no trust in the retailers’ reported information, he has no choice but to decide upon his own information about the demand (“No Trust”). Another extreme case is when the supplier and retailers work as a whole as if they belong to a centralized supply chain, where the retailers truly share their private forecast information with the supplier (“Symmetric Information”). Performances of these two extreme cases can be used as upper and lower bounds for the performance of the trust-based mechanism.

Let E
                     
                        l
                     
                     F
                     
                        v
                      specify a reporting strategy employed for an interaction, where E
                     
                        l
                      stands for “Exaggeration level l” and F
                     
                        v
                      stands for “Frequency level v”. Three levels are used for the Frequency of exaggeration because report inflation in every four period can be considered as insignificant and then ignored. On the other hand, three levels of exaggeration in forecast information are used so as to reduce the number of simulation runs. It is clear that higher number of levels with a smaller increment in exaggerations will lead to more accurate results. A sequence of 10 reporting strategies expressed as “Honesty, E
                     1
                     F
                     1, E
                     2
                     F
                     1, E
                     3
                     F
                     1, E
                     1
                     F
                     2, E
                     2
                     F
                     2, E
                     3
                     F
                     2, E
                     1
                     F
                     3, E
                     2
                     F
                     3, E
                     3
                     F
                     3”, is considered to conduct 10 simulation runs for each one of the four treatments. This sequence means that, simultaneously in the first run, Honesty reporting strategy is applied to retailer 1, E
                     1
                     F
                     1 is applied to retailer 2 and so on. In order to build the second sequence, the first strategy is moved from the beginning to the end of the sequence. By repeating this method, 10 different sequences are generated and used to conduct 10 simulation runs for each treatment whereby each retailer experiences all reporting strategies, and in each simulation run, all reporting strategies are present. This configuration permits to compare a retailer’s average profits under different reporting strategies. The average profits of retailers, supplier and total chain over the last 20 periods are considered as performance evaluation criteria. Moreover, utilization of each contract type as a percentage is used to evaluate the performance of the rewarding-punishing system with respect to different reporting strategies.

In order to simulate and compare the performances, simulations are implemented using MATLAB 2008a and IBM ILOG CPLEX Optimization Studio Academic Research Edition version 12.3, and Microsoft Excel 2007 on a computer with Intel® Core 2 Duo CPU 2gigahertz and 4gigabytes RAM.

The ‘SI’ case is an ideal one, where the retailers perfectly share forecast information with the supplier. The profit improvement of the total chain in this model compared to that of ‘NT’ model indicates the maximum potential improvement hidden in the forecast information sharing process. The relative Achieved Percentage of Possible Improvement (APPI) is considered in this section in a way that the ‘NT’ model gets 0% and the ‘SI’ model obtains 100% using the APPI index, and any other mechanism, based on how much improvement it can accomplish, scores a percentage between them. The row of Possible improvement Percentage (PIP) in Table 6
                      shows the improvement derived from comparing the ‘SI’ and the ‘NT’ mechanisms. The last row of Table 6 presents the Achieved Improvement Percentage (AIP) by the ‘TB’ mechanism as compared to ‘NT’ mechanism. As a main performance index, AIP is used, and the other two indexes complement the discussion. The values of the indices are summarized in Table 6.

As Table 6 shows, the highest value of AIP as well as the highest PIP correspond to the case A2B2. The case A1B2 with PIP of 8.63% and APPI of 67.88% ranks second on the basis of profit improvement in the total chain.

On the side of fair observance and discriminatory measures to differentiate between honest and deceptive agents, the proposed ‘TB’ mechanism is better off in A1B1 situation. The greatest number of generous contracts are offered to agents with honesty strategy in this contextual situation. Agents with F3 strategies are ranked second, whereas no generous contract is offered to agents with other types of strategies. In addition, the highest number of stringent contracts are subject to agents with F1 and F2 strategies. However, honest agents and agents with F3 strategies could not keep away from the harm of stringent contracts in respectively on average 7.1% and 10% of the last 20 periods (Fig. 3
                     a). A2B1 has similar performance to the former situation. A small difference is observed in the percentage of offered contracts over 26 periods in 10 different runs regarding the strategy F2E1, where the percentage of stringent contract is reduced in favor of mostly moderate contracts and slightly generous contracts. Other changes mainly concern shifts from the percentage of stringent contract to the percentage of moderate contract in different strategies (Fig. 3c). Agents with F2 strategies also take more advantage of TB mechanism in the situations A1B1 and A2B1 as compared to the two former situations. Particularly, agents with F2E1 strategy almost catch up with those with F3 strategies concerning the utilization of generous contracts. Moreover, as observed in Fig. 3, significant amount of shifts is seen from the percentage of stringent contracts to the percentage of moderate and generous contracts. A description about comparison of retailers ‘average revenue over 10 reporting strategy in different contextual situations are provided in the Supplementary document.


                     Fig. 4
                      shows the evolution of the supply chain profit at the first run in the situation A1B1 over 26 periods. This line chart is an instance of 40 available charts which is illustrated here to build a better understanding of performance of the three mechanisms over 26 periods. The results obtained from 40 simulation runs, including 10 simulation runs for each contextual situation, where each simulation run corresponds to a unique assignment of a retailer to a reporting strategy, are summarized in Table 6. This table represents average performance values in four situations. Fig. 4 shows that over all periods, ‘SI’ mechanism predictably outperforms ‘TB’ mechanism which in turn surpassed ‘NT’ mechanism, even if in some specific periods such as 3, 6, 9, 22 and 25 there are very little differences between the three cases. This may be due to the combination of randomized values of demands and designed rules incorporated into the TB mechanism. This pattern almost remains unchanged in all 40 charts resulting from 40 simulations.

@&#DISCUSSION@&#

Performance evaluation results of the trust-based mechanism concerning both profit improvement of total chain and detecting and discriminating capability indexes move to opposite directions with respect to the contextual factors. As the variability of stochastic demand increases, the performance of the mechanism in detecting deceptive agents becomes worse, whereas the mechanism performance from the aspect of total chain profit increases; The higher risk, the more potential profit. When the demand variability is low, there are little possible potential improvements using the proposed mechanism as shown in Table 6. As for the market size factor, the contrast is not so dramatic. In other words, detecting capability deteriorates as the market size becomes larger, but the effect of the market size on the total chain profit under the proposed mechanism is not clear. As to the fall in detecting capability, a possible explanation is that in the examined instances of the supply chain, the standard deviation of the demand is assumed to be a multiplication of the demand mean, which in turn is a multiplication of the market size. That is, the increase in market size implies an increase in the demand variability.

The higher achieved improvement percentages of the situations A1B2 and A2B2 implies the adequacy of the proposed mechanism to situations with high demand variability. Although detecting capability is low in these environments, it is still situated in such an acceptable level that almost it can perfectly detect F1 group of strategies and also has considerable accuracy in identifying agents using F2 strategies. Concerning agents with F3 strategies, the mechanism also applies slight punishments. However, F3 strategies are far away from F1 strategies in terms of extent of deception.

In situations with low demand variability (A1B1 and A2B1), the achieved improvement percentages in these situations are not considerably encouraging but the outstanding performance of the mechanism in detecting deceptive agents make them advisable to be applied in practice. In more detail, the ‘TB’ mechanism in these situations detects perfectly F1 strategies and near perfectly F2 strategies as well as substantially discriminates between honest agents and agents with F3 strategies in the simulation runs.

This work complements the experimental work of Özer et al. (2011), where they propose a model that fits data gathered from subjects’ actual behaviors and decisions using implications of their work to design the mechanism. They could explain the difference between actual decisions in practice and prediction of theories by incorporating trust as a non-pecuniary factor, but they did not propose any coordination mechanism. However, concerning the supply chain structure, care must be taken as the findings might not be transferable to all supply chain structures, or to the same supply chain structure with different parameter values. In this work, ‘Trust’ as an important non-pecuniary factor is used to design this coordination mechanism, which results in significant detecting and discriminating capability as well as profit improvements. A detailed description about advantage and disadvantages of the proposed mechanism is provided in the Supplementary document. One of the most important findings derived from this work for the end users (firms integrated in divergent supply chains) is the more the coordination establishes and the credible information sharing takes place in the supply chain, the more the supply chain can increase the total profit and reduce the market price. Specifically, it is shown that the performance of the mechanism in detecting deceptive agents becomes worse when the variability of stochastic demand increases, whereas the total supply chain profit increases. Therefore, implementing this mechanism within real supply chains can provide products with lower market prices to end-users’ benefits.

@&#CONCLUSION@&#

This paper addresses the design of a punishing–rewarding coordination mechanism incorporating trust as a non-pecuniary factor as well as common contracts, as opposed to prevalent works in the literature proposing complex and less practical contracts. Generally, the proposed mechanism is better than the Non-Trust mechanism. Application of the proposed mechanism might be advisable in situations with high demand variability especially due to high potential financial performance. It is as well applicable in low demand variability situations owing to its high detecting capability in terms of retailer honesty. An important implication of this study is that the proposed mechanism can be applied with some customizations and variations in similar cases in practice. This work presents some limitations and thus future research directions. First, the retailers only decide on their initial orders for the considered period, whereas they could divide the order size at different time intervals. Second, the inventory holding costs are approximated in this study in order to simplify the constraints used in the optimization model. Third, there is still a probability that a honest agent is punished or that a deceptive agent is awarded due to the statistic nature of this mechanism. Finally, These results therefore need to be interpreted with caution because of the small number of cases tested and the particular divergent supply chain structure studied, which open future research directions. Another possible extension of this work is to investigate the cases in which the retailers can make direct decisions on their reservation quantities and prices. From the computational perspective, different research directions could be proposed, related to the actual performances of such algorithm with respect to the calculation times and the robustness.

@&#ACKNOWLEDGEMENTS@&#

This work has been supported by Center for International Scientific Studies & Collaboration (CISSC) and French Embassy in Tehran.

Supplementary data associated with this article can be found, in the online version, at http://dx.doi.org/10.1016/j.ejor.2013.04.055.


                     
                        
                           Supplementary Material
                           
                        
                     
                  

@&#REFERENCES@&#

