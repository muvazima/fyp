@&#MAIN-TITLE@&#Transmission and generation investment in electricity markets: The effects of market splitting and network fee regimes

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           Equilibrium model for transmission line and generation capacity investment.


                        
                        
                           
                           Problem tailored solution for techniques multilevel optimization problems.


                        
                        
                           
                           Analysis of investment incentives for different market designs.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Electricity market modeling

Mixed-integer nonlinear optimization

Multilevel programming

Network expansion

Transmission management

@&#ABSTRACT@&#


               
               
                  We propose an equilibrium model that allows to analyze the long-run impact of the electricity market design on transmission line expansion by the regulator and investment in generation capacity by private firms in liberalized electricity markets. The model incorporates investment decisions of the transmission system operator and private firms in expectation of an energy-only market and cost-based redispatch. In different specifications we consider the cases of one vs. multiple price zones (market splitting) and analyze different approaches to recover network cost—in particular lump sum, generation capacity based, and energy based fees. In order to compare the outcomes of our multilevel market model with a first best benchmark, we also solve the corresponding integrated planner problem. Using two test networks we illustrate that energy-only markets can lead to suboptimal locational decisions for generation capacity and thus imply excessive network expansion. Market splitting heals these problems only partially. These results are valid for all considered types of network tariffs, although investment slightly differs across those regimes.
               
            

@&#INTRODUCTION@&#

Following the British privatization in the 1980s, various countries around the world liberalized their electricity sectors. Today, in most industrialized countries only the transmission network remains regulated while private firms decide on investment in generation capacities and trade electricity on markets. This structure challenges the planning of transmission and generation capacity expansion. While an entirely regulated electricity sector allows for simultaneous transmission and generation expansion planning, in a liberalized market, investment decisions in transmission and generation capacities are taken by different agents. Investment in generation capacities is typically made by firms and private investors based on their expectations concerning the future regulatory environment. Network expansion, however, is decided on by regulated firms (or even the regulator), in anticipation of capacity investments by private firms. Traditional optimization approaches, which only consider integrated transmission and generation expansion planning, reveal the optimal expansion plan for transmission and generation but do not offer valuable information on how to achieve those goals in a mixed market/non-market environment. In a liberalized market, incentives induced by the interplay of the market environment and regulation determine whether firms make the appropriate investment choices. As our results clearly reveal, the proper design of market rules providing adequate incentives in those markets crucially matters. Liberalized electricity markets thus call for new tools to inform the various agents involved: regulators, electricity firms, investors, and other stakeholders.

In this paper we propose a model that allows to analyze investment decisions by the regulator and private firms in liberalized electricity markets. We model energy-only markets and a regulated transmission system operator (TSO) who uses cost-based redispatch to deal with transmission constraints. In a multilevel analysis we study transmission expansion decisions by the regulated TSO in anticipation of capacity expansion by private firms. In different instantiations of our model we analyze the effects of market splitting (one vs. multiple price zones) as well as different approaches to recover network cost—in particular a lump sum, a generation capacity based, and an energy based fee. In order to compare the outcomes to a first best benchmark we also solve the integrated planner problem. For the computational studies we restrict ourselves to solving stylized test cases to illustrate the applicability of our framework. The results demonstrate that investment choices in a market environment substantially differ from the first best solution. In our numerical examples the absence of proper locational investment incentives for firms clearly affects investment choices of generators, which, in turn, leads to excessive line investment. This shows that our model allows to compare different network management regimes and to quantify their effects on long-run investment decisions. Our approach is thus an important extension of various studies that have mainly considered the short-run properties of different transmission management regimes; see the literature review below. As we show, transmission management has also important implications in the long-run when generation and transmission expansion are taken into account.

Let us emphasize that our approach allows to assess the long-run impact of different transmission management regimes adopted in liberalized electricity markets around the world. Especially in Europe spot market trading does not fully account for transmission constraints. In contrast, capacities are shut down and called by the TSO in case that the spot market solution is technically infeasible. Under cost-based redispatch (as it is used in Austria, Switzerland, or Germany) firms called into operation are just compensated for their variable production cost. Consequently, redispatch operations cannot contribute to the recovery of investment cost.
                        1
                     
                     
                        1
                        In contrast, market-based redispatch (used, e.g., in Belgium, Finland, France, or Sweden) may yield rents for firms that are called at the redispatch and thus induces incentives to build plants at locations with systematic underprovision, see Grimm, Martin, Sölch, Weibelzahl, and Zöttl (2016). However, market-based redispatch is plagued by severe gaming problems, which obtain even for perfectly competitive markets. In the literature this is often referred to as the inc-dec game. For a discussion of these issues see, e.g., Neuhoff, Hobbs, and Newbery (2011).
                      Other liberalized electricity markets adopted a system of nodal prices (see, e.g., Joskow, 2008), where spot market prices directly reflect transmission constraints (e.g., the United States, Canada, Australia, or New Zealand), which induces more adequate incentives for generation capacities by private firms. To at least partially overcome the lack of locational signals provided by spot market prices, several countries that rely on a system of redispatch have introduced price zones (e.g., Sweden and Italy). Since the first best solution coincides with the outcome obtained under nodal pricing in our framework, our approach also allows to assess the long-run benefits of a change to this transmission management system.

Apart from the consideration of nodal prices and price zones as compared to a uniform price spot market, we also analyze the impact of different network fee regimes. We consider a lump sum fee as a theoretical benchmark that does not directly affect investment decisions for generation capacity. In practice, however, network fee regimes typically combine energy based and capacity based components. For instance, the current practice in the UK uses “Transmission Network Use of System” fees that are collected based on power plant capacity connected to the grid, whereas “Balancing Services Use of System Charges” fees are charged based on energy fed into the network (cf. National Grid, 2015). In order to provide some insights on the desirability of different network fee regimes, we consider the extreme cases of an energy based and a purely capacity based network fee. The insights of Ruderer and Zöttl (2012) that a lump sum fee yields the highest generation investment incentives and a capacity based fee the lowest (with the energy based fee in between) are reflected in our computational results. In the discussion of our case studies we provide an intuition and moreover demonstrate that the clear ranking of the network fee regimes in terms of investment incentives does not translate into a clear ranking in terms of welfare. The desirability of a network fee regime rather depends on whether distortions induced by the market design itself are alleviated or worsened by higher investment.

@&#LITERATURE REVIEW@&#

Prior to the liberalization of electricity sectors around the world, vertically integrated monopolists (either regulated or directly state owned) were responsible for generation and transmission expansion. Such monopolists needed insights on the cost minimal configuration of the system. As a consequence, traditionally most of the contributions proposed frameworks and techniques to determine overall optimal expansion for generation and transmission facilities; see, e.g., Gallego, Monticelli, and Romero (1998), Binato, Pereira, and Granville (2001), Alguacil, Motto, and Conejo (2003), or de Oliveira, da Silva, Pereira, and Carneiro (2005). In a recent contribution Ruiz and Conejo (2015) propose robust optimization techniques to analyze transmission expansion planning under uncertainty.

In liberalized electricity markets, however, we observe vertical unbundling of transmission and generation facilities. Thus, in addition to insights on the global optimum of an integrated monopolist, research is needed on how the market environment affects decisions of different stakeholders. By now a large literature has developed, which analyzes incentives for private and potentially strategic firms to invest in generation facilities. However, these studies typically assume unlimited transmission capacity; examples are Gabszewicz and Poddar (1997), Murphy and Smeers (2005), Joskow and Tirole (2007), Zöttl (2010), Fabra, von der Fehr, and de Frutos (2011), de Frutos and Fabra (2011), Grimm and Zöttl (2013), or Wogrin, Hobbs, Ralph, Centeno, and Barquín (2013).

Another recent strand of literature explicitly models both generation and transmission investment typically by making use of bilevel models. Sauma and Oren (2006, 2009) are among the first to model investment incentives of generators and transmission network expansion in such a way. In their contribution they quantify the impact of whether transmission investment anticipates resulting investment of strategic generation companies or not. Roh, Shahidehpour, and Fu (2007) propose a simulation framework to analyze investment of competitive generation companies and competitive merchant transmission companies. Roh, Shahidehpour, and Wu (2009) generalize this framework to also include a transmission system operator as a further agent. van der Weijde and Hobbs (2012) provide a bilevel model of transmission expansion facing uncertain investment in renewable generation. Baringo and Conejo (2012) propose a bilevel model together with MPEC- and MILP-based reformulation techniques that addresses investment in wind power plants and transmission lines in a market environment. Ryan, Downward, Philpott, and Zakeri (2010) and, in an extension, Jin and Ryan (2011) analyze expansion of electricity generation and transmission capacities together with the expansion of a fuel transportation network. For electricity markets, Jenabi, Ghomi, and Smeers (2013) propose a clear-cut bilevel framework which considers optimal network expansion by the transmission company, anticipating investment of competitive generation companies. Also based on a bilevel approach, O’Neill, Krall, Hedman, and Oren (2013) propose an auction mechanism to implement optimal investment incentives by transmission companies. In a recent contribution Huppmann and Egerer (2015) also use a bilevel approach to analyze the strategic interaction among several transmission companies and their incentives to build transmission capacities. All those approaches, however, do not explicitly take into account the specific structure of the transmission management regime, but implicitly assume optimal management of the transmission network which is implemented by a regime of locational marginal prices; see Hogan (2002). While this models incentives in markets where indeed a system of locational marginal prices is implemented (as, e.g., in the United States or Canada), it limits insights with respect to other markets that might rely on a system of market splitting or coupling and redispatch, which is not captured by the approaches mentioned above. It is the purpose of this article to explicitly analyze the impact of specific design features of transmission management regimes as market splitting and redispatch on the generation and transmission investment incentives.

Let us finally note that, in recent years, an extensive literature has been developed, which analyzes the impact of specific rules of the transmission management regime on short-run market outcomes, i.e., for fixed generation and transmission facilities. Prominent articles include Hogan (1999), Ehrenmann and Smeers (2005), Neuhoff et al. (2005), Green (2007), or Ehrenmann and Neuhoff (2009) who compare the short-run implications of zonal systems with redispatch to the system of nodal pricing. Several articles analyze the incentives of different agents that are able to exercise market power under different transmission management regimes; see, e.g., Oren (1997), Jing-Yuan and Smeers (1999), Borenstein, Bushnell, and Stoft (1997), Metzler, Hobbs, and Pang (2003), Gilbert, Neuhoff, and Newbery (2004), or Hu and Ralph (2007). Recently, Holmberg and Lazarczyk (2012), Oggioni and Smeers (2013), Oggioni, Smeers, Allevi, and Schaible (2012), and Perninge and Söder (2014) compared different transmission management regimes based on market coupling or splitting with redispatch. All those articles consider only the short-run perspective, while it is our purpose to consider the long-run effects on investment incentives.

This paper is organized as follows. Section 2 presents the basic economical and technical quantities that are used throughout the paper. In Section 3 we introduce the integrated planner approach, while Section 4 presents the trilevel model with a cost-based redispatch system and market splitting. The trilevel model is reformulated using novel ideas in Section 5 and tailored solution strategies for the reformulated model are given in Section 6. The penultimate part of the paper, Section 7, presents computational results for test networks that illustrate the applicability of our model. Finally, Section 8 concludes.

In this section we present the basic notation that is used throughout the paper.

We consider an electricity transmission network 
                           
                              G
                              =
                              (
                              N
                              ,
                              
                                 L
                                 ex
                              
                              )
                           
                         with a set of nodes 
                           
                              N
                              =
                              {
                              
                                 n
                                 1
                              
                              ,
                              …
                              
                              ,
                              
                                 n
                                 
                                    |
                                    N
                                    |
                                 
                              
                              }
                           
                         and a set of existing transmission lines 
                           
                              L
                              ex
                           
                        . The lines l are characterized by their capacity 
                           
                              
                                 f
                                 ¯
                              
                              l
                           
                         and their susceptance Bl
                        . Given these data, the transmission system operator decides on an optimal network expansion plan, i.e., on the construction of candidate power lines 
                           
                              l
                              ∈
                              
                                 L
                                 new
                              
                           
                         and on the degradation of existing lines 
                           
                              l
                              ∈
                              
                                 L
                                 ex
                              
                           
                        . The set of all lines, i.e., existing and candidate transmission lines, is denoted by 
                           
                              L
                              
                                 :
                                 =
                              
                              
                                 L
                                 ex
                              
                              ∪
                              
                                 L
                                 new
                              
                           
                        . For 
                           
                              
                                 L
                                 ˜
                              
                              ⊆
                              L
                           
                         and 
                           
                              
                                 N
                                 ˜
                              
                              ⊆
                              N
                           
                         we denote by

                           
                              
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   N
                                                   ˜
                                                
                                                in
                                             
                                             
                                                (
                                                
                                                   L
                                                   ˜
                                                
                                                )
                                             
                                             :
                                             
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             l
                                             ∈
                                             
                                                L
                                                ˜
                                             
                                             :
                                             l
                                             =
                                             
                                                (
                                                n
                                                ,
                                                m
                                                )
                                             
                                             ,
                                             n
                                             ∉
                                             
                                                N
                                                ˜
                                             
                                             ,
                                             m
                                             ∈
                                             
                                                N
                                                ˜
                                             
                                             }
                                             ,
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   N
                                                   ˜
                                                
                                                out
                                             
                                             
                                                (
                                                
                                                   L
                                                   ˜
                                                
                                                )
                                             
                                             :
                                             
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             {
                                             l
                                             ∈
                                             
                                                L
                                                ˜
                                             
                                             :
                                             l
                                             =
                                             
                                                (
                                                n
                                                ,
                                                m
                                                )
                                             
                                             ,
                                             n
                                             ∈
                                             
                                                N
                                                ˜
                                             
                                             ,
                                             m
                                             ∉
                                             
                                                N
                                                ˜
                                             
                                             }
                                          
                                       
                                    
                                 
                              
                           
                        the set of ingoing and outgoing lines of the node set 
                           
                              N
                              ˜
                           
                        .

Our trilevel power market model allows us to account for multiple price zones 
                           
                              Z
                              =
                              {
                              
                                 Z
                                 1
                              
                              ,
                              …
                              
                              ,
                              
                                 Z
                                 
                                    |
                                    Z
                                    |
                                 
                              
                              }
                           
                         that form a partition of the node set 
                           
                              N
                              =
                              
                                 Z
                                 1
                              
                              ∪
                              ⋯
                              ∪
                              
                                 Z
                                 
                                    |
                                    Z
                                    |
                                 
                              
                           
                        . In our context, the parts of this partition refer to different price zones in the electricity market. By 
                           
                              L
                              inter
                           
                         we denote inter-zone lines connecting nodes that belong to different zones.

Line investment costs are denoted by 
                           
                              c
                              l
                              inv
                           
                         and line degradation cost by 
                           
                              c
                              l
                              deg
                           
                        . When making line investment decisions, the TSO faces physical network constraints known as Kirchhoff’s first and second law. Throughout the paper we use a linear approximation of real power flows known as the lossless direct current (DC) power flow approximation; see, e.g., Kirschen and Strbac (2004).

We assume a given equidistantly discretized time horizon 
                           
                              T
                              =
                              {
                              
                                 t
                                 1
                              
                              ,
                              …
                              
                              ,
                              
                                 t
                                 
                                    |
                                    T
                                    |
                                 
                              
                              }
                           
                         with time steps 
                           
                              τ
                              =
                              
                                 t
                                 
                                    k
                                    +
                                    1
                                 
                              
                              −
                              
                                 t
                                 k
                              
                           
                         for all 
                           
                              k
                              =
                              1
                              ,
                              …
                              
                              ,
                              |
                              T
                              |
                              −
                              1
                           
                        . Moreover, the set of demand nodes is denoted by 
                           
                              
                                 N
                                 dem
                              
                              ⊆
                              N
                           
                        . Consumers are located exclusively at these nodes, i.e., demand in every time period is zero at any other node 
                           
                              n
                              ∈
                              N
                              ∖
                              
                                 N
                                 dem
                              
                           
                        . Elastic demand at demand node 
                           
                              n
                              ∈
                              
                                 N
                                 dem
                              
                           
                         in time period t ∈ T is modeled by a continuous, strictly decreasing function

                           
                              
                                 
                                    
                                       p
                                       
                                          t
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       
                                          d
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       )
                                    
                                    :
                                    
                                       [
                                       0
                                       ,
                                       
                                          
                                             d
                                             ¯
                                          
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       ]
                                    
                                    →
                                    
                                       R
                                       +
                                    
                                    .
                                 
                              
                           
                        
                     

Here and in what follows, d
                        
                           t, n
                         denotes demand and p
                        
                           t, n
                        (d
                        
                           t, n
                        ) is the resulting market price. The saturation point 
                           
                              
                                 d
                                 ¯
                              
                              
                                 t
                                 ,
                                 n
                              
                           
                         is the unique positive root of p
                        
                           t, n
                        . Note that the gross consumer surplus, which is the integral of p
                        
                           t, n
                         over 
                           
                              [
                              0
                              ,
                              
                                 
                                    d
                                    ¯
                                 
                                 
                                    t
                                    ,
                                    n
                                 
                              
                              ]
                              ,
                           
                         is a concave function in our case.

For a given network node n ∈ N, 
                           
                              G
                              n
                              all
                           
                         denotes a finite set of existing technologies and candidate technologies that firms can invest in. We use the set 
                           
                              G
                              n
                              ex
                           
                         for already existing generation technologies and the set 
                           
                              G
                              n
                              new
                           
                         for candidate generation technologies. Thus, 
                           
                              
                                 G
                                 n
                                 all
                              
                              =
                              
                                 G
                                 n
                                 new
                              
                              ∪
                              
                                 G
                                 n
                                 ex
                              
                           
                         holds. To account for the characteristics of different production technologies, we allow for so-called equivalent availabilities αg
                         ∈ [0, 1] for every 
                           
                              g
                              ∈
                              
                                 G
                                 n
                                 all
                              
                           
                         and n ∈ N. Investment cost of building new generation capacity is denoted by 
                           
                              
                                 c
                                 g
                                 inv
                              
                              ∈
                              
                                 R
                                 +
                              
                           
                        .

We assume that all firms act in a competitive environment without any type of market power and act as price takers; see also Section 4.2. Variable production cost is denoted by 
                           
                              
                                 c
                                 g
                                 var
                              
                              ∈
                              
                                 R
                                 +
                              
                           
                         for all 
                           
                              g
                              ∈
                              
                                 G
                                 n
                                 all
                              
                           
                         and n ∈ N. In addition, we assume that all variable costs 
                           
                              c
                              g
                              var
                           
                         are pairwise distinct to ensure unique spot market solutions; see Section 5.

In our
                         power market model the TSO has to collect network fees in order to cover expenses arising from line investment and redispatch. We denote the revenues from these network fees by R and consider three different types of network fee regimes:

                           
                              •
                              We denote by 
                                    
                                       φ
                                       ls
                                    
                                  the lump sum fee that is paid by the consumers. The corresponding revenues are given by 
                                    
                                       
                                          R
                                          ls
                                       
                                       =
                                       
                                          φ
                                          ls
                                       
                                    
                                 .

We denote by 
                                    
                                       φ
                                       eb
                                    
                                  the energy based fee, i.e., a per-unit fee charged for each unit of electricity traded on the spot market. Let 
                                    
                                       d
                                       
                                          t
                                          ,
                                          n
                                       
                                       spot
                                    
                                  describe spot market demand at node n in time period t. Then, the corresponding revenue is given by

                                    
                                       
                                          
                                             
                                                R
                                                eb
                                             
                                             =
                                             
                                                φ
                                                eb
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                                spot
                                             
                                             .
                                          
                                       
                                    
                                 
                              

We denote by 
                                    
                                       φ
                                       gcb
                                    
                                  the generation capacity based fee, i.e., a per-unit fee charged for each unit of generation capacity connected to the network. If 
                                    
                                       
                                          y
                                          ¯
                                       
                                       g
                                       ex
                                    
                                  denotes the capacity of an existing generator and 
                                    
                                       
                                          y
                                          ¯
                                       
                                       g
                                       new
                                    
                                  the capacity of a newly installed generator, the corresponding revenues are

                                    
                                       
                                          
                                             
                                                R
                                                gcb
                                             
                                             =
                                             
                                                φ
                                                gcb
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      
                                                         G
                                                         n
                                                         new
                                                      
                                                   
                                                
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   g
                                                   new
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      
                                                         G
                                                         n
                                                         ex
                                                      
                                                   
                                                
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   g
                                                   ex
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              

Let us briefly justify the choice of the different network fees. We consider a lump sum fee as a theoretical benchmark that does not directly affect investment decisions for generation capacity. We are aware that, in practice, network fee regimes typically combine energy based and capacity based components. In order to provide insights on how the network fee regime affects investment incentives and welfare, we consider the extreme cases of an energy based and a purely capacity based network fee. The model can be extended to capture hybrid fees if it is applied to a particular market. Our approach allows to illustrate how the effect of different network fee regimes on optimal capacity investment translates into welfare effects.

For the sake of completeness, we present all quantities used in our models in Tables 1 and 2.

As a first best benchmark we consider the integrated planner approach where an integrated generation and transmission company (IGTC) simultaneously decides on transmission and generation capacity expansion and chooses welfare maximizing production at the spot markets. There are several formulations in the literature that analyze integrated planner solutions, which might serve as a benchmark in our setting. The formulation chosen here is closely related to the formulation of the integrated planner model in Jenabi et al. (2013). The IGTC maximizes total social welfare, which is defined as the difference of gross consumer surplus (aggregated over all demand scenarios) and line investment cost, line degradation cost, as well as generation capacity investment cost and variable cost of production. Thus, the objective function of the IGTC reads

                        
                           
                              
                                 
                                    
                                       
                                          
                                             ψ
                                             IGTC
                                          
                                          :
                                       
                                    
                                    
                                       =
                                    
                                    
                                       
                                          
                                             ∑
                                             
                                                n
                                                ∈
                                                
                                                   N
                                                   dem
                                                
                                             
                                          
                                          
                                             ∑
                                             
                                                t
                                                ∈
                                                T
                                             
                                          
                                          
                                             ∫
                                             0
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                          
                                          
                                             p
                                             
                                                t
                                                ,
                                                n
                                             
                                          
                                          
                                             (
                                             x
                                             )
                                          
                                          
                                          
                                             d
                                          
                                          x
                                          −
                                          
                                             ∑
                                             
                                                l
                                                ∈
                                                
                                                   L
                                                   new
                                                
                                             
                                          
                                          
                                             c
                                             l
                                             inv
                                          
                                          
                                             z
                                             l
                                             new
                                          
                                          −
                                          
                                             ∑
                                             
                                                l
                                                ∈
                                                
                                                   L
                                                   ex
                                                
                                             
                                          
                                          
                                             c
                                             l
                                             deg
                                          
                                          
                                             z
                                             l
                                             ex
                                          
                                       
                                    
                                 
                                 
                                    
                                    
                                    
                                       
                                          −
                                          
                                          
                                             ∑
                                             
                                                n
                                                ∈
                                                N
                                             
                                          
                                          
                                             (
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      n
                                                      new
                                                   
                                                
                                             
                                             
                                                c
                                                g
                                                inv
                                             
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                g
                                                new
                                             
                                             +
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      n
                                                      all
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                c
                                                g
                                                var
                                             
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           z
                           l
                           new
                        
                      and 
                        
                           z
                           l
                           ex
                        
                      are binary decision variables that decide whether a new line is built or an existing line is degraded. Moreover, y
                     
                        t, g
                      is the actual production of generation technology g at node n. It can be shown that this approach yields the same investment and production outcomes as an idealized nodal pricing system.
                        2
                     
                     
                        2
                        It is well-known that the integrated planner approach yields the same outcome as a nodal price system in the short-run; see, e.g., Hogan (2002). Analogously, our results in Section 5 imply that the solution of the long-run integrated planner approach is equivalent to the outcome of a trilevel nodal pricing model which also accounts for investments in transmission and generation capacity. In such a trilevel nodal pricing model, a regulated TSO decides on transmission expansion in the first level. At the second level, competitive firms decide on generation expansion investment and spot market bids. At the third level, the TSO decides on the welfare maximizing feasible allocation and implements nodal prices.
                     
In what follows, we introduce the constraints that the IGTC is facing. Kirchhoff’s first law ensures power balance at every node n ∈ N in the electricity network. Thus, for every time period t ∈ T the power flow out of node n ∈ N and the power flow into that node have to be balanced with respect to total production and demand at that node:

                        
                           (1)
                           
                              
                                 
                                    d
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       g
                                       ∈
                                       
                                          G
                                          n
                                          all
                                       
                                    
                                 
                                 
                                    y
                                    
                                       t
                                       ,
                                       g
                                    
                                 
                                 +
                                 
                                    ∑
                                    
                                       l
                                       ∈
                                       
                                          δ
                                          n
                                          in
                                       
                                       
                                          (
                                          L
                                          )
                                       
                                    
                                 
                                 
                                    f
                                    
                                       t
                                       ,
                                       l
                                    
                                 
                                 −
                                 
                                    ∑
                                    
                                       l
                                       ∈
                                       
                                          δ
                                          n
                                          out
                                       
                                       
                                          (
                                          L
                                          )
                                       
                                    
                                 
                                 
                                    f
                                    
                                       t
                                       ,
                                       l
                                    
                                 
                                 
                                 for
                                 
                                 all
                                 
                                 n
                                 ∈
                                 N
                                 ,
                                 t
                                 ∈
                                 T
                                 .
                              
                           
                        
                     
                  

Note that summing up (1) for all network nodes yields the market clearing condition

                        
                           (2)
                           
                              
                                 
                                    ∑
                                    
                                       n
                                       ∈
                                       
                                          N
                                          dem
                                       
                                    
                                 
                                 
                                    d
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    ∑
                                    
                                       n
                                       ∈
                                       N
                                    
                                 
                                 
                                    ∑
                                    
                                       g
                                       ∈
                                       
                                          G
                                          n
                                          all
                                       
                                    
                                 
                                 
                                    y
                                    
                                       t
                                       ,
                                       g
                                    
                                 
                                 
                                 for
                                 
                                 all
                                 
                                 t
                                 ∈
                                 T
                                 .
                              
                           
                        
                     
                  

Kirchhoff’s second law determines the voltage angles θ
                     
                        t, n
                     ,n ∈ N,t ∈ T, in the network:

                        
                           (3a)
                           
                              
                                 
                                    
                                       
                                          −
                                          
                                             M
                                             l
                                          
                                          
                                             z
                                             l
                                             ex
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             f
                                             
                                                t
                                                ,
                                                l
                                             
                                          
                                          −
                                          
                                             B
                                             l
                                          
                                          
                                             (
                                             
                                                θ
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             −
                                             
                                                θ
                                                
                                                   t
                                                   ,
                                                   m
                                                
                                             
                                             )
                                          
                                          ≤
                                          
                                             M
                                             l
                                          
                                          
                                             z
                                             l
                                             ex
                                          
                                          
                                          for
                                          
                                          all
                                          
                                       
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          =
                                          
                                             (
                                             n
                                             ,
                                             m
                                             )
                                          
                                          ∈
                                          
                                             L
                                             ex
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (3b)
                           
                              
                                 
                                    
                                       
                                          −
                                          
                                             M
                                             l
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                z
                                                l
                                                new
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          ≤
                                          
                                             f
                                             
                                                t
                                                ,
                                                l
                                             
                                          
                                          −
                                          
                                             B
                                             l
                                          
                                          
                                             (
                                             
                                                θ
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             −
                                             
                                                θ
                                                
                                                   t
                                                   ,
                                                   m
                                                
                                             
                                             )
                                          
                                          ≤
                                          
                                             M
                                             l
                                          
                                          
                                             (
                                             1
                                             −
                                             
                                                z
                                                l
                                                new
                                             
                                             )
                                          
                                          
                                          for
                                          
                                          all
                                          
                                       
                                    
                                 
                                 
                                    
                                       l
                                    
                                    
                                       
                                          =
                                          
                                             (
                                             n
                                             ,
                                             m
                                             )
                                          
                                          ∈
                                          
                                             L
                                             new
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                  

where M denotes a sufficiently large constant. In order to obtain physically unique solutions, we have to fix the voltage angle at an arbitrary reference node n
                     1 ∈ N in every time period:

                        
                           (4)
                           
                              
                                 
                                    θ
                                    
                                       t
                                       ,
                                       
                                          n
                                          1
                                       
                                    
                                 
                                 =
                                 0
                                 
                                 for
                                 
                                 all
                                 
                                 t
                                 ∈
                                 T
                                 .
                              
                           
                        
                     
                  

Furthermore, transmission flows are limited by lower and upper bounds. Here, line investment is explicitly taken into account:

                        
                           (5a)
                           
                              
                                 
                                    
                                       
                                          −
                                          
                                             (
                                             1
                                             −
                                             
                                                z
                                                l
                                                ex
                                             
                                             )
                                          
                                          
                                             
                                                f
                                                ¯
                                             
                                             l
                                          
                                          ≤
                                          
                                             f
                                             
                                                t
                                                ,
                                                l
                                             
                                          
                                          ≤
                                          
                                             (
                                             1
                                             −
                                             
                                                z
                                                l
                                                ex
                                             
                                             )
                                          
                                          
                                             
                                                f
                                                ¯
                                             
                                             l
                                          
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          l
                                          ∈
                                          
                                             L
                                             ex
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (5b)
                           
                              
                                 
                                    
                                       
                                          −
                                          
                                             z
                                             l
                                             new
                                          
                                          
                                             
                                                f
                                                ¯
                                             
                                             l
                                          
                                          ≤
                                          
                                             f
                                             
                                                t
                                                ,
                                                l
                                             
                                          
                                          ≤
                                          
                                             z
                                             l
                                             new
                                          
                                          
                                             
                                                f
                                                ¯
                                             
                                             l
                                          
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          l
                                          ∈
                                          
                                             L
                                             new
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

The next group of constraints ensures that electricity production does not exceed installed generation capacity with respect to the equivalent availabilities of the considered technologies:

                        
                           (6a)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                t
                                                ,
                                                g
                                             
                                          
                                          ≤
                                          
                                             α
                                             g
                                          
                                          τ
                                          
                                             
                                                y
                                                ¯
                                             
                                             g
                                             ex
                                          
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          n
                                          ∈
                                          N
                                          ,
                                          g
                                          ∈
                                          
                                             G
                                             n
                                             ex
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (6b)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                t
                                                ,
                                                g
                                             
                                          
                                          ≤
                                          
                                             α
                                             g
                                          
                                          τ
                                          
                                             
                                                y
                                                ¯
                                             
                                             g
                                             new
                                          
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          n
                                          ∈
                                          N
                                          ,
                                          g
                                          ∈
                                          
                                             G
                                             n
                                             new
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

Note that generation capacity is denoted in MW while actual production is given in MWh. This is the reason why we have to multiply the right-hand sides with the time step τ. Finally, we have to impose simple bounds on the variables of the ITGC model:

                        
                           (7a)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                ¯
                                             
                                             g
                                             new
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          n
                                          ∈
                                          N
                                          ,
                                          g
                                          ∈
                                          
                                             G
                                             n
                                             new
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7b)
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                             
                                                t
                                                ,
                                                g
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          n
                                          ∈
                                          N
                                          ,
                                          g
                                          ∈
                                          
                                             G
                                             n
                                             all
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7c)
                           
                              
                                 
                                    
                                       
                                          
                                             d
                                             
                                                t
                                                ,
                                                n
                                             
                                          
                                          ≥
                                          0
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          n
                                          ∈
                                          
                                             N
                                             dem
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7d)
                           
                              
                                 
                                    
                                       
                                          
                                             z
                                             l
                                             ex
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          l
                                          ∈
                                          
                                             L
                                             ex
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (7e)
                           
                              
                                 
                                    
                                       
                                          
                                             z
                                             l
                                             new
                                          
                                          ∈
                                          
                                             {
                                             0
                                             ,
                                             1
                                             }
                                          
                                       
                                    
                                    
                                       
                                          
                                          for
                                          
                                          all
                                          
                                          l
                                          ∈
                                          
                                             L
                                             new
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

In summary, the IGTC faces the following inter-temporal mixed-integer maximization problem with linear constraints and a concave objective function:

                        
                           (8a)
                           
                              
                                 
                                    
                                       
                                          max
                                          
                                       
                                    
                                    
                                       
                                          ψ
                                          IGTC
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8b)
                           
                              
                                 
                                    
                                       
                                          s.t.
                                          
                                          
                                       
                                    
                                    
                                       
                                          Kirchhoff"s
                                          
                                          first
                                          
                                          and
                                          
                                          second
                                          
                                          law:
                                          
                                          (
                                          1
                                          )
                                          ,
                                          (
                                          3
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8c)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          voltage
                                          
                                          phase
                                          
                                          angle
                                          
                                          at
                                          
                                          reference
                                          
                                          node:
                                          
                                          (
                                          4
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8d)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          transmission
                                          
                                          flow
                                          
                                          limits:
                                          
                                          (
                                          5
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8e)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          generation
                                          
                                          capacity
                                          
                                          limits:
                                          
                                          (
                                          6
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (8f)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                          
                                          variable
                                          
                                          restrictions:
                                          
                                          (
                                          7
                                          )
                                          .
                                       
                                    
                                 
                              
                           
                        
                     
                  

We finally note that it might also be possible to incorporate additional security of supply constraints, both for line and generation investment. However, we neglect this aspect here and in what follows for the ease of presentation.
                  

In most European countries spot market trading does not fully account for network constraints (if at all). Therefore, congestion management mechanisms and the way network fees are collected play a crucial role for investment incentives—both in network and generation capacity expansion. It is most likely that energy-only markets with redispatch do not result in optimal incentive structures. Thus, one is faced with two main questions: How large is the difference to the first best solution and do there exist alternative mechanisms that have the capability to improve the situation substantially?

In our power market model we consider an energy-only market with cost-based redispatch. Electricity trading and redispatch is organized as follows in such a system: Firms trade electricity day ahead (and possibly intra-day) at a power exchange that does not account for any transmission constraints—or at least not for all of them as in the case of market splitting. After closing the market, the TSO checks feasibility of the resulting transmission flows. If the allocation is feasible, nothing is changed and electricity is generated and consumed as traded. If transmission is infeasible, the TSO redispatches plants and consumers in the cheapest possible way that ensures feasibility of transmission flows. To that aim the TSO obliges some producers to (partially) shut down production, while others are called to step in instead, or asks consumers to modify their demand. Plants that are shut down have to pay their variable cost, which they save due to the shutdown, to the TSO. Plants that are called to step in receive their variable production cost. Production cost of the called plants are necessarily higher than production cost of the plants that are shut down, since otherwise they would have been successful on the spot market. The resulting cost is collected by the TSO through network fees. While in the early days of liberalized electricity markets redispatch was a rare event, nowadays the phenomenon becomes more and more important. See, e.g., ENTSO-E (2012a) for the case of Germany, where the decision to shut down nuclear power plants and to increase the generation capacity of renewables implies a much more uncertain and regionally dispersed supply structure. Fig. 1
                      illustrates the cost-based redispatch mechanism on a stylized two-node example. Here, linear demand is located at one node and production is hosted at the other node. We further assume that there is only one generator with constant variable production cost. As illustrated in Fig. 1, in the case of unlimited transmission capacities the equilibrium quantity B will be produced. However, given physical transmission constraints with D describing the maximum amount of electricity that can be transmitted between the two nodes, the TSO obliges consumers to step back from their contracts. As a compensation, the TSO pays these consumers the amount equal to the area of the polygon ABDF. Additionally, the TSO asks firms (typically those with the highest variable cost) to shut down their production. The respective firms pay an amount equal to the area of the rectangle ABDE to the TSO, which corresponds exactly to the variable cost that do not arise due to redispatch. Obviously, the redispatch mechanism has no impact on the firms’ profits when they are asked to decrease their production. In contrast, the TSO faces additional cost equal to the area of the triangle AEF. These additional cost must be collected from the market participants through network fees.

Let us now briefly sketch how we capture the described market/non-market environment in the structure of a trilevel model before we introduce the details at all levels and our solution strategy.

The timing of the situation we want to capture is illustrated in Fig. 2. Note that investment choices are taken once (sequentially by the TSO and competitive firms), followed by multiple periods of spot market trading and redispatch (in the case of congestion). We translate this game into a trilevel model as follows: At the first level, the TSO decides to invest in line expansion or degradation, anticipating the outcomes at all subsequent levels. The objective of the TSO is to maximize welfare.
                        3
                     
                     
                        3
                        In liberalized electricity markets, regulated monopolists operate the networks and maximize their profits. Ideally, the regulatory environment (in particular the possibility to recover investment costs through network fees) should be set up as to induce the TSO to maximize welfare. We are aware that in practice incomplete information hinders the regulator to achieve this goal. Our assumption therefore reflects the ideal case that regulation works perfectly. In many states the authorities try to address the issue also by means beyond traditional incentive regulation. In Germany, for example, network expansion plans are developed and revised on a bi-annual basis in a joint activity among all TSOs and the regulatory authority. The so-called NEP (Netzentwicklungsplan–Network Development Plan) is consulted with all stakeholders every two years.
                      Now consider the multiple periods of spot market trading and redispatch. Note that there are no interdependencies between the different subsequent spot markets (due to non-storability of the product). Thus, we can solve the redispatch problems jointly in a separate level of the problem at the very end (third level). The redispatch that takes place after the |T| spot markets is anticipated by firms when they decide on investment and supply. In case of cost-based redispatch, firms do not anticipate further profits, which enables us to simplify the problem further (see Section 5). The current formulation also allows to capture alternative redispatch mechanisms.

At the second level, we model investment decisions of private firms in generation capacity as well as trading at a sequence of |T| spot markets with fluctuating demand. We can consider investment and production jointly since the decisions are taken by the same decision maker. In contrast to the TSO who is driven by welfare concerns (or regulated such that it is in his own interest to maximize welfare), firms take investment and supply decisions as to maximize profits. This is due to the fact that in liberalized electricity markets generation investment and electricity production is decided on by private firms. We assume that spot market rules yield a uniform price within a price zone and assume that spot markets are competitive (see Section 4.2 for a detailed discussion of the latter assumption).

We point out that all levels of our power market model are interconnected: the investment of firms and optimal spot market behavior as well as the redispatch market are part of the TSO’s objective and constraints at the first level. We graphically illustrate the trilevel problem that we analyze in the following in Fig. 3
                     .

Let us finally emphasize that our power market model allows to account for multiple price zones Z, which enables us to investigate the effect of market splitting under cost-based redispatch. Under market splitting, spot market trading takes network constraints between, but not within, zones into account.

In order to formally state the models, we have to introduce some more notation. In what follows, a superindex “spot” indicates quantities after spot market trading and a superindex “redi” denotes quantities after redispatch. Lastly, Δ’s denote redispatch quantities, i.e., the difference of the quantity after redispatch and after spot market trading. For instance, 
                           
                              
                                 d
                                 
                                    t
                                    ,
                                    n
                                 
                                 redi
                              
                              =
                              
                                 d
                                 
                                    t
                                    ,
                                    n
                                 
                                 spot
                              
                              +
                              Δ
                              
                                 d
                                 
                                    t
                                    ,
                                    n
                                 
                              
                           
                         specifies the relationship between demand after spot market trading and the actual demand after redispatch.

At the first level, the TSO decides on a line expansion plan as to maximize welfare, which is given as the difference of gross consumer surplus from all markets and investment and generation costs:

                           
                              (9)
                              
                                 
                                    
                                       
                                          
                                             
                                                ψ
                                                1
                                             
                                             :
                                             
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∫
                                                0
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                   redi
                                                
                                             
                                             
                                                p
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                             
                                                d
                                             
                                             x
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      new
                                                   
                                                
                                             
                                             
                                                c
                                                l
                                                inv
                                             
                                             
                                                z
                                                l
                                                new
                                             
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      ex
                                                   
                                                
                                             
                                             
                                                c
                                                l
                                                deg
                                             
                                             
                                                z
                                                l
                                                ex
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      
                                                         G
                                                         n
                                                         new
                                                      
                                                   
                                                
                                                
                                                   c
                                                   g
                                                   inv
                                                
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   g
                                                   new
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      
                                                         G
                                                         n
                                                         all
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   c
                                                   g
                                                   var
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      g
                                                   
                                                   redi
                                                
                                                )
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

The TSO is restricted by the budget constraint 
                           
                              E
                              =
                              R
                           
                         requiring that expenses

                           
                              (10)
                              
                                 
                                    
                                       
                                          E
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∫
                                                
                                                   
                                                      d
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                      redi
                                                   
                                                
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                   spot
                                                
                                             
                                             
                                                p
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                             
                                                d
                                             
                                             x
                                             +
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      n
                                                      all
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                c
                                                g
                                                var
                                             
                                             Δ
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             +
                                             
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      new
                                                   
                                                
                                             
                                             
                                                c
                                                l
                                                inv
                                             
                                             
                                                z
                                                l
                                                new
                                             
                                             +
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      L
                                                      ex
                                                   
                                                
                                             
                                             
                                                c
                                                l
                                                deg
                                             
                                             
                                                z
                                                l
                                                ex
                                             
                                          
                                       
                                    
                                 
                              
                           
                        for network expansion and degradation (third and fourth term) and redispatch (first and second term) are covered by revenues R from network fees φ; cf. Section 2.4. Thus, revenues R are a function of the collected fee φ, which makes the latter a first-level variable. Note that redispatch cost is composed of remuneration of consumers that cannot be supplied (first term) as well as transfers to (or from) plants that are redispatched (second term). As the TSO can decide to reduce spot market production or demand, Δy
                        
                           t, g
                         and Δd
                        
                           t, n
                         may also become negative. All together, we obtain the following first-level problem:

                           
                              
                                 
                                    
                                       
                                       
                                       
                                          
                                             max
                                             
                                             
                                                ψ
                                                1
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             s.t.
                                             
                                             
                                             E
                                             =
                                             R
                                             ,
                                             
                                             
                                                z
                                                l
                                                new
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                new
                                             
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             
                                             
                                             
                                                z
                                                l
                                                ex
                                             
                                             ∈
                                             
                                                {
                                                0
                                                ,
                                                1
                                                }
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                ex
                                             
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

At the second level we model the behavior of firms with respect to generation investment and spot market trading. The wholesale electricity market is assumed to be perfectly competitive, i.e., no firm can directly affect prices by strategic investment or supply decisions. It has been shown in the literature that in the absence of transmission constraints a perfectly competitive environment yields welfare maximizing investment and production decisions in our context; see, e.g., Grimm and Zöttl (2013). This implies that we identify the competitive investment and production decisions of the generators by solving the corresponding welfare maximization problem. We are aware of the issue that the assumption of perfect competition may not be adequate for power systems in general. However, this assumption is necessary in order to keep the multilevel problem tractable, both theoretically and computationally: For the case of strategic firms investing in several technologies, it has been shown that uniqueness of equilibria does not hold for a reasonable set of assumptions; see Zöttl (2010). As a consequence, this assumption has been established as a standard in the literature; see, e.g., Boucher and Smeers (2001) or Daxhelet and Smeers (2007).

When making investment and supply decisions, firms only consider physical constraints for which they receive price signals. If the market is not divided into zones, firms receive no signals concerning network capacities and thus will not account for them. If the market is divided into two or more zones, firms consider those physical constraints, which are expressed in price differences due to market splitting: Between any pair of zones, electricity flow cannot exceed the maximum capacity of the respective inter-zone network links—and congestion implies price differences across zones. This is modeled by the following zonal version of Kirchhoff’s first law

                           
                              (11)
                              
                                 
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          
                                             N
                                             dem
                                          
                                          ∩
                                          
                                             Z
                                             k
                                          
                                       
                                    
                                    
                                       d
                                       
                                          t
                                          ,
                                          n
                                       
                                       spot
                                    
                                    =
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          N
                                          ∩
                                          
                                             Z
                                             k
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          g
                                          ∈
                                          
                                             G
                                             n
                                             all
                                          
                                       
                                    
                                    
                                       y
                                       
                                          t
                                          ,
                                          g
                                       
                                       spot
                                    
                                    +
                                    
                                       ∑
                                       
                                          l
                                          ∈
                                          
                                             δ
                                             
                                                Z
                                                k
                                             
                                             in
                                          
                                          
                                             (
                                             L
                                             )
                                          
                                       
                                    
                                    
                                       f
                                       
                                          t
                                          ,
                                          l
                                       
                                       spot
                                    
                                    −
                                    
                                       ∑
                                       
                                          l
                                          ∈
                                          
                                             δ
                                             
                                                Z
                                                k
                                             
                                             out
                                          
                                          
                                             (
                                             L
                                             )
                                          
                                       
                                    
                                    
                                       f
                                       
                                          t
                                          ,
                                          l
                                       
                                       spot
                                    
                                 
                              
                           
                        for all t ∈ T, Zk
                         ∈ Z, and market splitting flow restrictions

                           
                              (12a)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   l
                                                   ex
                                                
                                                )
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             ≤
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                spot
                                             
                                             ≤
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   l
                                                   ex
                                                
                                                )
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                inter
                                             
                                             ∩
                                             
                                                L
                                                ex
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (12b)
                              
                                 
                                    
                                       
                                          
                                             −
                                             
                                                z
                                                l
                                                new
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             ≤
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                spot
                                             
                                             ≤
                                             
                                                z
                                                l
                                                new
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                          
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                inter
                                             
                                             ∩
                                             
                                                L
                                                new
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Other physical restrictions like Kirchhoff’s second law are not considered.
                           4
                        
                        
                           4
                           Note that analogous to flow-based market coupling, we could also consider Kirchhoff’s second law on the reduced network among zones. Our framework would be perfectly suited for such an analysis. However, due to the overall length of this article we refrain from this aspect.
                         In addition, we have variable restrictions in analogy to (7), i.e.,

                           
                              (13a)
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                g
                                                new
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             g
                                             ∈
                                             
                                                G
                                                n
                                                new
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13b)
                              
                                 
                                    
                                       
                                          
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                spot
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             g
                                             ∈
                                             
                                                G
                                                n
                                                all
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        
                        
                           
                              (13c)
                              
                                 
                                    
                                       
                                          
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                                spot
                                             
                                             ≥
                                             0
                                          
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

To summarize, at level two we consider welfare maximizing generation investment and supply decisions, i.e.,

                           
                              (14)
                              
                                 
                                    
                                       
                                          
                                             
                                                ψ
                                                2
                                             
                                             :
                                             
                                             
                                          
                                       
                                       
                                          =
                                       
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                ∫
                                                0
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                   spot
                                                
                                             
                                             
                                                p
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             
                                                (
                                                x
                                                )
                                             
                                             
                                             
                                                d
                                             
                                             x
                                          
                                       
                                    
                                    
                                       
                                       
                                       
                                          
                                             −
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                (
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      
                                                         G
                                                         n
                                                         new
                                                      
                                                   
                                                
                                                
                                                   c
                                                   g
                                                   inv
                                                
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   g
                                                   new
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      g
                                                      ∈
                                                      
                                                         G
                                                         n
                                                         all
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   c
                                                   g
                                                   var
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      g
                                                   
                                                   spot
                                                
                                                )
                                             
                                             −
                                             R
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where supply is constrained by generation capacities installed and transmission constraints across zones. Note that in (14), R again denotes revenues of the TSO, which affect demand and generation decisions on the spot market. Thus, the second-level problem reads

                           
                              
                                 
                                    
                                       
                                          
                                             max
                                             
                                          
                                       
                                       
                                          
                                             ψ
                                             2
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             generation
                                             
                                             capacity
                                             
                                             limits:
                                             
                                             (
                                             6
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             zonal
                                             
                                             version
                                             
                                             of
                                             
                                             Kirchhoff"s
                                             
                                             first
                                             
                                             law:
                                             
                                             (
                                             11
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             market
                                             
                                             splitting
                                             
                                             flow
                                             
                                             restrictions:
                                             
                                             (
                                             12
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             variable
                                             
                                             restrictions:
                                             
                                             (
                                             13
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where we replaced y
                        
                           t, g
                         by 
                           
                              y
                              
                                 t
                                 ,
                                 g
                              
                              spot
                           
                         in (6).

We finally point to the following observations regarding the zonal version of Kirchhoff’s first law: Summing up (11) for all zones we obtain the market clearing condition (2). In a model with redispatch and only one zone, (11) coincides with a standard market clearing condition. In the case where every zone consists of exactly one network node, (11) coincides with Kirchhoff’s first law ensuring power balance at every network node. Intermediate cases require the market to clear within each zone, accounting for possible transmission constraints across zones through differences in the respective market clearing prices.

At the third level, the TSO simultaneously decides on redispatch for all |T| spot markets. Reallocation of spot market outcomes is realized in a way that ensures feasibility with respect to transmission constraints at lowest costs. These costs are given by

                           
                              
                                 
                                    
                                       ψ
                                       3
                                    
                                    
                                       :
                                       =
                                    
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          
                                             N
                                             dem
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       ∫
                                       
                                          
                                             d
                                             
                                                t
                                                ,
                                                n
                                             
                                             redi
                                          
                                       
                                       
                                          d
                                          
                                             t
                                             ,
                                             n
                                          
                                          spot
                                       
                                    
                                    
                                       p
                                       
                                          t
                                          ,
                                          n
                                       
                                    
                                    
                                       (
                                       x
                                       )
                                    
                                    
                                    
                                       d
                                    
                                    x
                                    +
                                    
                                       ∑
                                       
                                          n
                                          ∈
                                          N
                                       
                                    
                                    
                                       ∑
                                       
                                          g
                                          ∈
                                          
                                             G
                                             n
                                             all
                                          
                                       
                                    
                                    
                                       ∑
                                       
                                          t
                                          ∈
                                          T
                                       
                                    
                                    
                                       c
                                       g
                                       var
                                    
                                    Δ
                                    
                                       y
                                       
                                          t
                                          ,
                                          g
                                       
                                    
                                 
                              
                           
                        and the redispatch decision has to account for all physical transmission constraints and generation capacity limits:

                           
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                          
                                       
                                       
                                          
                                             ψ
                                             3
                                          
                                       
                                    
                                    
                                       
                                          
                                             s.t.
                                             
                                          
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                                redi
                                             
                                             =
                                             
                                                ∑
                                                
                                                   g
                                                   ∈
                                                   
                                                      G
                                                      n
                                                      all
                                                   
                                                
                                             
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                redi
                                             
                                             +
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      δ
                                                      n
                                                      in
                                                   
                                                   
                                                      (
                                                      L
                                                      )
                                                   
                                                
                                             
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             −
                                             
                                                ∑
                                                
                                                   l
                                                   ∈
                                                   
                                                      δ
                                                      n
                                                      out
                                                   
                                                   
                                                      (
                                                      L
                                                      )
                                                   
                                                
                                             
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             
                                             for
                                             
                                             all
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             −
                                             
                                                M
                                                l
                                             
                                             
                                                z
                                                l
                                                ex
                                             
                                             ≤
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             −
                                             
                                                B
                                                l
                                             
                                             
                                                (
                                                
                                                   θ
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      t
                                                      ,
                                                      m
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                M
                                                l
                                             
                                             
                                                z
                                                l
                                                ex
                                             
                                             
                                             for
                                             
                                             all
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             l
                                             =
                                             
                                                (
                                                n
                                                ,
                                                m
                                                )
                                             
                                             ∈
                                             
                                                L
                                                ex
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             −
                                             
                                                M
                                                l
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   l
                                                   new
                                                
                                                )
                                             
                                             ≤
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             −
                                             
                                                B
                                                l
                                             
                                             
                                                (
                                                
                                                   θ
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   θ
                                                   
                                                      t
                                                      ,
                                                      m
                                                   
                                                
                                                )
                                             
                                             ≤
                                             
                                                M
                                                l
                                             
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   l
                                                   new
                                                
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             =
                                             
                                                (
                                                n
                                                ,
                                                m
                                                )
                                             
                                             ∈
                                             
                                                L
                                                new
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                θ
                                                
                                                   t
                                                   ,
                                                   
                                                      n
                                                      1
                                                   
                                                
                                             
                                             =
                                             0
                                             
                                             for
                                             
                                             all
                                             
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             −
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   l
                                                   ex
                                                
                                                )
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             ≤
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             ≤
                                             
                                                (
                                                1
                                                −
                                                
                                                   z
                                                   l
                                                   ex
                                                
                                                )
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                ex
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             −
                                             
                                                z
                                                l
                                                new
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             ≤
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             ≤
                                             
                                                z
                                                l
                                                new
                                             
                                             
                                                
                                                   f
                                                   ¯
                                                
                                                l
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                new
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                redi
                                             
                                             ≤
                                             
                                                α
                                                g
                                             
                                             τ
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                g
                                                ex
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             g
                                             ∈
                                             
                                                G
                                                n
                                                ex
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                redi
                                             
                                             ≤
                                             
                                                α
                                                g
                                             
                                             τ
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                g
                                                new
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             g
                                             ∈
                                             
                                                G
                                                n
                                                new
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                                redi
                                             
                                             =
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                                spot
                                             
                                             +
                                             Δ
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                redi
                                             
                                             =
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                spot
                                             
                                             +
                                             Δ
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             g
                                             ∈
                                             
                                                G
                                                n
                                                all
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                redi
                                             
                                             =
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                                spot
                                             
                                             +
                                             Δ
                                             
                                                f
                                                
                                                   t
                                                   ,
                                                   l
                                                
                                             
                                             
                                             for
                                             
                                             all
                                             
                                             l
                                             ∈
                                             
                                                L
                                                inter
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                                redi
                                             
                                             ≥
                                             0
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                y
                                                
                                                   t
                                                   ,
                                                   g
                                                
                                                redi
                                             
                                             ≥
                                             0
                                             
                                             for
                                             
                                             all
                                             
                                             n
                                             ∈
                                             N
                                             ,
                                             g
                                             ∈
                                             
                                                G
                                                n
                                                all
                                             
                                             ,
                                             t
                                             ∈
                                             T
                                             .
                                          
                                       
                                    
                                 
                              
                           
                        
                     

Observe that the trilevel problem yields a different solution than the integrated planner problem. This is mainly driven by the fact that firms at the second level choose generation capacities, which are not optimal from an overall welfare maximizing perspective, since their choice ignores network congestion. Welfare obtained for the solution of the integrated planner problem is thus larger than welfare obtained for the solution of the trilevel market problem.


                        Table 3
                         gives an overview of the variables of all three levels.

The trilevel problem developed in the last section is a special instance of general multilevel optimization problems, which is a very hard class of optimization problems; cf. Jeroslow (1985), who showed that even solving linear bilevel problems is NP-hard. Most algorithmic approaches for bilevel problems make use of first-order optimality conditions and solve the resulting mathematical program with equilibrium constraints (MPEC); see Hobbs (1998), Jenabi et al. (2013), or Jin and Ryan (2011) for applied studies. However, such problem reformulations explicitly rely on nonconvex optimization problems and additionally have the drawback that standard constraint qualifications like the Mangasarian–Fromovitz constraint qualification are violated at every feasible point. Therefore, problem tailored constraint qualifications and stationarity concepts have been developed for MPECs; see, e.g., Scheel and Scholtes (2000). For more information on the topic of multilevel optimization and MPECs we refer to Cottle, Pang, and Stone (2009), Dempe (2002), and Luo, Pang, and Ralph (1996).

In this section we present a new reformulation approach that allows us to find global optimal solutions in our specific case without using first-order optimality conditions. Before we present our reformulation approach, we point out that the trilevel problem always has a finite global optimal solution, since the feasible region is bounded.

The main reason that makes a reduction of levels of the trilevel model possible is that the objective functions all point “into the same direction”. This aspect and the way how we exploit it is discussed in detail in the following. Our reformulation approach builds on a two-step analysis of the connection between the three problem levels. In a first step, we fix all non-second-level variables in the second-level problem. This allows us to iteratively solve independent single-level subproblems, i.e., second-level problems with respect to given line investment, and corresponding bilevel master problems consisting of the original first- and third-level models. In a second step, we show that instead of solving a bilevel master problem, we can solve a single-level master problem. Combining the results of both steps, we iteratively solve single-level sub- and master problems arriving at a global optimal solution to the original trilevel problem. Table 4
                      depicts the reformulation of the trilevel problem into single-level sub- and master problems.

First note that the second-level problem (generation investment and spot market behavior) includes only first- and second-level variables. The reason is that for cost-based redispatch firms never receive additional rents from the third level. Consequently, although the second-level problem is connected to the third level (redispatch) via the line investment problem at the first level, there is no direct interconnection. To be more precise, the interconnection of the levels is purely driven by inter-zonal line investment variables and the network fee variable from the first-level problem. Thus, we can fix these variables and solve the second-level market subproblem for every possible realization of these variables. We then fix the respective second-level variables in the first-level and the third-level problem to the values of this solution. This reduces the problem to a bilevel master problem with a reduced number of variables. Note that the approach to substitute the optimal second-level values requires uniqueness of the second-level solution. This is shown in Grimm, Schewe, Schmidt, and Zöttl (2015b).

We now show how the bilevel master problem consisting of line investment and redispatch can be solved efficiently. The key ingredient is given in the following proposition, which states that the third-level objective ψ
                        3 is an affine transformation of the objective ψ
                        1 of the first level.

                           Proposition 1
                           
                              Let ψ
                              1 
                              and ψ
                              3 
                              be the objective functions of the original first and third level. Then,
                              
                                 
                                    
                                       ψ
                                       3
                                    
                                    =
                                    −
                                    
                                       ψ
                                       1
                                    
                                    +
                                    b
                                 
                               
                              holds, where
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   b
                                                   =
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         
                                                            N
                                                            dem
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      ∫
                                                      
                                                         0
                                                      
                                                      
                                                         d
                                                         
                                                            t
                                                            ,
                                                            n
                                                         
                                                         spot
                                                      
                                                   
                                                   
                                                      p
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   
                                                   
                                                      d
                                                   
                                                   x
                                                   −
                                                   
                                                      ∑
                                                      
                                                         l
                                                         ∈
                                                         
                                                            L
                                                            new
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      l
                                                      inv
                                                   
                                                   
                                                      z
                                                      l
                                                      new
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         l
                                                         ∈
                                                         
                                                            L
                                                            ex
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      l
                                                      deg
                                                   
                                                   
                                                      z
                                                      l
                                                      ex
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   −
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         g
                                                         ∈
                                                         
                                                            G
                                                            n
                                                            new
                                                         
                                                      
                                                   
                                                   
                                                      c
                                                      g
                                                      inv
                                                   
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      g
                                                      new
                                                   
                                                   −
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         g
                                                         ∈
                                                         
                                                            G
                                                            n
                                                            all
                                                         
                                                      
                                                   
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      c
                                                      g
                                                      var
                                                   
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         g
                                                      
                                                      spot
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              only depends on spot market and line investment variables.
                           

This insight reveals that the first- and third-level problem have affine equivalent objective functions and thus have identical optimization directions. We remark that the latter proposition is the mathematical consequence of the economical discussion of our market model in Section 4. Next, we exploit the fact that, in order to solve a general bilevel problem with affine equivalent objective functions, it is possible to solve an easier single-level problem.

                           Proposition 2
                           
                              Consider the bilevel problem
                              
                                 
                                    
                                       
                                          
                                             
                                             
                                                
                                                   
                                                      min
                                                      
                                                         
                                                            x
                                                            1
                                                         
                                                         ,
                                                         
                                                            x
                                                            2
                                                         
                                                      
                                                   
                                                   
                                                   ψ
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      ,
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                   
                                                   s.t.
                                                   
                                                   g
                                                   
                                                      (
                                                      
                                                         x
                                                         1
                                                      
                                                      ,
                                                      
                                                         x
                                                         2
                                                      
                                                      )
                                                   
                                                   ≥
                                                   0
                                                   ,
                                                
                                             
                                          
                                          
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      x
                                                      2
                                                   
                                                   =
                                                   
                                                      arg min
                                                      z
                                                   
                                                   
                                                      {
                                                      ψ
                                                      
                                                         (
                                                         
                                                            x
                                                            1
                                                         
                                                         ,
                                                         z
                                                         )
                                                      
                                                      :
                                                      h
                                                      
                                                         (
                                                         
                                                            x
                                                            1
                                                         
                                                         ,
                                                         z
                                                         )
                                                      
                                                      ≥
                                                      0
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              with equivalent objective functions in the upper and lower level and denote the set of optimal solutions by
                              
                                 
                                    S
                                    bl
                                 
                              
                              . Moreover, let
                              
                                 
                                    
                                       
                                          
                                             min
                                             
                                                
                                                   x
                                                   1
                                                
                                                ,
                                                
                                                   x
                                                   2
                                                
                                             
                                          
                                          
                                          ψ
                                          
                                             (
                                             
                                                x
                                                1
                                             
                                             ,
                                             
                                                x
                                                2
                                             
                                             )
                                          
                                          
                                          s.t.
                                          
                                          g
                                          
                                             (
                                             
                                                x
                                                1
                                             
                                             ,
                                             
                                                x
                                                2
                                             
                                             )
                                          
                                          ≥
                                          0
                                          ,
                                          
                                          h
                                          
                                             (
                                             
                                                x
                                                1
                                             
                                             ,
                                             
                                                x
                                                2
                                             
                                             )
                                          
                                          ≥
                                          0
                                       
                                    
                                 
                              
                              be the corresponding single-level problem with solution set
                              
                                 
                                    S
                                    sl
                                 
                              
                              . Then,
                              
                                 
                                    
                                       S
                                       sl
                                    
                                    =
                                    
                                       S
                                       bl
                                    
                                 
                               
                              holds.
                           

Since a solution of the bilevel problem is feasible for the single-level problem and vice versa, the same objective function in the upper and lower level directly implies the result.□

Note that the above result can easily be generalized to p-level optimization problems for p > 2. For the sake of completeness let us also state the following proposition, which is an immediate consequence.

                           Proposition 3
                           
                              Assume a p-level minimization problem is given with ψi denoting the objective function of the ith level of the problem. If there exist affine linear transformations
                              
                                 
                                    
                                       a
                                       i
                                    
                                    
                                       ψ
                                       i
                                    
                                    +
                                    
                                       b
                                       i
                                    
                                    =
                                    
                                       ψ
                                       1
                                    
                                 
                               
                              and ai
                               > 0 for all
                              
                                 
                                    i
                                    ∈
                                    {
                                    2
                                    ,
                                    …
                                    
                                    ,
                                    p
                                    }
                                    ,
                                 
                               
                              then the multilevel model can be solved as a single-level model.
                           

Note that the condition 
                           
                              
                                 a
                                 i
                              
                              
                                 ψ
                                 i
                              
                              +
                              
                                 b
                                 i
                              
                              =
                              
                                 ψ
                                 1
                              
                           
                         is obviously satisfied if 
                           
                              
                                 a
                                 i
                              
                              
                                 ψ
                                 i
                              
                              +
                              
                                 b
                                 i
                              
                              =
                              
                                 ψ
                                 
                                    i
                                    −
                                    1
                                 
                              
                           
                         holds for all 
                           
                              i
                              ∈
                              {
                              2
                              ,
                              …
                              
                              ,
                              p
                              }
                           
                        .

We finally remark that Proposition 1 directly fits into the setting of the last proposition since we maximize in the first and minimize in the third level, which is the reason for the sign conversion.

In this section we describe how we solve the reformulated problem to global optimality. Since we started from a mixed-integer nonlinear trilevel problem it is clear that this is computationally a very hard task. However, the reformulation discussed in Section 5, together with the results given in this section, allows us to set up a binary search strategy to solve the coupled master and subproblems; see Section 6.1. In Section 6.2, we describe how binary search upper bounds for the network fee are determined and in Section 6.3, we describe a technique for reducing the complexity of the proposed algorithm.

We now describe how the trilevel problem can be solved in an efficient way using a problem tailored binary search strategy. This approach is based on the trilevel problem reformulated as a single-level sub- and master problem as described in Section 5. The key insight is that the master and subproblem are only coupled by transmission line investment and network fees. Thus, fixing these values yields decoupled models that can be solved separately. For this purpose, we iterate over all possible network configurations 
                           X
                         with 
                           
                              ∅
                              ⊆
                              X
                              ⊆
                              
                                 L
                                 ex
                              
                              ∪
                              
                                 L
                                 new
                              
                           
                         and additionally neglect the budget constraint 
                           
                              μ
                              =
                              R
                              −
                              E
                              =
                              0
                              ,
                           
                         for which we compute the unique feasible solution via binary search. The resulting algorithm is depicted in Algorithm 1.
                     

In order to proof correctness of the algorithm, we have to show that the budget function 
                           
                              μ
                              =
                              μ
                              (
                              φ
                              )
                           
                         for fixed line investment is strictly increasing in the network fee φ and that 
                           
                              sign
                              
                                 (
                                 μ
                                 
                                    (
                                    0
                                    )
                                 
                                 )
                              
                              ≠
                              sign
                              
                                 (
                                 μ
                                 
                                    (
                                    
                                       φ
                                       ¯
                                    
                                    )
                                 
                                 )
                              
                           
                        . Note that correctness of the binary search algorithm only requires monotonicity of the budget function but strict monotonicity is required in order to obtain global optimal solutions. Here and in what follows, 
                           
                              φ
                              ¯
                           
                         denotes the upper bound on the network fee that is used in the binary search. Our discussion in Section 4 shows that cost from redispatch are always nonnegative. Moreover, they can only be zero in the case of no line investment. Since 
                           
                              R
                              (
                              0
                              )
                              =
                              0
                           
                         for every fee type, this shows μ(0) ≤ 0. Thus, it is sufficient to prove strict monotonicity of μ since then 
                           
                              μ
                              (
                              
                                 φ
                                 ¯
                              
                              )
                              >
                              0
                           
                         follows for sufficiently large 
                           
                              φ
                              ¯
                           
                        . Obviously, there is nothing to show for the case of a lump sum fee. In the next section, we prove a criterion for strict monotonicity for the generation capacity based fee 
                           
                              φ
                              =
                              
                                 φ
                                 gcb
                              
                           
                         and focus on the case of the energy based fee 
                           
                              φ
                              =
                              
                                 φ
                                 eb
                              
                           
                         in Section 6.1.2.

In the following, quantities without a subindex for network elements or time periods denote the corresponding vector, e.g., 
                              
                                 
                                    
                                       y
                                       ¯
                                    
                                    new
                                 
                                 =
                                 
                                    
                                       (
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       )
                                    
                                    
                                       n
                                       ∈
                                       N
                                    
                                 
                              
                            is the vector of all newly installed generation capacities. Using this notation, the budget function 
                              
                                 μ
                                 :
                                 R
                                 →
                                 R
                              
                            is defined as

                              
                                 
                                    
                                       μ
                                       
                                          (
                                          φ
                                          )
                                       
                                       
                                          :
                                          =
                                       
                                       R
                                       
                                          (
                                          φ
                                          ,
                                          
                                             
                                                y
                                                ¯
                                             
                                             new
                                          
                                          
                                             (
                                             φ
                                             )
                                          
                                          )
                                       
                                       −
                                       E
                                       
                                          (
                                          
                                             
                                                y
                                                ¯
                                             
                                             new
                                          
                                          
                                             (
                                             φ
                                             )
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

For the ease of exposition, we consider the slightly simplified spot market model without market splitting

                              
                                 (15a)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      d
                                                      ,
                                                      y
                                                      ,
                                                      
                                                         
                                                            y
                                                            ¯
                                                         
                                                         new
                                                      
                                                   
                                                
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ψ
                                                   spot
                                                
                                                
                                                   :
                                                   =
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      
                                                         N
                                                         dem
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   ∫
                                                   
                                                      0
                                                   
                                                   
                                                      d
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                                
                                                   p
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                d
                                                x
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      n
                                                      inv
                                                   
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      n
                                                      new
                                                   
                                                   +
                                                   φ
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      n
                                                      new
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      c
                                                      n
                                                      var
                                                   
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (15b)
                                 
                                    
                                       
                                          
                                             
                                                s.t.
                                                
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   n
                                                   new
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (15c)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      
                                                         N
                                                         dem
                                                      
                                                   
                                                
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

in which we (w.l.o.g.) assume that it can only be invested in one technology per node, all equivalent availabilities are 1, and the time steps τ are 1 hour. The corresponding redispatch model is given by

                              
                                 (16a)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      d
                                                      ,
                                                      y
                                                   
                                                
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ψ
                                                   redi
                                                
                                                
                                                   :
                                                   =
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         
                                                            N
                                                            dem
                                                         
                                                      
                                                   
                                                   
                                                      ∫
                                                      
                                                         0
                                                      
                                                      
                                                         d
                                                         
                                                            t
                                                            ,
                                                            n
                                                         
                                                      
                                                   
                                                   
                                                      p
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   
                                                      (
                                                      x
                                                      )
                                                   
                                                   
                                                   
                                                      d
                                                   
                                                   x
                                                   −
                                                   
                                                      ∑
                                                      
                                                         n
                                                         ∈
                                                         N
                                                      
                                                   
                                                   
                                                      c
                                                      n
                                                      var
                                                   
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16b)
                                 
                                    
                                       
                                          
                                             
                                                s.t.
                                                
                                                
                                             
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   n
                                                   new
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16c)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      
                                                         N
                                                         dem
                                                      
                                                   
                                                
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (16d)
                                 
                                    
                                       
                                          
                                          
                                             
                                                
                                                −
                                                
                                                   f
                                                   ¯
                                                
                                                ≤
                                                A
                                                
                                                   (
                                                   d
                                                   −
                                                   y
                                                   )
                                                
                                                ≤
                                                
                                                   f
                                                   ¯
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

where A is the well-known PTDF matrix that relates demand and production at nodes of an electricity network to power flows on lines. With these two models and the definition (10) of the TSO’s expenses, the budget function can be rewritten as

                              
                                 
                                    
                                       μ
                                       
                                          (
                                          φ
                                          )
                                       
                                       =
                                       
                                          
                                             ψ
                                             ^
                                          
                                          redi
                                       
                                       
                                          (
                                          
                                             
                                                y
                                                ¯
                                             
                                             new
                                          
                                          
                                             (
                                             φ
                                             )
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             ψ
                                             ^
                                          
                                          spot
                                       
                                       
                                          (
                                          φ
                                          )
                                       
                                       −
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                       
                                          c
                                          n
                                          inv
                                       
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       
                                          (
                                          φ
                                          )
                                       
                                       ,
                                    
                                 
                              
                           where only those dependencies on parameters are given that do not vanish in the first derivative w.r.t. φ. Strict monotonicity in φ is then equivalent to

                              
                                 (17)
                                 
                                    
                                       0
                                       <
                                       
                                          
                                             d
                                             μ
                                          
                                          
                                             d
                                             φ
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                ∇
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   new
                                                
                                             
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                redi
                                             
                                             )
                                          
                                          T
                                       
                                       
                                          ∇
                                          φ
                                       
                                       
                                          
                                             y
                                             ¯
                                          
                                          new
                                       
                                       −
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                       
                                          c
                                          n
                                          inv
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                n
                                                new
                                             
                                          
                                          
                                             ∂
                                             φ
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       .
                                    
                                 
                              
                           
                        

Thus, we have to compute the change in generation investment with respect to the network fee 
                              
                                 
                                    ∇
                                    φ
                                 
                                 
                                    
                                       y
                                       ¯
                                    
                                    new
                                 
                              
                            and the change in the optimal redispatch value with respect to the upper bounds on generation 
                              
                                 
                                    ∇
                                    
                                       
                                          y
                                          ¯
                                       
                                       new
                                    
                                 
                                 
                                    
                                       ψ
                                       ^
                                    
                                    redi
                                 
                              
                           . We start with the former and make use of the first-order optimality conditions of the spot market model (15), which are also sufficient in our case. These conditions comprise dual feasibility

                              
                                 (18a)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                +
                                                
                                                   λ
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                
                                                   N
                                                   dem
                                                
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (18b)
                                 
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   c
                                                   n
                                                   var
                                                
                                                +
                                                
                                                   α
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   β
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   λ
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (18c)
                                 
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   c
                                                   n
                                                   inv
                                                
                                                −
                                                φ
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   β
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

primal feasibility (15b) and (15c) as well as complementarity and nonnegativity of dual variables of inequality constraints (15b). That is, the lower bounds 0 ≤ y
                           
                              t, n
                            are equipped with dual variables α
                           
                              t, n
                           , upper bounds 
                              
                                 
                                    y
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 ≤
                                 
                                    
                                       y
                                       ¯
                                    
                                    n
                                 
                              
                            with β
                           
                              t, n
                           , and the market clearing condition (15c) with λt
                           . Note that a price equilibrium directly follows from (18a), i.e.,

                              
                                 (19)
                                 
                                    
                                       
                                          p
                                          
                                             t
                                             ,
                                             
                                                n
                                                i
                                             
                                          
                                       
                                       
                                          (
                                          
                                             d
                                             
                                                t
                                                ,
                                                
                                                   n
                                                   i
                                                
                                             
                                          
                                          )
                                       
                                       =
                                       
                                          p
                                          
                                             t
                                             ,
                                             
                                                n
                                                j
                                             
                                          
                                       
                                       
                                          (
                                          
                                             d
                                             
                                                t
                                                ,
                                                
                                                   n
                                                   j
                                                
                                             
                                          
                                          )
                                       
                                       
                                       for
                                       
                                       all
                                       
                                       
                                          
                                             n
                                             i
                                          
                                          ,
                                          
                                             n
                                             j
                                          
                                          ∈
                                          
                                             N
                                             dem
                                          
                                          ,
                                          t
                                          ∈
                                          T
                                       
                                    
                                 
                              
                           holds. Thus, it is reasonable to introduce the notation pt
                            (independent of a demand node n) for the spot market price in time period t. Combining (18a) and (18b) yields

                              
                                 (20)
                                 
                                    
                                       
                                          β
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       =
                                       
                                          p
                                          t
                                       
                                       −
                                       
                                          c
                                          n
                                          var
                                       
                                       +
                                       
                                          α
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       
                                       for
                                       
                                       all
                                       
                                       n
                                       ∈
                                       N
                                       ,
                                       t
                                       ∈
                                       T
                                       .
                                    
                                 
                              
                           
                        

From now on, we assume that no node ni
                            dominates another node nj
                           , i.e., we exclude the situation in which 
                              
                                 
                                    c
                                    
                                       n
                                       i
                                    
                                    inv
                                 
                                 <
                                 
                                    c
                                    
                                       n
                                       j
                                    
                                    inv
                                 
                              
                            and 
                              
                                 
                                    c
                                    
                                       n
                                       i
                                    
                                    var
                                 
                                 <
                                 
                                    c
                                    
                                       n
                                       j
                                    
                                    var
                                 
                              
                            holds. Moreover, we assume that all variable costs 
                              
                                 
                                    c
                                    n
                                    var
                                 
                                 ,
                                 n
                                 ∈
                                 N
                                 =
                                 
                                    {
                                    
                                       n
                                       1
                                    
                                    ,
                                    …
                                    
                                    ,
                                    
                                       n
                                       
                                          |
                                          N
                                          |
                                       
                                    
                                    }
                                 
                                 ,
                              
                            are positive and pairwise distinct and that the nodes are ordered such that

                              
                                 
                                    
                                       0
                                       <
                                       
                                          c
                                          
                                             n
                                             1
                                          
                                          var
                                       
                                       <
                                       
                                          c
                                          
                                             n
                                             2
                                          
                                          var
                                       
                                       <
                                       ⋯
                                       <
                                       
                                          c
                                          
                                             n
                                             
                                                |
                                                N
                                                |
                                             
                                          
                                          var
                                       
                                    
                                 
                              
                           holds. These assumptions allow us to state the following lemma, which follows directly from the optimality of spot market solutions:

                              Lemma 1
                              
                                 For every time step t ∈ T there exists a node index i such that
                                 
                                    
                                       
                                          
                                             
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            y
                                                            ¯
                                                         
                                                         
                                                            n
                                                            j
                                                         
                                                         new
                                                      
                                                      =
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            
                                                               n
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                      for
                                                      
                                                      all
                                                      
                                                      
                                                         j
                                                         <
                                                         i
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      0
                                                      =
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            
                                                               n
                                                               j
                                                            
                                                         
                                                      
                                                      
                                                      for
                                                      
                                                      all
                                                      
                                                      
                                                         j
                                                         >
                                                         i
                                                      
                                                      ,
                                                   
                                                
                                             
                                             
                                                
                                                
                                                
                                                   
                                                      0
                                                      ≤
                                                      
                                                         y
                                                         
                                                            t
                                                            ,
                                                            
                                                               n
                                                               i
                                                            
                                                         
                                                      
                                                      <
                                                      
                                                         
                                                            y
                                                            ¯
                                                         
                                                         
                                                            n
                                                            i
                                                         
                                                         new
                                                      
                                                      ,
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 holds for every optimal solution d, y, and
                                 
                                    
                                       
                                          y
                                          ¯
                                       
                                       new
                                    
                                  
                                 of the spot market model.
                              

In what follows, we use the index sets

                              
                                 
                                    
                                       
                                          
                                             
                                                T
                                                i
                                                =
                                             
                                          
                                          
                                             
                                                
                                                   :
                                                   =
                                                
                                                {
                                                t
                                                ∈
                                                T
                                                :
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      
                                                         n
                                                         i
                                                      
                                                   
                                                
                                                =
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   
                                                      n
                                                      i
                                                   
                                                   new
                                                
                                                ,
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      
                                                         n
                                                         j
                                                      
                                                   
                                                
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                j
                                                >
                                                i
                                                }
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                T
                                                i
                                                <
                                             
                                          
                                          
                                             
                                                
                                                   :
                                                   =
                                                
                                                {
                                                t
                                                ∈
                                                T
                                                :
                                                0
                                                <
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      
                                                         n
                                                         i
                                                      
                                                   
                                                
                                                <
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   
                                                      n
                                                      i
                                                   
                                                   new
                                                
                                                ,
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      
                                                         n
                                                         j
                                                      
                                                   
                                                
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                j
                                                >
                                                i
                                                }
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           In order to compute 
                              
                                 
                                    ∇
                                    φ
                                 
                                 
                                    
                                       y
                                       ¯
                                    
                                    new
                                 
                              
                            we now consider the KKT condition (18c). By subtracting the equation for node 
                              
                                 n
                                 
                                    i
                                    +
                                    1
                                 
                              
                            from the one for ni
                            and using (20) we obtain

                              
                                 
                                    
                                       
                                          γ
                                          
                                             i
                                             +
                                             1
                                             ,
                                             i
                                          
                                       
                                       +
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             
                                                T
                                                i
                                                =
                                             
                                          
                                       
                                       
                                          p
                                          t
                                       
                                       =
                                       0
                                       ,
                                    
                                 
                              
                           where 
                              
                                 γ
                                 
                                    i
                                    +
                                    1
                                    ,
                                    i
                                 
                              
                            only depends on variable and investment costs. Here, we used the price equilibrium (19), condition (20), and Lemma 1. We now apply Gaussian elimination steps in which we replace the equation of node ni
                            by the difference of equation for node ni
                            and of node 
                              
                                 n
                                 
                                    i
                                    +
                                    1
                                 
                              
                            for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 
                                 ,
                                 |
                                 N
                                 |
                                 −
                                 1
                              
                           . The equation of the last node stays untouched. This gives

                              
                                 (21a)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      
                                                         T
                                                         i
                                                         =
                                                      
                                                   
                                                
                                                
                                                   p
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                ,
                                                
                                                for
                                                
                                                all
                                                
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                
                                                ,
                                                |
                                                N
                                                |
                                                −
                                                1
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (21b)
                                 
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   c
                                                   
                                                      n
                                                      
                                                         |
                                                         N
                                                         |
                                                      
                                                   
                                                   inv
                                                
                                                −
                                                φ
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      
                                                         T
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                         =
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      p
                                                      t
                                                   
                                                   −
                                                   
                                                      c
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      var
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We make the additional assumption (which is in line with our case studies) that the price functions are linear, i.e., 
                              
                                 
                                    p
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 
                                    (
                                    
                                       d
                                       
                                          t
                                          ,
                                          n
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    a
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 −
                                 
                                    s
                                    n
                                 
                                 
                                    d
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 ,
                              
                            where a
                           
                              t, n
                            > 0 is the intercept with the price axis and 
                              
                                 −
                                 
                                    s
                                    n
                                 
                                 <
                                 0
                              
                            is the slope. Note that fluctuation is only modeled by shifted intercepts whereas the slope of the price functions stays the same. Furthermore, we need the well-known notion of so-called inverse market demand functions Pt
                           (Dt
                           ), which represent the price functions for the aggregated market demand in time step t. They are given as 
                              
                                 
                                    P
                                    t
                                 
                                 
                                    (
                                    
                                       D
                                       t
                                    
                                    )
                                 
                                 =
                                 
                                    A
                                    t
                                 
                                 +
                                 S
                                 
                                    D
                                    t
                                 
                              
                            with

                              
                                 (22)
                                 
                                    
                                       
                                          D
                                          t
                                       
                                       =
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                          
                                       
                                       
                                          d
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       ,
                                       
                                       
                                          A
                                          t
                                       
                                       =
                                       
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             
                                                a
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             /
                                             
                                                s
                                                n
                                             
                                          
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             1
                                             /
                                             
                                                s
                                                n
                                             
                                          
                                       
                                       ,
                                       
                                       S
                                       =
                                       −
                                       
                                          1
                                          
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             1
                                             /
                                             
                                                s
                                                n
                                             
                                          
                                       
                                       .
                                    
                                 
                              
                           
                        

The inverse demand functions can be derived as follows: First solve the single demand functions for d
                           
                              t, n
                           , yielding 
                              
                                 
                                    d
                                    
                                       t
                                       ,
                                       n
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       a
                                       
                                          t
                                          ,
                                          n
                                       
                                    
                                    −
                                    
                                       p
                                       
                                          t
                                          ,
                                          n
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    s
                                    n
                                 
                              
                           . Since all prices are equal for all nodes, we have

                              
                                 
                                    
                                       
                                          D
                                          t
                                       
                                       
                                       =
                                       
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                          
                                       
                                       
                                          d
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       
                                       =
                                       
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                          
                                       
                                       
                                          (
                                          
                                             a
                                             
                                                t
                                                ,
                                                n
                                             
                                          
                                          −
                                          
                                             p
                                             
                                                t
                                                ,
                                                n
                                             
                                          
                                          )
                                       
                                       /
                                       
                                          s
                                          n
                                       
                                       =
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                          
                                       
                                       
                                          a
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       /
                                       
                                          s
                                          n
                                       
                                       −
                                       
                                          P
                                          t
                                       
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                          
                                       
                                       1
                                       /
                                       
                                          s
                                          n
                                       
                                    
                                 
                              
                           yielding (22). This fact allows to rewrite (21) as

                              
                                 (23a)
                                 
                                    
                                       
                                          
                                             
                                                
                                                   γ
                                                   
                                                      i
                                                      +
                                                      1
                                                      ,
                                                      i
                                                   
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      
                                                         T
                                                         i
                                                         =
                                                      
                                                   
                                                
                                                
                                                   P
                                                   t
                                                
                                                
                                                   (
                                                   
                                                      ∑
                                                      
                                                         k
                                                         =
                                                         1
                                                      
                                                      i
                                                   
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         k
                                                      
                                                      new
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                ,
                                                
                                                for
                                                
                                                all
                                                
                                                i
                                                =
                                                1
                                                ,
                                                …
                                                
                                                ,
                                                |
                                                N
                                                |
                                                −
                                                1
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (23b)
                                 
                                    
                                       
                                          
                                             
                                                −
                                                
                                                   c
                                                   
                                                      n
                                                      
                                                         |
                                                         N
                                                         |
                                                      
                                                   
                                                   inv
                                                
                                                −
                                                φ
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      
                                                         T
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                         =
                                                      
                                                   
                                                
                                                
                                                   (
                                                   
                                                      P
                                                      t
                                                   
                                                   
                                                      (
                                                      
                                                         ∑
                                                         
                                                            n
                                                            ∈
                                                            N
                                                         
                                                      
                                                      
                                                         
                                                            y
                                                            ¯
                                                         
                                                         n
                                                         new
                                                      
                                                      )
                                                   
                                                   −
                                                   
                                                      c
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      var
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

We now additionally assume 
                              
                                 
                                    γ
                                    
                                       i
                                       +
                                       1
                                       ,
                                       i
                                    
                                 
                                 ≠
                                 0
                              
                            for all 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 ,
                                 |
                                 N
                                 |
                                 −
                                 1
                              
                           . Eq. (23a) then uniquely define 
                              
                                 
                                    y
                                    ¯
                                 
                                 
                                    n
                                    i
                                 
                                 new
                              
                            for 
                              
                                 i
                                 =
                                 1
                                 ,
                                 …
                                 
                                 ,
                                 |
                                 N
                                 |
                                 −
                                 1
                              
                            and do not depend on the fee φ. Thus, we have

                              
                                 (24)
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   n
                                                   i
                                                
                                                new
                                             
                                          
                                          
                                             ∂
                                             φ
                                          
                                       
                                       =
                                       0
                                       
                                       for
                                       
                                       all
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       
                                       ,
                                       
                                          |
                                          N
                                          |
                                       
                                       −
                                       1
                                       .
                                    
                                 
                              
                           
                        

In addition, the remaining partial derivative is given by the following lemma.

                              Lemma 2
                              
                                 It holds
                                 
                                    
                                       
                                          
                                             Φ
                                             
                                                :
                                                =
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      new
                                                   
                                                
                                                
                                                   ∂
                                                   φ
                                                
                                             
                                             
                                                
                                                   (
                                                   |
                                                   
                                                      T
                                                      
                                                         |
                                                         N
                                                         |
                                                      
                                                      =
                                                   
                                                   |
                                                   S
                                                   )
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             <
                                             0
                                             .
                                          
                                       
                                    
                                 
                              


                                 Eq. (23b) is an equation of the form 
                                    
                                       F
                                       (
                                       
                                          
                                             y
                                             ¯
                                          
                                          
                                             n
                                             1
                                          
                                          new
                                       
                                       
                                          (
                                          φ
                                          )
                                       
                                       ,
                                       …
                                       
                                       ,
                                       
                                          
                                             y
                                             ¯
                                          
                                          
                                             n
                                             
                                                |
                                                N
                                                |
                                             
                                          
                                          new
                                       
                                       
                                          (
                                          φ
                                          )
                                       
                                       ;
                                       φ
                                       )
                                       =
                                       0
                                    
                                 . Thus, (24) and the implicit function theorem imply

                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   F
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      new
                                                   
                                                
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      new
                                                   
                                                
                                                
                                                   ∂
                                                   φ
                                                
                                             
                                             =
                                             −
                                             
                                                
                                                   ∂
                                                   F
                                                
                                                
                                                   ∂
                                                   φ
                                                
                                             
                                             .
                                          
                                       
                                    
                                 
                              

The claim follows since 
                                    
                                       
                                          ∂
                                          φ
                                       
                                       F
                                       =
                                       −
                                       1
                                    
                                  and

                                    
                                       
                                          
                                             
                                                
                                                   ∂
                                                   F
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      new
                                                   
                                                
                                             
                                             =
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   
                                                      T
                                                      
                                                         |
                                                         N
                                                         |
                                                      
                                                      =
                                                   
                                                
                                             
                                             S
                                             .
                                          
                                       
                                    
                                 
                                 □

It can be easily shown that 
                              
                                 
                                    |
                                 
                                 
                                    T
                                    
                                       |
                                       N
                                       |
                                    
                                    =
                                 
                                 
                                    |
                                    >
                                    0
                                    ,
                                 
                              
                            justifying the definition of Φ. Using the previous lemma, we finally obtain the following monotonicity criterion:

                              Theorem 1
                              
                                 Let the spot market and redispatch model with linear demand functions and network fee φ be given as in 
                                 
                                    (15)
                                  
                                 and 
                                 
                                    (16)
                                 
                                 . Furthermore, let
                                 
                                    
                                       
                                          ψ
                                          ^
                                       
                                       redi
                                    
                                  
                                 be the optimal value of the redispatch model,
                                 
                                    
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       ,
                                       n
                                       ∈
                                       N
                                       ,
                                    
                                  
                                 be the spot market optimal capacity generation investment, Φ be as defined in Lemma 
                                 
                                    2
                                  
                                 and let
                                 
                                    
                                       
                                          γ
                                          
                                             i
                                             +
                                             1
                                             ,
                                             i
                                          
                                       
                                       ≠
                                       0
                                    
                                  
                                 for all
                                 
                                    
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       ,
                                       |
                                       N
                                       |
                                       −
                                       1
                                    
                                 
                                 . Then, the budget function is strictly increasing in [0, φ] if
                                 
                                    
                                       (25)
                                       
                                          
                                             
                                                Θ
                                                gcb
                                             
                                             
                                                :
                                                =
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         ψ
                                                         ^
                                                      
                                                      redi
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         
                                                            |
                                                            N
                                                            |
                                                         
                                                      
                                                      new
                                                   
                                                
                                             
                                             +
                                             
                                                Φ
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   N
                                                
                                             
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                n
                                                new
                                             
                                             −
                                             
                                                c
                                                
                                                   n
                                                   
                                                      |
                                                      N
                                                      |
                                                   
                                                
                                                inv
                                             
                                             <
                                             0
                                          
                                       
                                    
                                 
                                 holds.
                              

From the preceding computations it directly follows that dφ
                                 μ > 0 holds if and only if 
                                    
                                       
                                          Θ
                                          gcb
                                       
                                       <
                                       0
                                    
                                  holds. Additionally, 
                                    
                                       Θ
                                       gcb
                                    
                                  is strictly decreasing in 
                                    
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       ,
                                       n
                                       ∈
                                       N
                                    
                                 : The second derivative of the optimal value function of the redispatch model (first term) vanishes due to the envelope theorem and because the capacities appear only linearly in the Lagrangian. The second term also vanishes after differentiating, and the derivative of the third term is 
                                    
                                       
                                          Φ
                                          
                                             −
                                             1
                                          
                                       
                                       ,
                                    
                                  which is also negative. Moreover, 
                                    
                                       Θ
                                       gcb
                                    
                                  is increasing in the fee φ because 
                                    
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       ,
                                       n
                                       ∈
                                       N
                                       ,
                                    
                                  are decreasing in φ.□

As a consequence, the correctness of the binary search follows if (25) holds for the generation capacity corresponding to the upper bound 
                              
                                 φ
                                 ¯
                              
                           . In order to check (25) in practice, we finally note that the first term can be expressed by the dual variables of the redispatch model. From standard sensitivity analysis of convex optimization (cf., Boyd & Vandenberghe, 2004) we obtain

                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                redi
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   n
                                                   
                                                      |
                                                      N
                                                      |
                                                   
                                                
                                                new
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                       
                                          β
                                          
                                             t
                                             ,
                                             
                                                n
                                                
                                                   |
                                                   N
                                                   |
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           holds, where 
                              
                                 
                                    β
                                    
                                       t
                                       ,
                                       
                                          n
                                          
                                             |
                                             N
                                             |
                                          
                                       
                                    
                                 
                                 ,
                                 t
                                 ∈
                                 T
                                 ,
                              
                            are the optimal dual variables of the upper bounds in (16b).

In order to show the correctness of the binary search algorithm for the case of the energy based fee 
                              
                                 φ
                                 =
                                 
                                    φ
                                    eb
                                 
                                 ,
                              
                            we consider the slightly modified spot market model

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   max
                                                   
                                                      d
                                                      ,
                                                      y
                                                      ,
                                                      
                                                         
                                                            y
                                                            ¯
                                                         
                                                         new
                                                      
                                                   
                                                
                                                
                                             
                                          
                                          
                                          
                                             
                                                
                                                   ψ
                                                   spot
                                                
                                                
                                                   :
                                                   =
                                                
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      
                                                         N
                                                         dem
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   ∫
                                                   
                                                      0
                                                   
                                                   
                                                      d
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                
                                                
                                                   p
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   x
                                                   )
                                                
                                                
                                                d
                                                x
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   (
                                                   
                                                      c
                                                      n
                                                      inv
                                                   
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      n
                                                      new
                                                   
                                                   +
                                                   
                                                      ∑
                                                      
                                                         t
                                                         ∈
                                                         T
                                                      
                                                   
                                                   
                                                      c
                                                      n
                                                      var
                                                   
                                                   
                                                      y
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      
                                                         N
                                                         dem
                                                      
                                                   
                                                
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                φ
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                s.t.
                                                
                                             
                                          
                                          
                                          
                                             
                                                0
                                                ≤
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   n
                                                   new
                                                
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                          
                                             
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      
                                                         N
                                                         dem
                                                      
                                                   
                                                
                                                
                                                   d
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   ∑
                                                   
                                                      n
                                                      ∈
                                                      N
                                                   
                                                
                                                
                                                   y
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                t
                                                ∈
                                                T
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

The redispatch model (16) stays the same. With these models at hand, we can rewrite the budget function as

                              
                                 
                                    
                                       μ
                                       
                                          (
                                          φ
                                          )
                                       
                                       =
                                       
                                          
                                             ψ
                                             ^
                                          
                                          redi
                                       
                                       
                                          (
                                          
                                             
                                                y
                                                ¯
                                             
                                             new
                                          
                                          
                                             (
                                             φ
                                             )
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             ψ
                                             ^
                                          
                                          spot
                                       
                                       
                                          (
                                          φ
                                          )
                                       
                                       −
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                       
                                          c
                                          n
                                          inv
                                       
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       
                                          (
                                          φ
                                          )
                                       
                                       .
                                    
                                 
                              
                           
                        

Thus, the budget function is strictly increasing in φ if

                              
                                 (26)
                                 
                                    
                                       
                                          
                                             d
                                             μ
                                          
                                          
                                             d
                                             φ
                                          
                                       
                                       =
                                       
                                          
                                             (
                                             
                                                ∇
                                                
                                                   
                                                      y
                                                      ¯
                                                   
                                                   new
                                                
                                             
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                redi
                                             
                                             )
                                          
                                          T
                                       
                                       
                                          ∇
                                          φ
                                       
                                       
                                          
                                             y
                                             ¯
                                          
                                          new
                                       
                                       +
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             
                                                N
                                                dem
                                             
                                          
                                       
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                       
                                          d
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       −
                                       
                                          ∑
                                          
                                             n
                                             ∈
                                             N
                                          
                                       
                                       
                                          c
                                          n
                                          inv
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                n
                                                new
                                             
                                          
                                          
                                             ∂
                                             φ
                                          
                                       
                                       >
                                       0
                                    
                                 
                              
                           holds. As before,

                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   ψ
                                                   ^
                                                
                                                redi
                                             
                                          
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                n
                                                new
                                             
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             t
                                             ∈
                                             T
                                          
                                       
                                       
                                          β
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                    
                                 
                              
                           is known from standard sensitivity analysis. Thus, we have to compute 
                              
                                 
                                    ∇
                                    φ
                                 
                                 
                                    
                                       y
                                       ¯
                                    
                                    new
                                 
                              
                           . The main strategy is the same as for the generation capacity based fee. Dual feasibility conditions of the spot market model read

                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   p
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                
                                                   (
                                                   
                                                      d
                                                      
                                                         t
                                                         ,
                                                         n
                                                      
                                                   
                                                   )
                                                
                                                −
                                                φ
                                                +
                                                
                                                   λ
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                
                                                   N
                                                   dem
                                                
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                −
                                                
                                                   c
                                                   n
                                                   var
                                                
                                                +
                                                
                                                   α
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   β
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                                −
                                                
                                                   λ
                                                   t
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                ,
                                                t
                                                ∈
                                                T
                                                ,
                                             
                                          
                                       
                                       
                                          
                                             
                                                −
                                                
                                                   c
                                                   n
                                                   inv
                                                
                                                +
                                                
                                                   ∑
                                                   
                                                      t
                                                      ∈
                                                      T
                                                   
                                                
                                                
                                                   β
                                                   
                                                      t
                                                      ,
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                =
                                                0
                                                
                                                for
                                                
                                                all
                                                
                                                n
                                                ∈
                                                N
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

As before, the first condition implies the equilibrium of spot market prices (19) for each time step t ∈ T. Thus, λt
                            can be eliminated in the first two conditions yielding

                              
                                 (27)
                                 
                                    
                                       
                                          β
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       =
                                       
                                          p
                                          t
                                       
                                       −
                                       
                                          c
                                          n
                                          var
                                       
                                       −
                                       φ
                                       +
                                       
                                          α
                                          
                                             t
                                             ,
                                             n
                                          
                                       
                                       
                                       for
                                       
                                       all
                                       
                                       n
                                       ∈
                                       N
                                       ,
                                       t
                                       ∈
                                       T
                                       .
                                    
                                 
                              
                           
                        

Using the same techniques as in the last section, we obtain

                              
                                 
                                    
                                       
                                          ∂
                                          
                                             ∂
                                             φ
                                          
                                       
                                       
                                          (
                                          
                                             ∑
                                             
                                                k
                                                =
                                                1
                                             
                                             i
                                          
                                          
                                             
                                                y
                                                ¯
                                             
                                             
                                                n
                                                k
                                             
                                             new
                                          
                                          )
                                       
                                       =
                                       
                                          1
                                          S
                                       
                                       
                                       for
                                       
                                       all
                                       
                                       i
                                       =
                                       1
                                       ,
                                       …
                                       
                                       ,
                                       
                                          |
                                          N
                                          |
                                       
                                       ,
                                    
                                 
                              
                           which readily implies

                              
                                 
                                    
                                       
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   n
                                                   1
                                                
                                                new
                                             
                                          
                                          
                                             ∂
                                             φ
                                          
                                       
                                       =
                                       
                                          1
                                          S
                                       
                                       ,
                                       
                                       
                                          
                                             ∂
                                             
                                                
                                                   y
                                                   ¯
                                                
                                                
                                                   n
                                                   i
                                                
                                                new
                                             
                                          
                                          
                                             ∂
                                             φ
                                          
                                       
                                       =
                                       0
                                       
                                       for
                                       
                                       all
                                       
                                       i
                                       =
                                       2
                                       ,
                                       …
                                       
                                       ,
                                       
                                          |
                                          N
                                          |
                                       
                                       .
                                    
                                 
                              
                           
                        

This implies the following theorem.

                              Theorem 2
                              
                                 Let the spot market and redispatch model with linear demand functions and network fee φ be given as in 
                                 
                                    (26)
                                  
                                 and 
                                 
                                    (16)
                                 
                                 . Furthermore, let
                                 
                                    
                                       
                                          ψ
                                          ^
                                       
                                       redi
                                    
                                  
                                 be the optimal value of the redispatch model and
                                 
                                    
                                       
                                          
                                             y
                                             ¯
                                          
                                          n
                                          new
                                       
                                       ,
                                       n
                                       ∈
                                       N
                                       ,
                                    
                                  
                                 be the spot market optimal capacity generation investments. Then, the budget function is strictly increasing in [0, φ] if
                                 
                                    
                                       (28)
                                       
                                          
                                             
                                                Θ
                                                eb
                                             
                                             
                                                :
                                                =
                                             
                                             
                                                
                                                   ∂
                                                   
                                                      
                                                         ψ
                                                         ^
                                                      
                                                      redi
                                                   
                                                
                                                
                                                   ∂
                                                   
                                                      
                                                         y
                                                         ¯
                                                      
                                                      
                                                         n
                                                         1
                                                      
                                                      new
                                                   
                                                
                                             
                                             +
                                             S
                                             
                                                ∑
                                                
                                                   n
                                                   ∈
                                                   
                                                      N
                                                      dem
                                                   
                                                
                                             
                                             
                                                ∑
                                                
                                                   t
                                                   ∈
                                                   T
                                                
                                             
                                             
                                                d
                                                
                                                   t
                                                   ,
                                                   n
                                                
                                             
                                             −
                                             
                                                c
                                                
                                                   n
                                                   1
                                                
                                                inv
                                             
                                             <
                                             0
                                          
                                       
                                    
                                 
                                 holds.
                              

From the preceding computations it directly follows that dφ
                                 μ > 0 is equivalent to 
                                    
                                       
                                          Θ
                                          eb
                                       
                                       <
                                       0
                                    
                                 . By the same arguments as before, it can be shown that the demands d
                                 
                                    t, n
                                  are decreasing in φ. Since S < 0, this implies that the second term is increasing in φ. Thus, 
                                    
                                       Θ
                                       eb
                                    
                                  is increasing in φ.□

In other words, the last theorem shows the correctness of the binary search algorithm for energy based fees and values of 
                              
                                 φ
                                 ¯
                              
                            that fulfill criterion (28).

Given the importance of appropriate network fee bounds, we take the following strategy. In all network fee regimes we use zero as a lower bound excluding negative fees. Then, we compute monopoly solutions of the spot market scenario (cf. model (15)) and derive the respective monopoly markups. We use these markups as upper bounds. In the case of the energy based fee, we use the average monopoly markup across all time periods and market zones as an upper bound. In the case of the generation capacity based fee, we use the cumulative monopoly markup across all time periods, where total generation capacity is binding in a given zone. To obtain the upper bound we then take averages over all market zones. In our computational study (cf. Section 7) the obtained upper bounds fulfill the criteria developed in the last section (cf. conditions (25) and (28)) and thus lead to a well-defined search strategy.

An ingenuous way of incorporating all possible network configurations by simply introducing binary variables for every extension and degradation typically yields very large mixed-integer problems that are hard to solve in practice. In order to reduce the number of combinatorial choices, we model network extensions and degradations in the following way: By 
                           
                              
                                 L
                                 
                                    j
                                    k
                                 
                                 new
                              
                              ⊆
                              
                                 L
                                 inter
                              
                              ∩
                              
                                 L
                                 new
                              
                           
                         we denote the set of candidate transmission lines and by 
                           
                              L
                              
                                 j
                                 k
                              
                              ex
                           
                         the set of existing lines between zone Zj
                         and zone Zk
                        . Moreover, let Γjk
                         denote the set of transmission capacities between the two zones that can be realized by an investment in or a degradation of a (sub)set of lines between the zones, i.e.,

                           
                              
                                 
                                    
                                       Γ
                                       
                                          j
                                          k
                                       
                                    
                                    
                                       :
                                       =
                                    
                                    
                                       {
                                       
                                          
                                             f
                                             ¯
                                          
                                          
                                             j
                                             k
                                          
                                       
                                       =
                                       
                                          ∑
                                          
                                             l
                                             ∈
                                             X
                                          
                                       
                                       
                                          
                                             f
                                             ¯
                                          
                                          l
                                       
                                       :
                                       ∅
                                       ⊆
                                       X
                                       ⊆
                                       
                                          (
                                          
                                             L
                                             
                                                j
                                                k
                                             
                                             new
                                          
                                          ∪
                                          
                                             L
                                             
                                                j
                                                k
                                             
                                             ex
                                          
                                          )
                                       
                                       }
                                    
                                    .
                                 
                              
                           
                        
                     

Since intra-zone transmission capacities do not affect spot market trading, intra-zone network modifications do not have to be considered in the subproblem. This allows us to iterate only over the set of inter-zone network modifications in the outer loop of Alg 1. Moreover, we do not iterate over the specific network configurations but over the set of relevant capacities, i.e., over all elements of

                           
                              
                                 
                                    
                                       ∏
                                       
                                          
                                             Z
                                             j
                                          
                                          ,
                                          
                                             Z
                                             k
                                          
                                          ∈
                                          Z
                                          ,
                                          j
                                          ≠
                                          k
                                       
                                    
                                    
                                       Γ
                                       
                                          j
                                          k
                                       
                                    
                                    .
                                 
                              
                           
                        
                     

This way, the constraint for 
                           
                              
                                 
                                    f
                                    ¯
                                 
                                 
                                    j
                                    k
                                 
                              
                              ∈
                              
                                 Γ
                                 
                                    j
                                    k
                                 
                              
                           
                         of a zonal version of the market splitting flow restrictions (12) reads

                           
                              
                                 
                                    −
                                    
                                       
                                          f
                                          ¯
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    ≤
                                    
                                       ∑
                                       
                                          l
                                          =
                                          
                                             (
                                             j
                                             ,
                                             k
                                             )
                                          
                                          ∈
                                          
                                             L
                                             inter
                                          
                                       
                                    
                                    
                                       f
                                       
                                          t
                                          ,
                                          l
                                       
                                    
                                    ≤
                                    
                                       
                                          f
                                          ¯
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    
                                       t
                                       ∈
                                       T
                                    
                                    .
                                 
                              
                           
                        
                     

On the other hand, the master problem determines both a welfare maximizing intra-zone network extension and a welfare maximizing inter-zone network extension that yields the predefined inter-zone transmission capacity of the given network extension and degradation plan. Thus, the master problem is additionally restricted by the following constraint:

                           
                              
                                 
                                    
                                       ∑
                                       
                                          l
                                          ∈
                                          
                                             L
                                             
                                                j
                                                k
                                             
                                             ex
                                          
                                       
                                    
                                    
                                       (
                                       1
                                       −
                                       
                                          z
                                          l
                                          ex
                                       
                                       )
                                    
                                    
                                       
                                          f
                                          ¯
                                       
                                       l
                                    
                                    +
                                    
                                       ∑
                                       
                                          l
                                          ∈
                                          
                                             L
                                             
                                                j
                                                k
                                             
                                             new
                                          
                                       
                                    
                                    
                                       z
                                       l
                                       new
                                    
                                    
                                       
                                          f
                                          ¯
                                       
                                       l
                                    
                                    =
                                    
                                       
                                          f
                                          ¯
                                       
                                       
                                          j
                                          k
                                       
                                    
                                    
                                    for
                                    
                                    all
                                    
                                    
                                       Z
                                       j
                                    
                                    ,
                                    
                                       Z
                                       k
                                    
                                    
                                    with
                                    
                                    j
                                    ≠
                                    k
                                    .
                                 
                              
                           
                        
                     

Note that this reduction technique is only possible if physical line characteristics other than thermal capacities do not play a role on the spot market.

Taking all together, the fixation of a network extension yields a concave-quadratic maximization over a polyhedral set for the subproblem and additionally relaxing the budget constraint yields a concave-quadratic mixed-integer maximization with respect to linear constraints for the master problem.

In this section we discuss computational results for two prominent test networks from the literature. The first example is taken from Jenabi et al. (2013) and consists of three nodes. The second test network is a six-node example by Chao and Peck (1998) that has been widely used in the energy market literature. For both test cases (consisting of the network structure as well as demand and cost parameters) we compute

                        
                           (1)
                           the welfare optimum of the integrated planner model;

the market outcomes in the case of a market model without market splitting.

For the six-node example we additionally compute

                        
                           (3)
                           the market outcomes in the case of a market model with market splitting.

For the market models we consider all three different network fee regimes, i.e., the lump sum, the energy based, and the generation capacity based fee. Note that we transformed all parameters into equivalent annual hourly values.

We implemented the market model as well as the integrated planner model in Zimpl (see Koch, 2004) and used SCIP (see Achterberg, 2009) to generate corresponding mps files. Finally, we solved the problems using CPLEX 12.5.1; see CPLEX (2013). All experiments were performed on a 12 core computer equipped with two AMD Opteron(tm) 2435 Processors and 64 gigabyte DDR2-RAM. Using the binary search algorithm described in the last section, every instance is solved within seconds. This indicates that our method also seems quite promising for larger test instances.

Before we present our main results, we briefly review the input data that is directly taken from Jenabi et al. (2013). The graph consists of three nodes, three existing lines, and one candidate line as depicted in Fig. 4
                        , where all physical and economical data of the network are given. We allow for both investment in the transmission network and in generation capacity. We consider four time periods and assume that at the beginning of the planning horizon there are no existing generators but explicitly model generation investment. Node 1 and node 2 are generation nodes. Technology 1 can be built at node 1 and technology 2 can be built at node 2. The equivalent availability of generation capacity is 80 percent.

Consumers are located at node 3. We assume that the demand function is 
                           
                              p
                              =
                              550
                              −
                              500
                              d
                           
                        . To give the four periods some simple interpretation, we refer to them as the four seasons spring, summer, autumn, and winter. For this reason, we multiply the intercept of the above demand function by 1, 0.5, 1, and 1.5 in time period 1–4, respectively.

@&#DISCUSSION@&#


                           Table 5 presents the computational results for the three node network. The table compares the first best solution (which would result from a nodal pricing approach) to an energy-only market with a single price zone. The integrated planner approach yields a social welfare of 1083 dollars. An energy-only market without market splitting, i.e., one price zone, implies a welfare loss as compared to the first best solution in all three network fee regimes. In the case of a generation capacity based fee, an energy based fee, and a lump sum fee the realized welfare levels are 1050 dollars, 1044 dollars, and 1040 dollars, respectively.

This welfare loss is mainly driven by a distortion of generation investment. As Table 5 illustrates, the solution to the integrated planner problem implies positive investment in both technologies, where investment in technology 2—which has lower investment cost—is much larger. In contrast, the trilevel power market model yields generation investment only in technology 2, as technology 1 would earn too little on the spot market to recover investment cost. Generation investment in technology 2 in the trilevel power market model is higher than in the welfare optimum implying an overinvestment at node 2 for all network fee regimes—lowest for the generation capacity based fee, highest for the lump sum fee.

The three considered network fee regimes have different effects on investment decisions in generation capacity. The intuition is as follows. If the fee is collected based on installed capacity (
                              
                                 φ
                                 gcb
                              
                           ), the fee directly increases investment cost. This obviously decreases investment incentives as compared to a regime with a lump sum fee (
                              
                                 φ
                                 ls
                              
                           ), which would not enter a firm’s first-order condition. This immediately explains the fact that less capacity is invested under a capacity based fee than under a lump sum fee. Now consider the energy based fee 
                              
                                 φ
                                 eb
                              
                           . The energy based fee reduces the revenues collected at the spot market (by the fee per megawatt hour) and thereby also decreases the investment incentives as compared to a lump sum fee. However, investment is more beneficial than under a capacity based fee that collects the same overall revenue for the TSO, since contributions to cover network cost are also collected from infra-marginal production, which does not affect the first-order condition that determines optimal investment. For investment in only one technology—as in our example—this explains the observed differences in installed generation capacity at node 2.

Even though generation investment is inefficient in the solution of our market model as compared to the first best solution, line investment is equivalent to the first best in all three scenarios: The candidate line connecting the nodes 1 and 2 is build in the trilevel power market model as well as in the welfare optimum.

In total, the capacity based fee produces the lowest welfare distortion in our example. This is due to the fact that overinvestment is less severe than under the other regimes. Consequently, in this particular example, welfare is highest with a capacity based fee. However, note that this does not indicate that capacity based fees are generally the most desirable choice among the considered network fee regimes. This will become clear in the second example that we present in Section 7.2.

Let us finally motivate why we do not consider market splitting in the three node example. In the considered network, the two lines connecting the consumer to the firms each have sufficient capacity to transmit the entire production in any period. Capacity constraints in the network occur solely due to the low capacity of the line connecting the generators, which restricts available capacity at the other two lines due to loop flows. As a consequence, market splitting with inter-zonal capacities that are equal to nominal inter-zonal line capacities would not be effective, since desired transmission would never exceed these transfer capacities. Market splitting into two zones could become effective if substantially lower inter-zonal capacities were considered in the context of market splitting. Since such a choice of low inter-zonal capacities would somehow be arbitrary, we abstain from calculating an example and refer the reader to the discussion of the six node network for the consideration of price zones, or to Grimm, Martin, Weibelzahl, and Zöttl (2015a).

While the three node network provides some intuition for different levels of generation investment under different network fee regimes, we do not obtain insights on the effects, which the market design and in particular the configuration of price zones may have on transmission line expansion. On top of that, we already emphasized that the desirability of different network fee regimes might depend on details of the environment. In the following we consider an adapted 52-period test example based on Chao and Peck (1998) in order to illustrate these issues and to provide further intuition. The network of this example has extensively been analyzed in the literature to illustrate different energy market models. We extend the original test example by several aspects that are specific to our approach, such as fluctuating demand, generation investment, network investment, and a cost-based redispatch mechanism.

As Fig. 5
                         illustrates, the network consists of six nodes connected by eight existing transmission lines (solid). Northern nodes (nodes 1–3) and southern nodes (nodes 4–6) are interconnected by lines with unlimited capacities. The “northern zone” and the “southern zone” are interconnected by only two lines with limited capacities. We consider a situation where two different candidate transmission lines (dashed) can be built to alleviate congestion problems. The technical line data as well as all other data is given in Fig. 5. The equivalent availability of generation capacity is 80 percent.

We again assume that there are no existing generators but explicitly model generation investment. Generation units can be built at nodes 1, 2, and 4. Demand is located at nodes 3, 5, and 6. The basic demand functions are 
                           
                              
                                 p
                                 3
                              
                              =
                              37.5
                              −
                              −
                              0.05
                              
                              
                                 d
                                 3
                              
                              ,
                              
                                 p
                                 5
                              
                              =
                              75
                              −
                              0.1
                              
                              
                                 d
                                 5
                              
                              ,
                              
                                 p
                                 6
                              
                              =
                              80
                              −
                              0.1
                              
                              
                                 d
                                 6
                              
                           
                        . Assuming these three demand functions taken from Chao and Peck (1998) we use real-world data to induce demand fluctuation across the 52 periods at all nodes.
                           5
                        
                        
                           5
                           Alternatively, one could choose random draws from a distribution that reflects the nature of demand fluctuation in electricity markets.
                         In particular, we use factors derived from the German demand realizations of 2011 for shifting the demand functions; see ENTSO-E (2012b). Demand levels across nodes in a given period are always shifted by the same factor, which accounts for the fact that the level of demand in a given period is typically correlated across demand nodes.

@&#DISCUSSION@&#


                           Table 6
                            summarizes the computational results for the six node example for three different scenarios concerning the cost of line investment (190,000 dollars, 230,000 dollars, and 270,000 dollars). We compare the first best solution (which corresponds to the outcome of a nodal pricing regime) to two market designs with an energy-only market with one and with two price zones. In our example, market splitting (two price zones) significantly increases welfare as compared to a single price zone, but welfare does not achieve its optimal level.
                              6
                           
                           
                              6
                              Note that it cannot be generally shown that market splitting increases welfare in electricity markets if investment is considered as an endogenous choice. Grimm et al. (2015a) show in a three node network, that market splitting can actually decrease welfare for badly configured zones.
                            We also show that the network fee regime matters for generation investment and welfare. In all scenarios, investment in generation capacity is (ceteris paribus) highest under a lump sum fee, second highest under an energy based fee, and lowest under a capacity based fee. We provided a general intuition for this in Section 7.1.1. The six node example illustrates clearly, however, that higher (or lower) generation investment does not automatically translate into lower (or higher) welfare. It is rather the particular interplay of line investment, generation investment, and production schedules that determines the overall welfare effect. In the scenarios that we consider there is for each network fee regime at least one case where this particular regime is welfare superior to the other two regimes. It is moreover notable that overinvestment due to a lump sum network fee is much more severe in the single zone setup, which may contribute to the fact that the lump sum fee is never optimal (in our example) in combination with a single zone.


                           Table 6 also illustrates investment decisions in transmission line expansion for the different scenarios. In the welfare optimum the social planner refrains from transmission line expansion and instead installs positive generation capacities at all nodes, unless line investment cost is low. If investment cost is low, he expands one of the two lines. Obviously, from a welfare perspective investment in generation capacity at node 4 is preferable to line investment, although variable production cost of the available technology is substantially higher than variable cost of technologies available at northern nodes. Furthermore, due to the fact that demand satisfied by northern generators is relatively low in the absence of line investment, in the welfare optimum more generation capacity is built at node 2, where investment cost is lower than at node 1, but variable generation cost is higher.

In the scenarios with an energy-only market and one single price zone at least one line is built in any scenario (i.e., for all combinations of line investment costs and network fee regimes). If line investment cost is low, both lines are built. Investment in generation capacity takes place exclusively at node 1, where the technology with the lowest variable production cost is located. This is due to the fact that no other generator could sell its capacity at the spot market. In case of a lump sum network fee, generation investment is substantially higher, while energy based and capacity based fees lead to the same extent of generation investment. Welfare is lowest under the lump sum fee, which suggests substantial overinvestment. Energy and capacity based fees yield the same welfare results.

We moreover consider scenarios with market splitting and two price zones. Line investment is lower (or sometimes equal) as compared to a single zone, but in some scenarios higher than in the welfare optimum. Market splitting induces generation investment at node 4, the more the fewer lines are built. In all scenarios investment is suboptimally distributed across the nodes in the northern zone. While a substantial investment at node 2 would be welfare optimal, firms invest exclusively at node 1 in the northern zone, due to missing price signals within the zone. The welfare optimal network fee regime with two price zones is the energy based fee in the scenario with high line investment costs (where no line is built), and the lump sum fee otherwise.

Prices for the case of an energy based fee and line investment cost of 270,000 dollars are shown in Fig. 6
                            and support the above intuition. In the welfare optimal solution, prices at the consumption nodes are low in the north (node 3) and high in the south (nodes 5 and 6). With one price zone the spot market price is relatively high. However, generators with high unit production cost have no possibility to contract their supply at the spot market. Two price zones imply a north–south spread, which induces investment in the south.

This paper analyzes the long-run impact of different transmission management regimes on investment incentives of generating firms in a market environment with a regulated TSO. We propose a trilevel optimization approach to model an electricity market with cost-based redispatch both with and without market splitting, accounting for different network fee regimes. As a first best benchmark we also solve the corresponding integrated planner problem, in which a central planner controls both the grid and generation units. In order to solve our trilevel problem computationally, we present a reformulation that relies on a detailed analysis of the interconnection between the three problem levels. We apply our approach to two simple test instances in order to demonstrate the capabilities to analyze transmission and capacity expansion in a market environment.

Our results show that in a market environment investment choices by the TSO and by private firms can substantially differ from welfare optimal choices. In our case studies, generation investment in the welfare optimum is distributed across all possible supply locations, which would also be obtained under a nodal pricing regime in our setup. In a market environment with a uniform electricity price at all nodes, generation investment is typically concentrated at the node where the available technology exhibits lowest variable production cost. This is due to the fact that technologies with higher production cost (but probably lower investment cost) cannot contract their supply at the spot market and thus would have no chance to recover their investment cost. Splitting the market into zones alleviates the problem that generation investment is concentrated at particular nodes. However, distortions remain unless each node constitutes a zone.

Line investment by the TSO clearly reacts to anticipated generation investment. Distributed capacity in the welfare optimum is complemented by no or only minor network expansion. Concentrated generation investment at single nodes in a market environment with one price zone implies extensive expansion up to the maximum level. The introduction of price zones leads to an intermediate level of line expansion. Obviously, a market environment where transmission cost is not reflected in the prices induces overinvestment in line expansion, which is sometimes even coupled with overinvestment in generation capacity.

Our model moreover allows to compare different network fee regimes. In our case studies we compare three regimes, a lump sum fee, an energy based fee collected upon production, as well as a capacity based fee. From a theoretical perspective the lump sum fee should give rise to higher generation investment than the energy based fee, and the capacity based fee should trigger lowest generation investment (see also Ruderer and Zöttl (2012) for a thorough theoretical analysis). This is due to the fact that the lump sum fee does not affect the first-order condition of the firms investment choice problem, whereas the capacity based fee and the energy based fee increase investment cost (capacity based fee) or decrease marginal returns (energy based fee) and thereby decrease investment incentives. Our analysis clearly shows that the clear ranking in terms of investment incentives does not translate in a welfare ranking in a simple way. Whether high or low generation investment is preferable from a welfare point of view crucially depends on where exactly the investment takes place, and whether the installed capacity can be utilized. Our computations reveal that any network fee regime can be the optimal one, depending on the scenario under consideration.

In summary, in this paper we develop a trilevel model that allows to compare different market designs in electricity markets and to assess their effects on long-run investment decisions in network and generation capacity. Thus, our approach is an important and obvious extension of the literature that up to now has mainly considered the short-run properties of different transmission management regimes. Computational results that we report from two case studies demonstrate that transmission management can have substantial effects in the long-run when generation and transmission expansion are taken into account. Further research will extend the insights by applying the method to existing networks and by extending the model in order to capture further aspects of common market designs.

@&#ACKNOWLEDGMENTS@&#

This research was performed as part of the Energie Campus Nürnberg and supported by funding through the “Aufbruch Bayern (Bavaria on the move)” initiative of the state of Bavaria (D7-F2421.4.3/9/2) and the Emerging Field Initiative (EFI) of the Friedrich-Alexander-Universität Erlangen-Nürnberg through the project “Sustainable Business Models in Energy Markets” (EFO-Proj:RW01). We would like to thank Robert Bixby, Katja Breitmoser, Andreas Ehrenmann, Frauke Liers, Johannes Müller, Lars Schewe, and Yves Smeers for valuable comments and discussions. The authors thank the Deutsche Forschungsgemeinschaft for their support within project A05 and B07 in the Sonderforschungsbereich/Transregio 154 “Mathematical Modelling, Simulation and Optimization Using the Example of Gas Networks”. Finally, we thank two anonymous referees, whose comments on the manuscript greatly helped to improve the quality of the paper.

@&#REFERENCES@&#

