@&#MAIN-TITLE@&#A high capacity reversible data hiding method for 2D vector maps based on virtual coordinates

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop a high capacity reversible data hiding method for 2D vector maps.


                        
                        
                           
                           
                              Virtual coordinates are exploited to expand the capacity.


                        
                        
                           
                           The data capacity achieves nearly 
                                 2
                                 c
                              
                              
                                 
                                    (
                                    c
                                    ≥
                                    1
                                    )
                                 
                               bits/vertex.


                        
                        
                           
                           The reversibility, invisibility, and computational complexity are good.


                        
                        
                           
                           For polylines and polygons, content preserving operations can be resisted.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Reversible data hiding

Data capacity

2D vector map




                     virtual coordinates

@&#ABSTRACT@&#


               
               
                  In this paper, we propose a high capacity reversible data hiding method for 2D vector maps based on virtual coordinates. In the scheme, we calculate two virtual coordinates for each eligible coordinate, and embed 
                        c
                      (
                        c
                        ≥
                        1
                     ) secret bits by modifying the state value of the interval which is created by the two corresponding virtual coordinates. Since nearly every coordinate can carry 
                        c
                      bits, the data capacity in bits achieves nearly 
                        2
                        c
                      times the number of vertices in the vector map. In addition, to resist content preserving operations, the vertex traversing order is defined. Experimental results and analysis show that the proposed method provides good reversibility, invisibility and computational complexity and is robust against the feature rearrangement and vertex reversing attacks for polylines and polygons.
               
            

@&#INTRODUCTION@&#

Today, 2D vector maps, the fundamental data of geographical information systems (GISs), have been intensively applied in military, civil cartography, urban planning, forestry etc. The acquisition of such data is a high cost process  [1–5]. These vector geo-spatial data can be easily replicated, manipulated and distributed. On the other hand, thanks to powerful available tools and equipment, it is very easy even for an amateur to illegally modify and copy these valuable data. Tools that help us verify the integrity and protect the copyright of the 2D vector map content are thus essential.

In the past few years, many new techniques and concepts based on data hiding or steganography have been introduced as a means for tamper detection  [6,7] and copyright protection  [1–5,8–19] in 2D vector maps. Data hiding can be defined as a process that hides data in a multimedia object. In most cases of data hiding, the original content is modified, and hence distorted in order to embed the hidden information in an irreversible way, i.e., they cannot recover the original data. However, due to the required high-precision nature of 2D vector maps, it is critical to reverse the embedded content back to the original version after the hidden data are retrieved. The techniques satisfying this requirement are reversible (also referred to as invertible, lossless, or distortion-free) data hiding. Those methods embed the secret data into the host signal in an invertible manner so that after the hidden data are extracted, the signal can be restored to its original form.

Currently, research on reversible data hiding is mainly focused on images  [20–31]. Vector graphics are relatively new media forms for many applications, such as GIS and computer aided design (CAD). Some reversible data hiding schemes have been proposed for 3D graphic models  [32–39]. In 2001, Dittmann and Benedens  [32] proposed an invertible labeling algorithm by exploiting the method in  [33], which embeds data by adding faces and vertices. Although the data capacity is high, the extra bandwidth it requires for transmitting the added vertices and faces may be undesirable. Considering a triangle as a two-state geometrical object, Cayre and Macq  [34] described a reversible data hiding algorithm that hides data by modifying the triangle’s state according to the bit to be hidden. This method provides good robustness against translation, rotation and scaling transformations. However, it does not have large enough capacity and it takes too much time. In  [35], the minimum spanning tree (MST) and the connectivity of edges are used in a reversible data hiding scheme for 3D graphic models. Although it does not change the position of vertices in the 3D space, the embedding capacity is too low (close to 0.06 bit/vertex). Wu and Cheung  [36] proposed a method that embeds one bit into a mesh face by modulating the distance from the mesh faces to the mesh centroid. Despite the low capacity (at most 1 bit/face), the original mesh can only be approximately recovered. Based on the idea of sequential quantization, Cheung and Wu conceal 
                        n
                        −
                        1
                      secret bits in a mesh with 
                        n
                      vertices in  [37]. Although the capacity is high (around 1 bit/vertex), it also only approximately recovers the original content. Another scheme is proposed by Wu and Dugelay  [38], where prediction-error expansion  [31] is used for obtaining good hiding capacity (about 3 bits/vertex).

Of special interest to this paper is the work done by Wang and Wang  [39]. They firstly sort the coordinates of each axis in the point-sampled model to create intervals, and then embed 
                        c
                      secret bits into an interval by modifying the state value of the interval. The data capacity of this method is high (around 1.5
                        c
                      bits/vertex). However, when it is applied to the vector data in which the coordinates exhibit low correlation, the distortion may be not small. Besides, the computational complexity may be high since the coordinates have to be sorted before embedding.

The reversible data hiding schemes for 2D vector maps  [17–19]have been presented a little besides 3D graphic models. Voigt et al.  [17] hide the secret data by modifying the frequency coefficient in the integer discrete cosine transform (DCT) domain according to the embedded bit being 1 or 0. Since this algorithm is realized in the frequency domain, controlling the embedding distortion in the spatial domain seems complex. Besides, the data capacity is not high. In  [18], two reversible data hiding schemes based on the idea of difference expansion  [23] are proposed: one hides data by modifying the differences between adjacent coordinates, and the second by manipulating the Manhattan distances between neighboring vertices. The data capacities of these methods are at most 1 bit/vertex and 0.5 bit/vertex, respectively. The two approaches have good invisibility in maps with dense vertices whereas the performance could be seriously decreased for maps whose coordinates exhibit low correlation. To provide good invisibility, Zhou et al.  [19] offered a reversible data hiding algorithm that embeds secret bits by modifying the difference histogram which is established by the differences of neighboring vertices. The maximum embedding capacity of this method is 1 bit/vertex. Furthermore, to make the difference expansion suitable for 2D CAD engineering graphics with low data correlation, Peng et al. made an improvement in  [40]. By hiding secret bits in the scale factor of the relative coordinates, this approach provides high embedding capacity (at least 1 bit/vertex) and good invisibility. However, because the distance between every two vertices has to be calculated for selecting the reference vertices, the computational complexity may be very high. Another drawback of the aforementioned schemes for 2D vector graphics  [17–19,40] is that they are not robust against content preserving operations such as feature rearrangement and vertex reversing.

To embed a large amount of data with insignificant visual distortion of the original vector map in which the coordinates exhibit low correlation, and simultaneously increasing the robustness against content preserving operations, we propose a reversible data hiding method for 2D vector maps based on virtual coordinates. The proposed algorithm is inspired by the reversible data hiding approach by Wang and Wang  [39]. Rather than sorting the coordinates to yield intervals for data embedding, we divide the distance between the maximum coordinate and the minimum coordinate of each axis into segments, calculate two virtual coordinates according to the segment which an eligible coordinate is within, and modify the state value of the interval created by the two virtual coordinates to accommodate secret bits. For achieving robustness against content preserving operations, the vertex traversing order is defined. The advantages of the proposed method include the following: (1) the data capacity can be very large, nearly 
                        2
                        c
                      (
                        c
                        ≥
                        1
                     ) bit/vertex, where 
                        c
                      is the number of secret bits each eligible coordinate carries; (2) the reversibility, invisibility, and computational complexity are good; (3) for polylines and polygons, feature rearrangement and vertex reversing operations can be resisted. The experimental results and analysis will be given to reveal the advantages of the proposed method.

The paper is organized as follows. We briefly review the reversible data hiding method by Wang and Wang  [39] and present our improvement based on virtual coordinates in Section  2. In Section  3, we propose our reversible data hiding scheme. Our experimental results and an analysis of the algorithm are provided in Section  4. Finally, conclusions are summarized in Section  5.

In this section, we briefly review Wang and Wang’s  [39] scheme in Section  2.1, and describe our improvement based on virtual coordinates in Section  2.2.

The basic idea of Wang and Wang’s algorithm  [39] is as follows. Given a list of vertices, the coordinates of each axis are first sorted to produce sorted lists; then every sorted list is divided into intervals, each of which contains three adjacent sorted coordinates. Finally, 
                           c
                           
                           
                              (
                              c
                              ≥
                              1
                              )
                           
                         secret bits are embedded into an interval by modifying the interval’s state value.

The state value of an interval is defined as follows. Suppose 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ≤
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              <
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              )
                           
                         are three adjacent 
                           x
                         coordinates in the sorted 
                           X
                        -axis. The interval between 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         can be divided into 
                           P
                        
                        
                           
                              (
                              P
                              ≥
                              2
                              )
                           
                         equal subintervals. The index of the subinterval which the coordinate 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         is located on indicates the interval’s state value. Since the watermark is embedded by moving 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         between 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                        , the watermarked 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         remains within the range 
                           
                              [
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        . As a result, no watermarked coordinate exceeds the original coordinate range, and all the watermarked vertices are within the original vertex range.

Denote the interval which contains the three adjacent 
                           x
                         coordinates (
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                        ) in the sorted 
                           X
                        -axis as 
                           Q
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                              
                              )
                           
                        , and the watermark to be embedded as 
                           w
                           
                              (
                              0
                              ≤
                              w
                              <
                              
                                 
                                    2
                                 
                                 
                                    c
                                 
                              
                              )
                           
                        .

In the embedding phase, the 
                           r
                         state of the interval 
                           Q
                         is first calculated, 
                           
                              (1)
                              
                                 
                                    {
                                    
                                       
                                          
                                             r
                                             =
                                             0
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             <
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                             
                                             /
                                             2
                                          
                                       
                                       
                                          
                                             r
                                             =
                                             1
                                          
                                          
                                             if
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   2
                                                
                                             
                                             ≥
                                             
                                                (
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      1
                                                   
                                                
                                                +
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      3
                                                   
                                                
                                                )
                                             
                                             /
                                             2
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        
                     

Then, the interval 
                           Q
                         is divided into 
                           
                              
                                 2
                              
                              
                                 c
                                 +
                                 1
                              
                           
                         equal subintervals. The state value 
                           s
                         of the watermarked interval 
                           
                              
                                 Q
                              
                              
                                 ′
                              
                           
                        , i.e., the index of the subinterval which the embedded coordinate 
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         should be located on is computed by 
                           
                              (2)
                              
                                 s
                                 =
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 ×
                                 r
                                 +
                                 w
                                 .
                              
                           
                        
                     

Finally, the embedded 
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         is obtained by moving 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         to the 
                           s
                        th subinterval, 
                           
                              (3)
                              
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 +
                                 s
                                 ×
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    
                                       2
                                    
                                    
                                       c
                                       +
                                       1
                                    
                                 
                                 +
                                 κ
                                 /
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              (4)
                              
                                 κ
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                 
                                 −
                                 
                                    (
                                    1
                                    −
                                    r
                                    )
                                 
                                 ×
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                 
                                 −
                                 r
                                 ×
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 /
                                 2
                                 .
                              
                           
                        
                     

After watermark embedding, 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           ≤
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         still holds and if 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         holds, 
                           
                              
                                 x
                              
                              
                                 1
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 3
                              
                           
                         will hold. That is, the watermarked coordinates still keep their original sorted order and no watermarked coordinate exceeds the original coordinate range. Besides, assuming the length of 
                           Q
                         is 
                           
                              
                                 l
                              
                              
                                 Q
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         moves less than 
                           
                              
                                 l
                              
                              
                                 Q
                              
                           
                           /
                           2
                         for embedding the watermark 
                           w
                        .

In the extraction phase, the 
                           r
                         state of the watermarked interval 
                           
                              
                                 Q
                              
                              
                                 ′
                              
                           
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    1
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    2
                                 
                                 
                                    ′
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    3
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         (
                           
                              
                                 x
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                           ≤
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                           <
                           
                              
                                 x
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                        ), which consists of the three watermarked coordinates 
                           
                              
                                 x
                              
                              
                                 1
                              
                              
                                 ′
                              
                           
                        , 
                           
                              
                                 x
                              
                              
                                 2
                              
                              
                                 ′
                              
                           
                         and 
                           
                              
                                 x
                              
                              
                                 3
                              
                              
                                 ′
                              
                           
                        , is also first calculated with Eq. (1).

Then, each subinterval’s length 
                           
                              
                                 l
                              
                              
                                 s
                              
                           
                         is computed according to the embedded interval 
                           
                              
                                 Q
                              
                              
                                 ′
                              
                           
                        , 
                           
                              (5)
                              
                                 
                                    
                                       l
                                    
                                    
                                       s
                                    
                                 
                                 =
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    
                                       2
                                    
                                    
                                       c
                                       +
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

Next, the state value 
                           s
                         of the embedded interval 
                           
                              
                                 Q
                              
                              
                                 ′
                              
                           
                         is calculated, 
                           
                              (6)
                              
                                 s
                                 =
                                 
                                    ⌊
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    /
                                    
                                       
                                          l
                                       
                                       
                                          s
                                       
                                    
                                    ⌋
                                 
                                 .
                              
                           
                        
                     

Then, the embedded watermark 
                           w
                         is obtained, 
                           
                              (7)
                              
                                 w
                                 =
                                 s
                                 −
                                 r
                                 ×
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 .
                              
                           
                        
                     

Finally, the original coordinate 
                           
                              
                                 x
                              
                              
                                 2
                              
                           
                         is restored, 
                           
                              (8)
                              
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       ″
                                    
                                 
                                 =
                                 
                                    (
                                    1
                                    −
                                    r
                                    )
                                 
                                 ×
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 +
                                 r
                                 ×
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    +
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 /
                                 2
                                 +
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 ×
                                 
                                    
                                       κ
                                    
                                    
                                       ′
                                    
                                 
                                 ,
                              
                           
                         where 
                           
                              (9)
                              
                                 
                                    
                                       κ
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       2
                                    
                                    
                                       ′
                                    
                                 
                                 −
                                 
                                    
                                       x
                                    
                                    
                                       1
                                    
                                    
                                       ′
                                    
                                 
                                 −
                                 s
                                 ×
                                 
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          3
                                       
                                       
                                          ′
                                       
                                    
                                    −
                                    
                                       
                                          x
                                       
                                       
                                          1
                                       
                                       
                                          ′
                                       
                                    
                                    )
                                 
                                 /
                                 
                                    
                                       2
                                    
                                    
                                       c
                                       +
                                       1
                                    
                                 
                                 .
                              
                           
                        
                     

The above is Wang and Wang’s approach.

In order to improve the data capacity and decrease the computational complexity of Wang and Wang’s algorithm  [39], we create intervals by calculating two neighboring virtual coordinates for every coordinate rather than sorting the coordinates of each axis to yield intervals. To provide good invisibility, we control the embedding distortion by appropriately selecting the length of each interval.

We need to point out that in our improved method the minimum and maximum coordinates of each axis do not carry watermarks.

Given a list of vertices, we first divide the distance between the maximum and the minimum coordinates of each axis into equal segments. Then, for each coordinate, two neighboring virtual coordinates are calculated according to the segment which the coordinate is within, and an interval is formed by combining the coordinate itself and its two neighboring virtual coordinates. After that, every new formed interval can carry a watermark by modifying its state value.

We use the 
                              X
                           -axis to illustrate the embedding and extraction processes. Suppose 
                              X
                              =
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 i
                                 ∈
                                 
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                                 }
                              
                            is an 
                              x
                            coordinate list composed of 
                              n
                            elements, 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                            is the minimum coordinate of 
                              X
                            and 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                            is the maximum coordinate of 
                              X
                           .

In the embedding stage, we first find the minimum and maximum coordinates of 
                              X
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       min
                                    
                                 
                                   and  
                                 
                                    
                                       x
                                    
                                    
                                       max
                                    
                                 
                                 )
                              
                           .

Then, we divide the distance between 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                            into 
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                              
                              
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       x
                                    
                                 
                                 ≥
                                 2
                                 )
                              
                            equal segments. According to the number of segments 
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                           , the length of each segment 
                              
                                 
                                    l
                                 
                                 
                                    t
                                 
                              
                            can be calculated by 
                              
                                 (10)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                    
                                    =
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             max
                                          
                                       
                                       −
                                       
                                          
                                             x
                                          
                                          
                                             min
                                          
                                       
                                       )
                                    
                                    /
                                    
                                       
                                          D
                                       
                                       
                                          x
                                       
                                    
                                    .
                                 
                              
                           
                        

After that, for any coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 i
                                 ∈
                                 
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                                 )
                              
                            of 
                              X
                           , we calculate two neighboring coordinates 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                            for it, and obtain an interval 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            by combining the coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            and its two calculated neighboring coordinates (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                           ) according to the index 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                              
                                 (
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       D
                                    
                                    
                                       x
                                    
                                 
                                 −
                                 1
                                 )
                              
                            of the segment which 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            is within, 
                              
                                 (11)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                =
                                                
                                                   ⌊
                                                   
                                                      (
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                      −
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                      )
                                                   
                                                   /
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                   ⌋
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      l
                                                   
                                                
                                                =
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      min
                                                   
                                                
                                                +
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      
                                                         
                                                            x
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                
                                                ×
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                                =
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      min
                                                   
                                                
                                                +
                                                
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   1
                                                   )
                                                
                                                ×
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      t
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            We regard the neighboring coordinates (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                           ) of 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            which is calculated by Eq. (11) as 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           ’s two virtual coordinates. As illustrated in Fig. 1
                           , the two virtual coordinates (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                           ) of 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            also indicate the boundary of the 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                              
                           th segment. Because the calculated virtual coordinates do not really exist in the coordinate list 
                              X
                           , they are illustrated in dark gray.

Finally, a watermark 
                              w
                              
                                 (
                                 0
                                 ≤
                                 w
                                 <
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 )
                              
                            can be embedded into an interval by modifying its state value with Eqs. (1)–(4). Since 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                            are used to calculate the two neighboring virtual coordinates for each coordinate, correct calculation of the two virtual coordinates of each coordinate and correct watermark extraction in the data extraction phase may be impossible if they are used to embed watermarks. As a result, 
                              
                                 
                                    x
                                 
                                 
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                            do not carry watermarks in our method. Therefore, if an 
                              x
                            coordinate e.g.,  
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                           , can be used to carry a watermark, its corresponding interval 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                              
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       l
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       r
                                    
                                 
                                 )
                              
                            should satisfy the following condition, 
                              
                                 (12)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                <
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      max
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            We call an 
                              x
                            coordinate that satisfies the above condition an eligible x coordinate. Similarly, assuming 
                              
                                 
                                    y
                                 
                                 
                                    max
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    min
                                 
                              
                            are the maximum and the minimum coordinates in the 
                              Y
                           -axis, 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            is a 
                              y
                            coordinate, and 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    l
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                                 
                                    r
                                 
                              
                            are 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                           ’s two neighboring virtual coordinates 
                              s
                           , we call 
                              
                                 
                                    y
                                 
                                 
                                    i
                                 
                              
                            an eligible 
                           
                              y
                            coordinate if it satisfies that 
                              
                                 (13)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      l
                                                   
                                                
                                                ≤
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                <
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      r
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      min
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      i
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      max
                                                   
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                            In the rest of this paper, we call a coordinate an eligible coordinate if it is an eligible x coordinate or an eligible y coordinate.

After watermark embedding, a watermarked coordinate list 
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                    
                                       ′
                                    
                                 
                                 |
                                 i
                                 ∈
                                 
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                                 }
                              
                            is obtained.

In the above embedding procedure, an eligible x coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            moves less than 
                              
                                 
                                    l
                                 
                                 
                                    t
                                 
                              
                              /
                              2
                            to embed a watermark. That is, the Euclidean distance between a vertex and its watermarked version is less than 
                              
                                 
                                    l
                                 
                                 
                                    e
                                 
                              
                           , where 
                              
                                 (14)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          e
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                l
                                             
                                             
                                                t
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                          
                                          
                                             
                                                D
                                             
                                             
                                                x
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            Therefore, to make sure that the embedding distortion does not exceed the vector map’s precision tolerance 
                              τ
                           , we can assign a value to 
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                            so that 
                              
                                 (15)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          e
                                       
                                    
                                    ≤
                                    τ
                                    .
                                 
                              
                            In other words, to ensure the validity of the map data, 
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                            should satisfy the following condition, 
                              
                                 (16)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          x
                                       
                                    
                                    ≥
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                max
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                          
                                          τ
                                       
                                    
                                    .
                                 
                              
                            As a simple implementation, we assign a value to 
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                              
                            by 
                              
                                 (17)
                                 
                                    
                                       
                                          D
                                       
                                       
                                          x
                                       
                                    
                                    =
                                    
                                       ⌈
                                       
                                          
                                             
                                                
                                                   x
                                                
                                                
                                                   max
                                                
                                             
                                             −
                                             
                                                
                                                   x
                                                
                                                
                                                   min
                                                
                                             
                                          
                                          
                                             
                                                
                                                   2
                                                
                                             
                                             τ
                                          
                                       
                                       ⌉
                                    
                                    .
                                 
                              
                           
                        

During watermark extraction, similar steps are followed.

First, we find the maximum coordinate 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                                 
                                    ′
                                 
                              
                            and the minimum coordinate 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                                 
                                    ′
                                 
                              
                            of 
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                           .

Then, the distance between 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    
                                       max
                                    
                                 
                                 
                                    ′
                                 
                              
                            is divided into 
                              
                                 
                                    D
                                 
                                 
                                    x
                                 
                                 
                                    ′
                                 
                              
                              
                              
                                 (
                                 
                                    
                                       D
                                    
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 ≥
                                 2
                                 )
                              
                            equal segments, and the length of each segment 
                              
                                 
                                    l
                                 
                                 
                                    t
                                 
                                 
                                    ′
                                 
                              
                            is calculated with Eq. (10).

Next, for any watermarked eligible 
                           
                              x
                            coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              
                              
                                 (
                                 i
                                 ∈
                                 
                                    [
                                    1
                                    ,
                                    n
                                    ]
                                 
                                 )
                              
                            of 
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                           , two neighboring virtual coordinates 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                    ′
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                    ′
                                 
                              
                            are computed according to the index 
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              
                                 (
                                 0
                                 ≤
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             i
                                          
                                          
                                             ′
                                          
                                       
                                    
                                 
                                 ≤
                                 
                                    
                                       D
                                    
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                                 −
                                 1
                                 )
                              
                            of the segment which 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            is located on with Eq. (11), and a watermarked interval 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           (
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                    ′
                                 
                              
                           , 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           , 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                    ′
                                 
                              
                           ) is formed by combining the coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            and its two neighboring virtual coordinates 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    l
                                    ′
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    r
                                    ′
                                 
                              
                           .

Finally, for any watermarked eligible x coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            of 
                              
                                 
                                    X
                                 
                                 
                                    ′
                                 
                              
                           , the embedded watermark is extracted from its corresponding watermarked interval 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            and the original 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                              
                            is restored using Eqs. (1) and (5)–(9). After extracting the embedded watermarks from all the eligible 
                           
                              x
                            coordinates, the original coordinate list 
                              X
                            can be recovered.

According to Eqs. (5)–(9), a watermark is extracted from a watermarked eligible 
                           
                              x
                            coordinate 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            by calculating the state value of its corresponding embedded interval 
                              
                                 
                                    Q
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                           , i.e., the index of the subinterval which 
                              
                                 
                                    x
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                            is located on. If the calculated state value is not the same as the one used in the embedding stage, the extracted watermark will not be equal to the embedded one. Denote the length of each subinterval calculated with Eq. (5) for the 
                              X
                           -axis as 
                              
                                 
                                    l
                                 
                                 
                                    x
                                 
                                 
                                    s
                                    ′
                                 
                              
                           . In general, 
                              
                                 
                                    l
                                 
                                 
                                    x
                                 
                                 
                                    s
                                    ′
                                 
                              
                            is a double-precision number, which gives from 15 to 17 significant decimal digits precision. Once 
                              
                                 
                                    l
                                 
                                 
                                    x
                                 
                                 
                                    s
                                    ′
                                 
                              
                            is no more than 
                              1
                              
                                 
                                    0
                                 
                                 
                                    −
                                    15
                                 
                              
                           , the calculated state value may be not the same as the original one, and the extracted watermark may be not equal to the embedded one. Hence, to guarantee correct extraction, 
                              
                                 
                                    l
                                 
                                 
                                    x
                                 
                                 
                                    s
                                    ′
                                 
                              
                            should satisfy the following condition 
                              
                                 (18)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          x
                                       
                                       
                                          s
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          l
                                       
                                       
                                          t
                                       
                                       
                                          ′
                                       
                                    
                                    /
                                    
                                       
                                          2
                                       
                                       
                                          c
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                max
                                             
                                             
                                                ′
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                min
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                x
                                             
                                             
                                                ′
                                             
                                          
                                          ×
                                          
                                             
                                                2
                                             
                                             
                                                c
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                x
                                             
                                             
                                                max
                                             
                                             
                                                ′
                                             
                                          
                                          −
                                          
                                             
                                                x
                                             
                                             
                                                min
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             ⌈
                                             
                                                
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         max
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         min
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                   τ
                                                
                                             
                                             ⌉
                                          
                                          ×
                                          
                                             
                                                2
                                             
                                             
                                                c
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    >
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          15
                                       
                                    
                                    .
                                 
                              
                            Similarly, assuming 
                              
                                 
                                    y
                                 
                                 
                                    max
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    min
                                 
                                 
                                    ′
                                 
                              
                            are the maximum and the minimum coordinates in the watermarked 
                              Y
                           -axis, 
                              
                                 
                                    D
                                 
                                 
                                    y
                                 
                                 
                                    ′
                                 
                              
                            is the number of equal segments into which the distance between 
                              
                                 
                                    y
                                 
                                 
                                    max
                                 
                                 
                                    ′
                                 
                              
                            and 
                              
                                 
                                    y
                                 
                                 
                                    min
                                 
                                 
                                    ′
                                 
                              
                            is divided, and 
                              
                                 
                                    l
                                 
                                 
                                    y
                                 
                                 
                                    s
                                    ′
                                 
                              
                            is the length of each subinterval calculated with Eq. (5) for the 
                              Y
                           -axis, to guarantee correct extraction, 
                              
                                 
                                    l
                                 
                                 
                                    y
                                 
                                 
                                    s
                                    ′
                                 
                              
                            should satisfy the following condition 
                              
                                 (19)
                                 
                                    
                                       
                                          l
                                       
                                       
                                          y
                                       
                                       
                                          s
                                          ′
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                max
                                             
                                             
                                                ′
                                             
                                          
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                min
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             
                                                D
                                             
                                             
                                                y
                                             
                                             
                                                ′
                                             
                                          
                                          ×
                                          
                                             
                                                2
                                             
                                             
                                                c
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                y
                                             
                                             
                                                max
                                             
                                             
                                                ′
                                             
                                          
                                          −
                                          
                                             
                                                y
                                             
                                             
                                                min
                                             
                                             
                                                ′
                                             
                                          
                                       
                                       
                                          
                                             ⌈
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         max
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         min
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         2
                                                      
                                                   
                                                   τ
                                                
                                             
                                             ⌉
                                          
                                          ×
                                          
                                             
                                                2
                                             
                                             
                                                c
                                                +
                                                1
                                             
                                          
                                       
                                    
                                    >
                                    1
                                    
                                       
                                          0
                                       
                                       
                                          −
                                          15
                                       
                                    
                                    .
                                 
                              
                            This means that the value of 
                              c
                            should satisfy that 
                              
                                 (20)
                                 
                                    c
                                    <
                                    
                                       
                                          c
                                       
                                       
                                          min
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 (21)
                                 
                                    
                                       
                                          c
                                       
                                       
                                          min
                                       
                                    
                                    =
                                    min
                                    
                                       (
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      max
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                −
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      min
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               max
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               x
                                                            
                                                            
                                                               min
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                         τ
                                                      
                                                   
                                                   ⌉
                                                
                                                ×
                                                1
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      −
                                                      15
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       1
                                       ,
                                       
                                          
                                             log
                                          
                                          
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      max
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                −
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      min
                                                   
                                                   
                                                      ′
                                                   
                                                
                                             
                                             
                                                
                                                   ⌈
                                                   
                                                      
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               max
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               y
                                                            
                                                            
                                                               min
                                                            
                                                            
                                                               ′
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               2
                                                            
                                                         
                                                         τ
                                                      
                                                   
                                                   ⌉
                                                
                                                ×
                                                1
                                                
                                                   
                                                      0
                                                   
                                                   
                                                      −
                                                      15
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       −
                                       1
                                       )
                                    
                                    .
                                 
                              
                            Therefore, assuming the number of eligible coordinates is 
                              
                                 
                                    N
                                 
                                 
                                    e
                                 
                              
                           , we can get the upper limit of the data capacity of the improved algorithm 
                              
                                 
                                    U
                                 
                                 
                                    c
                                 
                              
                            by 
                              
                                 (22)
                                 
                                    
                                       
                                          U
                                       
                                       
                                          c
                                       
                                    
                                    =
                                    
                                       
                                          N
                                       
                                       
                                          e
                                       
                                    
                                    ×
                                    
                                       
                                          c
                                       
                                       
                                          min
                                       
                                    
                                    .
                                 
                              
                           
                        

The above is our improved method. Since 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                            do not carry watermarks, no watermarked coordinate exceeds the range 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       max
                                    
                                 
                                 )
                              
                            after watermark embedding. In the watermark extraction stage, 
                              
                                 
                                    x
                                 
                                 
                                    min
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    max
                                 
                              
                            can still be correctly identified and the virtual coordinates of each watermarked coordinate can be correctly obtained. Thus, correct extraction of the embedded watermarks and recovery of the original content can be ensured.

In this section, the improved reversible data hiding method described in Section  2.2 is implemented in the reversible data hiding algorithm for 2D vector maps.

Our proposed scheme is introduced in two stages. First of all, we explain how it prepares the vertices to be watermarked and embeds the secret data. Later, we will introduce how it extracts the secret data and recovers the original content.

The data embedding process consists of two basic steps: (i) Vertex preparation and (ii) Data embedding.

As we embed the secret data into the vertices one by one, correct data extraction may be impossible once the vertex traversing order has been changed. In order to resist feature rearrangement and vertex reversing attacks, we provide different vertex traversing orders for different types of features.

For obtaining the vertex order of polylines, the first vertex and the last vertex of each polyline are sorted. The vertex that has bigger coordinate value is called a start vertex, and the vertex that has smaller coordinate value is called an end vertex. Within each polyline, the vertices are traversed from the start vertex to the end vertex. For obtaining the polyline order, the start vertices of the polylines are sorted, and the polylines are scanned from the polyline that has the biggest start vertex to the polyline that has the smallest start vertex.

For polygons, the vertex traversing order is similar to that of polylines except that the start vertex and the end vertex of each polygon are obtained by sorting the second vertex and the penultimate vertex, and within each polygon, the vertices are traversed from the start vertex to the end vertex, to the start vertex.

As for points, the vertices are scanned according to the vertex order stored in the vector map file.

In our method, the start vertex and the end vertex of each polyline or polygon are used to indicate the vertex order of the polyline or the polygon. Since indicating the vertex order within a polyline or a polygon is very important for the scheme to resist feature rearrangement and vertex reversing attacks, the coordinates of the start vertices and the end vertices should not be used to embed secret bits. This means that for a vector map 
                              M
                           , the coordinates which can be used to embed watermarks should be searched from the eligible coordinates of 
                              
                                 
                                    V
                                 
                                 
                                    M
                                 
                              
                            except the coordinates of 
                              
                                 
                                    V
                                 
                                 
                                    M
                                 
                                 
                                    n
                                    e
                                 
                              
                           , where 
                              
                                 
                                    V
                                 
                                 
                                    M
                                 
                              
                            is the set of 
                              M
                           ’s vertices and 
                              
                                 
                                    V
                                 
                                 
                                    M
                                 
                                 
                                    n
                                    e
                                 
                              
                            is the set of the start vertices and the end vertices of 
                              M
                           .

Therefore, assuming 
                              
                                 
                                    M
                                 
                                 
                                    min
                                 
                                 
                                    x
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    max
                                 
                                 
                                    x
                                 
                              
                            are the minimum and maximum coordinates in the 
                              X
                           -axis, and 
                              
                                 
                                    M
                                 
                                 
                                    min
                                 
                                 
                                    y
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    max
                                 
                                 
                                    y
                                 
                              
                            are the minimum and maximum coordinates in the 
                              Y
                           -axis, if an eligible 
                           
                              x
                            coordinate 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            can be used to embed a watermark, it should meet the following condition,


                           
                              
                                 (23)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      min
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      max
                                                   
                                                   
                                                      x
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      x
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ∉
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                            If an eligible 
                           
                              y
                            coordinate 
                              
                                 
                                    y
                                 
                                 
                                    e
                                 
                              
                            can be used to carry a watermark, it should meet the following condition, 
                              
                                 (24)
                                 
                                    
                                       {
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      min
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ≠
                                                
                                                   
                                                      M
                                                   
                                                   
                                                      max
                                                   
                                                   
                                                      y
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      e
                                                   
                                                
                                                ∉
                                                
                                                   
                                                      
                                                         
                                                            V
                                                         
                                                         
                                                            M
                                                         
                                                      
                                                   
                                                   
                                                      n
                                                      e
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           
                        

In the following, we call an eligible 
                           
                              x
                            coordinate a watermark 
                           
                              x
                            coordinate if it satisfies the condition defined in Eq. (23), an eligible 
                           
                              y
                            coordinate a watermark 
                           
                              y
                            coordinate if it satisfies the condition defined in Eq. (24), a coordinate a watermark coordinate if it is a watermark 
                           
                              x
                            coordinate or a watermark 
                           
                              y
                            coordinate, and a vertex a watermark vertex if it contains a watermark coordinate. The watermark vertices will be used to carry the secret message in the data embedding stage.

Suppose a secret bit stream 
                              S
                              =
                              
                                 {
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                 
                                 |
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    1
                                    }
                                 
                                 ,
                                 
                                 j
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    L
                                    −
                                    1
                                    ]
                                 
                                 }
                              
                            of length 
                              L
                            is the secret data to be embedded into the vector map 
                              M
                           , and 
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                            is the number of 
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                           s watermark coordinates. To make sure that each watermark coordinate of 
                              M
                            carries a watermark, we assume that 
                              L
                              =
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              ×
                              c
                           .

We embed the secret data using the following five steps.


                           Step  1. Convert the secret bit stream 
                              S
                            into a secret data sequence 
                              W
                              =
                              
                                 {
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    
                                       
                                          2
                                       
                                       
                                          c
                                       
                                    
                                    −
                                    1
                                    }
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          w
                                       
                                    
                                    −
                                    1
                                    ]
                                 
                                 }
                              
                           , 
                              
                                 (25)
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          ×
                                          c
                                       
                                    
                                    ×
                                    
                                       
                                          2
                                       
                                       
                                          c
                                          −
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          s
                                       
                                       
                                          i
                                          ×
                                          c
                                          +
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          2
                                       
                                       
                                          c
                                          −
                                          2
                                       
                                    
                                    +
                                    ⋯
                                    +
                                    
                                       
                                          s
                                       
                                       
                                          
                                             (
                                             i
                                             +
                                             1
                                             )
                                          
                                          ×
                                          c
                                          −
                                          1
                                       
                                    
                                    ×
                                    
                                       
                                          2
                                       
                                       
                                          0
                                       
                                    
                                    .
                                 
                              
                           
                        


                           Step  2. Scramble the elements of 
                              W
                            under the control of a private key 
                              K
                           . Denote the scrambled data sequence as 
                              
                                 
                                    W
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 {
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 |
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                    
                                       s
                                    
                                 
                                 ∈
                                 
                                    {
                                    0
                                    ,
                                    
                                       
                                          2
                                       
                                       
                                          c
                                       
                                    
                                    −
                                    1
                                    }
                                 
                                 ,
                                 
                                 i
                                 ∈
                                 
                                    [
                                    0
                                    ,
                                    
                                       
                                          N
                                       
                                       
                                          w
                                       
                                    
                                    −
                                    1
                                    ]
                                 
                                 }
                              
                           . The scrambling algorithm is briefly described in the Appendix.


                           Step  3. Scan the vertices of the whole vector map 
                              M
                            to get the maximum 
                              x
                            coordinate 
                              
                                 
                                    M
                                 
                                 
                                    max
                                 
                                 
                                    x
                                 
                              
                           , the minimum 
                              x
                            coordinate 
                              
                                 
                                    M
                                 
                                 
                                    min
                                 
                                 
                                    x
                                 
                              
                           , the maximum 
                              y
                            coordinate 
                              
                                 
                                    M
                                 
                                 
                                    max
                                 
                                 
                                    y
                                 
                              
                            and the minimum 
                              y
                            coordinate 
                              
                                 
                                    M
                                 
                                 
                                    min
                                 
                                 
                                    y
                                 
                              
                           .


                           Step  4. According to the vertex traversing order, scan the vertices of 
                              M
                            and obtain the ordered watermark vertices using 
                              
                                 
                                    M
                                 
                                 
                                    max
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    min
                                 
                                 
                                    x
                                 
                              
                              ,
                              
                                 
                                    M
                                 
                                 
                                    max
                                 
                                 
                                    y
                                 
                              
                            and 
                              
                                 
                                    M
                                 
                                 
                                    min
                                 
                                 
                                    y
                                 
                              
                           .


                           Step  5. Embed 
                              
                                 
                                    W
                                 
                                 
                                    s
                                 
                              
                            into the watermark coordinates of the ordered watermark vertices by exploiting the method described in Section  2.2.1.

After data embedding, an embedded vector map 
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                            is derived.

The process of data extraction and data recovery goes as follows.


                        Step  1. Scan the vertices of the whole vector map 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         to get the maximum 
                           x
                         coordinate 
                           
                              
                                 M
                              
                              
                                 max
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        , the minimum 
                           x
                         coordinate 
                           
                              
                                 M
                              
                              
                                 min
                              
                              
                                 
                                    
                                       x
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        , the maximum 
                           y
                         coordinate 
                           
                              
                                 M
                              
                              
                                 max
                              
                              
                                 
                                    
                                       y
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                         and the minimum 
                           y
                         coordinate 
                           
                              
                                 M
                              
                              
                                 min
                              
                              
                                 
                                    
                                       y
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                        .


                        Step  2. Obtain the ordered embedded watermark vertices according to the vertex traversing order defined in Section  3.1.1. Suppose the number of embedded watermark coordinates of 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         is 
                           
                              
                                 N
                              
                              
                                 w
                              
                              
                                 ′
                              
                           
                        .


                        Step  3. Extract the secret sequence 
                           
                              
                                 W
                                 
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 ′
                              
                           
                           =
                           
                              {
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              |
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 −
                                 1
                                 }
                              
                              ,
                              
                              i
                              ∈
                              
                                 [
                                 0
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 −
                                 1
                                 ]
                              
                              }
                           
                         from the watermark coordinates of the ordered embedded watermark vertices and recover the original content of 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                         using the method described in Section  2.2.2.


                        Step  4. Descramble the elements of 
                           
                              
                                 W
                                 
                                    
                                    
                                       s
                                    
                                 
                              
                              
                                 ′
                              
                           
                         and obtain the embedded data sequence 
                           
                              
                                 W
                              
                              
                                 ′
                              
                           
                           =
                           
                              {
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              |
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 
                                    
                                       2
                                    
                                    
                                       c
                                    
                                 
                                 −
                                 1
                                 }
                              
                              ,
                              
                              i
                              ∈
                              
                                 [
                                 0
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 −
                                 1
                                 ]
                              
                              }
                           
                         with the private key 
                           K
                        . The descrambling process is presented in the Appendix.


                        Step  5. Convert the data sequence 
                           
                              
                                 W
                              
                              
                                 ′
                              
                           
                         into binary form 
                           
                              
                                 S
                              
                              
                                 ′
                              
                           
                           =
                           
                              {
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                                 
                                    ′
                                 
                              
                              |
                              
                                 
                                    s
                                 
                                 
                                    j
                                 
                                 
                                    ′
                                 
                              
                              ∈
                              
                                 {
                                 0
                                 ,
                                 1
                                 }
                              
                              ,
                              j
                              ∈
                              
                                 [
                                 0
                                 ,
                                 
                                    
                                       N
                                    
                                    
                                       w
                                    
                                    
                                       ′
                                    
                                 
                                 ×
                                 c
                                 −
                                 1
                                 ]
                              
                              }
                           
                        , 
                           
                              (26)
                              
                                 
                                    
                                       s
                                    
                                    
                                       j
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    ⌊
                                    
                                       
                                          
                                             
                                                w
                                             
                                             
                                                
                                                   ⌊
                                                   j
                                                   /
                                                   c
                                                   ⌋
                                                
                                             
                                             
                                                ′
                                             
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                m
                                                =
                                                
                                                   ⌊
                                                   j
                                                   /
                                                   c
                                                   ⌋
                                                
                                                ×
                                                c
                                             
                                             
                                                j
                                                −
                                                1
                                             
                                          
                                          
                                             
                                                s
                                             
                                             
                                                m
                                             
                                             
                                                ′
                                             
                                          
                                          ×
                                          
                                             
                                                2
                                             
                                             
                                                c
                                                −
                                                
                                                   (
                                                   m
                                                   mod
                                                   c
                                                   )
                                                
                                                −
                                                1
                                             
                                          
                                       
                                       
                                          
                                             
                                                2
                                             
                                             
                                                c
                                                −
                                                
                                                   (
                                                   j
                                                   mod
                                                   c
                                                   )
                                                
                                                −
                                                1
                                             
                                          
                                       
                                    
                                    ⌋
                                 
                                 .
                              
                           
                        
                     

The above is our reversible data hiding scheme for 2D vector maps.

@&#RESULTS AND ANALYSIS@&#

We proposed a novel reversible data hiding approach in the preceding section. Now, we will demonstrate the effectiveness of our method with experimental results and discuss the performance of the algorithm.

@&#EXPERIMENTAL RESULTS@&#

We ran experiments on a PC with CPU 2.0 GHz, RAM 2G, WinXP Professional, ArcMap Version 9.2, Map Objects 2.4 and Visual C++ 6.0. In the experiment, 50 different 2D vector maps in the shapefile format of Environmental Systems Research Institute, Inc. (ESRI)  [41] were used as the covers. As shown in Fig. 2
                        , four of them are a spot height map of Taylor Rookery  [42], a coastline map of Taylor Rookery  [42], a road map  [43] and a Windmill Islands map  [44]. Table 1
                         lists some basic properties of the four vector maps, including the feature type, the number of vertices/features, the scale, the precision tolerance 
                           τ
                         and the density. The term “density” is the average number of vertices within a map patch with the unit area 
                           
                              
                                 
                                    m
                                 
                              
                              
                                 2
                              
                           
                        . It measures the density of map vertices. Higher density means that the vertices of a map are located closer to each other and their coordinates may have a higher correlation. During data hiding, the number of secret bits each watermark coordinate carried 
                           c
                         was 8.

In the first test case, we demonstrated the invisibility of our scheme. The vector maps in Fig. 2 were watermarked by the technique proposed in Section  3.1 yielding the watermarked versions seen in Fig. 3
                        . It can be seen from Fig. 3 that the perceived quality is acceptable. For evaluating the quality of the embedded vector maps, the average distortion 
                           d
                           
                              (
                              M
                              ,
                              
                                 
                                    M
                                 
                                 
                                    ′
                                 
                              
                              )
                           
                         and the maximum distortion Maxd(
                           M
                        , 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                        ) were calculated, 
                           
                              (27)
                              
                                 
                                    
                                       
                                          d
                                          
                                             (
                                             M
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                
                                                   
                                                      V
                                                   
                                                   
                                                      M
                                                   
                                                
                                             
                                          
                                          
                                             ‖
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                             
                                             −
                                             
                                                
                                                   v
                                                
                                                
                                                   i
                                                
                                                
                                                   ′
                                                
                                             
                                             ‖
                                          
                                       
                                    
                                    
                                       
                                          M
                                          a
                                          x
                                          d
                                          
                                             (
                                             M
                                             ,
                                             
                                                
                                                   M
                                                
                                                
                                                   ′
                                                
                                             
                                             )
                                          
                                          =
                                          max
                                          
                                             (
                                             
                                                ‖
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                
                                                −
                                                
                                                   
                                                      v
                                                   
                                                   
                                                      i
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                ‖
                                             
                                             )
                                          
                                          ,
                                          
                                          
                                             (
                                             i
                                             =
                                             1
                                             ,
                                             2
                                             ,
                                             …
                                             ,
                                             
                                                
                                                   V
                                                
                                                
                                                   M
                                                
                                             
                                             )
                                          
                                          ,
                                       
                                    
                                 
                              
                           
                         where 
                           
                              
                                 v
                              
                              
                                 i
                              
                           
                         the and 
                           
                              
                                 v
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                         are the corresponding vertices in the original vector map 
                           
                              (
                              M
                              )
                           
                         and the watermarked vector map (
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                        ) and 
                           
                              
                                 V
                              
                              
                                 M
                              
                           
                         denotes the total number of vertices in the vector map 
                           M
                        . The experimental results are listed in Table 2
                        . From this table, we know that due to the configuration of the number of the segments each axis divided (Eq. (17)), the Maxd and 
                           d
                         value of each vector map do not exceed the precision tolerance 
                           τ
                        . The data of the embedded vector map are valid.

The reversibility of the proposed algorithm has been demonstrated in the second test case. The hidden data were extracted from the embedded vector maps in Fig. 3 using the proposed method. The recovered vector maps shown in Fig. 4
                         indicate that the perceived quality of the recovered vector maps is acceptable. Besides, for evaluating the objective quality of the recovered vector maps, the Maxd and 
                           d
                         values between the original vector maps and the recovered ones were computed. Table 3
                         shows that the Maxd values of the four vector maps are all less than 
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 6
                              
                           
                           
                           
                              m
                           
                         and the 
                           d
                         values are all less than 
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 6
                              
                           
                           
                           
                              m
                           
                         as well. Generally, the storage precision for the coordinates of a 2D vector map is about 0.1 mm. In other words, as long as the differences between the original coordinates and the recovered ones are less than 
                           1
                           
                              
                                 0
                              
                              
                                 −
                                 4
                              
                           
                           
                           
                              m
                           
                        , the data hiding scheme can be seen as reversible. Therefore, the precision requirements of most situations can be met.

According to the data hiding procedure, the invisibility of our proposed scheme described in Section  2.2 is closely related to the number of secret bits each watermark coordinate carries 
                           c
                        . In this section, we will discuss how 
                           c
                         affects the embedded vector maps quality.

During data hiding, the secret data are embedded into each watermark coordinate one by one. We can evaluate the relationship between embedding distortion and 
                              c
                            by calculating the distortion introduced into a watermark coordinate with different 
                              c
                            values.

According to the data hiding method presented in Section  2.2, for a watermark 
                           
                              x
                            coordinate 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                           , its two corresponding virtual coordinates (
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                                 
                                    r
                                 
                              
                           ) calculated by Eq. (11) will be the same with different 
                              c
                            values. Let 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                           
                           
                              =
                              −
                              63.9032920954004
                            be the watermark coordinate to be embedded, its two corresponding virtual coordinates are 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                                 
                                    l
                                 
                              
                              =
                              −
                              63.9032921434334
                            and 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                                 
                                    r
                                 
                              
                              =
                              −
                              63.903279670857
                           , and a list of 
                              c
                            values is 
                              
                                 
                                    C
                                 
                                 
                                    l
                                 
                              
                              =
                              
                                 {
                                 1
                                 ,
                                 4
                                 ,
                                 6
                                 ,
                                 7
                                 ,
                                 8
                                 }
                              
                           . Let us assume the watermark generated for 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            with 
                              c
                              =
                              1
                            is 1, the watermark generated for 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            with 
                              c
                              =
                              4
                            is 14, the watermark generated for 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            with 
                              c
                              =
                              6
                            is 56, the watermark generated for 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            with 
                              c
                              =
                              7
                            is 98 and the watermark generated for 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            with 
                              c
                              =
                              8
                            is 120. We can calculate the distortion introduced into 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            by the following equation: 
                              
                                 (28)
                                 
                                    D
                                    i
                                    s
                                    t
                                    a
                                    n
                                    c
                                    e
                                    
                                       (
                                       
                                          
                                             x
                                          
                                          
                                             e
                                          
                                       
                                       ,
                                       
                                          
                                             x
                                          
                                          
                                             e
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         e
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         x
                                                      
                                                      
                                                         e
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                2
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                            where 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                                 
                                    ′
                                 
                              
                            represents the embedded 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                           . Table 4
                            lists the calculated Distance values between 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                              
                            and 
                              
                                 
                                    x
                                 
                                 
                                    e
                                 
                                 
                                    ′
                                 
                              
                            with different 
                              c
                            values. From Table 4, we know that the distortion introduced into a watermark coordinate is neither monotonically decreasing nor monotonically increasing with 
                              c
                           . Thus, the embedding distortion may be neither monotonically decreasing nor monotonically increasing with 
                              c
                           .

Experiments have been conducted on the spot height map of Taylor Rookery in Fig. 2(a) to demonstrate the relationship between average embedding distortion and 
                              c
                           . Based on the experimental results illustrated in Fig. 5
                           , we can see that the average embedding distortion is neither monotonically decreasing nor monotonically increasing with 
                              c
                           . This verifies our analysis above.


                           Table 5
                            presents the invisibility comparisons among the proposed method and some former approaches  [18,39,40]. The average distortions between the original vector maps and the watermarked ones of these methods were calculated. During data hiding, Wang et al.’s scheme  [18] was performed by taking 
                              p
                              =
                              4
                           , Peng et al.’s method  [40] was carried out by taking 
                              p
                              =
                              −
                              4
                            and 
                              S
                              =
                              1
                           , Wang and Wang’s algorithm  [39] was performed by taking 
                              c
                              =
                              1
                           , and our proposed approach was carried out by taking 
                              c
                              =
                              1
                           .

From this table, we can see that the invisibility of the proposed method is superior to that of Wang et al.’s approach  [18]. That is because Wang et al.’s method  [18] embeds the secret data by modifying the difference of two neighboring coordinates, and some higher digits may be modified to accommodate the secret data.

The invisibility of Peng et al.’s algorithm  [40] outperforms that of the proposed approach. However, due to the configuration of the segments each axis divided (Eq. (17)) in the proposed method, the 
                              d
                            value of each vector map does not exceed the precision tolerance 
                              τ
                           . Our proposed algorithm can always guarantee the validity of the vector map data.

Wang and Wang’s approach  [39] provides better embedded vector map quality for the vector maps with dense vertices, e.g., the coastline map of Taylor Rookery, than the proposed method. However, for the vector maps whose coordinates exhibit low correlation, e.g., the spot height map of Taylor Rookery, the invisibility of the proposed scheme is superior to that of Wang and Wang’s algorithm  [39].


                        Table 6
                         presents the capacity comparisons among the proposed method and the approaches reported in  [18,39,40]. During data hiding, the parameters of the four schemes were set the same as that used in the experiments in Section  4.2.2.

From this table, we can know that for Wang et al.’s algorithm  [18], the average data capacity of 50 different vector maps is less than 1 bit/vertex. Since each watermark coordinate can carry 
                           c
                         secret bits in our proposed method, resulting in nearly 
                           2
                           c
                         bits/vertex, the data capacity of our proposed approach outperforms that of Wang et al.’s scheme  [18].

In Peng et al.’s scheme  [40], each vertex except the two reference vertices can carry 
                           S
                           
                           
                              (
                              S
                              ≥
                              1
                              )
                           
                         bits, nearly resulting in 
                           S
                         bits/vertex. Hence, the proposed method is about twice the data capacity of Peng et al.’s approach   [40].

While applying Wang and Wang’s scheme  [39] to a 2D vector map, the data capacity is about 
                           c
                         bits/vertex, which is half of the data capacity of our proposed algorithm. Thus, the proposed method provides higher data capacity.


                        Table 7
                         presents the data embedding and data extraction execution time comparisons among the proposed method and the approaches reported in  [18,39,40]. During data hiding and extraction, the parameters of the four schemes were set the same as used in the experiments in Section  4.2.2.

Let us assume 
                           
                              
                                 N
                              
                              
                                 v
                              
                           
                         is the number of vertices of the vector map 
                           M
                         and 
                           
                              
                                 N
                              
                              
                                 F
                              
                           
                         is the total number of 
                           
                              
                                 M
                              
                              
                                 ′
                              
                           
                        s polylines and polygons. For Wang et al.’s algorithm  [18], the computational complexity is 
                           O
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              )
                           
                        . Because the computational complexity of our proposed approach is 
                           O
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              )
                           
                           +
                           O
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    F
                                 
                              
                              log
                              
                                 
                                    N
                                 
                                 
                                    F
                                 
                              
                              )
                           
                        , the execution time of Wang et al.’s method  [18] outperforms that of the proposed algorithm, which can be seen from Table 7.

For Peng et al.’s scheme  [40], the main cost of data hiding derives from calculating the distance of every two vertex pair in order to obtain the reference vertices. Because the computational complexity of this step is 
                           O
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        , the proposed method is superior to Peng et al.’s approach  [40] in terms of data embedding execution time. The reference vertices do not need to be calculated during data extraction. However, since extracting a watermark from a vertex with this method requires more time than extracting watermarks from a watermark vertex using the proposed algorithm, the data extraction time of this algorithm is longer than that of the proposed approach.

In Wang and Wang’s method  [39], the main cost which derives mainly from sorting the coordinates during data hiding is 
                           O
                           
                              (
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              log
                              
                                 
                                    N
                                 
                                 
                                    v
                                 
                              
                              )
                           
                        . As the value of 
                           
                              
                                 N
                              
                              
                                 F
                              
                           
                         is much smaller than that of 
                           
                              
                                 N
                              
                              
                                 v
                              
                           
                         for most vector maps, the data hiding execution time of the proposed approach is superior to that of Wang and Wang’s algorithm  [39] in general. Because the coordinates do not need to be sorted during data extraction and this scheme performs fewer data extraction operations than the proposed method, the data extraction time of this approach is shorter than that of the proposed algorithm.


                        Table 8
                         presents the robustness comparisons among the proposed method and the approaches reported in  [18,39,40]. The coastline map of Taylor Rookery shown in Fig. 2(b) was used as the cover. The BER (bit error rate) of the extracted hidden data was exploited as the evaluation measure. During data hiding and extraction, the parameters of the four schemes were set the same as that used in the experiments in Section  4.2.2. In the experiment, eight different attacks, including low-amplitude additive noise, vertex addition, vertex deletion, rotation, scaling, translation, vertex reversing and feature rearrangement, were involved.

From this table, we can know that our proposed method is fragile to low-amplitude additive noise, vertex addition, vertex deletion, rotation and scaling attacks. Because of the vertex traversing order defined in Section  3.1.1, our algorithm is superior to Wang et al.’s algorithm  [18] and Peng et al.’s scheme  [40] in terms of resistance against vertex reversing and feature rearrangement attacks. Peng et al. hide secret bits in the scale factor of the relative coordinates in  [40]. Thus, the tolerance to RST (rotation, scaling and translation) transformations of Peng et al.’s approach  [40] outperforms that of the proposed method. Since Wang and Wang construct PCA (principal component analysis)-coordinate systems in  [39], this algorithm also provides good robustness against RST transformations. Besides, as the data extraction procedure of Wang and Wang’s approach  [39] has no relationship with the scanning order of the watermarked coordinates, the hidden data can be correctly extracted after vertex reversing and feature rearrangement attacks. Therefore, like our proposed algorithm, Wang and Wang’s method  [39] is tolerant to vertex reversing and feature rearrangement attacks as well. From the above discussion, we can observe that the proposed method provides higher capacity than Wang and Wang’s scheme  [39] at the cost of the resistance against translation and scaling attacks.

Furthermore, we need to point out that the proposed scheme is fragile to feature rearrangement operation when it is applied to a 2D vector map composed of points, because the vertices of points are scanned according to the vertex order stored in the vector map file.

Overall, the robustness of the proposed algorithm is still very weak. This may limit its applicability. As a result, the robustness of the proposed scheme needs to be further enhanced to support some applications where higher robustness is required.

@&#CONCLUSIONS@&#

In this paper, we present a high capacity reversible data hiding method based on virtual coordinates. The basic concept of the proposed algorithm is Wang and Wang’s reversible data hiding scheme  [39]. To embed large amounts of data with insignificant visual distortion of the original vector map, and simultaneously decreasing the computational complexity, the method based on virtual coordinates is presented. In addition, for tolerating content preserving operations, the vertex traversing order is defined. The data capacity achieves nearly 
                        2
                        c
                      bits/vertex. The experimental results and analysis indicate that the proposed approach has good performances in reversibility, invisibility, data capacity and computational complexity and is robust against feature rearrangement and vertex reversing operations for polylines and polygons.

Meanwhile, the proposed scheme offers a significant advantage over other reversible data hiding methods in that no embedded coordinate exceeds the original coordinate range, i.e., it can be integrated with block-based fragile watermarks for authentication.

In this paper, the improved reversible data hiding method was described as applied to 2D vector maps in shapefile format. This method can also be applied to other kinds of 2D vector graphics (e.g., 2D vector map in MapInfo TAB format and CAD drawings in DXF format) and 3D vector graphics (e.g., point-sampled geometry) which have similar data structures as 2D vector maps for achieving high capacity and low distortion.

There are two main drawbacks in our scheme. First, the robustness of this algorithm is still very weak. Second, the topological relations between features are not considered during data hiding. Our future research will focus on enhancing the robustness of the scheme to support some other applications where higher robustness is required, and increasing the convenience of keeping the topological relations between features.

Here, we describe the scrambling process used in Section  3.1.2 and its corresponding descrambling process exploited in Section  3.2.

In Section  3.1.2, the secret data sequence 
                        W
                        =
                        
                           {
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           |
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ∈
                           
                              {
                              0
                              ,
                              
                                 
                                    2
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              }
                           
                           ,
                           
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                      is scrambled under the control of the private key 
                        K
                      by the following four steps.


                     Step  1. Generate an integer sequence 
                        P
                        =
                        
                           {
                           
                              
                                 p
                              
                              
                                 i
                              
                           
                           |
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                     ,


                     
                        
                           (29)
                           
                              
                                 
                                    p
                                 
                                 
                                    i
                                 
                              
                              =
                              i
                              .
                           
                        
                     
                  


                     Step  2. Generate a random sequence 
                        R
                        =
                        
                           {
                           
                              
                                 r
                              
                              
                                 i
                              
                           
                           |
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                      under the control of the private key 
                        K
                     .


                     Step  3. Shuffle the elements of 
                        P
                      by swapping 
                        
                           
                              p
                           
                           
                              j
                           
                        
                        
                        
                           (
                           j
                           ∈
                           
                              [
                              1
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              −
                              1
                              ]
                           
                           )
                        
                      and 
                        
                           
                              p
                           
                           
                              
                                 
                                    r
                                 
                                 
                                    j
                                 
                              
                              mod
                              
                                 (
                                 j
                                 +
                                 1
                                 )
                              
                           
                        
                     . Denote the shuffled 
                        P
                      as 
                        
                           
                              P
                           
                           
                              ′
                           
                        
                        =
                        
                           {
                           
                              
                                 p
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           |
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                     .


                     Step  4. According to 
                        
                           
                              P
                           
                           
                              ′
                           
                        
                     , adjust the order of 
                        W
                     ’s elements and obtain the scrambled sequence 
                        
                           
                              W
                           
                           
                              s
                           
                        
                        =
                        
                           {
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 s
                              
                           
                           |
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 s
                              
                           
                           ∈
                           
                              {
                              0
                              ,
                              
                                 
                                    2
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              }
                           
                           ,
                           
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                      by 
                        
                           (30)
                           
                              
                                 
                                    
                                       
                                          w
                                       
                                       
                                          i
                                       
                                    
                                 
                                 
                                    s
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    p
                                    i
                                 
                                 
                                    ′
                                 
                              
                              .
                           
                        
                     
                  

In Section  3.2, we can descramble the extracted secret sequence 
                        
                           
                              W
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    ′
                                 
                              
                           
                        
                        =
                        
                           {
                           
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           |
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 
                                    
                                       s
                                    
                                    
                                       ′
                                    
                                 
                              
                           
                           ∈
                           
                              {
                              0
                              ,
                              
                                 
                                    2
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              }
                           
                           ,
                           
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                                 
                                    ′
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                      with the private key 
                        K
                      by the following:


                     Step  1. According to the private key 
                        K
                      and the number of 
                        
                           
                              W
                              
                                 
                                 
                                    s
                                 
                              
                           
                           
                              ′
                           
                        
                     ’s elements 
                        
                           
                              N
                           
                           
                              w
                           
                           
                              ′
                           
                        
                     , get the shuffled random integer sequence 
                        
                           
                              P
                           
                           
                              ″
                           
                        
                        =
                        
                           {
                           
                              
                                 p
                              
                              
                                 i
                              
                              
                                 ″
                              
                           
                           |
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                                 
                                    ′
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                      using Steps  1–3 described in the scrambling process.


                     Step  2. According to 
                        
                           
                              P
                           
                           
                              ″
                           
                        
                     , adjust the order of 
                        
                           
                              W
                           
                           
                              
                                 
                                    s
                                 
                                 
                                    ′
                                 
                              
                           
                        
                     ’s elements and obtain the descrambled sequence 
                        
                           
                              W
                           
                           
                              ′
                           
                        
                        =
                        
                           {
                           
                              
                                 w
                              
                              
                                 i
                              
                              
                                 ′
                              
                           
                           |
                           
                              
                                 w
                              
                              
                                 i
                              
                           
                           ∈
                           
                              {
                              0
                              ,
                              
                                 
                                    2
                                 
                                 
                                    c
                                 
                              
                              −
                              1
                              }
                           
                           ,
                           
                           i
                           ∈
                           
                              [
                              0
                              ,
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                                 
                                    ′
                                 
                              
                              −
                              1
                              ]
                           
                           }
                        
                      by the following equation 
                        
                           (31)
                           
                              
                                 
                                    w
                                 
                                 
                                    
                                       
                                          p
                                          i
                                       
                                       
                                          ″
                                       
                                    
                                 
                                 
                                    ′
                                 
                              
                              =
                              
                                 
                                    w
                                 
                                 
                                    i
                                 
                                 
                                    
                                       
                                          s
                                       
                                       
                                          ′
                                       
                                    
                                 
                              
                              .
                           
                        
                     
                  

The above is the scrambling algorithm we used in the data embedding and extraction processes.

@&#REFERENCES@&#

