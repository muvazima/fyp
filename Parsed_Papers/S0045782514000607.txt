@&#MAIN-TITLE@&#A displacement-based finite element formulation for incompressible and nearly-incompressible cardiac mechanics

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A finite element displacement formulation stemming from the Perturbed Lagrangian.


                        
                        
                           
                           The efficiency is enhanced with a Shamanskii–Newton–Raphson scheme.


                        
                        
                           
                           Comparison with Perturbed Lagrangian, Lagrange Multiplier and penalty methods.


                        
                        
                           
                           Presence of locking in the penalty method, for whole-cycle cardiac mechanics.


                        
                        
                           
                           The presented form combines good convergence behavior with a simplified structure.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Cardiac mechanics

Solid mechanics

Incompressibility

Near incompressibility

Perturbed Lagrangian

Finite element method

@&#ABSTRACT@&#


               
               
                  The Lagrange Multiplier (LM) and penalty methods are commonly used to enforce incompressibility and compressibility in models of cardiac mechanics. In this paper we show how both formulations may be equivalently thought of as a weakly penalized system derived from the statically condensed Perturbed Lagrangian formulation, which may be directly discretized maintaining the simplicity of penalty formulations with the convergence characteristics of LM techniques. A modified Shamanskii–Newton–Raphson scheme is introduced to enhance the nonlinear convergence of the weakly penalized system and, exploiting its equivalence, modifications are developed for the penalty form. Focusing on accuracy, we proceed to study the convergence behavior of these approaches using different interpolation schemes for both a simple test problem and more complex models of cardiac mechanics. Our results illustrate the well-known influence of locking phenomena on the penalty approach (particularly for lower order schemes) and its effect on accuracy for whole-cycle mechanics. Additionally, we verify that direct discretization of the weakly penalized form produces similar convergence behavior to mixed formulations while avoiding the use of an additional variable. Combining a simple structure which allows the solution of computationally challenging problems with good convergence characteristics, the weakly penalized form provides an accurate and efficient alternative to incompressibility and compressibility in cardiac mechanics.
               
            

@&#INTRODUCTION@&#

The human heart is a remarkably complex organ, translating cellular ATP consumption into the systemic blood flow [1]. Over the last four decades, computational modeling of cardiac mechanics has evolved, incorporating biophysically-based hyperelastic strain energy laws [2–5], anisotropic tissue structure [6–8], patient-specific geometries [9] and cellular activation [10] to effectively simulate the myocardial behavior assuming basic Newtonian physics [11]. Based on tunable parameters [12,13], cardiac models provide a framework for studying and assessing heart function, offering spatiotemporally varying metrics– such as strain, stress, work and power– which are otherwise inaccessible clinically [14,15].

While cardiac modeling is capable of providing quantitative data of clinical relevance, a number of modeling questions remain actively pursued in the community. An issue commonly discussed in cardiac mechanics is the choice of modeling myocardial tissue as an incompressible [16,3,17,4,18,19,5,20,21] or nearly incompressible [14,22–24] material. While this choice is inherently based on tissue behavior which must be determined experimentally, both models continue to be used either to model incompressible/nearly incompressible behavior or, in some cases, for numerical convenience.

A range of relevant numerical schemes have been applied in heart models, one of the most popular being the penalty method [25,14,22,15,23]. An advantage of this approach is its simplified form, requiring only the solution of the tissue displacement. However, when applied in the finite element method (FEM) framework, displacement-based formulations near the incompressible limit exhibit locking leading to sub-optimal convergence rates and poor numerical approximations in classic elastic models [26–30]. Critically, the penalty method lacks monotonic convergence to the incompressible solution as the bulk modulus is increased, making it challenging to employ as an approximate model to an incompressible cardiac material model.

The development of numerical strategies circumventing these issues has been a field of significant research effort in the solid mechanics community. Among others, the B-Bar method introduced by Hughes [31] and its generalization to finite strains [32,33], the reduced or selective integration technique [34,30,35], the augmented Lagrangian method [36,37], have been successfully employed to enforce incompressibility while tackling the numerical difficulties and locking phenomena associated with the penalty formulation. An alternative approach used extensively in solid mechanics, also known to alleviate locking, is the class of multi-field variational principles, which gained popularity with the pioneering work of Herrmann on isotropic linear elasticity [38]. Herrmann’s principle was also extended to orthotropic materials by Taylor [39] and Key [40], to nonlinear formulations [41,42] and elasto-plastic applications [43].

The most common of these mixed formulations is the Lagrange Multiplier (LM) method, a two-field variational approach which has been used widely to enforce incompressibility of the myocardium by introducing a variable to respresent the hydrostatic pressure [16,17,4,19,44]. While the LM method is known to improve numerical convergence [45,46,29,47] and avoid locking phenomena, the use of an additional variable results in increased computational cost and enhanced complexity in the linear algebra involved, due to the indefinite nature of the resulting stiffness matrix [26,45].

The Perturbed Lagrangian (PL) formulation was introduced to address this issue, by augmenting the energy functional of the LM approach with a penalty/compressibility term [48–50]. The PL is a two-field variational approach suitable for the solution of nearly incompressible problems, where pressure and displacement are treated as independent variables. Sussman and Bathe introduced a generalized form of the PL approach, the 
                        
                           u
                           /
                           p
                        
                      formulation, which has been used extensively in the computational mechanics literature [51,52,48] and has also been applied in the myocardium [44]. Similarly, the well established three-field Hu-Washizu formulation by Simo et al. [33] extends the PL formulation by introducing pressure and dilatation as independent variables [37,46,51,53]. This approach has also been employed in cardiac mechanics [24] (though this procedure comes with the cost of computing an additional variable). The use of a separate interpolation for the independent variables, allows efficient and accurate approximations, alleviating the numerical difficulties associated with both the penalty and LM methods. The efficiency of these methods was also enhanced with the use of discontinuous interpolation for the pressure and dilatation fields (static condensation) [50,47,33,46] allowing the estimation of these fields on element level and leading to a generalized displacement-only formulation. Further, Bercovier [50] proved that, for Herrmann’s principle, the PL (and its statically condensed equivalent) converges monotonically to the incompressible problem as the bulk modulus is increased. Nevertheless, as suggested by Sussman and Bathe [47], static condensation may exhibit convergence difficulties during the Newton–Raphson procedure.

In this paper, we consider the statically condensed Perturbed Lagrangian formulation of Bercovier [50] and others [48,49], which may be conveniently thought of as a weakly penalized form with an optional choice of projection operator. In this generalized form, with an appropriate choice of the projection operator, we may choose to strengthen or weaken the constraint resulting in the PL, LM or penalty formulations. Using this generalization, we derive an estimate detailing the error convergence of these methods (in a linear setting) and introduce modifications to a Newton-Raphson scheme [54,55] to significantly improve nonlinear convergence properties for standard and weakly penalized formulations (particularly for high bulk modulus). The scheme is further augmented to take advantage of a Shamanskii-type Newton scheme [54,55] boosting computational performance by enabling re-use of the Jacobian matrix (and its inverses or preconditioners) estimated at previous time/loading steps. As this re-use is particularly sensitive to stiffness, we modify the scheme to effectively maintain nonlinear convergence behavior. Further, we examine the direct numerical discretization of the weakly penalized form which may be made efficient through the use of discontinuous projection operators. The weakly penalized form is then compared with the mixed variational formulations (LM, PL), as well as the penalty method, showing that the modified form maintains the convergence characteristics of the mixed variational forms and avoids locking behaviors observed in the penalty method. This comparison is performed on a model left ventricle, which to the best of our knowledge is the first application of this combination of the PL method and static condensation in cardiac mechanics. Further we verify the result proven for linear problems in [50], showing that the error between the weakly penalized formulation and the incompressible solution indeed decreases with a rate inversely proportional to the bulk modulus. As a result, the formulation enables modeling of the myocardium as nearly incompressible or incompressible (with an error proportional to 
                        
                           1
                           /
                           k
                        
                     , with k being the bulk modulus).

Below we expand on this approach to illustrate the general minimization problem (Section 2.1) and show how both penalty and LM formulations may be thought of equivalently as weakly penalized constraints in the continuous setting (Section 2.1.1). The basis for locking is then reviewed in Section 2.2, motivating the introduction of the weakly penalized approach. The different convergence behavior of the various schemes is also illustrated through their error estimates at the solution of a linear incompressible problem (Section 2.4). We then introduce modifications to the mechanical system to improve the nonlinear convergence behavior of the weakly penalized scheme for high values of the bulk modulus (Section 2.5.3). Moreover, we modify the SNR scheme for the weakly penalized and penalty formulations to enable better computational efficiency (Section 2.5.4). The numerical convergence of these different methods is then compared, showing optimal convergence and locking phenomena in the various schemes [27,56] for a two-dimensional problem and a cardiac model (Section 3). Finally, the LM, penalty and weakly penalized formulations are compared in terms of accuracy and convergence for whole-cycle cardiac mechanics. Our results suggest that the weakly penalized form provides an accurate and computationally efficient alternative to the LM, PL and penalty methods and can be applied successfully in the numerical implementation of incompressible and nearly incompressible cardiac models (Section 4).

@&#METHODS@&#

In this section we show how LM and Penalty formulations can be viewed uniformly through a weakly penalized form (PL) (Section 2.1). Subsequently, we introduce the discretized forms, illustrating the deviation of the two schemes and resulting locking phenomena (Section 2.2). These motivate the use of an alternative discretization strategy, leading to a displacement-only formulation. The solution to this system is then demonstrated and optimized to accommodate the numerical stiffening due to the weakly penalized terms.

Problems of static (or quasi-static) solid mechanics involve finding the deformation, 
                           
                              u
                           
                        , of a body defined over a domain 
                           
                              Ω
                           
                         as shown in Fig. 1
                        . Here, the body is under the action of a body force, 
                           
                              f
                              :
                              Ω
                              →
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                              ,
                              d
                              ⩾
                              1
                           
                        , and some boundary traction 
                           
                              t
                              :
                              
                                 
                                    Γ
                                 
                                 
                                    N
                                 
                              
                              →
                              
                                 
                                    R
                                 
                                 
                                    d
                                 
                              
                           
                        .

The solution 
                           
                              u
                           
                         is a function commonly sought in an appropriate function space 
                           
                              X
                           
                         (usually 
                           
                              X
                              ⊂
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                              (
                              Ω
                              )
                           
                         or a space smooth enough to ensure existence and uniqueness of the solution of the minimization problem [61,48]), subject to the Dirichlet boundary condition 
                           
                              
                                 
                                    u
                                 
                                 
                                    
                                       
                                          |
                                       
                                       
                                          
                                             
                                                Γ
                                             
                                             
                                                D
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              g
                           
                        , i.e.
                        
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       D
                                    
                                 
                                 =
                                 {
                                 v
                                 ∈
                                 X
                                 |
                                 
                                    
                                       v
                                    
                                    
                                       
                                          
                                             |
                                          
                                          
                                             
                                                
                                                   Γ
                                                
                                                
                                                   D
                                                
                                             
                                          
                                       
                                    
                                 
                                 =
                                 g
                                 }
                                 .
                              
                           
                        The displacement of the body may be obtained by the principle of virtual work, equivalent to the principle of stationary potential energy [45]. Following the principle of stationary potential energy we seek to find a minimizer of the total potential energy functional, 
                           
                              Π
                              :
                              
                                 
                                    X
                                 
                                 
                                    D
                                 
                              
                              →
                              R
                           
                        , describing the total potential energy of the body under consideration (see Fig. 1). Assuming that the traction and body forces are not functions of the displacement 
                           
                              u
                           
                        , then under static equilibrium, the total potential energy for a hyperelastic body may be expressed as a sum of the internal and external potential energy as,
                           
                              (1)
                              
                                 Π
                                 (
                                 v
                                 )
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       int
                                    
                                 
                                 (
                                 v
                                 )
                                 +
                                 
                                    
                                       Π
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 v
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (2)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       int
                                    
                                 
                                 (
                                 v
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 Ψ
                                 (
                                 v
                                 )
                                 dV
                                 ,
                                 
                                 
                                    
                                       Π
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 v
                                 )
                                 =
                                 -
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 f
                                 ·
                                 v
                                 dV
                                 -
                                 
                                    ∫
                                    
                                       ∂
                                       Ω
                                    
                                 
                                 t
                                 ·
                                 v
                                 dA
                                 ,
                              
                           
                        where 
                           
                              Ψ
                              :
                              X
                              →
                              
                                 
                                    R
                                 
                                 
                                    +
                                 
                              
                           
                         represents the strain energy function [45]. According to the principle of stationary potential energy, the body will deform in a way that minimizes its total potential energy 
                           
                              Π
                           
                        . This problem can be expressed as,
                           
                              (3)
                              
                                 Π
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       inf
                                    
                                    
                                       v
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             D
                                          
                                       
                                    
                                 
                                 Π
                                 (
                                 v
                                 )
                                 .
                              
                           
                        In the case of incompressibility, the deformation is required to preserve the determinant of the deformation gradient 
                           
                              
                                 
                                    F
                                 
                                 
                                    v
                                 
                              
                           
                        ,
                           
                              
                                 
                                    
                                       J
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 1
                                 =
                                 0
                                 ,
                                 
                                 
                                    
                                       J
                                    
                                    
                                       v
                                    
                                 
                                 =
                                 |
                                 
                                    
                                       F
                                    
                                    
                                       v
                                    
                                 
                                 |
                                 =
                                 |
                                 ∇
                                 v
                                 +
                                 I
                                 |
                                 .
                              
                           
                        In this case, the solution is found [29], which satisfies,
                           
                              (4)
                              
                                 Π
                                 (
                                 u
                                 )
                                 =
                                 
                                    
                                       inf
                                    
                                    
                                       v
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             J
                                          
                                       
                                    
                                 
                                 Π
                                 (
                                 v
                                 )
                                 ,
                              
                           
                        
                        
                           
                              (5)
                              
                                 
                                    
                                       X
                                    
                                    
                                       J
                                    
                                 
                                 =
                                 {
                                 v
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       D
                                    
                                 
                                 |
                                 
                                    
                                       J
                                    
                                    
                                       v
                                    
                                 
                                 -
                                 1
                                 =
                                 0
                                 ,
                                 a
                                 .
                                 e
                                 .
                                 
                                 on
                                 
                                 Ω
                                 }
                                 .
                              
                           
                        We note that as it is not, in general, straightforward to construct the space 
                           
                              
                                 
                                    X
                                 
                                 
                                    J
                                 
                              
                           
                         it is often preferable to seek the solution in the entire 
                           
                              
                                 
                                    X
                                 
                                 
                                    D
                                 
                              
                           
                         space.

For later comparisons, in this section we introduce a weakly penalized form of the mechanical problem and show its equivalence with both penalty and LM formulations. Here we introduce the projection operator 
                              
                                 
                                    
                                       π
                                    
                                    
                                       W
                                    
                                 
                                 :
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                                 →
                                 W
                              
                            which, for any function 
                              
                                 g
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                           , denotes the orthogonal projection onto W, i.e.
                           
                              
                                 (6)
                                 
                                    (
                                    g
                                    -
                                    
                                       
                                          π
                                       
                                       
                                          W
                                       
                                    
                                    (
                                    g
                                    )
                                    ,
                                    q
                                    )
                                    ≔
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    [
                                    g
                                    -
                                    
                                       
                                          π
                                       
                                       
                                          W
                                       
                                    
                                    (
                                    g
                                    )
                                    ]
                                    qdV
                                    ≔
                                    0
                                    ,
                                    
                                    ∀
                                    q
                                    ∈
                                    W
                                    .
                                 
                              
                           In this way, we may elect to represent g coarsely or finely by adjusting the selection of the space W (as we will discuss further in the following sections). We may then introduce the weakly penalized total potential energy functional,
                              
                                 (7)
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          P
                                       
                                    
                                    (
                                    v
                                    )
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    Ψ
                                    (
                                    v
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                π
                                             
                                             
                                                W
                                             
                                          
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                v
                                             
                                          
                                          -
                                          1
                                          )
                                          ]
                                       
                                       
                                          2
                                       
                                    
                                    dV
                                    +
                                    
                                       
                                          Π
                                       
                                       
                                          ext
                                       
                                    
                                    (
                                    v
                                    )
                                    ,
                                 
                              
                           where an additional penalty term has been added, representing the growth in energy resulting from material compression as is typical for many penalty methods. However, the presence of the projection 
                              
                                 
                                    
                                       π
                                    
                                    
                                       W
                                    
                                 
                              
                            enables the selective weakening or strengthening of the constraint by allowing it to hold weakly through Eq. (6). Clearly, when 
                              
                                 
                                    
                                       J
                                    
                                    
                                       v
                                    
                                 
                                 ∈
                                 W
                              
                            for any 
                              
                                 v
                                 ∈
                                 X
                              
                            (for example, when 
                              
                                 W
                                 ≔
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            as is the case for the continuous mechanical system [48]), then
                              
                                 (8)
                                 
                                    
                                       
                                          π
                                       
                                       
                                          W
                                       
                                    
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          v
                                       
                                    
                                    -
                                    1
                                    )
                                    =
                                    
                                       
                                          J
                                       
                                       
                                          v
                                       
                                    
                                    -
                                    1
                                 
                              
                           and Eq. (7) reduces to the classic total potential energy functional,
                              
                                 (9)
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    v
                                    )
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    Ψ
                                    (
                                    v
                                    )
                                    +
                                    
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    k
                                    
                                       
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                v
                                             
                                          
                                          -
                                          1
                                          )
                                       
                                       
                                          2
                                       
                                    
                                    dV
                                    +
                                    
                                       
                                          Π
                                       
                                       
                                          ext
                                       
                                    
                                    (
                                    v
                                    )
                                    ,
                                 
                              
                           where the k-dependent term denotes the volumetric penalty term often used in cardiac mechanics [25,23]. The Perturbed Lagrangian formulation may be derived by introducing an additional variable, 
                              
                                 λ
                                 ∈
                                 W
                              
                            with,
                              
                                 (10)
                                 
                                    λ
                                    ≔
                                    k
                                    
                                       
                                          π
                                       
                                       
                                          W
                                       
                                       
                                          v
                                       
                                    
                                    .
                                 
                              
                           Substituting the orthogonal projection with the added variable, and adding the Galerkin orthogonality condition (Eq. (6)) we arrive at the PL functional [50,47,48,57],
                              
                                 (11)
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    v
                                    ,
                                    λ
                                    )
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    Ψ
                                    (
                                    v
                                    )
                                    +
                                    λ
                                    (
                                    J
                                    -
                                    1
                                    )
                                    -
                                    
                                       
                                          
                                             
                                                λ
                                             
                                             
                                                2
                                             
                                          
                                       
                                       
                                          2
                                          k
                                       
                                    
                                    dV
                                    +
                                    
                                       
                                          Π
                                       
                                       
                                          ext
                                       
                                    
                                    (
                                    v
                                    )
                                    .
                                 
                              
                           
                        

This general purpose formulation has been employed for the solution of nearly incompressible materials [47,50,48,49] and cardiac mechanics [44]. Note that as 
                              
                                 k
                                 →
                                 ∞
                              
                            the previous formulation becomes the classic LM method [26,29].

In the continuous setting, there is a solution 
                              
                                 u
                                 ∈
                                 X
                              
                            which satisfies,
                              
                                 (12)
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          P
                                       
                                    
                                    (
                                    u
                                    )
                                    ≔
                                    
                                       
                                          inf
                                       
                                       
                                          v
                                          ∈
                                          X
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          P
                                       
                                    
                                    (
                                    v
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (13)
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    u
                                    )
                                    ≔
                                    
                                       
                                          inf
                                       
                                       
                                          v
                                          ∈
                                          X
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          k
                                       
                                    
                                    (
                                    v
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (14)
                                 
                                    
                                       
                                          Π
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    u
                                    ,
                                    λ
                                    )
                                    ≔
                                    
                                       
                                          
                                             inf
                                          
                                          
                                             v
                                             ∈
                                             X
                                          
                                       
                                    
                                    
                                       
                                          
                                             sup
                                          
                                          
                                             q
                                             ∈
                                             W
                                          
                                       
                                    
                                    
                                       
                                          Π
                                       
                                       
                                          λ
                                       
                                    
                                    (
                                    v
                                    ,
                                    q
                                    )
                                 
                              
                           for all approaches and all values of k. However, this equivalence is often lost in the discrete setting as different strategies are applied to discretize the function space, 
                              
                                 X
                              
                           , and the orthogonal projection, 
                              
                                 
                                    
                                       π
                                    
                                    
                                       W
                                    
                                 
                              
                           .

In the FEM framework used in the solution of Problems (12)–(14), the domain 
                           
                              Ω
                           
                         is subdivided into a mesh of non-overlapping elements [56]. The displacement is then interpolated with functions in 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                              ⊂
                              X
                           
                        , consisting of a set of piecewise polynomials (
                           
                              
                                 
                                    P
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        ) on the mesh 
                           
                              T
                              =
                              T
                              (
                              Ω
                              )
                           
                        , i.e.
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       h
                                    
                                 
                                 ≔
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 C
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 |
                                 
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       τ
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 T
                                 (
                                 Ω
                                 )
                                 }
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    k
                                 
                                 
                                    u
                                 
                              
                           
                         denotes the order of interpolation used for the displacement and 
                           
                              C
                           
                         is the space of continuous vector functions. Letting 
                           
                              
                                 
                                    Φ
                                 
                                 
                                    u
                                 
                              
                           
                         be an 
                           
                              
                                 
                                    N
                                 
                                 
                                    u
                                 
                              
                           
                         vector function comprised of the basis functions 
                           
                              
                                 
                                    {
                                    
                                       
                                          Φ
                                       
                                       
                                          i
                                       
                                    
                                    }
                                 
                                 
                                    i
                                    =
                                    1
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                           
                        , the resulting displacement solution is then expressed as the weighted sum,
                           
                              (15)
                              
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 U
                                 ·
                                 
                                    
                                       Φ
                                    
                                    
                                       u
                                    
                                 
                                 ,
                                 
                                 U
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                                 .
                              
                           
                        In all approaches, the minimization of the total potential energy occurs over 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                              ⊂
                              X
                           
                        .

The primary point of departure between the penalty and PL formulations comes in the choice of orthogonal projection. In the case of the penalty method, the orthogonal projection 
                           
                              
                                 
                                    π
                                 
                                 
                                    W
                                 
                              
                              :
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              →
                              W
                           
                         remains on the continuous space 
                           
                              W
                              =
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                           
                        , leaving the total potential energy 
                           
                              
                                 
                                    Π
                                 
                                 
                                    k
                                 
                              
                           
                         unchanged. In contrast, the PL approach given in Eqs. (11) and (14) requires a numerical approximation of the pressure variable, 
                           
                              λ
                           
                         by 
                           
                              
                                 
                                    λ
                                 
                                 
                                    h
                                 
                              
                           
                        , it is hence natural to introduce a discrete function space 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                              ⊂
                              W
                           
                        , i.e.
                        
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 ≔
                                 {
                                 
                                    
                                       q
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 C
                                 (
                                 
                                    
                                       Ω
                                    
                                    
                                       ¯
                                    
                                 
                                 )
                                 |
                                 
                                 
                                    
                                       q
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       τ
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             p
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 T
                                 (
                                 Ω
                                 )
                                 }
                                 .
                              
                           
                        This is equivalent to introducing the projection operator 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              :
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              →
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                         which satisfies the Galerkin orthogonality condition (Eq. (6)) on 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                        . This change means that 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                           
                         projects the incompressibility onto a discrete set of polynomials of degree 
                           
                              
                                 
                                    k
                                 
                                 
                                    p
                                 
                              
                           
                        , effectively relaxing strict satisfaction of the constraint. The weakening of the constraint through the projection operator is similar to reduced/selective integration techniques which also weaken the constraint on compressibility/incompressibility. However, while these techniques have been proven consistent for specific quadrature and element schemes [26], proof is required to ensure each scheme achieves an optimal rate of convergence. The spaces 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                         for the weakly penalized approach are often selected to satisfy the inf–sup condition (where we note 
                           
                              
                                 
                                    k
                                 
                                 
                                    p
                                 
                              
                              <
                              
                                 
                                    k
                                 
                                 
                                    u
                                 
                              
                           
                        ), which ensures uniqueness in the multiplier for all k 
                        [58,26,59–61]. Additionally, for appropriately selected spaces 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                        – such as 
                           
                              
                                 
                                    Q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              -
                              
                                 
                                    Q
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          p
                                       
                                    
                                 
                              
                           
                         with 
                           
                              
                                 
                                    k
                                 
                                 
                                    u
                                 
                              
                              =
                              
                                 
                                    k
                                 
                                 
                                    p
                                 
                              
                              +
                              1
                           
                        – convergence rates in the energy norm are optimal (i.e. 
                        
                           
                              O
                              (
                              
                                 
                                    h
                                 
                                 
                                    
                                       
                                          k
                                       
                                       
                                          u
                                       
                                    
                                 
                              
                              )
                           
                        ).

It is well known that these two methods need not be equivalent in the discrete setting, as can also be confirmed by the presence of locking phenomena in penalty applications [26,27]. These facts can also be observed through the dependence of the methods on the penalty parameter k. As 
                           
                              k
                              →
                              ∞
                           
                        , the PL becomes the classic LM method and the approximation spaces reduce to the subsets,
                           
                              (16)
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       h
                                    
                                 
                                 |
                                 
                                    
                                       π
                                    
                                    
                                       W
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 -
                                 1
                                 )
                                 =
                                 0
                                 }
                                 ,
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                    
                                       X
                                    
                                    
                                       λ
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       h
                                    
                                 
                                 |
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 -
                                 1
                                 )
                                 =
                                 0
                                 }
                                 ,
                              
                           
                        for the penalty and LM methods, respectively. These spaces are nested, i.e.
                        
                           
                              (18)
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                                 ⊆
                                 
                                    
                                       X
                                    
                                    
                                       λ
                                    
                                    
                                       h
                                    
                                 
                                 ⊆
                                 
                                    
                                       X
                                    
                                    
                                       h
                                    
                                 
                                 ,
                              
                           
                        illustrating the more restrictive subset of functions over which the minimization problem can be considered. As a consequence, the space 
                           
                              
                                 
                                    X
                                 
                                 
                                    k
                                 
                                 
                                    h
                                 
                              
                           
                         is typically a small subset of 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                         and can be too restrictive. This occurs as a small violation of the incompressibility constraint can cause a significant increase in the strain energy even though the approximate solution may have a minor degree of error from the true solution.

In contrast, while the LM approach effectively weakens the satisfaction of the constraint, it also has proven optimal convergence rates when 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                         are chosen to satisfy the inf–sup condition [26]. This circumvents over-constraining of the approximation space, but comes at the expense of computing an additional variable.

In the discrete setting, the projection operator 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              :
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              →
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                         introduced in Eq. (6) can be written as,
                           
                              (19)
                              
                                 (
                                 g
                                 -
                                 
                                    
                                       π
                                    
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 g
                                 )
                                 ,
                                 
                                    
                                       q
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 ≔
                                 
                                    
                                       Q
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       R
                                    
                                    
                                       g
                                    
                                 
                                 -
                                 M
                                 π
                                 )
                                 ≔
                                 0
                                 ,
                                 
                                 ∀
                                 
                                    
                                       q
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    q
                                 
                                 
                                    h
                                 
                              
                              =
                              Q
                              ·
                              
                                 
                                    Φ
                                 
                                 
                                    w
                                 
                              
                           
                         is a test function in 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    π
                                 
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                              (
                              g
                              )
                              =
                              π
                              ·
                              
                                 
                                    Φ
                                 
                                 
                                    w
                                 
                              
                           
                         denotes the projection of g on 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                              M
                           
                         is the 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                              -
                           
                         mass matrix,
                           
                              (20)
                              
                                 
                                    
                                       [
                                       M
                                       ]
                                    
                                    
                                       ij
                                    
                                 
                                 ≔
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 dV
                                 ,
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                              
                           
                        and 
                           
                              
                                 
                                    R
                                 
                                 
                                    g
                                 
                              
                           
                         is the weighted function over the test space 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                        ,
                           
                              (21)
                              
                                 
                                    
                                       [
                                       
                                          
                                             R
                                          
                                          
                                             J
                                          
                                       
                                       ]
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 gdV
                                 ,
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 .
                              
                           
                        Considering the introduced term in Eq. (7), we may write
                           
                              (22)
                              
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 k
                                 
                                    
                                       [
                                       
                                          
                                             π
                                          
                                          
                                             W
                                          
                                       
                                       (
                                       
                                          
                                             J
                                          
                                          
                                             v
                                          
                                       
                                       -
                                       1
                                       )
                                       ]
                                    
                                    
                                       2
                                    
                                 
                                 dV
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 k
                                 
                                    
                                       π
                                    
                                    
                                       T
                                    
                                 
                                 M
                                 π
                                 ,
                              
                           
                        where here 
                           
                              π
                              ·
                              
                                 
                                    Φ
                                 
                                 
                                    w
                                 
                              
                              =
                              π
                              (
                              
                                 
                                    J
                                 
                                 
                                    
                                       
                                          v
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                              -
                              1
                              )
                           
                        . Following from Eq. (19) and noting the requirement that the projection holds for 
                           
                              
                                 
                                    q
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                         is equivalent to requiring it hold for all 
                           
                              Q
                              ∈
                              
                                 
                                    R
                                 
                                 
                                    
                                       
                                          N
                                       
                                       
                                          w
                                       
                                    
                                 
                              
                           
                         (where 
                           
                              
                                 
                                    N
                                 
                                 
                                    w
                                 
                              
                           
                         is the dimension of the discrete space 
                           
                              
                                 
                                    W
                                 
                                 
                                    h
                                 
                              
                           
                        ), 
                           
                              π
                           
                         can be seen to satisfy the linear system,
                           
                              (23)
                              
                                 M
                                 π
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       J
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              M
                           
                         is given in Eq. (20)
                        
                           
                              (24)
                              
                                 
                                    
                                       [
                                       
                                          
                                             R
                                          
                                          
                                             J
                                          
                                       
                                       ]
                                    
                                    
                                       j
                                    
                                 
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 (
                                 
                                    
                                       J
                                    
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 1
                                 )
                                 dV
                                 ,
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       j
                                    
                                 
                                 ∈
                                 
                                    
                                       W
                                    
                                    
                                       h
                                    
                                 
                                 .
                              
                           
                        Inverting 
                           
                              M
                           
                         in Eq. (23) and substituting into Eq. (22), the weakly penalized system (Eq. (7)) may be written in discrete form as,
                           
                              (25)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       P
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 Ψ
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 dV
                                 +
                                 
                                    
                                       1
                                    
                                    
                                       2
                                    
                                 
                                 k
                                 
                                    
                                       R
                                    
                                    
                                       J
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       J
                                    
                                 
                                 +
                                 
                                    
                                       Π
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

This form, also used by Bercovier [50] and others [48,49], reduces the system into a single minimization problem on 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                        , eliminating the pressure variable. However, the presence of 
                           
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                           
                         requires the solve of Eq. (23), incuring similar computational cost as computing the PL solution. Considering the discrete weak form and its solution (as we show later), this weakly penalized term requires matrix–matrix products which are (1) expensive, (2) nonlinearly dependent on the solution and (3) generally of a more dense sparsity than the standard penalty system.

These practical issues presented stem from the choice of global orthogonal projection, 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                           
                        , which unfortunately complicates the computation. However, the choice of 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                           
                         is, generally speaking, arbitrary and ideally should balance the need for accuracy with ease of computation. An alternative approach is to use a local orthogonal projection, 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          loc
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                           
                        , satisfying
                           
                              (26)
                              
                                 
                                    
                                       M
                                    
                                    
                                       τ
                                    
                                 
                                 
                                    
                                       π
                                    
                                    
                                       l
                                    
                                 
                                 =
                                 
                                    
                                       R
                                    
                                    
                                       J
                                       ,
                                       τ
                                    
                                 
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 T
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    M
                                 
                                 
                                    τ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    J
                                    ,
                                    τ
                                 
                              
                           
                         are the mass matrix and the weighted constraint vectors on the element 
                           
                              τ
                           
                        . That is, the local orthogonal projection, 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          loc
                                       
                                       
                                          h
                                       
                                    
                                 
                              
                           
                        , satisfies Eq. (6) on the piecewise discontinuous space,
                           
                              
                                 
                                    
                                       W
                                    
                                    
                                       loc
                                    
                                    
                                       h
                                    
                                 
                                 ≔
                                 {
                                 
                                    
                                       q
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                                 |
                                 
                                 
                                    
                                       q
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       |
                                    
                                    
                                       τ
                                    
                                 
                                 ∈
                                 
                                    
                                       P
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             π
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 ∀
                                 τ
                                 ∈
                                 T
                                 (
                                 Ω
                                 )
                                 }
                                 .
                              
                           
                        
                     

Using this locally continuous, but globally discontinuous interpolation space, the total potential energy for the body becomes,
                           
                              (27)
                              
                                 
                                    
                                       Π
                                    
                                    
                                       P
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       Ω
                                    
                                 
                                 Ψ
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 dV
                                 +
                                 
                                    
                                       k
                                    
                                    
                                       2
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          τ
                                          ∈
                                          T
                                       
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       J
                                       ,
                                       τ
                                    
                                    
                                       T
                                    
                                 
                                 
                                    
                                       M
                                    
                                    
                                       τ
                                    
                                    
                                       -
                                       1
                                    
                                 
                                 
                                    
                                       R
                                    
                                    
                                       J
                                       ,
                                       τ
                                    
                                 
                                 +
                                 
                                    
                                       Π
                                    
                                    
                                       ext
                                    
                                 
                                 (
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 .
                              
                           
                        
                     

This localized projection, also known as static condensation has been employed by Sussman and Bathe [47], Bercovier [50] and Simo et al. [33,37] to enhance the efficiency of the formulation, while avoiding over-constraining of the approximation space and locking phenomena. Indeed, by localizing the projection, computations remain on the element level, reducing the computational cost relative to Eq. (25). Moreover, localization of the penalty term preserves sparsity of the penalty system, significantly reducing sparsity to that resulting from Eq. (25). These practical improvements come at the cost of restricting the approximation space. Again, as we send 
                           
                              k
                              →
                              ∞
                           
                        , the approximation space of the weakly penalized formulation in Eq. (27) is restricted to the space,
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       P
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       h
                                    
                                 
                                 |
                                 
                                    
                                       π
                                    
                                    
                                       
                                          
                                             W
                                          
                                          
                                             loc
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 =
                                 0
                                 }
                                 .
                              
                           
                        which we note is,
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                                 ⊆
                                 
                                    
                                       X
                                    
                                    
                                       P
                                    
                                    
                                       h
                                    
                                 
                                 ⊆
                                 
                                    
                                       X
                                    
                                    
                                       λ
                                    
                                    
                                       h
                                    
                                 
                                 .
                              
                           
                        Note that in a practical setting, as k can not be infinite, an augmented Lagrangian iterative scheme can be applied to iteratively increase k. In this way, the weakly penalized form can provide equivalent results to the incompressible LM method.

Though the weakly penalized form in Eq. (27) does not mandate the inf–sup condition, usage of inf–sup stable spaces (such as Nicolaides–Boland [60] or Crouzeix–Raviart [62] elements) with globally discontinuous pressure ensures optimal convergence. However, as we demonstrate, even for some spaces which are not inf–sup stable (for instance 
                           
                              
                                 
                                    Q
                                 
                                 
                                    2
                                 
                              
                              -
                              
                                 
                                    Q
                                 
                                 
                                    loc
                                 
                                 
                                    1
                                 
                              
                           
                        ), this weakening of the constraint is sufficient to restore convergence.
                           1
                           In this paper, we consider only quadrilateral and hexahedral element types.
                        
                        
                           1
                        
                     

Using the generalized weakly penalized form, Appendix B shows an error estimate in Lemma 1 in the case of a linear elastic model. Here, the projection and bulk modulus in the discrete model 
                           
                              (
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    k
                                 
                                 
                                    h
                                 
                              
                              )
                           
                         are left general, enabling extension to the methods (LM, PL, and Penalty) considered in the paper. From this analysis, we observe in Lemma 1 (when 
                           
                              
                                 
                                    k
                                 
                                 
                                    h
                                 
                              
                              =
                              k
                           
                        ) that the continuous model (
                           
                              u
                              =
                              
                                 
                                    u
                                 
                                 
                                    ∗
                                 
                              
                              +
                              (
                              1
                              /
                              k
                              )
                              
                                 
                                    u
                                 
                                 
                                    ⊥
                                 
                              
                           
                        ) and discrete model satisfy the estimate,
                           
                              (28)
                              
                                 ‖
                                 u
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                                 ⩽
                                 C
                                 
                                    
                                       inf
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      y
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      0
                                                      ,
                                                      div
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      z
                                                   
                                                   
                                                      h
                                                   
                                                
                                                ∈
                                                
                                                   
                                                      (
                                                      
                                                         
                                                            X
                                                         
                                                         
                                                            0
                                                            ,
                                                            div
                                                         
                                                         
                                                            h
                                                         
                                                      
                                                      )
                                                   
                                                   
                                                      ⊥
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ‖
                                          
                                             
                                                π
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          ∇
                                          ·
                                          
                                             
                                                u
                                             
                                             
                                                ⊥
                                             
                                          
                                          )
                                          -
                                          ∇
                                          ·
                                          
                                             
                                                u
                                             
                                             
                                                ⊥
                                             
                                          
                                          ‖
                                          +
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                ∗
                                             
                                          
                                          -
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                1
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   
                                                      
                                                         1
                                                      
                                                      
                                                         k
                                                      
                                                   
                                                   +
                                                   1
                                                
                                             
                                          
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                ⊥
                                             
                                          
                                          -
                                          
                                             
                                                z
                                             
                                             
                                                h
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                1
                                             
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        (see Appendix B). Here, the estimate shows the approximation depends on three principle terms which relate the error incurred due to the projection as well as the error approximating divergence free and non-divergence free components of the solution. Importantly, the bound depends on the subspaces 
                           
                              
                                 
                                    X
                                 
                                 
                                    0
                                    ,
                                    div
                                 
                                 
                                    h
                                 
                              
                           
                         and 
                           
                              
                                 
                                    (
                                    
                                       
                                          X
                                       
                                       
                                          0
                                          ,
                                          div
                                       
                                       
                                          h
                                       
                                    
                                    )
                                 
                                 
                                    ⊥
                                 
                              
                           
                         which, in general do not exhibit straightforward convergence properties. However, as demonstrated in Corollary 1 of Appendix B, if 
                           
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                           
                         projects 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                           
                         to a discrete space which satisfies the inf–sup condition [50,59,26,61], the estimate can be extended so the infimum is taken over 
                           
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                                 
                                    h
                                 
                              
                           
                        . This factor – which is exploited in the LM and PL formulations (as well as the weakly penalized form suggested above) – enables straightforward application of standard estimates derived from interpolation theory.

However, in the case of the penalty method, 
                           
                              π
                              :
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              →
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                           
                         remains the continuous 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                        -projection, limiting the extension discussed. While some simplification can be made (see Corollary 2), the estimate requires use of 
                           
                              
                                 
                                    X
                                 
                                 
                                    0
                                    ,
                                    div
                                 
                                 
                                    h
                                 
                              
                           
                         which may be prohibitive, limiting the convergence behavior. While more straightforward estimates may be derived (see for example [36]), in these the scaling constant C depends on k.

These results are in agreement with the the numerical results presented later in this paper.

This section deals with the weak form of the weakly penalized formulation and the modifications introduced in the residual evaluation to enable improved nonlinear convergence and better performance of the SNR scheme. The discrete weak form for the weakly penalized formulation can be obtained by requiring that the directional derivative of the total potential energy functional vanishes in all arbitrary directions 
                           
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                                 
                                    h
                                 
                              
                           
                         at 
                           
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           
                        , i.e.
                        
                           
                              (29)
                              
                                 D
                                 
                                    
                                       Π
                                    
                                    
                                       P
                                    
                                 
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 [
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ]
                                 =
                                 0
                                 ,
                                 
                                 ∀
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                    
                                       h
                                    
                                 
                                 ,
                              
                           
                        with 
                           
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                                 
                                    h
                                 
                              
                           
                         the homogeneous zero Dirichlet subspace of 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                        . Following this procedure, the discrete weak form can be written in operator notation as,
                           
                              (30)
                              
                                 R
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 ≔
                                 A
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 +
                                 C
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 -
                                 F
                                 (
                                 δ
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 =
                                 0
                                 ,
                              
                           
                        
                     

where R is the residual function and the operators 
                           
                              A
                              ,
                              F
                           
                        , and C are defined as,
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             A
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                             δ
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                             =
                                             
                                                ∫
                                                
                                                   Ω
                                                
                                             
                                             
                                                
                                                   F
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   S
                                                
                                                
                                                   h
                                                
                                             
                                             :
                                             ∇
                                             δ
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             dV
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             F
                                             (
                                             δ
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                             =
                                             
                                                ∫
                                                
                                                   Ω
                                                
                                             
                                             f
                                             ·
                                             δ
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             dV
                                             +
                                             
                                                ∫
                                                
                                                   ∂
                                                   Ω
                                                
                                             
                                             t
                                             ·
                                             δ
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             dA
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             C
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             ,
                                             δ
                                             
                                                
                                                   u
                                                
                                                
                                                   h
                                                
                                             
                                             )
                                             =
                                             k
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      τ
                                                      ∈
                                                      T
                                                   
                                                
                                             
                                             δ
                                             
                                                
                                                   U
                                                
                                                
                                                   τ
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   B
                                                
                                                
                                                   τ
                                                
                                                
                                                   T
                                                
                                             
                                             
                                                
                                                   M
                                                
                                                
                                                   τ
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                             
                                                
                                                   R
                                                
                                                
                                                   J
                                                   ,
                                                   τ
                                                
                                             
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where 
                           
                              
                                 
                                    F
                                 
                                 
                                    h
                                 
                              
                              =
                              ∇
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              +
                              I
                           
                         and 
                           
                              
                                 
                                    S
                                 
                                 
                                    h
                                 
                              
                           
                         are the discrete deformation gradient and second Piola stress tensors, respectively [45]. Here 
                           
                              δ
                              
                                 
                                    U
                                 
                                 
                                    τ
                                 
                              
                           
                         represents the local basis coefficients for 
                           
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           
                         on the element and the element matrix 
                           
                              
                                 
                                    B
                                 
                                 
                                    τ
                                 
                              
                           
                         denotes the linearized constraint derived from the PL functional, i.e.
                        
                           
                              (31)
                              
                                 
                                    
                                       [
                                       
                                          
                                             B
                                          
                                          
                                             τ
                                          
                                       
                                       ]
                                    
                                    
                                       ij
                                    
                                 
                                 =
                                 
                                    
                                       B
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 
                                    
                                       ϕ
                                    
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 =
                                 
                                    ∫
                                    
                                       τ
                                    
                                 
                                 
                                    
                                       ϕ
                                    
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       J
                                    
                                    
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 
                                    
                                       F
                                    
                                    
                                       h
                                    
                                    
                                       -
                                       T
                                    
                                 
                                 :
                                 ∇
                                 
                                    
                                       ϕ
                                    
                                    
                                       u
                                    
                                    
                                       j
                                    
                                 
                                 dV
                                 ,
                              
                           
                        with 
                           
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              )
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    loc
                                 
                                 
                                    h
                                 
                              
                              ×
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                        . Note that 
                           
                              
                                 
                                    M
                                 
                                 
                                    τ
                                 
                              
                           
                         and 
                           
                              
                                 
                                    R
                                 
                                 
                                    J
                                    ,
                                    τ
                                 
                              
                           
                         are identical to those in Eq. (20) and (24) with 
                           
                              
                                 
                                    ϕ
                                 
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ∈
                              
                                 
                                    W
                                 
                                 
                                    loc
                                 
                                 
                                    h
                                 
                              
                           
                        .

The weak forms for the penalty, LM and PL formulations can be derived similarly as outlined in Appendix A.

In order to solve the mechanical system introduced in Eq. (30) (as well as the others discussed in the Appendix A), we look to use the global Shamanskii–Newton–Raphson (SNR) method [54]. This method has been shown to be effective for problems in fluid–structure interaction [55], enabling faster computation by re-using the Jacobian matrix over multiple time/load steps. Following the procedure outlined in [55], on the 
                              
                                 
                                    
                                       n
                                    
                                    
                                       th
                                    
                                 
                              
                            SNR iteration we update each subsequent guess of the solution, 
                              
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                 
                                 ·
                                 
                                    
                                       Φ
                                    
                                    
                                       u
                                    
                                 
                              
                           , using the iterative formula,
                              
                                 (32)
                                 
                                    
                                       
                                          U
                                       
                                       
                                          n
                                          +
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    +
                                    δ
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    
                                    δ
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    -
                                    
                                       
                                          α
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          
                                             
                                                J
                                                (
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      β
                                                   
                                                
                                                )
                                             
                                          
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    R
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    .
                                 
                              
                           Here 
                              
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                 
                              
                            denotes the basis weights at the 
                              
                                 
                                    
                                       n
                                    
                                    
                                       th
                                    
                                 
                              
                            iteration, 
                              
                                 δ
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                 
                              
                            the update vector, and 
                              
                                 R
                              
                            and 
                              
                                 J
                              
                            are the residual and Jacobian, respectively, defined in Eq. (33).
                              
                                 (33)
                                 
                                    
                                       
                                          [
                                          R
                                          (
                                          
                                             
                                                U
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    R
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    ·
                                    
                                       
                                          ϕ
                                       
                                       
                                          u
                                       
                                    
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                       
                                          [
                                          J
                                          (
                                          
                                             
                                                U
                                             
                                             
                                                n
                                             
                                          
                                          )
                                          ]
                                       
                                       
                                          ij
                                       
                                    
                                    ≈
                                    
                                       
                                          ∂
                                          R
                                          (
                                          
                                             
                                                U
                                             
                                             
                                                n
                                             
                                          
                                          ·
                                          
                                             
                                                ϕ
                                             
                                             
                                                u
                                             
                                          
                                          ,
                                          
                                             
                                                ϕ
                                             
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          )
                                       
                                       
                                          ∂
                                          
                                             
                                                U
                                             
                                             
                                                j
                                             
                                             
                                                n
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           The key distinction between the Newton–Raphson method, global Newton–Raphson method and SNR method introduced in Eq. (32) are the parameters 
                              
                                 
                                    
                                       α
                                    
                                    
                                       n
                                    
                                 
                              
                            and 
                              
                                 β
                              
                           . In classical Newton–Raphson, these parameters play no role in the update process (in this case 
                              
                                 (
                                 
                                    
                                       α
                                    
                                    
                                       n
                                    
                                 
                                 ,
                                 β
                                 )
                                 =
                                 (
                                 1
                                 ,
                                 n
                                 )
                              
                           ). The global Newton–Raphson scheme, however, uses the parameter 
                              
                                 
                                    
                                       α
                                    
                                    
                                       n
                                    
                                 
                                 ∈
                                 [
                                 0
                                 ,
                                 1
                                 ]
                              
                            to scale the descent direction to minimize 
                              
                                 ‖
                                 R
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                                 ‖
                              
                            and ensure that 
                              
                                 ‖
                                 R
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       n
                                       +
                                       1
                                    
                                 
                                 )
                                 ‖
                                 ⩽
                                 ‖
                                 R
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                 
                                 )
                                 ‖
                              
                           , i.e. that the residual decays (in this case 
                              
                                 β
                                 =
                                 n
                              
                           ).
                              
                                 
                                    
                                    
                                       
                                          
                                             Algorithm 1. Shamanskii–Newton–Raphson (SNR)
                                       
                                    
                                    
                                       
                                          Given initial guess 
                                                
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   β
                                                
                                             , and 
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             . Compute 
                                                
                                                   R
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             , and set 
                                                
                                                   n
                                                   =
                                                   0
                                                
                                             .
                                       
                                       
                                          
                                             
                                                while
                                              
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ‖
                                                   R
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                   ‖
                                                   >
                                                   TOL
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                             
                                                if
                                              (
                                                
                                                   β
                                                   =
                                                   n
                                                
                                             ) {
                                                Compute
                                              
                                             
                                                
                                                   J
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                
                                              
                                             
                                                and
                                              
                                             
                                                
                                                   
                                                      
                                                         [
                                                         J
                                                         (
                                                         
                                                            
                                                               U
                                                            
                                                            
                                                               n
                                                            
                                                         
                                                         )
                                                         ]
                                                      
                                                      
                                                         -
                                                         1
                                                      
                                                   
                                                
                                              (or preconditioner)}
                                       
                                       
                                          
                                             
                                             
                                                Solve
                                              
                                             
                                                
                                                   J
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         β
                                                      
                                                   
                                                   )
                                                   δ
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   =
                                                   -
                                                   R
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                Find
                                              
                                             
                                                
                                                   min
                                                   
                                                   {
                                                   
                                                   ‖
                                                   R
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   δ
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   )
                                                   ‖
                                                   ,
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ∈
                                                   [
                                                   0
                                                   ,
                                                   1
                                                   ]
                                                   }
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                Set
                                              
                                             
                                                
                                                   δ
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         ′
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   +
                                                   δ
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                
                                             .
                                       
                                       
                                          
                                             
                                             
                                                if
                                              (
                                                
                                                   ‖
                                                   R
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                         +
                                                         1
                                                      
                                                   
                                                   )
                                                   ‖
                                                   >
                                                   γ
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   ‖
                                                   R
                                                   (
                                                   
                                                      
                                                         U
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   )
                                                   ‖
                                                
                                             
                                             
                                             
                                                or
                                              
                                             
                                                
                                                   n
                                                   >
                                                
                                              ITER) {
                                                Set
                                              
                                             
                                                
                                                   β
                                                   =
                                                   n
                                                   +
                                                   1
                                                
                                             }
                                       
                                       
                                          
                                             
                                             
                                                Set
                                              
                                             
                                                
                                                   n
                                                   =
                                                   n
                                                   +
                                                   1
                                                
                                             , 
                                                and
                                              
                                             
                                                
                                                   
                                                      
                                                         S
                                                      
                                                      
                                                         n
                                                      
                                                   
                                                   =
                                                   1
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                end
                                             
                                             
                                             
                                                while
                                             
                                          
                                       
                                    
                                 
                              
                           
                        

In constrast, the SNR method shown in Algorithm 1 combines the minimization procedure with a re-use scheme, where 
                              
                                 β
                                 ⩽
                                 n
                              
                            denotes the use of a Jacobian matrix determined at a previous load step/iteration. The selection of 
                              
                                 β
                              
                            is based on the convergence characteristics governed by 
                              
                                 γ
                                 ,
                                 
                                    
                                       S
                                    
                                    
                                       n
                                    
                                 
                              
                            and ITER.
                              2
                              Default values used 
                                    
                                       γ
                                       =
                                       3
                                       /
                                       4
                                       ,
                                       
                                          
                                             S
                                          
                                          
                                             1
                                          
                                       
                                       =
                                       100
                                    
                                  for stiff problems, and ITER 
                                 
                                    
                                       =
                                       15
                                    
                                 .
                           
                           
                              2
                            Here 
                              
                                 γ
                                 ∈
                                 (
                                 0
                                 ,
                                 1
                                 ]
                              
                            governs the degree of residual decrease required to continue using the currently stored Jacobian. ITER may also signal re-computation and enables a cap on the degree of re-use. Finally, the parameters 
                              
                                 
                                    
                                       S
                                    
                                    
                                       0
                                    
                                 
                              
                            is used to cope with stiff problems which, due to Dirichlet conditions, may see initial increases in the residual computation.

As both penalty and LM formulations have been outlined elsewhere, here we focus on the Jacobian and residual evaluations for the weakly penalized approach. Note that 
                              
                                 J
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             u
                                          
                                       
                                       ×
                                       
                                          
                                             N
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                            and 
                              
                                 R
                                 ∈
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             N
                                          
                                          
                                             u
                                          
                                       
                                    
                                 
                              
                            may be written as,
                              
                                 (34)
                                 
                                    J
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          β
                                       
                                    
                                    )
                                    =
                                    A
                                    
                                       
                                          A
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          β
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          C
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          β
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (35)
                                 
                                    R
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    =
                                    A
                                    
                                       
                                          R
                                       
                                       
                                          A
                                          ,
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          P
                                          ,
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          U
                                       
                                       
                                          n
                                       
                                    
                                    )
                                    ,
                                 
                              
                           where 
                              
                                 A
                              
                            is the FEM assembly operator, 
                              
                                 τ
                                 ∈
                                 T
                              
                            denotes specific elements, the subscript 
                              
                                 τ
                              
                            denotes vector, matrices or operators constructed on the element and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       A
                                       ,
                                       τ
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       P
                                       ,
                                       τ
                                    
                                 
                              
                            are element-level residual contributions stemming from the weakly penalized term, 
                              
                                 
                                    
                                       R
                                    
                                    
                                       P
                                    
                                 
                              
                           , and all other terms, 
                              
                                 
                                    
                                       R
                                    
                                    
                                       A
                                    
                                 
                              
                           . Introducing a short-hand notation, i.e. 
                              
                                 
                                    
                                       C
                                    
                                    
                                       τ
                                    
                                    
                                       β
                                    
                                 
                                 =
                                 
                                    
                                       C
                                    
                                    
                                       τ
                                    
                                 
                                 (
                                 
                                    
                                       U
                                    
                                    
                                       β
                                    
                                 
                                 )
                              
                           , we can express the element-level Jacobian contributions 
                              
                                 
                                    
                                       A
                                    
                                    
                                       τ
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       C
                                    
                                    
                                       τ
                                    
                                 
                              
                            as,
                              
                                 (36)
                                 
                                    
                                       
                                          [
                                          
                                             
                                                A
                                             
                                             
                                                τ
                                             
                                             
                                                β
                                             
                                          
                                          ]
                                       
                                       
                                          ij
                                       
                                    
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          ∊
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   τ
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   β
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             ∊
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   F
                                                
                                                
                                                   τ
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   β
                                                
                                                
                                                   h
                                                
                                             
                                             +
                                             ∊
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   A
                                                
                                                
                                                   τ
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   β
                                                
                                                
                                                   h
                                                
                                             
                                             -
                                             ∊
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                             +
                                             
                                                
                                                   F
                                                
                                                
                                                   τ
                                                
                                             
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   β
                                                
                                                
                                                   h
                                                
                                             
                                             -
                                             ∊
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             ,
                                             
                                                
                                                   ϕ
                                                
                                                
                                                   i
                                                
                                             
                                             )
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (37)
                                 
                                    
                                       
                                          C
                                       
                                       
                                          τ
                                       
                                       
                                          β
                                       
                                    
                                    =
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                β
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          B
                                       
                                       
                                          τ
                                       
                                       
                                          β
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (38)
                                 
                                    
                                       
                                          [
                                          
                                             
                                                R
                                             
                                             
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                       
                                          j
                                       
                                    
                                    =
                                    
                                       
                                          A
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          n
                                       
                                       
                                          h
                                       
                                    
                                    ,
                                    
                                       
                                          ϕ
                                       
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          F
                                       
                                       
                                          τ
                                       
                                    
                                    (
                                    
                                       
                                          ϕ
                                       
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (39)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          P
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                 
                              
                           The element-level matrix 
                              
                                 
                                    
                                       A
                                    
                                    
                                       τ
                                    
                                 
                              
                            denotes those terms resulting from the elasticity stress/boundary contributions
                              3
                              Note that, as the traction 
                                    
                                       t
                                    
                                  typically depends on the physical domain, the operator 
                                    
                                       
                                          
                                             F
                                          
                                          
                                             τ
                                          
                                       
                                    
                                  often depends on 
                                    
                                       u
                                    
                                  and is included in the Jacobian.
                           
                           
                              3
                            and is evaluated using central finite differencing (typically 
                              
                                 ∊
                                 =
                                 
                                    
                                       10
                                    
                                    
                                       -
                                       4
                                    
                                 
                                 h
                              
                           , where h is the mesh size). 
                              
                                 
                                    
                                       C
                                    
                                    
                                       τ
                                    
                                 
                              
                            denotes those terms which result from the weakly penalized form. Here we assume that 
                              
                                 
                                    
                                       B
                                    
                                    
                                       τ
                                    
                                 
                              
                           , defined in Eq. (31), is independent of 
                              
                                 u
                              
                            when we linearize the C operator introduced in Section 2.5. This linearization does not seem to impact convergence of the Newton scheme and preserves symmetric positive semi-definiteness of the weakly penalized matrix term. As we see, 
                              
                                 
                                    
                                       C
                                    
                                    
                                       τ
                                    
                                 
                              
                            is comprised of the local element mass matrix 
                              
                                 
                                    
                                       M
                                    
                                    
                                       τ
                                    
                                 
                              
                            and the linearized constraint equation 
                              
                                 
                                    
                                       B
                                    
                                    
                                       τ
                                    
                                 
                              
                            introduced in the previous section. We note that 
                              
                                 
                                    
                                       M
                                    
                                    
                                       τ
                                    
                                 
                              
                            and its inverse are linear and thus may be computed once for the entire simulation. On the other hand, the linearized constraint must be re-computed due to its nonlinear dependence on the solution. However, computing this matrix is quick as it does not require differencing.

As mentioned previously, the weakly penalized system can be thought of as a generalized formulation which can result in the PL, penalty or statically condensed PL formulations depending on the choice of the projection operator. The equivalence of these methods under the weakly penalized regime, allows us to combine and take advantage of the good characteristics of each method. For instance, the weakly penalized formulation combines the simplified structure of the penalty method with the convergence characteristics of the PL formulation. However, due to the stiffness of the linear system at high values of the bulk modulus, the penalized formulations (classic penalty/weakly penalized) exhibit deteriorated nonlinear convergence. This stands in stark contrast to the PL method which (for inf–sup stable schemes) exhibits fast convergence even for high bulk modulus. However, we observe that, when the choice of 
                              
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                              
                            provides equivalence with the discrete PL method, poor nonlinear convergence is observed though, in principle, the convergence should be similar. Examining the update formulae for both weakly penalized and PL approaches (see Appendix C), we observe that deteriorated convergence stems from: (1) initial residual amplification, and (2) the amplification of the residual.

The first factor, mentioned in Section 2.5.1, results from non-monotonicity in the residual. This manifests particularly early during the nonlinear solve, where the initial residual becomes amplified after the first iteration. This is particularly evident with Dirichlet conditions on a stiff material, where the norm of the boundary displacement (for example) may be much smaller than the updated residual due to stiffness in the material. This issue which is not observed in the PL solution, is circumvented in the Newton–Raphson procedure and the SNR procedure outlined in Algorithm 1 by enabling an initial amplification of the residual and relaxing strict requirements on monotonicity.

Less trivial issue to address is the amplification of the residual resulting from large k, which can lead to poor convergence or stalling in the iterative solve. This increased residual, due to strong dependence on the weakly penalized term, often does not imply divergence but rather results from a k-dependent scaling of the projection problem and its nonlinear dependence on 
                              
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                              
                            as shown in Appendix C. Based on Eq. (C.7) (and choosing 
                              
                                 β
                                 =
                                 n
                              
                           ), we may re-write the weakly penalized residual contribution in terms of the linearized guess and a remainder,
                              
                                 (40)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          P
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          τ
                                       
                                    
                                    +
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          e
                                          ,
                                          τ
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (41)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          τ
                                       
                                    
                                    =
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          B
                                       
                                       
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    δ
                                    
                                       
                                          U
                                       
                                       
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (42)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          e
                                          ,
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          B
                                       
                                       
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    δ
                                    
                                       
                                          U
                                       
                                       
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                           Here the first term approximates the current linearized guess of the projection, while the second examines how well the current guess satisfies the projection problem. In other words, the first term denotes the hydrostatic contribution to momentum, while the second represents the error remaining in the projection problem amplified by the bulk modulus k. For large k, the later term can become disproportionately scaled, making nonlinear convergence more challenging. Moreover, this issue is avoided in the PL formulation where the hydrostatic constraint is not scaled by k as can be seen in the residual terms of Eq. (C.3).

To circumvent this, we modify the Newton–Raphson scheme to measure convergence of 
                              
                                 ‖
                                 R
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 ‖
                              
                            instead of 
                              
                                 ‖
                                 R
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       P
                                    
                                 
                                 ‖
                              
                           . Clearly, 
                              
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∗
                                          
                                       
                                       ,
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       P
                                       ,
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ‖
                                 →
                                 0
                              
                            as 
                              
                                 ‖
                                 δ
                                 
                                    
                                       U
                                    
                                    
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 ‖
                                 →
                                 0
                              
                           ; however, measuring convergence of 
                              
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                              
                            avoids issues due to high bulk modulus. Further, extending this form to the Penalty formulation, we must select the projection 
                              
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                                 :
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                                 →
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                           . As, in this case, the rank of 
                              
                                 M
                              
                            is no longer finite dimensional, we may instead write the modified Penalty form in its equivalent integral form, i.e.
                           
                              
                                 (43)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          P
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          τ
                                       
                                    
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          e
                                          ,
                                          τ
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (44)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ,
                                                τ
                                             
                                          
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    k
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          J
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                -
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    δ
                                    
                                       
                                          u
                                       
                                       
                                          h
                                          ,
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          J
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    dV
                                    ,
                                 
                              
                           
                           
                              
                                 (45)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                e
                                                ,
                                                τ
                                             
                                          
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    k
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          J
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          J
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                n
                                                -
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    δ
                                    
                                       
                                          u
                                       
                                       
                                          h
                                          ,
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          J
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    dV
                                    .
                                 
                              
                           
                        

Similarly to the modifications introduced in the weakly penalized approach, in the modified penalty formulation we measure the convergence of 
                              
                                 ‖
                                 R
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             P
                                          
                                          
                                             ∗
                                          
                                       
                                    
                                 
                                 ‖
                              
                            instead of 
                              
                                 ‖
                                 R
                                 +
                                 
                                    
                                       R
                                    
                                    
                                       P
                                    
                                 
                                 ‖
                              
                           . This avoids the amplification of the error in the second term of the residual, allowing better nonlinear convergence of the scheme.

While the Shamanskii–Newton–Raphson scheme can significantly enhance performance of the PL scheme, acceleration in the SNR approach for penalized methods is minimal or even worse than standard Global Newton–Raphson. This deterioration in performance is due, predominantly, to the stiffness of the system for high k and the inevitable inaccuracies introduced in the descent direction by the re-used Jacobian. In contrast, this deterioration in performance is not observed in both PL and LM formulations, which can take significant advantage of matrix re-use (as we will show). Once more, by examining the equivalence between weakly penalized and PL formulations (see Appendix C), we observe this deterioration may be circumvented using the modified form,
                              
                                 (46)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          P
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          τ
                                       
                                    
                                    +
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                β
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          e
                                          ,
                                          τ
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (47)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                P
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          τ
                                       
                                    
                                    =
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          B
                                       
                                       
                                          τ
                                       
                                       
                                          β
                                       
                                    
                                    δ
                                    
                                       
                                          U
                                       
                                       
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    ,
                                 
                              
                           
                           
                              
                                 (48)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          e
                                          ,
                                          τ
                                       
                                    
                                    =
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    (
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          B
                                       
                                       
                                          τ
                                       
                                       
                                          β
                                       
                                    
                                    δ
                                    
                                       
                                          U
                                       
                                       
                                          τ
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    .
                                 
                              
                           Note that, as 
                              
                                 ‖
                                 δ
                                 
                                    
                                       U
                                    
                                    
                                       n
                                    
                                 
                                 ‖
                                 →
                                 0
                              
                           , the difference in the constraint residual 
                              
                                 ‖
                                 
                                    
                                       R
                                    
                                    
                                       J
                                       ,
                                       τ
                                    
                                    
                                       n
                                    
                                 
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       J
                                       ,
                                       τ
                                    
                                    
                                       n
                                       -
                                       1
                                    
                                 
                                 ‖
                                 →
                                 0
                              
                            and as a result,
                              
                                 
                                    
                                       
                                          R
                                       
                                       
                                          P
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    →
                                    k
                                    
                                       
                                          [
                                          
                                             
                                                B
                                             
                                             
                                                τ
                                             
                                             
                                                n
                                             
                                          
                                          ]
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          M
                                       
                                       
                                          τ
                                       
                                       
                                          -
                                          1
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          J
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                 
                              
                           which represents the standard residual resulting from Eq. (30). That is, as we converge, the modified residual 
                              
                                 
                                    
                                       R
                                    
                                    
                                       P
                                       ,
                                       τ
                                    
                                 
                              
                            converges to that given by evaluating C. Further, we note that if 
                              
                                 β
                                 =
                                 n
                              
                           , the first term in the definition 
                              
                                 
                                    
                                       R
                                    
                                    
                                       P
                                       ,
                                       τ
                                    
                                 
                              
                            drops away, leaving us with the expected residual.

The modifications we introduced to the residual of the weakly penalized formulation can also be applied in the penalty method to improve its nonlinear convergence behavior by once more selecting the projection operator 
                              
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                                 :
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                                 →
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            and using the equivalence of the weakly penalized/penalty forms. Expressing these modifications in integral form, we may write the modified Penalty form with residuals,
                              
                                 (49)
                                 
                                    
                                       
                                          R
                                       
                                       
                                          k
                                          ,
                                          τ
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                ∗
                                             
                                          
                                          ,
                                          τ
                                       
                                    
                                    +
                                    
                                       
                                          R
                                       
                                       
                                          ek
                                          ,
                                          τ
                                       
                                    
                                    ,
                                 
                              
                           
                           
                              
                                 (50)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                
                                                   
                                                      P
                                                   
                                                   
                                                      ∗
                                                   
                                                
                                                ,
                                                τ
                                             
                                          
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    k
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          J
                                       
                                       
                                          β
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                β
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    δ
                                    
                                       
                                          u
                                       
                                       
                                          h
                                          ,
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          J
                                       
                                       
                                          n
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                n
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    dV
                                    ,
                                 
                              
                           
                           
                              
                                 (51)
                                 
                                    
                                       
                                          (
                                          
                                             
                                                R
                                             
                                             
                                                e
                                                ,
                                                τ
                                             
                                          
                                          )
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    k
                                    (
                                    
                                       
                                          J
                                       
                                       
                                          n
                                       
                                    
                                    -
                                    
                                       
                                          J
                                       
                                       
                                          n
                                          -
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          J
                                       
                                       
                                          β
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                β
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    δ
                                    
                                       
                                          u
                                       
                                       
                                          h
                                          ,
                                          n
                                          -
                                          1
                                       
                                    
                                    )
                                    
                                       
                                          J
                                       
                                       
                                          β
                                       
                                    
                                    
                                       
                                          (
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                β
                                             
                                          
                                          )
                                       
                                       
                                          -
                                          T
                                       
                                    
                                    :
                                    ∇
                                    
                                       
                                          ϕ
                                       
                                       
                                          i
                                       
                                    
                                    dV
                                    .
                                 
                              
                           With the introduced modifications in the residual monitored for convergence, the modified penalty method is able to significantly exploit matrix re-use, and substantially improve its computational efficiency.

@&#RESULTS@&#

In this section we study the convergence behavior of the LM, PL, penalty and weakly penalized formulations outlined in Section 2, in the solution of incompressible mechanics problems, for varying values of k. Furthermore, the PL, penalty and weakly penalized approaches are compared on nearly-incompressible solid mechanics problems, assuming various values for the bulk modulus.

The convergence behavior of the LM, penalty and weakly penalized methods was compared on the simple case of the stretch of a square domain (Fig. 2
                           (a)). The body was assumed to be made of a Neo-Hookean material, described by the deviatoric strain energy/Second-Piola stress tensor [45],
                              
                                 (52)
                                 
                                    Ψ
                                    (
                                    C
                                    )
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          2
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         III
                                                      
                                                      
                                                         C
                                                      
                                                      
                                                         1
                                                         /
                                                         d
                                                      
                                                   
                                                
                                             
                                             -
                                             d
                                          
                                       
                                    
                                    ,
                                    
                                    S
                                    =
                                    
                                       
                                          μ
                                       
                                       
                                          
                                             
                                                III
                                             
                                             
                                                C
                                             
                                             
                                                1
                                                /
                                                d
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             I
                                             -
                                             
                                                
                                                   
                                                      
                                                         I
                                                      
                                                      
                                                         C
                                                      
                                                   
                                                
                                                
                                                   d
                                                
                                             
                                             
                                                
                                                   C
                                                
                                                
                                                   -
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where the material parameter 
                              
                                 μ
                              
                            is analogous to the shear modulus of linear elasticity, 
                              
                                 C
                              
                            is the right Cauchy–Green deformation tensor, 
                              
                                 I
                              
                            is the unity tensor, 
                              
                                 
                                    
                                       I
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 tr
                                 (
                                 C
                                 )
                              
                            and 
                              
                                 
                                    
                                       III
                                    
                                    
                                       C
                                    
                                 
                                 =
                                 det
                                 C
                              
                            are the first and third invariants of 
                              
                                 C
                              
                           , and d is the dimension of the domain (in our case 
                              
                                 d
                                 =
                                 2
                              
                           ).

The domain was discretized using six different meshes of inf–sup stable 
                              
                                 
                                    
                                       Q
                                    
                                    
                                       2
                                    
                                 
                                 -
                                 
                                    
                                       Q
                                    
                                    
                                       1
                                    
                                 
                              
                            Taylor–Hood quadrilateral elements [26]. For the weakly penalized formulation, a quadratic interpolation was used for the displacement field and a discontinuous linear interpolation was used for the pressure. The actual solution was approximated using the LM and PL solution (for the incompressible and nearly-incompressible comparison respectively) on a finer mesh (mesh7), with a cubic interpolation for the displacement and a quadratic interpolation for the pressure. Fig. 2(b) presents the number of elements in all seven meshes, and the corresponding degrees of freedom when the LM, PL, penalty and weakly penalized methods were used.

The three methods were tested on a model of the passive inflation of a left ventricle under diastolic loading conditions. The left ventricle (LV) was modeled as a thick-walled truncated ellipsoid (Fig. 3
                           (a)). A standard generic heterogeneous fiber field was used to represent the structure of the tissue [7], where the fiber angle varied linearly between 
                              
                                 60
                                 °
                              
                            and 
                              
                                 -
                                 60
                                 °
                              
                           , from endocardium to epicardium [63].

Several hyperelastic constitutive laws have been proposed to model the myocardial tissue. In this work, the myocardium was modeled using the transversely isotropic exponential law introduced by Guccione et al. [3], a model used frequently in the literature.
                              4
                              The original formulation proposed by Guccione et al. does not use the isochoric split of the deformation gradient [44]. Although this might incur some error, it is not expected to alter the trend of the results presented in this work, therefore the original version of the constitutive law was used, avoiding the required reparameterization of the isochoric version.
                           
                           
                              4
                            This constitutive law is defined with respect to the fiber coordinate system where a coordinate system aligned with local tissue structure is defined everywhere in the material by orthogonal fiber 
                              
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           , sheet 
                              
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                              
                           , and sheet normal 
                              
                                 
                                    
                                       n
                                    
                                    
                                       ˆ
                                    
                                 
                              
                            unit vectors [5,11]. Letting,
                              
                                 (53)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          vw
                                       
                                    
                                    =
                                    E
                                    :
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                    ⊗
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    )
                                    ,
                                    
                                    
                                       
                                          v
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          ˆ
                                       
                                    
                                    ∈
                                    {
                                    
                                       
                                          f
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          s
                                       
                                       
                                          ˆ
                                       
                                    
                                    ,
                                    
                                       
                                          n
                                       
                                       
                                          ˆ
                                       
                                    
                                    }
                                    ,
                                 
                              
                           denote the components of strain aligned with the local tissue structure directions, then the fiber oriented Green strain is,
                              
                                 (54)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          F
                                       
                                    
                                    =
                                    
                                       
                                          Q
                                       
                                       
                                          T
                                       
                                    
                                    EQ
                                    =
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            ff
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            fs
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            fn
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            sf
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            ss
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            sn
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            nf
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            ns
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            E
                                                         
                                                         
                                                            nn
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           with 
                              
                                 Q
                                 =
                                 [
                                 
                                    
                                       f
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       s
                                    
                                    
                                       ˆ
                                    
                                 
                                 ,
                                 
                                    
                                       n
                                    
                                    
                                       ˆ
                                    
                                 
                                 ]
                              
                           . The strain energy and second Piola stress tensor may then be written as [3],
                              
                                 
                                    
                                       
                                          
                                          
                                             
                                                Ψ
                                                (
                                                E
                                                )
                                                =
                                                
                                                   
                                                      C
                                                   
                                                   
                                                      2
                                                   
                                                
                                                (
                                                
                                                   
                                                      e
                                                   
                                                   
                                                      Q
                                                   
                                                
                                                -
                                                1
                                                )
                                                ,
                                                
                                                Q
                                                =
                                                (
                                                A
                                                ∘
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      F
                                                   
                                                
                                                )
                                                :
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      F
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                       
                                          
                                          
                                             
                                                S
                                                =
                                                
                                                   
                                                      Ce
                                                   
                                                   
                                                      Q
                                                   
                                                
                                                Q
                                                (
                                                A
                                                ∘
                                                
                                                   
                                                      E
                                                   
                                                   
                                                      F
                                                   
                                                
                                                )
                                                
                                                   
                                                      Q
                                                   
                                                   
                                                      T
                                                   
                                                
                                                ,
                                             
                                          
                                       
                                    
                                 
                              
                           where 
                              
                                 A
                              
                            stores the material parameters governing the stress response to strain in fiber/sheet/normal directions, i.e.
                           
                              
                                 (55)
                                 
                                    A
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            f
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            fs
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            fs
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            fs
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            fs
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            b
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    .
                                 
                              
                           The parameters used were 
                              
                                 C
                                 =
                                 1760
                                 Pa
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       f
                                    
                                 
                                 =
                                 18.5
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 3.58
                                 ,
                                 
                                    
                                       b
                                    
                                    
                                       fs
                                    
                                 
                                 =
                                 1.63
                              
                            
                           [25]. The endocardial surface of the ventricular model was passively loaded to 
                              
                                 3
                                 kPa
                              
                            (
                              
                                 22.5
                                 
                                 mm
                                 
                                 Hg
                              
                           ), to cover normal and pathological LV functions at end diastole. The LV was inflated using 150 equal load steps, by setting the boundary traction 
                              
                                 t
                              
                            equal to the product of the pressure and the deformed surface normal.

In order to simulate a cardiac cycle, the cardiac model was modified to include myocardial contraction through an active tension generation model [10]. Active tension generation was incorporated into the cardiac model by the addition of the active stress in the fiber direction of the stress tensor. The cardiac model was also coupled to a Windkessel model representing the systemic circulation using the parameters given by Korakianitis et al. [64]. The coupling was enabled through the use of a Lagrange Multiplier which enforces the same rate of change of LV volume in the two models [65].

The LV was discretized using four different meshes of hexahedral elements (Fig. 3(b)). On the first three discretizations, a quadratic interpolation was used for the displacement. The pressure field was interpolated using linear continuous (for the LM/PL methods) and discontinuous (for the weakly penalized formulation) Lagrange polynomials. In the cardiac tests the results on the first three meshes were compared with the LM and PL solution on mesh4 (for the incompressible and compressible comparison respectively), where a quadratic-linear interpolation scheme was employed.

The solid mechanics tests presented in Section 3.1 were used to test the convergence behavior of the methods discussed. The convergence rate of each method was acquired by observing the change in the error between a high resolution benchmark solution and the approximate solution, with mesh refinement. As compressible methods may be selected as an approximation to incompressible behavior, we tested the convergence characteristics of the penalty and weakly penalized approaches to the incompressible LM solution (i.e. 
                        
                           
                              k
                              =
                              ∞
                           
                         in Eq. (11)). We also examined the ability of these approaches to model compressible behavior, comparing the results with a fine grid compressible solution(s) (PL solution(s)). The error tolerance for these tests was set to 
                           
                              1
                              ×
                              
                                 
                                    10
                                 
                                 
                                    -
                                    9
                                 
                              
                           
                        .

The problems under consideration were implemented in CHeart –a multi-physics software tool based on [66–68,55] and expanded by the CHeart team at KCL. All problems were solved on a Dell OPTIPLEX 990, quad-core (Intel® Core
                           
                              ™
                           
                         i7–2600 CPU @ 3.40GHz), on an 2.1GHz AMD Opteron
                           
                              ™
                           
                         Interlagos 32 processor and on an SGI with 640 2.67GHz processors (Intel® Xeon® CPU E7–8837).

The LM, penalty and weakly penalized formulations were initially compared to the incompressible formulation of the elongation problem (Section 3.1.1). Fig. 4
                         compares the error of the penalty and weakly penalized methods in the solution of the incompressible elongation problem measured over the entire domain as well as a horizontal patch excluding the corners (where singularities in the solution occur). Finally, the importance of interpolation order is highlighted in Fig. 5
                        , where linear interpolation was used for both penalty and weakly penalized formulations (where the local orthogonal projection was selected as the set of piecewise-discontinuous constants).

Similar results can be observed in the passive inflation problem detailed in Section 3.1.2. Here convergence of the 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                        -norm displacement error in the different methods is shown in Fig. 6
                         for both approximations to the fine grid incompressible (for 
                           
                              k
                              ∈
                              [
                              
                                 
                                    10
                                 
                                 
                                    4
                                 
                              
                              ,
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                              ]
                              
                              Pa
                           
                        ) and compressible passive inflation problems (with 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    4
                                 
                              
                              
                              Pa
                           
                         and 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                              
                              Pa
                           
                        ). The LM, penalty and weakly penalized methods were also compared on the cardiac cycle model showing consistent results to those illustrated in the passive inflation test. Representative results of this comparison are illustrated in Fig. 3(b), while Fig. 7
                        (a) illustrates convergence of the weakly penalized pressure–volume loops with mesh refinement.

Examining the different effects of these methods on cardiac mechanics, we solved each model over a single cardiac cycle, comparing the differences in their behavior, using the LM method as the point of reference. The cardiac cycle was solved on an intermediate mesh (mesh2), using a quadratic-linear interpolation scheme for the displacement and pressure variables. Fig. 7 illustrates the pressure–volume loop derived from the coupled Windkessel-ventricle model as well as the differences between the LM model and both penalty and weakly penalized methods (with 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                           
                        ) throughout the cycle. Fig. 9 shows the fiber strain, 
                           
                              
                                 
                                    E
                                 
                                 
                                    ff
                                 
                              
                           
                         of the LM method, at the point where the most significant variations are observed (
                           
                              t
                              =
                              361
                              
                              ms
                           
                         after end diastole) as well as the absolute difference in fiber strain between the LM solution on every mesh and the respective penalty and weakly penalized approximations.

The PL, penalty and weakly penalized formulations were compared in terms of their nonlinear convergence behavior. Representative values for the number of iterations of the Newton–Rapson scheme, the number of Jacobian matrix computations (and their respective times) along with the linear solution time and total time are presented in Table 1
                        . The improvement in the efficiency of the different methods when the SNR scheme is applied is presented as well. Finally, the effect of the modifications we introduced in the SNR scheme for the penalty method can be deduced as the table compares the application of the SNR scheme to the penalty method with and without the introduced modifications. Note that although not presented here, the nonlinear behavior of the weakly penalized system when the SNR is applied without the introduced modifications is similar to that of the penalty method without the introduced modifications (PEN). Similar observations can be made using Fig. 8
                         which compares the number of Jacobian and residual computations when the classic Newton–Raphson and the SNR scheme are used for the different methods.

@&#DISCUSSION@&#

Examining the ability of all approaches to model imcompressibility, as we noted in the introduction the most straightforward is the incompressible LM method which enforces weak incompressibility. However, we could consider the compressible penalty and weakly penalized approaches as approximations to the incompressible system. With this in mind, from Eq. (11), the error for any method should converge to zero with a rate proportional to 
                           
                              1
                              /
                              k
                           
                        . For the penalty method, we see from Fig. 4(a) and Fig. 6(a) that the error relative to the incompressible solution was generally higher and increased with increasing k, as a result of the well-known locking phenomena associated with displacement-only formulations. In the cardiac model, with 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                           
                         the error was actually uniformly worse than all other values of the parameter at almost all levels of refinement, making the selection of an appropriate k to model incompressible behavior non-trivial.

As discussed in Section 2.2, we initially hypothesized that issues affiliated with the penalty method could be circumvented by projecting the constraint using an orthogonal projection operator, 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          loc
                                       
                                    
                                 
                              
                           
                        , resulting in the displacement-based formulation suggested by Bercovier [50] and others [48,49]. Indeed, from Fig. 4(b) and Fig. 6(b), we see that as k increased, the error in the approximation decreased proportionally to 
                           
                              1
                              /
                              k
                           
                         and became indistinguishable from the convergence of the LM method itself. The existence of a k-dependent error bound for the weakly penalized approach enables regulation of the error by an appropriate choice of k. Moreover, due to its dependence on the discretization, the error showed plateauing behavior for values of k which incured an error larger than the error associated with the discretization.

The locking behavior of the penalty method is observed to worsen with lower order as shown in Fig. 5, where linear elements were used. In this case, as the bulk modulus increased, the rate of convergence observed in the penalty method deteriorated to nearly zero. In contrast, the weakly penalized approach exhibited consistent linear convergence for 
                           
                              k
                              >
                              
                                 
                                    10
                                 
                                 
                                    5
                                 
                              
                           
                        .

We notice that for both elongation/cardiac problems, the rates of convergence from all methods were not optimal as we would expect based on the error estimates [61]. As the sub-optimal convergence rates appear in the application of all methods, we can assume that this is not a method-dependent issue. We believe that it is due to singularities in the two problems which limit convergence. In the elongation problem, singularities occur at all corners of the domain. Measuring convergence in a horizontal patch excluding corners as shown in Fig. 4(c), we see that for 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                           
                         the rate of convergence in the weakly penalized method is restored to the expected order 
                           
                              O
                              (
                              
                                 
                                    h
                                 
                                 
                                    2
                                 
                              
                              )
                           
                         (for the 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         semi-norm). In contrast, due to locking, no improvement to the rate of convergence is observed in the penalty approach. In the cardiac model, sub-optimal convergence is due to fixing the base plane of the model and the singularity in the fiber field near the apex. Even though the specific boundary condition and fiber field incur singularities, they were chosen because of their frequent use in cardiac models.

Similar conclusions can be deduced by the application of the PL, penalty and weakly penalized formulations in the solution of compressible problems. In compressible problems, the three formulations should provide consistent results for low and moderate values of k. This is observed in Fig. 6(c). While we observed flattening of the convergence behavior to the incompressible solution for 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    4
                                 
                              
                           
                         in both penalty and weakly penalized methods (and, though not shown, for PL), we see uniform and consistent convergence to the compressible solution.

Increasing k, however, caused deterioration in the convergence of the penalty method as shown in Fig. 6(d). Here, the error increased by almost an order of magnitude, while convergence remains consistent between the PL and weakly penalized methods. We note that identical behavior was observed in the 2D elongation problem and, while measurement of the error excluding corners, restored optimal convergence rates in the PL and weakly penalized methods, no improvement in the rate was observed in the penalty method.

In Fig. 7(b), we compare all methods over a cardiac cycle plotting the difference between both penalty and weakly penalized approaches (with 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                           
                        ) and the incompressible LM method on the same discretization. This comparison was performed on an intermediate mesh, mesh2, consisting of 448 elements. Here we see that the LM and penalty methods differ in the 
                           
                              
                                 
                                    H
                                 
                                 
                                    1
                                 
                              
                           
                         semi-norm (which is indicative of errors we could expect in strain) by up to 
                           
                              20
                              %
                           
                        , while the peak difference between weakly penalized and LM approaches remains below 
                           
                              8
                              %
                           
                        . These differences in strain occured primarily during the systolic phase, with decreased error through the rest of the cardiac cycle. Similar conclusions can be deduced from the bulk behavior of these models as seen in Fig. 9
                        , presenting a larger difference in fiber strain between the penalty and LM methods than the weakly penalized and LM methods. Interestingly, in this case the error of both the penalty and weakly penalized formulations decreased with mesh refinement.

The influence of these effects is heavily dependent on the k chosen for the model. Considering convergence (i.e. mesh3 with fine grid mesh4) of the compressible model over the cardiac cycle (even though not shown here), the maximum error for 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    7
                                 
                              
                           
                         was ∼1% for the weakly penalized and LM methods and ∼10% for the penalty method. However, for 
                           
                              k
                              =
                              
                                 
                                    10
                                 
                                 
                                    5
                                 
                              
                           
                         the error for weakly penalized and LM methods remained around ∼1% while the error observed in the penalty method dropped to ∼3%. As the bulk modulus represents the tissue’s resistance to compression, its value is tied to the other cardiac constitutive parameters. Thus the influence of locking in the penalty method depends on the level of compressibility which is acceptable in the model. In general it seems that as 
                           
                              k
                              /
                              C
                              >
                              
                                 
                                    10
                                 
                                 
                                    3
                                 
                              
                           
                        , where C is the bulk scaling on the strain energy in Section 3.1.2, locking becomes increasingly more predominant.

In Section 2.5.2, we outlined the solution procedure for the weakly penalized formulation illustrating that the linearized system involves only the body displacement, 
                           
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                           
                        . Considering the Jacobian for the LM (
                           
                              
                                 
                                    J
                                 
                                 
                                    λ
                                 
                              
                           
                        ), and penalty methods (
                           
                              
                                 
                                    J
                                 
                                 
                                    k
                                 
                              
                           
                        ), shown in Eq. (56), the LM formulation has an indefinite saddle point structure while the penalty method adds to the principle 
                           
                              A
                              -
                           
                         block,
                           
                              (56)
                              
                                 
                                    
                                       J
                                    
                                    
                                       λ
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   A
                                                
                                                
                                                   B
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         B
                                                      
                                                      
                                                         ^
                                                      
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                          
                                       
                                    
                                 
                                 ,
                                 
                                 
                                    
                                       J
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 A
                                 +
                                 P
                                 .
                              
                           
                        Similar to 
                           
                              
                                 
                                    J
                                 
                                 
                                    k
                                 
                              
                           
                        , the Jacobian of the weakly penalized formulation shown in Eq. (34) also augments the 
                           
                              A
                              -
                           
                         block with a matrix, 
                           
                              C
                           
                         which, by construction, is symmetric positive semi-definite. Further, the Jacobian of the PL method augments the zero block matrix with a k-dependent term, avoiding the indefinite nature of the LM Jacobian (the Jacobians of the different formulations are outlined in Appendix A).

The structure of these systems has a significant impact on their solution. While the actual system sizes (shown in Fig. 2(b) and 3(b)) are not substantially different, the indefinite structure of 
                           
                              
                                 
                                    J
                                 
                                 
                                    λ
                                 
                              
                           
                         makes it more challenging to solve, requiring direct methods, “sophisticated” preconditioners or splitting schemes [70]. In contrast, the penalty, PL and weakly penalized strategies are more straightforward in structure, making them more ammenable to classic preconditioning strategies. However, as the bulk modulus k increases, care must be taken to deal with the conditioning of the linear system.

In addition to having contrasting linear structure, the methods also exhibited differing convergence behavior in the Newton–Raphson scheme outlined in Section 2.5.1.
                           5
                           We note that in the examples presented in this work, the cost of computing the Jacobian is larger than the Newton–Raphson solution process, due to the quadratic interpolation used for the displacement and the higher order quadrature rule applied.
                        
                        
                           5
                         In general, the non-linear convergence of the weakly penalized formulation averaged ∼3.81 iterations per load step when the classic Newton–Raphson scheme was employed (Table 1). The modifications we introduced in the weakly penalized form (Section 2.5.2), enhanced the numerical ability of the scheme, which exhibited marginally better non-linear convergence behavior than that of the PL method.

Furthermore, the PL and weakly penalized forms were able to exploit the Jacobian re-use strategy (Shamanskii–Newton–Raphson scheme), leading to approximately 
                           
                              93
                              %
                           
                         decrease in the computational time of the Jacobian matrix 
                           
                              J
                           
                         (build and solution) and a 
                           
                              94
                              %
                           
                         reduction in the total time per loading step (for the weakly penalized form). By modifying the weakly penalized scheme to avoid the high sensitivity to the bulk modulus associated with displacement formulations, the weakly penalized formulation allows efficient re-use of the Jacobian matrix, whereas the performance of the penalty formulation (PEN) is not significantly improved when the SNR scheme is applied. When these modifications were also extended to the penalty method (PEN-MOD), they resulted in significant improvements in both the computational time of the Jacobian matrix 
                           
                              J
                           
                         (
                           
                              87
                              %
                           
                         decrease) and the total time per loading step (
                           
                              89
                              %
                           
                         decrease) compared to the classic Newton–Raphson scheme.

Similar conclusions can be deduced from Fig. 8 which compares the Jacobian and residual computations over the iteration number, with and without the SNR scheme. Clearly, the SNR scheme significantly reduces the number of Jacobian computations for all methods. It is important to note that these observations are consistent in all formulations, indicating that the modifications we introduced in the SNR scheme for both the weakly penalized and penalty formulations were able to significantly improve the performance of the methods.

In Section 2.1.1 we illustrated how the energy functional for a hyperelastic solid can be written consistently for both penalty and LM methods by choosing both an appropriate space of solutions, 
                           
                              X
                           
                        , and orthogonal projection, 
                           
                              
                                 
                                    π
                                 
                                 
                                    W
                                 
                              
                           
                        . In the finite element context, we showed that in the LM method both 
                           
                              X
                           
                         and 
                           
                              
                                 
                                    π
                                 
                                 
                                    W
                                 
                              
                           
                         were necessarily discretized as both the displacement and pressure variables need to be computed, while in the penalty formulation the orthogonal projection is not necessarily discretized as the only unknown variable is the displacement (Section 2.2). As we have shown, this discretization of the orthogonal projection can restrict the approximation space 
                           
                              
                                 
                                    X
                                 
                                 
                                    h
                                 
                              
                           
                         for high values of k.

To circumvent this issue while retaining the single field approach, in Section 2.3 we apply a displacement-only formulation introduced by Bercovier [50] and others [48,49] which uses a localized discrete orthogonal projection operator, 
                           
                              
                                 
                                    π
                                 
                                 
                                    
                                       
                                          W
                                       
                                       
                                          loc
                                       
                                    
                                 
                              
                           
                        . Similar to augmented Lagrangian and reduced integration techniques [26], the aim of the discrete projection is to weaken the compressible/incompressible constraint, thereby enhancing the approximation space in the limit as k gets large. Furthermore, by appropriate restructuring of the weakly penalized system, we avoid the poor nonlinear convergence for high bulk modulus associated with displacement-only formulations. As shown in Figs. 4 and 6, the weakly penalized formulation restores convergence behavior while maintaining the simplicity of a single field approach. Finally, viewing the various methods under the same generalized framework allows us to extend the SNR modifications of the weakly penalized form to the penalty approach, significantly improving the computational performance of the scheme.

A convenient feature of the weakly penalized approach is that it enables more straightforward analysis by tapping into known finite element spaces. Though for uniqueness inf–sup stability is not necessary, this condition ensures optimal convergence in the null space of 
                           
                              
                                 
                                    π
                                 
                                 
                                    W
                                 
                              
                           
                         for linear problems, for appropriately chosen spaces. In the examples presented here, the projection was chosen to be one polynomial order less and piece-wise discontinuous. Though this pairing is not inf–sup stable, for the quadrilateral and hexahedral elements considered, this restored convergence. Another convenient choice are Nicolaides–Boland [60] elements, which give consistent results to those presented here.

@&#CONCLUSION@&#

In this paper we compared the use of different methods for approximating incompressible and compressible tissue mechanics in the heart. Noting that the choice of model is governed by both model validity and numerical considerations, we assessed the use of Lagrange (LM and PL) and penalty methods as models of both incompressible and compressible behavior. Motivated by the classic locking phenomena observed for linear mechanics [26,27], we apply an enhancement of the Bercovier [50] formulation which enables the single field approach while providing similar convergence behavior to the LM method. To the best of our knowledge this is the first application of this approach on heart models.

Observing the convergence behavior of these methods on a simple solid mechanics test and on cardiac models, we highlight the fact that the LM and penalty methods, although often used equivalently in cardiac mechanics, may present significant variations in results. This is due to the well-known deterioration of the convergence behavior of the penalty method for large values of the bulk modulus. Indeed in both the 2D elongation problem and the cardiac models, the penalty method generally has a larger error than the other two methods for all values of the bulk modulus. In contrast, the single field weakly penalized approach provides both improved rates of convergence and avoids issues associated with locking phenomena over these test problems. Further modifications introduced in this work enhance the computational performance of the numerical scheme, by allowing efficient application of the SNR re-use strategy and significantly reducing the computational time. The weakly penalized formulation can therefore provide an accurate and computationally inexpensive method that can be used to deal with incompressibility and near incompressibility in problems of cardiac mechanics and solid mechanics in general.

@&#ACKNOWLEDGEMENTS@&#

The authors would like to acknowledge funding from the British Heart Foundation (NH/11/5/29058). We also acknowledge the support from the Wellcome Trust-EPSRC Centre of Excellence in Medical Engineering (WT 088641/Z/09/Z) and the NIHR Biomedical Research Centre at Guy’s and St.Thomas’ NHS Foundation Trust and KCL. The views expressed are those of the authors and not necessarily those of the NHS, the NIHR, or the DoH.

The aim of this section is to provide the discrete weak forms of the formulations implemented and used in this work. A detailed derivation of the weak forms of the penalty, LM and PL methods is provided in various textbooks [45,29]. Specifically, the weak form for the penalty method is acquired by requiring that the directional derivative of the penalty functional 
                        
                           
                              
                                 Π
                              
                              
                                 k
                              
                           
                        
                      vanishes for all arbitrary directions 
                        
                           δ
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                        
                      in the homogeneous zero Dirichlet space 
                        
                           
                              
                                 X
                              
                              
                                 0
                              
                              
                                 h
                              
                           
                        
                     , i.e.
                     
                        
                           (A.1)
                           
                              D
                              
                                 
                                    Π
                                 
                                 
                                    k
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              [
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ]
                              =
                              0
                              ,
                              
                              ∀
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                                 
                                    h
                                 
                              
                              .
                           
                        
                     Similarly, the PL method requires that,
                        
                           (A.2)
                           
                              D
                              
                                 
                                    Π
                                 
                                 
                                    λ
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    λ
                                 
                                 
                                    h
                                 
                              
                              )
                              [
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    q
                                 
                                 
                                    h
                                 
                              
                              ]
                              =
                              0
                           
                        
                     for every 
                        
                           (
                           δ
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           ,
                           δ
                           
                              
                                 q
                              
                              
                                 h
                              
                           
                           )
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                              
                                 h
                              
                           
                           ×
                           
                              
                                 W
                              
                              
                                 h
                              
                           
                        
                     . The discrete weak forms for the penalty, PL and LM systems can also be written in operator notation as,
                        
                           (A.3)
                           
                              A
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              +
                              P
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              =
                              F
                              (
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (A.4)
                           
                              A
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              +
                              B
                              (
                              
                                 
                                    p
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              +
                              
                                 
                                    B
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    p
                                 
                                 
                                    h
                                 
                              
                              )
                              -
                              
                                 
                                    1
                                 
                                 
                                    k
                                 
                              
                              M
                              (
                              
                                 
                                    p
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    p
                                 
                                 
                                    h
                                 
                              
                              )
                              =
                              F
                              (
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              ,
                           
                        
                     
                     
                        
                           (A.5)
                           
                              A
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              +
                              B
                              (
                              
                                 
                                    p
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              +
                              
                                 
                                    B
                                 
                                 
                                    ^
                                 
                              
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              δ
                              
                                 
                                    p
                                 
                                 
                                    h
                                 
                              
                              )
                              =
                              F
                              (
                              δ
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              ,
                           
                        
                     where the operators 
                        
                           A
                           ,
                           P
                           ,
                           F
                           ,
                           B
                           ,
                           
                              
                                 B
                              
                              
                                 ^
                              
                           
                           ,
                           M
                        
                     , and C are defined as,
                        
                           
                              
                                 
                                    
                                    
                                       
                                          A
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                          
                                          
                                             
                                                S
                                             
                                             
                                                h
                                             
                                          
                                          :
                                          ∇
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          dV
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          P
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                kJ
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                          -
                                          1
                                          )
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                -
                                                T
                                             
                                          
                                          :
                                          ∇
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          dV
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          F
                                          (
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          f
                                          ·
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          dV
                                          +
                                          
                                             ∫
                                             
                                                ∂
                                                Ω
                                             
                                          
                                          t
                                          ·
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          dA
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          B
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                h
                                             
                                          
                                          
                                             
                                                J
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                h
                                             
                                             
                                                -
                                                T
                                             
                                          
                                          :
                                          ∇
                                          δ
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          dV
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                ^
                                             
                                          
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          δ
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          δ
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          (
                                          
                                             
                                                J
                                             
                                             
                                                
                                                   
                                                      u
                                                   
                                                   
                                                      h
                                                   
                                                
                                             
                                          
                                          -
                                          1
                                          )
                                          dV
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          M
                                          (
                                          
                                             
                                                λ
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          δ
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          )
                                          =
                                          
                                             ∫
                                             
                                                Ω
                                             
                                          
                                          
                                             
                                                λ
                                             
                                             
                                                h
                                             
                                          
                                          δ
                                          
                                             
                                                q
                                             
                                             
                                                h
                                             
                                          
                                          dV
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 F
                              
                              
                                 h
                              
                           
                           =
                           ∇
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           +
                           I
                        
                      and 
                        
                           
                              
                                 S
                              
                              
                                 h
                              
                           
                        
                      represent the discrete deformation gradient and second Piola stress tensors, respectively.

The Jacobian of these formulations is then derived by taking the directional derivative of the discrete weak forms with respect to displacement (and pressure). For the penalty method, the Jacobian can not be derived analytically due to the nonlinearity of hyperelastic laws and is usually estimated by the finite difference approximation of the gradient of the operators 
                        
                           A
                           ,
                           P
                        
                      and F:
                        
                           (A.6)
                           
                              
                                 
                                    J
                                 
                                 
                                    k
                                 
                              
                              =
                              A
                              +
                              P
                              ,
                           
                        
                     
                     
                        
                           
                              
                                 
                                    [
                                    A
                                    ]
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    ∊
                                 
                              
                              
                                 
                                    
                                       A
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       +
                                       ∊
                                       
                                          
                                             ϕ
                                          
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       F
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       +
                                       ∊
                                       
                                          
                                             ϕ
                                          
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       -
                                       A
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       -
                                       ∊
                                       
                                          
                                             ϕ
                                          
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                       +
                                       F
                                       (
                                       
                                          
                                             u
                                          
                                          
                                             h
                                          
                                       
                                       -
                                       ∊
                                       
                                          
                                             ϕ
                                          
                                          
                                             u
                                          
                                          
                                             j
                                          
                                       
                                       ,
                                       
                                          
                                             ϕ
                                          
                                          
                                             i
                                          
                                       
                                       )
                                    
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (A.7)
                           
                              
                                 
                                    [
                                    P
                                    ]
                                 
                                 
                                    ij
                                 
                              
                              =
                              
                                 
                                    1
                                 
                                 
                                    ∊
                                 
                              
                              (
                              P
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              +
                              ∊
                              
                                 
                                    ϕ
                                 
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              )
                              -
                              P
                              (
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              -
                              ∊
                              
                                 
                                    ϕ
                                 
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    i
                                 
                              
                              )
                              )
                              ,
                           
                        
                     where we note that, the operator F is included in the Jacobian estimation as it often depends on 
                        
                           u
                        
                     .

The Jacobian of the PL method is written in matrix form as
                        
                           (A.8)
                           
                              
                                 
                                    J
                                 
                                 
                                    PL
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                B
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      -
                                                      1
                                                   
                                                   
                                                      k
                                                   
                                                
                                                M
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where the block matrices 
                        
                           A
                           ,
                           
                           B
                        
                      and 
                        
                           
                              
                                 B
                              
                              
                                 ^
                              
                           
                        
                      are defined as
                        
                           (A.9)
                           
                              
                                 
                                    
                                    
                                       
                                          
                                             
                                                [
                                                A
                                                ]
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          
                                             
                                                1
                                             
                                             
                                                ∊
                                             
                                          
                                          
                                             
                                                
                                                   A
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   +
                                                   ∊
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   +
                                                   B
                                                   (
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   +
                                                   ∊
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   F
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   +
                                                   ∊
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   A
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   -
                                                   ∊
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   -
                                                   B
                                                   (
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   -
                                                   ∊
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                   +
                                                   F
                                                   (
                                                   
                                                      
                                                         u
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   -
                                                   ∊
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         u
                                                      
                                                      
                                                         j
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         ϕ
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                    
                                       
                                          
                                             
                                                [
                                                B
                                                ]
                                             
                                             
                                                ij
                                             
                                          
                                          =
                                          B
                                          (
                                          
                                             
                                                ϕ
                                             
                                             
                                                w
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                             
                                                u
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          
                                             
                                                ϕ
                                             
                                             
                                                u
                                             
                                             
                                                i
                                             
                                          
                                          )
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     
                     
                        
                           (A.10)
                           
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          ^
                                       
                                    
                                    ]
                                 
                                 
                                    ij
                                 
                              
                              =
                              B
                              (
                              
                                 
                                    ϕ
                                 
                                 
                                    w
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              ,
                              
                                 
                                    ϕ
                                 
                                 
                                    u
                                 
                                 
                                    j
                                 
                              
                              )
                              ,
                           
                        
                     The block matrix 
                        
                           M
                        
                      is the mass matrix defined in Eq. (20).

The Jacobian matrix of the LM formulation can be derived from the Jacobian of the PL formulation by assuming 
                        
                           k
                           →
                           ∞
                        
                     , as
                        
                           (A.11)
                           
                              
                                 
                                    J
                                 
                                 
                                    λ
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                B
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ^
                                                   
                                                
                                             
                                             
                                                0
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where the 
                        
                           0
                        
                      block matrix results in a non-positive definite Jacobian matrix which may cause numerical difficulties.

In this section we present an error estimate for the generalized weakly penalized form and illustrate how this may be used to derive estimates for the Perturbed Lagrangian, incompressible and/or nearly incompressible forms. For ease, a linear elastic material is considered with Homogenous Dirichlet boundary conditions, giving the continuous weakly penalized problem: find 
                        
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                           =
                           {
                           u
                           ∈
                           
                              
                                 [
                                 
                                    
                                       H
                                    
                                    
                                       1
                                    
                                 
                                 (
                                 Ω
                                 )
                                 ]
                              
                              
                                 d
                              
                           
                           |
                           u
                           =
                           0
                           
                           on
                           
                           Γ
                           }
                        
                      such that,
                        
                           (B.1)
                           
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    EDu
                                 
                                 
                                    k
                                 
                              
                              :
                              Dw
                              dV
                              +
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              k
                              π
                              (
                              ∇
                              ·
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                              
                              )
                              ∇
                              ·
                              w
                              dV
                              =
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              f
                              ·
                              w
                              dV
                              ,
                              
                              ∀
                              w
                              ∈
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                              
                              ,
                           
                        
                     where 
                        
                           E
                           :
                           Ω
                           →
                           
                              
                                 R
                              
                              
                                 d
                                 ×
                                 d
                              
                           
                        
                      is the elasticity tensor, 
                        
                           D
                           (
                           ·
                           )
                           =
                           1
                           /
                           2
                           (
                           ∇
                           (
                           ·
                           )
                           +
                           (
                           ·
                           )
                           ∇
                           )
                           ,
                           k
                           >
                           0
                        
                      is the bulk modulus of the material, 
                        
                           π
                        
                      the projection operator (in this case the 
                        
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                        
                      projection) and 
                        
                           f
                           ∈
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                        
                      is given data. Here we assume 
                        
                           E
                        
                      is a symmetric positive definite matrix satisfying, for any 
                        
                           v
                           ,
                           w
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                        
                     , the linear coercivity and continuity conditions (where 
                        
                           ‖
                           ·
                           
                              
                                 ‖
                              
                              
                                 1
                              
                           
                        
                      is the norm on 
                        
                           
                              
                                 H
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                        
                     ),
                        
                           (B.2)
                           
                              α
                              ‖
                              v
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              ⩽
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              EDv
                              :
                              Dv
                              dV
                              ,
                              
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              EDv
                              :
                              Dw
                              dV
                              ⩽
                              γ
                              ‖
                              v
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              ‖
                              w
                              
                                 
                                    ‖
                                 
                                 
                                    1
                                 
                              
                              .
                           
                        
                     We note that here, given 
                        
                           u
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                           (
                           Ω
                           )
                        
                     , using Korn’s inequality [71] there exists an equivalence between 
                        
                           ‖
                           Dv
                           ‖
                        
                      and 
                        
                           ‖
                           v
                           
                              
                                 ‖
                              
                              
                                 1
                              
                           
                        
                      (which, for ease, are included in these bounds). Due to the coercivity/continuity conditions, the existence and uniqueness of solutions is ensured by Lax–Milgram lemma [61].

Noting that the space 
                        
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                           =
                           
                              
                                 X
                              
                              
                                 0
                                 ,
                                 div
                              
                           
                           ⊕
                           
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                 
                                 )
                              
                              
                                 ⊥
                              
                           
                        
                      (with 
                        
                           
                              
                                 X
                              
                              
                                 0
                                 ,
                                 div
                              
                           
                           =
                           
                              
                                 H
                              
                              
                                 0
                                 ,
                                 div
                              
                              
                                 1
                              
                           
                           (
                           Ω
                           )
                        
                     ) is separable into divergence free and non-divergence free functions, we may also write 
                        
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                           =
                           
                              
                                 u
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           +
                           (
                           1
                           /
                           k
                           )
                           
                              
                                 u
                              
                              
                                 k
                              
                              
                                 ⊥
                              
                           
                        
                      with 
                        
                           
                              
                                 u
                              
                              
                                 k
                              
                              
                                 ∗
                              
                           
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                                 ,
                                 div
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 k
                              
                              
                                 ⊥
                              
                           
                           ∈
                           
                              
                                 (
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                 
                                 )
                              
                              
                                 ⊥
                              
                           
                        
                     , which satisfies,
                        
                           (B.3)
                           
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              ED
                              
                                 
                                    
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                          
                                             ∗
                                          
                                       
                                       +
                                       
                                          
                                             1
                                          
                                          
                                             k
                                          
                                       
                                       
                                          
                                             u
                                          
                                          
                                             k
                                          
                                          
                                             ⊥
                                          
                                       
                                    
                                 
                              
                              :
                              Dw
                              dV
                              +
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              π
                              (
                              ∇
                              ·
                              
                                 
                                    u
                                 
                                 
                                    k
                                 
                                 
                                    ⊥
                                 
                              
                              )
                              ∇
                              ·
                              w
                              dV
                              =
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              f
                              ·
                              w
                              dV
                              ,
                              
                              ∀
                              w
                              ∈
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                              
                              .
                           
                        
                     The weakly penalized form introduced in Eq. (B.1) can be easily related to the equivalent continuous Perturbed Lagrangian, Penalty and Lagrange Multiplier forms (with appropriate selection of k). As any 
                        
                           w
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                        
                      satisfies 
                        
                           ∇
                           ·
                           w
                           ∈
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                        
                     , it is clear that 
                        
                           π
                           (
                           ∇
                           ·
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                           )
                           =
                           ∇
                           ·
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                        
                     . Inserting this relation into Eq. (B.1) yields the continuous penalty form. Moreover, from the continuous constraint of the Perturbed Lagrangian we observe that 
                        
                           π
                           (
                           ∇
                           ·
                           
                              
                                 u
                              
                              
                                 k
                              
                           
                           )
                           =
                           λ
                           /
                           k
                        
                      (or 
                        
                           π
                           (
                           ∇
                           ·
                           
                              
                                 u
                              
                              
                                 k
                              
                              
                                 ⊥
                              
                           
                           )
                           =
                           λ
                        
                     ), enabling condensation of the PL form into the weakly penalized variant. Finally, in the limit as 
                        
                           k
                           →
                           ∞
                        
                      it is clear that in Eq. (B.1) 
                     
                        
                           u
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                                 ,
                                 div
                              
                           
                        
                     , yielding equivalence with the LM form [50].

In the following, we shall consider an error estimate for the discrete weakly penalized problem: find 
                        
                           
                              
                                 u
                              
                              
                                 h
                              
                           
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                              
                                 h
                              
                           
                           ⊂
                           
                              
                                 X
                              
                              
                                 0
                              
                           
                        
                      such that,
                        
                           (B.4)
                           
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    EDu
                                 
                                 
                                    h
                                 
                              
                              :
                              
                                 
                                    Dw
                                 
                                 
                                    h
                                 
                              
                              dV
                              +
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    k
                                 
                                 
                                    h
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              (
                              ∇
                              ·
                              
                                 
                                    u
                                 
                                 
                                    h
                                 
                              
                              )
                              ∇
                              ·
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                              
                              dV
                              =
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              f
                              ·
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                              
                              dV
                              ,
                              
                              ∀
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                              
                              ∈
                              
                                 
                                    X
                                 
                                 
                                    0
                                 
                                 
                                    h
                                 
                              
                              ,
                           
                        
                     where 
                        
                           E
                        
                      is the elasticity tensor and initial data 
                        
                           f
                        
                      are defined as above. Here we let 
                        
                           
                              
                                 k
                              
                              
                                 h
                              
                           
                           >
                           0
                        
                      denote the bulk modulus of the discrete model, acknowledging that we may choose (for numerical convenience, for example) to compute solutions using a bulk modulus which is different from the continuous model (i.e. 
                     
                        
                           
                              
                                 k
                              
                              
                                 h
                              
                           
                           
                           ≠
                           
                           k
                        
                     ). Further, we consider
                        
                           (B.5)
                           
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              :
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              →
                              S
                              ⊆
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              ,
                           
                        
                     to be the 
                        
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                        
                      projection operator onto the subspace 
                        
                           S
                           ⊆
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                        
                     . As a consequence, it is clear that,
                        
                           (B.6)
                           
                              ‖
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              (
                              g
                              )
                              ‖
                              ⩽
                              ‖
                              g
                              ‖
                              ,
                              
                              g
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              ,
                           
                        
                     (where 
                        
                           ‖
                           ·
                           ‖
                        
                      denotes the 
                        
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                        
                      norm). Moreover, due to symmetry in the discrete projection, for any 
                        
                           
                              
                                 v
                              
                              
                                 h
                              
                           
                           ,
                           
                              
                                 w
                              
                              
                                 h
                              
                           
                           ∈
                           
                              
                                 X
                              
                              
                                 0
                              
                              
                                 h
                              
                           
                        
                     ,
                        
                           (B.7)
                           
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              (
                              ∇
                              ·
                              
                                 
                                    v
                                 
                                 
                                    h
                                 
                              
                              )
                              ∇
                              ·
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                              
                              dV
                              =
                              
                                 ∫
                                 
                                    Ω
                                 
                              
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              (
                              ∇
                              ·
                              
                                 
                                    v
                                 
                                 
                                    h
                                 
                              
                              )
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              (
                              ∇
                              ·
                              
                                 
                                    w
                                 
                                 
                                    h
                                 
                              
                              )
                              dV
                              .
                           
                        
                     From Eqs. (B.2), (B.6) and (B.7), the discrete form retains continuity and coercivity yielding a unique solution as in the continuous case. Similar to above, equivalence of this form to other methods (in their discrete form) can be obtained with appropriate selections of 
                        
                           (
                           S
                           ,
                           
                              
                                 k
                              
                              
                                 h
                              
                           
                           )
                        
                     , i.e. LM 
                        
                           (
                           
                              
                                 W
                              
                              
                                 h
                              
                           
                           ,
                           ∞
                           )
                        
                     , PL 
                        
                           (
                           
                              
                                 W
                              
                              
                                 h
                              
                           
                           ,
                           k
                           )
                        
                     , and Penalty 
                        
                           (
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                           ,
                           k
                           )
                        
                     .

Finally, we may derive the following error estimate between the weakly penalized form in Eq. (B.4) and the continuous form introduced in Eq. (B.1).
                        Lemma 1
                        
                           Let 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                              
                            
                           be the solutions to Eqs. 
                           
                              (B.1) and (B.4)
                           
                           , with 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 (
                                 1
                                 /
                                 k
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       ⊥
                                    
                                 
                              
                            
                           with 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       ∗
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                    
                                       ⊥
                                    
                                 
                                 ∈
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             0
                                             ,
                                             div
                                          
                                       
                                       )
                                    
                                    
                                       ⊥
                                    
                                 
                              
                           
                           . Then the difference between discrete and continuous solutions (when 
                           
                              
                                 k
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                              
                           
                           ) is given by,
                           
                              
                                 (B.8)
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    C
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         0
                                                         ,
                                                         div
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     0
                                                                     ,
                                                                     div
                                                                  
                                                                  
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⊥
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             )
                                             -
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             ‖
                                             +
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           where 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                    
                                       h
                                    
                                 
                                 ⊕
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             0
                                             ,
                                             div
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    
                                       ⊥
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                    
                                       h
                                    
                                 
                                 ≔
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                    
                                       h
                                    
                                 
                                 |
                                 
                                 ‖
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                                 (
                                 ∇
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 ‖
                                 =
                                 0
                                 }
                              
                            
                           are the discrete projected null and perpendicular spaces, respectively. When 
                           
                              
                                 k
                                 
                                 ≠
                                 
                                 
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                              
                           
                           ,
                           
                              
                                 (B.9)
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          C
                                       
                                       
                                          0
                                       
                                    
                                    
                                       max
                                    
                                    
                                       
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   k
                                                
                                             
                                             ,
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           with 
                           
                              
                                 C
                                 ,
                                 
                                    
                                       C
                                    
                                    
                                       0
                                    
                                 
                                 >
                                 0
                              
                            
                           being positive constants independent of h.
                        

Selecting 
                              
                                 w
                                 =
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                              
                            in Eq. (B.1) and noting equality of the RHS with Eq. (B.4), it is clear that,
                              
                                 (B.10)
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          EDu
                                       
                                       
                                          h
                                       
                                    
                                    :
                                    
                                       
                                          Dw
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    )
                                    ∇
                                    ·
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          EDu
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    :
                                    
                                       
                                          Dw
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    π
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    )
                                    ∇
                                    ·
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    .
                                 
                              
                           Letting 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                              
                            and 
                              
                                 e
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                              
                            for some 
                              
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                    
                                       h
                                    
                                 
                              
                           , we may express Eq. (B.10) as,
                              
                                 (B.11)
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    ED
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    :
                                    
                                       
                                          Dw
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    )
                                    ∇
                                    ·
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    =
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    EDe
                                    :
                                    
                                       
                                          Dw
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    e
                                    )
                                    ∇
                                    ·
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    [
                                    π
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    )
                                    ]
                                    ∇
                                    ·
                                    
                                       
                                          w
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    .
                                 
                              
                           Selecting 
                              
                                 
                                    
                                       w
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       ε
                                    
                                    
                                       h
                                    
                                 
                              
                           , applying the coercivity/continuity conditions in Eq. (B.2), Cauchy Schwarz Inequality and noting the symmetry condition in Eqs. (B.7) and (B.11), (B.11) may be further reduced,
                              
                                 (B.12)
                                 
                                    α
                                    ‖
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                       
                                          2
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    ‖
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    )
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    ⩽
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    EDe
                                    :
                                    D
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    e
                                    )
                                    ∇
                                    ·
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    +
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    [
                                    π
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    ∇
                                    ·
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    )
                                    ]
                                    ∇
                                    ·
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    dV
                                    ⩽
                                    γ
                                    ‖
                                    e
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ‖
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             e
                                             )
                                             ‖
                                             +
                                             ‖
                                             π
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             ‖
                                          
                                       
                                    
                                    ‖
                                    ∇
                                    ·
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    ‖
                                    .
                                 
                              
                           Noting 
                              
                                 ‖
                                 ∇
                                 ·
                                 w
                                 ‖
                                 ⩽
                                 
                                    
                                       d
                                    
                                 
                                 ‖
                                 w
                                 
                                    
                                       ‖
                                    
                                    
                                       1
                                    
                                 
                              
                            for any 
                              
                                 w
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                 
                              
                           , Eq. (B.12) yields,
                              
                                 (B.13)
                                 
                                    α
                                    ‖
                                    
                                       
                                          ε
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    γ
                                    ‖
                                    e
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             e
                                             )
                                             ‖
                                             +
                                             ‖
                                             π
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             ‖
                                          
                                       
                                    
                                    .
                                 
                              
                           Further, observing that 
                              
                                 
                                    
                                       ε
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       h
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 +
                                 e
                              
                            and applying the reverse triangle inequality,
                              
                                 (B.14)
                                 
                                    α
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    (
                                    γ
                                    +
                                    α
                                    )
                                    ‖
                                    e
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          d
                                       
                                    
                                    
                                       
                                          k
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             e
                                             )
                                             ‖
                                             +
                                             ‖
                                             π
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             ‖
                                          
                                       
                                    
                                    .
                                 
                              
                           Finally, splitting 
                              
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ≔
                                 
                                    
                                       y
                                    
                                    
                                       h
                                    
                                 
                                 +
                                 (
                                 1
                                 /
                                 
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 
                                    
                                       z
                                    
                                    
                                       h
                                    
                                 
                              
                            where 
                              
                                 (
                                 
                                    
                                       y
                                    
                                    
                                       h
                                    
                                 
                                 ,
                                 
                                    
                                       z
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                    
                                       h
                                    
                                 
                                 ×
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             0
                                             ,
                                             div
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    
                                       ⊥
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       ∗
                                    
                                 
                                 +
                                 (
                                 1
                                 /
                                 
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                                 )
                                 
                                    
                                       u
                                    
                                    
                                       
                                          
                                             k
                                          
                                          
                                             h
                                          
                                       
                                    
                                    
                                       ⊥
                                    
                                 
                              
                            as in Eq. (B.3) and applying the triangle inequality,
                              
                                 (B.15)
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          (
                                          γ
                                          +
                                          α
                                          )
                                       
                                       
                                          α
                                       
                                    
                                    ‖
                                    e
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          α
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             e
                                             )
                                             ‖
                                             +
                                             ‖
                                             π
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             )
                                             ‖
                                          
                                       
                                    
                                    .
                                    ⩽
                                    
                                       
                                          (
                                          γ
                                          +
                                          α
                                          )
                                       
                                       
                                          α
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   1
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                d
                                             
                                          
                                       
                                       
                                          α
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             [
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   h
                                                
                                             
                                             ]
                                             )
                                             ‖
                                             +
                                             ‖
                                             π
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             )
                                             ‖
                                          
                                       
                                    
                                    .
                                    ⩽
                                    C
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            
                                                               
                                                                  k
                                                               
                                                               
                                                                  h
                                                               
                                                            
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             ‖
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             )
                                             ‖
                                          
                                       
                                    
                                    .
                                 
                              
                           where 
                              
                                 C
                                 =
                                 max
                                 {
                                 d
                                 /
                                 α
                                 ,
                                 (
                                 γ
                                 +
                                 α
                                 )
                                 /
                                 α
                                 }
                              
                           . Taking the infimum, we arrive at the first result of Lemma 1. The second result follows directly from [50] where the error between 
                              
                                 
                                    
                                       u
                                    
                                    
                                       ∞
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       u
                                    
                                    
                                       k
                                    
                                 
                              
                            satisfies the estimate,
                              
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ∞
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    C
                                    /
                                    k
                                 
                              
                           for any 
                              
                                 k
                                 >
                                 0
                              
                           . Consequently,
                              
                                 (B.16)
                                 
                                    C
                                    /
                                    k
                                    ⩾
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ∞
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ∞
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩾
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ∞
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ∞
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩾
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          k
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          ∞
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           which may be re-arranged to show the final result. 
                           
                              
                                 □
                              
                           
                        

The error estimate presented in Lemma 1 enables us to interpret the error for any choice of 
                        
                           (
                           S
                           ,
                           
                              
                                 k
                              
                              
                                 h
                              
                           
                           )
                        
                      and k, enabling the derivation of different permutations. A case of particular interest occurs when the projection 
                        
                           
                              
                                 π
                              
                              
                                 h
                              
                           
                        
                      is defined on a space S which satisfies the inf–sup condition, i.e. there is a 
                        
                           β
                           >
                           0
                        
                      such that [50,59,26,61],
                        
                           (B.17)
                           
                              
                                 
                                    
                                       sup
                                    
                                    
                                       
                                          
                                             v
                                          
                                          
                                             h
                                          
                                       
                                       ∈
                                       
                                          
                                             X
                                          
                                          
                                             0
                                          
                                          
                                             h
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       ∫
                                       
                                          Ω
                                       
                                    
                                    
                                       
                                          π
                                       
                                       
                                          h
                                       
                                    
                                    (
                                    g
                                    )
                                    ∇
                                    ·
                                    
                                       
                                          v
                                       
                                       
                                          h
                                       
                                    
                                 
                                 
                                    ‖
                                    
                                       
                                          v
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                              ⩾
                              β
                              ‖
                              
                                 
                                    π
                                 
                                 
                                    h
                                 
                              
                              (
                              g
                              )
                              ‖
                              ,
                              
                              β
                              >
                              0
                              ,
                              
                              g
                              ∈
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                              (
                              Ω
                              )
                              .
                           
                        
                     In this case, the estimates in Lemma 1 may be simplified as shown in Corollary 1.
                        Corollary 1
                        
                           Using the estimate in 
                           
                              Lemma 1
                           , and supposing the subspace S corresponding to the projection operator 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                                 :
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                                 →
                                 S
                              
                            
                           is selected such that the inf–sup condition in Eq. 
                           
                              (B.17)
                            
                           holds, then the weakly penalized form satisfies (for 
                           
                              
                                 k
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                              
                           
                           ),
                           
                              
                                 (B.18)
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    C
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          ,
                                          
                                             
                                                z
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   π
                                                
                                                
                                                   h
                                                
                                             
                                             (
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             )
                                             -
                                             ∇
                                             ·
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             ‖
                                             +
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           with 
                           
                              
                                 C
                                 >
                                 0
                              
                            
                           being positive constants independent of h.
                        

From [61], we observe that the weakly divergence free subspace 
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                    
                                       h
                                    
                                 
                              
                            for a projection 
                              
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                              
                            onto a space S which satisfies the inf–sup condition satisfies,
                              
                                 (B.19)
                                 
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                                ,
                                                div
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                
                                                
                                                   β
                                                
                                             
                                             +
                                             1
                                          
                                       
                                    
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    .
                                 
                              
                           As a consequence of this extension, we also observe that,
                              
                                 
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         0
                                                         ,
                                                         div
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     X
                                                                  
                                                                  
                                                                     0
                                                                     ,
                                                                     div
                                                                  
                                                                  
                                                                     h
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         ⊥
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          h
                                       
                                    
                                    +
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ⊥
                                       
                                    
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩾
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      0
                                                      ,
                                                      div
                                                   
                                                   
                                                      h
                                                   
                                                
                                                )
                                             
                                             
                                                ⊥
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ⊥
                                       
                                    
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    -
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                                ,
                                                div
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           and hence
                              
                                 (B.20)
                                 
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                (
                                                
                                                   
                                                      X
                                                   
                                                   
                                                      0
                                                      ,
                                                      div
                                                   
                                                   
                                                      h
                                                   
                                                
                                                )
                                             
                                             
                                                ⊥
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ⊥
                                       
                                    
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                z
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ⊥
                                       
                                    
                                    -
                                    
                                       
                                          z
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         d
                                                      
                                                   
                                                
                                                
                                                   β
                                                
                                             
                                             +
                                             2
                                          
                                       
                                    
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                y
                                             
                                             
                                                h
                                             
                                          
                                          ∈
                                          
                                             
                                                X
                                             
                                             
                                                0
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                       
                                          ∗
                                       
                                    
                                    -
                                    
                                       
                                          y
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                 
                              
                           enabling the extension seen in the corollary. 
                           
                              
                                 □
                              
                           
                        

From Corollary 1, it is clear that, when the inf–sup condition holds, optimal convergence rates may be obtained by applying standard interpolation theory for 
                        
                           
                              
                                 X
                              
                              
                                 0
                              
                              
                                 h
                              
                           
                        
                      and the projection 
                        
                           
                              
                                 π
                              
                              
                                 h
                              
                           
                           :
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                           →
                           S
                        
                     . While the PL, LM and weakly penalized forms may exploit this, the penalty formulation is subject to stricter conditions on 
                        
                           
                              
                                 π
                              
                              
                                 h
                              
                           
                        
                     , namely 
                        
                           
                              
                                 π
                              
                              
                                 h
                              
                           
                           :
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                           →
                           
                              
                                 L
                              
                              
                                 2
                              
                           
                           (
                           Ω
                           )
                        
                     . Consequently, the error bound for this projection may be expressed as seen in Corollary 2.
                        Corollary 2
                        
                           Using the estimate in 
                           
                              Lemma 1
                           , and supposing the subspace 
                           
                              
                                 S
                                 =
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                              
                            
                           corresponding to the projection operator 
                           
                              
                                 
                                    
                                       π
                                    
                                    
                                       h
                                    
                                 
                                 :
                                 
                                    
                                       L
                                    
                                    
                                       2
                                    
                                 
                                 (
                                 Ω
                                 )
                                 →
                                 S
                              
                            
                           is selected, then the weakly penalized form satisfies (for 
                           
                              
                                 k
                                 =
                                 
                                    
                                       k
                                    
                                    
                                       h
                                    
                                 
                              
                           
                           ),
                           
                              
                                 (B.21)
                                 
                                    ‖
                                    
                                       
                                          u
                                       
                                       
                                          
                                             
                                                k
                                             
                                             
                                                h
                                             
                                          
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          h
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          1
                                       
                                    
                                    ⩽
                                    C
                                    
                                       
                                          inf
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         y
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         X
                                                      
                                                      
                                                         0
                                                         ,
                                                         div
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         z
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                   ∈
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               X
                                                            
                                                            
                                                               0
                                                               ,
                                                               div
                                                            
                                                            
                                                               h
                                                            
                                                         
                                                         )
                                                      
                                                      
                                                         ⊥
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ∗
                                                
                                             
                                             -
                                             
                                                
                                                   y
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            k
                                                         
                                                      
                                                      +
                                                      1
                                                   
                                                
                                             
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   
                                                      
                                                         k
                                                      
                                                      
                                                         h
                                                      
                                                   
                                                
                                                
                                                   ⊥
                                                
                                             
                                             -
                                             
                                                
                                                   z
                                                
                                                
                                                   h
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   1
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           
                           where 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                    
                                       h
                                    
                                 
                                 =
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                    
                                       h
                                    
                                 
                                 ⊕
                                 
                                    
                                       (
                                       
                                          
                                             X
                                          
                                          
                                             0
                                             ,
                                             div
                                          
                                          
                                             h
                                          
                                       
                                       )
                                    
                                    
                                       ⊥
                                    
                                 
                              
                            
                           and 
                           
                              
                                 
                                    
                                       X
                                    
                                    
                                       0
                                       ,
                                       div
                                    
                                    
                                       h
                                    
                                 
                                 ≔
                                 {
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ∈
                                 
                                    
                                       X
                                    
                                    
                                       0
                                    
                                    
                                       h
                                    
                                 
                                 |
                                 
                                 ‖
                                 ∇
                                 ·
                                 
                                    
                                       v
                                    
                                    
                                       h
                                    
                                 
                                 ‖
                                 =
                                 0
                                 }
                              
                           
                           .
                        

Here we note that 
                        
                           
                              
                                 X
                              
                              
                                 0
                                 ,
                                 div
                              
                              
                                 h
                              
                           
                        
                      in Corollary 2 can be quite restrictive, yielding deterioration in the rate of convergence.

As mentioned before, the weakly penalized formulation is a generalization of the PL method, and as such should be able to present similar nonlinear behavior. To this end, the residual of the weakly penalized approach in Sections 2.5.3 and 2.5.4 is modified based on the residual derived from the PL method, in order to achieve the same nonlinear convergence. The static condensation used in the weakly penalized system follows the linear algebra used in this section in order to eliminate the pressure variable from the PL formulation. We can therefore use the PL formulation in order to study and understand the sources of poor nonlinear convergence for the weakly penalized formulation.

For later comparison, we first present the linearized system for the weakly penalized formulation, when the SNR scheme is applied, without the modifications introduced in this work. Based on Eq. (32), the update 
                        
                           δ
                           
                              
                                 U
                              
                              
                                 n
                              
                           
                        
                      for the 
                        
                           
                              
                                 n
                              
                              
                                 th
                              
                           
                        
                      iteration of the weakly penalized formulation is given by
                        
                           (C.1)
                           
                              J
                              (
                              
                                 
                                    U
                                 
                                 
                                    β
                                 
                              
                              )
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                              =
                              -
                              R
                              (
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                              )
                              ,
                           
                        
                     where the Jacobian is computed at a previous iteration 
                        
                           β
                        
                      (the parameter 
                        
                           
                              
                                 α
                              
                              
                                 n
                              
                           
                        
                      will be added in later through the minimization step). Using Eq. (34), the linearized system for the weakly penalized formulation can be written as
                        
                           (C.2)
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    β
                                 
                              
                              +
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    β
                                 
                              
                              )
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                              =
                              -
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                              
                              (
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                              )
                              +
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              .
                           
                        
                     The linearized system for the 
                        
                           
                              
                                 (
                                 n
                                 +
                                 1
                                 )
                              
                              
                                 th
                              
                           
                        
                      iteration of the PL method when the SNR scheme (Section 2.5.4) is applied, can be expressed as
                        
                           (C.3)
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      β
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            β
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      T
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      β
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      -
                                                      1
                                                   
                                                   
                                                      k
                                                   
                                                
                                                M
                                             
                                          
                                       
                                    
                                 
                              
                              
                                 
                                    
                                       
                                          
                                             
                                                δ
                                                
                                                   
                                                      U
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                δ
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              =
                              
                                 
                                    
                                       
                                          
                                             
                                                -
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      A
                                                   
                                                   
                                                      n
                                                   
                                                
                                                -
                                                
                                                   
                                                      [
                                                      
                                                         
                                                            B
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ]
                                                   
                                                   
                                                      T
                                                   
                                                
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                          
                                             
                                                -
                                                
                                                   
                                                      R
                                                   
                                                   
                                                      J
                                                   
                                                   
                                                      n
                                                   
                                                
                                                +
                                                
                                                   
                                                      1
                                                   
                                                   
                                                      k
                                                   
                                                
                                                M
                                                
                                                   
                                                      p
                                                   
                                                   
                                                      n
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                              ,
                           
                        
                     where we use the Jacobian matrix of the PL system (Eq. (A.8)) computed at a previous iteration 
                        
                           β
                        
                      in the SNR iterative process. The updates for the displacement and pressure at the 
                        
                           
                              
                                 n
                              
                              
                                 th
                              
                           
                        
                      iteration are given by vectors 
                        
                           δ
                           
                              
                                 U
                              
                              
                                 n
                              
                           
                        
                      and 
                        
                           δ
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                        
                     . The right hand side of the matrix equation (C.3) denotes the residual at the 
                        
                           
                              
                                 n
                              
                              
                                 th
                              
                           
                        
                      iteration, where 
                        
                           
                              
                                 R
                              
                              
                                 A
                              
                              
                                 n
                              
                           
                        
                      denotes the residual used in Eq. (35) and 
                        
                           
                              
                                 R
                              
                              
                                 J
                              
                              
                                 n
                              
                           
                        
                      refers to the residual defined in Eq. (21).

The matrix Eq. (C.3) can be decomposed into the following equations:
                        
                           (C.4)
                           
                              
                                 
                                    A
                                 
                                 
                                    β
                                 
                              
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                              +
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              δ
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              =
                              -
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                                 
                                    n
                                 
                              
                              -
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              ,
                           
                        
                     
                     
                        
                           (C.5)
                           
                              δ
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              =
                              k
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    β
                                 
                              
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                 
                              
                              +
                              k
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              -
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              .
                           
                        
                     Combining the two equations we obtain
                        
                           (C.6)
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    β
                                 
                              
                              +
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    β
                                 
                              
                              )
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              -
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                                 
                                    n
                                 
                              
                              +
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              -
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    R
                                 
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              -
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    p
                                 
                                 
                                    n
                                 
                              
                              .
                           
                        
                     Note that if 
                        
                           β
                           =
                           n
                        
                      always, this equation matches Eq. (C.2) of the weakly penalized approach thus the convergence behavior of the two formulations should be the same.

Taking into account Eq. (C.5), we can see that 
                        
                           
                              
                                 p
                              
                              
                                 n
                              
                           
                           =
                           
                              
                                 p
                              
                              
                                 n
                                 -
                                 1
                              
                           
                           +
                           δ
                           
                              
                                 p
                              
                              
                                 n
                                 -
                                 1
                              
                           
                           =
                           k
                           
                              
                                 M
                              
                              
                                 -
                                 1
                              
                           
                           (
                           
                              
                                 B
                              
                              
                                 β
                              
                           
                           δ
                           
                              
                                 U
                              
                              
                                 n
                                 -
                                 1
                              
                           
                           +
                           
                              
                                 R
                              
                              
                                 J
                              
                              
                                 n
                                 -
                                 1
                              
                           
                           )
                        
                     , which represents the linearized estimate for 
                        
                           
                              
                                 R
                              
                              
                                 J
                              
                              
                                 n
                              
                           
                        
                     . Using this estimate,
                        
                           (C.7)
                           
                              (
                              
                                 
                                    A
                                 
                                 
                                    β
                                 
                              
                              +
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              
                                 
                                    B
                                 
                                 
                                    β
                                 
                              
                              )
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                    +
                                    1
                                 
                              
                              =
                              -
                              
                                 
                                    R
                                 
                                 
                                    A
                                 
                                 
                                    n
                                 
                              
                              -
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          n
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              
                                 
                                    B
                                 
                                 
                                    β
                                 
                              
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    R
                                 
                                 
                                    J
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              )
                              +
                              k
                              
                                 
                                    [
                                    
                                       
                                          B
                                       
                                       
                                          β
                                       
                                    
                                    ]
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    M
                                 
                                 
                                    -
                                    1
                                 
                              
                              (
                              
                                 
                                    R
                                 
                                 
                                    J
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              +
                              
                                 
                                    B
                                 
                                 
                                    β
                                 
                              
                              δ
                              
                                 
                                    U
                                 
                                 
                                    n
                                    -
                                    1
                                 
                              
                              -
                              
                                 
                                    R
                                 
                                 
                                    J
                                 
                                 
                                    n
                                 
                              
                              )
                              .
                           
                        
                     The last formulation can be used for a better understanding of the poor nonlinear convergence behavior of the weakly penalized formulation.

@&#REFERENCES@&#

