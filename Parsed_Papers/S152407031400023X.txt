@&#MAIN-TITLE@&#As-rigid-as-possible spherical parametrization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We develop model of spherical parameterization in a rigidity-preserving manner.


                        
                        
                           
                           We analyze ARAP energy from smooth description to its corresponding discrete case.


                        
                        
                           
                           We propose a iterative algorithm to efficiently solve the non-linear model.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Spherical parametrization

As-rigid-as-possible energy

Mesh processing

@&#ABSTRACT@&#


               
               
                  In this paper, we present an efficient approach for parameterizing a genus-zero triangular mesh onto the sphere with an optimal radius in an as-rigid-as-possible (ARAP) manner, which is an extension of planar ARAP parametrization approach to spherical domain. We analyze the smooth and discrete ARAP energy and formulate our spherical parametrization energy from the discrete ARAP energy. The solution is non-trivial as the energy involves a large system of non-linear equations with additional spherical constraints. To this end, we propose a two-step iterative algorithm. In the first step, we adopt a local/global iterative scheme to calculate the parametrization coordinates. In the second step, we optimize a best approximate sphere on which parametrization triangles can be embedded in a rigidity-preserving manner. Our algorithm is simple, robust, and efficient. Experimental results show that our approach provides almost isometric spherical parametrizations with lowest rigidity distortion over state-of-the-art approaches.
               
            

@&#INTRODUCTION@&#

Parametrization is essential for geometry processing and has wide applications in various fields, including texture mapping, texture synthesis, detail transfer, mesh completion, remeshing, surface approximation, scattered data fitting, and morphing, etc.

The problem of mesh parametrization is to compute a one-to-one mapping from a given mesh to a suitable domain. The most commonly used mesh is triangular mesh, and the mappings are required to be at least piecewise linear, so we only need to compute the vertex coordinates.

The parametrization of a closed genus-zero manifold triangular mesh preferably is done on its natural domain: the spherical domain. Many applications are quite sensitive to discontinuities in the parametrization, or cannot tolerate them at all. The big advantage of the spherical domain over the planar one is that it allows for seamless, continuous parametrization of genus-zero models, and there are a large number of such models in use [1].

As we have known, the common goal of parametrization is to find a mapping which minimizes some metric distortion of the original mesh. There are various types of parametrization methodologies, such as authalic (area-preserving) mapping, conformal (angle-preserving) mapping, isometric (length-preserving) mapping, and some combination of these [2]. In this paper, we aim to parameterize a genus-zero triangular mesh onto a sphere in an as-rigid-as-possible (ARAP) manner.

Specifically, we extend the ARAP planar parametrization method [2,3] to spherical domain. In the planar case, the ARAP parametrization [2] minimizes an “intrinsic” deformation energy function which can be expressed in terms of the singular values of the Jacobian of the parametrization. Unfortunately, the extension to the sphere is not straightforward. Furthermore, in sharp contrast to the planar case, we need to optimize a radius of the sphere on which parametrization triangles can be embedded on in a rigidity-preserving manner.

After we formulate the smooth ARAP spherical parametrization energy, we propose the discrete variational description of the energy. We use a two-step iterative algorithm to solve the non-linear problem with additional spherical constraints. An optimal radius of the sphere is obtained to guarantee the rigidity of the parametrization. Experimental results show that our ARAP parametrization approach always gives the lowest rigidity distortion compared with state-of-the-art approaches [4–7].

@&#RELATED WORK@&#

The problem of mesh spherical parametrization is mapping a piecewise linear surface with a discrete representation onto a spherical surface. There are many methods of spherical parametrization proposed in the past years. We refer the interested reader to [8,1] for a survey of the state-of-the-art in spherical parametrization research. Many of these methods are very similar to those of mapping simple meshes onto planar domain, whereas some of the linear methods become non-linear versions.

The simplest way to map a closed triangular mesh to the sphere is to reduce the problem to the planar case. Haker et al. [9] used a method which mapped the given genus-zero mesh into the plane and then used stereographic projection to map it to the sphere. Thus, it is more natural to parameterize the mesh directly on the sphere without going back and forth to the plane. Several methods for direct parametrization on the sphere exist. Gotsman et al. [5] showed a nice relationship between spectral graph theory and spherical parametrization, and embedded simple meshes onto the sphere by solving a quadratic system. Unfortunately, there was no analysis of the degrees of freedom in the various spherical embedding, the system was also quite slow even for a few hundred vertices. Saba et al. [10] provided an efficient optimization method combined with an algebraic multigrid technique to get the solution of the large system of non-linear equations in [5]. Li et al. [6] minimized the discrete harmonic energy to map a genus-zero surface to the unit sphere with good shapes which was suitable for surface fitting with PHT-splines.

Some spherical parametrization approaches have focused on directly optimizing the metric distortion. These approaches require extensive computation, due to the distortion measures are usually highly non-linear. Gu and Yau [11] gave an important point that a harmonic spherical map is conformal, then they proposed an iterative method which approximated a harmonic map without splitting. Other spherical conformal mappings are proposed in [4,12,13]. Sheffer et al. [14] proposed a method which measured angle distortion directly. They formulated a set of necessary and sufficient conditions for the spherical angles of the triangulation to form a valid spherical triangulation. The resultant mappings of all methods above are almost angle-preserving. However, the area distortion of these methods should be very large, and the area distortion is necessary to consider. Praun and Hoppe [15] used a coarse-to-fine solving scheme to iteratively optimize the 
                           
                              
                                 
                                    L
                                 
                                 
                                    2
                                 
                              
                           
                         stretching energy [16] defined piecewise on the triangluar mesh. Zayer et al. [17] proposed a curvilinear spherical parametrization which better reduced area-distortion efficiently. Wan et al. [7] utilized the distortion energy [18] and presented an efficient hierarchical optimization scheme minimizing angle and area distortions. However, we find that little work has been done on rigidity-preserving in spherical parametrization, thus we propose a method using the ARAP energy to parameterize the surface in a rigidity-preserving manner.

Recently, some basic flows have been used to evolve surface geometry. Both are classic mean-curvature flow derivations (see [19] for a modern treatment of the continuous formulation, and [20] for the finite-elements discretization) [21] modified the flow and presented empirical evidence that does it define a stable surface evolution for genus-zero surfaces, but that the evolution converges to a conformal parametrization of the surface onto the sphere. However, discrete surface Ricci flow theory was developed by Chow and Luo [22] and a computational algorithm was introduced in [23]. With spherical geometry, Ricci energy is not strictly convex but converges to a local optimum [22,24,25] presented a framework for spherical parametrization using Euclidean Ricci flow, facilitating efficient and effective surface mapping.

The ARAP energy is very important in geometry processing and has wide applications in editing [3], morphing [26,27], simulation [28], and planar parametrization [2,29]. The energy measures the sum of distance between deformation differentials and their corresponding rotation group [28]. Chao et al. [28] analyzed the relationship between the ARAP energy and standard elastic energy which commonly used in simulation. Local rigidity can be seen as the governing principle of various surface deformation models, and Sorkine et al. [3] used the ARAP energy to preserve the local-details of vertex’s one-ring neighbors for surface modeling. The principle of ARAP deformation was successfully applied to shape interpolation [26,27] to determine intermediate shape path such that the deformation from source to target appears as rigid as possible. Liu et al. [2] used the ARAP energy for planar parametrization of disk-topology surfaces, they parameterize the mesh to the plane in a rigidity-preserving manner for each individual triangle. Myles and Zorin [29] described a method for finding cone locations, and extended the ARAP parametrization of disk-topology surfaces to general surfaces, which yielded seamless parametrization with low metric distortion.

We extend the ARAP planar parametrization of disk-topology surfaces [2] to spherical parametrization of closed genus-zero mesh. This poses the problem to find an optimal local transformation for each individual mesh element, then stitch the transformed elements into a coherent sphere. Compared with [2] in 2D, where the local transformations are applied to individual triangles, we apply the local transformations to tetrahedrons in 3D. Moreover, we optimize the radius of the sphere for isometric mapping. The reason we update the radius is that, our algorithm cannot guarantee all parametrization triangles are congruent to the original ones (there are some rigidity distortions and our method is an as rigid as possible one), thus we need to update the radius correspondingly to decrease the ARAP energy which determines the rigidity distortion directly.

In this context, our contributions are:
                        
                           1.
                           We develop the model of mapping the genus-zero triangular mesh to the sphere with an optimal radius in a rigidity-preserving manner. Our spherical parametrization model bases on minimizing the ARAP energy in 3D with additional spherical constraints.

We analyze the ARAP energy from the smooth variational description to its corresponding discrete 2D and 3D case.

It is non-trivial to solve such a non-linear model with non-linear constraints, we propose a two-step iterative algorithm to efficiently solve it.

In this section, we give out an analysis of the ARAP energy. Firstly, we introduce the smooth, variational description ARAP energy. Then, we give out the discretization of the smooth energy in 2D and 3D case respectively.

Given a smooth map 
                        
                           f
                           :
                           M
                           →
                           N
                           ,
                           f
                           (
                           v
                           )
                           =
                           u
                        
                      describes the mapping of a reference configuration 
                        
                           M
                           ⊂
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                      into a deformed configuration 
                        
                           N
                           ⊂
                           
                              
                                 R
                              
                              
                                 n
                              
                           
                        
                     . Likewise, a differential vector 
                        
                           d
                           v
                        
                      is mapped by the deformation gradient df, then we get the energy
                        
                           (1)
                           
                              E
                              (
                              f
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    2
                                 
                              
                              
                                 ∫
                                 
                                    M
                                 
                              
                              
                                 
                                    
                                       min
                                    
                                    
                                       R
                                       ∈
                                       SO
                                       (
                                       n
                                       )
                                    
                                 
                              
                              |
                              df
                              -
                              R
                              
                                 
                                    |
                                 
                                 
                                    2
                                 
                              
                              .
                           
                        
                     The energy (1) measures the distance between the deformation differential df and the nearest rotation 
                        
                           R
                        
                     , characterizing how far f is from an isometry [28].

For convenience, we deNote 2-manifold simplicial complex as 
                        
                           M
                           =
                           (
                           V
                           ,
                           E
                           ,
                           F
                           )
                        
                      and 3-manifold simplicial complex as 
                        
                           M
                           =
                           (
                           V
                           ,
                           E
                           ,
                           F
                           ,
                           T
                           )
                        
                     .

For 2-manifold simplicial complex consisting of vertices, edges, triangles, the integral over M becomes a sum over triangles. Assume the triangles F of the mesh M are numbered with t = 1 to n (n is the number of triangles F). The original triangle t denotes 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              }
                           
                        , and 
                           
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                              
                              =
                              {
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    2
                                 
                              
                              }
                           
                         its image under df.

The corresponding discrete energy in 2D is the piecewise linear Dirichlet energy [2,30] as
                           
                              (2)
                              
                                 E
                                 (
                                 f
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       4
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          =
                                          0
                                       
                                       
                                          2
                                       
                                    
                                 
                                 cot
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 )
                                 ‖
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       t
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                    
                                       i
                                       +
                                       1
                                    
                                 
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    θ
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                           
                         is the angle opposite the edge 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                           
                         in the triangle whose vertices are 
                           
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                              
                           
                         and superscripts are all modulo 3.

For 3-manifold simplicial complex consisting of vertices, edges, triangles and tetrahedrons, the integral over M becomes a sum over tetrahedrons. Assume the tetrahedrons T of the mesh M are numbered with 
                           
                              T
                           
                         = 1 to n (n is the number of tetrahedrons T).

The original tetrahedron 
                           
                              T
                           
                         denotes 
                           
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                              
                              =
                              {
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                                 
                                    3
                                 
                              
                              }
                           
                        , and 
                           
                              
                                 
                                    u
                                 
                                 
                                    T
                                 
                              
                              =
                              {
                              
                                 
                                    u
                                 
                                 
                                    T
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    T
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    T
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    u
                                 
                                 
                                    T
                                 
                                 
                                    3
                                 
                              
                              }
                           
                         its image under df.

Following the cotan formula for tetrahedron [28,31], the corresponding discrete energy in 3D is as follows
                           
                              (3)
                              
                                 E
                                 (
                                 f
                                 )
                                 =
                                 
                                    
                                       1
                                    
                                    
                                       12
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          T
                                          =
                                          1
                                       
                                       
                                          n
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          {
                                          i
                                          ,
                                          j
                                          }
                                          ∈
                                          {
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ,
                                          3
                                          }
                                       
                                    
                                 
                                 cot
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       T
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       l
                                    
                                 
                                 ‖
                                 ‖
                                 (
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 -
                                 
                                    
                                       R
                                    
                                    
                                       T
                                    
                                 
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       j
                                    
                                 
                                 )
                                 
                                    
                                       ‖
                                    
                                    
                                       2
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              {
                              k
                              ,
                              l
                              }
                              =
                              {
                              0
                              ,
                              1
                              ,
                              2
                              ,
                              3
                              }
                              ⧹
                              {
                              i
                              ,
                              j
                              }
                           
                        , 
                           
                              
                                 
                                    θ
                                 
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    j
                                 
                              
                           
                         is the dihedral angle opposite edge 
                           
                              (
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                                 
                                    i
                                 
                              
                              ,
                              
                                 
                                    x
                                 
                                 
                                    T
                                 
                                 
                                    j
                                 
                              
                              )
                           
                         in the tetrahedron (see Fig. 1
                        ).

If each triangle of the 3D triangular mesh is required to be flattened onto the sphere independently of the other triangles, this would certainly be easy (see Fig. 2
                      (middle)), we denote the flattened triangles on the sphere with local isometric parametrization as 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           =
                           {
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 2
                              
                           
                           }
                        
                     . Note that 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                      depends on radius r of the sphere. However, requiring all the flattened triangles on the sphere fit together into one coherent mesh with correct orientations is a main challenge (see Fig. 2 (right)). Obviously some of the triangles are going to be deformed in this process, in this paper we only allow each triangle to be deformed by rigid transformation with additional spherical constraints. We aim to find a single parametrization of the entire mesh, i.e., a piecewise linear mapping from the 3D mesh to the 3D sphere, described by assigning 3D coordinates 
                        
                           u
                        
                      to each of the n vertices on the sphere. For each triangle t, we denote the parametrization coordinates as 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                           =
                           {
                           
                              
                                 u
                              
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 t
                              
                              
                                 2
                              
                           
                           }
                        
                     .

In 2D case, the planar parametrization of the ARAP energy was studied by [2] and its discrete setting is Eq. (2). Firstly they flattened each 3D triangle into the plane with its own local isometric parametrization, then used a local/global scheme to stitch the separated triangles into a coherent mesh.

In 3D case, however, with each flattened triangle 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                      of the original mesh and its piecewise linear mapping result 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                      of the parametrization of the entire mesh, we cannot calculate a unique 
                        
                           3
                           ×
                           3
                        
                      Jacobian matrix (deformation gradient df). In order to solve this problem, we add an auxiliary vertex 
                        
                           O
                           =
                           {
                           0
                           ,
                           0
                           ,
                           0
                           }
                        
                      to each triangle of the mesh, thus the original mesh is converted to a 3-manifold simplicial complex. Then 
                        
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                        
                      corresponds to a tetrahedron 
                        
                           
                              
                                 x
                              
                              
                                 T
                              
                           
                           =
                           {
                           
                              
                                 x
                              
                              
                                 t
                              
                           
                           ,
                           O
                           }
                           =
                           {
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 2
                              
                           
                           ,
                           O
                           }
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                      corresponds to a tetrahedron 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                           =
                           {
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                           ,
                           O
                           }
                           =
                           {
                           
                              
                                 u
                              
                              
                                 t
                              
                              
                                 0
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 t
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 u
                              
                              
                                 t
                              
                              
                                 2
                              
                           
                           ,
                           O
                           }
                        
                      (see Fig. 4). With the help of the auxiliary vertex, we can easily calculate the mapping f between 
                        
                           
                              
                                 x
                              
                              
                                 T
                              
                           
                        
                      and 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                        
                     , and use a 
                        
                           3
                           ×
                           3
                        
                      Jacobian matrix (deformation gradient df) to describe the mapping which is a constant per tetrahedron.

We define the ARAP spherical energy of the parametrization coordinates 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                        
                      and the rotation group 
                        
                           
                              
                                 R
                              
                              
                                 T
                              
                           
                        
                      for each tetrahedron, consequently our problem is minimizing the energy as follows
                        
                           (4)
                           
                              
                                 
                                    
                                       
                                          
                                             min
                                          
                                          
                                       
                                    
                                    
                                       
                                          E
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          
                                             
                                                R
                                             
                                             
                                                T
                                             
                                          
                                          ,
                                          r
                                          )
                                          =
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   T
                                                
                                             
                                          
                                          
                                             
                                                V
                                             
                                             
                                                T
                                             
                                          
                                          ‖
                                          J
                                          (
                                          
                                             
                                                u
                                             
                                             
                                                T
                                             
                                          
                                          )
                                          -
                                          
                                             
                                                R
                                             
                                             
                                                T
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                F
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                       
                                    
                                 
                                 
                                    
                                       
                                          s
                                          .
                                          t
                                          .
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                          
                                             
                                                u
                                             
                                             
                                                T
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                ‖
                                             
                                             
                                                2
                                             
                                          
                                          =
                                          
                                             
                                                r
                                             
                                             
                                                2
                                             
                                          
                                          ,
                                          
                                          i
                                          =
                                          0
                                          ,
                                          1
                                          ,
                                          2
                                          ,
                                       
                                    
                                 
                              
                           
                        
                     where 
                        
                           
                              
                                 V
                              
                              
                                 T
                              
                           
                        
                      is the volume of tetrahedron 
                        
                           T
                           ,
                           
                           J
                           (
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                           )
                        
                      is the 
                        
                           3
                           ×
                           3
                        
                      Jacobian matrix which depends on 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                        
                      and r is the radius of the sphere.

Note that each tetrahedron 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                        
                      consists of the triangle 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                      with an additional constant vertex 
                        
                           O
                        
                     , since the rotation of 
                        
                           
                              
                                 u
                              
                              
                                 T
                              
                           
                        
                      is equal to the rotation of 
                        
                           
                              
                                 u
                              
                              
                                 t
                              
                           
                        
                      
                     
                        
                           (
                           
                              
                                 R
                              
                              
                                 T
                              
                           
                           =
                           
                              
                                 R
                              
                              
                                 t
                              
                           
                           )
                        
                     . We have mentioned above that 
                        
                           u
                        
                      denote the 3D spherical parametrization coordinates of the vertices and 
                        
                           R
                        
                      denote the rotation group of the triangles. Then, following [28,31] we can use the discrete 3D ARAP energy (3) to rewrite (4) (instead of in terms of the Jacobians) in an explicit form (in terms of the parametrization coordinates 
                        
                           u
                        
                      and the mesh vertex coordinates 
                        
                           x
                        
                     )
                        
                           (5)
                           
                              E
                              (
                              u
                              ,
                              R
                              ,
                              r
                              )
                              =
                              
                                 
                                    1
                                 
                                 
                                    12
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       2
                                    
                                 
                              
                              [
                              cot
                              (
                              
                                 
                                    α
                                 
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    i
                                    +
                                    1
                                 
                              
                              )
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    2
                                 
                              
                              -
                              O
                              ‖
                              ‖
                              (
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              -
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              +
                              cot
                              (
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    o
                                 
                              
                              )
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    2
                                 
                              
                              ‖
                              ‖
                              (
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              O
                              )
                              -
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              O
                              )
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              ]
                              =
                              
                                 
                                    1
                                 
                                 
                                    12
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       t
                                       =
                                       1
                                    
                                    
                                       n
                                    
                                 
                              
                              
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       2
                                    
                                 
                              
                              [
                              cot
                              (
                              
                                 
                                    α
                                 
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    i
                                    +
                                    1
                                 
                              
                              )
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    2
                                 
                              
                              ‖
                              ‖
                              (
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              -
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              )
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              +
                              cot
                              (
                              
                                 
                                    β
                                 
                                 
                                    T
                                 
                                 
                                    i
                                    ,
                                    o
                                 
                              
                              )
                              ‖
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    1
                                 
                              
                              -
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                    +
                                    2
                                 
                              
                              ‖
                              ‖
                              
                                 
                                    u
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              -
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              
                                 
                                    x
                                 
                                 
                                    t
                                 
                                 
                                    i
                                 
                              
                              
                                 
                                    ‖
                                 
                                 
                                    2
                                 
                              
                              ]
                           
                        
                     where 
                        
                           
                              
                                 α
                              
                              
                                 T
                              
                              
                                 i
                                 ,
                                 i
                                 +
                                 1
                              
                           
                        
                      is the dihedral angle opposite the edge 
                        
                           (
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 i
                                 +
                                 1
                              
                           
                           )
                        
                      and 
                        
                           
                              
                                 β
                              
                              
                                 T
                              
                              
                                 i
                                 ,
                                 o
                              
                           
                        
                      is the dihedral angle opposite the edge 
                        
                           (
                           
                              
                                 x
                              
                              
                                 t
                              
                              
                                 i
                              
                           
                           ,
                           O
                           )
                        
                      in the tetrahedra. Note that we optimize a radius r of the sphere in the energy (5), for reason that the radius r directly influences the ARAP spherical parametrization result (see Section 6.2). It is non-trivial to solve such a non-linear problem with non-linear constraints, hence in next section we will provide a simple and efficient algorithm to deal with the problem.

In order to solve the minimization problem (4) for an ARAP spherical mapping, we present a two-step iterative algorithm by separating variables of the parametrization coordinates 
                        
                           u
                        
                     , the rigid rotation group 
                        
                           R
                        
                      and the radius r.

Starting from an initial spherical parametrization from any available algorithm, our algorithm alternatively updates the parametrization coordinates 
                        
                           u
                        
                     , rotation group 
                        
                           R
                        
                      and optimal radius r in two steps (see Fig. 3
                     ). The two-step iterative algorithm is described as follows.

In step one, we fix the radius r of the sphere, and use a local/global iterative scheme to update the parametrization coordinates 
                           
                              u
                           
                         and the rotation group 
                           
                              R
                           
                        . In the local phase of step one, the optimal rotation 
                           
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              (
                              
                                 
                                    R
                                 
                                 
                                    T
                                 
                              
                              =
                              
                                 
                                    R
                                 
                                 
                                    t
                                 
                              
                              )
                           
                         is computed for per tetrahedron, assuming 
                           
                              u
                           
                         are fixed. Then in the global phase, the rotation group 
                           
                              R
                           
                         are assumed fixed, the optimal 
                           
                              u
                           
                         are solved for as a sparse linear system.

Remember that, in order to calculate the 
                              
                                 3
                                 ×
                                 3
                              
                            Jacobian matrix (deformation gradient df), we add an auxiliary vertex 
                              
                                 O
                                 =
                                 {
                                 0
                                 ,
                                 0
                                 ,
                                 0
                                 }
                              
                            to each flattened triangle 
                              
                                 
                                    
                                       x
                                    
                                    
                                       t
                                    
                                 
                              
                            and construct the corresponding tetrahedron 
                              
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                              
                            (see Fig. 4
                           ). Since the optimal rotation of each flattened triangle is equal to the rotation of its corresponding tetrahedron, we minimize the following energy function for a single tetrahedron which can easily be deduced from energy (3)
                           
                              
                                 (6)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             {
                                             i
                                             ,
                                             j
                                             }
                                             ∈
                                             {
                                             0
                                             ,
                                             1
                                             ,
                                             2
                                             ,
                                             3
                                             }
                                          
                                       
                                    
                                    cot
                                    (
                                    
                                       
                                          θ
                                       
                                       
                                          T
                                       
                                       
                                          i
                                          ,
                                          j
                                       
                                    
                                    )
                                    ‖
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                       
                                          k
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                       
                                          l
                                       
                                    
                                    ‖
                                    ‖
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    -
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          T
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 {
                                 k
                                 ,
                                 l
                                 }
                                 =
                                 {
                                 0
                                 ,
                                 1
                                 ,
                                 2
                                 ,
                                 3
                                 }
                                 ⧹
                                 {
                                 i
                                 ,
                                 j
                                 }
                              
                           , 
                              
                                 
                                    
                                       θ
                                    
                                    
                                       T
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                              
                            is the dihedral angle opposite edge 
                              
                                 (
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       j
                                    
                                 
                                 )
                              
                            in the tetrahedron.

To calculate this, we rewrite the energy (6) as
                              
                                 (7)
                                 
                                    
                                       
                                          E
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ˆ
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             5
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                    ‖
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ′
                                       
                                    
                                    -
                                    
                                       
                                          R
                                       
                                       
                                          T
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                    
                                       
                                          ‖
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 
                                    
                                       w
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 
                                 =
                                 cot
                                 (
                                 
                                    
                                       θ
                                    
                                    
                                       T
                                    
                                    
                                       i
                                       ,
                                       j
                                    
                                 
                                 )
                                 ‖
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       k
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       l
                                    
                                 
                                 ‖
                              
                            are the cotangent weights for tetrahedron, 
                              
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                    
                                       ′
                                    
                                 
                                 =
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       u
                                    
                                    
                                       T
                                    
                                    
                                       j
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       e
                                    
                                    
                                       
                                          
                                             i
                                          
                                          
                                             ˆ
                                          
                                       
                                    
                                 
                                 =
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                    
                                       j
                                    
                                 
                              
                           .

Inspired by [2,3], this is solved as 
                              
                                 
                                    
                                       R
                                    
                                    
                                       T
                                    
                                 
                                 =
                                 
                                    
                                       V
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             T
                                          
                                       
                                    
                                 
                                 
                                    
                                       U
                                    
                                    
                                       
                                          
                                             x
                                          
                                          
                                             T
                                          
                                       
                                    
                                    
                                       T
                                    
                                 
                              
                            by the signed SVD factorization of the cross-covariance matrix.
                              
                                 (8)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             
                                                
                                                   i
                                                
                                                
                                                   ˆ
                                                
                                             
                                             =
                                             0
                                          
                                          
                                             5
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                    
                                    
                                       
                                          e
                                       
                                       
                                          
                                             
                                                i
                                             
                                             
                                                ˆ
                                             
                                          
                                       
                                       
                                          ′
                                          T
                                       
                                    
                                    =
                                    
                                       
                                          U
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          D
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                       
                                    
                                    
                                       
                                          V
                                       
                                       
                                          
                                             
                                                x
                                             
                                             
                                                T
                                             
                                          
                                       
                                       
                                          T
                                       
                                    
                                    .
                                 
                              
                           
                        

After we apply the rotation 
                              
                                 
                                    
                                       R
                                    
                                    
                                       T
                                    
                                 
                              
                            to each tetrahedron 
                              
                                 
                                    
                                       x
                                    
                                    
                                       T
                                    
                                 
                              
                            individually, the corresponding intermediate result may not coincide as shown in Fig. 2 (middle). Thus, we need to stitch them in the global phase.

Note that we fix radius r and rotation group 
                              
                                 R
                              
                            to solve parametrization coordinates 
                              
                                 u
                              
                            in the global phase, since the energy 
                              
                                 E
                                 (
                                 u
                                 ,
                                 R
                                 ,
                                 r
                                 )
                              
                            
                           (5) is quadratic in 
                              
                                 u
                              
                           . The minimum 
                              
                                 u
                              
                            can be found by setting the gradient of (5) to zero and solving the associated linear sparse system.

To calculate this, overloading the notation slightly, we rewrite the energy function (5) in terms of the tetrahedrons:
                              
                                 (9)
                                 
                                    E
                                    (
                                    u
                                    ,
                                    R
                                    ,
                                    r
                                    )
                                    =
                                    
                                       
                                          1
                                       
                                       
                                          12
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      (
                                                      i
                                                      ,
                                                      j
                                                      )
                                                      ∈
                                                      he
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   ij
                                                
                                             
                                             ‖
                                             (
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   u
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             -
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         (
                                                         i
                                                         ,
                                                         j
                                                         )
                                                      
                                                   
                                                
                                             
                                             (
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   x
                                                
                                                
                                                   j
                                                
                                             
                                             )
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      k
                                                   
                                                
                                             
                                             
                                                
                                                   w
                                                
                                                
                                                   io
                                                
                                             
                                             ‖
                                             
                                                
                                                   u
                                                
                                                
                                                   i
                                                
                                             
                                             -
                                             
                                                
                                                   R
                                                
                                                
                                                   
                                                      
                                                         T
                                                      
                                                      
                                                         ve
                                                         (
                                                         k
                                                         )
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   x
                                                
                                                
                                                   i
                                                
                                             
                                             
                                                
                                                   ‖
                                                
                                                
                                                   2
                                                
                                             
                                          
                                       
                                    
                                    ,
                                 
                              
                           where 
                              
                                 he
                              
                            is the set of half-edges in the original mesh; 
                              
                                 
                                    
                                       u
                                    
                                    
                                       i
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       x
                                    
                                    
                                       i
                                    
                                 
                              
                            are coordinates of vertices 
                              
                                 i
                                 ;
                                 
                                    
                                       T
                                    
                                    
                                       (
                                       i
                                       ,
                                       j
                                       )
                                    
                                 
                              
                            is the tetrahedron containing the triangle with half-edge 
                              
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ;
                                 
                                    
                                       w
                                    
                                    
                                       ij
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       w
                                    
                                    
                                       io
                                    
                                 
                              
                            are the tetrahedron cotan weights which are the dihedral angles opposite edges 
                              
                                 (
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 i
                                 ,
                                 o
                                 )
                                 )
                              
                            time edge lengths opposite edges 
                              
                                 (
                                 (
                                 i
                                 ,
                                 j
                                 )
                                 ,
                                 (
                                 i
                                 ,
                                 o
                                 )
                                 )
                              
                           ; 
                              
                                 ve
                              
                            is the set of edges of tetrahedrons which contain the edge 
                              
                                 (
                                 i
                                 ,
                                 O
                                 )
                                 ;
                                 
                                    
                                       T
                                    
                                    
                                       ve
                                    
                                 
                              
                            is the set of tetrahedrons containing the edge 
                              
                                 (
                                 i
                                 ,
                                 O
                                 )
                              
                            and 
                              
                                 
                                    
                                       R
                                    
                                    
                                       
                                          
                                             T
                                          
                                          
                                             ve
                                          
                                       
                                    
                                 
                              
                            is the rotation group corresponding to the tetrahedrons 
                              
                                 
                                    
                                       T
                                    
                                    
                                       ve
                                    
                                 
                              
                           . 
                              
                                 
                                    
                                       N
                                    
                                    
                                       ve
                                    
                                 
                              
                            is the number of edges in 
                              
                                 ve
                              
                            and 
                              
                                 k
                                 ∈
                                 
                                    
                                       N
                                    
                                    
                                       ve
                                    
                                 
                              
                           .

Setting the gradient of (9) to zero, we obtain the following set of linear equations for 
                              
                                 u
                              
                           
                           
                              
                                 (10)
                                 
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             N
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          ji
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          u
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             i
                                             ,
                                             O
                                             )
                                             ∈
                                             ve
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          io
                                       
                                    
                                    
                                       
                                          u
                                       
                                       
                                          i
                                       
                                    
                                    =
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             ∈
                                             N
                                             (
                                             i
                                             )
                                          
                                       
                                    
                                    (
                                    
                                       
                                          w
                                       
                                       
                                          ij
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                          (
                                          i
                                          ,
                                          j
                                          )
                                       
                                    
                                    +
                                    
                                       
                                          w
                                       
                                       
                                          ji
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          T
                                          (
                                          j
                                          ,
                                          i
                                          )
                                       
                                    
                                    )
                                    (
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    -
                                    
                                       
                                          x
                                       
                                       
                                          j
                                       
                                    
                                    )
                                    +
                                    
                                       
                                          
                                             ∑
                                          
                                          
                                             (
                                             i
                                             ,
                                             O
                                             )
                                             ∈
                                             ve
                                          
                                       
                                    
                                    
                                       
                                          w
                                       
                                       
                                          io
                                       
                                    
                                    
                                       
                                          R
                                       
                                       
                                          
                                             
                                                T
                                             
                                             
                                                ve
                                                (
                                                k
                                                )
                                             
                                          
                                       
                                    
                                    
                                       
                                          x
                                       
                                       
                                          i
                                       
                                    
                                    .
                                 
                              
                           The entries of the associated matrix depend only on the geometry of the input 3D mesh. Thus this sparse matrix is fixed throughout the step one (the local/gobal step), allowing us to pre-factor it (e.g. with Cholesky decomposition) and reuse the factorization many times in order to accelerate the process. This has a significant impact on algorithm efficiency.

Once we compute 
                              
                                 u
                              
                            from (10), all the triangles almost distribute nearly the surface of sphere. Heuristically, we project them to the sphere of radius r along radius direction. That is, we get the new spherical parametrization satisfying the model (4).

In this section, we will talk about how to find the optimal radius r. The chosen of the r is important, since it determines the rigidity distortion directly. If r is too small or too large, it will increase the rigidity distortion sharply. Because of aiming to parameterize the triangles in a rigidity preserving manner, we try to keep the total area of the mesh as the original one. As a consequence, we set the initial 
                           
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                           
                         just as below
                           
                              
                                 
                                    
                                       r
                                    
                                    
                                       0
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   t
                                                
                                             
                                             
                                                
                                                   A
                                                
                                                
                                                   t
                                                
                                             
                                          
                                          
                                             4
                                             π
                                          
                                       
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                           
                         is the area of the triangle t. Unfortunately, our algorithm cannot guarantee that all parametrization triangles are congruent to their original ones. The total area of the parametrization mesh is changed during the iterative process, thus we need to update the radius during the iterations correspondingly. We update the radius as follows
                           
                              (11)
                              
                                 
                                    
                                       r
                                    
                                    
                                       k
                                       +
                                       1
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   k
                                                   +
                                                   1
                                                
                                             
                                          
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   k
                                                
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       r
                                    
                                    
                                       k
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    r
                                 
                                 
                                    k
                                 
                              
                           
                         is the k-th iteration of 
                           
                              r
                              ,
                              
                                 
                                    S
                                 
                                 
                                    k
                                 
                              
                           
                         is the total area of local/global results in k-th iteration instead of projected results in k-th iteration.


                        
                           Algorithm 1
                           ARAP spherical parametrization 
                                 
                                    
                                       
                                       
                                          
                                             
                                                Input: The triangular mesh 
                                                   
                                                      M
                                                      =
                                                      {
                                                      E
                                                      ,
                                                      F
                                                      ,
                                                      V
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                                Output: The spherical parametrization coordinates 
                                                   
                                                      u
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                Initialization: Generate an initial parametrization coordinates 
                                                   
                                                      
                                                         
                                                            u
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                 and a radius 
                                                   
                                                      
                                                         
                                                            r
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                   
                                                .
                                          
                                          
                                             
                                                Repeat until convergence 
                                                   
                                                      {
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                Step one:
                                          
                                          
                                             
                                                Repeat until convergence 
                                                   
                                                      {
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                
                                                Local phase: Update rotation group 
                                                   
                                                      R
                                                   
                                                 with Eq. (8) (Section 6.1.1)
                                          
                                          
                                             
                                                
                                                
                                                Global phase: Update parametrization 
                                                   
                                                      u
                                                   
                                                 with Eq. (10) (Section 6.1.2) 
                                                   
                                                      }
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                Step two:
                                          
                                          
                                             
                                                
                                                Update optimal radius r with Eq. (11) (Section 6.2) 
                                                   
                                                      }
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Advantages over previous methods. Our two-step iterative approach can preserve the parametrization triangles as rigid as possible and get an optimal approximate sphere for isometric mapping. Compared with previous spherical parametrization methods [5,11,6,7], our method can yield the best rigidity-preserving results. In contrast to the conformal method [11], our method has a very small, even insignificant penalty in angle distortion. Compared with the hierarchical method [7], our method has a small penalty in area distortion. However, if we consider the value of area and angle distortion synthetically, our ARAP parametrization consistently gives the best results (See Section 8).

@&#DISCUSSION@&#

We discuss about some issues of our algorithm in this section including initialization, tessellation, convergence, flipping and complex model processing.

Our algorithm requires an initial parametrization result to start it off. The initial parametrization should be a valid embedding (contains no flips) with an initial radius 
                           
                              
                                 
                                    r
                                 
                                 
                                    0
                                 
                              
                           
                        . We have applied the initial parametrization produced by some available algorithms, such as the convex parametrization [5], the conformal parametrization [11] and the harmonic parametrization [6]. We tested the sensitivity of our algorithm to different types of initializations, and found that the parametrization results of our algorithm are insensitive to the choosing of the initializations. Fig. 5
                         shows the same parametrization results of our algorithm by inputting different initializations. However, the time of convergence is impacted by the initialization. The convergence is slow for a significantly distorted initialization, while fast for a good initialization.

To evaluate that whether our algorithm is sensitive to tessellation, we have applied a model with different quality. Fig. 6
                         shows almost the same distortions are obtained with different mesh quality.

The 3D ARAP energy (5) has been minimized by an alternating solver referred in Section 6. Although it is difficult to formally prove convergence of the two-step iterative algorithm, the energy in each step is guaranteed to reduce, thus this energy will eventually converge. And we prove the convergence of our algorithm via numerical experiments. We show ARAP energy curves of the models in Fig. 10 for an example. Fig. 7
                         shows that the energy always decreases in each iteration and finally converges to a stable minimum.

In a valid parametrization result, the flipped triangles should be eliminated. Our algorithm uses a global Poisson equation to stitch the local elements into a coherent one, then projects the stitched result onto sphere.

Unfortunately, the projection operation can not guarantee the parametrization result without flips, especially for highly curvature sections, such as the long and thin protrusion regions. In this case, we sacrifice some rigidity of the extreme regions to obtain a valid spherical embedding. We solve this problem with a final post-processing phase using the harmonic energy of [6] to deal with the extreme regions. That is, we fix all non-flipped triangles and recompute the parametrization coordinates of the flipped triangles using the scheme in [6]. We have applied our method on the large and complex model, the hand model with many highly curvature sections, to verify the efficiency of it (see Fig. 8
                        ).

Since in most cases, there are only a few flips, sprinkled throughout the parametrization, the post-processing removes the flips without changing much else. Note that all the spherical parametrization results in this paper are without any post-processing and contain no flipped triangles, except the ones in Fig. 8 to demonstrate the flipping and complex model processing.

To quantify the parametrization distortion, we compute area, angle and rigidity metric distortion following [2]. We flatten each triangle t of original mesh and parametrization mesh into the same plane, then compute the signed singular values 
                           
                              
                                 
                                    σ
                                 
                                 
                                    1
                                    ,
                                    t
                                 
                              
                           
                         and 
                           
                              
                                 
                                    σ
                                 
                                 
                                    2
                                    ,
                                    t
                                 
                              
                           
                         of the Jacobians 
                           
                              
                                 
                                    J
                                 
                                 
                                    t
                                 
                              
                           
                         for triangle t, as defined in [32,33,2]:
                           
                              
                                 
                                    
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   area
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                             
                                             +
                                             1
                                             /
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                             
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                             
                                             )
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   angle
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                             
                                             /
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                             
                                             +
                                             
                                                
                                                   σ
                                                
                                                
                                                   2
                                                   ,
                                                   t
                                                
                                             
                                             /
                                             
                                                
                                                   σ
                                                
                                                
                                                   1
                                                   ,
                                                   t
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                    
                                       
                                       
                                          
                                             
                                                
                                                   D
                                                
                                                
                                                   rigidity
                                                
                                             
                                             =
                                             
                                                
                                                   
                                                      ∑
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                             
                                                
                                                   ρ
                                                
                                                
                                                   t
                                                
                                             
                                             (
                                             
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         1
                                                         ,
                                                         t
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             +
                                             
                                                
                                                   (
                                                   
                                                      
                                                         σ
                                                      
                                                      
                                                         2
                                                         ,
                                                         t
                                                      
                                                   
                                                   -
                                                   1
                                                   )
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                             ,
                                          
                                       
                                    
                                 
                              
                           
                        where the weight 
                           
                              
                                 
                                    ρ
                                 
                                 
                                    t
                                 
                              
                           
                         is
                           
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       t
                                    
                                 
                                 =
                                 
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                t
                                             
                                          
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          t
                                       
                                    
                                 
                                 
                                    
                                       A
                                    
                                    
                                       t
                                    
                                 
                                 ,
                              
                           
                        where 
                           
                              
                                 
                                    A
                                 
                                 
                                    t
                                 
                              
                           
                         is area of triangle t.

@&#IMPLEMENTATION DETAILS@&#

We have implemented our two-step iterative spherical parametrization algorithm using MATLAB on a Pentium 4 
                           
                              2.16
                           
                         GHz laptop with 2GB RAM. In step one, we use an iterative local/global method to calculate the parametrization coordinates 
                           
                              u
                           
                        . In the local phase we used the standard SVD implementation (used for polar decomposition of 3
                           
                              ×
                           
                        3 matrices). The most time-consuming part of our algorithm is solving the sparse linear system (5) in the global phase. The factorization of the normal equation may take a longer time. At each iteration step, only back-substitutions are performed to solve the system. We used the sparse Cholesky linear solver for matrix computation. Table 1
                         gives the model statistic and the time required of the parametrization results. Note that the convex method [5] involves a solution of a large system of non-linear equations. For large geometry models, we use conformal or harmonic parametrization result as initialization.

We have applied our approach to parameterize a variety of 3D genus-zero meshes and compared with other relevant methods including the conformal parametrization [11], the harmonic parametrization [6], the convex parametrization [5] and the hierarchical parametrization [7]. Note that we normalize the bounding box of each model to unit length for comparison’s sake. We show some results in Figs. 9, 10
                        .


                        Fig. 9 compares the parametrization results of a Max-Planck model with various approaches. And Fig. 10
                         shows the parametrization results of different models.

The values of the area, angle and rigidity distortion measures obtained by various algorithms are summarized in Tables 2,3
                        
                        , respectively.

From the metric distortion we can see that
                           
                              •
                              As is evident our ARAP parametrization consistently gives the best values of the rigidity distortion.

Our approach has a small, even insignificant penalty in angle distortion compared with the conformal approach [11], but has a better value than other approaches [5–7].

Our approach has a small, even insignificant penalty in area distortion compared with the hierarchical approach [7], but has a better value than other approaches [5,11,6].

From the tables, we find that our ARAP parametrization results have the best rigidity-preserving property compared with other methods. The area, angle and rigidity distortion are very low in all the examples of this paper, which demonstrates the efficiency and accuracy of our algorithm. We also provide the worst cases of the rigidity distortion measures in Table 3 for comparing with the average ones.

@&#CONCLUSION@&#

We have presented an efficient approach to parameterize the genus-zero triangular mesh onto the sphere with an optimal radius by minimizing the discrete ARAP energy. This is a natural extension from planar parametrization to spherical domain, corresponding to the extension of ARAP energy. However, as the extension involves a transition from non-constrained optimization to a highly non-linear constrained one, it is much difficult to solve. We have provided a simple and efficient two-step iterative algorithm to solve the spherical parametrization problem. In the first step, we apply a local/global scheme to calculate the spherical parametrization coordinates. The local component tries to minimize the distance between the parametrization differential and the nearest rotation for each tetrahedron which individual triangle is in, while the global component fits all the tetrahedrons together. In second step, we try to find an optimal radius of the sphere for isometric mapping. We demonstrate our parametrization results on a collection of challenging models and show that our algorithm is simple, efficient and practical.

In future work, we will focus on the following problems. Since our objective energy cannot guarantee the parametrization results without flips especially for high curvature sections, we want to give out a better objective function to avoid the self-intersection, such as harmonic energy. In addition, we want to generalize our method to parameterize higher genus meshes onto sphere.

@&#ACKNOWLEDGMENTS@&#

Thanks to Xin Lin and Ying Li for providing results of the algorithms of [7,6]. This work is supported by the National Natural Science Foundation of China (61222206) and the One Hundred Talent Project of the Chinese Academy of Sciences.

@&#REFERENCES@&#

