@&#MAIN-TITLE@&#Robustness and efficiency of geometric programs: The Predicate Construction Kit (PCK)

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           A system to automatically generate C++ code for robust predicates from their formulas.


                        
                        
                           
                           The predicates involved in the intersection between a Voronoi diagram and a tetrahedral solid.


                        
                        
                           
                           A companion open-source implementation (Predicate Construction Kit) in the GEOGRAM library.


                        
                        
                           
                           Experimental validation with several synthetic and real industrial datasets.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Geometric predicates

Arbitrary precision

Symbolic perturbation

Expansion arithmetics

@&#ABSTRACT@&#


               
               
                  In this article, I focus on the robustness of geometric programs (e.g., Delaunay triangulation, intersection between surfacic or volumetric meshes, Voronoi-based meshing …) w.r.t. numerical degeneracies. Some of these geometric programs require “exotic” predicates, not available in standard libraries (e.g., J.-R. Shewchuk’s implementation and CGAL). I propose a complete methodology and a sample Open Source implementation of a toolset (PCK: Predicate Construction Kit) that makes it reasonably easy to design geometric programs free of numerical errors. The C++ code of the predicates is automatically generated from its formula, written in a simple specification language. Robustness is obtained through a combination of arithmetic filters, expansion arithmetics and symbolic perturbation.
                  As an example of my approach, I give the formulas and PCK source-code for the 4 predicates used to compute the intersection between a 3d Voronoi diagram and a tetrahedral mesh, as well as symbolic perturbations that provably escapes the corner cases. This allows to robustly compute the intersection between a Voronoi diagram and a triangle mesh, or the intersection between a Voronoi diagram and a tetrahedral mesh. Such an algorithm may have several applications, including surface and volume meshing based on Lloyd relaxation.
               
            

@&#INTRODUCTION@&#

In this article, I focus on the robustness of geometric programs w.r.t. numerical degeneracies, and propose a complete methodology implemented in a toolset to easily design geometric programs free of numerical problems.

Some classical tasks in geometric modeling, including computing the Delaunay triangulation, computing the intersection between surfacic and/or volumetric meshes, and meshing using Voronoi diagrams are examples involving such geometric programs. Geometric programs take as an input a set of objects (points, lines, segments, triangles …) and return a combinatorial structure (e.g. a mesh) that inter-connects the elements of the input.


                        Geometric predicates are central components of geometric algorithms. They are functions that take as input a small set of geometric objects and return a binary (or ternary, see below) answer. For instance, the orientation predicate in 2d indicates for a set of points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                        , 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                        , 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 3
                              
                           
                         whether the angle between 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       2
                                    
                                 
                              
                              
                                 ⃗
                              
                           
                         and 
                           
                              
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       1
                                    
                                 
                                 ,
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       3
                                    
                                 
                              
                              
                                 ⃗
                              
                           
                         is a right turn or a left turn (or no turn at all if 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 1
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 2
                              
                           
                           ,
                           
                              
                                 
                                    p
                                 
                              
                              
                                 3
                              
                           
                         are aligned, thus “ternary” answer). Typically, in C/C++, the 2d orientation predicate is implemented as a function:
                           
                              int orient2d(double* p1, double* p2, double* p3)
                           
                         that returns 
                           −
                           1
                         for a left turn, 
                           +
                           1
                         for a right turn and 0 if the three points are aligned. The result of this function is used by the geometric algorithm, typically to decide which pairs of points/triples of points should be connected by an edge/triangle in a mesh, in other words, the predicates determine all the “combinatorial decisions” taken by the algorithm.

The mathematical definition of geometric predicates are most of the time quite simple, for instance, for the orient2d predicate mentioned above, this corresponds to the sign of the determinant of the two vectors. However, there are two major difficulties for implementing a geometric predicate: 
                           
                              1.
                              
                                 double precision does not suffice: When using standard floating point doubles, for some configurations, the answer given by the implementation will differ from the exact value. More importantly, it may differ inconsistently. For instance, the same predicate may assert that 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                  is strictly above 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                 , and that 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                  is strictly above 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                 ! This clearly leads to erroneous combinatorics (inconsistent mesh);


                                 corner cases are tricky: There are configurations where the predicate answers 0. For instance, in the case of orient2d, this corresponds to three points that are aligned. If you use the predicate to compute the intersection between a polygon and a straight line, this corresponds to the configuration where a vertex of the polygon lies exactly on the straight line. While such configurations are reasonably easy to handle in 2d, this quickly becomes very complicated for 3d intersection problems.

Two techniques have been developed to handle both difficulties:


                        Arbitrary precision: To deal with the first issue, the idea is to replace standard double floating point computation with custom types  [1], that can represent numbers with arbitrary precision, using a dynamically allocated space (more on this below);


                        Avoiding corner cases with ‘Simulation of Simplicity’: to deal with the second issue, a natural (naive) idea would be to “move the points a little bit” whenever a degeneracy is encountered. Unfortunately this naive idea does not work in general. Imagine that the same point 
                           
                              p
                           
                         is used several times as an argument of the predicate, for instance 
                           P
                           
                              (
                              
                                 p
                              
                              ,
                              q
                              ,
                              r
                              )
                           
                         and 
                           P
                           
                              (
                              s
                              ,
                              t
                              ,
                              
                                 p
                              
                              )
                           
                        , and imagine that the second configuration 
                           P
                           
                              (
                              s
                              ,
                              t
                              ,
                              
                                 p
                              
                              )
                           
                         is degenerate, then, if 
                           
                              p
                           
                         is moved, in order to keep combinatorial decisions coherent, the information should be “back propagated in time” to the first invocation. A solution to this problem was introduced in  [2], that defines a globally consistent perturbation and applies it symbolically: Imagine that all the points 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         follow a set of trajectories, parameterized by time 
                           t
                        , and starting from their actual positions. Then each point 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         is replaced with a function 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         such that 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              0
                              )
                           
                           =
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                         (dashed arrows on the figure).


                        
                           
                              
                           
                        
                     

Whenever a predicate 
                           P
                           
                              (
                              
                                 p
                              
                              ,
                              
                                 q
                              
                              ,
                              
                                 r
                              
                              )
                           
                         returns 0 (such as the circled vertex when classified w.r.t. the solid line), the idea will be to replace the answer of the predicate with the (symbolically computed) limit: 
                           
                              
                                 lim
                              
                              
                                 t
                                 →
                                 0
                              
                           
                           P
                           
                              (
                              
                                 p
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                              
                                 q
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                              
                                 r
                              
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                        . In practice, to derive the implementation of a predicate 
                           P
                         from its formula, this means choosing a perturbation 
                           
                              
                                 
                                    p
                                 
                              
                              
                                 i
                              
                           
                           
                              (
                              t
                              )
                           
                         (typically an exponent of 
                           t
                         that depends on 
                           i
                        ), then computing the Taylor expansion of 
                           P
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    1
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    2
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    3
                                 
                              
                              
                                 (
                                 t
                                 )
                              
                              )
                           
                         in function of 
                           t
                        . The implementation tests all the terms of the Taylor expansions in increasing powers of 
                           t
                        , and returns the sign of the first non-zero one. Note that the constant term corresponds to the unperturbed predicate.

At first sight, this may seem a pretty convoluted/overly complicated way of handling these corner cases, but from a software design point of view, this has very interesting properties: most geometric programs depend on a very small number of predicates. For instance, a robust implementation of Delaunay triangulation only needs two predicates, orient() and in_sphere(), and an algorithm to compute mesh intersections will mostly depend on some forms of orient() (more on this below). If your predicates implement the Simulation of Simplicity, this means that they will never answer 0, in other words, corner cases are never encountered. This has a dramatic influence on the development of the geometric program: imagine an algorithm that computes the intersection between two volumetric meshes. There is a wide variety of degenerate configurations that can occur (vertex on a face, edge on a face, edge on an edge, coplanar faces …). Using the symbolically perturbed predicates, these configurations never occur. By simply replacing a couple of functions, all the corner cases “mathemagically” disappear! The price to pay is that since the algorithm behaves as if the point was not on the plane, the algorithm will generate zero-area/zero-volume elements (see results in Section  4), but they can be filtered-out by a post-processing phase, that is much easier to develop than the algorithm that handles all corner cases explicitly. More importantly, it also makes it much easier to check the correctness of the program.


                        Efficiency/arithmetic filters At this point, to implement the predicate, one will derive its mathematical expression, compute the symbolic perturbation, and implement the formula for all the terms of the Taylor expansion with exact arithmetics (e.g.,  [1], described in the next section). However, exact arithmetics costs between 
                           10
                           ×
                         and 
                           50
                           ×
                         the time of standard floating point double precision arithmetics! For this reason, to improve performances, it is interesting to have a way of determining the answer in the “easy cases”, where we are sure that the result computed using double precision floating points is exact. In other words, this corresponds to configuration where we are sure that the sign of the computed floating point number is correct. Meyer and Pion introduced a method that computes bounds from the formula of the predicate  [3]. If the absolute value of the result is larger than the bound, then they prove that the sign is correct. In addition, the bounds can be dynamically adjusted to the input, thus making it even more efficient (with these dynamic bounds, a quick decision can be taken in a much larger number of cases).


                        Summary: a predicate implementation depends on the following three components: 
                           
                              1.
                              an arithmetic filter:
                                 [3], that gives an answer in the “easy cases” where the exact answer can be determined using standard floating point arithmetics. This is the key to efficiency (obtaining correctness and robustness without paying the price for it!);


                                 exact arithmetics :
                                 [1], used when the filter could not determine the answer, this is the key to correctness and robustness;


                                 symbolic perturbation :
                                 [2], that “escape” the corner cases by (symbolically) considering the limit of a globally consistent perturbation applied to the input. This is the key to correctness, robustness and ease of implementation of the geometric program on top of the predicate.

For Delaunay triangulation, predicates are well studied and understood, and several implementations are available, such as [4] and Shewchuk’s code  [1], that are widely used.

However, some mesh generation algorithm that we develop, such as the flow simulator with adaptive gridding  [5,6], our adaptive meshing algorithms  [7,8], and our hex-dominant meshing algorithm  [9], require to compute the intersection between a 3D Voronoi diagram and a tetrahedral mesh. Robustness is a key issue, for instance our adaptive meshing algorithm optimizes a Voronoi mesh such that some facets of the Voronoi cells conform to the interfaces of a volumetric structural model (horizons and faults). In terms of mesh intersections, this means that we create degenerate configurations. Unfortunately, the predicates that we need are “exotic” and therefore not available in the standard packages.


                        Exact predicates “without the agonizing pain”:
                        
                           1
                        
                        
                           1
                           Tribute to Jonathan Shewchuk’s “Conjugate Gradient without the agonizing pain”.
                         In the programming libraries mentioned above, the expertise on the three components often depend on a limited number of individuals (J. Shewchuk, S. Pion, O. Devillers …). Since we will need to implement a whole family of more general predicates, my goal is now to develop a methodology such that any practitioner of the field could create his own predicates. Concerning the first layer (filters), this goal is already reached by the FPG tool  [3]. Concerning the two other ones, some new programming tools are needed. In particular, we need an efficient and easy-to-use implementation of exact arithmetics.


                        A first solution: exact arithmetics using dynamic integers: There are already several existing programming libraries that implement exact arithmetics. For instance, when considering integer arithmetics, it is possible to represent an integer of arbitrary precision by an array of integers 
                           a
                           
                              [
                              0
                              ]
                           
                           …
                           a
                           
                              [
                              l
                              −
                              1
                              ]
                           
                        . Such an array represents the integer 
                           x
                         given by 
                           
                              
                                 x
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 
                                    
                                       2
                                    
                                    
                                       32
                                       ∗
                                       i
                                    
                                 
                                 a
                                 
                                    [
                                    i
                                    ]
                                 
                                 .
                              
                           
                         Then, it is possible to implement algebraic operations 
                           
                              (
                              +
                              ,
                              −
                              ,
                              ∗
                              ,
                              /
                              )
                           
                        , in a way that is very similar to computing by hand (except that ‘digits’ are numbers between 0 and 
                           
                              
                                 2
                              
                              
                                 32
                              
                           
                           −
                           1
                         instead of 
                           0
                           ,
                           1
                           ,
                           …
                           ,
                           9
                        ). Some programming libraries, such as GMP  [10], provide efficient implementations of these integer-arithmetics operations, optimized from both an algorithmic point of view (Fourier transform for large numbers) and implementation point of view (assembly for some architectures). Once you have this implementation of arithmetic operations for integers of arbitrary length, it is possible to implement a floating point number as a couple of two (arbitrary length) integers, that represent the mantissa and the exponent. Arithmetic operations are then implemented, making sure that each significant bit is represented in the result, using dynamic allocation. This is the strategy taken by  [11], a widely used programming library. At this point, one may directly use MPFR to implement the predicates, however, this makes the software dependent on MPFR and GMP, that are quite difficult to install/compile on non-Unix platforms. Note that MPFR is a very general software library, that implements not only basic algebraic operations, but also transcendental functions, accurate control of the rounding modes,…. In our context, to implement the geometric predicates, we only need three algebraic operations 
                           
                              (
                              +
                              ,
                              −
                              ,
                              ∗
                              )
                           
                        . Note also that in the end, we only need to evaluate the sign (positive, zero or negative) of the result. Is there a way of having a more “minimalist” implementation, easy to compile, and with only the functionality that we need?


                        A minimalist solution: expansion arithmetics: We now take again a look at Shewchuck’s predicates[1], but this time, instead of taking the point of view of a user of the predicates, we need to understand the underlying principles, in order to be able to derive our owns predicates. Shewchuk’s predicates use a form of exact arithmetics that is different from the arbitrary-length integers mentioned in the previous paragraph. The idea is again to represent a number as a set of components 
                           x
                           
                              [
                              0
                              ]
                           
                           …
                           x
                           
                              [
                              l
                              −
                              1
                              ]
                           
                        , but this time each component is a floating point number, and the array represents the real number given by 
                           
                              
                                 x
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       l
                                    
                                 
                                 x
                                 
                                    [
                                    i
                                    ]
                                 
                                 .
                              
                           
                         In addition, all the operations are specified to ensure an important property, that the sign of 
                           x
                         is completely determined by the size of the last component: 
                           
                              
                                 Sign
                                 
                                    (
                                    x
                                    )
                                 
                                 =
                                 Sign
                                 
                                    (
                                    x
                                    
                                       [
                                       l
                                       −
                                       1
                                       ]
                                    
                                    )
                                 
                                 .
                              
                           
                         In a nutshell, this property is enforced by ensuring that all the components are sorted by increasing exponents, and by ensuring that the exponents are sufficiently separated (or non-overlapping) so that the sum 
                           x
                           
                              [
                              0
                              ]
                           
                           +
                           ⋯
                           x
                           
                              [
                              l
                              −
                              2
                              ]
                           
                         has a smaller magnitude than the least significant bit of 
                           x
                           
                              [
                              l
                              −
                              1
                              ]
                           
                        . An array of floating point numbers that satisfies this condition is referred to as a non-overlapping expansion. Shewchuk provides C implementations for the following operations: 
                           
                              •
                              
                                 two-sum(
                                 
                                    d
                                    o
                                    u
                                    b
                                    l
                                    e
                                 , 
                                    d
                                    o
                                    u
                                    b
                                    l
                                    e
                                 
                                 )
                                 
                                    →
                                 
                                 
                                    
                                       (
                                       2
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                              


                                 grow-expansion(
                                 
                                    d
                                    o
                                    u
                                    b
                                    l
                                    e
                                 , 
                                    
                                       (
                                       k
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                                 )
                                 
                                    →
                                 
                                 
                                    
                                       (
                                       k
                                       +
                                       1
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                              


                                 expansion-sum(
                                 
                                    
                                       (
                                       k
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 , 
                                    
                                       (
                                       l
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                                 )
                                 
                                    →
                                 
                                 
                                    
                                       (
                                       k
                                       +
                                       l
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                              


                                 scale-expansion(
                                 
                                    d
                                    o
                                    u
                                    b
                                    l
                                    e
                                 , 
                                    
                                       (
                                       k
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                                 )
                                 
                                    →
                                 
                                 
                                    
                                       (
                                       2
                                       k
                                       )
                                    
                                    e
                                    x
                                    p
                                    a
                                    n
                                    s
                                    i
                                    o
                                    n
                                 
                              

Starting from these 4 functions as building blocs, I implemented expansion-product, by recursively calling scale-expansion and expansion-sum (a method referred to as distillation in Shewchuk’s article). This gives a class expansion with functions for the three algebraic operations 
                           
                              (
                              +
                              ,
                              −
                              ,
                              ∗
                              )
                           
                         and obtaining the sign at the end. To ensure that the code will remain efficient, even in a multithreaded environment, my expansion class allocates space on the stack instead of the heap, since there is (in most systems) a global lock on the heap, not well suited to multithreaded environments. In addition to the (low-level) expansion class, I implemented an (easier to use but less efficient) expansion_nt wrapper (expansion “number type”), that overloads the operators 
                           
                              (
                              +
                              ,
                              −
                              ,
                              ∗
                              )
                           
                        . The resulting library is minimalist and compact (only a few hundred lines of C++ code, or 3000 lines if comments are counted). I experimented it on several OSes and architectures (PC Windows, PC Unix, Mac, Intel MIC 64-cores, Android phones with ARM v7 chips…). The C++ source code (BSD license) is available from the following address: http://gforge.inria.fr/geogram, together with a script that generate the C++ function of a predicate from its formula and its symbolic perturbation.

I shall now explain how to use the Predicate Construction Kit to (robustly) compute the intersection between a 3D Voronoi diagram and a tetrahedral mesh. This is the key component to several 3D meshing algorithm that we are currently investigating, such as adaptive Voronoi meshing for flow simulation  [5,6], adaptive simplicial meshing  [7,8], and hex-dominant meshing  [9]. In the context of 3d modeling for oil and gas exploration, the degenerate configurations are encountered very often, due to both the geometry of the input (thin layers, onlaps, …) and the nature of the algorithms  [12].

For instance, the algorithm in  [5,6] aims at generating a Voronoi diagram with cell facets that match some predefined interfaces (such as the boundaries between geological layers and geological faults), which will create degenerate configurations when computing the intersections between the cells and those interfaces. For this reason, in order to have a robust implementation of this software component, we have no other choice than carefully analyzing the predicates involved in the intersection algorithm, and developing a robust version of them. Before detailing the predicates, I shall present the general algorithm (next page) that computes the intersections:


                     
                        
                           
                        
                     
                  

The algorithm works by propagating simultaneously over the tetrahedra and the power cells. It traverses all the couples 
                        
                           (
                           t
                           ,
                           i
                           )
                        
                      such that the tetrahedron 
                        t
                      has a non-empty intersection with the power cell of 
                        
                           
                              
                                 y
                              
                           
                           
                              i
                           
                        
                     . (1) Propagation is initialized by starting from an arbitrary tetrahedron 
                        t
                      and a point 
                        
                           
                              
                                 y
                              
                           
                           
                              i
                           
                        
                      that has a non-empty intersection between its power cell and 
                        t
                     . I use the point 
                        
                           
                              
                                 y
                              
                           
                           
                              i
                           
                        
                      that minimizes its power distance 
                        
                           
                              
                                 ‖
                                 
                                    
                                       
                                          y
                                       
                                    
                                    
                                       i
                                    
                                 
                                 −
                                 .
                                 ‖
                              
                           
                           
                              2
                           
                        
                        −
                        
                           
                              w
                           
                           
                              i
                           
                        
                      to one of the vertices of 
                        t
                     . (2) A tetrahedron 
                        t
                      and a Voronoi cell 
                        Del
                        
                           
                              
                                 y
                              
                           
                           
                              i
                           
                        
                      can be both described as the intersection of half-spaces, as well as the intersection 
                        t
                        ∩
                        Del
                        
                           
                              
                                 y
                              
                           
                           
                              i
                           
                        
                     , computed using re-entrant clipping (each half-space is removed iteratively). I use two version of the algorithm, a non-robust one that uses floating point arithmetics, and a robust one. (3) Each intersection 
                        P
                        =
                        t
                        ∩
                        Vor
                        
                           
                              
                                 y
                              
                           
                           
                              i
                           
                        
                      is passed back to client code (that does what it needed to do with it). The convex 
                        P
                      is illustrated in the (2d) Fig. 1
                      as the grayed area (in 3d, 
                        P
                      is a convex polyhedron). The algorithm then propagates to both neighboring tetrahedra and points (points are neighbors if they are connected with a Delaunay edge). (4) Each facet of 
                        P
                      generated by a Voronoi cell facet triggers propagation to a neighboring point. In the 2d example of the figure, this corresponds to edges 
                        
                           
                              e
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              e
                           
                           
                              3
                           
                        
                      that trigger propagation to points 
                        
                           
                              y
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    1
                                 
                              
                           
                        
                      and 
                        
                           
                              y
                           
                           
                              
                                 
                                    j
                                 
                                 
                                    2
                                 
                              
                           
                        
                      respectively. (5) Each portion of a facet of 
                        t
                      that remains in 
                        P
                      triggers a propagation to a neighboring tetrahedron 
                        
                           
                              t
                           
                           
                              ′
                           
                        
                     . In the 2d example of Fig. 1, this corresponds to edges 
                        
                           
                              e
                           
                           
                              1
                           
                        
                      and 
                        
                           
                              e
                           
                           
                              4
                           
                        
                      that trigger a propagation to triangles 
                        
                           
                              t
                           
                           
                              2
                           
                        
                      and 
                        
                           
                              t
                           
                           
                              1
                           
                        
                      respectively.

This algorithm is parallelized, by partitioning the mesh 
                        M
                      into 
                        
                           
                              M
                           
                           
                              1
                           
                        
                     , 
                        
                           
                              M
                           
                           
                              2
                           
                        
                        ,
                        …
                        ,
                        
                           
                              M
                           
                           
                              n
                              b
                              _
                              c
                              o
                              r
                              e
                              s
                           
                        
                      and by computing in each thread 
                        
                           
                              M
                           
                           
                              
                                 thrd
                              
                           
                        
                        ∩
                        Del
                        
                           (
                           Y
                           )
                        
                     .

In the algorithm, the convex clipping operation (step 2) is the only moment where exact predicates are used. This operation takes as an input a tetrahedron and a Voronoi cell, and returns the intersection between them. It can be implemented in an iterative/reentrant manner: the Voronoi cell can be described as the intersection of half-spaces (the bisectors of the Delaunay edges). Each iteration will “chop-off” a half-space from the result. It means that the only needed predicate is a form of orient3d, that classifies a point with respect to a bisector. However, the setting is significantly more complicated, since starting from the second facet of the Voronoi cell, we need to classify points that were the result of previous intersections. This difficulty can be dealt with by replacing in each predicate the intersection points with their expression in function of the data (tetrahedral mesh vertices and Delaunay vertices). Depending on the involved points, several configurations can occur. Fortunately, the total number of configurations remains reasonably small (four configurations in 3d). The rest of this section introduces the relevant definitions, gives the general formula for all possible configurations in arbitrary dimension, together with the symbolic perturbations that allow degenerate configurations to escape. The formulas in our 3d setting are also given. The implementation of the predicates is freely available in PCK (http://gforge.inria.fr/geogram). The derivations are provided below for the interested reader.


                     Warning–boring material ahead!
                  


                     The rest of this section may be skipped in a first reading.
                  


                        
                           Definition 1
                           The (additively) weighted distance (or power distance) 
                                 
                                    
                                       d
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       p
                                    
                                    ,
                                    
                                       q
                                    
                                    )
                                 
                               between a weighted point 
                                 
                                    (
                                    
                                       p
                                    
                                    ,
                                    w
                                    )
                                 
                               and a point 
                                 
                                    q
                                 
                               is defined by 
                                 
                                    
                                       
                                          
                                             d
                                          
                                          
                                             W
                                          
                                       
                                       
                                          (
                                          
                                             p
                                          
                                          ,
                                          
                                             q
                                          
                                          )
                                       
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                       
                                          
                                             
                                                ‖
                                                
                                                   p
                                                
                                                −
                                                
                                                   q
                                                
                                                ‖
                                             
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       w
                                       .
                                    
                                 
                              
                           


                        
                           Definition 2
                           The bisector 
                              
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               of the pair of weighted points 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 ,
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          w
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               is defined by 
                                 
                                    
                                       
                                          
                                             Π
                                          
                                          
                                             W
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                       
                                          {
                                          
                                             q
                                          
                                          |
                                          
                                             
                                                d
                                             
                                             
                                                W
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                q
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                d
                                             
                                             
                                                W
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                q
                                             
                                             )
                                          
                                          }
                                       
                                       =
                                       
                                          {
                                          
                                             q
                                          
                                          |
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      q
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   −
                                                   
                                                      q
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          0
                                          }
                                       
                                       =
                                       
                                          {
                                          
                                             q
                                          
                                          |
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      q
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   −
                                                   
                                                      q
                                                   
                                                   )
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                q
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             +
                                             
                                                q
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          0
                                          }
                                       
                                       =
                                       
                                          {
                                          
                                             q
                                          
                                          |
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   (
                                                   
                                                      q
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          =
                                          0
                                          }
                                       
                                       .
                                    
                                 
                              
                           


                        
                           Observation 1
                           
                              The intersection 
                              
                                 
                                    q
                                 
                               
                              between 
                              
                                 d
                               
                              bisectors 
                              
                                 
                                    
                                       Π
                                    
                                    
                                       w
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ,
                                 …
                                 
                                    
                                       Π
                                    
                                    
                                       w
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                               
                              and a 
                              
                                 d
                              
                              -simplex 
                              
                                 
                                    Δ
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    …
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                               
                              can be obtained in barycentric form as 
                              
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    
                                       
                                          q
                                       
                                    
                                    
                                       i
                                    
                                 
                              
                              . The barycentric coordinates 
                              
                                 
                                    (
                                    
                                       
                                          λ
                                       
                                       
                                          i
                                       
                                    
                                    )
                                 
                               
                              are given by
                              
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                =
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ⋮
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               −
                                                               w
                                                               1
                                                               +
                                                               w
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               ⋮
                                                            
                                                         
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   )
                                                
                                                +
                                                b
                                             
                                          
                                          
                                             
                                                
                                                   where
                                                
                                                
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            i
                                                            ,
                                                            j
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            1
                                                            ≤
                                                            i
                                                            ≤
                                                            d
                                                         
                                                         
                                                            0
                                                            ≤
                                                            j
                                                            ≤
                                                            d
                                                         
                                                      
                                                   
                                                
                                                =
                                                2
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  q
                                                               
                                                            
                                                            
                                                               j
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                                ;
                                                
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            i
                                                         
                                                      
                                                   
                                                   
                                                      1
                                                      ≤
                                                      i
                                                      ≤
                                                      d
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                         ‖
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         ‖
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                      ×
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                =
                                                
                                                   
                                                      
                                                     ;
                                                
                                                Δ
                                                =
                                                
                                                   |
                                                   A
                                                   |
                                                
                                                ;
                                                
                                             
                                          
                                          
                                             
                                                B
                                                =
                                                Δ
                                                
                                                   
                                                      A
                                                   
                                                   
                                                      −
                                                      1
                                                   
                                                
                                                =
                                                
                                                   (
                                                   
                                                      
                                                         
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        
                           Proof
                           
                              
                                 
                                    
                                       
                                          
                                             
                                                The intersection  
                                                
                                                   q
                                                
                                                  satisfies:
                                                
                                                   {
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            =
                                                            1
                                                            ;
                                                         
                                                         
                                                            
                                                               q
                                                            
                                                            =
                                                            
                                                               
                                                                  ∑
                                                               
                                                               
                                                                  i
                                                                  =
                                                                  0
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            
                                                               
                                                                  
                                                                     q
                                                                  
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ∀
                                                            1
                                                            ≤
                                                            i
                                                            ≤
                                                            d
                                                            ,
                                                         
                                                         
                                                            
                                                               q
                                                            
                                                            ∈
                                                            
                                                               
                                                                  Π
                                                               
                                                               
                                                                  W
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               ,
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                                in matrix form, using the equation of  
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   )
                                                
                                                  (   Definition 2):
                                             
                                          
                                          
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                         
                                                            …
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            2
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              q
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            …
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              q
                                                                           
                                                                        
                                                                        
                                                                           d
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                         
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            2
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              q
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            …
                                                         
                                                         
                                                            2
                                                            
                                                               
                                                                  
                                                                     (
                                                                     
                                                                        
                                                                           
                                                                              q
                                                                           
                                                                        
                                                                        
                                                                           d
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     )
                                                                  
                                                               
                                                               
                                                                  t
                                                               
                                                            
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ‖
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           1
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     ‖
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ‖
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           2
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     ‖
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     ‖
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           d
                                                                        
                                                                     
                                                                     −
                                                                     
                                                                        
                                                                           
                                                                              p
                                                                           
                                                                        
                                                                        
                                                                           0
                                                                        
                                                                     
                                                                     ‖
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                or with the notations above:
                                                
                                                   
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                     
                                                                        …
                                                                     
                                                                     
                                                                        1
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              1
                                                                              ,
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              1
                                                                              ,
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              1
                                                                              ,
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        ⋮
                                                                     
                                                                     
                                                                     
                                                                     
                                                                        ⋮
                                                                     
                                                                  
                                                                  
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              0
                                                                           
                                                                        
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              1
                                                                           
                                                                        
                                                                     
                                                                     
                                                                     
                                                                        
                                                                           
                                                                              a
                                                                           
                                                                           
                                                                              d
                                                                              ,
                                                                              d
                                                                           
                                                                        
                                                                     
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         ︸
                                                      
                                                   
                                                   
                                                      A
                                                   
                                                
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                          
                                             
                                                =
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            1
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                                +
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            0
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            −
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  w
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                               thus we have: 
                                 
                                    
                                       
                                          
                                             
                                                Δ
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                         
                                                      
                                                      
                                                         
                                                            ⋮
                                                         
                                                      
                                                      
                                                         
                                                            
                                                               
                                                                  λ
                                                               
                                                               
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   ]
                                                
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  A
                                                               
                                                               
                                                                  −
                                                                  1
                                                               
                                                            
                                                         
                                                         ︸
                                                      
                                                   
                                                   
                                                      B
                                                   
                                                
                                                
                                                   (
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               1
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ⋮
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               0
                                                            
                                                         
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ⋮
                                                            
                                                         
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   (
                                                   
                                                      
                                                         
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      
                                                   
                                                
                                             
                                          
                                          
                                             
                                             
                                                =
                                             
                                             
                                                
                                                   
                                                      B
                                                   
                                                   
                                                      ′
                                                   
                                                
                                                
                                                   (
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ⋮
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  
                                                                     l
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   +
                                                   
                                                      [
                                                      
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     1
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               ⋮
                                                            
                                                         
                                                         
                                                            
                                                               −
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     d
                                                                  
                                                               
                                                               +
                                                               
                                                                  
                                                                     w
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                            
                                                         
                                                      
                                                      ]
                                                   
                                                   )
                                                
                                                +
                                                b
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                              □


                        
                           Definition 3
                           The predicates 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       q
                                    
                                    )
                                 
                               determines the position of 
                                 
                                    q
                                 
                               relative to the bisector 
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                side
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             q
                                          
                                          )
                                       
                                       
                                       returns
                                       
                                       
                                          {
                                          
                                             
                                                
                                                   +
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         q
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                   <
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         q
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   0
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         q
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                   =
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         q
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   1
                                                
                                                
                                                   if
                                                   
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         q
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            0
                                                         
                                                      
                                                      )
                                                   
                                                   >
                                                   
                                                      
                                                         d
                                                      
                                                      
                                                         W
                                                      
                                                   
                                                   
                                                      (
                                                      
                                                         q
                                                      
                                                      ,
                                                      
                                                         
                                                            
                                                               p
                                                            
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                      )
                                                   
                                                   .
                                                
                                             
                                          
                                       
                                    
                                 
                               Using the definition of 
                                 
                                    
                                       d
                                    
                                    
                                       W
                                    
                                 
                               (Definition 1), 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       1
                                    
                                 
                                is given by 
                                 
                                    
                                       
                                          
                                             
                                                side
                                             
                                          
                                          
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             q
                                          
                                          )
                                       
                                       
                                          
                                             =
                                          
                                          
                                             def
                                          
                                       
                                       
                                          
                                             d
                                          
                                          
                                             w
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                1
                                             
                                          
                                          ,
                                          
                                             q
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             d
                                          
                                          
                                             w
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          
                                             q
                                          
                                          )
                                       
                                       =
                                       Sign
                                       
                                          (
                                          
                                             
                                                
                                                   ‖
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ‖
                                                
                                             
                                             
                                                2
                                             
                                          
                                          −
                                          2
                                          
                                             
                                                
                                                   (
                                                   
                                                      q
                                                   
                                                   −
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   )
                                                
                                             
                                             
                                                t
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                          +
                                          
                                             
                                                w
                                             
                                             
                                                0
                                             
                                          
                                          −
                                          
                                             
                                                w
                                             
                                             
                                                1
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                           


                        Main Term and Simulation of Simplicity for
                        
                           
                              
                                 
                                    side
                                 
                              
                              
                                 1
                              
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 q
                              
                              )
                           
                        
                     


                        
                           
                              •
                              Main term: 
                                    Sign
                                    
                                       (
                                       l
                                       −
                                       a
                                       )
                                    
                                 ,

where 
                                    a
                                    =
                                    2
                                    
                                       
                                          
                                             (
                                             
                                                q
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             )
                                          
                                       
                                       
                                          t
                                       
                                    
                                    
                                       (
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             1
                                          
                                       
                                       −
                                       
                                          
                                             
                                                p
                                             
                                          
                                          
                                             0
                                          
                                       
                                       )
                                    
                                  and 
                                    l
                                    =
                                    
                                       
                                          
                                             ‖
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             −
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ‖
                                          
                                       
                                       
                                          2
                                       
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                 : 
                                    +
                                    1
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                 : 
                                    −
                                    1
                                 
                              


                        
                           Definition 4
                           The predicates 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                               determines the position of 
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 …
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    Δ
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          d
                                       
                                    
                                    )
                                 
                               relative to 
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         d
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                                
                                                   
                                                      =
                                                   
                                                   
                                                      def
                                                   
                                                
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         d
                                                         +
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      q
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                where
                                                
                                                
                                                   q
                                                
                                                =
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                …
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                ∩
                                                
                                                   Δ
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   …
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         d
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Main Term and Simulation of Simplicity for
                        
                           
                              
                                 
                                    side
                                 
                              
                              
                                 d
                                 +
                                 1
                              
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    d
                                    +
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              …
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    d
                                    +
                                    1
                                 
                              
                              )
                           
                        
                     


                        
                           
                              •
                              Main term: 
                                    Sign
                                    
                                       (
                                       Δ
                                       
                                          
                                             l
                                          
                                          
                                             d
                                             +
                                             1
                                          
                                       
                                       −
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         d
                                                         +
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                   …
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         d
                                                         +
                                                         1
                                                         ,
                                                         d
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          (
                                          
                                             
                                                B
                                             
                                             
                                                ′
                                             
                                          
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            1
                                                         
                                                      
                                                   
                                                
                                                
                                                   
                                                      ⋮
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            l
                                                         
                                                         
                                                            d
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          +
                                          b
                                          )
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                 : 
                                    Sign
                                    
                                       (
                                       −
                                       
                                          
                                             ∑
                                          
                                          
                                             i
                                             =
                                             0
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             1
                                          
                                          
                                             d
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             i
                                             ,
                                             j
                                          
                                          
                                             ′
                                          
                                       
                                       
                                          
                                             a
                                          
                                          
                                             d
                                             +
                                             1
                                             ,
                                             i
                                          
                                       
                                       +
                                       Δ
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          i
                                       
                                    
                                    ;
                                    1
                                    ≤
                                    i
                                    ≤
                                    d
                                 : 
                                    Sign
                                    
                                       (
                                       
                                          
                                             ∑
                                          
                                          
                                             j
                                             =
                                             0
                                          
                                          
                                             d
                                          
                                       
                                       
                                          (
                                          
                                             
                                                a
                                             
                                             
                                                d
                                                +
                                                1
                                                ,
                                                j
                                             
                                          
                                          
                                             
                                                b
                                             
                                             
                                                j
                                                ,
                                                i
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                 : 
                                    −
                                    1
                                 
                              


                        
                           
                              
                                 
                                    
                                       
                                          where
                                       
                                    
                                    
                                       
                                          
                                             {
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  a
                                                               
                                                               
                                                                  i
                                                                  ,
                                                                  j
                                                               
                                                            
                                                         
                                                         
                                                            
                                                               
                                                                  1
                                                                  ≤
                                                                  i
                                                                  ≤
                                                                  d
                                                                  +
                                                                  1
                                                               
                                                               
                                                                  0
                                                                  ≤
                                                                  j
                                                                  ≤
                                                                  d
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  
                                                                     j
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               i
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  l
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                         
                                                            1
                                                            ≤
                                                            i
                                                            ≤
                                                            d
                                                         
                                                      
                                                   
                                                   
                                                      =
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ‖
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               ‖
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          ;
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                A
                                             
                                             
                                                d
                                                +
                                                1
                                                ×
                                                d
                                                +
                                                1
                                             
                                          
                                          =
                                          
                                             
                                                
                                             
                                          
                                       
                                    
                                    
                                       
                                          Δ
                                          =
                                          
                                             |
                                             A
                                             |
                                          
                                          ;
                                          
                                       
                                    
                                    
                                       
                                          
                                             
                                                B
                                             
                                             
                                                d
                                                +
                                                1
                                                ×
                                                d
                                                +
                                                1
                                             
                                          
                                          =
                                          Δ
                                          
                                             
                                                A
                                             
                                             
                                                −
                                                1
                                             
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             (
                                             
                                                
                                                   
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           
                        
                     


                        
                           Proof
                           To obtain the expression of 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                              , we inject the expression 
                                 Δ
                                 
                                    (
                                    
                                       q
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                                 =
                                 
                                    
                                       ∑
                                    
                                    
                                       i
                                       =
                                       0
                                    
                                    
                                       d
                                    
                                 
                                 Δ
                                 
                                    
                                       λ
                                    
                                    
                                       i
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          i
                                       
                                    
                                    −
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    )
                                 
                               into 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       1
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          d
                                          +
                                          1
                                       
                                    
                                    ,
                                    Δ
                                    
                                       q
                                    
                                    )
                                 
                                 ×
                                 Sign
                                 
                                    (
                                    Δ
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                side
                                             
                                          
                                          
                                             d
                                             +
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   p
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          ,
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                0
                                             
                                          
                                          ,
                                          …
                                          ,
                                          
                                             
                                                
                                                   q
                                                
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          )
                                       
                                       =
                                       Sign
                                       
                                          (
                                          Δ
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ‖
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     d
                                                                     +
                                                                     1
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               ‖
                                                            
                                                         
                                                         
                                                            2
                                                         
                                                      
                                                   
                                                   ︸
                                                
                                             
                                             
                                                
                                                   
                                                      =
                                                   
                                                   
                                                      def
                                                   
                                                
                                                
                                                   
                                                      l
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                   
                                                
                                             
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                d
                                             
                                          
                                          Δ
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      2
                                                      
                                                         
                                                            
                                                               (
                                                               
                                                                  
                                                                     
                                                                        q
                                                                     
                                                                  
                                                                  
                                                                     i
                                                                  
                                                               
                                                               −
                                                               
                                                                  
                                                                     
                                                                        p
                                                                     
                                                                  
                                                                  
                                                                     0
                                                                  
                                                               
                                                               )
                                                            
                                                         
                                                         
                                                            t
                                                         
                                                      
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               d
                                                               +
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   ︸
                                                
                                             
                                             
                                                
                                                   
                                                      =
                                                   
                                                   
                                                      def
                                                   
                                                
                                                
                                                   
                                                      a
                                                   
                                                   
                                                      d
                                                      +
                                                      1
                                                      ,
                                                      i
                                                   
                                                
                                             
                                          
                                          +
                                          Δ
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   w
                                                
                                                
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ×
                                       Sign
                                       
                                          (
                                          Δ
                                          )
                                       
                                       =
                                       Sign
                                       
                                          (
                                          Δ
                                          
                                             
                                                l
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                0
                                             
                                             
                                                d
                                             
                                          
                                          Δ
                                          
                                             
                                                λ
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                a
                                             
                                             
                                                d
                                                +
                                                1
                                                ,
                                                i
                                             
                                          
                                          +
                                          Δ
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   w
                                                
                                                
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ×
                                       Sign
                                       
                                          (
                                          Δ
                                          )
                                       
                                       =
                                       Sign
                                       
                                          (
                                          Δ
                                          
                                             
                                                l
                                             
                                             
                                                d
                                                +
                                                1
                                             
                                          
                                          −
                                          
                                             [
                                             
                                                
                                                   
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            d
                                                            +
                                                            1
                                                            ,
                                                            0
                                                         
                                                      
                                                      …
                                                      
                                                         
                                                            a
                                                         
                                                         
                                                            d
                                                            +
                                                            1
                                                            ,
                                                            d
                                                         
                                                      
                                                   
                                                
                                             
                                             ]
                                          
                                          
                                             (
                                             
                                                
                                                   B
                                                
                                                
                                                   ′
                                                
                                             
                                             
                                                [
                                                
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         ⋮
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               l
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               d
                                                            
                                                         
                                                         +
                                                         
                                                            
                                                               w
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                      
                                                   
                                                
                                                ]
                                             
                                             +
                                             b
                                             )
                                          
                                          +
                                          Δ
                                          
                                             (
                                             
                                                
                                                   w
                                                
                                                
                                                   0
                                                
                                             
                                             −
                                             
                                                
                                                   w
                                                
                                                
                                                   d
                                                   +
                                                   1
                                                
                                             
                                             )
                                          
                                          )
                                       
                                       ×
                                       Sign
                                       
                                          (
                                          Δ
                                          )
                                       
                                       .
                                    
                                 
                               Each perturbation associated with each 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       i
                                    
                                 
                               is retrieved as the term that has 
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                               as a factor. □

I now make a simple observation that proves the robustness of the perturbation, i.e. its ability to escape from any singular configuration: 
                           Observation 2
                           
                              There is always at least one term in the Taylor expansion of 
                              
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                                 
                                    (
                                    )
                                 
                               
                              perturbed by 
                              
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 =
                                 
                                    
                                       ϵ
                                    
                                    
                                       i
                                    
                                 
                              
                              that is non-zero.
                           


                        
                           Proof
                           The term associated with 
                                 
                                    
                                       
                                          p
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                               is 
                                 −
                                 Sign
                                 
                                    (
                                    Δ
                                    )
                                 
                                 ×
                                 Sign
                                 
                                    (
                                    Δ
                                    )
                                 
                                 =
                                 −
                                 1
                              . □

For surfacic meshing, we need the expression of 
                           
                              
                                 
                                    side
                                 
                              
                              
                                 1
                              
                           
                         (point 
                           
                              q
                           
                         is directly given), 
                           
                              
                                 
                                    side
                                 
                              
                              
                                 2
                              
                           
                         (point 
                           
                              q
                           
                         is defined as the intersection between a bisector and a segment) and 
                           
                              
                                 
                                    side
                                 
                              
                              
                                 3
                              
                           
                         (point 
                           
                              q
                           
                         is defined as the intersection between two bisectors and a triangle). For volumetric meshing, in addition we need the expression of 
                           
                              
                                 
                                    side
                                 
                              
                              
                                 4
                              
                           
                         (point 
                           
                              q
                           
                         is defined as the intersection between three bisectors and a tetrahedron).


                        
                           Definition 5
                           The predicate 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       2
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                               determines the position of 
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    [
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ]
                                 
                               relative to 
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      2
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      q
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                where
                                                
                                                
                                                   q
                                                
                                                =
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ∩
                                                
                                                   [
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ]
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Main Term and Simulation of Simplicity for
                        
                           
                              
                                 
                                    side
                                 
                              
                              
                                 2
                              
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    1
                                 
                              
                              )
                           
                        
                     


                        
                           
                              •
                              Main term: 
                                    Sign
                                    
                                       (
                                       Δ
                                       
                                          
                                             l
                                          
                                          
                                             2
                                          
                                       
                                       −
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ,
                                                         0
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         2
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       
                                          [
                                          
                                             
                                                
                                                   −
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                   
                                                   
                                                      
                                                         l
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   −
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                 : 
                                    Sign
                                    
                                       (
                                       Δ
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             2
                                             ,
                                             0
                                          
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             2
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                 : 
                                    Sign
                                    
                                       (
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             2
                                             ,
                                             0
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             2
                                             ,
                                             1
                                          
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                 : 
                                    −
                                    1
                                 
                              


                        
                           Proof
                           These expressions are obtained by specializing the definition of 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       d
                                       +
                                       1
                                    
                                 
                               (Definition 3) with 
                                 d
                                 +
                                 1
                                 =
                                 2
                              . The 
                                 A
                               and 
                                 B
                               matrices are then as follows: 
                                 
                                    
                                       A
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   1
                                                
                                                
                                                   1
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                          
                                          )
                                       
                                       ;
                                       
                                       B
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                                
                                                   
                                                   
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       ;
                                       
                                       b
                                       =
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   −
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         1
                                                         ,
                                                         0
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       ;
                                       
                                       
                                          
                                             B
                                          
                                          
                                             ′
                                          
                                       
                                       =
                                       
                                          (
                                          
                                             
                                                
                                                   −
                                                   1
                                                
                                             
                                             
                                                
                                                   1
                                                
                                             
                                          
                                          )
                                       
                                       .
                                    
                                 
                              
                              □


                        
                           Definition 6
                           The predicate 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       3
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               determines the position of 
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    Δ
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                               relative to 
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      q
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                where
                                                
                                                
                                                   q
                                                
                                                =
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ∩
                                                
                                                   Δ
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            q
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                .
                                             
                                          
                                       
                                    
                                 
                              
                           


                        Main Term and Simulation of Simplicity for
                        
                           
                              
                                 
                                    side
                                 
                              
                              
                                 3
                              
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       q
                                    
                                 
                                 
                                    2
                                 
                              
                              )
                           
                        
                     


                        
                           
                              •
                              Main term: 
                                    Sign
                                    
                                       (
                                       Δ
                                       
                                          
                                             l
                                          
                                          
                                             3
                                          
                                       
                                       −
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                         ,
                                                         0
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                         ,
                                                         1
                                                      
                                                   
                                                   
                                                   
                                                      
                                                         a
                                                      
                                                      
                                                         3
                                                         ,
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       Δ
                                       
                                          [
                                          
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         λ
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          ]
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                 :


                                 
                                    Sign
                                    
                                       (
                                       Δ
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             0
                                          
                                       
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                0
                                                ,
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                0
                                                ,
                                                2
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             1
                                          
                                       
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                1
                                                ,
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                1
                                                ,
                                                2
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       −
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             2
                                          
                                       
                                       
                                          (
                                          
                                             
                                                b
                                             
                                             
                                                2
                                                ,
                                                1
                                             
                                             
                                                ′
                                             
                                          
                                          +
                                          
                                             
                                                b
                                             
                                             
                                                2
                                                ,
                                                2
                                             
                                             
                                                ′
                                             
                                          
                                          )
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                 : 
                                    Sign
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             0
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             1
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             ,
                                             1
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                 : 
                                    Sign
                                    
                                       (
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             0
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             0
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             1
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             1
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       +
                                       
                                          
                                             a
                                          
                                          
                                             3
                                             ,
                                             2
                                          
                                       
                                       
                                          
                                             b
                                          
                                          
                                             2
                                             ,
                                             2
                                          
                                          
                                             ′
                                          
                                       
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                 
                              

Perturbation of 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                 : -1


                        
                           Definition 7
                           The predicate 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       4
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               determines the position of 
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    Δ
                                 
                                 
                                    (
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             q
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               relative to 
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   side
                                                
                                             
                                             
                                                3
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   4
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          =
                                          
                                             
                                                
                                                   side
                                                
                                             
                                             
                                                1
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                q
                                             
                                             )
                                          
                                       
                                    
                                    
                                       
                                          where
                                          
                                          
                                             q
                                          
                                          =
                                          
                                             
                                                Π
                                             
                                             
                                                W
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             )
                                          
                                          ∩
                                          
                                             
                                                Π
                                             
                                             
                                                W
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             )
                                          
                                          ∩
                                          
                                             
                                                Π
                                             
                                             
                                                W
                                             
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      p
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          ∩
                                          
                                             Δ
                                          
                                          
                                             (
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   0
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   1
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   2
                                                
                                             
                                             ,
                                             
                                                
                                                   
                                                      q
                                                   
                                                
                                                
                                                   3
                                                
                                             
                                             )
                                          
                                          .
                                       
                                    
                                 
                              
                           

The expression of the main term and perturbations is not given here for keeping the length of the article reasonable. The reader may refer to the companion PCK (Predicate Construction Kit) sourcecode.

Note that dimension 3 is a particular case (i.e. the dimension of the ambient space coincides with the dimension of the simplex). In this case, three bisectors in generic position are sufficient to determine a point in 
                           3
                           d
                         (the simplex is no-longer needed). Interestingly, computations are much simpler in that case. For this reason, we introduce the following version of the predicate:


                        
                           Definition 8
                           The predicate 
                                 
                                    
                                       
                                          side
                                       
                                    
                                    
                                       4
                                    
                                    
                                       3
                                       d
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                               determines the position of 
                                 
                                    q
                                 
                                 =
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                    )
                                 
                                 ∩
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                    )
                                 
                               relative to 
                                 
                                    
                                       Π
                                    
                                    
                                       W
                                    
                                 
                                 
                                    (
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                    ,
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                    )
                                 
                              : 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      3
                                                   
                                                   
                                                      3
                                                      d
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         4
                                                      
                                                   
                                                   )
                                                
                                                =
                                                
                                                   
                                                      
                                                         side
                                                      
                                                   
                                                   
                                                      1
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   ,
                                                   
                                                      q
                                                   
                                                   )
                                                
                                             
                                          
                                          
                                             
                                                where
                                                
                                                
                                                   q
                                                
                                                =
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         1
                                                      
                                                   
                                                   )
                                                
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                   )
                                                
                                                ∩
                                                
                                                   
                                                      Π
                                                   
                                                   
                                                      W
                                                   
                                                
                                                
                                                   (
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         0
                                                      
                                                   
                                                   ,
                                                   
                                                      
                                                         
                                                            p
                                                         
                                                      
                                                      
                                                         3
                                                      
                                                   
                                                   )
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           

The predicate 
                           
                              
                                 
                                    side
                                 
                              
                              
                                 4
                              
                              
                                 3
                                 d
                              
                           
                         is equivalent to 
                           
                              insphere
                           
                        . See  [2] for more details. Using similar derivations (based on Kramer’s formula for solving linear systems), we obtain the following:


                        Main Term and Simulation of Simplicity for
                        
                           
                              
                                 
                                    side
                                 
                              
                              
                                 4
                              
                              
                                 3
                                 d
                              
                           
                           
                              (
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    0
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    1
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    2
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    3
                                 
                              
                              ,
                              
                                 
                                    
                                       p
                                    
                                 
                                 
                                    4
                                 
                              
                              )
                           
                        
                     


                        
                           
                              •
                              Main term:


                                 
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                                
                                                   −
                                                   
                                                      
                                                         
                                                            ‖
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            ‖
                                                         
                                                      
                                                      
                                                         2
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       )
                                    
                                    where
                                    
                                    Δ
                                    =
                                    
                                       |
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               1
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         (
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               3
                                                            
                                                         
                                                         −
                                                         
                                                            
                                                               
                                                                  p
                                                               
                                                            
                                                            
                                                               0
                                                            
                                                         
                                                         )
                                                      
                                                   
                                                   
                                                      t
                                                   
                                                
                                             
                                          
                                       
                                       |
                                    
                                 
                              

Perturbation for 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          0
                                       
                                    
                                 :


                                 
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       −
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       +
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       −
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       )
                                    
                                 
                              

Perturbation for 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          1
                                       
                                    
                                 : 
                                    
                                    
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       )
                                    
                                 
                              

Perturbation for 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          2
                                       
                                    
                                 : 
                                    −
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  3
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       )
                                    
                                 
                              

Perturbation for 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          3
                                       
                                    
                                 : 
                                    
                                    
                                    Sign
                                    
                                       (
                                       Δ
                                       )
                                    
                                    ×
                                    Sign
                                    
                                       (
                                       
                                          |
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  1
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  2
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                             
                                                
                                                   
                                                      
                                                         
                                                            (
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  4
                                                               
                                                            
                                                            −
                                                            
                                                               
                                                                  
                                                                     p
                                                                  
                                                               
                                                               
                                                                  0
                                                               
                                                            
                                                            )
                                                         
                                                      
                                                      
                                                         t
                                                      
                                                   
                                                
                                             
                                          
                                          |
                                       
                                       )
                                    
                                 
                              

Perturbation for 
                                    
                                       
                                          
                                             p
                                          
                                       
                                       
                                          4
                                       
                                    
                                 : 
                                    −
                                    1
                                 
                              

To test the algorithm, I first tried very degenerate configurations, such as the two ones depicted in Figs. 2 and 3
                     
                     . In the 2D configuration shown in Fig. 2, the Voronoi diagram and the mesh coincide exactly, thus causing singularities everywhere. The symbolic perturbations successfully escape from these singularities (as predicted by Observation 2). The 3D configuration shown in Fig. 3 consists in computing the intersection between the Voronoi diagram of two parallel grids of points and a square equidistant to both grids of points (left), in such a way that many Voronoi facets fall exactly on the square (right).

I experimented the algorithm in different application settings, comprising mesh generation with both Voronoi diagrams, Voronoi diagrams with anisotropy, Voronoi diagrams with the 
                        
                           
                              L
                           
                           
                              p
                           
                        
                      metric (for hex-dominant mesh generation).


                     Anisotropic mesh generation: Making the techniques robust to high anisotropy is very important for several simulation techniques, since it allows dramatically reducing the number of mesh elements while preserving the accuracy of the simulation. Fig. 4
                      shows the first results obtained with an anisotropic Voronoi diagram. To my knowledge, this is the first time an Anisotropic Voronoi diagram can be computed in 3d. It uses the idea of replacing anisotropy with a higher-dimensional embedding  [13]. In this specific case, I used an explicit 6d embedding, designed to create the variation of anisotropy shown in the figure. To represent anisotropy, the method uses a fine 1503 grid embedded in 6d space, and the dimension-independent expression of the predicates.


                     hex-dominant meshing: The 
                        
                           
                              L
                           
                           
                              p
                           
                        
                     -CVT algorithm  [14] provides a possible means of generating hex-dominant meshes. However it creates degenerate configuration in the Delaunay triangulation, with many co-spherical vertices, leading to difficulties in the predicates. The symbolic perturbation successfully escapes the singularities (as proved in theory), resulting in an algorithm that is robust in both the surfacic case (Fig. 5
                     ) and the volumetric case (Fig. 6
                     ). The shown mechanical part is a “crash test” for the algorithm: in addition with the degeneracies caused by Voronoi vertices aligned on a hex grid, it introduces coplanar surfaces and corcircular vertices in the mesh, an interesting benchmark for the predicates.


                     Optimal transport in 3d: Optimal Transport is an active research topic in mathematics  [15]. From a practical point of view, it is a promising way of designing new numerical solution mechanisms for some Partial Derivative Equations. Initially, Optimal Transport studies the following optimization problem, that tries to find the “cheapest” application 
                        T
                      that deforms a source measure 
                        μ
                      onto a target measure 
                        ν
                      (Monge’s problem): 
                        
                           
                              
                                 
                                    min
                                 
                                 
                                    T
                                 
                              
                              
                                 
                                    ∫
                                 
                                 
                                    Ω
                                 
                              
                              c
                              
                                 (
                                 
                                    x
                                 
                                 ,
                                 T
                                 
                                    (
                                    
                                       x
                                    
                                    )
                                 
                                 )
                              
                              d
                              μ
                              
                              subject to:
                              
                              ν
                              =
                              T
                              ♯
                              μ
                           
                        
                      where 
                        μ
                      and 
                        ν
                      are two probability measures on 
                        Ω
                      and where 
                        c
                        
                           (
                           
                              x
                           
                           ,
                           
                              y
                           
                           )
                        
                      is the “transport cost” (e.g.,  
                        
                           
                              
                                 ‖
                                 
                                    y
                                 
                                 −
                                 
                                    x
                                 
                                 ‖
                              
                           
                           
                              2
                           
                        
                      in 
                        
                           
                              L
                           
                           
                              2
                           
                        
                      optimal transport) and where the constraint 
                        ν
                        =
                        T
                        ♯
                        μ
                      means that 
                        T
                      “preserves mass” (
                        T
                      pushes 
                        μ
                      onto 
                        ν
                     ). Kantorovich introduces a relaxation of the problem that restores its symmetry and that exhibits some regularity in the dual formulation, thus allowing to study existence and uniqueness, depending on the cost function 
                        c
                        
                           (
                           .
                           ,
                           .
                           )
                        
                     . The value of the objective function is a distance between measures, called the Wasserstein measure 
                        W
                        
                           (
                           μ
                           ,
                           ν
                           )
                        
                     , that can be used to construct a metric space, thus providing means of interpolating between different measures.

In the specific case where 
                        μ
                      has a density 
                        u
                      (i.e.,  
                        μ
                        
                           (
                           B
                           )
                        
                        =
                        
                           
                              ∫
                           
                           
                              B
                           
                        
                        u
                        
                           (
                           x
                           )
                        
                        d
                        x
                     ) and 
                        ν
                        =
                        
                           
                              ∑
                           
                           
                              i
                              =
                              1
                           
                           
                              k
                           
                        
                        
                           
                              λ
                           
                           
                              i
                           
                        
                        
                           
                              δ
                           
                           
                              
                                 
                                    
                                       
                                          
                                             y
                                          
                                       
                                       
                                          ̱
                                       
                                    
                                 
                                 
                                    i
                                 
                              
                           
                        
                      is a sum of Dirac masses, Aurenhammer et al. remarked that the pre-image of the Dirac masses correspond to a power diagram [16]. The same result can be also directly obtained by specializing Optimal Transport theory (Kantorovich duality) to the semi-discrete case. Interestingly, the derivations of the proof in  [16] can be translated into an algorithm: the weights 
                        
                           W
                        
                        =
                        
                           
                              
                                 (
                                 
                                    
                                       w
                                    
                                    
                                       i
                                    
                                 
                                 )
                              
                           
                           
                              1
                           
                           
                              k
                           
                        
                      of the power diagram that determines the optimal transport can be determined as the (unique) maximum of a concave function 
                        f
                        
                           (
                           
                              W
                           
                           )
                        
                     . However, the resulting algorithm has a slow speed of convergence. For this reason, Mérigot proposed an algorithm and experimented it in 2d  [17]. To be generalized to the 3d case, the method needs to robustly compute the intersection between a power diagram and a tetrahedral mesh. This can be implemented using my PCK system, as I did in  [18] (see Fig. 7
                     ).


                     Compatibility with other programming libraries: The exact precision number type in my PCK system comes with two different APIs: the low-level one, that is most efficient, and the higher-level one, easier to use (but slower), that provides a “number type” expansion_nt with operator overloads (+,-,* and sign computation). We experimenting “grafting” it into CGAL. For standard datasets, difference of timings could not be distinguished, this is because arithmetic filters find the answer in most cases (in general, far less than 1 percent of the calls requires exact precision). To further analyze performance, we compared the performance of the Delaunay triangulation with a degenerate dataset,
                        2
                     
                     
                        2
                        with Andreas Fabri, during the 2015 CGAL meeting in Nancy.
                      with many points located on a regular grid, that nearly triggers the exact precision all the time. With CGAL’s default arbitrary precision number type it takes 1.2 s, and with PCK it takes 1.6 s, therefore the price to pay for the additional flexibility of PCK seems to stay reasonable. Moreover, we can probably still gain performance by writing some template specializations that avoid converting between number types and that use the more efficient lower-level API of PCK.


                     Conclusions: Computing the intersection between a 3d Voronoi diagram and a tetrahedral mesh requires some “exotic” predicates. They are not theoretically challenging, but their algebraic expression is quite involved. Transforming these predicates into a practical implementation required to develop some new unconventional software tools (and to use some existing ones). I made the PCK software tools presented here available under the BSD open-source license. The PCK code is fully documented, simple, portable and easy to compile. I think that the methodology presented here can be reused for a wider set of predicates. This leads to several suggestions for future work and open questions: 
                        
                           •
                           In its current state, the PCK code generation tool is a set of macros and scripts. It would be possible to write a cleaner (and more powerful) version completely in C++ (as an extension of FPG for instance);

Is the code completely correct? It was extensively tested, but testing does not show the absence of bugs (it shows their presence, as it did several times in this specific case!). To gain better certification, is it possible to use formal proof assistant tools? Such tools, such as Coq/Gasper, can analyze numerical code and prove some properties. It is so easy to do errors in this kind of code, that my point of view is that every possible way of certification should be used (experimental, theoretical, automatic formal verification).

@&#ACKNOWLEDGMENTS@&#

This research was funded by the following grants: ERC GOODSHAPE (ERC-StG-205693), ANR MORPHO (ANR-10-BLAN-0206) and ANR BECASIM (ANR-12-MONU-0007). I wish to thank the organizers of the International Meshing Roundtable for inviting me to give the talk that was at the origin of this article. I wish also to thank Jonathan Shewchuk for discussions, Andreas Fabri for a nice coding day in CGAL, and the anonymous reviewers for their feedback that helped to improve the article.


                     
                        
                           
                        
                     
                  

@&#REFERENCES@&#

