@&#MAIN-TITLE@&#Simulation-based heuristic method for container supply chain network optimization

@&#HIGHLIGHTS@&#


               
               
                  
                     
                        
                           
                           We propose a novel idea that considers optimization problem of multi-echelon container supply chain network.


                        
                        
                           
                           We develop a mixed integer programming model to minimize the total container supply chain service cost.


                        
                        
                           
                           We propose a simulation-based heuristic method to efficiently solve the problem.


                        
                     
                  
               
            

@&#KEYPHRASES@&#

Container supply chain

Network architecture

Simulation-based heuristic method

Genetic algorithm

Particle swarm optimization

@&#ABSTRACT@&#


               
               
                  With the emerging of free trade zones (FTZs) in the world, the service level of container supply chain plays an important role in the efficiency, quality and cost of the world trade. The performance of container supply chain network directly impacts its service level. Therefore, it is imperative to seek an appropriate method to optimize the container supply chain network architecture. This paper deals with the modeling and optimization problem of multi-echelon container supply chain network (MCSCN). The problem is formulated as a mixed integer programming model (MIP), where the objective is subject to the minimization of the total supply chain service cost. Since the problem is well known to be NP-hard, a novel simulation-based heuristic method is proposed to solving it, where the heuristic is used for searching near-optimal solutions, and the simulation is used for evaluating solutions and repairing unfeasible solutions. The heuristic algorithm integrates genetic algorithm (GA) and particle swarm optimization (PSO) algorithm, where the GA is used for global search and the PSO is used for local search. Finally, computational experiments are conducted to validate the performance of the proposed method and give some managerial implications.
               
            

@&#INTRODUCTION@&#

Container supply chain is an integrated system including transportation, packing, container storage, container loading, container transshipment, container unloading and unpacking. Container supply chain is essentially logistics service supply chain, which has characteristic features of service supply chain. However, there are some differences between them. (1) The structure of the container supply chain is more complex than that of logistics service supply chain. The container supply chain is made up of all the activities required to deliver containers to customers, such as inventory, transportation, loading/unloading, distribution, cargo and shipping agency, and customer service. However, the structure of logistics service supply chain is functional logistic service provider-logistics service integrator – manufacturers or retailers. (2) In the cost structure fold, container supply chain is also more complex, which refers shortage cost, transportation cost, handling cost, storage cost overstock cost. The logistics service supply chain generally only considers service cost. In all the activities, container supply chain is a network for satisfying value increment of the entire chain. The integration and collaboration of the container supply chain management processes and systems are more evident and become more necessary. The most necessary condition for maximizing economical, security and social benefits of the entire supply chain is the coordination of all nodes in container supply chain. With the mushroom development of the service economy in the world, the optimization and coordination of container supply chain network have become the mainstream in this research area.

With the emerging of free trade zones (FTZs) in the world, many manufacturing, service, logistics, port and shipping enterprises gather in FTZs, which does not only bring about huge logistics, but also bring about diversified product supply chain and service supply chain, such as container supply chain. FTZs have further requirements for higher efficiency and lower cost of global supply chain. Thus, the service level of container supply chain plays an important role in the efficiency, quality and cost of the world trade. The performance of container supply chain network directly impacts its service level.

In order to reduce costs, minimize inventories and of course, improve profits, effectively integrating the information flow, logistics, commerce flow and cash flow within the demand and supply process plays a very key role. For most node enterprises of container supply chain, such as inland yards, container terminals and shipping lines, two major and very interdependent issues must be simultaneously addressed. The first issue is delivering containers with very short lead times at a customer-acceptable cost. The second issue is sharing the effective, high-quality and timely information. Regardless of anyone in container supply chain, more effective supply chain network will be a prerequisite to win–win cooperation. In fact, effective container supply chain management must become an integral part of competitive and survival strategy. Therefore, we must seek appropriate method to optimize the network architecture of container supply chain from the entire chain perspective.

This rest of the paper is organized as follows. In the next section, relevant literatures are reviewed. In Section 3, mathematical models are formulated for our problem. Section 4 proposes a simulation-based heuristic for resolving our problem. Numerical experiments for evaluating the proposed model and heuristic are performed in Section 6, and some concluding remarks and future research are given in the last section.

@&#LITERATURE REVIEW@&#

To date, there are numerous studies on supply chain management [1]. Most of these studies have been devoted to product supply chain or service supply chain management. However, container supply chain management is rarely addressed. Although container supply chain close to logistics service supply chain, but these studies on logistics service supply chain only considered two or three echelons. The models and methods for logistics service supply chain are not entirely suited to our problem. Moreover, although container supply chain network optimization is imperative, most significant researches have focused on the empirical study. Since container supply chain is tightly related to logistics and port, only a brief review of studies highly related to service supply chain, logistics service supply chain and shipping supply chain are provided in this section.

Up to now, tremendous attentions have been appealed towards the research work on logistics service supply chain in achieving competitive advantage, such as logistics service supply chain network design and optimizing, selection of logistics service providers, supply chain integration and coordination with revenue-sharing contracts [2]. Zhen [3] proposed an optimal decision model for designing Service-Oriented Manufacturing supply chain strategy. Persson and Virum [4] developed a set of hypotheses concerning logistics service providers and their roles in supply chain alliances, and proposed a matrix categorizing the players and their strategic position. Choy et al. [5] proposed an integrated logistics management information system to integrate business processes and increase information transparency in the logistics supply chain for reducing uncertainty. Liu et al. [6] thought that a logistics service supply chain consists of one logistics service integrator and many functional logistics service providers, developed a two-echelon order allocation mode1 to establish a subjective utility function of each functional logistics service provider based on the cumulative prospect theory in two-period order allocation. Furthermore, Liu et al. [7] proposed a deterministic approach to the fairest revenue-sharing coefficient when the logistics service integrator and the functional logistics service provider implement revenue-sharing contract under stochastic demand condition. Jayaram and Tan [8] employed the support of extant theory to supply chain integration with third-party logistics providers. Liao and Kao [9] proposed an effective approach integrating quality function development, fuzzy extended analytic hierarchy process and multi-segment goal programming for logistics customer service management. Celebi et al. [10] used analytical network process for logistics management to increase the operational efficiency by facilitating greater collaboration and coordination with business partners.

Container supply chain is one part of shipping supply chain, which has drawn more attention from researchers in recent years. Talley [11] investigated the effects of carrier, port and shipper choice effects in shipping supply chain. Bichou and Gray [12] proposed relevant framework of port performance through conceptualizing ports from a logistics and supply chain management approach. Lam [13] proposed a tool to analyze patterns of ports and routes and shipping lines that are embedded within the shipping supply chain. Gibbs et al. [14] investigated the role of ports in helping to mitigate the emissions associated with the shipping supply chain. Barnes and Oloruntoba [15] highlighted the need for enhanced crisis management capabilities s and across supply networks. Moreover, Yang [16] used a loss exposure matrix and a bowtie diagram to evaluate the impact of risk factors on the shipping supply chain in Taiwan. Lam and Yap [17] investigated the calling patterns of container shipping services to understand the dynamics of liner shipping network and port connectivity in the supply chains and suggested a new classification scheme for mapping vulnerability within ports. Zhen and Chang [18] and Zhen [19] addressed the resource scheduling problems of port node in container supply chain.

As an effective approach for solving manufacturing systems, supply chain systems, financial management systems, transportation systems and logistics systems, simulation-based optimization method has drawn more attention from researchers in recent years. Arango et al. [20] constructed a simulation optimization framework for optimizing the port berth allocation planning problems. Jung et al. [21] used simulation based optimization approach to determine the safety stock level to use to meet a desired level of customer satisfaction. Schwartz et al. [22] proposed a simulation-based optimization framework for inventory management in supply chains under supply and demand uncertainty. Mourani et al. [23] proposed a bi-section search algorithm based on simulation and sample gradients for minimizing the long-run average inventory holding and backlogging cost of a single-stage single-product manufacturing system. Zeng and Yang [24] proposed a simulation-based optimization approach to solve an integrated handling equipment scheduling problem for loading operations. Lee et al. [25] proposed a simulation optimization method for robust flight scheduling. Legato et al. [26] proposed a simulation-based heuristic to generate and evaluate the container yard handling equipment assignment policy. Chang et al. [27] proposed a simulation optimization method for solving the combined berth allocation with quay cranes assignment, where the simulation was used to simulate the handling operations as the ships arrived and evaluate the performance of each schedules. He et al. [28] presented a simulation optimization method to solve the problem of sharing internal trucks among multiple container terminals in a large port with multiple adjacent terminals, where the GA was used for guiding the search process and the simulation was used for evaluating and adjusting schedules. Korytkowski et al. [29] proposed evolutionary simulation-based heuristics to construct near-optimal solutions for dispatching rule allocation. Zhen et al. [30] proposed a simulation optimization framework for ambulance deployment and relocation problems.

Therefore, it can be seen that most significant researches have only concerned with the evaluation of shipping supply chain. However, to our best knowledge, no paper has specially investigated the container supply chain, not to speak of modeling and optimizing the problem of the multi-echelon container supply chain network (MCSCN).

The literature survey also indicates that the simulation optimization is found to be quite powerful by various researchers to find the near-optimal solutions of combinatorial optimization problem such as supply chain systems optimization. Thus, different variations of simulation-based heuristic method are proposed for solving the MCSCN problem with the objective of minimizing total supply chain service cost.

The concept of container set is vital to the MCSCN problem. Therefore, we first define task container set as follow:


                        Container set: All containers, which load the same one or more of goods and satisfy the same requirements of goods type for customers, can be called a container set. For each container set, the origin is fixed, but the destination is not fixed. The origin of each container set may be a domestic inland yard (DIY), or a domestic container terminal (DCT), or an overseas container terminal (OCT) or an overseas inland yard (OIY). The destination of each container set only may be a DIY or an OIY.

In this paper, multi-echelon container supply chain only includes four parts, i.e., domestic inland yard (DIY), domestic container terminal (DCT), overseas container terminal (OCT) and overseas inland yard (OIY). A general four echelon container supply chain is shown in Fig. 1
                        . The first level enterprise is domestic inland yard and containers are delivered and received from and to DCTs. The second level enterprise is DCT and containers are discharged from vessels for delivering to DIY and loaded to vessels for delivering to OCT. The third level enterprise is OCT and containers are discharged from vessels for delivering to OIY and loaded to vessels for delivering to DCT. The fourth level enterprise is OIY and containers are delivered and received from and to OCT.

This paper specifically deals with the modeling and optimization of a four stage multi-echelon container supply chain network architecture using the simulation-based heuristic method. Total service cost of the container supply chain network is considered as a performance indicator. Each container supply chain echelon has a set of control parameters that affect the performance of the service cost, such as shortage cost, storage cost, handling cost and transporting cost. It optimizes container flows throughout the supply chain, gives the near-optimal container transportation plan.

Demands for each container set at each inland yard are different, and amount of each container set belonged to each inland yard also are different. In the container supply chain network optimization, we need considering six interrelated decisions: (1) the amount of a container set from a DIY to a DCT, (2) the amount of a container set from a DCT to a DIY, (3) the amount of a container set from a DCT to an OCT, (4) the amount of a container set from an OCT to a DCT, (5) the amount of a container set from an OCT to an OIY and (6) the amount of a container set from an OIY to an OCT.

The assumptions are presented as follows:
                           
                              (1)
                              The total time of container flows from the origin inland yard to destination inland yard is not considered as a performance indicator.

All container flows are for foreign trade, and domestic trade is not considered. If a DIY need a container set, no OIY also needs the same container set, and vice versa. The container flows from DIY to DIY or DCT to DCT or OIY to OIY or OCT to OCT or DIY to DCT to DIY or OIY to OCT to OIY are not allowed.

All cargo demanders, suppliers, inland yards and container terminals make up a container supply chain alliance. Containers can be transported freely among the alliance, except the unallowed container flows presented in the second assumption.

If a container set flows from a DCT to an OCT, the container set cannot flow from the OCT to any DCT. If a container set flows from a OCT to an DCT, the container set cannot flow from the DCT to any OCT.

There is no un-allowed route between DIYs and DCTs, and DCTs and OCTs, and OCTs and OIYs.

The storage capacity limit of all terminals and inland yards are not considered. The total real demand of each inland yard or each terminal for all container sets generally is not more than its storage capacity, and the minimization of the overstock cost is one of optimized objectives. Therefore, the schedule obtained from our solution method can ensure the total overstock of all container sets in all inland yards or terminals is minimum. Thus, the storage capacity of each inland yard or each terminal generally is not broken. Therefore, the assumption is reasonable.

Taking the average value of the storage time of all containers at all container terminals and all inland yards as the storage time of each container at a container terminal or an inland yard.


                        
                           
                              
                                 
                                 
                                 
                                    
                                       
                                          Parameters
                                       
                                    
                                    
                                       
                                          Ψ
                                       
                                       The set of all container sets (indexed by i). ∣Ψ∣=
                                          CS
                                       
                                    
                                    
                                       
                                          ϒ
                                       
                                       The set of all DIYs (indexed by j). ∣ϒ∣=
                                          DY
                                       
                                    
                                    
                                       
                                          Ω
                                       
                                       The set of all DCTs (indexed by k). ∣Ω∣=
                                          DT
                                       
                                    
                                    
                                       
                                          Λ
                                       
                                       The set of all OIYs (indexed by m). ∣Λ∣=
                                          OY
                                       
                                    
                                    
                                       ℓ
                                       The set of all OCTs (indexed by q). ∣ℓ∣=
                                          OT
                                       
                                    
                                    
                                       
                                          ady
                                          
                                             ij
                                          
                                       
                                       The amount of Container Set i at DIY j
                                       
                                    
                                    
                                       
                                          adt
                                          
                                             ik
                                          
                                       
                                       The amount of Container Set i at DCT k
                                       
                                    
                                    
                                       
                                          aoy
                                          
                                             im
                                          
                                       
                                       The amount of Container Set i at OIY m
                                       
                                    
                                    
                                       
                                          aot
                                          
                                             iq
                                          
                                       
                                       The amount of Container Set i at OCT q
                                       
                                    
                                    
                                       
                                          ddy
                                          
                                             ij
                                          
                                       
                                       The demand for Container Set i at DIY j
                                       
                                    
                                    
                                       
                                          doy
                                          
                                             im
                                          
                                       
                                       The demand for Container Set i at OIY m
                                       
                                    
                                    
                                       
                                          cty
                                          
                                             jk
                                          
                                       
                                       The transportation time between DIY j and DCT k (unit: h)
                                    
                                    
                                       
                                          ctc
                                          
                                             kq
                                          
                                       
                                       The transportation time between DCT k and OCT q (unit: h)
                                    
                                    
                                       
                                          cto
                                          
                                             qm
                                          
                                       
                                       The transportation time between OCT q and OIY m (unit: h)
                                    
                                    
                                       
                                          uty
                                          
                                             jk
                                          
                                       
                                       The unit transportation cost between DIY j and DCT k (unit: $/h)
                                    
                                    
                                       
                                          utc
                                          
                                             kq
                                          
                                       
                                       The unit transportation cost between DCT k and OCT q (unit: $/h)
                                    
                                    
                                       
                                          uto
                                          
                                             qm
                                          
                                       
                                       The unit transportation cost between OCT q and OIY m (unit: $/h)
                                    
                                    
                                       
                                          cs
                                       
                                       The unit storage cost of a container at a container terminal or an inland yard (unit: $/h)
                                    
                                    
                                       
                                          ts
                                       
                                       The storage time of each container at a container terminal or an inland yard (unit: h)
                                    
                                    
                                       
                                          hdy
                                       
                                       The unit handling cost of all container terminals and inland yards (unit: $)
                                    
                                    
                                       
                                          coy
                                          
                                             ij
                                          
                                       
                                       The unit shortage cost of Container Set i at DIY j (unit: $)
                                    
                                    
                                       
                                          cot
                                          
                                             im
                                          
                                       
                                       The unit shortage cost of Container Set i at OIY m (unit: $)
                                    
                                    
                                       
                                          ody
                                          
                                             ij
                                          
                                       
                                       The unit overstock cost of Container Set i at DIY j (unit: $)
                                    
                                    
                                       
                                          odt
                                          
                                             ik
                                          
                                       
                                       The unit overstock cost of Container Set i at DCT k (unit: $)
                                    
                                    
                                       
                                          ooy
                                          
                                             im
                                          
                                       
                                       The unit overstock cost of Container Set i at OIY m (unit: $)
                                    
                                    
                                       
                                          oot
                                          
                                             iq
                                          
                                       
                                       The unit overstock cost of Container Set i at OCT q (unit: $)
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      ϑ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      ϑ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                1
                                             
                                          , if the demand for Container Set i at DIY j is more than the amount of it at DIY j; 
                                             
                                                
                                                   
                                                      ϑ
                                                   
                                                   
                                                      j
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                1
                                             
                                          , if the demand for Container Set i at OIY m is more than the amount of it at OIY m; 
                                             
                                                
                                                   
                                                      σ
                                                   
                                                   
                                                      m
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise
                                    
                                    
                                       
                                          
                                       
                                    
                                    
                                       
                                          Decision variables
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      φ
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       The amount of Container Set i transported from DIY j to DCT k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      α
                                                   
                                                   
                                                      kq
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       The amount of Container Set i transported from DCT k to OCT q
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      β
                                                   
                                                   
                                                      qm
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       The amount of Container Set i transported from OCT q to OIY m
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      δ
                                                   
                                                   
                                                      jk
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       The amount of Container Set i transported from DCT k to DIY j
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      η
                                                   
                                                   
                                                      kq
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       The amount of Container Set i transported from OCT q to DCT k
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      μ
                                                   
                                                   
                                                      qm
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       The amount of Container Set i transported from OIY m to OCT q
                                       
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                1
                                             
                                          , if the amount of Container Set i transported from DCT k to all OCTs is more than zero; 
                                             
                                                
                                                   
                                                      θ
                                                   
                                                   
                                                      k
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise
                                    
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                             
                                          
                                       
                                       
                                          
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                1
                                             
                                          , if the amount of Container Set i transported from OCT q to all DCTs is more than zero; 
                                             
                                                
                                                   
                                                      γ
                                                   
                                                   
                                                      q
                                                   
                                                   
                                                      i
                                                   
                                                
                                                =
                                                0
                                             
                                          , otherwise
                                    
                                 
                              
                           
                        
                     

The most pursued objective in container supply chain network optimization model is the minimization of total supply chain service cost, which consists of four parts: (1) total shortage cost, (2) total transportation cost, (3) total handling cost, (4) total storage cost and (5) total overstock cost.

When the demand for a container set at a demander is not satisfied, the shortage cost of the container set at the demander is occurred. The total shortage cost is calculated as
                           
                              (1)
                              
                                 TSC
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          ϒ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    
                                       ϑ
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                ddy
                                             
                                             
                                                ij
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         ady
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       coy
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          Λ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    
                                       σ
                                    
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                doy
                                             
                                             
                                                im
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         aoy
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            q
                                                            ∈
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            q
                                                            ∈
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       cot
                                    
                                    
                                       im
                                    
                                 
                              
                           
                        where TSC – the total shortage cost.

The total transportation cost is calculated as
                           
                              (2)
                              
                                 TTC
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                jk
                                             
                                             
                                                i
                                             
                                          
                                          ·
                                          
                                             
                                                cty
                                             
                                             
                                                jk
                                             
                                          
                                          ·
                                          
                                             
                                                uty
                                             
                                             
                                                jk
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            ϒ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         cty
                                                      
                                                      
                                                         jk
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            q
                                                            ∈
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         ctc
                                                      
                                                      
                                                         kq
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         utc
                                                      
                                                      
                                                         kq
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            ∈
                                                            Λ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         cto
                                                      
                                                      
                                                         qm
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         uto
                                                      
                                                      
                                                         qm
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         ctc
                                                      
                                                      
                                                         kq
                                                      
                                                   
                                                   ·
                                                   
                                                      
                                                         utc
                                                      
                                                      
                                                         kq
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   ∈
                                                   Λ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                qm
                                             
                                             
                                                i
                                             
                                          
                                          ·
                                          
                                             
                                                cto
                                             
                                             
                                                qm
                                             
                                          
                                          ·
                                          
                                             
                                                uto
                                             
                                             
                                                qm
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where TTC – the total transportation cost.

The total handling cost is calculated as
                           
                              (3)
                              
                                 THC
                                 =
                                 hdy
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            ϒ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  δ
                                                               
                                                               
                                                                  jk
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  φ
                                                               
                                                               
                                                                  jk
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            q
                                                            ∈
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  kq
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  kq
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  α
                                                               
                                                               
                                                                  kq
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  η
                                                               
                                                               
                                                                  kq
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            ∈
                                                            Λ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               
                                                                  μ
                                                               
                                                               
                                                                  qm
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                            +
                                                            
                                                               
                                                                  β
                                                               
                                                               
                                                                  qm
                                                               
                                                               
                                                                  i
                                                               
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   ∈
                                                   Λ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where THC – the total handling cost.

The total storage cost is calculated as
                           
                              (4)
                              
                                 TOC
                                 =
                                 cs
                                 ·
                                 ts
                                 ·
                                 
                                    
                                       
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                jk
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            ϒ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            q
                                                            ∈
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            ∈
                                                            Λ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   ∈
                                                   Λ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   i
                                                   ∈
                                                   Ψ
                                                
                                             
                                          
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                qm
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                              
                           
                        where TOC – the total storage cost.

When an inland yard or a terminal has surplus amount of a container set at the end of the supply chain operation, the overstock cost of the container set is occurred. The total over cost is calculated as
                           
                              (5)
                              
                                 TDC
                                 =
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          ϒ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                ady
                                             
                                             
                                                ij
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                δ
                                             
                                             
                                                jk
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                φ
                                             
                                             
                                                jk
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                ddy
                                             
                                             
                                                ij
                                             
                                          
                                          ,
                                          0
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       ody
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          Λ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    max
                                 
                                 
                                    
                                       
                                          
                                             
                                                aoy
                                             
                                             
                                                im
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                β
                                             
                                             
                                                qm
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                qm
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                doy
                                             
                                             
                                                im
                                             
                                          
                                          ,
                                          0
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       ooy
                                    
                                    
                                       im
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                adt
                                             
                                             
                                                ik
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             
                                          
                                          
                                             
                                                φ
                                             
                                             
                                                jk
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   q
                                                   ∈
                                                   ℓ
                                                
                                             
                                          
                                          
                                             
                                                η
                                             
                                             
                                                kq
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            j
                                                            ∈
                                                            ϒ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            q
                                                            ∈
                                                            ℓ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       odt
                                    
                                    
                                       ik
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          i
                                          ∈
                                          Ψ
                                       
                                    
                                 
                                 
                                    
                                       
                                          
                                             
                                                aot
                                             
                                             
                                                iq
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             
                                          
                                          
                                             
                                                α
                                             
                                             
                                                kq
                                             
                                             
                                                i
                                             
                                          
                                          +
                                          
                                             
                                                
                                                   ∑
                                                
                                                
                                                   m
                                                   ∈
                                                   Λ
                                                
                                             
                                          
                                          
                                             
                                                μ
                                             
                                             
                                                qm
                                             
                                             
                                                i
                                             
                                          
                                          -
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            k
                                                            ∈
                                                            Ω
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         
                                                            ∑
                                                         
                                                         
                                                            m
                                                            ∈
                                                            Λ
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                                 ·
                                 
                                    
                                       oot
                                    
                                    
                                       iq
                                    
                                 
                              
                           
                        where TDC – the total overstock cost.

The MCSCN problem is formulated as the following mixed integer programming (MIP) model.
                           
                              (6)
                              
                                 [
                                 MNLIP
                                 ]
                                 
                                 
                                    min
                                 
                                 
                                 f
                                 =
                                 TSC
                                 +
                                 TTC
                                 +
                                 THC
                                 +
                                 TOC
                                 +
                                 TDC
                              
                           
                        
                        
                           
                              (7)
                              
                                 s
                                 .
                                 t
                                 .
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       ady
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 M
                                 ·
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                ϑ
                                             
                                             
                                                j
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       ddy
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                              
                           
                        
                        
                           
                              (8)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                ϑ
                                             
                                             
                                                j
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       φ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                              
                           
                        
                        
                           
                              (9)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 M
                                 ·
                                 
                                    
                                       ϑ
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       ady
                                    
                                    
                                       ij
                                    
                                 
                                 -
                                 
                                    
                                       ddy
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                              
                           
                        
                        
                           
                              (10)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       ϑ
                                    
                                    
                                       j
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       δ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                              
                           
                        
                        
                           
                              (11)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       aoy
                                    
                                    
                                       im
                                    
                                 
                                 -
                                 M
                                 ·
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                σ
                                             
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 ⩽
                                 
                                    
                                       doy
                                    
                                    
                                       im
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                              
                           
                        
                        
                           
                              (12)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                σ
                                             
                                             
                                                m
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       μ
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (13)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 M
                                 ·
                                 
                                    
                                       σ
                                    
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 ⩽
                                 
                                    
                                       aoy
                                    
                                    
                                       im
                                    
                                 
                                 -
                                 
                                    
                                       doy
                                    
                                    
                                       im
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                              
                           
                        
                        
                           
                              (14)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       σ
                                    
                                    
                                       m
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       μ
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (15)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (16)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                θ
                                             
                                             
                                                k
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       η
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (17)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       γ
                                    
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       η
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (18)
                              
                                 
                                 M
                                 ·
                                 
                                    
                                       
                                          1
                                          -
                                          
                                             
                                                γ
                                             
                                             
                                                q
                                             
                                             
                                                i
                                             
                                          
                                       
                                    
                                 
                                 -
                                 
                                    
                                       α
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (19)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          ϒ
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       adt
                                    
                                    
                                       ik
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          j
                                          ∈
                                          ϒ
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                              
                           
                        
                        
                           
                              (20)
                              
                                 
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       α
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          Λ
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       aot
                                    
                                    
                                       iq
                                    
                                 
                                 ⩾
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       η
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          m
                                          ∈
                                          Λ
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (21)
                              
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       α
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       β
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       δ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       η
                                    
                                    
                                       kq
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       μ
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                                 ,
                                 k
                                 ∈
                                 Ω
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                        
                           
                              (22)
                              
                                 
                                 
                                    
                                       θ
                                    
                                    
                                       k
                                    
                                    
                                       i
                                    
                                 
                                 ,
                                 
                                    
                                       γ
                                    
                                    
                                       q
                                    
                                    
                                       i
                                    
                                 
                                 ∈
                                 {
                                 0
                                 ,
                                 1
                                 }
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 k
                                 ∈
                                 Ω
                                 ,
                                 
                                 q
                                 ∈
                                 ℓ
                              
                           
                        
                     

The objective function of the above model is to minimize the total container supply chain service cost, which can be formally represented in Eq. (6).

Constraints (7)–(10) restrict the inflows and outflows of each container set at each DIY. Constraint (7) indicates that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    ∈
                                    Ω
                                 
                              
                              
                                 
                                    δ
                                 
                                 
                                    jk
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    ady
                                 
                                 
                                    ij
                                 
                              
                              ⩽
                              
                                 
                                    ddy
                                 
                                 
                                    ij
                                 
                              
                           
                         if 
                           
                              
                                 
                                    ϑ
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , which ensures that the total inflows of Container Set i from all DCTs to DIY j and the amount of Container Set i at DIY j cannot be more than the demand for Container Set i at DIY j when DIY j has extra demand for Container Set i. Constraint (8) indicates that 
                           
                              
                                 
                                    φ
                                 
                                 
                                    jk
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    ϑ
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , which ensures that the outflows of Container Set i from DIY j to each DCT must be zero when DIY j has extra demand for Container Set i. Constraint (9) indicates that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    k
                                    ∈
                                    Ω
                                 
                              
                              
                                 
                                    φ
                                 
                                 
                                    jk
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              
                                 
                                    ady
                                 
                                 
                                    ij
                                 
                              
                              -
                              
                                 
                                    ddy
                                 
                                 
                                    ij
                                 
                              
                           
                         if 
                           
                              
                                 
                                    ϑ
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        , which ensures that the total outflows of Container Set i from DIY j to all DCTs cannot be more than the surplus amount of the container set at DIY j. Constraint (10) indicates that 
                           
                              
                                 
                                    δ
                                 
                                 
                                    jk
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    ϑ
                                 
                                 
                                    j
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        , which ensures that the inflows of Container Set i from each DCT to DIY j must be zero when DIY j dose not have extra demand for Container Set i.

Constraints (11)–(14) restrict the inflows and outflows of each container set at each OIY. Constraint (11) indicates that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    q
                                    ∈
                                    ℓ
                                 
                              
                              
                                 
                                    β
                                 
                                 
                                    qm
                                 
                                 
                                    i
                                 
                              
                              +
                              
                                 
                                    aoy
                                 
                                 
                                    im
                                 
                              
                              ⩽
                              
                                 
                                    doy
                                 
                                 
                                    im
                                 
                              
                           
                         if 
                           
                              
                                 
                                    σ
                                 
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , which ensures that the total inflows of Container Set i from all OCTs to OIY m and the amount of Container Set i at OIY m cannot be more than the demand for Container Set i at OIY m when OIY m has extra demand for Container Set i. Constraint (12) indicates that 
                           
                              
                                 
                                    μ
                                 
                                 
                                    qm
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    σ
                                 
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , which ensures that the outflows of Container Set i from OIY m to each OCT must be zero when OIY m has extra demand for Container Set i. Constraint (13) indicates that 
                           
                              
                                 
                                    ∑
                                 
                                 
                                    q
                                    ∈
                                    ℓ
                                 
                              
                              
                                 
                                    μ
                                 
                                 
                                    qm
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              
                                 
                                    aoy
                                 
                                 
                                    im
                                 
                              
                              -
                              
                                 
                                    doy
                                 
                                 
                                    im
                                 
                              
                           
                         if 
                           
                              
                                 
                                    σ
                                 
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        , which ensures that the total outflows of Container Set i from OIY m to all OCTs cannot be more than the surplus amount of the container set at OIY m. Constraint (14) indicates that 
                           
                              
                                 
                                    μ
                                 
                                 
                                    qm
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    σ
                                 
                                 
                                    m
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        , which ensures that the inflows of Container Set i from each OCT to OIY m must be zero when OIY m dose not have extra demand for Container Set i.

Constraints (15)–(20) restrict the inflows and outflows of each container set at each DCT and OCT. Constraint (15) indicates that 
                           
                              
                                 
                                    α
                                 
                                 
                                    kq
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        , which ensures that the total outflows of Container Set i from DCT k to each OCT must be zero when total outflows of Container Set i from DCT k to all OCTs is zero. Constraint (16) indicates that 
                           
                              
                                 
                                    η
                                 
                                 
                                    kq
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    θ
                                 
                                 
                                    k
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , which ensures that the inflow of Container Set i from each OCT to DCT k must be zero when the total outflows of Container Set i from DCT k to all OCTs is more than zero. Constraint (17) indicates that 
                           
                              
                                 
                                    η
                                 
                                 
                                    kq
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    γ
                                 
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              =
                              0
                           
                        , which ensures that the inflow of Container Set i from each DCT to OCT q must be zero when the total outflows of Container Set i from OCT q to all DCTs is more than zero. Constraint (18) indicates that 
                           
                              
                                 
                                    α
                                 
                                 
                                    kq
                                 
                                 
                                    i
                                 
                              
                              ⩽
                              0
                           
                         if 
                           
                              
                                 
                                    γ
                                 
                                 
                                    q
                                 
                                 
                                    i
                                 
                              
                              =
                              1
                           
                        , which ensures that the inflow of Container Set i from each DCT to OCT q must be zero when the total outflows of Container Set i from OCT q to all DCTs is more than zero. Constraint (19) ensures that the total out flows of a container set at a DCT cannot be more than the sum of the total inflows and the amount of the container set at the DCT. Constraint (20) ensures that the total out flows of a container set at an OCT cannot be more than the sum of the total inflows and the amount of the container set at the OCT.

Constraint (21) defines non-negative the integer variables, and Constraint (22) defines binary variables.

To overcome the computational difficulties caused by maximum value forms in Eq. (5), it can be linearized by substituting 
                           
                              max
                              
                                 
                                    
                                       
                                          
                                             ady
                                          
                                          
                                             ij
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             δ
                                          
                                          
                                             jk
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             ∑
                                          
                                          
                                             k
                                             ∈
                                             Ω
                                          
                                       
                                       
                                          
                                             φ
                                          
                                          
                                             jk
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             ddy
                                          
                                          
                                             ij
                                          
                                       
                                       ,
                                       0
                                    
                                 
                              
                           
                         in Eq. (5) with auxiliary variable dos
                        
                           ij
                         and substituting 
                           
                              max
                              
                                 
                                    
                                       
                                          
                                             aoy
                                          
                                          
                                             im
                                          
                                       
                                       +
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             ∈
                                             ℓ
                                          
                                       
                                       
                                          
                                             β
                                          
                                          
                                             qm
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             ∑
                                          
                                          
                                             q
                                             ∈
                                             ℓ
                                          
                                       
                                       
                                          
                                             μ
                                          
                                          
                                             qm
                                          
                                          
                                             i
                                          
                                       
                                       -
                                       
                                          
                                             doy
                                          
                                          
                                             im
                                          
                                       
                                       ,
                                       0
                                    
                                 
                              
                           
                         in Eq. (5) with auxiliary variable oos
                        
                           im
                        . The added constraints are as follows:
                           
                              (23)
                              
                                 
                                    
                                       dos
                                    
                                    
                                       ij
                                    
                                 
                                 ⩾
                                 
                                    
                                       ady
                                    
                                    
                                       ij
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       δ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          k
                                          ∈
                                          Ω
                                       
                                    
                                 
                                 
                                    
                                       φ
                                    
                                    
                                       jk
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       ddy
                                    
                                    
                                       ij
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                              
                           
                        
                        
                           
                              (24)
                              
                                 
                                    
                                       dos
                                    
                                    
                                       ij
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 j
                                 ∈
                                 ϒ
                              
                           
                        
                        
                           
                              (25)
                              
                                 
                                    
                                       oos
                                    
                                    
                                       im
                                    
                                 
                                 ⩾
                                 
                                    
                                       aoy
                                    
                                    
                                       im
                                    
                                 
                                 +
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       β
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       
                                          ∑
                                       
                                       
                                          q
                                          ∈
                                          ℓ
                                       
                                    
                                 
                                 
                                    
                                       μ
                                    
                                    
                                       qm
                                    
                                    
                                       i
                                    
                                 
                                 -
                                 
                                    
                                       doy
                                    
                                    
                                       im
                                    
                                 
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                              
                           
                        
                        
                           
                              (26)
                              
                                 
                                    
                                       oos
                                    
                                    
                                       im
                                    
                                 
                                 ⩾
                                 0
                                 ,
                                 
                                 ∀
                                 i
                                 ∈
                                 Ψ
                                 ,
                                 
                                 m
                                 ∈
                                 Λ
                              
                           
                        
                     

The MCSCN problem is difficult to be solved by MIP solvers because (i) practical instances have a number of decision variables and constraints; (ii) the model has a number of integer variables; and (iii) we could not identify any special structure for the problem to be solved efficiently. To address the MCSCN problem of practical sizes, a simulation-based heuristic method is proposed, where the heuristic method used to search solution space and the simulation is used to evaluate solution and handle constraints.

For the simulation model, we employ a discrete event simulation that simulates the operational level process of MCSCN in detail. The simulation model embedded in this framework takes a potential solution to the considered optimization problem and conducts a simulation to evaluate the solutions’ performance and repair unfeasible solutions and improve evident low quality solutions. It allows tracing the storage, loading, transshipment and unloading processes of each container set at each terminal and yard. The simulation model outputs an operational level performance measure, which denotes the total container supply chain service cost.

For the heuristic method, it consists of two parts, i.e., genetic algorithm (GA) and particle swarm optimization (PSO) algorithm, where the GA is used for global search and the PSO is used for local search and adjusting the GA’s search direction to identify potentially better solutions of each generation.

The simulation-based optimization method consists essentially of three modules: the GA search module, the PSO search module and the simulation module. Fig. 2
                         shows the framework of the proposed simulation-based heuristic method.

The procedure of the simulation-based optimization method is as follows.
                           
                              
                                 
                                 
                                    
                                       
                                          Initialize a population by the GA search module as all chromosomes of the first generation;
                                    
                                    
                                       
                                          While the termination criterion of the GA is not satisfied do
                                       
                                    
                                    
                                       
                                          
                                          For 
                                          p
                                          =1 to 
                                          P 
                                          Loop // P denotes the maximum population size
                                    
                                    
                                       
                                          Input the control variables generated by Chromosome p into the simulation model;
                                    
                                    
                                       
                                          Evaluate Chromosome p by the simulation model;
                                    
                                    
                                       
                                          {
                                    
                                    
                                       
                                          
                                          
                                          If Chromosome p is not feasible Then
                                       
                                    
                                    
                                       
                                          
                                          
                                          Repair Chromosome p;
                                    
                                    
                                       
                                          
                                          
                                          End If;
                                    
                                    
                                       
                                          
                                          
                                          If the solution quality of Chromosome p is evident low Then
                                       
                                    
                                    
                                       
                                          
                                          
                                          Improve Chromosome p;
                                    
                                    
                                       
                                          
                                          
                                          End If;
                                    
                                    
                                       
                                          
                                          Run simulation;
                                    
                                    
                                       
                                          
                                          Output the evaluation indices;
                                    
                                    
                                       
                                          }
                                    
                                    
                                       
                                          Return the evaluation indices into the GA;
                                    
                                    
                                       
                                          Compute the fitness value of Chromosome p;
                                    
                                    
                                       
                                          
                                          End For;
                                    
                                    
                                       
                                          
                                          Select 
                                          N best chromosomes as the initial particles of the PSO search;
                                    
                                    
                                       
                                          
                                          While the termination criterion of the PSO is not satisfied do
                                       
                                    
                                    
                                       
                                          Find the global best position attained in the swarm;
                                    
                                    
                                       
                                          
                                          For 
                                          n
                                          =1 to N 
                                          Loop // N denotes the size of the swarm
                                    
                                    
                                       
                                          
                                          Evolve Particle n;
                                    
                                    
                                       
                                          
                                          Evaluate Particle n by the simulation model;
                                    
                                    
                                       
                                          
                                          
                                          {
                                    
                                    
                                       
                                          
                                          
                                          
                                          If Particle n is not feasible Then
                                       
                                    
                                    
                                       
                                          
                                          
                                          
                                          Repair Particle n;
                                    
                                    
                                       
                                          
                                          
                                          
                                          End If;
                                    
                                    
                                       
                                          
                                          
                                          If the solution quality of Particle n is evident low Then
                                       
                                    
                                    
                                       
                                          
                                          
                                          
                                          Improve Particle n;
                                    
                                    
                                       
                                          
                                          
                                          
                                          End If;
                                    
                                    
                                       
                                          
                                          
                                          Run simulation;
                                    
                                    
                                       
                                          
                                          
                                          Output the evaluation indices;
                                    
                                    
                                       
                                          
                                          }
                                    
                                    
                                       
                                          
                                          Return the evaluation indices into the PSO;
                                    
                                    
                                       
                                          
                                          Compute the fitness value of Particle n;
                                    
                                    
                                       
                                          
                                          End For;
                                    
                                    
                                       
                                          
                                          End While;
                                    
                                    
                                       
                                          Offspring acceptance;
                                    
                                    
                                       
                                          Parent selection;
                                    
                                    
                                       
                                          Generate next generation by genetic operation, including crossover and mutation;
                                    
                                    
                                       
                                          End While;
                                    
                                    
                                       Output best solution;
                                    
                                 
                              
                           
                        
                     

The initial and most important step of the GA search is the solution representation. In the proposed GA module, a chromosome consists of a rectangular matrix with (DY
                           +
                           DT
                           +
                           OY
                           +
                           OT)×
                           CS columns and (DY
                           +
                           DT
                           +
                           OY
                           +
                           OT) rows. Considering the containers cannot flow across echelon, the number of genes in the chromosome is (DY
                           ×
                           DT
                           +
                           DT
                           ×(DY
                           +
                           OY)+
                           OY
                           ×
                           OT
                           +
                           OT
                           ×(OY
                           +
                           DT))×
                           CS. In the matrix, the column title represents container suppliers, the sub-column title represents their container sets, and the row title represents container demanders. The elements of all cells denote all genes of a chromosome and can be encoded by a vertical single string, which represent the amount of all container sets from all suppliers to all demanders. Since the containers cannot flow across echelon, notation ‘–’ is used to represent the container flows across echelon. If the content of a cell in the matrix is zero, the container set corresponding to the sub-column title of the cell cannot be transported from the supplier corresponding to the column title of the cell to the demander corresponding to the row title of the cell. If the content of a cell in the matrix is a positive integer, the corresponding quantity of containers will flow from the corresponding supplier to the corresponding demander. A GA chromosome represents a schedule as depicted in Table 1
                           , in which there are two container sets, two DIYs, two DCTs, two OCTs and two OIYs.

Initial population is a set of solutions obtained from a heuristic or generated randomly, which plays an essential role in determining the efficiency of GA. As an initial population generated randomly may not satisfy good performance, a heuristic algorithm, which is embedded in the framework of simulation-based heuristic method, is applied to generate the initial solutions for the GA. In this stage, the simulation model is used to simulate the container supply chain operation processes corresponding to all chromosomes and repair unfeasible chromosomes and improve evident low quality chromosomes (details are described in Section 4.2.3). To generate the initial population, The procedure of population initialization is as follows:
                              
                                 
                                    
                                    
                                       
                                          
                                             Let 
                                             ma
                                             
                                                ij
                                              denotes the extra demand of DIY j, sa
                                             
                                                ij
                                              denotes the surplus amount of DIY j, sa
                                             
                                                ik
                                              denotes the surplus amount of DCT k, sa
                                             
                                                iq
                                              denotes the surplus amount of OCT q, ma
                                             
                                                im
                                              denotes the extra demand of OIY m, sa
                                             
                                                im
                                              denotes the surplus amount of OIY m;
                                       
                                       
                                          
                                             For 
                                             i
                                             ∈
                                             Ψ 
                                             Loop
                                          
                                       
                                       
                                          
                                             
                                             For 
                                             j
                                             ∈
                                             ϒ, k
                                             ∈
                                             Ω, q
                                             ∈
                                             Λ, m
                                             ∈ℓ Loop
                                          
                                       
                                       
                                          
                                             
                                             Compute ma
                                             
                                                ij
                                             , sa
                                             
                                                ij
                                             , sa
                                             
                                                ik
                                             , sa
                                             
                                                iq
                                             , ma
                                             
                                                im
                                              and sa
                                             
                                                im
                                             ;
                                       
                                       
                                          
                                             
                                             End For;
                                       
                                       
                                          
                                             // DIYs have extra demand for Container Set i.
                                       
                                       
                                          
                                             
                                             If 
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                
                                              
                                             Then // Container Set i need not flows from any OCT to any DCT
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from DCT k to DIY j, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Else If 
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                
                                              
                                             Then // Container Set i need not flows from any OIY to any OCT;
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from OCT q to DCT k, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                ik
                                             , and randomly assign the amount of Container Set i transported from DCT k to DIY j, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Else If 
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                
                                              
                                             Then
                                          
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from OIY m to OCT q, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   m
                                                   ∈
                                                   ℓ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                iq
                                             , and randomly assign the amount of Container Set i transported from OCT q to DCT k, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                ik
                                             , and randomly assign the amount of Container Set i transported from DCT k to DIY j, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Else
                                          
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from OIY m to OCT q, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         μ
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   m
                                                   ∈
                                                   ℓ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                iq
                                             , and randomly assign the amount of Container Set i transported from OCT q to DCT k, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         η
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                ik
                                             , and randomly assign the amount of Container Set i transported from DCT k to DIY j, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         δ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   ϒ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             End If;
                                       
                                       
                                          
                                             // OIYs have extra demand for Container Set i.
                                       
                                       
                                          
                                             
                                             If 
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                
                                              
                                             Then // Container Set i need not flows from any DCT to any OCT
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from OCT q to OIY m, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   m
                                                   ∈
                                                   ℓ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Else If 
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                
                                              
                                             Then // Container Set i need not flows from any DIY to any DCT;
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from DCT k to OCT q, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                iq
                                             , and randomly assign the amount of Container Set i transported from OCT q to OIY m, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   m
                                                   ∈
                                                   ℓ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Else If 
                                             
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   +
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                
                                              
                                             Then
                                          
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from DIY j to DCT k, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   ℓ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         j
                                                         ∈
                                                         ϒ
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                ik
                                             , and randomly assign the amount of Container Set i transported from DCT k to OCT q, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   -
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                iq
                                             , and randomly assign the amount of Container Set i transported from OCT q to OIY m, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   m
                                                   ∈
                                                   ℓ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Else
                                          
                                       
                                       
                                          
                                             
                                             Randomly assign the amount of Container Set i transported from DIY j to DCT k, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         k
                                                         ∈
                                                         Ω
                                                      
                                                   
                                                   
                                                      
                                                         φ
                                                      
                                                      
                                                         jk
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ij
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   j
                                                   ∈
                                                   ℓ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                ik
                                             , and randomly assign the amount of Container Set i transported from DCT k to OCT q, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         α
                                                      
                                                      
                                                         kq
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         ik
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   k
                                                   ∈
                                                   Ω
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             Update sa
                                             
                                                iq
                                             , and randomly assign the amount of Container Set i transported from OCT q to OIY m, where 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         m
                                                         ∈
                                                         ℓ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   =
                                                   
                                                      
                                                         sa
                                                      
                                                      
                                                         iq
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   q
                                                   ∈
                                                   Λ
                                                
                                              and 
                                                
                                                   
                                                      
                                                         ∑
                                                      
                                                      
                                                         q
                                                         ∈
                                                         Λ
                                                      
                                                   
                                                   
                                                      
                                                         β
                                                      
                                                      
                                                         qm
                                                      
                                                      
                                                         i
                                                      
                                                   
                                                   ⩽
                                                   
                                                      
                                                         ma
                                                      
                                                      
                                                         im
                                                      
                                                   
                                                   ,
                                                   
                                                   ∀
                                                   m
                                                   ∈
                                                   ℓ
                                                
                                             ;
                                       
                                       
                                          
                                             
                                             End If;
                                          
                                       
                                       
                                          
                                             End For;
                                       
                                    
                                 
                              
                           
                        

All chromosomes should be checked using the constraints described in Section 3.5. If the chromosome is feasible, it can be held; otherwise, we use the gene repair procedure to make a proper modification on the unfeasible chromosomes. Besides repairing unfeasible chromosomes, we also use the gene repair procedure to improve evidently low quality chromosomes, such as using multi-echelon transportation when existing proper one echelon transportation. Gene repair can reduce the iterations of the GA. The gene repair procedure is as follows:
                              
                                 Step 1:
                                 If a supplier has no surplus container of a container set but the outflows of the container set from the supplier is more than zero, let the amounts of the container set transported from the supplier to all demanders is zero.

If a demander has no extra demand for a container set but the inflows of the container set to the demander is more than zero, let the amounts of the container set transported from all suppliers to the demander is zero.

If the outflows of a container set from a supplier exceed the sum of the supplier’s surplus amount of the container set, the amount of the container set transported from the supplier to all demanders should be randomly reduced until the outflows is not excessive. This step should be successively executed from the first echelon supplier to the last echelon supplier.

If the inflows of a container set from all suppliers to a demander exceed the sum of the demander’s extra demand for the container set, the amount of the container set transported from all suppliers to the demander should be randomly reduced until the inflows is not excessive. This step should be successively executed from the last echelon demander to the first echelon demander.

After generating the chromosome, if a supplier still has surplus amount of a container set and some demanders still have extra demand for the container set, the surplus containers of the container set can be randomly transported from the supplier to its next echelon demanders and to the end demanders.

If there are proper one echelon transportations, they should substitute two echelon and three transportations according to the chromosome.

If there are proper two echelon transportations, they should substitute three transportations according to the chromosome.

After generating the chromosome, if the inflows of a container set of a demander from some suppliers are with high transportation costs, but some suppliers still have surplus amount of the container set and their transportation costs to the demander are lower, the amount of the container set transported from the suppliers with lower costs should be increased and the amount from the suppliers with high costs should be reduced according to the demander’s necessary.

Steps 5–8 are mainly used to reduce the total container supply chain service cost, and further improve evidently low quality chromosomes.

Considering the complexity of the gene repair procedure, it is embedded into the simulation model and is executed in the simulation evaluation process.

After the completion of the gene repair process, a feasible MCSCN solution is generated. Afterwards, the solution should be input into the simulation module for obtaining the shortage cost of each demander for each container set, the transportation cost of each container set from its supplier to its demander, the handling cost of each container set at each supply chain node and the storage cost of each container set at each supply chain node.

Finally, the fitness value of the chromosome is calculated by fitness evaluation function. As the MCSCN problem is developed as a minimization problem, the smaller the objective function value, the higher the fitness value must be. To maintain the diversity of population and avoid the GA’s premature convergence to local optimal solution, a few chromosomes with evident smaller objective values cannot control the selection process. Thus, the fitness evaluation function is defined as the following exponential function:
                              
                                 (27)
                                 
                                    F
                                    =
                                    1
                                    /
                                    {
                                    1
                                    +
                                    exp
                                    [
                                    (
                                    TSC
                                    +
                                    TTC
                                    +
                                    THC
                                    +
                                    TOC
                                    +
                                    TDC
                                    )
                                    /
                                    ε
                                    ]
                                    }
                                 
                              
                           where ε is a problem scale related parameter.

We employ the roulette wheel selection sampling strategy for parent selection mechanism [31]. The details are as follows:
                              
                                 Step 1:
                                 Calculate the sum of all fitness values of the population, i.e., 
                                       
                                          TF
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                i
                                                =
                                                1
                                             
                                             
                                                P
                                             
                                          
                                          
                                             
                                                F
                                             
                                             
                                                i
                                             
                                          
                                       
                                    , where P is the population size.

Calculate the selection probability of each chromosome, i.e., SP
                                    
                                       i
                                    
                                    =
                                    F
                                    
                                       i
                                    /TF, i
                                    =1,2,…,
                                    P.

Calculate the cumulative probability of each chromosome, i.e., 
                                       
                                          
                                             
                                                CSP
                                             
                                             
                                                i
                                             
                                          
                                          =
                                          
                                             
                                                ∑
                                             
                                             
                                                j
                                                =
                                                1
                                             
                                             
                                                i
                                             
                                          
                                          
                                             
                                                SP
                                             
                                             
                                                j
                                             
                                          
                                          ,
                                          
                                          i
                                          =
                                          1
                                          ,
                                          2
                                          ,
                                          …
                                          ,
                                          P
                                       
                                    .

Generate a random number r in the range r
                                    ∈(0,1]. If CSP
                                    
                                       i−1
                                    <
                                    r
                                    ⩽
                                    CSP
                                    
                                       i
                                    , Chromosome i is selected.

In this paper, crossover operator is used for exploiting a better solution and mutation operator is used for exploring a wider search space. The genetic operators are presented as follows.

Generally, the aforementioned chromosome representation may miss some better solutions by one-point, two-point or multi-point crossover when population size is not very large. Therefore, the arithmetic crossover is used for crossover operation. The details of the arithmetic crossover are as follows:
                                 
                                    (28)
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         =
                                                         r
                                                         ·
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         +
                                                         (
                                                         1
                                                         -
                                                         r
                                                         )
                                                         ·
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                               +
                                                               1
                                                            
                                                         
                                                         =
                                                         r
                                                         ·
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               1
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         +
                                                         (
                                                         1
                                                         -
                                                         r
                                                         )
                                                         ·
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               2
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              where r is a randomly-generated number within an interval from 0 to 1.

Parameter r is not a constant, which should be changed dynamically with the evolved generation increasing. When the current generation is closer to the maximum generation, the λ should be closer to 0. As each gene should be encoded as an integer, all genes should be rounded after crossover operation. Upon the completion of crossover operation, we should check the feasibility of all offspring should be checked, and unfeasible offspring should be repaired by the gene repair procedure embedded in the simulation model. Fig. 3
                               shows an example of arithmetic crossover operation with r
                              =0.7.

The mutation operator forces the GA to explore a wider search space. In the early phase, the uniform mutation operator is used to keep the GA moving freely in the wider search space. In the later phase, non-uniform mutation operator is used to search the neighborhood space of the current chromosome.

The uniform mutation operator is separately applied for the selected chromosomes. The details are as follows:
                                 
                                    (29)
                                    
                                       
                                          
                                             ch
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       =
                                       U
                                       +
                                       r
                                       ·
                                       (
                                       U
                                       -
                                       L
                                       )
                                    
                                 
                              where r is a randomly-generated number within an interval from 0 to 1, U and L respectively are the upper bound and lower bound of the selected gene.

The non-uniform mutation is presented as follow.
                                 
                                    (30)
                                    
                                       
                                          
                                             ch
                                          
                                          
                                             t
                                             +
                                             1
                                          
                                       
                                       =
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         +
                                                         (
                                                         U
                                                         -
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         )
                                                         ·
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               (
                                                               1
                                                               -
                                                               G
                                                               /
                                                               T
                                                               )
                                                               ·
                                                               b
                                                            
                                                         
                                                         )
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         r
                                                         =
                                                         random
                                                         (
                                                         0
                                                         ,
                                                         1
                                                         )
                                                         ⩾
                                                         0.5
                                                      
                                                   
                                                   
                                                      
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         -
                                                         (
                                                         
                                                            
                                                               ch
                                                            
                                                            
                                                               t
                                                            
                                                         
                                                         -
                                                         L
                                                         )
                                                         ·
                                                         (
                                                         1
                                                         -
                                                         
                                                            
                                                               r
                                                            
                                                            
                                                               (
                                                               1
                                                               -
                                                               G
                                                               /
                                                               T
                                                               )
                                                               ·
                                                               b
                                                            
                                                         
                                                         )
                                                         ,
                                                      
                                                      
                                                         if
                                                         
                                                         r
                                                         =
                                                         random
                                                         (
                                                         0
                                                         ,
                                                         1
                                                         )
                                                         <
                                                         0.5
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              where L and U are the lower and upper bound of mutation, respectively, r is a random number between 0 and 1, G is the current generation, T is the maximum generation, and b is a parameter used to adjust mutation steps.

After genetic operations, the best chromosomes from previous generations may be lost. Hence, we should inherit the best chromosomes with the outstanding characters to the next generation as much as possible. Therefore, if the fitness of a chromosome is greater, its probability of being accepted is higher. Firstly, we combine all chromosomes including all parents and offspring of the current generation. Subsequently, all chromosomes of the combined population are sorted by the decreasing order of their fitness values. Finally, since the size of the population should keep unchanged, only the chromosomes whose sequence numbers are smaller than the population size are accepted.

The maximum number of elapsed generation determined by experiments is set as the GA’s stoppage rule.

In general, the pure GA is very difficult to effectively obtain high quality near optimal solutions. A local search optimization method is usually integrated with a global search optimization algorithm for improving the performance of the global search optimization, which has been validated the global and local exploration abilities of the PSO with inexpensive computation efforts [32]. Therefore, we employ the PSO as a local search method to adjust the GA’s search direction to identify potentially better solutions. After the completion of a generation’s evolution of the GA, it does not immediately evolve to the next generation, but selects some best chromosomes as the initial swarm of the PSO for local search.

In the proposed PSO algorithm, the particle representation is the same as that for the GA. Each particle is represented by a X
                           ×
                           Y dimensional matrix in solution space S
                           
                              n
                           
                           =[(S
                           
                              n11,
                           S
                           
                              n21,…,
                           S
                           
                              nx1,
                           …,
                           S
                           
                              nX1),…,(S
                           
                              n1y
                           , S
                           
                              n2y
                           ,…,
                           S
                           
                              nxy,
                           …,
                           S
                           
                              nXy
                           ),…,(S
                           
                              n1Y
                           , S
                           
                              n2Y
                           ,…,
                           S
                           
                              nxY,
                           …,
                           S
                           
                              nXY
                           )], where X
                           =(DY
                           +
                           DT
                           +
                           OY
                           +
                           OT)×
                           CS, Y
                           =(DY
                           +
                           DT
                           +
                           OY
                           +
                           OT), x
                           =1,2,…,
                           X, y
                           =1,2,…,
                           Y, n
                           =1,2,…,
                           N (N is the number of particles).

The velocity v
                           
                              pxy
                            represents the changes of Particle n that will be made to move the particle from one position to another. The moving velocity depends on the dynamic interaction of the particle own best position (pbest
                           
                              nxy
                           ) and the best particle’s position (gbest
                           
                              xy
                           ).

In this paper, we use constriction particle swarm optimization for the velocity calculation [33]. The velocity can be calculated as
                              
                                 (31)
                                 
                                    
                                       
                                          v
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    +
                                    1
                                    )
                                    =
                                    ξ
                                    (
                                    
                                       
                                          v
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          1
                                       
                                    
                                    ·
                                    (
                                    
                                       
                                          pbest
                                       
                                       
                                          nxy
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    +
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    ·
                                    
                                       
                                          r
                                       
                                       
                                          2
                                       
                                    
                                    ·
                                    (
                                    
                                       
                                          gbest
                                       
                                       
                                          xy
                                       
                                    
                                    -
                                    
                                       
                                          S
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    )
                                    )
                                    )
                                 
                              
                           where
                              
                                 (32)
                                 
                                    ξ
                                    =
                                    
                                       
                                          2
                                       
                                       
                                          
                                             
                                                
                                                   2
                                                   -
                                                   ρ
                                                   -
                                                   
                                                      
                                                         
                                                            
                                                               ρ
                                                            
                                                            
                                                               2
                                                            
                                                         
                                                         -
                                                         4
                                                         ρ
                                                      
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ,
                                    
                                    ρ
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    +
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    
                                    and
                                    
                                    ρ
                                    >
                                    4
                                 
                              
                           
                           
                              
                                 (33)
                                 
                                    
                                       
                                          pbest
                                       
                                       
                                          n
                                       
                                    
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                      ,
                                                   
                                                   
                                                      if
                                                      
                                                      F
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      (
                                                      t
                                                      +
                                                      1
                                                      )
                                                      )
                                                      <
                                                      F
                                                      (
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      (
                                                      t
                                                      )
                                                      )
                                                   
                                                
                                                
                                                   
                                                      
                                                         
                                                            pbest
                                                         
                                                         
                                                            n
                                                         
                                                      
                                                      ,
                                                   
                                                   
                                                      otherwise
                                                   
                                                
                                             
                                          
                                       
                                    
                                 
                              
                           
                           
                              
                                 (34)
                                 
                                    gbest
                                    =
                                    
                                       min
                                    
                                    (
                                    
                                       
                                          pbest
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    
                                       
                                          pbest
                                       
                                       
                                          1
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          pbest
                                       
                                       
                                          n
                                       
                                    
                                    ,
                                    …
                                    ,
                                    
                                       
                                          pbest
                                       
                                       
                                          N
                                       
                                    
                                    )
                                 
                              
                           
                        

In the above equations, ϑ is a constriction factor, t is iterations counter, ρ
                           1 and ρ
                           2 are the acceleration coefficients, r
                           1 and r
                           2 are two random numbers between 0 and 1, pbest
                           
                              n
                            is the personal best position of each particle, gbest is the global best position attained by any particle of the swarm.

In Eq. (27), the ρ
                           1 and ρ
                           2 can be respectively calculated as
                              
                                 (35)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                    
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          1
                                       
                                       
                                          min
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                1
                                             
                                             
                                                max
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                1
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                max
                                             
                                          
                                       
                                    
                                    ·
                                    t
                                 
                              
                           
                           
                              
                                 (36)
                                 
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                    
                                    =
                                    
                                       
                                          ρ
                                       
                                       
                                          2
                                       
                                       
                                          min
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                             
                                                max
                                             
                                          
                                          -
                                          
                                             
                                                ρ
                                             
                                             
                                                2
                                             
                                             
                                                min
                                             
                                          
                                       
                                       
                                          
                                             
                                                G
                                             
                                             
                                                max
                                             
                                          
                                       
                                    
                                    ·
                                    t
                                 
                              
                           where 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       max
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                    
                                       max
                                    
                                 
                              
                            are the minimum and maximum values of ρ
                           1 and ρ
                           2, G
                           max is the maximum number of the iterations of the PSO, and t is the number of the current generation.

The initial velocity v
                           
                              nxy
                           (0) of each particle is calculated as
                              
                                 (37)
                                 
                                    
                                       
                                          v
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    0
                                    )
                                    =
                                    
                                       
                                          
                                             
                                                
                                                   S
                                                
                                                
                                                   nxy
                                                
                                                
                                                   n
                                                
                                             
                                             -
                                             
                                                
                                                   S
                                                
                                                
                                                   nxy
                                                
                                             
                                             (
                                             0
                                             )
                                          
                                       
                                    
                                    +
                                    
                                       
                                          
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            nxy
                                                         
                                                         
                                                            max
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            nxy
                                                         
                                                      
                                                      (
                                                      0
                                                      )
                                                   
                                                
                                             
                                             -
                                             
                                                
                                                   
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            nxy
                                                         
                                                         
                                                            min
                                                         
                                                      
                                                      -
                                                      
                                                         
                                                            S
                                                         
                                                         
                                                            nxy
                                                         
                                                      
                                                      (
                                                      0
                                                      )
                                                   
                                                
                                             
                                          
                                       
                                    
                                    ·
                                    U
                                    (
                                    0
                                    ,
                                    1
                                    )
                                 
                              
                           where 
                              
                                 
                                    
                                       S
                                    
                                    
                                       nxy
                                    
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       S
                                    
                                    
                                       nxy
                                    
                                    
                                       max
                                    
                                 
                              
                            are the lower bound and upper bound of each position of each particle.

The position of each particle is calculated as
                              
                                 (38)
                                 
                                    
                                       
                                          S
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    +
                                    1
                                    )
                                    =
                                    
                                       
                                          S
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    )
                                    +
                                    
                                       
                                          v
                                       
                                       
                                          nxy
                                       
                                    
                                    (
                                    t
                                    +
                                    1
                                    )
                                 
                              
                           
                        

The evolution process of the PSO as a local search method for MCSCN problem is as follows.
                              
                                 
                                    
                                    
                                       
                                          Select N best chromosomes from all chromosomes of the GA in the current generation as the initial swarm of the PSO;
                                       
                                       
                                          Calculate the initial velocity of each particle using Eq. (37);
                                       
                                       
                                          
                                             For 
                                             t
                                             =1 to the maximum number of the iterations of the PSO Loop
                                          
                                       
                                       
                                          
                                             Find the global best position gbest of the swarm;
                                       
                                       
                                          
                                             
                                             For 
                                             n
                                             =1 to the number of particles Loop
                                       
                                       
                                          
                                             
                                             Find the personal best position pbest
                                             
                                                n
                                              of Particle n;
                                       
                                       
                                          
                                             
                                             Calculate the moving velocity v
                                             
                                                n
                                             (t
                                             +1) of Particle n using Eq. (31);
                                       
                                       
                                          
                                             
                                             Update the new position S
                                             
                                                n
                                             (t
                                             +1) of Particle n using Eq. (38);
                                       
                                       
                                          
                                             
                                             Evaluate the new position S
                                             
                                                n
                                             (t
                                             +1) of Particle n by simulation model;
                                       
                                       
                                          
                                             
                                             End For;
                                       
                                       
                                          
                                             End For;
                                       
                                    
                                 
                              
                           
                        

We develop a discrete event simulation model to simulate the operational process of the MCSCN in detail. The simulation model, which is embedded in the proposed simulation-based heuristic method framework, takes a potential solution to the considered optimization problem and conducts a simulation to evaluate the solutions’ performance and repair unfeasible solutions and improve evident low quality solutions. It allows tracing the storage, loading, transshipment and unloading processes of each container set at each terminal and each yard. The simulation model outputs an operational level performance measure, which denotes the total container supply chain service cost.

In the MCSCN problem, the simulation model is constructed based on the method proposed by He et al. [28]. The simulation model consists of five parts, i.e., (1) parameter module, (2) optimization interface, (3) event control module, (4) object module, and (5) indices and evaluation module. The simulation model is illustrated in Fig. 4
                        .

Parameter module is the fundament of simulation optimization, which mainly is used to initialize the simulation environment of the MCSCN problem. Initial parameters include all user-defined parameters presented in Section 3.3, such as the set of all container sets and the transportation cost between a supplier and a demander. These user-defined parameters can be divided into three classes. The first class parameters are used to define the initial scenario, such as the amount of each Container Set at each inland yard and each terminal, the demand of each inland yard for each container set. The second class parameters are used in the process of simulation, such as the transportation time between a supplier and a demander. The third class parameters are used for calculating evaluation indices. For example, the unit shortage cost of a container set at a demander is used for calculating the total shortage cost of the MCSCN solution.

The optimization interface is used to convert each chromosome generated by the GA and each particle generated by the PSO into a MCSCN scheme, and feed back the evaluation indices into the GA or the PSO for calculating fitness value.

The control module mainly is used to control the pushing of the simulation events and execute gene repair procedure. The simulation clock of the control module is used to control (1) the start and end of running simulation and (2) control the processing time of each event. The gene repair procedure of the control module is very important, which is used to repair the unfeasible solutions and improve low quality solutions. There are many different events that occur within the simulation process for the MCSCN problem, such as storage event, loading event, unloading event and transshipment event. The control module ensures that events occur in proper chronological order. All of storage event, loading event, unloading event occur at all inland yards and terminals, but transshipment event occur between a supplier and a demander. Fig. 5
                            presents the control flow of all events in the simulation model.

The object module is used to simulate all movements and behaviors, e.g., loading, unloading, transshipment and storage. This module consists of four parts: (1) container set objects, (2) storage objects, (3) loading objects, (4) unloading objects, and (5) transshipment objects. Container set objects are flowed among all other objects. All inland yards and container terminals should own storage objects, loading objects and unloading objects, which are used to undertake the storage, loading and unloading behaviors, respectively. Transshipment objects are used to simulate the transshipments of containers, which exist between all suppliers and demanders.

The indices and evaluation module is used to evaluate a MCSCN solution and obtain all performance indices. In the MCSCN problem, performance indices include the shortage cost of each demander for each container set, the transportation cost of each container set in each echelon transportation, the handling cost, storage cost and overstock cost of each container set at each container supply chain node. Based on these performance indices obtained from the simulation, the evaluation model is used to calculate the objective value of the MNSSCN solution. Upon completion of simulation for the MNSSCN solution, the objective value is input into the GA or PSO for calculating its fitness value.

In numerical experiments section, a series of numerical experiments with different sizes are conducted to evaluate the effectiveness of the proposed simulation-based heuristic algorithm for the MCSCN problem. The numerical experiments consist of two parts: (1) the performance evaluation of the proposed method and (2) managerial implications analysis.

In these experiments, we should first set all initial parameters. Some initial parameters are used to set the size of the MCSCN problem, such as the number of container sets, the number of DIYs, the number of DCTs, the number of OCTs and the number of OIYs. Some inconstant initial parameters are randomly generated based on some distributions, e.g., the transportation time and unit transportation cost between a supplier and a demander, the unit shortage cost of each container set at each terminal or each inland yard, and the unit overstock cost of each container set at each terminal or each inland yard. The other constant initial parameters include the storage time, the unit storage cost and handling cost of all container terminals and inland yards. The statistical distributions of all inconstant initial parameters are as follows.
                           
                              
                                 
                                 
                                 
                                    
                                       The amount of a container set at each inland yard
                                       Uniform distribution, U(50,300)
                                    
                                    
                                       The amount of a container set at each terminal
                                       Uniform distribution, U(50,300)
                                    
                                    
                                       The demand for a container set at an inland yard
                                       Uniform distribution, U(80,400)
                                    
                                    
                                       The transportation time between a DIY and a DCT (unit: h)
                                       Normal distribution, N(12,2)
                                    
                                    
                                       The transportation time between a DCT and an OCT (unit: h)
                                       Normal distribution, N(120,12)
                                    
                                    
                                       The transportation time between an OCT and an OIY (unit: h)
                                       Normal distribution, N(12,2)
                                    
                                    
                                       The unit transportation cost per hour between a DIY and a DCT (unit: $/h)
                                       Normal distribution, N(150,20)
                                    
                                    
                                       The unit transportation cost per hour between a DCT and an OCT (unit: $/h)
                                       Normal distribution, N(4,0.5)
                                    
                                    
                                       The unit transportation cost per hour between an OCT and an OIY (unit: $/h)
                                       Normal distribution, N(150,20)
                                    
                                    
                                       The unit shortage cost of a container set at an inland yard (unit: $)
                                       Uniform distribution, U (400,500)
                                    
                                    
                                       The unit overstock cost of a container set at a node (unit: $)
                                       Uniform distribution, U (180,200)
                                    
                                 
                              
                           
                        
                     

In the above initial parameters, all normal distributions actually are truncated normal distribution. The constant initial parameters are set as follows.
                           
                              
                                 
                                 
                                 
                                    
                                       The unit storage cost of a container at a container terminal or an inland yard (unit: $/h)
                                       0.1
                                    
                                    
                                       The storage time of a container at a container terminal or an inland yard(unit: h)
                                       72
                                    
                                    
                                       The unit handling cost of a container at a container terminal and an inland yard (unit: $)
                                       160
                                    
                                 
                              
                           
                        
                     

In order to ensure the objective performance evaluation, all numerical experiments are run on Intel Core Duo 2.1GHz processors and 3GB RAM.

@&#PERFORMANCE EVALUATION@&#

In this section, we analyze the computational performance of the proposed simulation-based heuristic method. We compare the CPU time and solution quality of three methods:
                           
                              (1)
                              GA–PSO–SIM: In the simulation-based framework, the heuristic integrates GA and PSO.

GA–SIM: In the simulation-based framework, only the pure GA without PSO is used as the heuristic method.

CPLEX: The linearized MNSSCN model is directly solved by ILOG CPLEX 12.4, which is a commercial mathematical programming solver.

Different test instances are divided in two sets, with 10 sets of small size instances and 15 sets of large size instances. We classify the experiments into small and large sizes because the exact solutions in the small size MCSCN problems can be obtained by CPLEX, whereas the exact solutions may not be obtained until out of memory in the large size problems. Therefore, we use the exact solutions of the small size instances and the lower bounds of the large size instances as a benchmark for evaluating the solution quality of GA–PSO–SIM and GA–SIM. The sizes of all instances are determined by the number of containers and the number of container supply chain nodes. In each set experiment, 10 instances are randomly generated to reduce the impact of using specific data sets. Table 2
                         shows the size parameters of each set experiment.

In this subsection, ten sets of small size instances are randomly created according to the size parameters presented in Table 2, and the objective values and CPU times obtained by the GA–PSO–SIM, GA–SIM and CPLEX are compared. The parameters of the GA and PSO can be determined by preliminary tests. The population size, the probability of crossover, the probability of mutation, and the maximum generations of the GA, are set as 40, 0.6, 0.1 and 60, respectively. The number of particles, 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       max
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                    
                                       max
                                    
                                 
                              
                            and the maximum iterations of the PSO are set as 15, 1, 6, 1, 6 and 20, respectively.


                           Table 3
                            shows the results of the ten sets of small size instances, in which 3–30 container, 4–40 DIYs and OIYs, 2–20 DCTs and OCTs are considered. It can be observed from Table 1 that the gaps between the results obtained from GA–PSO–SIM and those obtained from CPLEX are very small (for example, the average gap is only 1.13%, the minimum gap is 0, and the maximum gap is only 3.1%). Another observation is the gaps between the results obtained from GA–PSO–SIM and those obtained from CPLEX are smaller than the gaps between those obtained from GA–SIM. For example, the average gap of GA–PSO–SIM is only approximately 42% of that of GA–SIM. This observation confirms that GA–PSO–SIM performs better than GA–SIM in the small size MCSCN problems. Fig. 6
                            shows the changing trend of the gaps obtained by GA–PSO–SIM and GA–SIM in these small size instances, which indicates that with the increment of the problem size, the gaps between the aforementioned heuristic methods and CPLEX generally increase. From Fig. 6, we can find that the difference of the gaps of GA–PSO–SIM and GA–SIM generally increase, which indicates that the advantage of GA–PSO–SIM over GA–SIM is more evident with the increment of the problem size.

As to the CPU time of aforementioned methods, CPLEX varies dramatically and grows exponentially as the instance size increases. The CPU time of CPLEX is on average 22.53 times of that of GA–PSO–SIM, 23.61 times of that of GA–SIM. Although the CPU time of GA–PSO–SIM is longer than that of GA–SIM, the difference among them is marginal (the CPU time of GA–PSO–SIM is only 1.05 times of that of the GA–SIM). Furthermore, the CPU time of GA–PSO–SIM is also acceptable in practice for small size instances (for example, the maximum CPU time of these ten sets of instances is only 427.4s). Therefore, the GA–PSO–SIM has a relatively good solution quality, and is more suitable for solving small size instances.

In this subsection, 15 sets of large size instances are randomly created according to the size parameters presented in Table 2, and the objective values and CPU times obtained by the GA–PSO–SIM and GA–SIM are compared. Since it is difficult to obtain the optimal solution within a reasonable time limit by CPLEX for large size instances, we use lower bounds corresponding to the instances directly generated by CPLEX as benchmarks. The parameters of the GA and PSO can be determined by preliminary tests. The population size, the probability of crossover, the probability of mutation, and the maximum generations of the GA, are set as 80, 0.8, 0.2 and 100, respectively. The number of particles, 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       min
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       1
                                    
                                    
                                       max
                                    
                                 
                                 ,
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                    
                                       min
                                    
                                 
                              
                            and 
                              
                                 
                                    
                                       ρ
                                    
                                    
                                       2
                                    
                                    
                                       max
                                    
                                 
                              
                            and the maximum iterations of the PSO are set as 20, 2, 5, 2, 5 and 15, respectively.

As observed in Table 4
                           , the gaps between the results obtained from GA–PSO–SIM and those obtained from CPLEX are still very small in large size instances (for example, the average gap is only 4.4%, the minimum gap is 3.4%, and the maximum gap is only 6.3%). From this table, we also can observe that GA–PSO–SIM performs better than GA–SIM in large size instances. Specially, the average gap of GA–PSO–SIM is only approximately 38% of that of GA–SIM. Fig. 7
                            shows the performance comparison among the aforementioned methods in large size instances. From this figure, we can observe that the difference of the gaps for the two methods in large size instances is greater than that in small size instances, which indicates that the advantage of GA–PSO–SIM for large size instances is more significant than that for small size instances.

As to the CPU time of aforementioned methods, the CPU time of GA–PSO–SIM still is longer than that of GA–SIM in large size instances. However, the difference is not large among these methods. In detail, the CPU time of GA–PSO–SIM is only 1.07 times of that of the GA–SIM, on average. The CPU times of GA–PSO–SIM for all the instances are acceptable in practice. Therefore, the GA–PSO–SIM is satisfactory for solving large size instances.

Based on the above twenty-five sets of numerical experiments, we conclude that the proposed simulation-based heuristic method GA–PSO–SIM could obtain high quality near-optimal solutions for all size MCSCN problems in reasonable time.

In this subsection, managerial implications are explored by investigate the influences of some parameters on the performances. This subsection consists of two parts: (1) the managerial implications and influences of the proportion of possessive quantity to demand of each container set at all nodes and (2) the managerial implications and influences of the proportion of overstock cost to shortage cost of each container set at all nodes.

The proportion of possessive quantity to demand of each container set is defined as follow:

Suppose the possessive quantity of an inland yard or a terminal for a container set is denoted by np, and the demand quantity of the inland yard or the terminal for the container set is denoted by nd, the proportion of possessive quantity to demand is np/nd.

Twenty-five sets of different size experiments are conducted to analyze the influences of the proportion of possessive quantity to demand of each container set at all nodes. We still use the size parameters presented in Table 2 to set the sizes of all sets instances in this subsection. The overstock cost of each container set at all nodes is the same to its shortage cost. The proportion coefficient π could be set as 0.5,0.6,…,1.5, with a step size of 0.1. By changing the value of π, different sets of solutions can be obtained.


                           Table 5
                            presents the total supply chain service cost with different proportion coefficient π. Fig. 8
                            shows the change trend of the total cost with the changing of the proportion coefficient π. From Table 5 and Fig. 8, we can observe that the total cost is the minimum when the proportion coefficient π is 1.0. As higher shortage cost, when π is smaller than 1.0, the total cost are higher and higher with the decrease of π. As higher overstock cost, when π is greater than 1.0, the total cost are higher and higher with the increase of π. From Fig. 8, we can also find the total costs when π is greater than 1.0 generally are slightly higher than that when π is smaller than 1.0. This is because there exists more transportation costs, handling costs and storage costs when possessive quantity to demand. Therefore, the possessive quantity of each container set in all nodes should be close to the demand of the container set in other nodes.

The proportion of overstock cost to shortage cost of each container set is defined as follow:

Suppose the overstock cost of an inland yard or a terminal for a container set is denoted by oc, and the shortage cost of the inland yard or the terminal for the container set is denoted by sc, the proportion of overstock cost to shortage cost is oc/sc.

In this subsection, we use a maximum size instance to investigate the influences of the proportion of overstock cost to shortage cost of each container set on the total cost. The proportion of overstock cost to shortage cost of each container set is denoted by Notation σ, which could be set as 0.5,0.6,…,1.5, with a step size of 0.1.

The proportion coefficient π still could be set as 0.5,0.6,…,1.5, By changing the values of σ and π, different sets of solutions can be obtained.


                           Table 6
                            presents the total supply chain service cost with different proportion coefficient σ and π. Fig. 9
                            shows a set of curves reflecting the change trend of the total cost with the changing of σ. From Table 6 and Fig. 9, we can observe that the total supply chain service cost firstly decreases rapidly and then increases slowly with π varying from 0.5 to 1.5, when σ is smaller than 1.0. On the contrary, when σ is greater than 1.0, the total supply chain operation cost firstly decreases slowly and then increases rapidly with π varying from 0.5 to 1.5. Therefore, we should maintain a little excess quantity for a container set when its overstock cost is smaller than its shortage cost. On the contrary, a appropriate lack for a container set also should be, when its overstock cost is greater than its shortage cost.

@&#CONCLUSIONS@&#

Motivated by how to improve service level of container supply chain, the optimization problem of multi-echelon container supply chain network is addressed in this paper. The main goal is to optimize the total container supply chain service cost. The major contributions of the study are as follows:
                        
                           (1)
                           The MCSCN problem is formulated as a MIP model, which aims at minimizing the total supply chain service cost (including shortage cost, transportation cost, handling cost, storage cost and overstock cost), while capturing all the essential constraints in practice. The MIP model can be solved by commercial solvers for small size instances, and can be used to obtain lower bounds for large size instances. Therefore, it provides benchmarks for evaluating the proposed solution method.

As the MCSCN problem is NP-hard, a novel simulation-based heuristic method is proposed to efficiently solve the problem, where the heuristic is used for searching near-optimal solutions, and the simulation is used for evaluating solutions and repairing unfeasible solutions. The heuristic algorithm integrates genetic algorithm (GA) and particle swarm optimization (PSO) algorithm, where the GA is used for global search and the PSO is used for local search. We find that GA–PSO–SIM performs the best among all variants of the simulation-based heuristic method. Expensive numerical experiments validate that our proposed simulation-based heuristic method can obtain high quality solutions in reasonable time for practical MCSCN problems. Some managerial implications are also obtained by investigate the influences of some parameters.

There are also limitations in this study. In the current study, operating time has not been considered as a performance indicator of the MCSCN. The uncertainty factors, such as demand, supply and transportation time have not been considered in this study. All of these issues are valuable research directions in the future.

@&#ACKNOWLEDGEMENTS@&#

This work is sponsored by National Natural Science Foundation project (71101090), Shanghai Top Academic Discipline Project – management science & engineering, Doctoral Fund of the Ministry of Education (20133121110001), Shanghai Yangfan Program (14YF1411200), Shanghai Municipal Education Commission Project (12ZZ148, 13YZ080, 14YZ112), and Shanghai Maritime University Research Project (20120102, 20120125). We also thank anonymous referees and the editor-in-chief.

@&#REFERENCES@&#

